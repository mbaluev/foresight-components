<!DOCTYPE html>
<html lang="ru">
  <head runat="server">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta charset="utf-8"/>
    <title>MAP</title>
    
 <link href="/asyst/css/asyst.third.min.css" rel="stylesheet">

    <link href="/asyst/css/asyst.global.css" rel="stylesheet">
	  
    <script src="/asyst/js/asyst.globalization.js" type="text/javascript"></script>
      
    <script src="/asyst/js/asyst.third.js" type="text/javascript"></script>
    
    <script src="/asyst/js/asyst.utils.js" type="text/javascript"></script>
    <script src="/asyst/js/asyst.js" type="text/javascript"></script>
    <script src="/asyst/js/asyst.workspace.js" type="text/javascript"></script>
    <script src="/asyst/js/asyst.number.js" type="text/javascript"></script>
    <script src="/asyst/js/asyst.globalsearch.js" type="text/javascript"></script>
    <script src="/asyst/js/asyst.board.js" type="text/javascript"></script>
    <script src="/asyst/js/application.js" type="text/javascript"></script>
    <script src="/asyst/js/application.model.js" type="text/javascript"></script>
    <script src="/asyst/js/application.documents.js" type="text/javascript"></script>
    <script src="/asyst/js/application.points.js" type="text/javascript"></script>
    <script src="/asyst/js/asyst.changerequest.js" type="text/javascript"></script>

    <script src="/asyst/jsTree/jquery.jstree.js" type="text/javascript" ></script>
    
    <script>
        $(function () {
            var treeData;
            $.ajax({
                url: '/asyst/api/gleaningtags',
                type: 'GET',
                async: true,
                cache: false,
                data: null,
                dataType: "json",
                processData: false,
                success: function (response) {
                    treeData = response;
                    $("#demo1").jstree({
                        "json_data": {
                            "data": treeData
                        },
                        "search" : { "case_insensitive": false, "show_only_matches": false },
                        "plugins": [ "themes", "json_data", "ui", "search"],
                        "themes" : { "theme" : "default", "dots" : true, "icons" : false },

                    }).bind("select_node.jstree", function (e, data) {
                        window['GleaningByTag'].DataParams.tagId = $.attr(data.args[0], 'id');
                        $("#TagName").text(data.args[0].innerText);
                        window['GleaningByTag'].Reload('GleaningByTag');
                    });

                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert(textStatus);
                }
            });
            showBrowser('#demo2', 'GleaningByTag', null, null, null, null, { tagId: '' });
             $('#demo1').height($(document).height() - 225);
        });
        var search = function() {
            $('#demo1').jstree(
                'search', $('#searchtext').val()
            );
        };
    </script>
    <style>
        #demo1 > ul > li > a { background-color: #57a1f2; padding: 3px 10px; color: #ffffff; border: 2px solid #fcfcfc; border-radius: 5px; }
        #demo1 > ul > li > ul > li > a { background-color: #33b533; padding: 3px 10px; color: #ffffff; border: 2px solid #fcfcfc; border-radius: 5px; }
        .jstree-leaf > a { padding: 3px 10px; color: #4a4a4a; border: 2px solid #fcfcfc; border-radius: 5px; }
    </style>
  </head>
  <body style="width: 100%; height: 100%; margin: 0px; padding: 0px;">
    <div style="width: 100%; height: 100%; padding-top: 5px;">
        <input id="searchtext" type="text" style="height: 19px; float: left; border: 1px solid #e5e5e5; width: 305px; border-radius: 5px; font-family: Segoe UI, Calibri, Arial; font-size: 13px; margin-left: 5px;"  />
        &nbsp;
        <input type="submit" value="Найти" onclick="search(); return false;" style="height: 29px; float: left; border: 1px solid #e5e5e5; background-color: #b233b9; width: 65px; min-width: 65px; border-radius: 5px; margin-left: 5px; color: #ffffff; font-family: Segoe UI, Calibri, Arial; font-size: 13px; vertical-align: middle; padding: 0px"/> 
        &nbsp;
        <span id="TagName" style="color: #5a5a5a; font-weight: 500; font: 24px 'Segoe UI Light'; padding-left: 5px"></span>

        <br style="clear: both" />

        <div id='demo1' style="float: left; height: 700px; width: 390px; background-color: #fcfcfc; overflow: auto; overflow-x: hidden;"></div>
        <div id='demo2' style="height: 100%"></div>
    </div>
  </body>
</html>
