{"version":3,"sources":["jquery-1.11.1.js","jquery-migrate-1.2.1.js","jquery-ui.1.11.1.min.js","jquery.event.drag-2.2.js","jquery.gritter.js","bootstrap.min.js","bootstrap-datepicker.js","bootstrap-modal.js","bootstrap-modalmanager.js","chosen.jquery.js","slick.core.js","slick.formatters.js","slick.editors.js","slick.cellrangeselector.js","slick.cellselectionmodel.js","slick.rowselectionmodel.js","asyst.rowselectionmodel.js","slick.checkboxselectcolumn.js","slick.grid.js","slick.groupitemmetadataprovider.js","slick.dataview.js","slick.pager.js","slick.columnpicker.js","fileuploader.js","highcharts.js","map.js","highcharts-more.js","exporting.js","no-data-to-display.js","funnel.js","heatmap.js","ru-all-disputed.js","treemap.js","highcharts-3d.js","sunburst.js","xrange.js","highcharts-asyst.js","jquery.timeline.widget.js","jquery.comments.widget.js","linq.min.js","jquery.sparkline.min.js","numeral.min.js","jszip.min.js","xlsx.js","FileSaver.js","jquery.ztree.all-3.5.min.js","jquery.ztree.exhide-3.5.custom.js","tree.class.js","dataRows.class.js","treeComboBox.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpkUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvZA;AACA;AACA;AACA;AACA;AACA;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpuCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACj7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjiCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9tCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1BA;AACA;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACTA;AACA;AACA;AACA;AACA;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtwYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"asyst.third.js","sourcesContent":["/*!\r\n * jQuery JavaScript Library v1.11.1\r\n * http://jquery.com/\r\n *\r\n * Includes Sizzle.js\r\n * http://sizzlejs.com/\r\n *\r\n * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors\r\n * Released under the MIT license\r\n * http://jquery.org/license\r\n *\r\n * Date: 2014-05-01T17:42Z\r\n */\r\n;\r\n(function( global, factory ) {\r\n\r\n\tif ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\r\n\t\t// For CommonJS and CommonJS-like environments where a proper window is present,\r\n\t\t// execute the factory and get jQuery\r\n\t\t// For environments that do not inherently posses a window with a document\r\n\t\t// (such as Node.js), expose a jQuery-making factory as module.exports\r\n\t\t// This accentuates the need for the creation of a real window\r\n\t\t// e.g. var jQuery = require(\"jquery\")(window);\r\n\t\t// See ticket #14549 for more info\r\n\t\tmodule.exports = global.document ?\r\n\t\t\tfactory( global, true ) :\r\n\t\t\tfunction( w ) {\r\n\t\t\t\tif ( !w.document ) {\r\n\t\t\t\t\tthrow new Error( \"jQuery requires a window with a document\" );\r\n\t\t\t\t}\r\n\t\t\t\treturn factory( w );\r\n\t\t\t};\r\n\t} else {\r\n\t\tfactory( global );\r\n\t}\r\n\r\n// Pass this if window is not defined yet\r\n}(typeof window !== \"undefined\" ? window : this, function( window, noGlobal ) {\r\n\r\n// Can't do this because several apps including ASP.NET trace\r\n// the stack via arguments.caller.callee and Firefox dies if\r\n// you try to trace through \"use strict\" call chains. (#13335)\r\n// Support: Firefox 18+\r\n//\r\n\r\nvar deletedIds = [];\r\n\r\nvar slice = deletedIds.slice;\r\n\r\nvar concat = deletedIds.concat;\r\n\r\nvar push = deletedIds.push;\r\n\r\nvar indexOf = deletedIds.indexOf;\r\n\r\nvar class2type = {};\r\n\r\nvar toString = class2type.toString;\r\n\r\nvar hasOwn = class2type.hasOwnProperty;\r\n\r\nvar support = {};\r\n\r\n\r\n\r\nvar\r\n\tversion = \"1.11.1\",\r\n\r\n\t// Define a local copy of jQuery\r\n\tjQuery = function( selector, context ) {\r\n\t\t// The jQuery object is actually just the init constructor 'enhanced'\r\n\t\t// Need init if jQuery is called (just allow error to be thrown if not included)\r\n\t\treturn new jQuery.fn.init( selector, context );\r\n\t},\r\n\r\n\t// Support: Android<4.1, IE<9\r\n\t// Make sure we trim BOM and NBSP\r\n\trtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,\r\n\r\n\t// Matches dashed string for camelizing\r\n\trmsPrefix = /^-ms-/,\r\n\trdashAlpha = /-([\\da-z])/gi,\r\n\r\n\t// Used by jQuery.camelCase as callback to replace()\r\n\tfcamelCase = function( all, letter ) {\r\n\t\treturn letter.toUpperCase();\r\n\t};\r\n\r\njQuery.fn = jQuery.prototype = {\r\n\t// The current version of jQuery being used\r\n\tjquery: version,\r\n\r\n\tconstructor: jQuery,\r\n\r\n\t// Start with an empty selector\r\n\tselector: \"\",\r\n\r\n\t// The default length of a jQuery object is 0\r\n\tlength: 0,\r\n\r\n\ttoArray: function() {\r\n\t\treturn slice.call( this );\r\n\t},\r\n\r\n\t// Get the Nth element in the matched element set OR\r\n\t// Get the whole matched element set as a clean array\r\n\tget: function( num ) {\r\n\t\treturn num != null ?\r\n\r\n\t\t\t// Return just the one element from the set\r\n\t\t\t( num < 0 ? this[ num + this.length ] : this[ num ] ) :\r\n\r\n\t\t\t// Return all the elements in a clean array\r\n\t\t\tslice.call( this );\r\n\t},\r\n\r\n\t// Take an array of elements and push it onto the stack\r\n\t// (returning the new matched element set)\r\n\tpushStack: function( elems ) {\r\n\r\n\t\t// Build a new jQuery matched element set\r\n\t\tvar ret = jQuery.merge( this.constructor(), elems );\r\n\r\n\t\t// Add the old object onto the stack (as a reference)\r\n\t\tret.prevObject = this;\r\n\t\tret.context = this.context;\r\n\r\n\t\t// Return the newly-formed element set\r\n\t\treturn ret;\r\n\t},\r\n\r\n\t// Execute a callback for every element in the matched set.\r\n\t// (You can seed the arguments with an array of args, but this is\r\n\t// only used internally.)\r\n\teach: function( callback, args ) {\r\n\t\treturn jQuery.each( this, callback, args );\r\n\t},\r\n\r\n\tmap: function( callback ) {\r\n\t\treturn this.pushStack( jQuery.map(this, function( elem, i ) {\r\n\t\t\treturn callback.call( elem, i, elem );\r\n\t\t}));\r\n\t},\r\n\r\n\tslice: function() {\r\n\t\treturn this.pushStack( slice.apply( this, arguments ) );\r\n\t},\r\n\r\n\tfirst: function() {\r\n\t\treturn this.eq( 0 );\r\n\t},\r\n\r\n\tlast: function() {\r\n\t\treturn this.eq( -1 );\r\n\t},\r\n\r\n\teq: function( i ) {\r\n\t\tvar len = this.length,\r\n\t\t\tj = +i + ( i < 0 ? len : 0 );\r\n\t\treturn this.pushStack( j >= 0 && j < len ? [ this[j] ] : [] );\r\n\t},\r\n\r\n\tend: function() {\r\n\t\treturn this.prevObject || this.constructor(null);\r\n\t},\r\n\r\n\t// For internal use only.\r\n\t// Behaves like an Array's method, not like a jQuery method.\r\n\tpush: push,\r\n\tsort: deletedIds.sort,\r\n\tsplice: deletedIds.splice\r\n};\r\n\r\njQuery.extend = jQuery.fn.extend = function() {\r\n\tvar src, copyIsArray, copy, name, options, clone,\r\n\t\ttarget = arguments[0] || {},\r\n\t\ti = 1,\r\n\t\tlength = arguments.length,\r\n\t\tdeep = false;\r\n\r\n\t// Handle a deep copy situation\r\n\tif ( typeof target === \"boolean\" ) {\r\n\t\tdeep = target;\r\n\r\n\t\t// skip the boolean and the target\r\n\t\ttarget = arguments[ i ] || {};\r\n\t\ti++;\r\n\t}\r\n\r\n\t// Handle case when target is a string or something (possible in deep copy)\r\n\tif ( typeof target !== \"object\" && !jQuery.isFunction(target) ) {\r\n\t\ttarget = {};\r\n\t}\r\n\r\n\t// extend jQuery itself if only one argument is passed\r\n\tif ( i === length ) {\r\n\t\ttarget = this;\r\n\t\ti--;\r\n\t}\r\n\r\n\tfor ( ; i < length; i++ ) {\r\n\t\t// Only deal with non-null/undefined values\r\n\t\tif ( (options = arguments[ i ]) != null ) {\r\n\t\t\t// Extend the base object\r\n\t\t\tfor ( name in options ) {\r\n\t\t\t\tsrc = target[ name ];\r\n\t\t\t\tcopy = options[ name ];\r\n\r\n\t\t\t\t// Prevent never-ending loop\r\n\t\t\t\tif ( target === copy ) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Recurse if we're merging plain objects or arrays\r\n\t\t\t\tif ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) ) ) {\r\n\t\t\t\t\tif ( copyIsArray ) {\r\n\t\t\t\t\t\tcopyIsArray = false;\r\n\t\t\t\t\t\tclone = src && jQuery.isArray(src) ? src : [];\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tclone = src && jQuery.isPlainObject(src) ? src : {};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Never move original objects, clone them\r\n\t\t\t\t\ttarget[ name ] = jQuery.extend( deep, clone, copy );\r\n\r\n\t\t\t\t// Don't bring in undefined values\r\n\t\t\t\t} else if ( copy !== undefined ) {\r\n\t\t\t\t\ttarget[ name ] = copy;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Return the modified object\r\n\treturn target;\r\n};\r\n\r\njQuery.extend({\r\n\t// Unique for each copy of jQuery on the page\r\n\texpando: \"jQuery\" + ( version + Math.random() ).replace( /\\D/g, \"\" ),\r\n\r\n\t// Assume jQuery is ready without the ready module\r\n\tisReady: true,\r\n\r\n\terror: function( msg ) {\r\n\t\tthrow new Error( msg );\r\n\t},\r\n\r\n\tnoop: function() {},\r\n\r\n\t// See test/unit/core.js for details concerning isFunction.\r\n\t// Since version 1.3, DOM methods and functions like alert\r\n\t// aren't supported. They return false on IE (#2968).\r\n\tisFunction: function( obj ) {\r\n\t\treturn jQuery.type(obj) === \"function\";\r\n\t},\r\n\r\n\tisArray: Array.isArray || function( obj ) {\r\n\t\treturn jQuery.type(obj) === \"array\";\r\n\t},\r\n\r\n\tisWindow: function( obj ) {\r\n\t\t/* jshint eqeqeq: false */\r\n\t\treturn obj != null && obj == obj.window;\r\n\t},\r\n\r\n\tisNumeric: function( obj ) {\r\n\t\t// parseFloat NaNs numeric-cast false positives (null|true|false|\"\")\r\n\t\t// ...but misinterprets leading-number strings, particularly hex literals (\"0x...\")\r\n\t\t// subtraction forces infinities to NaN\r\n\t\treturn !jQuery.isArray( obj ) && obj - parseFloat( obj ) >= 0;\r\n\t},\r\n\r\n\tisEmptyObject: function( obj ) {\r\n\t\tvar name;\r\n\t\tfor ( name in obj ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\tisPlainObject: function( obj ) {\r\n\t\tvar key;\r\n\r\n\t\t// Must be an Object.\r\n\t\t// Because of IE, we also have to check the presence of the constructor property.\r\n\t\t// Make sure that DOM nodes and window objects don't pass through, as well\r\n\t\tif ( !obj || jQuery.type(obj) !== \"object\" || obj.nodeType || jQuery.isWindow( obj ) ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// Not own constructor property must be Object\r\n\t\t\tif ( obj.constructor &&\r\n\t\t\t\t!hasOwn.call(obj, \"constructor\") &&\r\n\t\t\t\t!hasOwn.call(obj.constructor.prototype, \"isPrototypeOf\") ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} catch ( e ) {\r\n\t\t\t// IE8,9 Will throw exceptions on certain host objects #9897\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Support: IE<9\r\n\t\t// Handle iteration over inherited properties before own properties.\r\n\t\tif ( support.ownLast ) {\r\n\t\t\tfor ( key in obj ) {\r\n\t\t\t\treturn hasOwn.call( obj, key );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Own properties are enumerated firstly, so to speed up,\r\n\t\t// if last one is own, then all properties are own.\r\n\t\tfor ( key in obj ) {}\r\n\r\n\t\treturn key === undefined || hasOwn.call( obj, key );\r\n\t},\r\n\r\n\ttype: function( obj ) {\r\n\t\tif ( obj == null ) {\r\n\t\t\treturn obj + \"\";\r\n\t\t}\r\n\t\treturn typeof obj === \"object\" || typeof obj === \"function\" ?\r\n\t\t\tclass2type[ toString.call(obj) ] || \"object\" :\r\n\t\t\ttypeof obj;\r\n\t},\r\n\r\n\t// Evaluates a script in a global context\r\n\t// Workarounds based on findings by Jim Driscoll\r\n\t// http://weblogs.java.net/blog/driscoll/archive/2009/09/08/eval-javascript-global-context\r\n\tglobalEval: function( data ) {\r\n\t\tif ( data && jQuery.trim( data ) ) {\r\n\t\t\t// We use execScript on Internet Explorer\r\n\t\t\t// We use an anonymous function so that context is window\r\n\t\t\t// rather than jQuery in Firefox\r\n\t\t\t( window.execScript || function( data ) {\r\n\t\t\t\twindow[ \"eval\" ].call( window, data );\r\n\t\t\t} )( data );\r\n\t\t}\r\n\t},\r\n\r\n\t// Convert dashed to camelCase; used by the css and data modules\r\n\t// Microsoft forgot to hump their vendor prefix (#9572)\r\n\tcamelCase: function( string ) {\r\n\t\treturn string.replace( rmsPrefix, \"ms-\" ).replace( rdashAlpha, fcamelCase );\r\n\t},\r\n\r\n\tnodeName: function( elem, name ) {\r\n\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();\r\n\t},\r\n\r\n\t// args is for internal usage only\r\n\teach: function( obj, callback, args ) {\r\n\t\tvar value,\r\n\t\t\ti = 0,\r\n\t\t\tlength = obj.length,\r\n\t\t\tisArray = isArraylike( obj );\r\n\r\n\t\tif ( args ) {\r\n\t\t\tif ( isArray ) {\r\n\t\t\t\tfor ( ; i < length; i++ ) {\r\n\t\t\t\t\tvalue = callback.apply( obj[ i ], args );\r\n\r\n\t\t\t\t\tif ( value === false ) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor ( i in obj ) {\r\n\t\t\t\t\tvalue = callback.apply( obj[ i ], args );\r\n\r\n\t\t\t\t\tif ( value === false ) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t// A special, fast, case for the most common use of each\r\n\t\t} else {\r\n\t\t\tif ( isArray ) {\r\n\t\t\t\tfor ( ; i < length; i++ ) {\r\n\t\t\t\t\tvalue = callback.call( obj[ i ], i, obj[ i ] );\r\n\r\n\t\t\t\t\tif ( value === false ) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor ( i in obj ) {\r\n\t\t\t\t\tvalue = callback.call( obj[ i ], i, obj[ i ] );\r\n\r\n\t\t\t\t\tif ( value === false ) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t},\r\n\r\n\t// Support: Android<4.1, IE<9\r\n\ttrim: function( text ) {\r\n\t\treturn text == null ?\r\n\t\t\t\"\" :\r\n\t\t\t( text + \"\" ).replace( rtrim, \"\" );\r\n\t},\r\n\r\n\t// results is for internal usage only\r\n\tmakeArray: function( arr, results ) {\r\n\t\tvar ret = results || [];\r\n\r\n\t\tif ( arr != null ) {\r\n\t\t\tif ( isArraylike( Object(arr) ) ) {\r\n\t\t\t\tjQuery.merge( ret,\r\n\t\t\t\t\ttypeof arr === \"string\" ?\r\n\t\t\t\t\t[ arr ] : arr\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tpush.call( ret, arr );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn ret;\r\n\t},\r\n\r\n\tinArray: function( elem, arr, i ) {\r\n\t\tvar len;\r\n\r\n\t\tif ( arr ) {\r\n\t\t\tif ( indexOf ) {\r\n\t\t\t\treturn indexOf.call( arr, elem, i );\r\n\t\t\t}\r\n\r\n\t\t\tlen = arr.length;\r\n\t\t\ti = i ? i < 0 ? Math.max( 0, len + i ) : i : 0;\r\n\r\n\t\t\tfor ( ; i < len; i++ ) {\r\n\t\t\t\t// Skip accessing in sparse arrays\r\n\t\t\t\tif ( i in arr && arr[ i ] === elem ) {\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t},\r\n\r\n\tmerge: function( first, second ) {\r\n\t\tvar len = +second.length,\r\n\t\t\tj = 0,\r\n\t\t\ti = first.length;\r\n\r\n\t\twhile ( j < len ) {\r\n\t\t\tfirst[ i++ ] = second[ j++ ];\r\n\t\t}\r\n\r\n\t\t// Support: IE<9\r\n\t\t// Workaround casting of .length to NaN on otherwise arraylike objects (e.g., NodeLists)\r\n\t\tif ( len !== len ) {\r\n\t\t\twhile ( second[j] !== undefined ) {\r\n\t\t\t\tfirst[ i++ ] = second[ j++ ];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfirst.length = i;\r\n\r\n\t\treturn first;\r\n\t},\r\n\r\n\tgrep: function( elems, callback, invert ) {\r\n\t\tvar callbackInverse,\r\n\t\t\tmatches = [],\r\n\t\t\ti = 0,\r\n\t\t\tlength = elems.length,\r\n\t\t\tcallbackExpect = !invert;\r\n\r\n\t\t// Go through the array, only saving the items\r\n\t\t// that pass the validator function\r\n\t\tfor ( ; i < length; i++ ) {\r\n\t\t\tcallbackInverse = !callback( elems[ i ], i );\r\n\t\t\tif ( callbackInverse !== callbackExpect ) {\r\n\t\t\t\tmatches.push( elems[ i ] );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn matches;\r\n\t},\r\n\r\n\t// arg is for internal usage only\r\n\tmap: function( elems, callback, arg ) {\r\n\t\tvar value,\r\n\t\t\ti = 0,\r\n\t\t\tlength = elems.length,\r\n\t\t\tisArray = isArraylike( elems ),\r\n\t\t\tret = [];\r\n\r\n\t\t// Go through the array, translating each of the items to their new values\r\n\t\tif ( isArray ) {\r\n\t\t\tfor ( ; i < length; i++ ) {\r\n\t\t\t\tvalue = callback( elems[ i ], i, arg );\r\n\r\n\t\t\t\tif ( value != null ) {\r\n\t\t\t\t\tret.push( value );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t// Go through every key on the object,\r\n\t\t} else {\r\n\t\t\tfor ( i in elems ) {\r\n\t\t\t\tvalue = callback( elems[ i ], i, arg );\r\n\r\n\t\t\t\tif ( value != null ) {\r\n\t\t\t\t\tret.push( value );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Flatten any nested arrays\r\n\t\treturn concat.apply( [], ret );\r\n\t},\r\n\r\n\t// A global GUID counter for objects\r\n\tguid: 1,\r\n\r\n\t// Bind a function to a context, optionally partially applying any\r\n\t// arguments.\r\n\tproxy: function( fn, context ) {\r\n\t\tvar args, proxy, tmp;\r\n\r\n\t\tif ( typeof context === \"string\" ) {\r\n\t\t\ttmp = fn[ context ];\r\n\t\t\tcontext = fn;\r\n\t\t\tfn = tmp;\r\n\t\t}\r\n\r\n\t\t// Quick check to determine if target is callable, in the spec\r\n\t\t// this throws a TypeError, but we will just return undefined.\r\n\t\tif ( !jQuery.isFunction( fn ) ) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\t// Simulated bind\r\n\t\targs = slice.call( arguments, 2 );\r\n\t\tproxy = function() {\r\n\t\t\treturn fn.apply( context || this, args.concat( slice.call( arguments ) ) );\r\n\t\t};\r\n\r\n\t\t// Set the guid of unique handler to the same of original handler, so it can be removed\r\n\t\tproxy.guid = fn.guid = fn.guid || jQuery.guid++;\r\n\r\n\t\treturn proxy;\r\n\t},\r\n\r\n\tnow: function() {\r\n\t\treturn +( new Date() );\r\n\t},\r\n\r\n\t// jQuery.support is not used in Core but other projects attach their\r\n\t// properties to it so it needs to exist.\r\n\tsupport: support\r\n});\r\n\r\n// Populate the class2type map\r\njQuery.each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"), function(i, name) {\r\n\tclass2type[ \"[object \" + name + \"]\" ] = name.toLowerCase();\r\n});\r\n\r\nfunction isArraylike( obj ) {\r\n\tvar length = obj.length,\r\n\t\ttype = jQuery.type( obj );\r\n\r\n\tif ( type === \"function\" || jQuery.isWindow( obj ) ) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif ( obj.nodeType === 1 && length ) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn type === \"array\" || length === 0 ||\r\n\t\ttypeof length === \"number\" && length > 0 && ( length - 1 ) in obj;\r\n}\r\nvar Sizzle =\r\n/*!\r\n * Sizzle CSS Selector Engine v1.10.19\r\n * http://sizzlejs.com/\r\n *\r\n * Copyright 2013 jQuery Foundation, Inc. and other contributors\r\n * Released under the MIT license\r\n * http://jquery.org/license\r\n *\r\n * Date: 2014-04-18\r\n */\r\n(function( window ) {\r\n\r\nvar i,\r\n\tsupport,\r\n\tExpr,\r\n\tgetText,\r\n\tisXML,\r\n\ttokenize,\r\n\tcompile,\r\n\tselect,\r\n\toutermostContext,\r\n\tsortInput,\r\n\thasDuplicate,\r\n\r\n\t// Local document vars\r\n\tsetDocument,\r\n\tdocument,\r\n\tdocElem,\r\n\tdocumentIsHTML,\r\n\trbuggyQSA,\r\n\trbuggyMatches,\r\n\tmatches,\r\n\tcontains,\r\n\r\n\t// Instance-specific data\r\n\texpando = \"sizzle\" + -(new Date()),\r\n\tpreferredDoc = window.document,\r\n\tdirruns = 0,\r\n\tdone = 0,\r\n\tclassCache = createCache(),\r\n\ttokenCache = createCache(),\r\n\tcompilerCache = createCache(),\r\n\tsortOrder = function( a, b ) {\r\n\t\tif ( a === b ) {\r\n\t\t\thasDuplicate = true;\r\n\t\t}\r\n\t\treturn 0;\r\n\t},\r\n\r\n\t// General-purpose constants\r\n\tstrundefined = typeof undefined,\r\n\tMAX_NEGATIVE = 1 << 31,\r\n\r\n\t// Instance methods\r\n\thasOwn = ({}).hasOwnProperty,\r\n\tarr = [],\r\n\tpop = arr.pop,\r\n\tpush_native = arr.push,\r\n\tpush = arr.push,\r\n\tslice = arr.slice,\r\n\t// Use a stripped-down indexOf if we can't use a native one\r\n\tindexOf = arr.indexOf || function( elem ) {\r\n\t\tvar i = 0,\r\n\t\t\tlen = this.length;\r\n\t\tfor ( ; i < len; i++ ) {\r\n\t\t\tif ( this[i] === elem ) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t},\r\n\r\n\tbooleans = \"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped\",\r\n\r\n\t// Regular expressions\r\n\r\n\t// Whitespace characters http://www.w3.org/TR/css3-selectors/#whitespace\r\n\twhitespace = \"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",\r\n\t// http://www.w3.org/TR/css3-syntax/#characters\r\n\tcharacterEncoding = \"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",\r\n\r\n\t// Loosely modeled on CSS identifier characters\r\n\t// An unquoted value should be a CSS identifier http://www.w3.org/TR/css3-selectors/#attribute-selectors\r\n\t// Proper syntax: http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier\r\n\tidentifier = characterEncoding.replace( \"w\", \"w#\" ),\r\n\r\n\t// Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors\r\n\tattributes = \"\\\\[\" + whitespace + \"*(\" + characterEncoding + \")(?:\" + whitespace +\r\n\t\t// Operator (capture 2)\r\n\t\t\"*([*^$|!~]?=)\" + whitespace +\r\n\t\t// \"Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]\"\r\n\t\t\"*(?:'((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\"|(\" + identifier + \"))|)\" + whitespace +\r\n\t\t\"*\\\\]\",\r\n\r\n\tpseudos = \":(\" + characterEncoding + \")(?:\\\\((\" +\r\n\t\t// To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:\r\n\t\t// 1. quoted (capture 3; capture 4 or capture 5)\r\n\t\t\"('((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\")|\" +\r\n\t\t// 2. simple (capture 6)\r\n\t\t\"((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\" + attributes + \")*)|\" +\r\n\t\t// 3. anything else (capture 2)\r\n\t\t\".*\" +\r\n\t\t\")\\\\)|)\",\r\n\r\n\t// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter\r\n\trtrim = new RegExp( \"^\" + whitespace + \"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\" + whitespace + \"+$\", \"g\" ),\r\n\r\n\trcomma = new RegExp( \"^\" + whitespace + \"*,\" + whitespace + \"*\" ),\r\n\trcombinators = new RegExp( \"^\" + whitespace + \"*([>+~]|\" + whitespace + \")\" + whitespace + \"*\" ),\r\n\r\n\trattributeQuotes = new RegExp( \"=\" + whitespace + \"*([^\\\\]'\\\"]*?)\" + whitespace + \"*\\\\]\", \"g\" ),\r\n\r\n\trpseudo = new RegExp( pseudos ),\r\n\tridentifier = new RegExp( \"^\" + identifier + \"$\" ),\r\n\r\n\tmatchExpr = {\r\n\t\t\"ID\": new RegExp( \"^#(\" + characterEncoding + \")\" ),\r\n\t\t\"CLASS\": new RegExp( \"^\\\\.(\" + characterEncoding + \")\" ),\r\n\t\t\"TAG\": new RegExp( \"^(\" + characterEncoding.replace( \"w\", \"w*\" ) + \")\" ),\r\n\t\t\"ATTR\": new RegExp( \"^\" + attributes ),\r\n\t\t\"PSEUDO\": new RegExp( \"^\" + pseudos ),\r\n\t\t\"CHILD\": new RegExp( \"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\" + whitespace +\r\n\t\t\t\"*(even|odd|(([+-]|)(\\\\d*)n|)\" + whitespace + \"*(?:([+-]|)\" + whitespace +\r\n\t\t\t\"*(\\\\d+)|))\" + whitespace + \"*\\\\)|)\", \"i\" ),\r\n\t\t\"bool\": new RegExp( \"^(?:\" + booleans + \")$\", \"i\" ),\r\n\t\t// For use in libraries implementing .is()\r\n\t\t// We use this for POS matching in `select`\r\n\t\t\"needsContext\": new RegExp( \"^\" + whitespace + \"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\" +\r\n\t\t\twhitespace + \"*((?:-\\\\d)?\\\\d*)\" + whitespace + \"*\\\\)|)(?=[^-]|$)\", \"i\" )\r\n\t},\r\n\r\n\trinputs = /^(?:input|select|textarea|button)$/i,\r\n\trheader = /^h\\d$/i,\r\n\r\n\trnative = /^[^{]+\\{\\s*\\[native \\w/,\r\n\r\n\t// Easily-parseable/retrievable ID or TAG or CLASS selectors\r\n\trquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\r\n\r\n\trsibling = /[+~]/,\r\n\trescape = /'|\\\\/g,\r\n\r\n\t// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters\r\n\trunescape = new RegExp( \"\\\\\\\\([\\\\da-f]{1,6}\" + whitespace + \"?|(\" + whitespace + \")|.)\", \"ig\" ),\r\n\tfunescape = function( _, escaped, escapedWhitespace ) {\r\n\t\tvar high = \"0x\" + escaped - 0x10000;\r\n\t\t// NaN means non-codepoint\r\n\t\t// Support: Firefox<24\r\n\t\t// Workaround erroneous numeric interpretation of +\"0x\"\r\n\t\treturn high !== high || escapedWhitespace ?\r\n\t\t\tescaped :\r\n\t\t\thigh < 0 ?\r\n\t\t\t\t// BMP codepoint\r\n\t\t\t\tString.fromCharCode( high + 0x10000 ) :\r\n\t\t\t\t// Supplemental Plane codepoint (surrogate pair)\r\n\t\t\t\tString.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );\r\n\t};\r\n\r\n// Optimize for push.apply( _, NodeList )\r\ntry {\r\n\tpush.apply(\r\n\t\t(arr = slice.call( preferredDoc.childNodes )),\r\n\t\tpreferredDoc.childNodes\r\n\t);\r\n\t// Support: Android<4.0\r\n\t// Detect silently failing push.apply\r\n\tarr[ preferredDoc.childNodes.length ].nodeType;\r\n} catch ( e ) {\r\n\tpush = { apply: arr.length ?\r\n\r\n\t\t// Leverage slice if possible\r\n\t\tfunction( target, els ) {\r\n\t\t\tpush_native.apply( target, slice.call(els) );\r\n\t\t} :\r\n\r\n\t\t// Support: IE<9\r\n\t\t// Otherwise append directly\r\n\t\tfunction( target, els ) {\r\n\t\t\tvar j = target.length,\r\n\t\t\t\ti = 0;\r\n\t\t\t// Can't trust NodeList.length\r\n\t\t\twhile ( (target[j++] = els[i++]) ) {}\r\n\t\t\ttarget.length = j - 1;\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction Sizzle( selector, context, results, seed ) {\r\n\tvar match, elem, m, nodeType,\r\n\t\t// QSA vars\r\n\t\ti, groups, old, nid, newContext, newSelector;\r\n\r\n\tif ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {\r\n\t\tsetDocument( context );\r\n\t}\r\n\r\n\tcontext = context || document;\r\n\tresults = results || [];\r\n\r\n\tif ( !selector || typeof selector !== \"string\" ) {\r\n\t\treturn results;\r\n\t}\r\n\r\n\tif ( (nodeType = context.nodeType) !== 1 && nodeType !== 9 ) {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tif ( documentIsHTML && !seed ) {\r\n\r\n\t\t// Shortcuts\r\n\t\tif ( (match = rquickExpr.exec( selector )) ) {\r\n\t\t\t// Speed-up: Sizzle(\"#ID\")\r\n\t\t\tif ( (m = match[1]) ) {\r\n\t\t\t\tif ( nodeType === 9 ) {\r\n\t\t\t\t\telem = context.getElementById( m );\r\n\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\r\n\t\t\t\t\t// nodes that are no longer in the document (jQuery #6963)\r\n\t\t\t\t\tif ( elem && elem.parentNode ) {\r\n\t\t\t\t\t\t// Handle the case where IE, Opera, and Webkit return items\r\n\t\t\t\t\t\t// by name instead of ID\r\n\t\t\t\t\t\tif ( elem.id === m ) {\r\n\t\t\t\t\t\t\tresults.push( elem );\r\n\t\t\t\t\t\t\treturn results;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn results;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Context is not a document\r\n\t\t\t\t\tif ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&\r\n\t\t\t\t\t\tcontains( context, elem ) && elem.id === m ) {\r\n\t\t\t\t\t\tresults.push( elem );\r\n\t\t\t\t\t\treturn results;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t// Speed-up: Sizzle(\"TAG\")\r\n\t\t\t} else if ( match[2] ) {\r\n\t\t\t\tpush.apply( results, context.getElementsByTagName( selector ) );\r\n\t\t\t\treturn results;\r\n\r\n\t\t\t// Speed-up: Sizzle(\".CLASS\")\r\n\t\t\t} else if ( (m = match[3]) && support.getElementsByClassName && context.getElementsByClassName ) {\r\n\t\t\t\tpush.apply( results, context.getElementsByClassName( m ) );\r\n\t\t\t\treturn results;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// QSA path\r\n\t\tif ( support.qsa && (!rbuggyQSA || !rbuggyQSA.test( selector )) ) {\r\n\t\t\tnid = old = expando;\r\n\t\t\tnewContext = context;\r\n\t\t\tnewSelector = nodeType === 9 && selector;\r\n\r\n\t\t\t// qSA works strangely on Element-rooted queries\r\n\t\t\t// We can work around this by specifying an extra ID on the root\r\n\t\t\t// and working up from there (Thanks to Andrew Dupont for the technique)\r\n\t\t\t// IE 8 doesn't work on object elements\r\n\t\t\tif ( nodeType === 1 && context.nodeName.toLowerCase() !== \"object\" ) {\r\n\t\t\t\tgroups = tokenize( selector );\r\n\r\n\t\t\t\tif ( (old = context.getAttribute(\"id\")) ) {\r\n\t\t\t\t\tnid = old.replace( rescape, \"\\\\$&\" );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcontext.setAttribute( \"id\", nid );\r\n\t\t\t\t}\r\n\t\t\t\tnid = \"[id='\" + nid + \"'] \";\r\n\r\n\t\t\t\ti = groups.length;\r\n\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\tgroups[i] = nid + toSelector( groups[i] );\r\n\t\t\t\t}\r\n\t\t\t\tnewContext = rsibling.test( selector ) && testContext( context.parentNode ) || context;\r\n\t\t\t\tnewSelector = groups.join(\",\");\r\n\t\t\t}\r\n\r\n\t\t\tif ( newSelector ) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tpush.apply( results,\r\n\t\t\t\t\t\tnewContext.querySelectorAll( newSelector )\r\n\t\t\t\t\t);\r\n\t\t\t\t\treturn results;\r\n\t\t\t\t} catch(qsaError) {\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tif ( !old ) {\r\n\t\t\t\t\t\tcontext.removeAttribute(\"id\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// All others\r\n\treturn select( selector.replace( rtrim, \"$1\" ), context, results, seed );\r\n}\r\n\r\n/**\r\n * Create key-value caches of limited size\r\n * @returns {Function(string, Object)} Returns the Object data after storing it on itself with\r\n *\tproperty name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)\r\n *\tdeleting the oldest entry\r\n */\r\nfunction createCache() {\r\n\tvar keys = [];\r\n\r\n\tfunction cache( key, value ) {\r\n\t\t// Use (key + \" \") to avoid collision with native prototype properties (see Issue #157)\r\n\t\tif ( keys.push( key + \" \" ) > Expr.cacheLength ) {\r\n\t\t\t// Only keep the most recent entries\r\n\t\t\tdelete cache[ keys.shift() ];\r\n\t\t}\r\n\t\treturn (cache[ key + \" \" ] = value);\r\n\t}\r\n\treturn cache;\r\n}\r\n\r\n/**\r\n * Mark a function for special use by Sizzle\r\n * @param {Function} fn The function to mark\r\n */\r\nfunction markFunction( fn ) {\r\n\tfn[ expando ] = true;\r\n\treturn fn;\r\n}\r\n\r\n/**\r\n * Support testing using an element\r\n * @param {Function} fn Passed the created div and expects a boolean result\r\n */\r\nfunction assert( fn ) {\r\n\tvar div = document.createElement(\"div\");\r\n\r\n\ttry {\r\n\t\treturn !!fn( div );\r\n\t} catch (e) {\r\n\t\treturn false;\r\n\t} finally {\r\n\t\t// Remove from its parent by default\r\n\t\tif ( div.parentNode ) {\r\n\t\t\tdiv.parentNode.removeChild( div );\r\n\t\t}\r\n\t\t// release memory in IE\r\n\t\tdiv = null;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds the same handler for all of the specified attrs\r\n * @param {String} attrs Pipe-separated list of attributes\r\n * @param {Function} handler The method that will be applied\r\n */\r\nfunction addHandle( attrs, handler ) {\r\n\tvar arr = attrs.split(\"|\"),\r\n\t\ti = attrs.length;\r\n\r\n\twhile ( i-- ) {\r\n\t\tExpr.attrHandle[ arr[i] ] = handler;\r\n\t}\r\n}\r\n\r\n/**\r\n * Checks document order of two siblings\r\n * @param {Element} a\r\n * @param {Element} b\r\n * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b\r\n */\r\nfunction siblingCheck( a, b ) {\r\n\tvar cur = b && a,\r\n\t\tdiff = cur && a.nodeType === 1 && b.nodeType === 1 &&\r\n\t\t\t( ~b.sourceIndex || MAX_NEGATIVE ) -\r\n\t\t\t( ~a.sourceIndex || MAX_NEGATIVE );\r\n\r\n\t// Use IE sourceIndex if available on both nodes\r\n\tif ( diff ) {\r\n\t\treturn diff;\r\n\t}\r\n\r\n\t// Check if b follows a\r\n\tif ( cur ) {\r\n\t\twhile ( (cur = cur.nextSibling) ) {\r\n\t\t\tif ( cur === b ) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn a ? 1 : -1;\r\n}\r\n\r\n/**\r\n * Returns a function to use in pseudos for input types\r\n * @param {String} type\r\n */\r\nfunction createInputPseudo( type ) {\r\n\treturn function( elem ) {\r\n\t\tvar name = elem.nodeName.toLowerCase();\r\n\t\treturn name === \"input\" && elem.type === type;\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns a function to use in pseudos for buttons\r\n * @param {String} type\r\n */\r\nfunction createButtonPseudo( type ) {\r\n\treturn function( elem ) {\r\n\t\tvar name = elem.nodeName.toLowerCase();\r\n\t\treturn (name === \"input\" || name === \"button\") && elem.type === type;\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns a function to use in pseudos for positionals\r\n * @param {Function} fn\r\n */\r\nfunction createPositionalPseudo( fn ) {\r\n\treturn markFunction(function( argument ) {\r\n\t\targument = +argument;\r\n\t\treturn markFunction(function( seed, matches ) {\r\n\t\t\tvar j,\r\n\t\t\t\tmatchIndexes = fn( [], seed.length, argument ),\r\n\t\t\t\ti = matchIndexes.length;\r\n\r\n\t\t\t// Match elements found at the specified indexes\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tif ( seed[ (j = matchIndexes[i]) ] ) {\r\n\t\t\t\t\tseed[j] = !(matches[j] = seed[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\n/**\r\n * Checks a node for validity as a Sizzle context\r\n * @param {Element|Object=} context\r\n * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value\r\n */\r\nfunction testContext( context ) {\r\n\treturn context && typeof context.getElementsByTagName !== strundefined && context;\r\n}\r\n\r\n// Expose support vars for convenience\r\nsupport = Sizzle.support = {};\r\n\r\n/**\r\n * Detects XML nodes\r\n * @param {Element|Object} elem An element or a document\r\n * @returns {Boolean} True iff elem is a non-HTML XML node\r\n */\r\nisXML = Sizzle.isXML = function( elem ) {\r\n\t// documentElement is verified for cases where it doesn't yet exist\r\n\t// (such as loading iframes in IE - #4833)\r\n\tvar documentElement = elem && (elem.ownerDocument || elem).documentElement;\r\n\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\r\n};\r\n\r\n/**\r\n * Sets document-related variables once based on the current document\r\n * @param {Element|Object} [doc] An element or document object to use to set the document\r\n * @returns {Object} Returns the current document\r\n */\r\nsetDocument = Sizzle.setDocument = function( node ) {\r\n\tvar hasCompare,\r\n\t\tdoc = node ? node.ownerDocument || node : preferredDoc,\r\n\t\tparent = doc.defaultView;\r\n\r\n\t// If no document and documentElement is available, return\r\n\tif ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {\r\n\t\treturn document;\r\n\t}\r\n\r\n\t// Set our document\r\n\tdocument = doc;\r\n\tdocElem = doc.documentElement;\r\n\r\n\t// Support tests\r\n\tdocumentIsHTML = !isXML( doc );\r\n\r\n\t// Support: IE>8\r\n\t// If iframe document is assigned to \"document\" variable and if iframe has been reloaded,\r\n\t// IE will throw \"permission denied\" error when accessing \"document\" variable, see jQuery #13936\r\n\t// IE6-8 do not support the defaultView property so parent will be undefined\r\n\tif ( parent && parent !== parent.top ) {\r\n\t\t// IE11 does not have attachEvent, so all must suffer\r\n\t\tif ( parent.addEventListener ) {\r\n\t\t\tparent.addEventListener( \"unload\", function() {\r\n\t\t\t\tsetDocument();\r\n\t\t\t}, false );\r\n\t\t} else if ( parent.attachEvent ) {\r\n\t\t\tparent.attachEvent( \"onunload\", function() {\r\n\t\t\t\tsetDocument();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/* Attributes\r\n\t---------------------------------------------------------------------- */\r\n\r\n\t// Support: IE<8\r\n\t// Verify that getAttribute really returns attributes and not properties (excepting IE8 booleans)\r\n\tsupport.attributes = assert(function( div ) {\r\n\t\tdiv.className = \"i\";\r\n\t\treturn !div.getAttribute(\"className\");\r\n\t});\r\n\r\n\t/* getElement(s)By*\r\n\t---------------------------------------------------------------------- */\r\n\r\n\t// Check if getElementsByTagName(\"*\") returns only elements\r\n\tsupport.getElementsByTagName = assert(function( div ) {\r\n\t\tdiv.appendChild( doc.createComment(\"\") );\r\n\t\treturn !div.getElementsByTagName(\"*\").length;\r\n\t});\r\n\r\n\t// Check if getElementsByClassName can be trusted\r\n\tsupport.getElementsByClassName = rnative.test( doc.getElementsByClassName ) && assert(function( div ) {\r\n\t\tdiv.innerHTML = \"<div class='a'></div><div class='a i'></div>\";\r\n\r\n\t\t// Support: Safari<4\r\n\t\t// Catch class over-caching\r\n\t\tdiv.firstChild.className = \"i\";\r\n\t\t// Support: Opera<10\r\n\t\t// Catch gEBCN failure to find non-leading classes\r\n\t\treturn div.getElementsByClassName(\"i\").length === 2;\r\n\t});\r\n\r\n\t// Support: IE<10\r\n\t// Check if getElementById returns elements by name\r\n\t// The broken getElementById methods don't pick up programatically-set names,\r\n\t// so use a roundabout getElementsByName test\r\n\tsupport.getById = assert(function( div ) {\r\n\t\tdocElem.appendChild( div ).id = expando;\r\n\t\treturn !doc.getElementsByName || !doc.getElementsByName( expando ).length;\r\n\t});\r\n\r\n\t// ID find and filter\r\n\tif ( support.getById ) {\r\n\t\tExpr.find[\"ID\"] = function( id, context ) {\r\n\t\t\tif ( typeof context.getElementById !== strundefined && documentIsHTML ) {\r\n\t\t\t\tvar m = context.getElementById( id );\r\n\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\r\n\t\t\t\t// nodes that are no longer in the document #6963\r\n\t\t\t\treturn m && m.parentNode ? [ m ] : [];\r\n\t\t\t}\r\n\t\t};\r\n\t\tExpr.filter[\"ID\"] = function( id ) {\r\n\t\t\tvar attrId = id.replace( runescape, funescape );\r\n\t\t\treturn function( elem ) {\r\n\t\t\t\treturn elem.getAttribute(\"id\") === attrId;\r\n\t\t\t};\r\n\t\t};\r\n\t} else {\r\n\t\t// Support: IE6/7\r\n\t\t// getElementById is not reliable as a find shortcut\r\n\t\tdelete Expr.find[\"ID\"];\r\n\r\n\t\tExpr.filter[\"ID\"] =  function( id ) {\r\n\t\t\tvar attrId = id.replace( runescape, funescape );\r\n\t\t\treturn function( elem ) {\r\n\t\t\t\tvar node = typeof elem.getAttributeNode !== strundefined && elem.getAttributeNode(\"id\");\r\n\t\t\t\treturn node && node.value === attrId;\r\n\t\t\t};\r\n\t\t};\r\n\t}\r\n\r\n\t// Tag\r\n\tExpr.find[\"TAG\"] = support.getElementsByTagName ?\r\n\t\tfunction( tag, context ) {\r\n\t\t\tif ( typeof context.getElementsByTagName !== strundefined ) {\r\n\t\t\t\treturn context.getElementsByTagName( tag );\r\n\t\t\t}\r\n\t\t} :\r\n\t\tfunction( tag, context ) {\r\n\t\t\tvar elem,\r\n\t\t\t\ttmp = [],\r\n\t\t\t\ti = 0,\r\n\t\t\t\tresults = context.getElementsByTagName( tag );\r\n\r\n\t\t\t// Filter out possible comments\r\n\t\t\tif ( tag === \"*\" ) {\r\n\t\t\t\twhile ( (elem = results[i++]) ) {\r\n\t\t\t\t\tif ( elem.nodeType === 1 ) {\r\n\t\t\t\t\t\ttmp.push( elem );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn tmp;\r\n\t\t\t}\r\n\t\t\treturn results;\r\n\t\t};\r\n\r\n\t// Class\r\n\tExpr.find[\"CLASS\"] = support.getElementsByClassName && function( className, context ) {\r\n\t\tif ( typeof context.getElementsByClassName !== strundefined && documentIsHTML ) {\r\n\t\t\treturn context.getElementsByClassName( className );\r\n\t\t}\r\n\t};\r\n\r\n\t/* QSA/matchesSelector\r\n\t---------------------------------------------------------------------- */\r\n\r\n\t// QSA and matchesSelector support\r\n\r\n\t// matchesSelector(:active) reports false when true (IE9/Opera 11.5)\r\n\trbuggyMatches = [];\r\n\r\n\t// qSa(:focus) reports false when true (Chrome 21)\r\n\t// We allow this because of a bug in IE8/9 that throws an error\r\n\t// whenever `document.activeElement` is accessed on an iframe\r\n\t// So, we allow :focus to pass through QSA all the time to avoid the IE error\r\n\t// See http://bugs.jquery.com/ticket/13378\r\n\trbuggyQSA = [];\r\n\r\n\tif ( (support.qsa = rnative.test( doc.querySelectorAll )) ) {\r\n\t\t// Build QSA regex\r\n\t\t// Regex strategy adopted from Diego Perini\r\n\t\tassert(function( div ) {\r\n\t\t\t// Select is set to empty string on purpose\r\n\t\t\t// This is to test IE's treatment of not explicitly\r\n\t\t\t// setting a boolean content attribute,\r\n\t\t\t// since its presence should be enough\r\n\t\t\t// http://bugs.jquery.com/ticket/12359\r\n\t\t\tdiv.innerHTML = \"<select msallowclip=''><option selected=''></option></select>\";\r\n\r\n\t\t\t// Support: IE8, Opera 11-12.16\r\n\t\t\t// Nothing should be selected when empty strings follow ^= or $= or *=\r\n\t\t\t// The test attribute must be unknown in Opera but \"safe\" for WinRT\r\n\t\t\t// http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section\r\n\t\t\tif ( div.querySelectorAll(\"[msallowclip^='']\").length ) {\r\n\t\t\t\trbuggyQSA.push( \"[*^$]=\" + whitespace + \"*(?:''|\\\"\\\")\" );\r\n\t\t\t}\r\n\r\n\t\t\t// Support: IE8\r\n\t\t\t// Boolean attributes and \"value\" are not treated correctly\r\n\t\t\tif ( !div.querySelectorAll(\"[selected]\").length ) {\r\n\t\t\t\trbuggyQSA.push( \"\\\\[\" + whitespace + \"*(?:value|\" + booleans + \")\" );\r\n\t\t\t}\r\n\r\n\t\t\t// Webkit/Opera - :checked should return selected option elements\r\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\r\n\t\t\t// IE8 throws error here and will not see later tests\r\n\t\t\tif ( !div.querySelectorAll(\":checked\").length ) {\r\n\t\t\t\trbuggyQSA.push(\":checked\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tassert(function( div ) {\r\n\t\t\t// Support: Windows 8 Native Apps\r\n\t\t\t// The type and name attributes are restricted during .innerHTML assignment\r\n\t\t\tvar input = doc.createElement(\"input\");\r\n\t\t\tinput.setAttribute( \"type\", \"hidden\" );\r\n\t\t\tdiv.appendChild( input ).setAttribute( \"name\", \"D\" );\r\n\r\n\t\t\t// Support: IE8\r\n\t\t\t// Enforce case-sensitivity of name attribute\r\n\t\t\tif ( div.querySelectorAll(\"[name=d]\").length ) {\r\n\t\t\t\trbuggyQSA.push( \"name\" + whitespace + \"*[*^$|!~]?=\" );\r\n\t\t\t}\r\n\r\n\t\t\t// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)\r\n\t\t\t// IE8 throws error here and will not see later tests\r\n\t\t\tif ( !div.querySelectorAll(\":enabled\").length ) {\r\n\t\t\t\trbuggyQSA.push( \":enabled\", \":disabled\" );\r\n\t\t\t}\r\n\r\n\t\t\t// Opera 10-11 does not throw on post-comma invalid pseudos\r\n\t\t\tdiv.querySelectorAll(\"*,:x\");\r\n\t\t\trbuggyQSA.push(\",.*:\");\r\n\t\t});\r\n\t}\r\n\r\n\tif ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||\r\n\t\tdocElem.webkitMatchesSelector ||\r\n\t\tdocElem.mozMatchesSelector ||\r\n\t\tdocElem.oMatchesSelector ||\r\n\t\tdocElem.msMatchesSelector) )) ) {\r\n\r\n\t\tassert(function( div ) {\r\n\t\t\t// Check to see if it's possible to do matchesSelector\r\n\t\t\t// on a disconnected node (IE 9)\r\n\t\t\tsupport.disconnectedMatch = matches.call( div, \"div\" );\r\n\r\n\t\t\t// This should fail with an exception\r\n\t\t\t// Gecko does not error, returns false instead\r\n\t\t\tmatches.call( div, \"[s!='']:x\" );\r\n\t\t\trbuggyMatches.push( \"!=\", pseudos );\r\n\t\t});\r\n\t}\r\n\r\n\trbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join(\"|\") );\r\n\trbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join(\"|\") );\r\n\r\n\t/* Contains\r\n\t---------------------------------------------------------------------- */\r\n\thasCompare = rnative.test( docElem.compareDocumentPosition );\r\n\r\n\t// Element contains another\r\n\t// Purposefully does not implement inclusive descendent\r\n\t// As in, an element does not contain itself\r\n\tcontains = hasCompare || rnative.test( docElem.contains ) ?\r\n\t\tfunction( a, b ) {\r\n\t\t\tvar adown = a.nodeType === 9 ? a.documentElement : a,\r\n\t\t\t\tbup = b && b.parentNode;\r\n\t\t\treturn a === bup || !!( bup && bup.nodeType === 1 && (\r\n\t\t\t\tadown.contains ?\r\n\t\t\t\t\tadown.contains( bup ) :\r\n\t\t\t\t\ta.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16\r\n\t\t\t));\r\n\t\t} :\r\n\t\tfunction( a, b ) {\r\n\t\t\tif ( b ) {\r\n\t\t\t\twhile ( (b = b.parentNode) ) {\r\n\t\t\t\t\tif ( b === a ) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t/* Sorting\r\n\t---------------------------------------------------------------------- */\r\n\r\n\t// Document order sorting\r\n\tsortOrder = hasCompare ?\r\n\tfunction( a, b ) {\r\n\r\n\t\t// Flag for duplicate removal\r\n\t\tif ( a === b ) {\r\n\t\t\thasDuplicate = true;\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t// Sort on method existence if only one input has compareDocumentPosition\r\n\t\tvar compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\r\n\t\tif ( compare ) {\r\n\t\t\treturn compare;\r\n\t\t}\r\n\r\n\t\t// Calculate position if both inputs belong to the same document\r\n\t\tcompare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?\r\n\t\t\ta.compareDocumentPosition( b ) :\r\n\r\n\t\t\t// Otherwise we know they are disconnected\r\n\t\t\t1;\r\n\r\n\t\t// Disconnected nodes\r\n\t\tif ( compare & 1 ||\r\n\t\t\t(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {\r\n\r\n\t\t\t// Choose the first element that is related to our preferred document\r\n\t\t\tif ( a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tif ( b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\t// Maintain original order\r\n\t\t\treturn sortInput ?\r\n\t\t\t\t( indexOf.call( sortInput, a ) - indexOf.call( sortInput, b ) ) :\r\n\t\t\t\t0;\r\n\t\t}\r\n\r\n\t\treturn compare & 4 ? -1 : 1;\r\n\t} :\r\n\tfunction( a, b ) {\r\n\t\t// Exit early if the nodes are identical\r\n\t\tif ( a === b ) {\r\n\t\t\thasDuplicate = true;\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tvar cur,\r\n\t\t\ti = 0,\r\n\t\t\taup = a.parentNode,\r\n\t\t\tbup = b.parentNode,\r\n\t\t\tap = [ a ],\r\n\t\t\tbp = [ b ];\r\n\r\n\t\t// Parentless nodes are either documents or disconnected\r\n\t\tif ( !aup || !bup ) {\r\n\t\t\treturn a === doc ? -1 :\r\n\t\t\t\tb === doc ? 1 :\r\n\t\t\t\taup ? -1 :\r\n\t\t\t\tbup ? 1 :\r\n\t\t\t\tsortInput ?\r\n\t\t\t\t( indexOf.call( sortInput, a ) - indexOf.call( sortInput, b ) ) :\r\n\t\t\t\t0;\r\n\r\n\t\t// If the nodes are siblings, we can do a quick check\r\n\t\t} else if ( aup === bup ) {\r\n\t\t\treturn siblingCheck( a, b );\r\n\t\t}\r\n\r\n\t\t// Otherwise we need full lists of their ancestors for comparison\r\n\t\tcur = a;\r\n\t\twhile ( (cur = cur.parentNode) ) {\r\n\t\t\tap.unshift( cur );\r\n\t\t}\r\n\t\tcur = b;\r\n\t\twhile ( (cur = cur.parentNode) ) {\r\n\t\t\tbp.unshift( cur );\r\n\t\t}\r\n\r\n\t\t// Walk down the tree looking for a discrepancy\r\n\t\twhile ( ap[i] === bp[i] ) {\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\treturn i ?\r\n\t\t\t// Do a sibling check if the nodes have a common ancestor\r\n\t\t\tsiblingCheck( ap[i], bp[i] ) :\r\n\r\n\t\t\t// Otherwise nodes in our document sort first\r\n\t\t\tap[i] === preferredDoc ? -1 :\r\n\t\t\tbp[i] === preferredDoc ? 1 :\r\n\t\t\t0;\r\n\t};\r\n\r\n\treturn doc;\r\n};\r\n\r\nSizzle.matches = function( expr, elements ) {\r\n\treturn Sizzle( expr, null, null, elements );\r\n};\r\n\r\nSizzle.matchesSelector = function( elem, expr ) {\r\n\t// Set document vars if needed\r\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\r\n\t\tsetDocument( elem );\r\n\t}\r\n\r\n\t// Make sure that attribute selectors are quoted\r\n\texpr = expr.replace( rattributeQuotes, \"='$1']\" );\r\n\r\n\tif ( support.matchesSelector && documentIsHTML &&\r\n\t\t( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&\r\n\t\t( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {\r\n\r\n\t\ttry {\r\n\t\t\tvar ret = matches.call( elem, expr );\r\n\r\n\t\t\t// IE 9's matchesSelector returns false on disconnected nodes\r\n\t\t\tif ( ret || support.disconnectedMatch ||\r\n\t\t\t\t\t// As well, disconnected nodes are said to be in a document\r\n\t\t\t\t\t// fragment in IE 9\r\n\t\t\t\t\telem.document && elem.document.nodeType !== 11 ) {\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n\t\t} catch(e) {}\r\n\t}\r\n\r\n\treturn Sizzle( expr, document, null, [ elem ] ).length > 0;\r\n};\r\n\r\nSizzle.contains = function( context, elem ) {\r\n\t// Set document vars if needed\r\n\tif ( ( context.ownerDocument || context ) !== document ) {\r\n\t\tsetDocument( context );\r\n\t}\r\n\treturn contains( context, elem );\r\n};\r\n\r\nSizzle.attr = function( elem, name ) {\r\n\t// Set document vars if needed\r\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\r\n\t\tsetDocument( elem );\r\n\t}\r\n\r\n\tvar fn = Expr.attrHandle[ name.toLowerCase() ],\r\n\t\t// Don't get fooled by Object.prototype properties (jQuery #13807)\r\n\t\tval = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?\r\n\t\t\tfn( elem, name, !documentIsHTML ) :\r\n\t\t\tundefined;\r\n\r\n\treturn val !== undefined ?\r\n\t\tval :\r\n\t\tsupport.attributes || !documentIsHTML ?\r\n\t\t\telem.getAttribute( name ) :\r\n\t\t\t(val = elem.getAttributeNode(name)) && val.specified ?\r\n\t\t\t\tval.value :\r\n\t\t\t\tnull;\r\n};\r\n\r\nSizzle.error = function( msg ) {\r\n\tthrow new Error( \"Syntax error, unrecognized expression: \" + msg );\r\n};\r\n\r\n/**\r\n * Document sorting and removing duplicates\r\n * @param {ArrayLike} results\r\n */\r\nSizzle.uniqueSort = function( results ) {\r\n\tvar elem,\r\n\t\tduplicates = [],\r\n\t\tj = 0,\r\n\t\ti = 0;\r\n\r\n\t// Unless we *know* we can detect duplicates, assume their presence\r\n\thasDuplicate = !support.detectDuplicates;\r\n\tsortInput = !support.sortStable && results.slice( 0 );\r\n\tresults.sort( sortOrder );\r\n\r\n\tif ( hasDuplicate ) {\r\n\t\twhile ( (elem = results[i++]) ) {\r\n\t\t\tif ( elem === results[ i ] ) {\r\n\t\t\t\tj = duplicates.push( i );\r\n\t\t\t}\r\n\t\t}\r\n\t\twhile ( j-- ) {\r\n\t\t\tresults.splice( duplicates[ j ], 1 );\r\n\t\t}\r\n\t}\r\n\r\n\t// Clear input after sorting to release objects\r\n\t// See https://github.com/jquery/sizzle/pull/225\r\n\tsortInput = null;\r\n\r\n\treturn results;\r\n};\r\n\r\n/**\r\n * Utility function for retrieving the text value of an array of DOM nodes\r\n * @param {Array|Element} elem\r\n */\r\ngetText = Sizzle.getText = function( elem ) {\r\n\tvar node,\r\n\t\tret = \"\",\r\n\t\ti = 0,\r\n\t\tnodeType = elem.nodeType;\r\n\r\n\tif ( !nodeType ) {\r\n\t\t// If no nodeType, this is expected to be an array\r\n\t\twhile ( (node = elem[i++]) ) {\r\n\t\t\t// Do not traverse comment nodes\r\n\t\t\tret += getText( node );\r\n\t\t}\r\n\t} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\r\n\t\t// Use textContent for elements\r\n\t\t// innerText usage removed for consistency of new lines (jQuery #11153)\r\n\t\tif ( typeof elem.textContent === \"string\" ) {\r\n\t\t\treturn elem.textContent;\r\n\t\t} else {\r\n\t\t\t// Traverse its children\r\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\r\n\t\t\t\tret += getText( elem );\r\n\t\t\t}\r\n\t\t}\r\n\t} else if ( nodeType === 3 || nodeType === 4 ) {\r\n\t\treturn elem.nodeValue;\r\n\t}\r\n\t// Do not include comment or processing instruction nodes\r\n\r\n\treturn ret;\r\n};\r\n\r\nExpr = Sizzle.selectors = {\r\n\r\n\t// Can be adjusted by the user\r\n\tcacheLength: 50,\r\n\r\n\tcreatePseudo: markFunction,\r\n\r\n\tmatch: matchExpr,\r\n\r\n\tattrHandle: {},\r\n\r\n\tfind: {},\r\n\r\n\trelative: {\r\n\t\t\">\": { dir: \"parentNode\", first: true },\r\n\t\t\" \": { dir: \"parentNode\" },\r\n\t\t\"+\": { dir: \"previousSibling\", first: true },\r\n\t\t\"~\": { dir: \"previousSibling\" }\r\n\t},\r\n\r\n\tpreFilter: {\r\n\t\t\"ATTR\": function( match ) {\r\n\t\t\tmatch[1] = match[1].replace( runescape, funescape );\r\n\r\n\t\t\t// Move the given value to match[3] whether quoted or unquoted\r\n\t\t\tmatch[3] = ( match[3] || match[4] || match[5] || \"\" ).replace( runescape, funescape );\r\n\r\n\t\t\tif ( match[2] === \"~=\" ) {\r\n\t\t\t\tmatch[3] = \" \" + match[3] + \" \";\r\n\t\t\t}\r\n\r\n\t\t\treturn match.slice( 0, 4 );\r\n\t\t},\r\n\r\n\t\t\"CHILD\": function( match ) {\r\n\t\t\t/* matches from matchExpr[\"CHILD\"]\r\n\t\t\t\t1 type (only|nth|...)\r\n\t\t\t\t2 what (child|of-type)\r\n\t\t\t\t3 argument (even|odd|\\d*|\\d*n([+-]\\d+)?|...)\r\n\t\t\t\t4 xn-component of xn+y argument ([+-]?\\d*n|)\r\n\t\t\t\t5 sign of xn-component\r\n\t\t\t\t6 x of xn-component\r\n\t\t\t\t7 sign of y-component\r\n\t\t\t\t8 y of y-component\r\n\t\t\t*/\r\n\t\t\tmatch[1] = match[1].toLowerCase();\r\n\r\n\t\t\tif ( match[1].slice( 0, 3 ) === \"nth\" ) {\r\n\t\t\t\t// nth-* requires argument\r\n\t\t\t\tif ( !match[3] ) {\r\n\t\t\t\t\tSizzle.error( match[0] );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// numeric x and y parameters for Expr.filter.CHILD\r\n\t\t\t\t// remember that false/true cast respectively to 0/1\r\n\t\t\t\tmatch[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === \"even\" || match[3] === \"odd\" ) );\r\n\t\t\t\tmatch[5] = +( ( match[7] + match[8] ) || match[3] === \"odd\" );\r\n\r\n\t\t\t// other types prohibit arguments\r\n\t\t\t} else if ( match[3] ) {\r\n\t\t\t\tSizzle.error( match[0] );\r\n\t\t\t}\r\n\r\n\t\t\treturn match;\r\n\t\t},\r\n\r\n\t\t\"PSEUDO\": function( match ) {\r\n\t\t\tvar excess,\r\n\t\t\t\tunquoted = !match[6] && match[2];\r\n\r\n\t\t\tif ( matchExpr[\"CHILD\"].test( match[0] ) ) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\t// Accept quoted arguments as-is\r\n\t\t\tif ( match[3] ) {\r\n\t\t\t\tmatch[2] = match[4] || match[5] || \"\";\r\n\r\n\t\t\t// Strip excess characters from unquoted arguments\r\n\t\t\t} else if ( unquoted && rpseudo.test( unquoted ) &&\r\n\t\t\t\t// Get excess from tokenize (recursively)\r\n\t\t\t\t(excess = tokenize( unquoted, true )) &&\r\n\t\t\t\t// advance to the next closing parenthesis\r\n\t\t\t\t(excess = unquoted.indexOf( \")\", unquoted.length - excess ) - unquoted.length) ) {\r\n\r\n\t\t\t\t// excess is a negative index\r\n\t\t\t\tmatch[0] = match[0].slice( 0, excess );\r\n\t\t\t\tmatch[2] = unquoted.slice( 0, excess );\r\n\t\t\t}\r\n\r\n\t\t\t// Return only captures needed by the pseudo filter method (type and argument)\r\n\t\t\treturn match.slice( 0, 3 );\r\n\t\t}\r\n\t},\r\n\r\n\tfilter: {\r\n\r\n\t\t\"TAG\": function( nodeNameSelector ) {\r\n\t\t\tvar nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();\r\n\t\t\treturn nodeNameSelector === \"*\" ?\r\n\t\t\t\tfunction() { return true; } :\r\n\t\t\t\tfunction( elem ) {\r\n\t\t\t\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\r\n\t\t\t\t};\r\n\t\t},\r\n\r\n\t\t\"CLASS\": function( className ) {\r\n\t\t\tvar pattern = classCache[ className + \" \" ];\r\n\r\n\t\t\treturn pattern ||\r\n\t\t\t\t(pattern = new RegExp( \"(^|\" + whitespace + \")\" + className + \"(\" + whitespace + \"|$)\" )) &&\r\n\t\t\t\tclassCache( className, function( elem ) {\r\n\t\t\t\t\treturn pattern.test( typeof elem.className === \"string\" && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute(\"class\") || \"\" );\r\n\t\t\t\t});\r\n\t\t},\r\n\r\n\t\t\"ATTR\": function( name, operator, check ) {\r\n\t\t\treturn function( elem ) {\r\n\t\t\t\tvar result = Sizzle.attr( elem, name );\r\n\r\n\t\t\t\tif ( result == null ) {\r\n\t\t\t\t\treturn operator === \"!=\";\r\n\t\t\t\t}\r\n\t\t\t\tif ( !operator ) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresult += \"\";\r\n\r\n\t\t\t\treturn operator === \"=\" ? result === check :\r\n\t\t\t\t\toperator === \"!=\" ? result !== check :\r\n\t\t\t\t\toperator === \"^=\" ? check && result.indexOf( check ) === 0 :\r\n\t\t\t\t\toperator === \"*=\" ? check && result.indexOf( check ) > -1 :\r\n\t\t\t\t\toperator === \"$=\" ? check && result.slice( -check.length ) === check :\r\n\t\t\t\t\toperator === \"~=\" ? ( \" \" + result + \" \" ).indexOf( check ) > -1 :\r\n\t\t\t\t\toperator === \"|=\" ? result === check || result.slice( 0, check.length + 1 ) === check + \"-\" :\r\n\t\t\t\t\tfalse;\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t\"CHILD\": function( type, what, argument, first, last ) {\r\n\t\t\tvar simple = type.slice( 0, 3 ) !== \"nth\",\r\n\t\t\t\tforward = type.slice( -4 ) !== \"last\",\r\n\t\t\t\tofType = what === \"of-type\";\r\n\r\n\t\t\treturn first === 1 && last === 0 ?\r\n\r\n\t\t\t\t// Shortcut for :nth-*(n)\r\n\t\t\t\tfunction( elem ) {\r\n\t\t\t\t\treturn !!elem.parentNode;\r\n\t\t\t\t} :\r\n\r\n\t\t\t\tfunction( elem, context, xml ) {\r\n\t\t\t\t\tvar cache, outerCache, node, diff, nodeIndex, start,\r\n\t\t\t\t\t\tdir = simple !== forward ? \"nextSibling\" : \"previousSibling\",\r\n\t\t\t\t\t\tparent = elem.parentNode,\r\n\t\t\t\t\t\tname = ofType && elem.nodeName.toLowerCase(),\r\n\t\t\t\t\t\tuseCache = !xml && !ofType;\r\n\r\n\t\t\t\t\tif ( parent ) {\r\n\r\n\t\t\t\t\t\t// :(first|last|only)-(child|of-type)\r\n\t\t\t\t\t\tif ( simple ) {\r\n\t\t\t\t\t\t\twhile ( dir ) {\r\n\t\t\t\t\t\t\t\tnode = elem;\r\n\t\t\t\t\t\t\t\twhile ( (node = node[ dir ]) ) {\r\n\t\t\t\t\t\t\t\t\tif ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) {\r\n\t\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// Reverse direction for :only-* (if we haven't yet done so)\r\n\t\t\t\t\t\t\t\tstart = dir = type === \"only\" && !start && \"nextSibling\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tstart = [ forward ? parent.firstChild : parent.lastChild ];\r\n\r\n\t\t\t\t\t\t// non-xml :nth-child(...) stores cache data on `parent`\r\n\t\t\t\t\t\tif ( forward && useCache ) {\r\n\t\t\t\t\t\t\t// Seek `elem` from a previously-cached index\r\n\t\t\t\t\t\t\touterCache = parent[ expando ] || (parent[ expando ] = {});\r\n\t\t\t\t\t\t\tcache = outerCache[ type ] || [];\r\n\t\t\t\t\t\t\tnodeIndex = cache[0] === dirruns && cache[1];\r\n\t\t\t\t\t\t\tdiff = cache[0] === dirruns && cache[2];\r\n\t\t\t\t\t\t\tnode = nodeIndex && parent.childNodes[ nodeIndex ];\r\n\r\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\r\n\r\n\t\t\t\t\t\t\t\t// Fallback to seeking `elem` from the start\r\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\r\n\r\n\t\t\t\t\t\t\t\t// When found, cache indexes on `parent` and break\r\n\t\t\t\t\t\t\t\tif ( node.nodeType === 1 && ++diff && node === elem ) {\r\n\t\t\t\t\t\t\t\t\touterCache[ type ] = [ dirruns, nodeIndex, diff ];\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Use previously-cached element index if available\r\n\t\t\t\t\t\t} else if ( useCache && (cache = (elem[ expando ] || (elem[ expando ] = {}))[ type ]) && cache[0] === dirruns ) {\r\n\t\t\t\t\t\t\tdiff = cache[1];\r\n\r\n\t\t\t\t\t\t// xml :nth-child(...) or :nth-last-child(...) or :nth(-last)?-of-type(...)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Use the same loop as above to seek `elem` from the start\r\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\r\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) && ++diff ) {\r\n\t\t\t\t\t\t\t\t\t// Cache the index of each encountered element\r\n\t\t\t\t\t\t\t\t\tif ( useCache ) {\r\n\t\t\t\t\t\t\t\t\t\t(node[ expando ] || (node[ expando ] = {}))[ type ] = [ dirruns, diff ];\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif ( node === elem ) {\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Incorporate the offset, then check against cycle size\r\n\t\t\t\t\t\tdiff -= last;\r\n\t\t\t\t\t\treturn diff === first || ( diff % first === 0 && diff / first >= 0 );\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t},\r\n\r\n\t\t\"PSEUDO\": function( pseudo, argument ) {\r\n\t\t\t// pseudo-class names are case-insensitive\r\n\t\t\t// http://www.w3.org/TR/selectors/#pseudo-classes\r\n\t\t\t// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters\r\n\t\t\t// Remember that setFilters inherits from pseudos\r\n\t\t\tvar args,\r\n\t\t\t\tfn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||\r\n\t\t\t\t\tSizzle.error( \"unsupported pseudo: \" + pseudo );\r\n\r\n\t\t\t// The user may use createPseudo to indicate that\r\n\t\t\t// arguments are needed to create the filter function\r\n\t\t\t// just as Sizzle does\r\n\t\t\tif ( fn[ expando ] ) {\r\n\t\t\t\treturn fn( argument );\r\n\t\t\t}\r\n\r\n\t\t\t// But maintain support for old signatures\r\n\t\t\tif ( fn.length > 1 ) {\r\n\t\t\t\targs = [ pseudo, pseudo, \"\", argument ];\r\n\t\t\t\treturn Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?\r\n\t\t\t\t\tmarkFunction(function( seed, matches ) {\r\n\t\t\t\t\t\tvar idx,\r\n\t\t\t\t\t\t\tmatched = fn( seed, argument ),\r\n\t\t\t\t\t\t\ti = matched.length;\r\n\t\t\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\t\t\tidx = indexOf.call( seed, matched[i] );\r\n\t\t\t\t\t\t\tseed[ idx ] = !( matches[ idx ] = matched[i] );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}) :\r\n\t\t\t\t\tfunction( elem ) {\r\n\t\t\t\t\t\treturn fn( elem, 0, args );\r\n\t\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\treturn fn;\r\n\t\t}\r\n\t},\r\n\r\n\tpseudos: {\r\n\t\t// Potentially complex pseudos\r\n\t\t\"not\": markFunction(function( selector ) {\r\n\t\t\t// Trim the selector passed to compile\r\n\t\t\t// to avoid treating leading and trailing\r\n\t\t\t// spaces as combinators\r\n\t\t\tvar input = [],\r\n\t\t\t\tresults = [],\r\n\t\t\t\tmatcher = compile( selector.replace( rtrim, \"$1\" ) );\r\n\r\n\t\t\treturn matcher[ expando ] ?\r\n\t\t\t\tmarkFunction(function( seed, matches, context, xml ) {\r\n\t\t\t\t\tvar elem,\r\n\t\t\t\t\t\tunmatched = matcher( seed, null, xml, [] ),\r\n\t\t\t\t\t\ti = seed.length;\r\n\r\n\t\t\t\t\t// Match elements unmatched by `matcher`\r\n\t\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\t\tif ( (elem = unmatched[i]) ) {\r\n\t\t\t\t\t\t\tseed[i] = !(matches[i] = elem);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}) :\r\n\t\t\t\tfunction( elem, context, xml ) {\r\n\t\t\t\t\tinput[0] = elem;\r\n\t\t\t\t\tmatcher( input, null, xml, results );\r\n\t\t\t\t\treturn !results.pop();\r\n\t\t\t\t};\r\n\t\t}),\r\n\r\n\t\t\"has\": markFunction(function( selector ) {\r\n\t\t\treturn function( elem ) {\r\n\t\t\t\treturn Sizzle( selector, elem ).length > 0;\r\n\t\t\t};\r\n\t\t}),\r\n\r\n\t\t\"contains\": markFunction(function( text ) {\r\n\t\t\treturn function( elem ) {\r\n\t\t\t\treturn ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;\r\n\t\t\t};\r\n\t\t}),\r\n\r\n\t\t// \"Whether an element is represented by a :lang() selector\r\n\t\t// is based solely on the element's language value\r\n\t\t// being equal to the identifier C,\r\n\t\t// or beginning with the identifier C immediately followed by \"-\".\r\n\t\t// The matching of C against the element's language value is performed case-insensitively.\r\n\t\t// The identifier C does not have to be a valid language name.\"\r\n\t\t// http://www.w3.org/TR/selectors/#lang-pseudo\r\n\t\t\"lang\": markFunction( function( lang ) {\r\n\t\t\t// lang value must be a valid identifier\r\n\t\t\tif ( !ridentifier.test(lang || \"\") ) {\r\n\t\t\t\tSizzle.error( \"unsupported lang: \" + lang );\r\n\t\t\t}\r\n\t\t\tlang = lang.replace( runescape, funescape ).toLowerCase();\r\n\t\t\treturn function( elem ) {\r\n\t\t\t\tvar elemLang;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tif ( (elemLang = documentIsHTML ?\r\n\t\t\t\t\t\telem.lang :\r\n\t\t\t\t\t\telem.getAttribute(\"xml:lang\") || elem.getAttribute(\"lang\")) ) {\r\n\r\n\t\t\t\t\t\telemLang = elemLang.toLowerCase();\r\n\t\t\t\t\t\treturn elemLang === lang || elemLang.indexOf( lang + \"-\" ) === 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t} while ( (elem = elem.parentNode) && elem.nodeType === 1 );\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t}),\r\n\r\n\t\t// Miscellaneous\r\n\t\t\"target\": function( elem ) {\r\n\t\t\tvar hash = window.location && window.location.hash;\r\n\t\t\treturn hash && hash.slice( 1 ) === elem.id;\r\n\t\t},\r\n\r\n\t\t\"root\": function( elem ) {\r\n\t\t\treturn elem === docElem;\r\n\t\t},\r\n\r\n\t\t\"focus\": function( elem ) {\r\n\t\t\treturn elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\r\n\t\t},\r\n\r\n\t\t// Boolean properties\r\n\t\t\"enabled\": function( elem ) {\r\n\t\t\treturn elem.disabled === false;\r\n\t\t},\r\n\r\n\t\t\"disabled\": function( elem ) {\r\n\t\t\treturn elem.disabled === true;\r\n\t\t},\r\n\r\n\t\t\"checked\": function( elem ) {\r\n\t\t\t// In CSS3, :checked should return both checked and selected elements\r\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\r\n\t\t\tvar nodeName = elem.nodeName.toLowerCase();\r\n\t\t\treturn (nodeName === \"input\" && !!elem.checked) || (nodeName === \"option\" && !!elem.selected);\r\n\t\t},\r\n\r\n\t\t\"selected\": function( elem ) {\r\n\t\t\t// Accessing this property makes selected-by-default\r\n\t\t\t// options in Safari work properly\r\n\t\t\tif ( elem.parentNode ) {\r\n\t\t\t\telem.parentNode.selectedIndex;\r\n\t\t\t}\r\n\r\n\t\t\treturn elem.selected === true;\r\n\t\t},\r\n\r\n\t\t// Contents\r\n\t\t\"empty\": function( elem ) {\r\n\t\t\t// http://www.w3.org/TR/selectors/#empty-pseudo\r\n\t\t\t// :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),\r\n\t\t\t//   but not by others (comment: 8; processing instruction: 7; etc.)\r\n\t\t\t// nodeType < 6 works because attributes (2) do not appear as children\r\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\r\n\t\t\t\tif ( elem.nodeType < 6 ) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t\"parent\": function( elem ) {\r\n\t\t\treturn !Expr.pseudos[\"empty\"]( elem );\r\n\t\t},\r\n\r\n\t\t// Element/input types\r\n\t\t\"header\": function( elem ) {\r\n\t\t\treturn rheader.test( elem.nodeName );\r\n\t\t},\r\n\r\n\t\t\"input\": function( elem ) {\r\n\t\t\treturn rinputs.test( elem.nodeName );\r\n\t\t},\r\n\r\n\t\t\"button\": function( elem ) {\r\n\t\t\tvar name = elem.nodeName.toLowerCase();\r\n\t\t\treturn name === \"input\" && elem.type === \"button\" || name === \"button\";\r\n\t\t},\r\n\r\n\t\t\"text\": function( elem ) {\r\n\t\t\tvar attr;\r\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" &&\r\n\t\t\t\telem.type === \"text\" &&\r\n\r\n\t\t\t\t// Support: IE<8\r\n\t\t\t\t// New HTML5 attribute values (e.g., \"search\") appear with elem.type === \"text\"\r\n\t\t\t\t( (attr = elem.getAttribute(\"type\")) == null || attr.toLowerCase() === \"text\" );\r\n\t\t},\r\n\r\n\t\t// Position-in-collection\r\n\t\t\"first\": createPositionalPseudo(function() {\r\n\t\t\treturn [ 0 ];\r\n\t\t}),\r\n\r\n\t\t\"last\": createPositionalPseudo(function( matchIndexes, length ) {\r\n\t\t\treturn [ length - 1 ];\r\n\t\t}),\r\n\r\n\t\t\"eq\": createPositionalPseudo(function( matchIndexes, length, argument ) {\r\n\t\t\treturn [ argument < 0 ? argument + length : argument ];\r\n\t\t}),\r\n\r\n\t\t\"even\": createPositionalPseudo(function( matchIndexes, length ) {\r\n\t\t\tvar i = 0;\r\n\t\t\tfor ( ; i < length; i += 2 ) {\r\n\t\t\t\tmatchIndexes.push( i );\r\n\t\t\t}\r\n\t\t\treturn matchIndexes;\r\n\t\t}),\r\n\r\n\t\t\"odd\": createPositionalPseudo(function( matchIndexes, length ) {\r\n\t\t\tvar i = 1;\r\n\t\t\tfor ( ; i < length; i += 2 ) {\r\n\t\t\t\tmatchIndexes.push( i );\r\n\t\t\t}\r\n\t\t\treturn matchIndexes;\r\n\t\t}),\r\n\r\n\t\t\"lt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\r\n\t\t\tvar i = argument < 0 ? argument + length : argument;\r\n\t\t\tfor ( ; --i >= 0; ) {\r\n\t\t\t\tmatchIndexes.push( i );\r\n\t\t\t}\r\n\t\t\treturn matchIndexes;\r\n\t\t}),\r\n\r\n\t\t\"gt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\r\n\t\t\tvar i = argument < 0 ? argument + length : argument;\r\n\t\t\tfor ( ; ++i < length; ) {\r\n\t\t\t\tmatchIndexes.push( i );\r\n\t\t\t}\r\n\t\t\treturn matchIndexes;\r\n\t\t})\r\n\t}\r\n};\r\n\r\nExpr.pseudos[\"nth\"] = Expr.pseudos[\"eq\"];\r\n\r\n// Add button/input type pseudos\r\nfor ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {\r\n\tExpr.pseudos[ i ] = createInputPseudo( i );\r\n}\r\nfor ( i in { submit: true, reset: true } ) {\r\n\tExpr.pseudos[ i ] = createButtonPseudo( i );\r\n}\r\n\r\n// Easy API for creating new setFilters\r\nfunction setFilters() {}\r\nsetFilters.prototype = Expr.filters = Expr.pseudos;\r\nExpr.setFilters = new setFilters();\r\n\r\ntokenize = Sizzle.tokenize = function( selector, parseOnly ) {\r\n\tvar matched, match, tokens, type,\r\n\t\tsoFar, groups, preFilters,\r\n\t\tcached = tokenCache[ selector + \" \" ];\r\n\r\n\tif ( cached ) {\r\n\t\treturn parseOnly ? 0 : cached.slice( 0 );\r\n\t}\r\n\r\n\tsoFar = selector;\r\n\tgroups = [];\r\n\tpreFilters = Expr.preFilter;\r\n\r\n\twhile ( soFar ) {\r\n\r\n\t\t// Comma and first run\r\n\t\tif ( !matched || (match = rcomma.exec( soFar )) ) {\r\n\t\t\tif ( match ) {\r\n\t\t\t\t// Don't consume trailing commas as valid\r\n\t\t\t\tsoFar = soFar.slice( match[0].length ) || soFar;\r\n\t\t\t}\r\n\t\t\tgroups.push( (tokens = []) );\r\n\t\t}\r\n\r\n\t\tmatched = false;\r\n\r\n\t\t// Combinators\r\n\t\tif ( (match = rcombinators.exec( soFar )) ) {\r\n\t\t\tmatched = match.shift();\r\n\t\t\ttokens.push({\r\n\t\t\t\tvalue: matched,\r\n\t\t\t\t// Cast descendant combinators to space\r\n\t\t\t\ttype: match[0].replace( rtrim, \" \" )\r\n\t\t\t});\r\n\t\t\tsoFar = soFar.slice( matched.length );\r\n\t\t}\r\n\r\n\t\t// Filters\r\n\t\tfor ( type in Expr.filter ) {\r\n\t\t\tif ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||\r\n\t\t\t\t(match = preFilters[ type ]( match ))) ) {\r\n\t\t\t\tmatched = match.shift();\r\n\t\t\t\ttokens.push({\r\n\t\t\t\t\tvalue: matched,\r\n\t\t\t\t\ttype: type,\r\n\t\t\t\t\tmatches: match\r\n\t\t\t\t});\r\n\t\t\t\tsoFar = soFar.slice( matched.length );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( !matched ) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\t// Return the length of the invalid excess\r\n\t// if we're just parsing\r\n\t// Otherwise, throw an error or return tokens\r\n\treturn parseOnly ?\r\n\t\tsoFar.length :\r\n\t\tsoFar ?\r\n\t\t\tSizzle.error( selector ) :\r\n\t\t\t// Cache the tokens\r\n\t\t\ttokenCache( selector, groups ).slice( 0 );\r\n};\r\n\r\nfunction toSelector( tokens ) {\r\n\tvar i = 0,\r\n\t\tlen = tokens.length,\r\n\t\tselector = \"\";\r\n\tfor ( ; i < len; i++ ) {\r\n\t\tselector += tokens[i].value;\r\n\t}\r\n\treturn selector;\r\n}\r\n\r\nfunction addCombinator( matcher, combinator, base ) {\r\n\tvar dir = combinator.dir,\r\n\t\tcheckNonElements = base && dir === \"parentNode\",\r\n\t\tdoneName = done++;\r\n\r\n\treturn combinator.first ?\r\n\t\t// Check against closest ancestor/preceding element\r\n\t\tfunction( elem, context, xml ) {\r\n\t\t\twhile ( (elem = elem[ dir ]) ) {\r\n\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\r\n\t\t\t\t\treturn matcher( elem, context, xml );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} :\r\n\r\n\t\t// Check against all ancestor/preceding elements\r\n\t\tfunction( elem, context, xml ) {\r\n\t\t\tvar oldCache, outerCache,\r\n\t\t\t\tnewCache = [ dirruns, doneName ];\r\n\r\n\t\t\t// We can't set arbitrary data on XML nodes, so they don't benefit from dir caching\r\n\t\t\tif ( xml ) {\r\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\r\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\r\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\r\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\r\n\t\t\t\t\t\touterCache = elem[ expando ] || (elem[ expando ] = {});\r\n\t\t\t\t\t\tif ( (oldCache = outerCache[ dir ]) &&\r\n\t\t\t\t\t\t\toldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {\r\n\r\n\t\t\t\t\t\t\t// Assign to newCache so results back-propagate to previous elements\r\n\t\t\t\t\t\t\treturn (newCache[ 2 ] = oldCache[ 2 ]);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Reuse newcache so results back-propagate to previous elements\r\n\t\t\t\t\t\t\touterCache[ dir ] = newCache;\r\n\r\n\t\t\t\t\t\t\t// A match means we're done; a fail means we have to keep checking\r\n\t\t\t\t\t\t\tif ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n}\r\n\r\nfunction elementMatcher( matchers ) {\r\n\treturn matchers.length > 1 ?\r\n\t\tfunction( elem, context, xml ) {\r\n\t\t\tvar i = matchers.length;\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tif ( !matchers[i]( elem, context, xml ) ) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t} :\r\n\t\tmatchers[0];\r\n}\r\n\r\nfunction multipleContexts( selector, contexts, results ) {\r\n\tvar i = 0,\r\n\t\tlen = contexts.length;\r\n\tfor ( ; i < len; i++ ) {\r\n\t\tSizzle( selector, contexts[i], results );\r\n\t}\r\n\treturn results;\r\n}\r\n\r\nfunction condense( unmatched, map, filter, context, xml ) {\r\n\tvar elem,\r\n\t\tnewUnmatched = [],\r\n\t\ti = 0,\r\n\t\tlen = unmatched.length,\r\n\t\tmapped = map != null;\r\n\r\n\tfor ( ; i < len; i++ ) {\r\n\t\tif ( (elem = unmatched[i]) ) {\r\n\t\t\tif ( !filter || filter( elem, context, xml ) ) {\r\n\t\t\t\tnewUnmatched.push( elem );\r\n\t\t\t\tif ( mapped ) {\r\n\t\t\t\t\tmap.push( i );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn newUnmatched;\r\n}\r\n\r\nfunction setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {\r\n\tif ( postFilter && !postFilter[ expando ] ) {\r\n\t\tpostFilter = setMatcher( postFilter );\r\n\t}\r\n\tif ( postFinder && !postFinder[ expando ] ) {\r\n\t\tpostFinder = setMatcher( postFinder, postSelector );\r\n\t}\r\n\treturn markFunction(function( seed, results, context, xml ) {\r\n\t\tvar temp, i, elem,\r\n\t\t\tpreMap = [],\r\n\t\t\tpostMap = [],\r\n\t\t\tpreexisting = results.length,\r\n\r\n\t\t\t// Get initial elements from seed or context\r\n\t\t\telems = seed || multipleContexts( selector || \"*\", context.nodeType ? [ context ] : context, [] ),\r\n\r\n\t\t\t// Prefilter to get matcher input, preserving a map for seed-results synchronization\r\n\t\t\tmatcherIn = preFilter && ( seed || !selector ) ?\r\n\t\t\t\tcondense( elems, preMap, preFilter, context, xml ) :\r\n\t\t\t\telems,\r\n\r\n\t\t\tmatcherOut = matcher ?\r\n\t\t\t\t// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,\r\n\t\t\t\tpostFinder || ( seed ? preFilter : preexisting || postFilter ) ?\r\n\r\n\t\t\t\t\t// ...intermediate processing is necessary\r\n\t\t\t\t\t[] :\r\n\r\n\t\t\t\t\t// ...otherwise use results directly\r\n\t\t\t\t\tresults :\r\n\t\t\t\tmatcherIn;\r\n\r\n\t\t// Find primary matches\r\n\t\tif ( matcher ) {\r\n\t\t\tmatcher( matcherIn, matcherOut, context, xml );\r\n\t\t}\r\n\r\n\t\t// Apply postFilter\r\n\t\tif ( postFilter ) {\r\n\t\t\ttemp = condense( matcherOut, postMap );\r\n\t\t\tpostFilter( temp, [], context, xml );\r\n\r\n\t\t\t// Un-match failing elements by moving them back to matcherIn\r\n\t\t\ti = temp.length;\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tif ( (elem = temp[i]) ) {\r\n\t\t\t\t\tmatcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( seed ) {\r\n\t\t\tif ( postFinder || preFilter ) {\r\n\t\t\t\tif ( postFinder ) {\r\n\t\t\t\t\t// Get the final matcherOut by condensing this intermediate into postFinder contexts\r\n\t\t\t\t\ttemp = [];\r\n\t\t\t\t\ti = matcherOut.length;\r\n\t\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\t\tif ( (elem = matcherOut[i]) ) {\r\n\t\t\t\t\t\t\t// Restore matcherIn since elem is not yet a final match\r\n\t\t\t\t\t\t\ttemp.push( (matcherIn[i] = elem) );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpostFinder( null, (matcherOut = []), temp, xml );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Move matched elements from seed to results to keep them synchronized\r\n\t\t\t\ti = matcherOut.length;\r\n\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\tif ( (elem = matcherOut[i]) &&\r\n\t\t\t\t\t\t(temp = postFinder ? indexOf.call( seed, elem ) : preMap[i]) > -1 ) {\r\n\r\n\t\t\t\t\t\tseed[temp] = !(results[temp] = elem);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t// Add elements to results, through postFinder if defined\r\n\t\t} else {\r\n\t\t\tmatcherOut = condense(\r\n\t\t\t\tmatcherOut === results ?\r\n\t\t\t\t\tmatcherOut.splice( preexisting, matcherOut.length ) :\r\n\t\t\t\t\tmatcherOut\r\n\t\t\t);\r\n\t\t\tif ( postFinder ) {\r\n\t\t\t\tpostFinder( null, results, matcherOut, xml );\r\n\t\t\t} else {\r\n\t\t\t\tpush.apply( results, matcherOut );\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction matcherFromTokens( tokens ) {\r\n\tvar checkContext, matcher, j,\r\n\t\tlen = tokens.length,\r\n\t\tleadingRelative = Expr.relative[ tokens[0].type ],\r\n\t\timplicitRelative = leadingRelative || Expr.relative[\" \"],\r\n\t\ti = leadingRelative ? 1 : 0,\r\n\r\n\t\t// The foundational matcher ensures that elements are reachable from top-level context(s)\r\n\t\tmatchContext = addCombinator( function( elem ) {\r\n\t\t\treturn elem === checkContext;\r\n\t\t}, implicitRelative, true ),\r\n\t\tmatchAnyContext = addCombinator( function( elem ) {\r\n\t\t\treturn indexOf.call( checkContext, elem ) > -1;\r\n\t\t}, implicitRelative, true ),\r\n\t\tmatchers = [ function( elem, context, xml ) {\r\n\t\t\treturn ( !leadingRelative && ( xml || context !== outermostContext ) ) || (\r\n\t\t\t\t(checkContext = context).nodeType ?\r\n\t\t\t\t\tmatchContext( elem, context, xml ) :\r\n\t\t\t\t\tmatchAnyContext( elem, context, xml ) );\r\n\t\t} ];\r\n\r\n\tfor ( ; i < len; i++ ) {\r\n\t\tif ( (matcher = Expr.relative[ tokens[i].type ]) ) {\r\n\t\t\tmatchers = [ addCombinator(elementMatcher( matchers ), matcher) ];\r\n\t\t} else {\r\n\t\t\tmatcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );\r\n\r\n\t\t\t// Return special upon seeing a positional matcher\r\n\t\t\tif ( matcher[ expando ] ) {\r\n\t\t\t\t// Find the next relative operator (if any) for proper handling\r\n\t\t\t\tj = ++i;\r\n\t\t\t\tfor ( ; j < len; j++ ) {\r\n\t\t\t\t\tif ( Expr.relative[ tokens[j].type ] ) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn setMatcher(\r\n\t\t\t\t\ti > 1 && elementMatcher( matchers ),\r\n\t\t\t\t\ti > 1 && toSelector(\r\n\t\t\t\t\t\t// If the preceding token was a descendant combinator, insert an implicit any-element `*`\r\n\t\t\t\t\t\ttokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === \" \" ? \"*\" : \"\" })\r\n\t\t\t\t\t).replace( rtrim, \"$1\" ),\r\n\t\t\t\t\tmatcher,\r\n\t\t\t\t\ti < j && matcherFromTokens( tokens.slice( i, j ) ),\r\n\t\t\t\t\tj < len && matcherFromTokens( (tokens = tokens.slice( j )) ),\r\n\t\t\t\t\tj < len && toSelector( tokens )\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tmatchers.push( matcher );\r\n\t\t}\r\n\t}\r\n\r\n\treturn elementMatcher( matchers );\r\n}\r\n\r\nfunction matcherFromGroupMatchers( elementMatchers, setMatchers ) {\r\n\tvar bySet = setMatchers.length > 0,\r\n\t\tbyElement = elementMatchers.length > 0,\r\n\t\tsuperMatcher = function( seed, context, xml, results, outermost ) {\r\n\t\t\tvar elem, j, matcher,\r\n\t\t\t\tmatchedCount = 0,\r\n\t\t\t\ti = \"0\",\r\n\t\t\t\tunmatched = seed && [],\r\n\t\t\t\tsetMatched = [],\r\n\t\t\t\tcontextBackup = outermostContext,\r\n\t\t\t\t// We must always have either seed elements or outermost context\r\n\t\t\t\telems = seed || byElement && Expr.find[\"TAG\"]( \"*\", outermost ),\r\n\t\t\t\t// Use integer dirruns iff this is the outermost matcher\r\n\t\t\t\tdirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),\r\n\t\t\t\tlen = elems.length;\r\n\r\n\t\t\tif ( outermost ) {\r\n\t\t\t\toutermostContext = context !== document && context;\r\n\t\t\t}\r\n\r\n\t\t\t// Add elements passing elementMatchers directly to results\r\n\t\t\t// Keep `i` a string if there are no elements so `matchedCount` will be \"00\" below\r\n\t\t\t// Support: IE<9, Safari\r\n\t\t\t// Tolerate NodeList properties (IE: \"length\"; Safari: <number>) matching elements by id\r\n\t\t\tfor ( ; i !== len && (elem = elems[i]) != null; i++ ) {\r\n\t\t\t\tif ( byElement && elem ) {\r\n\t\t\t\t\tj = 0;\r\n\t\t\t\t\twhile ( (matcher = elementMatchers[j++]) ) {\r\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\r\n\t\t\t\t\t\t\tresults.push( elem );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( outermost ) {\r\n\t\t\t\t\t\tdirruns = dirrunsUnique;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Track unmatched elements for set filters\r\n\t\t\t\tif ( bySet ) {\r\n\t\t\t\t\t// They will have gone through all possible matchers\r\n\t\t\t\t\tif ( (elem = !matcher && elem) ) {\r\n\t\t\t\t\t\tmatchedCount--;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Lengthen the array for every element, matched or not\r\n\t\t\t\t\tif ( seed ) {\r\n\t\t\t\t\t\tunmatched.push( elem );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Apply set filters to unmatched elements\r\n\t\t\tmatchedCount += i;\r\n\t\t\tif ( bySet && i !== matchedCount ) {\r\n\t\t\t\tj = 0;\r\n\t\t\t\twhile ( (matcher = setMatchers[j++]) ) {\r\n\t\t\t\t\tmatcher( unmatched, setMatched, context, xml );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( seed ) {\r\n\t\t\t\t\t// Reintegrate element matches to eliminate the need for sorting\r\n\t\t\t\t\tif ( matchedCount > 0 ) {\r\n\t\t\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\t\t\tif ( !(unmatched[i] || setMatched[i]) ) {\r\n\t\t\t\t\t\t\t\tsetMatched[i] = pop.call( results );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Discard index placeholder values to get only actual matches\r\n\t\t\t\t\tsetMatched = condense( setMatched );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Add matches to results\r\n\t\t\t\tpush.apply( results, setMatched );\r\n\r\n\t\t\t\t// Seedless set matches succeeding multiple successful matchers stipulate sorting\r\n\t\t\t\tif ( outermost && !seed && setMatched.length > 0 &&\r\n\t\t\t\t\t( matchedCount + setMatchers.length ) > 1 ) {\r\n\r\n\t\t\t\t\tSizzle.uniqueSort( results );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Override manipulation of globals by nested matchers\r\n\t\t\tif ( outermost ) {\r\n\t\t\t\tdirruns = dirrunsUnique;\r\n\t\t\t\toutermostContext = contextBackup;\r\n\t\t\t}\r\n\r\n\t\t\treturn unmatched;\r\n\t\t};\r\n\r\n\treturn bySet ?\r\n\t\tmarkFunction( superMatcher ) :\r\n\t\tsuperMatcher;\r\n}\r\n\r\ncompile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {\r\n\tvar i,\r\n\t\tsetMatchers = [],\r\n\t\telementMatchers = [],\r\n\t\tcached = compilerCache[ selector + \" \" ];\r\n\r\n\tif ( !cached ) {\r\n\t\t// Generate a function of recursive functions that can be used to check each element\r\n\t\tif ( !match ) {\r\n\t\t\tmatch = tokenize( selector );\r\n\t\t}\r\n\t\ti = match.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tcached = matcherFromTokens( match[i] );\r\n\t\t\tif ( cached[ expando ] ) {\r\n\t\t\t\tsetMatchers.push( cached );\r\n\t\t\t} else {\r\n\t\t\t\telementMatchers.push( cached );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Cache the compiled function\r\n\t\tcached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );\r\n\r\n\t\t// Save selector and tokenization\r\n\t\tcached.selector = selector;\r\n\t}\r\n\treturn cached;\r\n};\r\n\r\n/**\r\n * A low-level selection function that works with Sizzle's compiled\r\n *  selector functions\r\n * @param {String|Function} selector A selector or a pre-compiled\r\n *  selector function built with Sizzle.compile\r\n * @param {Element} context\r\n * @param {Array} [results]\r\n * @param {Array} [seed] A set of elements to match against\r\n */\r\nselect = Sizzle.select = function( selector, context, results, seed ) {\r\n\tvar i, tokens, token, type, find,\r\n\t\tcompiled = typeof selector === \"function\" && selector,\r\n\t\tmatch = !seed && tokenize( (selector = compiled.selector || selector) );\r\n\r\n\tresults = results || [];\r\n\r\n\t// Try to minimize operations if there is no seed and only one group\r\n\tif ( match.length === 1 ) {\r\n\r\n\t\t// Take a shortcut and set the context if the root selector is an ID\r\n\t\ttokens = match[0] = match[0].slice( 0 );\r\n\t\tif ( tokens.length > 2 && (token = tokens[0]).type === \"ID\" &&\r\n\t\t\t\tsupport.getById && context.nodeType === 9 && documentIsHTML &&\r\n\t\t\t\tExpr.relative[ tokens[1].type ] ) {\r\n\r\n\t\t\tcontext = ( Expr.find[\"ID\"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];\r\n\t\t\tif ( !context ) {\r\n\t\t\t\treturn results;\r\n\r\n\t\t\t// Precompiled matchers will still verify ancestry, so step up a level\r\n\t\t\t} else if ( compiled ) {\r\n\t\t\t\tcontext = context.parentNode;\r\n\t\t\t}\r\n\r\n\t\t\tselector = selector.slice( tokens.shift().value.length );\r\n\t\t}\r\n\r\n\t\t// Fetch a seed set for right-to-left matching\r\n\t\ti = matchExpr[\"needsContext\"].test( selector ) ? 0 : tokens.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\ttoken = tokens[i];\r\n\r\n\t\t\t// Abort if we hit a combinator\r\n\t\t\tif ( Expr.relative[ (type = token.type) ] ) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif ( (find = Expr.find[ type ]) ) {\r\n\t\t\t\t// Search, expanding context for leading sibling combinators\r\n\t\t\t\tif ( (seed = find(\r\n\t\t\t\t\ttoken.matches[0].replace( runescape, funescape ),\r\n\t\t\t\t\trsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context\r\n\t\t\t\t)) ) {\r\n\r\n\t\t\t\t\t// If seed is empty or no tokens remain, we can return early\r\n\t\t\t\t\ttokens.splice( i, 1 );\r\n\t\t\t\t\tselector = seed.length && toSelector( tokens );\r\n\t\t\t\t\tif ( !selector ) {\r\n\t\t\t\t\t\tpush.apply( results, seed );\r\n\t\t\t\t\t\treturn results;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Compile and execute a filtering function if one is not provided\r\n\t// Provide `match` to avoid retokenization if we modified the selector above\r\n\t( compiled || compile( selector, match ) )(\r\n\t\tseed,\r\n\t\tcontext,\r\n\t\t!documentIsHTML,\r\n\t\tresults,\r\n\t\trsibling.test( selector ) && testContext( context.parentNode ) || context\r\n\t);\r\n\treturn results;\r\n};\r\n\r\n// One-time assignments\r\n\r\n// Sort stability\r\nsupport.sortStable = expando.split(\"\").sort( sortOrder ).join(\"\") === expando;\r\n\r\n// Support: Chrome<14\r\n// Always assume duplicates if they aren't passed to the comparison function\r\nsupport.detectDuplicates = !!hasDuplicate;\r\n\r\n// Initialize against the default document\r\nsetDocument();\r\n\r\n// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)\r\n// Detached nodes confoundingly follow *each other*\r\nsupport.sortDetached = assert(function( div1 ) {\r\n\t// Should return 1, but returns 4 (following)\r\n\treturn div1.compareDocumentPosition( document.createElement(\"div\") ) & 1;\r\n});\r\n\r\n// Support: IE<8\r\n// Prevent attribute/property \"interpolation\"\r\n// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx\r\nif ( !assert(function( div ) {\r\n\tdiv.innerHTML = \"<a href='#'></a>\";\r\n\treturn div.firstChild.getAttribute(\"href\") === \"#\" ;\r\n}) ) {\r\n\taddHandle( \"type|href|height|width\", function( elem, name, isXML ) {\r\n\t\tif ( !isXML ) {\r\n\t\t\treturn elem.getAttribute( name, name.toLowerCase() === \"type\" ? 1 : 2 );\r\n\t\t}\r\n\t});\r\n}\r\n\r\n// Support: IE<9\r\n// Use defaultValue in place of getAttribute(\"value\")\r\nif ( !support.attributes || !assert(function( div ) {\r\n\tdiv.innerHTML = \"<input/>\";\r\n\tdiv.firstChild.setAttribute( \"value\", \"\" );\r\n\treturn div.firstChild.getAttribute( \"value\" ) === \"\";\r\n}) ) {\r\n\taddHandle( \"value\", function( elem, name, isXML ) {\r\n\t\tif ( !isXML && elem.nodeName.toLowerCase() === \"input\" ) {\r\n\t\t\treturn elem.defaultValue;\r\n\t\t}\r\n\t});\r\n}\r\n\r\n// Support: IE<9\r\n// Use getAttributeNode to fetch booleans when getAttribute lies\r\nif ( !assert(function( div ) {\r\n\treturn div.getAttribute(\"disabled\") == null;\r\n}) ) {\r\n\taddHandle( booleans, function( elem, name, isXML ) {\r\n\t\tvar val;\r\n\t\tif ( !isXML ) {\r\n\t\t\treturn elem[ name ] === true ? name.toLowerCase() :\r\n\t\t\t\t\t(val = elem.getAttributeNode( name )) && val.specified ?\r\n\t\t\t\t\tval.value :\r\n\t\t\t\tnull;\r\n\t\t}\r\n\t});\r\n}\r\n\r\nreturn Sizzle;\r\n\r\n})( window );\r\n\r\n\r\n\r\njQuery.find = Sizzle;\r\njQuery.expr = Sizzle.selectors;\r\njQuery.expr[\":\"] = jQuery.expr.pseudos;\r\njQuery.unique = Sizzle.uniqueSort;\r\njQuery.text = Sizzle.getText;\r\njQuery.isXMLDoc = Sizzle.isXML;\r\njQuery.contains = Sizzle.contains;\r\n\r\n\r\n\r\nvar rneedsContext = jQuery.expr.match.needsContext;\r\n\r\nvar rsingleTag = (/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/);\r\n\r\n\r\n\r\nvar risSimple = /^.[^:#\\[\\.,]*$/;\r\n\r\n// Implement the identical functionality for filter and not\r\nfunction winnow( elements, qualifier, not ) {\r\n\tif ( jQuery.isFunction( qualifier ) ) {\r\n\t\treturn jQuery.grep( elements, function( elem, i ) {\r\n\t\t\t/* jshint -W018 */\r\n\t\t\treturn !!qualifier.call( elem, i, elem ) !== not;\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tif ( qualifier.nodeType ) {\r\n\t\treturn jQuery.grep( elements, function( elem ) {\r\n\t\t\treturn ( elem === qualifier ) !== not;\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tif ( typeof qualifier === \"string\" ) {\r\n\t\tif ( risSimple.test( qualifier ) ) {\r\n\t\t\treturn jQuery.filter( qualifier, elements, not );\r\n\t\t}\r\n\r\n\t\tqualifier = jQuery.filter( qualifier, elements );\r\n\t}\r\n\r\n\treturn jQuery.grep( elements, function( elem ) {\r\n\t\treturn ( jQuery.inArray( elem, qualifier ) >= 0 ) !== not;\r\n\t});\r\n}\r\n\r\njQuery.filter = function( expr, elems, not ) {\r\n\tvar elem = elems[ 0 ];\r\n\r\n\tif ( not ) {\r\n\t\texpr = \":not(\" + expr + \")\";\r\n\t}\r\n\r\n\treturn elems.length === 1 && elem.nodeType === 1 ?\r\n\t\tjQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [] :\r\n\t\tjQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {\r\n\t\t\treturn elem.nodeType === 1;\r\n\t\t}));\r\n};\r\n\r\njQuery.fn.extend({\r\n\tfind: function( selector ) {\r\n\t\tvar i,\r\n\t\t\tret = [],\r\n\t\t\tself = this,\r\n\t\t\tlen = self.length;\r\n\r\n\t\tif ( typeof selector !== \"string\" ) {\r\n\t\t\treturn this.pushStack( jQuery( selector ).filter(function() {\r\n\t\t\t\tfor ( i = 0; i < len; i++ ) {\r\n\t\t\t\t\tif ( jQuery.contains( self[ i ], this ) ) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}) );\r\n\t\t}\r\n\r\n\t\tfor ( i = 0; i < len; i++ ) {\r\n\t\t\tjQuery.find( selector, self[ i ], ret );\r\n\t\t}\r\n\r\n\t\t// Needed because $( selector, context ) becomes $( context ).find( selector )\r\n\t\tret = this.pushStack( len > 1 ? jQuery.unique( ret ) : ret );\r\n\t\tret.selector = this.selector ? this.selector + \" \" + selector : selector;\r\n\t\treturn ret;\r\n\t},\r\n\tfilter: function( selector ) {\r\n\t\treturn this.pushStack( winnow(this, selector || [], false) );\r\n\t},\r\n\tnot: function( selector ) {\r\n\t\treturn this.pushStack( winnow(this, selector || [], true) );\r\n\t},\r\n\tis: function( selector ) {\r\n\t\treturn !!winnow(\r\n\t\t\tthis,\r\n\r\n\t\t\t// If this is a positional/relative selector, check membership in the returned set\r\n\t\t\t// so $(\"p:first\").is(\"p:last\") won't return true for a doc with two \"p\".\r\n\t\t\ttypeof selector === \"string\" && rneedsContext.test( selector ) ?\r\n\t\t\t\tjQuery( selector ) :\r\n\t\t\t\tselector || [],\r\n\t\t\tfalse\r\n\t\t).length;\r\n\t}\r\n});\r\n\r\n\r\n// Initialize a jQuery object\r\n\r\n\r\n// A central reference to the root jQuery(document)\r\nvar rootjQuery,\r\n\r\n\t// Use the correct document accordingly with window argument (sandbox)\r\n\tdocument = window.document,\r\n\r\n\t// A simple way to check for HTML strings\r\n\t// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)\r\n\t// Strict HTML recognition (#11290: must start with <)\r\n\trquickExpr = /^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,\r\n\r\n\tinit = jQuery.fn.init = function( selector, context ) {\r\n\t\tvar match, elem;\r\n\r\n\t\t// HANDLE: $(\"\"), $(null), $(undefined), $(false)\r\n\t\tif ( !selector ) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t// Handle HTML strings\r\n\t\tif ( typeof selector === \"string\" ) {\r\n\t\t\tif ( selector.charAt(0) === \"<\" && selector.charAt( selector.length - 1 ) === \">\" && selector.length >= 3 ) {\r\n\t\t\t\t// Assume that strings that start and end with <> are HTML and skip the regex check\r\n\t\t\t\tmatch = [ null, selector, null ];\r\n\r\n\t\t\t} else {\r\n\t\t\t\tmatch = rquickExpr.exec( selector );\r\n\t\t\t}\r\n\r\n\t\t\t// Match html or make sure no context is specified for #id\r\n\t\t\tif ( match && (match[1] || !context) ) {\r\n\r\n\t\t\t\t// HANDLE: $(html) -> $(array)\r\n\t\t\t\tif ( match[1] ) {\r\n\t\t\t\t\tcontext = context instanceof jQuery ? context[0] : context;\r\n\r\n\t\t\t\t\t// scripts is true for back-compat\r\n\t\t\t\t\t// Intentionally let the error be thrown if parseHTML is not present\r\n\t\t\t\t\tjQuery.merge( this, jQuery.parseHTML(\r\n\t\t\t\t\t\tmatch[1],\r\n\t\t\t\t\t\tcontext && context.nodeType ? context.ownerDocument || context : document,\r\n\t\t\t\t\t\ttrue\r\n\t\t\t\t\t) );\r\n\r\n\t\t\t\t\t// HANDLE: $(html, props)\r\n\t\t\t\t\tif ( rsingleTag.test( match[1] ) && jQuery.isPlainObject( context ) ) {\r\n\t\t\t\t\t\tfor ( match in context ) {\r\n\t\t\t\t\t\t\t// Properties of context are called as methods if possible\r\n\t\t\t\t\t\t\tif ( jQuery.isFunction( this[ match ] ) ) {\r\n\t\t\t\t\t\t\t\tthis[ match ]( context[ match ] );\r\n\r\n\t\t\t\t\t\t\t// ...and otherwise set as attributes\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.attr( match, context[ match ] );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t// HANDLE: $(#id)\r\n\t\t\t\t} else {\r\n\t\t\t\t\telem = document.getElementById( match[2] );\r\n\r\n\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\r\n\t\t\t\t\t// nodes that are no longer in the document #6963\r\n\t\t\t\t\tif ( elem && elem.parentNode ) {\r\n\t\t\t\t\t\t// Handle the case where IE and Opera return items\r\n\t\t\t\t\t\t// by name instead of ID\r\n\t\t\t\t\t\tif ( elem.id !== match[2] ) {\r\n\t\t\t\t\t\t\treturn rootjQuery.find( selector );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Otherwise, we inject the element directly into the jQuery object\r\n\t\t\t\t\t\tthis.length = 1;\r\n\t\t\t\t\t\tthis[0] = elem;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.context = document;\r\n\t\t\t\t\tthis.selector = selector;\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\r\n\t\t\t// HANDLE: $(expr, $(...))\r\n\t\t\t} else if ( !context || context.jquery ) {\r\n\t\t\t\treturn ( context || rootjQuery ).find( selector );\r\n\r\n\t\t\t// HANDLE: $(expr, context)\r\n\t\t\t// (which is just equivalent to: $(context).find(expr)\r\n\t\t\t} else {\r\n\t\t\t\treturn this.constructor( context ).find( selector );\r\n\t\t\t}\r\n\r\n\t\t// HANDLE: $(DOMElement)\r\n\t\t} else if ( selector.nodeType ) {\r\n\t\t\tthis.context = this[0] = selector;\r\n\t\t\tthis.length = 1;\r\n\t\t\treturn this;\r\n\r\n\t\t// HANDLE: $(function)\r\n\t\t// Shortcut for document ready\r\n\t\t} else if ( jQuery.isFunction( selector ) ) {\r\n\t\t\treturn typeof rootjQuery.ready !== \"undefined\" ?\r\n\t\t\t\trootjQuery.ready( selector ) :\r\n\t\t\t\t// Execute immediately if ready is not present\r\n\t\t\t\tselector( jQuery );\r\n\t\t}\r\n\r\n\t\tif ( selector.selector !== undefined ) {\r\n\t\t\tthis.selector = selector.selector;\r\n\t\t\tthis.context = selector.context;\r\n\t\t}\r\n\r\n\t\treturn jQuery.makeArray( selector, this );\r\n\t};\r\n\r\n// Give the init function the jQuery prototype for later instantiation\r\ninit.prototype = jQuery.fn;\r\n\r\n// Initialize central reference\r\nrootjQuery = jQuery( document );\r\n\r\n\r\nvar rparentsprev = /^(?:parents|prev(?:Until|All))/,\r\n\t// methods guaranteed to produce a unique set when starting from a unique set\r\n\tguaranteedUnique = {\r\n\t\tchildren: true,\r\n\t\tcontents: true,\r\n\t\tnext: true,\r\n\t\tprev: true\r\n\t};\r\n\r\njQuery.extend({\r\n\tdir: function( elem, dir, until ) {\r\n\t\tvar matched = [],\r\n\t\t\tcur = elem[ dir ];\r\n\r\n\t\twhile ( cur && cur.nodeType !== 9 && (until === undefined || cur.nodeType !== 1 || !jQuery( cur ).is( until )) ) {\r\n\t\t\tif ( cur.nodeType === 1 ) {\r\n\t\t\t\tmatched.push( cur );\r\n\t\t\t}\r\n\t\t\tcur = cur[dir];\r\n\t\t}\r\n\t\treturn matched;\r\n\t},\r\n\r\n\tsibling: function( n, elem ) {\r\n\t\tvar r = [];\r\n\r\n\t\tfor ( ; n; n = n.nextSibling ) {\r\n\t\t\tif ( n.nodeType === 1 && n !== elem ) {\r\n\t\t\t\tr.push( n );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn r;\r\n\t}\r\n});\r\n\r\njQuery.fn.extend({\r\n\thas: function( target ) {\r\n\t\tvar i,\r\n\t\t\ttargets = jQuery( target, this ),\r\n\t\t\tlen = targets.length;\r\n\r\n\t\treturn this.filter(function() {\r\n\t\t\tfor ( i = 0; i < len; i++ ) {\r\n\t\t\t\tif ( jQuery.contains( this, targets[i] ) ) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tclosest: function( selectors, context ) {\r\n\t\tvar cur,\r\n\t\t\ti = 0,\r\n\t\t\tl = this.length,\r\n\t\t\tmatched = [],\r\n\t\t\tpos = rneedsContext.test( selectors ) || typeof selectors !== \"string\" ?\r\n\t\t\t\tjQuery( selectors, context || this.context ) :\r\n\t\t\t\t0;\r\n\r\n\t\tfor ( ; i < l; i++ ) {\r\n\t\t\tfor ( cur = this[i]; cur && cur !== context; cur = cur.parentNode ) {\r\n\t\t\t\t// Always skip document fragments\r\n\t\t\t\tif ( cur.nodeType < 11 && (pos ?\r\n\t\t\t\t\tpos.index(cur) > -1 :\r\n\r\n\t\t\t\t\t// Don't pass non-elements to Sizzle\r\n\t\t\t\t\tcur.nodeType === 1 &&\r\n\t\t\t\t\t\tjQuery.find.matchesSelector(cur, selectors)) ) {\r\n\r\n\t\t\t\t\tmatched.push( cur );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.pushStack( matched.length > 1 ? jQuery.unique( matched ) : matched );\r\n\t},\r\n\r\n\t// Determine the position of an element within\r\n\t// the matched set of elements\r\n\tindex: function( elem ) {\r\n\r\n\t\t// No argument, return index in parent\r\n\t\tif ( !elem ) {\r\n\t\t\treturn ( this[0] && this[0].parentNode ) ? this.first().prevAll().length : -1;\r\n\t\t}\r\n\r\n\t\t// index in selector\r\n\t\tif ( typeof elem === \"string\" ) {\r\n\t\t\treturn jQuery.inArray( this[0], jQuery( elem ) );\r\n\t\t}\r\n\r\n\t\t// Locate the position of the desired element\r\n\t\treturn jQuery.inArray(\r\n\t\t\t// If it receives a jQuery object, the first element is used\r\n\t\t\telem.jquery ? elem[0] : elem, this );\r\n\t},\r\n\r\n\tadd: function( selector, context ) {\r\n\t\treturn this.pushStack(\r\n\t\t\tjQuery.unique(\r\n\t\t\t\tjQuery.merge( this.get(), jQuery( selector, context ) )\r\n\t\t\t)\r\n\t\t);\r\n\t},\r\n\r\n\taddBack: function( selector ) {\r\n\t\treturn this.add( selector == null ?\r\n\t\t\tthis.prevObject : this.prevObject.filter(selector)\r\n\t\t);\r\n\t}\r\n});\r\n\r\nfunction sibling( cur, dir ) {\r\n\tdo {\r\n\t\tcur = cur[ dir ];\r\n\t} while ( cur && cur.nodeType !== 1 );\r\n\r\n\treturn cur;\r\n}\r\n\r\njQuery.each({\r\n\tparent: function( elem ) {\r\n\t\tvar parent = elem.parentNode;\r\n\t\treturn parent && parent.nodeType !== 11 ? parent : null;\r\n\t},\r\n\tparents: function( elem ) {\r\n\t\treturn jQuery.dir( elem, \"parentNode\" );\r\n\t},\r\n\tparentsUntil: function( elem, i, until ) {\r\n\t\treturn jQuery.dir( elem, \"parentNode\", until );\r\n\t},\r\n\tnext: function( elem ) {\r\n\t\treturn sibling( elem, \"nextSibling\" );\r\n\t},\r\n\tprev: function( elem ) {\r\n\t\treturn sibling( elem, \"previousSibling\" );\r\n\t},\r\n\tnextAll: function( elem ) {\r\n\t\treturn jQuery.dir( elem, \"nextSibling\" );\r\n\t},\r\n\tprevAll: function( elem ) {\r\n\t\treturn jQuery.dir( elem, \"previousSibling\" );\r\n\t},\r\n\tnextUntil: function( elem, i, until ) {\r\n\t\treturn jQuery.dir( elem, \"nextSibling\", until );\r\n\t},\r\n\tprevUntil: function( elem, i, until ) {\r\n\t\treturn jQuery.dir( elem, \"previousSibling\", until );\r\n\t},\r\n\tsiblings: function( elem ) {\r\n\t\treturn jQuery.sibling( ( elem.parentNode || {} ).firstChild, elem );\r\n\t},\r\n\tchildren: function( elem ) {\r\n\t\treturn jQuery.sibling( elem.firstChild );\r\n\t},\r\n\tcontents: function( elem ) {\r\n\t\treturn jQuery.nodeName( elem, \"iframe\" ) ?\r\n\t\t\telem.contentDocument || elem.contentWindow.document :\r\n\t\t\tjQuery.merge( [], elem.childNodes );\r\n\t}\r\n}, function( name, fn ) {\r\n\tjQuery.fn[ name ] = function( until, selector ) {\r\n\t\tvar ret = jQuery.map( this, fn, until );\r\n\r\n\t\tif ( name.slice( -5 ) !== \"Until\" ) {\r\n\t\t\tselector = until;\r\n\t\t}\r\n\r\n\t\tif ( selector && typeof selector === \"string\" ) {\r\n\t\t\tret = jQuery.filter( selector, ret );\r\n\t\t}\r\n\r\n\t\tif ( this.length > 1 ) {\r\n\t\t\t// Remove duplicates\r\n\t\t\tif ( !guaranteedUnique[ name ] ) {\r\n\t\t\t\tret = jQuery.unique( ret );\r\n\t\t\t}\r\n\r\n\t\t\t// Reverse order for parents* and prev-derivatives\r\n\t\t\tif ( rparentsprev.test( name ) ) {\r\n\t\t\t\tret = ret.reverse();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.pushStack( ret );\r\n\t};\r\n});\r\nvar rnotwhite = (/\\S+/g);\r\n\r\n\r\n\r\n// String to Object options format cache\r\nvar optionsCache = {};\r\n\r\n// Convert String-formatted options into Object-formatted ones and store in cache\r\nfunction createOptions( options ) {\r\n\tvar object = optionsCache[ options ] = {};\r\n\tjQuery.each( options.match( rnotwhite ) || [], function( _, flag ) {\r\n\t\tobject[ flag ] = true;\r\n\t});\r\n\treturn object;\r\n}\r\n\r\n/*\r\n * Create a callback list using the following parameters:\r\n *\r\n *\toptions: an optional list of space-separated options that will change how\r\n *\t\t\tthe callback list behaves or a more traditional option object\r\n *\r\n * By default a callback list will act like an event callback list and can be\r\n * \"fired\" multiple times.\r\n *\r\n * Possible options:\r\n *\r\n *\tonce:\t\t\twill ensure the callback list can only be fired once (like a Deferred)\r\n *\r\n *\tmemory:\t\t\twill keep track of previous values and will call any callback added\r\n *\t\t\t\t\tafter the list has been fired right away with the latest \"memorized\"\r\n *\t\t\t\t\tvalues (like a Deferred)\r\n *\r\n *\tunique:\t\t\twill ensure a callback can only be added once (no duplicate in the list)\r\n *\r\n *\tstopOnFalse:\tinterrupt callings when a callback returns false\r\n *\r\n */\r\njQuery.Callbacks = function( options ) {\r\n\r\n\t// Convert options from String-formatted to Object-formatted if needed\r\n\t// (we check in cache first)\r\n\toptions = typeof options === \"string\" ?\r\n\t\t( optionsCache[ options ] || createOptions( options ) ) :\r\n\t\tjQuery.extend( {}, options );\r\n\r\n\tvar // Flag to know if list is currently firing\r\n\t\tfiring,\r\n\t\t// Last fire value (for non-forgettable lists)\r\n\t\tmemory,\r\n\t\t// Flag to know if list was already fired\r\n\t\tfired,\r\n\t\t// End of the loop when firing\r\n\t\tfiringLength,\r\n\t\t// Index of currently firing callback (modified by remove if needed)\r\n\t\tfiringIndex,\r\n\t\t// First callback to fire (used internally by add and fireWith)\r\n\t\tfiringStart,\r\n\t\t// Actual callback list\r\n\t\tlist = [],\r\n\t\t// Stack of fire calls for repeatable lists\r\n\t\tstack = !options.once && [],\r\n\t\t// Fire callbacks\r\n\t\tfire = function( data ) {\r\n\t\t\tmemory = options.memory && data;\r\n\t\t\tfired = true;\r\n\t\t\tfiringIndex = firingStart || 0;\r\n\t\t\tfiringStart = 0;\r\n\t\t\tfiringLength = list.length;\r\n\t\t\tfiring = true;\r\n\t\t\tfor ( ; list && firingIndex < firingLength; firingIndex++ ) {\r\n\t\t\t\tif ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse ) {\r\n\t\t\t\t\tmemory = false; // To prevent further calls using add\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfiring = false;\r\n\t\t\tif ( list ) {\r\n\t\t\t\tif ( stack ) {\r\n\t\t\t\t\tif ( stack.length ) {\r\n\t\t\t\t\t\tfire( stack.shift() );\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if ( memory ) {\r\n\t\t\t\t\tlist = [];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.disable();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t// Actual Callbacks object\r\n\t\tself = {\r\n\t\t\t// Add a callback or a collection of callbacks to the list\r\n\t\t\tadd: function() {\r\n\t\t\t\tif ( list ) {\r\n\t\t\t\t\t// First, we save the current length\r\n\t\t\t\t\tvar start = list.length;\r\n\t\t\t\t\t(function add( args ) {\r\n\t\t\t\t\t\tjQuery.each( args, function( _, arg ) {\r\n\t\t\t\t\t\t\tvar type = jQuery.type( arg );\r\n\t\t\t\t\t\t\tif ( type === \"function\" ) {\r\n\t\t\t\t\t\t\t\tif ( !options.unique || !self.has( arg ) ) {\r\n\t\t\t\t\t\t\t\t\tlist.push( arg );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if ( arg && arg.length && type !== \"string\" ) {\r\n\t\t\t\t\t\t\t\t// Inspect recursively\r\n\t\t\t\t\t\t\t\tadd( arg );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})( arguments );\r\n\t\t\t\t\t// Do we need to add the callbacks to the\r\n\t\t\t\t\t// current firing batch?\r\n\t\t\t\t\tif ( firing ) {\r\n\t\t\t\t\t\tfiringLength = list.length;\r\n\t\t\t\t\t// With memory, if we're not firing then\r\n\t\t\t\t\t// we should call right away\r\n\t\t\t\t\t} else if ( memory ) {\r\n\t\t\t\t\t\tfiringStart = start;\r\n\t\t\t\t\t\tfire( memory );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t// Remove a callback from the list\r\n\t\t\tremove: function() {\r\n\t\t\t\tif ( list ) {\r\n\t\t\t\t\tjQuery.each( arguments, function( _, arg ) {\r\n\t\t\t\t\t\tvar index;\r\n\t\t\t\t\t\twhile ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {\r\n\t\t\t\t\t\t\tlist.splice( index, 1 );\r\n\t\t\t\t\t\t\t// Handle firing indexes\r\n\t\t\t\t\t\t\tif ( firing ) {\r\n\t\t\t\t\t\t\t\tif ( index <= firingLength ) {\r\n\t\t\t\t\t\t\t\t\tfiringLength--;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ( index <= firingIndex ) {\r\n\t\t\t\t\t\t\t\t\tfiringIndex--;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t// Check if a given callback is in the list.\r\n\t\t\t// If no argument is given, return whether or not list has callbacks attached.\r\n\t\t\thas: function( fn ) {\r\n\t\t\t\treturn fn ? jQuery.inArray( fn, list ) > -1 : !!( list && list.length );\r\n\t\t\t},\r\n\t\t\t// Remove all callbacks from the list\r\n\t\t\tempty: function() {\r\n\t\t\t\tlist = [];\r\n\t\t\t\tfiringLength = 0;\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t// Have the list do nothing anymore\r\n\t\t\tdisable: function() {\r\n\t\t\t\tlist = stack = memory = undefined;\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t// Is it disabled?\r\n\t\t\tdisabled: function() {\r\n\t\t\t\treturn !list;\r\n\t\t\t},\r\n\t\t\t// Lock the list in its current state\r\n\t\t\tlock: function() {\r\n\t\t\t\tstack = undefined;\r\n\t\t\t\tif ( !memory ) {\r\n\t\t\t\t\tself.disable();\r\n\t\t\t\t}\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t// Is it locked?\r\n\t\t\tlocked: function() {\r\n\t\t\t\treturn !stack;\r\n\t\t\t},\r\n\t\t\t// Call all callbacks with the given context and arguments\r\n\t\t\tfireWith: function( context, args ) {\r\n\t\t\t\tif ( list && ( !fired || stack ) ) {\r\n\t\t\t\t\targs = args || [];\r\n\t\t\t\t\targs = [ context, args.slice ? args.slice() : args ];\r\n\t\t\t\t\tif ( firing ) {\r\n\t\t\t\t\t\tstack.push( args );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfire( args );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t// Call all the callbacks with the given arguments\r\n\t\t\tfire: function() {\r\n\t\t\t\tself.fireWith( this, arguments );\r\n\t\t\t\treturn this;\r\n\t\t\t},\r\n\t\t\t// To know if the callbacks have already been called at least once\r\n\t\t\tfired: function() {\r\n\t\t\t\treturn !!fired;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\treturn self;\r\n};\r\n\r\n\r\njQuery.extend({\r\n\r\n\tDeferred: function( func ) {\r\n\t\tvar tuples = [\r\n\t\t\t\t// action, add listener, listener list, final state\r\n\t\t\t\t[ \"resolve\", \"done\", jQuery.Callbacks(\"once memory\"), \"resolved\" ],\r\n\t\t\t\t[ \"reject\", \"fail\", jQuery.Callbacks(\"once memory\"), \"rejected\" ],\r\n\t\t\t\t[ \"notify\", \"progress\", jQuery.Callbacks(\"memory\") ]\r\n\t\t\t],\r\n\t\t\tstate = \"pending\",\r\n\t\t\tpromise = {\r\n\t\t\t\tstate: function() {\r\n\t\t\t\t\treturn state;\r\n\t\t\t\t},\r\n\t\t\t\talways: function() {\r\n\t\t\t\t\tdeferred.done( arguments ).fail( arguments );\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t},\r\n\t\t\t\tthen: function( /* fnDone, fnFail, fnProgress */ ) {\r\n\t\t\t\t\tvar fns = arguments;\r\n\t\t\t\t\treturn jQuery.Deferred(function( newDefer ) {\r\n\t\t\t\t\t\tjQuery.each( tuples, function( i, tuple ) {\r\n\t\t\t\t\t\t\tvar fn = jQuery.isFunction( fns[ i ] ) && fns[ i ];\r\n\t\t\t\t\t\t\t// deferred[ done | fail | progress ] for forwarding actions to newDefer\r\n\t\t\t\t\t\t\tdeferred[ tuple[1] ](function() {\r\n\t\t\t\t\t\t\t\tvar returned = fn && fn.apply( this, arguments );\r\n\t\t\t\t\t\t\t\tif ( returned && jQuery.isFunction( returned.promise ) ) {\r\n\t\t\t\t\t\t\t\t\treturned.promise()\r\n\t\t\t\t\t\t\t\t\t\t.done( newDefer.resolve )\r\n\t\t\t\t\t\t\t\t\t\t.fail( newDefer.reject )\r\n\t\t\t\t\t\t\t\t\t\t.progress( newDefer.notify );\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tnewDefer[ tuple[ 0 ] + \"With\" ]( this === promise ? newDefer.promise() : this, fn ? [ returned ] : arguments );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tfns = null;\r\n\t\t\t\t\t}).promise();\r\n\t\t\t\t},\r\n\t\t\t\t// Get a promise for this deferred\r\n\t\t\t\t// If obj is provided, the promise aspect is added to the object\r\n\t\t\t\tpromise: function( obj ) {\r\n\t\t\t\t\treturn obj != null ? jQuery.extend( obj, promise ) : promise;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeferred = {};\r\n\r\n\t\t// Keep pipe for back-compat\r\n\t\tpromise.pipe = promise.then;\r\n\r\n\t\t// Add list-specific methods\r\n\t\tjQuery.each( tuples, function( i, tuple ) {\r\n\t\t\tvar list = tuple[ 2 ],\r\n\t\t\t\tstateString = tuple[ 3 ];\r\n\r\n\t\t\t// promise[ done | fail | progress ] = list.add\r\n\t\t\tpromise[ tuple[1] ] = list.add;\r\n\r\n\t\t\t// Handle state\r\n\t\t\tif ( stateString ) {\r\n\t\t\t\tlist.add(function() {\r\n\t\t\t\t\t// state = [ resolved | rejected ]\r\n\t\t\t\t\tstate = stateString;\r\n\r\n\t\t\t\t// [ reject_list | resolve_list ].disable; progress_list.lock\r\n\t\t\t\t}, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );\r\n\t\t\t}\r\n\r\n\t\t\t// deferred[ resolve | reject | notify ]\r\n\t\t\tdeferred[ tuple[0] ] = function() {\r\n\t\t\t\tdeferred[ tuple[0] + \"With\" ]( this === deferred ? promise : this, arguments );\r\n\t\t\t\treturn this;\r\n\t\t\t};\r\n\t\t\tdeferred[ tuple[0] + \"With\" ] = list.fireWith;\r\n\t\t});\r\n\r\n\t\t// Make the deferred a promise\r\n\t\tpromise.promise( deferred );\r\n\r\n\t\t// Call given func if any\r\n\t\tif ( func ) {\r\n\t\t\tfunc.call( deferred, deferred );\r\n\t\t}\r\n\r\n\t\t// All done!\r\n\t\treturn deferred;\r\n\t},\r\n\r\n\t// Deferred helper\r\n\twhen: function( subordinate /* , ..., subordinateN */ ) {\r\n\t\tvar i = 0,\r\n\t\t\tresolveValues = slice.call( arguments ),\r\n\t\t\tlength = resolveValues.length,\r\n\r\n\t\t\t// the count of uncompleted subordinates\r\n\t\t\tremaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,\r\n\r\n\t\t\t// the master Deferred. If resolveValues consist of only a single Deferred, just use that.\r\n\t\t\tdeferred = remaining === 1 ? subordinate : jQuery.Deferred(),\r\n\r\n\t\t\t// Update function for both resolve and progress values\r\n\t\t\tupdateFunc = function( i, contexts, values ) {\r\n\t\t\t\treturn function( value ) {\r\n\t\t\t\t\tcontexts[ i ] = this;\r\n\t\t\t\t\tvalues[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;\r\n\t\t\t\t\tif ( values === progressValues ) {\r\n\t\t\t\t\t\tdeferred.notifyWith( contexts, values );\r\n\r\n\t\t\t\t\t} else if ( !(--remaining) ) {\r\n\t\t\t\t\t\tdeferred.resolveWith( contexts, values );\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t},\r\n\r\n\t\t\tprogressValues, progressContexts, resolveContexts;\r\n\r\n\t\t// add listeners to Deferred subordinates; treat others as resolved\r\n\t\tif ( length > 1 ) {\r\n\t\t\tprogressValues = new Array( length );\r\n\t\t\tprogressContexts = new Array( length );\r\n\t\t\tresolveContexts = new Array( length );\r\n\t\t\tfor ( ; i < length; i++ ) {\r\n\t\t\t\tif ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {\r\n\t\t\t\t\tresolveValues[ i ].promise()\r\n\t\t\t\t\t\t.done( updateFunc( i, resolveContexts, resolveValues ) )\r\n\t\t\t\t\t\t.fail( deferred.reject )\r\n\t\t\t\t\t\t.progress( updateFunc( i, progressContexts, progressValues ) );\r\n\t\t\t\t} else {\r\n\t\t\t\t\t--remaining;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// if we're not waiting on anything, resolve the master\r\n\t\tif ( !remaining ) {\r\n\t\t\tdeferred.resolveWith( resolveContexts, resolveValues );\r\n\t\t}\r\n\r\n\t\treturn deferred.promise();\r\n\t}\r\n});\r\n\r\n\r\n// The deferred used on DOM ready\r\nvar readyList;\r\n\r\njQuery.fn.ready = function( fn ) {\r\n\t// Add the callback\r\n\tjQuery.ready.promise().done( fn );\r\n\r\n\treturn this;\r\n};\r\n\r\njQuery.extend({\r\n\t// Is the DOM ready to be used? Set to true once it occurs.\r\n\tisReady: false,\r\n\r\n\t// A counter to track how many items to wait for before\r\n\t// the ready event fires. See #6781\r\n\treadyWait: 1,\r\n\r\n\t// Hold (or release) the ready event\r\n\tholdReady: function( hold ) {\r\n\t\tif ( hold ) {\r\n\t\t\tjQuery.readyWait++;\r\n\t\t} else {\r\n\t\t\tjQuery.ready( true );\r\n\t\t}\r\n\t},\r\n\r\n\t// Handle when the DOM is ready\r\n\tready: function( wait ) {\r\n\r\n\t\t// Abort if there are pending holds or we're already ready\r\n\t\tif ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).\r\n\t\tif ( !document.body ) {\r\n\t\t\treturn setTimeout( jQuery.ready );\r\n\t\t}\r\n\r\n\t\t// Remember that the DOM is ready\r\n\t\tjQuery.isReady = true;\r\n\r\n\t\t// If a normal DOM Ready event fired, decrement, and wait if need be\r\n\t\tif ( wait !== true && --jQuery.readyWait > 0 ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// If there are functions bound, to execute\r\n\t\treadyList.resolveWith( document, [ jQuery ] );\r\n\r\n\t\t// Trigger any bound ready events\r\n\t\tif ( jQuery.fn.triggerHandler ) {\r\n\t\t\tjQuery( document ).triggerHandler( \"ready\" );\r\n\t\t\tjQuery( document ).off( \"ready\" );\r\n\t\t}\r\n\t}\r\n});\r\n\r\n/**\r\n * Clean-up method for dom ready events\r\n */\r\nfunction detach() {\r\n\tif ( document.addEventListener ) {\r\n\t\tdocument.removeEventListener( \"DOMContentLoaded\", completed, false );\r\n\t\twindow.removeEventListener( \"load\", completed, false );\r\n\r\n\t} else {\r\n\t\tdocument.detachEvent( \"onreadystatechange\", completed );\r\n\t\twindow.detachEvent( \"onload\", completed );\r\n\t}\r\n}\r\n\r\n/**\r\n * The ready event handler and self cleanup method\r\n */\r\nfunction completed() {\r\n\t// readyState === \"complete\" is good enough for us to call the dom ready in oldIE\r\n\tif ( document.addEventListener || event.type === \"load\" || document.readyState === \"complete\" ) {\r\n\t\tdetach();\r\n\t\tjQuery.ready();\r\n\t}\r\n}\r\n\r\njQuery.ready.promise = function( obj ) {\r\n\tif ( !readyList ) {\r\n\r\n\t\treadyList = jQuery.Deferred();\r\n\r\n\t\t// Catch cases where $(document).ready() is called after the browser event has already occurred.\r\n\t\t// we once tried to use readyState \"interactive\" here, but it caused issues like the one\r\n\t\t// discovered by ChrisS here: http://bugs.jquery.com/ticket/12282#comment:15\r\n\t\tif ( document.readyState === \"complete\" ) {\r\n\t\t\t// Handle it asynchronously to allow scripts the opportunity to delay ready\r\n\t\t\tsetTimeout( jQuery.ready );\r\n\r\n\t\t// Standards-based browsers support DOMContentLoaded\r\n\t\t} else if ( document.addEventListener ) {\r\n\t\t\t// Use the handy event callback\r\n\t\t\tdocument.addEventListener( \"DOMContentLoaded\", completed, false );\r\n\r\n\t\t\t// A fallback to window.onload, that will always work\r\n\t\t\twindow.addEventListener( \"load\", completed, false );\r\n\r\n\t\t// If IE event model is used\r\n\t\t} else {\r\n\t\t\t// Ensure firing before onload, maybe late but safe also for iframes\r\n\t\t\tdocument.attachEvent( \"onreadystatechange\", completed );\r\n\r\n\t\t\t// A fallback to window.onload, that will always work\r\n\t\t\twindow.attachEvent( \"onload\", completed );\r\n\r\n\t\t\t// If IE and not a frame\r\n\t\t\t// continually check to see if the document is ready\r\n\t\t\tvar top = false;\r\n\r\n\t\t\ttry {\r\n\t\t\t\ttop = window.frameElement == null && document.documentElement;\r\n\t\t\t} catch(e) {}\r\n\r\n\t\t\tif ( top && top.doScroll ) {\r\n\t\t\t\t(function doScrollCheck() {\r\n\t\t\t\t\tif ( !jQuery.isReady ) {\r\n\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t// Use the trick by Diego Perini\r\n\t\t\t\t\t\t\t// http://javascript.nwbox.com/IEContentLoaded/\r\n\t\t\t\t\t\t\ttop.doScroll(\"left\");\r\n\t\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\t\treturn setTimeout( doScrollCheck, 50 );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// detach all dom ready events\r\n\t\t\t\t\t\tdetach();\r\n\r\n\t\t\t\t\t\t// and execute any waiting functions\r\n\t\t\t\t\t\tjQuery.ready();\r\n\t\t\t\t\t}\r\n\t\t\t\t})();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn readyList.promise( obj );\r\n};\r\n\r\n\r\nvar strundefined = typeof undefined;\r\n\r\n\r\n\r\n// Support: IE<9\r\n// Iteration over object's inherited properties before its own\r\nvar i;\r\nfor ( i in jQuery( support ) ) {\r\n\tbreak;\r\n}\r\nsupport.ownLast = i !== \"0\";\r\n\r\n// Note: most support tests are defined in their respective modules.\r\n// false until the test is run\r\nsupport.inlineBlockNeedsLayout = false;\r\n\r\n// Execute ASAP in case we need to set body.style.zoom\r\njQuery(function() {\r\n\t// Minified: var a,b,c,d\r\n\tvar val, div, body, container;\r\n\r\n\tbody = document.getElementsByTagName( \"body\" )[ 0 ];\r\n\tif ( !body || !body.style ) {\r\n\t\t// Return for frameset docs that don't have a body\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Setup\r\n\tdiv = document.createElement( \"div\" );\r\n\tcontainer = document.createElement( \"div\" );\r\n\tcontainer.style.cssText = \"position:absolute;border:0;width:0;height:0;top:0;left:-9999px\";\r\n\tbody.appendChild( container ).appendChild( div );\r\n\r\n\tif ( typeof div.style.zoom !== strundefined ) {\r\n\t\t// Support: IE<8\r\n\t\t// Check if natively block-level elements act like inline-block\r\n\t\t// elements when setting their display to 'inline' and giving\r\n\t\t// them layout\r\n\t\tdiv.style.cssText = \"display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1\";\r\n\r\n\t\tsupport.inlineBlockNeedsLayout = val = div.offsetWidth === 3;\r\n\t\tif ( val ) {\r\n\t\t\t// Prevent IE 6 from affecting layout for positioned elements #11048\r\n\t\t\t// Prevent IE from shrinking the body in IE 7 mode #12869\r\n\t\t\t// Support: IE<8\r\n\t\t\tbody.style.zoom = 1;\r\n\t\t}\r\n\t}\r\n\r\n\tbody.removeChild( container );\r\n});\r\n\r\n\r\n\r\n\r\n(function() {\r\n\tvar div = document.createElement( \"div\" );\r\n\r\n\t// Execute the test only if not already executed in another module.\r\n\tif (support.deleteExpando == null) {\r\n\t\t// Support: IE<9\r\n\t\tsupport.deleteExpando = true;\r\n\t\ttry {\r\n\t\t\tdelete div.test;\r\n\t\t} catch( e ) {\r\n\t\t\tsupport.deleteExpando = false;\r\n\t\t}\r\n\t}\r\n\r\n\t// Null elements to avoid leaks in IE.\r\n\tdiv = null;\r\n})();\r\n\r\n\r\n/**\r\n * Determines whether an object can have data\r\n */\r\njQuery.acceptData = function( elem ) {\r\n\tvar noData = jQuery.noData[ (elem.nodeName + \" \").toLowerCase() ],\r\n\t\tnodeType = +elem.nodeType || 1;\r\n\r\n\t// Do not set data on non-element DOM nodes because it will not be cleared (#8335).\r\n\treturn nodeType !== 1 && nodeType !== 9 ?\r\n\t\tfalse :\r\n\r\n\t\t// Nodes accept data unless otherwise specified; rejection can be conditional\r\n\t\t!noData || noData !== true && elem.getAttribute(\"classid\") === noData;\r\n};\r\n\r\n\r\nvar rbrace = /^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,\r\n\trmultiDash = /([A-Z])/g;\r\n\r\nfunction dataAttr( elem, key, data ) {\r\n\t// If nothing was found internally, try to fetch any\r\n\t// data from the HTML5 data-* attribute\r\n\tif ( data === undefined && elem.nodeType === 1 ) {\r\n\r\n\t\tvar name = \"data-\" + key.replace( rmultiDash, \"-$1\" ).toLowerCase();\r\n\r\n\t\tdata = elem.getAttribute( name );\r\n\r\n\t\tif ( typeof data === \"string\" ) {\r\n\t\t\ttry {\r\n\t\t\t\tdata = data === \"true\" ? true :\r\n\t\t\t\t\tdata === \"false\" ? false :\r\n\t\t\t\t\tdata === \"null\" ? null :\r\n\t\t\t\t\t// Only convert to a number if it doesn't change the string\r\n\t\t\t\t\t+data + \"\" === data ? +data :\r\n\t\t\t\t\trbrace.test( data ) ? jQuery.parseJSON( data ) :\r\n\t\t\t\t\tdata;\r\n\t\t\t} catch( e ) {}\r\n\r\n\t\t\t// Make sure we set the data so it isn't changed later\r\n\t\t\tjQuery.data( elem, key, data );\r\n\r\n\t\t} else {\r\n\t\t\tdata = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\treturn data;\r\n}\r\n\r\n// checks a cache object for emptiness\r\nfunction isEmptyDataObject( obj ) {\r\n\tvar name;\r\n\tfor ( name in obj ) {\r\n\r\n\t\t// if the public data object is empty, the private is still empty\r\n\t\tif ( name === \"data\" && jQuery.isEmptyObject( obj[name] ) ) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif ( name !== \"toJSON\" ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nfunction internalData( elem, name, data, pvt /* Internal Use Only */ ) {\r\n\tif ( !jQuery.acceptData( elem ) ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar ret, thisCache,\r\n\t\tinternalKey = jQuery.expando,\r\n\r\n\t\t// We have to handle DOM nodes and JS objects differently because IE6-7\r\n\t\t// can't GC object references properly across the DOM-JS boundary\r\n\t\tisNode = elem.nodeType,\r\n\r\n\t\t// Only DOM nodes need the global jQuery cache; JS object data is\r\n\t\t// attached directly to the object so GC can occur automatically\r\n\t\tcache = isNode ? jQuery.cache : elem,\r\n\r\n\t\t// Only defining an ID for JS objects if its cache already exists allows\r\n\t\t// the code to shortcut on the same path as a DOM node with no cache\r\n\t\tid = isNode ? elem[ internalKey ] : elem[ internalKey ] && internalKey;\r\n\r\n\t// Avoid doing any more work than we need to when trying to get data on an\r\n\t// object that has no data at all\r\n\tif ( (!id || !cache[id] || (!pvt && !cache[id].data)) && data === undefined && typeof name === \"string\" ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( !id ) {\r\n\t\t// Only DOM nodes need a new unique ID for each element since their data\r\n\t\t// ends up in the global cache\r\n\t\tif ( isNode ) {\r\n\t\t\tid = elem[ internalKey ] = deletedIds.pop() || jQuery.guid++;\r\n\t\t} else {\r\n\t\t\tid = internalKey;\r\n\t\t}\r\n\t}\r\n\r\n\tif ( !cache[ id ] ) {\r\n\t\t// Avoid exposing jQuery metadata on plain JS objects when the object\r\n\t\t// is serialized using JSON.stringify\r\n\t\tcache[ id ] = isNode ? {} : { toJSON: jQuery.noop };\r\n\t}\r\n\r\n\t// An object can be passed to jQuery.data instead of a key/value pair; this gets\r\n\t// shallow copied over onto the existing cache\r\n\tif ( typeof name === \"object\" || typeof name === \"function\" ) {\r\n\t\tif ( pvt ) {\r\n\t\t\tcache[ id ] = jQuery.extend( cache[ id ], name );\r\n\t\t} else {\r\n\t\t\tcache[ id ].data = jQuery.extend( cache[ id ].data, name );\r\n\t\t}\r\n\t}\r\n\r\n\tthisCache = cache[ id ];\r\n\r\n\t// jQuery data() is stored in a separate object inside the object's internal data\r\n\t// cache in order to avoid key collisions between internal data and user-defined\r\n\t// data.\r\n\tif ( !pvt ) {\r\n\t\tif ( !thisCache.data ) {\r\n\t\t\tthisCache.data = {};\r\n\t\t}\r\n\r\n\t\tthisCache = thisCache.data;\r\n\t}\r\n\r\n\tif ( data !== undefined ) {\r\n\t\tthisCache[ jQuery.camelCase( name ) ] = data;\r\n\t}\r\n\r\n\t// Check for both converted-to-camel and non-converted data property names\r\n\t// If a data property was specified\r\n\tif ( typeof name === \"string\" ) {\r\n\r\n\t\t// First Try to find as-is property data\r\n\t\tret = thisCache[ name ];\r\n\r\n\t\t// Test for null|undefined property data\r\n\t\tif ( ret == null ) {\r\n\r\n\t\t\t// Try to find the camelCased property\r\n\t\t\tret = thisCache[ jQuery.camelCase( name ) ];\r\n\t\t}\r\n\t} else {\r\n\t\tret = thisCache;\r\n\t}\r\n\r\n\treturn ret;\r\n}\r\n\r\nfunction internalRemoveData( elem, name, pvt ) {\r\n\tif ( !jQuery.acceptData( elem ) ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar thisCache, i,\r\n\t\tisNode = elem.nodeType,\r\n\r\n\t\t// See jQuery.data for more information\r\n\t\tcache = isNode ? jQuery.cache : elem,\r\n\t\tid = isNode ? elem[ jQuery.expando ] : jQuery.expando;\r\n\r\n\t// If there is already no cache entry for this object, there is no\r\n\t// purpose in continuing\r\n\tif ( !cache[ id ] ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( name ) {\r\n\r\n\t\tthisCache = pvt ? cache[ id ] : cache[ id ].data;\r\n\r\n\t\tif ( thisCache ) {\r\n\r\n\t\t\t// Support array or space separated string names for data keys\r\n\t\t\tif ( !jQuery.isArray( name ) ) {\r\n\r\n\t\t\t\t// try the string as a key before any manipulation\r\n\t\t\t\tif ( name in thisCache ) {\r\n\t\t\t\t\tname = [ name ];\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// split the camel cased version by spaces unless a key with the spaces exists\r\n\t\t\t\t\tname = jQuery.camelCase( name );\r\n\t\t\t\t\tif ( name in thisCache ) {\r\n\t\t\t\t\t\tname = [ name ];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tname = name.split(\" \");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// If \"name\" is an array of keys...\r\n\t\t\t\t// When data is initially created, via (\"key\", \"val\") signature,\r\n\t\t\t\t// keys will be converted to camelCase.\r\n\t\t\t\t// Since there is no way to tell _how_ a key was added, remove\r\n\t\t\t\t// both plain key and camelCase key. #12786\r\n\t\t\t\t// This will only penalize the array argument path.\r\n\t\t\t\tname = name.concat( jQuery.map( name, jQuery.camelCase ) );\r\n\t\t\t}\r\n\r\n\t\t\ti = name.length;\r\n\t\t\twhile ( i-- ) {\r\n\t\t\t\tdelete thisCache[ name[i] ];\r\n\t\t\t}\r\n\r\n\t\t\t// If there is no data left in the cache, we want to continue\r\n\t\t\t// and let the cache object itself get destroyed\r\n\t\t\tif ( pvt ? !isEmptyDataObject(thisCache) : !jQuery.isEmptyObject(thisCache) ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// See jQuery.data for more information\r\n\tif ( !pvt ) {\r\n\t\tdelete cache[ id ].data;\r\n\r\n\t\t// Don't destroy the parent cache unless the internal data object\r\n\t\t// had been the only thing left in it\r\n\t\tif ( !isEmptyDataObject( cache[ id ] ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\t// Destroy the cache\r\n\tif ( isNode ) {\r\n\t\tjQuery.cleanData( [ elem ], true );\r\n\r\n\t// Use delete when supported for expandos or `cache` is not a window per isWindow (#10080)\r\n\t/* jshint eqeqeq: false */\r\n\t} else if ( support.deleteExpando || cache != cache.window ) {\r\n\t\t/* jshint eqeqeq: true */\r\n\t\tdelete cache[ id ];\r\n\r\n\t// When all else fails, null\r\n\t} else {\r\n\t\tcache[ id ] = null;\r\n\t}\r\n}\r\n\r\njQuery.extend({\r\n\tcache: {},\r\n\r\n\t// The following elements (space-suffixed to avoid Object.prototype collisions)\r\n\t// throw uncatchable exceptions if you attempt to set expando properties\r\n\tnoData: {\r\n\t\t\"applet \": true,\r\n\t\t\"embed \": true,\r\n\t\t// ...but Flash objects (which have this classid) *can* handle expandos\r\n\t\t\"object \": \"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\"\r\n\t},\r\n\r\n\thasData: function( elem ) {\r\n\t\telem = elem.nodeType ? jQuery.cache[ elem[jQuery.expando] ] : elem[ jQuery.expando ];\r\n\t\treturn !!elem && !isEmptyDataObject( elem );\r\n\t},\r\n\r\n\tdata: function( elem, name, data ) {\r\n\t\treturn internalData( elem, name, data );\r\n\t},\r\n\r\n\tremoveData: function( elem, name ) {\r\n\t\treturn internalRemoveData( elem, name );\r\n\t},\r\n\r\n\t// For internal use only.\r\n\t_data: function( elem, name, data ) {\r\n\t\treturn internalData( elem, name, data, true );\r\n\t},\r\n\r\n\t_removeData: function( elem, name ) {\r\n\t\treturn internalRemoveData( elem, name, true );\r\n\t}\r\n});\r\n\r\njQuery.fn.extend({\r\n\tdata: function( key, value ) {\r\n\t\tvar i, name, data,\r\n\t\t\telem = this[0],\r\n\t\t\tattrs = elem && elem.attributes;\r\n\r\n\t\t// Special expections of .data basically thwart jQuery.access,\r\n\t\t// so implement the relevant behavior ourselves\r\n\r\n\t\t// Gets all values\r\n\t\tif ( key === undefined ) {\r\n\t\t\tif ( this.length ) {\r\n\t\t\t\tdata = jQuery.data( elem );\r\n\r\n\t\t\t\tif ( elem.nodeType === 1 && !jQuery._data( elem, \"parsedAttrs\" ) ) {\r\n\t\t\t\t\ti = attrs.length;\r\n\t\t\t\t\twhile ( i-- ) {\r\n\r\n\t\t\t\t\t\t// Support: IE11+\r\n\t\t\t\t\t\t// The attrs elements can be null (#14894)\r\n\t\t\t\t\t\tif ( attrs[ i ] ) {\r\n\t\t\t\t\t\t\tname = attrs[ i ].name;\r\n\t\t\t\t\t\t\tif ( name.indexOf( \"data-\" ) === 0 ) {\r\n\t\t\t\t\t\t\t\tname = jQuery.camelCase( name.slice(5) );\r\n\t\t\t\t\t\t\t\tdataAttr( elem, name, data[ name ] );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tjQuery._data( elem, \"parsedAttrs\", true );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\t\t// Sets multiple values\r\n\t\tif ( typeof key === \"object\" ) {\r\n\t\t\treturn this.each(function() {\r\n\t\t\t\tjQuery.data( this, key );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn arguments.length > 1 ?\r\n\r\n\t\t\t// Sets one value\r\n\t\t\tthis.each(function() {\r\n\t\t\t\tjQuery.data( this, key, value );\r\n\t\t\t}) :\r\n\r\n\t\t\t// Gets one value\r\n\t\t\t// Try to fetch any internally stored data first\r\n\t\t\telem ? dataAttr( elem, key, jQuery.data( elem, key ) ) : undefined;\r\n\t},\r\n\r\n\tremoveData: function( key ) {\r\n\t\treturn this.each(function() {\r\n\t\t\tjQuery.removeData( this, key );\r\n\t\t});\r\n\t}\r\n});\r\n\r\n\r\njQuery.extend({\r\n\tqueue: function( elem, type, data ) {\r\n\t\tvar queue;\r\n\r\n\t\tif ( elem ) {\r\n\t\t\ttype = ( type || \"fx\" ) + \"queue\";\r\n\t\t\tqueue = jQuery._data( elem, type );\r\n\r\n\t\t\t// Speed up dequeue by getting out quickly if this is just a lookup\r\n\t\t\tif ( data ) {\r\n\t\t\t\tif ( !queue || jQuery.isArray(data) ) {\r\n\t\t\t\t\tqueue = jQuery._data( elem, type, jQuery.makeArray(data) );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tqueue.push( data );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn queue || [];\r\n\t\t}\r\n\t},\r\n\r\n\tdequeue: function( elem, type ) {\r\n\t\ttype = type || \"fx\";\r\n\r\n\t\tvar queue = jQuery.queue( elem, type ),\r\n\t\t\tstartLength = queue.length,\r\n\t\t\tfn = queue.shift(),\r\n\t\t\thooks = jQuery._queueHooks( elem, type ),\r\n\t\t\tnext = function() {\r\n\t\t\t\tjQuery.dequeue( elem, type );\r\n\t\t\t};\r\n\r\n\t\t// If the fx queue is dequeued, always remove the progress sentinel\r\n\t\tif ( fn === \"inprogress\" ) {\r\n\t\t\tfn = queue.shift();\r\n\t\t\tstartLength--;\r\n\t\t}\r\n\r\n\t\tif ( fn ) {\r\n\r\n\t\t\t// Add a progress sentinel to prevent the fx queue from being\r\n\t\t\t// automatically dequeued\r\n\t\t\tif ( type === \"fx\" ) {\r\n\t\t\t\tqueue.unshift( \"inprogress\" );\r\n\t\t\t}\r\n\r\n\t\t\t// clear up the last queue stop function\r\n\t\t\tdelete hooks.stop;\r\n\t\t\tfn.call( elem, next, hooks );\r\n\t\t}\r\n\r\n\t\tif ( !startLength && hooks ) {\r\n\t\t\thooks.empty.fire();\r\n\t\t}\r\n\t},\r\n\r\n\t// not intended for public consumption - generates a queueHooks object, or returns the current one\r\n\t_queueHooks: function( elem, type ) {\r\n\t\tvar key = type + \"queueHooks\";\r\n\t\treturn jQuery._data( elem, key ) || jQuery._data( elem, key, {\r\n\t\t\tempty: jQuery.Callbacks(\"once memory\").add(function() {\r\n\t\t\t\tjQuery._removeData( elem, type + \"queue\" );\r\n\t\t\t\tjQuery._removeData( elem, key );\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n});\r\n\r\njQuery.fn.extend({\r\n\tqueue: function( type, data ) {\r\n\t\tvar setter = 2;\r\n\r\n\t\tif ( typeof type !== \"string\" ) {\r\n\t\t\tdata = type;\r\n\t\t\ttype = \"fx\";\r\n\t\t\tsetter--;\r\n\t\t}\r\n\r\n\t\tif ( arguments.length < setter ) {\r\n\t\t\treturn jQuery.queue( this[0], type );\r\n\t\t}\r\n\r\n\t\treturn data === undefined ?\r\n\t\t\tthis :\r\n\t\t\tthis.each(function() {\r\n\t\t\t\tvar queue = jQuery.queue( this, type, data );\r\n\r\n\t\t\t\t// ensure a hooks for this queue\r\n\t\t\t\tjQuery._queueHooks( this, type );\r\n\r\n\t\t\t\tif ( type === \"fx\" && queue[0] !== \"inprogress\" ) {\r\n\t\t\t\t\tjQuery.dequeue( this, type );\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t},\r\n\tdequeue: function( type ) {\r\n\t\treturn this.each(function() {\r\n\t\t\tjQuery.dequeue( this, type );\r\n\t\t});\r\n\t},\r\n\tclearQueue: function( type ) {\r\n\t\treturn this.queue( type || \"fx\", [] );\r\n\t},\r\n\t// Get a promise resolved when queues of a certain type\r\n\t// are emptied (fx is the type by default)\r\n\tpromise: function( type, obj ) {\r\n\t\tvar tmp,\r\n\t\t\tcount = 1,\r\n\t\t\tdefer = jQuery.Deferred(),\r\n\t\t\telements = this,\r\n\t\t\ti = this.length,\r\n\t\t\tresolve = function() {\r\n\t\t\t\tif ( !( --count ) ) {\r\n\t\t\t\t\tdefer.resolveWith( elements, [ elements ] );\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\tif ( typeof type !== \"string\" ) {\r\n\t\t\tobj = type;\r\n\t\t\ttype = undefined;\r\n\t\t}\r\n\t\ttype = type || \"fx\";\r\n\r\n\t\twhile ( i-- ) {\r\n\t\t\ttmp = jQuery._data( elements[ i ], type + \"queueHooks\" );\r\n\t\t\tif ( tmp && tmp.empty ) {\r\n\t\t\t\tcount++;\r\n\t\t\t\ttmp.empty.add( resolve );\r\n\t\t\t}\r\n\t\t}\r\n\t\tresolve();\r\n\t\treturn defer.promise( obj );\r\n\t}\r\n});\r\nvar pnum = (/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/).source;\r\n\r\nvar cssExpand = [ \"Top\", \"Right\", \"Bottom\", \"Left\" ];\r\n\r\nvar isHidden = function( elem, el ) {\r\n\t\t// isHidden might be called from jQuery#filter function;\r\n\t\t// in that case, element will be second argument\r\n\t\telem = el || elem;\r\n\t\treturn jQuery.css( elem, \"display\" ) === \"none\" || !jQuery.contains( elem.ownerDocument, elem );\r\n\t};\r\n\r\n\r\n\r\n// Multifunctional method to get and set values of a collection\r\n// The value/s can optionally be executed if it's a function\r\nvar access = jQuery.access = function( elems, fn, key, value, chainable, emptyGet, raw ) {\r\n\tvar i = 0,\r\n\t\tlength = elems.length,\r\n\t\tbulk = key == null;\r\n\r\n\t// Sets many values\r\n\tif ( jQuery.type( key ) === \"object\" ) {\r\n\t\tchainable = true;\r\n\t\tfor ( i in key ) {\r\n\t\t\tjQuery.access( elems, fn, i, key[i], true, emptyGet, raw );\r\n\t\t}\r\n\r\n\t// Sets one value\r\n\t} else if ( value !== undefined ) {\r\n\t\tchainable = true;\r\n\r\n\t\tif ( !jQuery.isFunction( value ) ) {\r\n\t\t\traw = true;\r\n\t\t}\r\n\r\n\t\tif ( bulk ) {\r\n\t\t\t// Bulk operations run against the entire set\r\n\t\t\tif ( raw ) {\r\n\t\t\t\tfn.call( elems, value );\r\n\t\t\t\tfn = null;\r\n\r\n\t\t\t// ...except when executing function values\r\n\t\t\t} else {\r\n\t\t\t\tbulk = fn;\r\n\t\t\t\tfn = function( elem, key, value ) {\r\n\t\t\t\t\treturn bulk.call( jQuery( elem ), value );\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( fn ) {\r\n\t\t\tfor ( ; i < length; i++ ) {\r\n\t\t\t\tfn( elems[i], key, raw ? value : value.call( elems[i], i, fn( elems[i], key ) ) );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn chainable ?\r\n\t\telems :\r\n\r\n\t\t// Gets\r\n\t\tbulk ?\r\n\t\t\tfn.call( elems ) :\r\n\t\t\tlength ? fn( elems[0], key ) : emptyGet;\r\n};\r\nvar rcheckableType = (/^(?:checkbox|radio)$/i);\r\n\r\n\r\n\r\n(function() {\r\n\t// Minified: var a,b,c\r\n\tvar input = document.createElement( \"input\" ),\r\n\t\tdiv = document.createElement( \"div\" ),\r\n\t\tfragment = document.createDocumentFragment();\r\n\r\n\t// Setup\r\n\tdiv.innerHTML = \"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\";\r\n\r\n\t// IE strips leading whitespace when .innerHTML is used\r\n\tsupport.leadingWhitespace = div.firstChild.nodeType === 3;\r\n\r\n\t// Make sure that tbody elements aren't automatically inserted\r\n\t// IE will insert them into empty tables\r\n\tsupport.tbody = !div.getElementsByTagName( \"tbody\" ).length;\r\n\r\n\t// Make sure that link elements get serialized correctly by innerHTML\r\n\t// This requires a wrapper element in IE\r\n\tsupport.htmlSerialize = !!div.getElementsByTagName( \"link\" ).length;\r\n\r\n\t// Makes sure cloning an html5 element does not cause problems\r\n\t// Where outerHTML is undefined, this still works\r\n\tsupport.html5Clone =\r\n\t\tdocument.createElement( \"nav\" ).cloneNode( true ).outerHTML !== \"<:nav></:nav>\";\r\n\r\n\t// Check if a disconnected checkbox will retain its checked\r\n\t// value of true after appended to the DOM (IE6/7)\r\n\tinput.type = \"checkbox\";\r\n\tinput.checked = true;\r\n\tfragment.appendChild( input );\r\n\tsupport.appendChecked = input.checked;\r\n\r\n\t// Make sure textarea (and checkbox) defaultValue is properly cloned\r\n\t// Support: IE6-IE11+\r\n\tdiv.innerHTML = \"<textarea>x</textarea>\";\r\n\tsupport.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;\r\n\r\n\t// #11217 - WebKit loses check when the name is after the checked attribute\r\n\tfragment.appendChild( div );\r\n\tdiv.innerHTML = \"<input type='radio' checked='checked' name='t'/>\";\r\n\r\n\t// Support: Safari 5.1, iOS 5.1, Android 4.x, Android 2.3\r\n\t// old WebKit doesn't clone checked state correctly in fragments\r\n\tsupport.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;\r\n\r\n\t// Support: IE<9\r\n\t// Opera does not clone events (and typeof div.attachEvent === undefined).\r\n\t// IE9-10 clones events bound via attachEvent, but they don't trigger with .click()\r\n\tsupport.noCloneEvent = true;\r\n\tif ( div.attachEvent ) {\r\n\t\tdiv.attachEvent( \"onclick\", function() {\r\n\t\t\tsupport.noCloneEvent = false;\r\n\t\t});\r\n\r\n\t\tdiv.cloneNode( true ).click();\r\n\t}\r\n\r\n\t// Execute the test only if not already executed in another module.\r\n\tif (support.deleteExpando == null) {\r\n\t\t// Support: IE<9\r\n\t\tsupport.deleteExpando = true;\r\n\t\ttry {\r\n\t\t\tdelete div.test;\r\n\t\t} catch( e ) {\r\n\t\t\tsupport.deleteExpando = false;\r\n\t\t}\r\n\t}\r\n})();\r\n\r\n\r\n(function() {\r\n\tvar i, eventName,\r\n\t\tdiv = document.createElement( \"div\" );\r\n\r\n\t// Support: IE<9 (lack submit/change bubble), Firefox 23+ (lack focusin event)\r\n\tfor ( i in { submit: true, change: true, focusin: true }) {\r\n\t\teventName = \"on\" + i;\r\n\r\n\t\tif ( !(support[ i + \"Bubbles\" ] = eventName in window) ) {\r\n\t\t\t// Beware of CSP restrictions (https://developer.mozilla.org/en/Security/CSP)\r\n\t\t\tdiv.setAttribute( eventName, \"t\" );\r\n\t\t\tsupport[ i + \"Bubbles\" ] = div.attributes[ eventName ].expando === false;\r\n\t\t}\r\n\t}\r\n\r\n\t// Null elements to avoid leaks in IE.\r\n\tdiv = null;\r\n})();\r\n\r\n\r\nvar rformElems = /^(?:input|select|textarea)$/i,\r\n\trkeyEvent = /^key/,\r\n\trmouseEvent = /^(?:mouse|pointer|contextmenu)|click/,\r\n\trfocusMorph = /^(?:focusinfocus|focusoutblur)$/,\r\n\trtypenamespace = /^([^.]*)(?:\\.(.+)|)$/;\r\n\r\nfunction returnTrue() {\r\n\treturn true;\r\n}\r\n\r\nfunction returnFalse() {\r\n\treturn false;\r\n}\r\n\r\nfunction safeActiveElement() {\r\n\ttry {\r\n\t\treturn document.activeElement;\r\n\t} catch ( err ) { }\r\n}\r\n\r\n/*\r\n * Helper functions for managing events -- not part of the public interface.\r\n * Props to Dean Edwards' addEvent library for many of the ideas.\r\n */\r\njQuery.event = {\r\n\r\n\tglobal: {},\r\n\r\n\tadd: function( elem, types, handler, data, selector ) {\r\n\t\tvar tmp, events, t, handleObjIn,\r\n\t\t\tspecial, eventHandle, handleObj,\r\n\t\t\thandlers, type, namespaces, origType,\r\n\t\t\telemData = jQuery._data( elem );\r\n\r\n\t\t// Don't attach events to noData or text/comment nodes (but allow plain objects)\r\n\t\tif ( !elemData ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Caller can pass in an object of custom data in lieu of the handler\r\n\t\tif ( handler.handler ) {\r\n\t\t\thandleObjIn = handler;\r\n\t\t\thandler = handleObjIn.handler;\r\n\t\t\tselector = handleObjIn.selector;\r\n\t\t}\r\n\r\n\t\t// Make sure that the handler has a unique ID, used to find/remove it later\r\n\t\tif ( !handler.guid ) {\r\n\t\t\thandler.guid = jQuery.guid++;\r\n\t\t}\r\n\r\n\t\t// Init the element's event structure and main handler, if this is the first\r\n\t\tif ( !(events = elemData.events) ) {\r\n\t\t\tevents = elemData.events = {};\r\n\t\t}\r\n\t\tif ( !(eventHandle = elemData.handle) ) {\r\n\t\t\teventHandle = elemData.handle = function( e ) {\r\n\t\t\t\t// Discard the second event of a jQuery.event.trigger() and\r\n\t\t\t\t// when an event is called after a page has unloaded\r\n\t\t\t\treturn typeof jQuery !== strundefined && (!e || jQuery.event.triggered !== e.type) ?\r\n\t\t\t\t\tjQuery.event.dispatch.apply( eventHandle.elem, arguments ) :\r\n\t\t\t\t\tundefined;\r\n\t\t\t};\r\n\t\t\t// Add elem as a property of the handle fn to prevent a memory leak with IE non-native events\r\n\t\t\teventHandle.elem = elem;\r\n\t\t}\r\n\r\n\t\t// Handle multiple events separated by a space\r\n\t\ttypes = ( types || \"\" ).match( rnotwhite ) || [ \"\" ];\r\n\t\tt = types.length;\r\n\t\twhile ( t-- ) {\r\n\t\t\ttmp = rtypenamespace.exec( types[t] ) || [];\r\n\t\t\ttype = origType = tmp[1];\r\n\t\t\tnamespaces = ( tmp[2] || \"\" ).split( \".\" ).sort();\r\n\r\n\t\t\t// There *must* be a type, no attaching namespace-only handlers\r\n\t\t\tif ( !type ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// If event changes its type, use the special event handlers for the changed type\r\n\t\t\tspecial = jQuery.event.special[ type ] || {};\r\n\r\n\t\t\t// If selector defined, determine special event api type, otherwise given type\r\n\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\r\n\r\n\t\t\t// Update special based on newly reset type\r\n\t\t\tspecial = jQuery.event.special[ type ] || {};\r\n\r\n\t\t\t// handleObj is passed to all event handlers\r\n\t\t\thandleObj = jQuery.extend({\r\n\t\t\t\ttype: type,\r\n\t\t\t\torigType: origType,\r\n\t\t\t\tdata: data,\r\n\t\t\t\thandler: handler,\r\n\t\t\t\tguid: handler.guid,\r\n\t\t\t\tselector: selector,\r\n\t\t\t\tneedsContext: selector && jQuery.expr.match.needsContext.test( selector ),\r\n\t\t\t\tnamespace: namespaces.join(\".\")\r\n\t\t\t}, handleObjIn );\r\n\r\n\t\t\t// Init the event handler queue if we're the first\r\n\t\t\tif ( !(handlers = events[ type ]) ) {\r\n\t\t\t\thandlers = events[ type ] = [];\r\n\t\t\t\thandlers.delegateCount = 0;\r\n\r\n\t\t\t\t// Only use addEventListener/attachEvent if the special events handler returns false\r\n\t\t\t\tif ( !special.setup || special.setup.call( elem, data, namespaces, eventHandle ) === false ) {\r\n\t\t\t\t\t// Bind the global event handler to the element\r\n\t\t\t\t\tif ( elem.addEventListener ) {\r\n\t\t\t\t\t\telem.addEventListener( type, eventHandle, false );\r\n\r\n\t\t\t\t\t} else if ( elem.attachEvent ) {\r\n\t\t\t\t\t\telem.attachEvent( \"on\" + type, eventHandle );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ( special.add ) {\r\n\t\t\t\tspecial.add.call( elem, handleObj );\r\n\r\n\t\t\t\tif ( !handleObj.handler.guid ) {\r\n\t\t\t\t\thandleObj.handler.guid = handler.guid;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Add to the element's handler list, delegates in front\r\n\t\t\tif ( selector ) {\r\n\t\t\t\thandlers.splice( handlers.delegateCount++, 0, handleObj );\r\n\t\t\t} else {\r\n\t\t\t\thandlers.push( handleObj );\r\n\t\t\t}\r\n\r\n\t\t\t// Keep track of which events have ever been used, for event optimization\r\n\t\t\tjQuery.event.global[ type ] = true;\r\n\t\t}\r\n\r\n\t\t// Nullify elem to prevent memory leaks in IE\r\n\t\telem = null;\r\n\t},\r\n\r\n\t// Detach an event or set of events from an element\r\n\tremove: function( elem, types, handler, selector, mappedTypes ) {\r\n\t\tvar j, handleObj, tmp,\r\n\t\t\torigCount, t, events,\r\n\t\t\tspecial, handlers, type,\r\n\t\t\tnamespaces, origType,\r\n\t\t\telemData = jQuery.hasData( elem ) && jQuery._data( elem );\r\n\r\n\t\tif ( !elemData || !(events = elemData.events) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Once for each type.namespace in types; type may be omitted\r\n\t\ttypes = ( types || \"\" ).match( rnotwhite ) || [ \"\" ];\r\n\t\tt = types.length;\r\n\t\twhile ( t-- ) {\r\n\t\t\ttmp = rtypenamespace.exec( types[t] ) || [];\r\n\t\t\ttype = origType = tmp[1];\r\n\t\t\tnamespaces = ( tmp[2] || \"\" ).split( \".\" ).sort();\r\n\r\n\t\t\t// Unbind all events (on this namespace, if provided) for the element\r\n\t\t\tif ( !type ) {\r\n\t\t\t\tfor ( type in events ) {\r\n\t\t\t\t\tjQuery.event.remove( elem, type + types[ t ], handler, selector, true );\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tspecial = jQuery.event.special[ type ] || {};\r\n\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\r\n\t\t\thandlers = events[ type ] || [];\r\n\t\t\ttmp = tmp[2] && new RegExp( \"(^|\\\\.)\" + namespaces.join(\"\\\\.(?:.*\\\\.|)\") + \"(\\\\.|$)\" );\r\n\r\n\t\t\t// Remove matching events\r\n\t\t\torigCount = j = handlers.length;\r\n\t\t\twhile ( j-- ) {\r\n\t\t\t\thandleObj = handlers[ j ];\r\n\r\n\t\t\t\tif ( ( mappedTypes || origType === handleObj.origType ) &&\r\n\t\t\t\t\t( !handler || handler.guid === handleObj.guid ) &&\r\n\t\t\t\t\t( !tmp || tmp.test( handleObj.namespace ) ) &&\r\n\t\t\t\t\t( !selector || selector === handleObj.selector || selector === \"**\" && handleObj.selector ) ) {\r\n\t\t\t\t\thandlers.splice( j, 1 );\r\n\r\n\t\t\t\t\tif ( handleObj.selector ) {\r\n\t\t\t\t\t\thandlers.delegateCount--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( special.remove ) {\r\n\t\t\t\t\t\tspecial.remove.call( elem, handleObj );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Remove generic event handler if we removed something and no more handlers exist\r\n\t\t\t// (avoids potential for endless recursion during removal of special event handlers)\r\n\t\t\tif ( origCount && !handlers.length ) {\r\n\t\t\t\tif ( !special.teardown || special.teardown.call( elem, namespaces, elemData.handle ) === false ) {\r\n\t\t\t\t\tjQuery.removeEvent( elem, type, elemData.handle );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdelete events[ type ];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Remove the expando if it's no longer used\r\n\t\tif ( jQuery.isEmptyObject( events ) ) {\r\n\t\t\tdelete elemData.handle;\r\n\r\n\t\t\t// removeData also checks for emptiness and clears the expando if empty\r\n\t\t\t// so use it instead of delete\r\n\t\t\tjQuery._removeData( elem, \"events\" );\r\n\t\t}\r\n\t},\r\n\r\n\ttrigger: function( event, data, elem, onlyHandlers ) {\r\n\t\tvar handle, ontype, cur,\r\n\t\t\tbubbleType, special, tmp, i,\r\n\t\t\teventPath = [ elem || document ],\r\n\t\t\ttype = hasOwn.call( event, \"type\" ) ? event.type : event,\r\n\t\t\tnamespaces = hasOwn.call( event, \"namespace\" ) ? event.namespace.split(\".\") : [];\r\n\r\n\t\tcur = tmp = elem = elem || document;\r\n\r\n\t\t// Don't do events on text and comment nodes\r\n\t\tif ( elem.nodeType === 3 || elem.nodeType === 8 ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// focus/blur morphs to focusin/out; ensure we're not firing them right now\r\n\t\tif ( rfocusMorph.test( type + jQuery.event.triggered ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( type.indexOf(\".\") >= 0 ) {\r\n\t\t\t// Namespaced trigger; create a regexp to match event type in handle()\r\n\t\t\tnamespaces = type.split(\".\");\r\n\t\t\ttype = namespaces.shift();\r\n\t\t\tnamespaces.sort();\r\n\t\t}\r\n\t\tontype = type.indexOf(\":\") < 0 && \"on\" + type;\r\n\r\n\t\t// Caller can pass in a jQuery.Event object, Object, or just an event type string\r\n\t\tevent = event[ jQuery.expando ] ?\r\n\t\t\tevent :\r\n\t\t\tnew jQuery.Event( type, typeof event === \"object\" && event );\r\n\r\n\t\t// Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)\r\n\t\tevent.isTrigger = onlyHandlers ? 2 : 3;\r\n\t\tevent.namespace = namespaces.join(\".\");\r\n\t\tevent.namespace_re = event.namespace ?\r\n\t\t\tnew RegExp( \"(^|\\\\.)\" + namespaces.join(\"\\\\.(?:.*\\\\.|)\") + \"(\\\\.|$)\" ) :\r\n\t\t\tnull;\r\n\r\n\t\t// Clean up the event in case it is being reused\r\n\t\tevent.result = undefined;\r\n\t\tif ( !event.target ) {\r\n\t\t\tevent.target = elem;\r\n\t\t}\r\n\r\n\t\t// Clone any incoming data and prepend the event, creating the handler arg list\r\n\t\tdata = data == null ?\r\n\t\t\t[ event ] :\r\n\t\t\tjQuery.makeArray( data, [ event ] );\r\n\r\n\t\t// Allow special events to draw outside the lines\r\n\t\tspecial = jQuery.event.special[ type ] || {};\r\n\t\tif ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Determine event propagation path in advance, per W3C events spec (#9951)\r\n\t\t// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)\r\n\t\tif ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {\r\n\r\n\t\t\tbubbleType = special.delegateType || type;\r\n\t\t\tif ( !rfocusMorph.test( bubbleType + type ) ) {\r\n\t\t\t\tcur = cur.parentNode;\r\n\t\t\t}\r\n\t\t\tfor ( ; cur; cur = cur.parentNode ) {\r\n\t\t\t\teventPath.push( cur );\r\n\t\t\t\ttmp = cur;\r\n\t\t\t}\r\n\r\n\t\t\t// Only add window if we got to document (e.g., not plain obj or detached DOM)\r\n\t\t\tif ( tmp === (elem.ownerDocument || document) ) {\r\n\t\t\t\teventPath.push( tmp.defaultView || tmp.parentWindow || window );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Fire handlers on the event path\r\n\t\ti = 0;\r\n\t\twhile ( (cur = eventPath[i++]) && !event.isPropagationStopped() ) {\r\n\r\n\t\t\tevent.type = i > 1 ?\r\n\t\t\t\tbubbleType :\r\n\t\t\t\tspecial.bindType || type;\r\n\r\n\t\t\t// jQuery handler\r\n\t\t\thandle = ( jQuery._data( cur, \"events\" ) || {} )[ event.type ] && jQuery._data( cur, \"handle\" );\r\n\t\t\tif ( handle ) {\r\n\t\t\t\thandle.apply( cur, data );\r\n\t\t\t}\r\n\r\n\t\t\t// Native handler\r\n\t\t\thandle = ontype && cur[ ontype ];\r\n\t\t\tif ( handle && handle.apply && jQuery.acceptData( cur ) ) {\r\n\t\t\t\tevent.result = handle.apply( cur, data );\r\n\t\t\t\tif ( event.result === false ) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tevent.type = type;\r\n\r\n\t\t// If nobody prevented the default action, do it now\r\n\t\tif ( !onlyHandlers && !event.isDefaultPrevented() ) {\r\n\r\n\t\t\tif ( (!special._default || special._default.apply( eventPath.pop(), data ) === false) &&\r\n\t\t\t\tjQuery.acceptData( elem ) ) {\r\n\r\n\t\t\t\t// Call a native DOM method on the target with the same name name as the event.\r\n\t\t\t\t// Can't use an .isFunction() check here because IE6/7 fails that test.\r\n\t\t\t\t// Don't do default actions on window, that's where global variables be (#6170)\r\n\t\t\t\tif ( ontype && elem[ type ] && !jQuery.isWindow( elem ) ) {\r\n\r\n\t\t\t\t\t// Don't re-trigger an onFOO event when we call its FOO() method\r\n\t\t\t\t\ttmp = elem[ ontype ];\r\n\r\n\t\t\t\t\tif ( tmp ) {\r\n\t\t\t\t\t\telem[ ontype ] = null;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Prevent re-triggering of the same event, since we already bubbled it above\r\n\t\t\t\t\tjQuery.event.triggered = type;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\telem[ type ]();\r\n\t\t\t\t\t} catch ( e ) {\r\n\t\t\t\t\t\t// IE<9 dies on focus/blur to hidden element (#1486,#12518)\r\n\t\t\t\t\t\t// only reproducible on winXP IE8 native, not IE9 in IE8 mode\r\n\t\t\t\t\t}\r\n\t\t\t\t\tjQuery.event.triggered = undefined;\r\n\r\n\t\t\t\t\tif ( tmp ) {\r\n\t\t\t\t\t\telem[ ontype ] = tmp;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn event.result;\r\n\t},\r\n\r\n\tdispatch: function( event ) {\r\n\r\n\t\t// Make a writable jQuery.Event from the native event object\r\n\t\tevent = jQuery.event.fix( event );\r\n\r\n\t\tvar i, ret, handleObj, matched, j,\r\n\t\t\thandlerQueue = [],\r\n\t\t\targs = slice.call( arguments ),\r\n\t\t\thandlers = ( jQuery._data( this, \"events\" ) || {} )[ event.type ] || [],\r\n\t\t\tspecial = jQuery.event.special[ event.type ] || {};\r\n\r\n\t\t// Use the fix-ed jQuery.Event rather than the (read-only) native event\r\n\t\targs[0] = event;\r\n\t\tevent.delegateTarget = this;\r\n\r\n\t\t// Call the preDispatch hook for the mapped type, and let it bail if desired\r\n\t\tif ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Determine handlers\r\n\t\thandlerQueue = jQuery.event.handlers.call( this, event, handlers );\r\n\r\n\t\t// Run delegates first; they may want to stop propagation beneath us\r\n\t\ti = 0;\r\n\t\twhile ( (matched = handlerQueue[ i++ ]) && !event.isPropagationStopped() ) {\r\n\t\t\tevent.currentTarget = matched.elem;\r\n\r\n\t\t\tj = 0;\r\n\t\t\twhile ( (handleObj = matched.handlers[ j++ ]) && !event.isImmediatePropagationStopped() ) {\r\n\r\n\t\t\t\t// Triggered event must either 1) have no namespace, or\r\n\t\t\t\t// 2) have namespace(s) a subset or equal to those in the bound event (both can have no namespace).\r\n\t\t\t\tif ( !event.namespace_re || event.namespace_re.test( handleObj.namespace ) ) {\r\n\r\n\t\t\t\t\tevent.handleObj = handleObj;\r\n\t\t\t\t\tevent.data = handleObj.data;\r\n\r\n\t\t\t\t\tret = ( (jQuery.event.special[ handleObj.origType ] || {}).handle || handleObj.handler )\r\n\t\t\t\t\t\t\t.apply( matched.elem, args );\r\n\r\n\t\t\t\t\tif ( ret !== undefined ) {\r\n\t\t\t\t\t\tif ( (event.result = ret) === false ) {\r\n\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Call the postDispatch hook for the mapped type\r\n\t\tif ( special.postDispatch ) {\r\n\t\t\tspecial.postDispatch.call( this, event );\r\n\t\t}\r\n\r\n\t\treturn event.result;\r\n\t},\r\n\r\n\thandlers: function( event, handlers ) {\r\n\t\tvar sel, handleObj, matches, i,\r\n\t\t\thandlerQueue = [],\r\n\t\t\tdelegateCount = handlers.delegateCount,\r\n\t\t\tcur = event.target;\r\n\r\n\t\t// Find delegate handlers\r\n\t\t// Black-hole SVG <use> instance trees (#13180)\r\n\t\t// Avoid non-left-click bubbling in Firefox (#3861)\r\n\t\tif ( delegateCount && cur.nodeType && (!event.button || event.type !== \"click\") ) {\r\n\r\n\t\t\t/* jshint eqeqeq: false */\r\n\t\t\tfor ( ; cur != this; cur = cur.parentNode || this ) {\r\n\t\t\t\t/* jshint eqeqeq: true */\r\n\r\n\t\t\t\t// Don't check non-elements (#13208)\r\n\t\t\t\t// Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)\r\n\t\t\t\tif ( cur.nodeType === 1 && (cur.disabled !== true || event.type !== \"click\") ) {\r\n\t\t\t\t\tmatches = [];\r\n\t\t\t\t\tfor ( i = 0; i < delegateCount; i++ ) {\r\n\t\t\t\t\t\thandleObj = handlers[ i ];\r\n\r\n\t\t\t\t\t\t// Don't conflict with Object.prototype properties (#13203)\r\n\t\t\t\t\t\tsel = handleObj.selector + \" \";\r\n\r\n\t\t\t\t\t\tif ( matches[ sel ] === undefined ) {\r\n\t\t\t\t\t\t\tmatches[ sel ] = handleObj.needsContext ?\r\n\t\t\t\t\t\t\t\tjQuery( sel, this ).index( cur ) >= 0 :\r\n\t\t\t\t\t\t\t\tjQuery.find( sel, this, null, [ cur ] ).length;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( matches[ sel ] ) {\r\n\t\t\t\t\t\t\tmatches.push( handleObj );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( matches.length ) {\r\n\t\t\t\t\t\thandlerQueue.push({ elem: cur, handlers: matches });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Add the remaining (directly-bound) handlers\r\n\t\tif ( delegateCount < handlers.length ) {\r\n\t\t\thandlerQueue.push({ elem: this, handlers: handlers.slice( delegateCount ) });\r\n\t\t}\r\n\r\n\t\treturn handlerQueue;\r\n\t},\r\n\r\n\tfix: function( event ) {\r\n\t\tif ( event[ jQuery.expando ] ) {\r\n\t\t\treturn event;\r\n\t\t}\r\n\r\n\t\t// Create a writable copy of the event object and normalize some properties\r\n\t\tvar i, prop, copy,\r\n\t\t\ttype = event.type,\r\n\t\t\toriginalEvent = event,\r\n\t\t\tfixHook = this.fixHooks[ type ];\r\n\r\n\t\tif ( !fixHook ) {\r\n\t\t\tthis.fixHooks[ type ] = fixHook =\r\n\t\t\t\trmouseEvent.test( type ) ? this.mouseHooks :\r\n\t\t\t\trkeyEvent.test( type ) ? this.keyHooks :\r\n\t\t\t\t{};\r\n\t\t}\r\n\t\tcopy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;\r\n\r\n\t\tevent = new jQuery.Event( originalEvent );\r\n\r\n\t\ti = copy.length;\r\n\t\twhile ( i-- ) {\r\n\t\t\tprop = copy[ i ];\r\n\t\t\tevent[ prop ] = originalEvent[ prop ];\r\n\t\t}\r\n\r\n\t\t// Support: IE<9\r\n\t\t// Fix target property (#1925)\r\n\t\tif ( !event.target ) {\r\n\t\t\tevent.target = originalEvent.srcElement || document;\r\n\t\t}\r\n\r\n\t\t// Support: Chrome 23+, Safari?\r\n\t\t// Target should not be a text node (#504, #13143)\r\n\t\tif ( event.target.nodeType === 3 ) {\r\n\t\t\tevent.target = event.target.parentNode;\r\n\t\t}\r\n\r\n\t\t// Support: IE<9\r\n\t\t// For mouse/key events, metaKey==false if it's undefined (#3368, #11328)\r\n\t\tevent.metaKey = !!event.metaKey;\r\n\r\n\t\treturn fixHook.filter ? fixHook.filter( event, originalEvent ) : event;\r\n\t},\r\n\r\n\t// Includes some event props shared by KeyEvent and MouseEvent\r\n\tprops: \"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),\r\n\r\n\tfixHooks: {},\r\n\r\n\tkeyHooks: {\r\n\t\tprops: \"char charCode key keyCode\".split(\" \"),\r\n\t\tfilter: function( event, original ) {\r\n\r\n\t\t\t// Add which for key events\r\n\t\t\tif ( event.which == null ) {\r\n\t\t\t\tevent.which = original.charCode != null ? original.charCode : original.keyCode;\r\n\t\t\t}\r\n\r\n\t\t\treturn event;\r\n\t\t}\r\n\t},\r\n\r\n\tmouseHooks: {\r\n\t\tprops: \"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),\r\n\t\tfilter: function( event, original ) {\r\n\t\t\tvar body, eventDoc, doc,\r\n\t\t\t\tbutton = original.button,\r\n\t\t\t\tfromElement = original.fromElement;\r\n\r\n\t\t\t// Calculate pageX/Y if missing and clientX/Y available\r\n\t\t\tif ( event.pageX == null && original.clientX != null ) {\r\n\t\t\t\teventDoc = event.target.ownerDocument || document;\r\n\t\t\t\tdoc = eventDoc.documentElement;\r\n\t\t\t\tbody = eventDoc.body;\r\n\r\n\t\t\t\tevent.pageX = original.clientX + ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) - ( doc && doc.clientLeft || body && body.clientLeft || 0 );\r\n\t\t\t\tevent.pageY = original.clientY + ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) - ( doc && doc.clientTop  || body && body.clientTop  || 0 );\r\n\t\t\t}\r\n\r\n\t\t\t// Add relatedTarget, if necessary\r\n\t\t\tif ( !event.relatedTarget && fromElement ) {\r\n\t\t\t\tevent.relatedTarget = fromElement === event.target ? original.toElement : fromElement;\r\n\t\t\t}\r\n\r\n\t\t\t// Add which for click: 1 === left; 2 === middle; 3 === right\r\n\t\t\t// Note: button is not normalized, so don't use it\r\n\t\t\tif ( !event.which && button !== undefined ) {\r\n\t\t\t\tevent.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );\r\n\t\t\t}\r\n\r\n\t\t\treturn event;\r\n\t\t}\r\n\t},\r\n\r\n\tspecial: {\r\n\t\tload: {\r\n\t\t\t// Prevent triggered image.load events from bubbling to window.load\r\n\t\t\tnoBubble: true\r\n\t\t},\r\n\t\tfocus: {\r\n\t\t\t// Fire native event if possible so blur/focus sequence is correct\r\n\t\t\ttrigger: function() {\r\n\t\t\t\tif ( this !== safeActiveElement() && this.focus ) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tthis.focus();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} catch ( e ) {\r\n\t\t\t\t\t\t// Support: IE<9\r\n\t\t\t\t\t\t// If we error on focus to hidden element (#1486, #12518),\r\n\t\t\t\t\t\t// let .trigger() run the handlers\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdelegateType: \"focusin\"\r\n\t\t},\r\n\t\tblur: {\r\n\t\t\ttrigger: function() {\r\n\t\t\t\tif ( this === safeActiveElement() && this.blur ) {\r\n\t\t\t\t\tthis.blur();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdelegateType: \"focusout\"\r\n\t\t},\r\n\t\tclick: {\r\n\t\t\t// For checkbox, fire native event so checked state will be right\r\n\t\t\ttrigger: function() {\r\n\t\t\t\tif ( jQuery.nodeName( this, \"input\" ) && this.type === \"checkbox\" && this.click ) {\r\n\t\t\t\t\tthis.click();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// For cross-browser consistency, don't fire native .click() on links\r\n\t\t\t_default: function( event ) {\r\n\t\t\t\treturn jQuery.nodeName( event.target, \"a\" );\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tbeforeunload: {\r\n\t\t\tpostDispatch: function( event ) {\r\n\r\n\t\t\t\t// Support: Firefox 20+\r\n\t\t\t\t// Firefox doesn't alert if the returnValue field is not set.\r\n\t\t\t\tif ( event.result !== undefined && event.originalEvent ) {\r\n\t\t\t\t\tevent.originalEvent.returnValue = event.result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tsimulate: function( type, elem, event, bubble ) {\r\n\t\t// Piggyback on a donor event to simulate a different one.\r\n\t\t// Fake originalEvent to avoid donor's stopPropagation, but if the\r\n\t\t// simulated event prevents default then we do the same on the donor.\r\n\t\tvar e = jQuery.extend(\r\n\t\t\tnew jQuery.Event(),\r\n\t\t\tevent,\r\n\t\t\t{\r\n\t\t\t\ttype: type,\r\n\t\t\t\tisSimulated: true,\r\n\t\t\t\toriginalEvent: {}\r\n\t\t\t}\r\n\t\t);\r\n\t\tif ( bubble ) {\r\n\t\t\tjQuery.event.trigger( e, null, elem );\r\n\t\t} else {\r\n\t\t\tjQuery.event.dispatch.call( elem, e );\r\n\t\t}\r\n\t\tif ( e.isDefaultPrevented() ) {\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t}\r\n};\r\n\r\njQuery.removeEvent = document.removeEventListener ?\r\n\tfunction( elem, type, handle ) {\r\n\t\tif ( elem.removeEventListener ) {\r\n\t\t\telem.removeEventListener( type, handle, false );\r\n\t\t}\r\n\t} :\r\n\tfunction( elem, type, handle ) {\r\n\t\tvar name = \"on\" + type;\r\n\r\n\t\tif ( elem.detachEvent ) {\r\n\r\n\t\t\t// #8545, #7054, preventing memory leaks for custom events in IE6-8\r\n\t\t\t// detachEvent needed property on element, by name of that event, to properly expose it to GC\r\n\t\t\tif ( typeof elem[ name ] === strundefined ) {\r\n\t\t\t\telem[ name ] = null;\r\n\t\t\t}\r\n\r\n\t\t\telem.detachEvent( name, handle );\r\n\t\t}\r\n\t};\r\n\r\njQuery.Event = function( src, props ) {\r\n\t// Allow instantiation without the 'new' keyword\r\n\tif ( !(this instanceof jQuery.Event) ) {\r\n\t\treturn new jQuery.Event( src, props );\r\n\t}\r\n\r\n\t// Event object\r\n\tif ( src && src.type ) {\r\n\t\tthis.originalEvent = src;\r\n\t\tthis.type = src.type;\r\n\r\n\t\t// Events bubbling up the document may have been marked as prevented\r\n\t\t// by a handler lower down the tree; reflect the correct value.\r\n\t\tthis.isDefaultPrevented = src.defaultPrevented ||\r\n\t\t\t\tsrc.defaultPrevented === undefined &&\r\n\t\t\t\t// Support: IE < 9, Android < 4.0\r\n\t\t\t\tsrc.returnValue === false ?\r\n\t\t\treturnTrue :\r\n\t\t\treturnFalse;\r\n\r\n\t// Event type\r\n\t} else {\r\n\t\tthis.type = src;\r\n\t}\r\n\r\n\t// Put explicitly provided properties onto the event object\r\n\tif ( props ) {\r\n\t\tjQuery.extend( this, props );\r\n\t}\r\n\r\n\t// Create a timestamp if incoming event doesn't have one\r\n\tthis.timeStamp = src && src.timeStamp || jQuery.now();\r\n\r\n\t// Mark it as fixed\r\n\tthis[ jQuery.expando ] = true;\r\n};\r\n\r\n// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding\r\n// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html\r\njQuery.Event.prototype = {\r\n\tisDefaultPrevented: returnFalse,\r\n\tisPropagationStopped: returnFalse,\r\n\tisImmediatePropagationStopped: returnFalse,\r\n\r\n\tpreventDefault: function() {\r\n\t\tvar e = this.originalEvent;\r\n\r\n\t\tthis.isDefaultPrevented = returnTrue;\r\n\t\tif ( !e ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// If preventDefault exists, run it on the original event\r\n\t\tif ( e.preventDefault ) {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t// Support: IE\r\n\t\t// Otherwise set the returnValue property of the original event to false\r\n\t\t} else {\r\n\t\t\te.returnValue = false;\r\n\t\t}\r\n\t},\r\n\tstopPropagation: function() {\r\n\t\tvar e = this.originalEvent;\r\n\r\n\t\tthis.isPropagationStopped = returnTrue;\r\n\t\tif ( !e ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// If stopPropagation exists, run it on the original event\r\n\t\tif ( e.stopPropagation ) {\r\n\t\t\te.stopPropagation();\r\n\t\t}\r\n\r\n\t\t// Support: IE\r\n\t\t// Set the cancelBubble property of the original event to true\r\n\t\te.cancelBubble = true;\r\n\t},\r\n\tstopImmediatePropagation: function() {\r\n\t\tvar e = this.originalEvent;\r\n\r\n\t\tthis.isImmediatePropagationStopped = returnTrue;\r\n\r\n\t\tif ( e && e.stopImmediatePropagation ) {\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t}\r\n\r\n\t\tthis.stopPropagation();\r\n\t}\r\n};\r\n\r\n// Create mouseenter/leave events using mouseover/out and event-time checks\r\njQuery.each({\r\n\tmouseenter: \"mouseover\",\r\n\tmouseleave: \"mouseout\",\r\n\tpointerenter: \"pointerover\",\r\n\tpointerleave: \"pointerout\"\r\n}, function( orig, fix ) {\r\n\tjQuery.event.special[ orig ] = {\r\n\t\tdelegateType: fix,\r\n\t\tbindType: fix,\r\n\r\n\t\thandle: function( event ) {\r\n\t\t\tvar ret,\r\n\t\t\t\ttarget = this,\r\n\t\t\t\trelated = event.relatedTarget,\r\n\t\t\t\thandleObj = event.handleObj;\r\n\r\n\t\t\t// For mousenter/leave call the handler if related is outside the target.\r\n\t\t\t// NB: No relatedTarget if the mouse left/entered the browser window\r\n\t\t\tif ( !related || (related !== target && !jQuery.contains( target, related )) ) {\r\n\t\t\t\tevent.type = handleObj.origType;\r\n\t\t\t\tret = handleObj.handler.apply( this, arguments );\r\n\t\t\t\tevent.type = fix;\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t};\r\n});\r\n\r\n// IE submit delegation\r\nif ( !support.submitBubbles ) {\r\n\r\n\tjQuery.event.special.submit = {\r\n\t\tsetup: function() {\r\n\t\t\t// Only need this for delegated form submit events\r\n\t\t\tif ( jQuery.nodeName( this, \"form\" ) ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Lazy-add a submit handler when a descendant form may potentially be submitted\r\n\t\t\tjQuery.event.add( this, \"click._submit keypress._submit\", function( e ) {\r\n\t\t\t\t// Node name check avoids a VML-related crash in IE (#9807)\r\n\t\t\t\tvar elem = e.target,\r\n\t\t\t\t\tform = jQuery.nodeName( elem, \"input\" ) || jQuery.nodeName( elem, \"button\" ) ? elem.form : undefined;\r\n\t\t\t\tif ( form && !jQuery._data( form, \"submitBubbles\" ) ) {\r\n\t\t\t\t\tjQuery.event.add( form, \"submit._submit\", function( event ) {\r\n\t\t\t\t\t\tevent._submit_bubble = true;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tjQuery._data( form, \"submitBubbles\", true );\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// return undefined since we don't need an event listener\r\n\t\t},\r\n\r\n\t\tpostDispatch: function( event ) {\r\n\t\t\t// If form was submitted by the user, bubble the event up the tree\r\n\t\t\tif ( event._submit_bubble ) {\r\n\t\t\t\tdelete event._submit_bubble;\r\n\t\t\t\tif ( this.parentNode && !event.isTrigger ) {\r\n\t\t\t\t\tjQuery.event.simulate( \"submit\", this.parentNode, event, true );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tteardown: function() {\r\n\t\t\t// Only need this for delegated form submit events\r\n\t\t\tif ( jQuery.nodeName( this, \"form\" ) ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Remove delegated handlers; cleanData eventually reaps submit handlers attached above\r\n\t\t\tjQuery.event.remove( this, \"._submit\" );\r\n\t\t}\r\n\t};\r\n}\r\n\r\n// IE change delegation and checkbox/radio fix\r\nif ( !support.changeBubbles ) {\r\n\r\n\tjQuery.event.special.change = {\r\n\r\n\t\tsetup: function() {\r\n\r\n\t\t\tif ( rformElems.test( this.nodeName ) ) {\r\n\t\t\t\t// IE doesn't fire change on a check/radio until blur; trigger it on click\r\n\t\t\t\t// after a propertychange. Eat the blur-change in special.change.handle.\r\n\t\t\t\t// This still fires onchange a second time for check/radio after blur.\r\n\t\t\t\tif ( this.type === \"checkbox\" || this.type === \"radio\" ) {\r\n\t\t\t\t\tjQuery.event.add( this, \"propertychange._change\", function( event ) {\r\n\t\t\t\t\t\tif ( event.originalEvent.propertyName === \"checked\" ) {\r\n\t\t\t\t\t\t\tthis._just_changed = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tjQuery.event.add( this, \"click._change\", function( event ) {\r\n\t\t\t\t\t\tif ( this._just_changed && !event.isTrigger ) {\r\n\t\t\t\t\t\t\tthis._just_changed = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Allow triggered, simulated change events (#11500)\r\n\t\t\t\t\t\tjQuery.event.simulate( \"change\", this, event, true );\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t// Delegated event; lazy-add a change handler on descendant inputs\r\n\t\t\tjQuery.event.add( this, \"beforeactivate._change\", function( e ) {\r\n\t\t\t\tvar elem = e.target;\r\n\r\n\t\t\t\tif ( rformElems.test( elem.nodeName ) && !jQuery._data( elem, \"changeBubbles\" ) ) {\r\n\t\t\t\t\tjQuery.event.add( elem, \"change._change\", function( event ) {\r\n\t\t\t\t\t\tif ( this.parentNode && !event.isSimulated && !event.isTrigger ) {\r\n\t\t\t\t\t\t\tjQuery.event.simulate( \"change\", this.parentNode, event, true );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tjQuery._data( elem, \"changeBubbles\", true );\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\thandle: function( event ) {\r\n\t\t\tvar elem = event.target;\r\n\r\n\t\t\t// Swallow native change events from checkbox/radio, we already triggered them above\r\n\t\t\tif ( this !== elem || event.isSimulated || event.isTrigger || (elem.type !== \"radio\" && elem.type !== \"checkbox\") ) {\r\n\t\t\t\treturn event.handleObj.handler.apply( this, arguments );\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tteardown: function() {\r\n\t\t\tjQuery.event.remove( this, \"._change\" );\r\n\r\n\t\t\treturn !rformElems.test( this.nodeName );\r\n\t\t}\r\n\t};\r\n}\r\n\r\n// Create \"bubbling\" focus and blur events\r\nif ( !support.focusinBubbles ) {\r\n\tjQuery.each({ focus: \"focusin\", blur: \"focusout\" }, function( orig, fix ) {\r\n\r\n\t\t// Attach a single capturing handler on the document while someone wants focusin/focusout\r\n\t\tvar handler = function( event ) {\r\n\t\t\t\tjQuery.event.simulate( fix, event.target, jQuery.event.fix( event ), true );\r\n\t\t\t};\r\n\r\n\t\tjQuery.event.special[ fix ] = {\r\n\t\t\tsetup: function() {\r\n\t\t\t\tvar doc = this.ownerDocument || this,\r\n\t\t\t\t\tattaches = jQuery._data( doc, fix );\r\n\r\n\t\t\t\tif ( !attaches ) {\r\n\t\t\t\t\tdoc.addEventListener( orig, handler, true );\r\n\t\t\t\t}\r\n\t\t\t\tjQuery._data( doc, fix, ( attaches || 0 ) + 1 );\r\n\t\t\t},\r\n\t\t\tteardown: function() {\r\n\t\t\t\tvar doc = this.ownerDocument || this,\r\n\t\t\t\t\tattaches = jQuery._data( doc, fix ) - 1;\r\n\r\n\t\t\t\tif ( !attaches ) {\r\n\t\t\t\t\tdoc.removeEventListener( orig, handler, true );\r\n\t\t\t\t\tjQuery._removeData( doc, fix );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjQuery._data( doc, fix, attaches );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t});\r\n}\r\n\r\njQuery.fn.extend({\r\n\r\n\ton: function( types, selector, data, fn, /*INTERNAL*/ one ) {\r\n\t\tvar type, origFn;\r\n\r\n\t\t// Types can be a map of types/handlers\r\n\t\tif ( typeof types === \"object\" ) {\r\n\t\t\t// ( types-Object, selector, data )\r\n\t\t\tif ( typeof selector !== \"string\" ) {\r\n\t\t\t\t// ( types-Object, data )\r\n\t\t\t\tdata = data || selector;\r\n\t\t\t\tselector = undefined;\r\n\t\t\t}\r\n\t\t\tfor ( type in types ) {\r\n\t\t\t\tthis.on( type, selector, data, types[ type ], one );\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tif ( data == null && fn == null ) {\r\n\t\t\t// ( types, fn )\r\n\t\t\tfn = selector;\r\n\t\t\tdata = selector = undefined;\r\n\t\t} else if ( fn == null ) {\r\n\t\t\tif ( typeof selector === \"string\" ) {\r\n\t\t\t\t// ( types, selector, fn )\r\n\t\t\t\tfn = data;\r\n\t\t\t\tdata = undefined;\r\n\t\t\t} else {\r\n\t\t\t\t// ( types, data, fn )\r\n\t\t\t\tfn = data;\r\n\t\t\t\tdata = selector;\r\n\t\t\t\tselector = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif ( fn === false ) {\r\n\t\t\tfn = returnFalse;\r\n\t\t} else if ( !fn ) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tif ( one === 1 ) {\r\n\t\t\torigFn = fn;\r\n\t\t\tfn = function( event ) {\r\n\t\t\t\t// Can use an empty set, since event contains the info\r\n\t\t\t\tjQuery().off( event );\r\n\t\t\t\treturn origFn.apply( this, arguments );\r\n\t\t\t};\r\n\t\t\t// Use same guid so caller can remove using origFn\r\n\t\t\tfn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );\r\n\t\t}\r\n\t\treturn this.each( function() {\r\n\t\t\tjQuery.event.add( this, types, fn, data, selector );\r\n\t\t});\r\n\t},\r\n\tone: function( types, selector, data, fn ) {\r\n\t\treturn this.on( types, selector, data, fn, 1 );\r\n\t},\r\n\toff: function( types, selector, fn ) {\r\n\t\tvar handleObj, type;\r\n\t\tif ( types && types.preventDefault && types.handleObj ) {\r\n\t\t\t// ( event )  dispatched jQuery.Event\r\n\t\t\thandleObj = types.handleObj;\r\n\t\t\tjQuery( types.delegateTarget ).off(\r\n\t\t\t\thandleObj.namespace ? handleObj.origType + \".\" + handleObj.namespace : handleObj.origType,\r\n\t\t\t\thandleObj.selector,\r\n\t\t\t\thandleObj.handler\r\n\t\t\t);\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tif ( typeof types === \"object\" ) {\r\n\t\t\t// ( types-object [, selector] )\r\n\t\t\tfor ( type in types ) {\r\n\t\t\t\tthis.off( type, selector, types[ type ] );\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tif ( selector === false || typeof selector === \"function\" ) {\r\n\t\t\t// ( types [, fn] )\r\n\t\t\tfn = selector;\r\n\t\t\tselector = undefined;\r\n\t\t}\r\n\t\tif ( fn === false ) {\r\n\t\t\tfn = returnFalse;\r\n\t\t}\r\n\t\treturn this.each(function() {\r\n\t\t\tjQuery.event.remove( this, types, fn, selector );\r\n\t\t});\r\n\t},\r\n\r\n\ttrigger: function( type, data ) {\r\n\t\treturn this.each(function() {\r\n\t\t\tjQuery.event.trigger( type, data, this );\r\n\t\t});\r\n\t},\r\n\ttriggerHandler: function( type, data ) {\r\n\t\tvar elem = this[0];\r\n\t\tif ( elem ) {\r\n\t\t\treturn jQuery.event.trigger( type, data, elem, true );\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\nfunction createSafeFragment( document ) {\r\n\tvar list = nodeNames.split( \"|\" ),\r\n\t\tsafeFrag = document.createDocumentFragment();\r\n\r\n\tif ( safeFrag.createElement ) {\r\n\t\twhile ( list.length ) {\r\n\t\t\tsafeFrag.createElement(\r\n\t\t\t\tlist.pop()\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\treturn safeFrag;\r\n}\r\n\r\nvar nodeNames = \"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|\" +\r\n\t\t\"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",\r\n\trinlinejQuery = / jQuery\\d+=\"(?:null|\\d+)\"/g,\r\n\trnoshimcache = new RegExp(\"<(?:\" + nodeNames + \")[\\\\s/>]\", \"i\"),\r\n\trleadingWhitespace = /^\\s+/,\r\n\trxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,\r\n\trtagName = /<([\\w:]+)/,\r\n\trtbody = /<tbody/i,\r\n\trhtml = /<|&#?\\w+;/,\r\n\trnoInnerhtml = /<(?:script|style|link)/i,\r\n\t// checked=\"checked\" or checked\r\n\trchecked = /checked\\s*(?:[^=]|=\\s*.checked.)/i,\r\n\trscriptType = /^$|\\/(?:java|ecma)script/i,\r\n\trscriptTypeMasked = /^true\\/(.*)/,\r\n\trcleanScript = /^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,\r\n\r\n\t// We have to close these tags to support XHTML (#13200)\r\n\twrapMap = {\r\n\t\toption: [ 1, \"<select multiple='multiple'>\", \"</select>\" ],\r\n\t\tlegend: [ 1, \"<fieldset>\", \"</fieldset>\" ],\r\n\t\tarea: [ 1, \"<map>\", \"</map>\" ],\r\n\t\tparam: [ 1, \"<object>\", \"</object>\" ],\r\n\t\tthead: [ 1, \"<table>\", \"</table>\" ],\r\n\t\ttr: [ 2, \"<table><tbody>\", \"</tbody></table>\" ],\r\n\t\tcol: [ 2, \"<table><tbody></tbody><colgroup>\", \"</colgroup></table>\" ],\r\n\t\ttd: [ 3, \"<table><tbody><tr>\", \"</tr></tbody></table>\" ],\r\n\r\n\t\t// IE6-8 can't serialize link, script, style, or any html5 (NoScope) tags,\r\n\t\t// unless wrapped in a div with non-breaking characters in front of it.\r\n\t\t_default: support.htmlSerialize ? [ 0, \"\", \"\" ] : [ 1, \"X<div>\", \"</div>\"  ]\r\n\t},\r\n\tsafeFragment = createSafeFragment( document ),\r\n\tfragmentDiv = safeFragment.appendChild( document.createElement(\"div\") );\r\n\r\nwrapMap.optgroup = wrapMap.option;\r\nwrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;\r\nwrapMap.th = wrapMap.td;\r\n\r\nfunction getAll( context, tag ) {\r\n\tvar elems, elem,\r\n\t\ti = 0,\r\n\t\tfound = typeof context.getElementsByTagName !== strundefined ? context.getElementsByTagName( tag || \"*\" ) :\r\n\t\t\ttypeof context.querySelectorAll !== strundefined ? context.querySelectorAll( tag || \"*\" ) :\r\n\t\t\tundefined;\r\n\r\n\tif ( !found ) {\r\n\t\tfor ( found = [], elems = context.childNodes || context; (elem = elems[i]) != null; i++ ) {\r\n\t\t\tif ( !tag || jQuery.nodeName( elem, tag ) ) {\r\n\t\t\t\tfound.push( elem );\r\n\t\t\t} else {\r\n\t\t\t\tjQuery.merge( found, getAll( elem, tag ) );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn tag === undefined || tag && jQuery.nodeName( context, tag ) ?\r\n\t\tjQuery.merge( [ context ], found ) :\r\n\t\tfound;\r\n}\r\n\r\n// Used in buildFragment, fixes the defaultChecked property\r\nfunction fixDefaultChecked( elem ) {\r\n\tif ( rcheckableType.test( elem.type ) ) {\r\n\t\telem.defaultChecked = elem.checked;\r\n\t}\r\n}\r\n\r\n// Support: IE<8\r\n// Manipulating tables requires a tbody\r\nfunction manipulationTarget( elem, content ) {\r\n\treturn jQuery.nodeName( elem, \"table\" ) &&\r\n\t\tjQuery.nodeName( content.nodeType !== 11 ? content : content.firstChild, \"tr\" ) ?\r\n\r\n\t\telem.getElementsByTagName(\"tbody\")[0] ||\r\n\t\t\telem.appendChild( elem.ownerDocument.createElement(\"tbody\") ) :\r\n\t\telem;\r\n}\r\n\r\n// Replace/restore the type attribute of script elements for safe DOM manipulation\r\nfunction disableScript( elem ) {\r\n\telem.type = (jQuery.find.attr( elem, \"type\" ) !== null) + \"/\" + elem.type;\r\n\treturn elem;\r\n}\r\nfunction restoreScript( elem ) {\r\n\tvar match = rscriptTypeMasked.exec( elem.type );\r\n\tif ( match ) {\r\n\t\telem.type = match[1];\r\n\t} else {\r\n\t\telem.removeAttribute(\"type\");\r\n\t}\r\n\treturn elem;\r\n}\r\n\r\n// Mark scripts as having already been evaluated\r\nfunction setGlobalEval( elems, refElements ) {\r\n\tvar elem,\r\n\t\ti = 0;\r\n\tfor ( ; (elem = elems[i]) != null; i++ ) {\r\n\t\tjQuery._data( elem, \"globalEval\", !refElements || jQuery._data( refElements[i], \"globalEval\" ) );\r\n\t}\r\n}\r\n\r\nfunction cloneCopyEvent( src, dest ) {\r\n\r\n\tif ( dest.nodeType !== 1 || !jQuery.hasData( src ) ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar type, i, l,\r\n\t\toldData = jQuery._data( src ),\r\n\t\tcurData = jQuery._data( dest, oldData ),\r\n\t\tevents = oldData.events;\r\n\r\n\tif ( events ) {\r\n\t\tdelete curData.handle;\r\n\t\tcurData.events = {};\r\n\r\n\t\tfor ( type in events ) {\r\n\t\t\tfor ( i = 0, l = events[ type ].length; i < l; i++ ) {\r\n\t\t\t\tjQuery.event.add( dest, type, events[ type ][ i ] );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// make the cloned public data object a copy from the original\r\n\tif ( curData.data ) {\r\n\t\tcurData.data = jQuery.extend( {}, curData.data );\r\n\t}\r\n}\r\n\r\nfunction fixCloneNodeIssues( src, dest ) {\r\n\tvar nodeName, e, data;\r\n\r\n\t// We do not need to do anything for non-Elements\r\n\tif ( dest.nodeType !== 1 ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tnodeName = dest.nodeName.toLowerCase();\r\n\r\n\t// IE6-8 copies events bound via attachEvent when using cloneNode.\r\n\tif ( !support.noCloneEvent && dest[ jQuery.expando ] ) {\r\n\t\tdata = jQuery._data( dest );\r\n\r\n\t\tfor ( e in data.events ) {\r\n\t\t\tjQuery.removeEvent( dest, e, data.handle );\r\n\t\t}\r\n\r\n\t\t// Event data gets referenced instead of copied if the expando gets copied too\r\n\t\tdest.removeAttribute( jQuery.expando );\r\n\t}\r\n\r\n\t// IE blanks contents when cloning scripts, and tries to evaluate newly-set text\r\n\tif ( nodeName === \"script\" && dest.text !== src.text ) {\r\n\t\tdisableScript( dest ).text = src.text;\r\n\t\trestoreScript( dest );\r\n\r\n\t// IE6-10 improperly clones children of object elements using classid.\r\n\t// IE10 throws NoModificationAllowedError if parent is null, #12132.\r\n\t} else if ( nodeName === \"object\" ) {\r\n\t\tif ( dest.parentNode ) {\r\n\t\t\tdest.outerHTML = src.outerHTML;\r\n\t\t}\r\n\r\n\t\t// This path appears unavoidable for IE9. When cloning an object\r\n\t\t// element in IE9, the outerHTML strategy above is not sufficient.\r\n\t\t// If the src has innerHTML and the destination does not,\r\n\t\t// copy the src.innerHTML into the dest.innerHTML. #10324\r\n\t\tif ( support.html5Clone && ( src.innerHTML && !jQuery.trim(dest.innerHTML) ) ) {\r\n\t\t\tdest.innerHTML = src.innerHTML;\r\n\t\t}\r\n\r\n\t} else if ( nodeName === \"input\" && rcheckableType.test( src.type ) ) {\r\n\t\t// IE6-8 fails to persist the checked state of a cloned checkbox\r\n\t\t// or radio button. Worse, IE6-7 fail to give the cloned element\r\n\t\t// a checked appearance if the defaultChecked value isn't also set\r\n\r\n\t\tdest.defaultChecked = dest.checked = src.checked;\r\n\r\n\t\t// IE6-7 get confused and end up setting the value of a cloned\r\n\t\t// checkbox/radio button to an empty string instead of \"on\"\r\n\t\tif ( dest.value !== src.value ) {\r\n\t\t\tdest.value = src.value;\r\n\t\t}\r\n\r\n\t// IE6-8 fails to return the selected option to the default selected\r\n\t// state when cloning options\r\n\t} else if ( nodeName === \"option\" ) {\r\n\t\tdest.defaultSelected = dest.selected = src.defaultSelected;\r\n\r\n\t// IE6-8 fails to set the defaultValue to the correct value when\r\n\t// cloning other types of input fields\r\n\t} else if ( nodeName === \"input\" || nodeName === \"textarea\" ) {\r\n\t\tdest.defaultValue = src.defaultValue;\r\n\t}\r\n}\r\n\r\njQuery.extend({\r\n\tclone: function( elem, dataAndEvents, deepDataAndEvents ) {\r\n\t\tvar destElements, node, clone, i, srcElements,\r\n\t\t\tinPage = jQuery.contains( elem.ownerDocument, elem );\r\n\r\n\t\tif ( support.html5Clone || jQuery.isXMLDoc(elem) || !rnoshimcache.test( \"<\" + elem.nodeName + \">\" ) ) {\r\n\t\t\tclone = elem.cloneNode( true );\r\n\r\n\t\t// IE<=8 does not properly clone detached, unknown element nodes\r\n\t\t} else {\r\n\t\t\tfragmentDiv.innerHTML = elem.outerHTML;\r\n\t\t\tfragmentDiv.removeChild( clone = fragmentDiv.firstChild );\r\n\t\t}\r\n\r\n\t\tif ( (!support.noCloneEvent || !support.noCloneChecked) &&\r\n\t\t\t\t(elem.nodeType === 1 || elem.nodeType === 11) && !jQuery.isXMLDoc(elem) ) {\r\n\r\n\t\t\t// We eschew Sizzle here for performance reasons: http://jsperf.com/getall-vs-sizzle/2\r\n\t\t\tdestElements = getAll( clone );\r\n\t\t\tsrcElements = getAll( elem );\r\n\r\n\t\t\t// Fix all IE cloning issues\r\n\t\t\tfor ( i = 0; (node = srcElements[i]) != null; ++i ) {\r\n\t\t\t\t// Ensure that the destination node is not null; Fixes #9587\r\n\t\t\t\tif ( destElements[i] ) {\r\n\t\t\t\t\tfixCloneNodeIssues( node, destElements[i] );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Copy the events from the original to the clone\r\n\t\tif ( dataAndEvents ) {\r\n\t\t\tif ( deepDataAndEvents ) {\r\n\t\t\t\tsrcElements = srcElements || getAll( elem );\r\n\t\t\t\tdestElements = destElements || getAll( clone );\r\n\r\n\t\t\t\tfor ( i = 0; (node = srcElements[i]) != null; i++ ) {\r\n\t\t\t\t\tcloneCopyEvent( node, destElements[i] );\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tcloneCopyEvent( elem, clone );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Preserve script evaluation history\r\n\t\tdestElements = getAll( clone, \"script\" );\r\n\t\tif ( destElements.length > 0 ) {\r\n\t\t\tsetGlobalEval( destElements, !inPage && getAll( elem, \"script\" ) );\r\n\t\t}\r\n\r\n\t\tdestElements = srcElements = node = null;\r\n\r\n\t\t// Return the cloned set\r\n\t\treturn clone;\r\n\t},\r\n\r\n\tbuildFragment: function( elems, context, scripts, selection ) {\r\n\t\tvar j, elem, contains,\r\n\t\t\ttmp, tag, tbody, wrap,\r\n\t\t\tl = elems.length,\r\n\r\n\t\t\t// Ensure a safe fragment\r\n\t\t\tsafe = createSafeFragment( context ),\r\n\r\n\t\t\tnodes = [],\r\n\t\t\ti = 0;\r\n\r\n\t\tfor ( ; i < l; i++ ) {\r\n\t\t\telem = elems[ i ];\r\n\r\n\t\t\tif ( elem || elem === 0 ) {\r\n\r\n\t\t\t\t// Add nodes directly\r\n\t\t\t\tif ( jQuery.type( elem ) === \"object\" ) {\r\n\t\t\t\t\tjQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );\r\n\r\n\t\t\t\t// Convert non-html into a text node\r\n\t\t\t\t} else if ( !rhtml.test( elem ) ) {\r\n\t\t\t\t\tnodes.push( context.createTextNode( elem ) );\r\n\r\n\t\t\t\t// Convert html into DOM nodes\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttmp = tmp || safe.appendChild( context.createElement(\"div\") );\r\n\r\n\t\t\t\t\t// Deserialize a standard representation\r\n\t\t\t\t\ttag = (rtagName.exec( elem ) || [ \"\", \"\" ])[ 1 ].toLowerCase();\r\n\t\t\t\t\twrap = wrapMap[ tag ] || wrapMap._default;\r\n\r\n\t\t\t\t\ttmp.innerHTML = wrap[1] + elem.replace( rxhtmlTag, \"<$1></$2>\" ) + wrap[2];\r\n\r\n\t\t\t\t\t// Descend through wrappers to the right content\r\n\t\t\t\t\tj = wrap[0];\r\n\t\t\t\t\twhile ( j-- ) {\r\n\t\t\t\t\t\ttmp = tmp.lastChild;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Manually add leading whitespace removed by IE\r\n\t\t\t\t\tif ( !support.leadingWhitespace && rleadingWhitespace.test( elem ) ) {\r\n\t\t\t\t\t\tnodes.push( context.createTextNode( rleadingWhitespace.exec( elem )[0] ) );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Remove IE's autoinserted <tbody> from table fragments\r\n\t\t\t\t\tif ( !support.tbody ) {\r\n\r\n\t\t\t\t\t\t// String was a <table>, *may* have spurious <tbody>\r\n\t\t\t\t\t\telem = tag === \"table\" && !rtbody.test( elem ) ?\r\n\t\t\t\t\t\t\ttmp.firstChild :\r\n\r\n\t\t\t\t\t\t\t// String was a bare <thead> or <tfoot>\r\n\t\t\t\t\t\t\twrap[1] === \"<table>\" && !rtbody.test( elem ) ?\r\n\t\t\t\t\t\t\t\ttmp :\r\n\t\t\t\t\t\t\t\t0;\r\n\r\n\t\t\t\t\t\tj = elem && elem.childNodes.length;\r\n\t\t\t\t\t\twhile ( j-- ) {\r\n\t\t\t\t\t\t\tif ( jQuery.nodeName( (tbody = elem.childNodes[j]), \"tbody\" ) && !tbody.childNodes.length ) {\r\n\t\t\t\t\t\t\t\telem.removeChild( tbody );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tjQuery.merge( nodes, tmp.childNodes );\r\n\r\n\t\t\t\t\t// Fix #12392 for WebKit and IE > 9\r\n\t\t\t\t\ttmp.textContent = \"\";\r\n\r\n\t\t\t\t\t// Fix #12392 for oldIE\r\n\t\t\t\t\twhile ( tmp.firstChild ) {\r\n\t\t\t\t\t\ttmp.removeChild( tmp.firstChild );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Remember the top-level container for proper cleanup\r\n\t\t\t\t\ttmp = safe.lastChild;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Fix #11356: Clear elements from fragment\r\n\t\tif ( tmp ) {\r\n\t\t\tsafe.removeChild( tmp );\r\n\t\t}\r\n\r\n\t\t// Reset defaultChecked for any radios and checkboxes\r\n\t\t// about to be appended to the DOM in IE 6/7 (#8060)\r\n\t\tif ( !support.appendChecked ) {\r\n\t\t\tjQuery.grep( getAll( nodes, \"input\" ), fixDefaultChecked );\r\n\t\t}\r\n\r\n\t\ti = 0;\r\n\t\twhile ( (elem = nodes[ i++ ]) ) {\r\n\r\n\t\t\t// #4087 - If origin and destination elements are the same, and this is\r\n\t\t\t// that element, do not do anything\r\n\t\t\tif ( selection && jQuery.inArray( elem, selection ) !== -1 ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tcontains = jQuery.contains( elem.ownerDocument, elem );\r\n\r\n\t\t\t// Append to fragment\r\n\t\t\ttmp = getAll( safe.appendChild( elem ), \"script\" );\r\n\r\n\t\t\t// Preserve script evaluation history\r\n\t\t\tif ( contains ) {\r\n\t\t\t\tsetGlobalEval( tmp );\r\n\t\t\t}\r\n\r\n\t\t\t// Capture executables\r\n\t\t\tif ( scripts ) {\r\n\t\t\t\tj = 0;\r\n\t\t\t\twhile ( (elem = tmp[ j++ ]) ) {\r\n\t\t\t\t\tif ( rscriptType.test( elem.type || \"\" ) ) {\r\n\t\t\t\t\t\tscripts.push( elem );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttmp = null;\r\n\r\n\t\treturn safe;\r\n\t},\r\n\r\n\tcleanData: function( elems, /* internal */ acceptData ) {\r\n\t\tvar elem, type, id, data,\r\n\t\t\ti = 0,\r\n\t\t\tinternalKey = jQuery.expando,\r\n\t\t\tcache = jQuery.cache,\r\n\t\t\tdeleteExpando = support.deleteExpando,\r\n\t\t\tspecial = jQuery.event.special;\r\n\r\n\t\tfor ( ; (elem = elems[i]) != null; i++ ) {\r\n\t\t\tif ( acceptData || jQuery.acceptData( elem ) ) {\r\n\r\n\t\t\t\tid = elem[ internalKey ];\r\n\t\t\t\tdata = id && cache[ id ];\r\n\r\n\t\t\t\tif ( data ) {\r\n\t\t\t\t\tif ( data.events ) {\r\n\t\t\t\t\t\tfor ( type in data.events ) {\r\n\t\t\t\t\t\t\tif ( special[ type ] ) {\r\n\t\t\t\t\t\t\t\tjQuery.event.remove( elem, type );\r\n\r\n\t\t\t\t\t\t\t// This is a shortcut to avoid jQuery.event.remove's overhead\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tjQuery.removeEvent( elem, type, data.handle );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Remove cache only if it was not already removed by jQuery.event.remove\r\n\t\t\t\t\tif ( cache[ id ] ) {\r\n\r\n\t\t\t\t\t\tdelete cache[ id ];\r\n\r\n\t\t\t\t\t\t// IE does not allow us to delete expando properties from nodes,\r\n\t\t\t\t\t\t// nor does it have a removeAttribute function on Document nodes;\r\n\t\t\t\t\t\t// we must handle all of these cases\r\n\t\t\t\t\t\tif ( deleteExpando ) {\r\n\t\t\t\t\t\t\tdelete elem[ internalKey ];\r\n\r\n\t\t\t\t\t\t} else if ( typeof elem.removeAttribute !== strundefined ) {\r\n\t\t\t\t\t\t\telem.removeAttribute( internalKey );\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\telem[ internalKey ] = null;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdeletedIds.push( id );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\njQuery.fn.extend({\r\n\ttext: function( value ) {\r\n\t\treturn access( this, function( value ) {\r\n\t\t\treturn value === undefined ?\r\n\t\t\t\tjQuery.text( this ) :\r\n\t\t\t\tthis.empty().append( ( this[0] && this[0].ownerDocument || document ).createTextNode( value ) );\r\n\t\t}, null, value, arguments.length );\r\n\t},\r\n\r\n\tappend: function() {\r\n\t\treturn this.domManip( arguments, function( elem ) {\r\n\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\r\n\t\t\t\tvar target = manipulationTarget( this, elem );\r\n\t\t\t\ttarget.appendChild( elem );\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tprepend: function() {\r\n\t\treturn this.domManip( arguments, function( elem ) {\r\n\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\r\n\t\t\t\tvar target = manipulationTarget( this, elem );\r\n\t\t\t\ttarget.insertBefore( elem, target.firstChild );\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tbefore: function() {\r\n\t\treturn this.domManip( arguments, function( elem ) {\r\n\t\t\tif ( this.parentNode ) {\r\n\t\t\t\tthis.parentNode.insertBefore( elem, this );\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tafter: function() {\r\n\t\treturn this.domManip( arguments, function( elem ) {\r\n\t\t\tif ( this.parentNode ) {\r\n\t\t\t\tthis.parentNode.insertBefore( elem, this.nextSibling );\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tremove: function( selector, keepData /* Internal Use Only */ ) {\r\n\t\tvar elem,\r\n\t\t\telems = selector ? jQuery.filter( selector, this ) : this,\r\n\t\t\ti = 0;\r\n\r\n\t\tfor ( ; (elem = elems[i]) != null; i++ ) {\r\n\r\n\t\t\tif ( !keepData && elem.nodeType === 1 ) {\r\n\t\t\t\tjQuery.cleanData( getAll( elem ) );\r\n\t\t\t}\r\n\r\n\t\t\tif ( elem.parentNode ) {\r\n\t\t\t\tif ( keepData && jQuery.contains( elem.ownerDocument, elem ) ) {\r\n\t\t\t\t\tsetGlobalEval( getAll( elem, \"script\" ) );\r\n\t\t\t\t}\r\n\t\t\t\telem.parentNode.removeChild( elem );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tempty: function() {\r\n\t\tvar elem,\r\n\t\t\ti = 0;\r\n\r\n\t\tfor ( ; (elem = this[i]) != null; i++ ) {\r\n\t\t\t// Remove element nodes and prevent memory leaks\r\n\t\t\tif ( elem.nodeType === 1 ) {\r\n\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\r\n\t\t\t}\r\n\r\n\t\t\t// Remove any remaining nodes\r\n\t\t\twhile ( elem.firstChild ) {\r\n\t\t\t\telem.removeChild( elem.firstChild );\r\n\t\t\t}\r\n\r\n\t\t\t// If this is a select, ensure that it displays empty (#12336)\r\n\t\t\t// Support: IE<9\r\n\t\t\tif ( elem.options && jQuery.nodeName( elem, \"select\" ) ) {\r\n\t\t\t\telem.options.length = 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tclone: function( dataAndEvents, deepDataAndEvents ) {\r\n\t\tdataAndEvents = dataAndEvents == null ? false : dataAndEvents;\r\n\t\tdeepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;\r\n\r\n\t\treturn this.map(function() {\r\n\t\t\treturn jQuery.clone( this, dataAndEvents, deepDataAndEvents );\r\n\t\t});\r\n\t},\r\n\r\n\thtml: function( value ) {\r\n\t\treturn access( this, function( value ) {\r\n\t\t\tvar elem = this[ 0 ] || {},\r\n\t\t\t\ti = 0,\r\n\t\t\t\tl = this.length;\r\n\r\n\t\t\tif ( value === undefined ) {\r\n\t\t\t\treturn elem.nodeType === 1 ?\r\n\t\t\t\t\telem.innerHTML.replace( rinlinejQuery, \"\" ) :\r\n\t\t\t\t\tundefined;\r\n\t\t\t}\r\n\r\n\t\t\t// See if we can take a shortcut and just use innerHTML\r\n\t\t\tif ( typeof value === \"string\" && !rnoInnerhtml.test( value ) &&\r\n\t\t\t\t( support.htmlSerialize || !rnoshimcache.test( value )  ) &&\r\n\t\t\t\t( support.leadingWhitespace || !rleadingWhitespace.test( value ) ) &&\r\n\t\t\t\t!wrapMap[ (rtagName.exec( value ) || [ \"\", \"\" ])[ 1 ].toLowerCase() ] ) {\r\n\r\n\t\t\t\tvalue = value.replace( rxhtmlTag, \"<$1></$2>\" );\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tfor (; i < l; i++ ) {\r\n\t\t\t\t\t\t// Remove element nodes and prevent memory leaks\r\n\t\t\t\t\t\telem = this[i] || {};\r\n\t\t\t\t\t\tif ( elem.nodeType === 1 ) {\r\n\t\t\t\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\r\n\t\t\t\t\t\t\telem.innerHTML = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telem = 0;\r\n\r\n\t\t\t\t// If using innerHTML throws an exception, use the fallback method\r\n\t\t\t\t} catch(e) {}\r\n\t\t\t}\r\n\r\n\t\t\tif ( elem ) {\r\n\t\t\t\tthis.empty().append( value );\r\n\t\t\t}\r\n\t\t}, null, value, arguments.length );\r\n\t},\r\n\r\n\treplaceWith: function() {\r\n\t\tvar arg = arguments[ 0 ];\r\n\r\n\t\t// Make the changes, replacing each context element with the new content\r\n\t\tthis.domManip( arguments, function( elem ) {\r\n\t\t\targ = this.parentNode;\r\n\r\n\t\t\tjQuery.cleanData( getAll( this ) );\r\n\r\n\t\t\tif ( arg ) {\r\n\t\t\t\targ.replaceChild( elem, this );\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Force removal if there was no new content (e.g., from empty arguments)\r\n\t\treturn arg && (arg.length || arg.nodeType) ? this : this.remove();\r\n\t},\r\n\r\n\tdetach: function( selector ) {\r\n\t\treturn this.remove( selector, true );\r\n\t},\r\n\r\n\tdomManip: function( args, callback ) {\r\n\r\n\t\t// Flatten any nested arrays\r\n\t\targs = concat.apply( [], args );\r\n\r\n\t\tvar first, node, hasScripts,\r\n\t\t\tscripts, doc, fragment,\r\n\t\t\ti = 0,\r\n\t\t\tl = this.length,\r\n\t\t\tset = this,\r\n\t\t\tiNoClone = l - 1,\r\n\t\t\tvalue = args[0],\r\n\t\t\tisFunction = jQuery.isFunction( value );\r\n\r\n\t\t// We can't cloneNode fragments that contain checked, in WebKit\r\n\t\tif ( isFunction ||\r\n\t\t\t\t( l > 1 && typeof value === \"string\" &&\r\n\t\t\t\t\t!support.checkClone && rchecked.test( value ) ) ) {\r\n\t\t\treturn this.each(function( index ) {\r\n\t\t\t\tvar self = set.eq( index );\r\n\t\t\t\tif ( isFunction ) {\r\n\t\t\t\t\targs[0] = value.call( this, index, self.html() );\r\n\t\t\t\t}\r\n\t\t\t\tself.domManip( args, callback );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif ( l ) {\r\n\t\t\tfragment = jQuery.buildFragment( args, this[ 0 ].ownerDocument, false, this );\r\n\t\t\tfirst = fragment.firstChild;\r\n\r\n\t\t\tif ( fragment.childNodes.length === 1 ) {\r\n\t\t\t\tfragment = first;\r\n\t\t\t}\r\n\r\n\t\t\tif ( first ) {\r\n\t\t\t\tscripts = jQuery.map( getAll( fragment, \"script\" ), disableScript );\r\n\t\t\t\thasScripts = scripts.length;\r\n\r\n\t\t\t\t// Use the original fragment for the last item instead of the first because it can end up\r\n\t\t\t\t// being emptied incorrectly in certain situations (#8070).\r\n\t\t\t\tfor ( ; i < l; i++ ) {\r\n\t\t\t\t\tnode = fragment;\r\n\r\n\t\t\t\t\tif ( i !== iNoClone ) {\r\n\t\t\t\t\t\tnode = jQuery.clone( node, true, true );\r\n\r\n\t\t\t\t\t\t// Keep references to cloned scripts for later restoration\r\n\t\t\t\t\t\tif ( hasScripts ) {\r\n\t\t\t\t\t\t\tjQuery.merge( scripts, getAll( node, \"script\" ) );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcallback.call( this[i], node, i );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasScripts ) {\r\n\t\t\t\t\tdoc = scripts[ scripts.length - 1 ].ownerDocument;\r\n\r\n\t\t\t\t\t// Reenable scripts\r\n\t\t\t\t\tjQuery.map( scripts, restoreScript );\r\n\r\n\t\t\t\t\t// Evaluate executable scripts on first document insertion\r\n\t\t\t\t\tfor ( i = 0; i < hasScripts; i++ ) {\r\n\t\t\t\t\t\tnode = scripts[ i ];\r\n\t\t\t\t\t\tif ( rscriptType.test( node.type || \"\" ) &&\r\n\t\t\t\t\t\t\t!jQuery._data( node, \"globalEval\" ) && jQuery.contains( doc, node ) ) {\r\n\r\n\t\t\t\t\t\t\tif ( node.src ) {\r\n\t\t\t\t\t\t\t\t// Optional AJAX dependency, but won't run scripts if not present\r\n\t\t\t\t\t\t\t\tif ( jQuery._evalUrl ) {\r\n\t\t\t\t\t\t\t\t\tjQuery._evalUrl( node.src );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tjQuery.globalEval( ( node.text || node.textContent || node.innerHTML || \"\" ).replace( rcleanScript, \"\" ) );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Fix #11809: Avoid leaking memory\r\n\t\t\t\tfragment = first = null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n});\r\n\r\njQuery.each({\r\n\tappendTo: \"append\",\r\n\tprependTo: \"prepend\",\r\n\tinsertBefore: \"before\",\r\n\tinsertAfter: \"after\",\r\n\treplaceAll: \"replaceWith\"\r\n}, function( name, original ) {\r\n\tjQuery.fn[ name ] = function( selector ) {\r\n\t\tvar elems,\r\n\t\t\ti = 0,\r\n\t\t\tret = [],\r\n\t\t\tinsert = jQuery( selector ),\r\n\t\t\tlast = insert.length - 1;\r\n\r\n\t\tfor ( ; i <= last; i++ ) {\r\n\t\t\telems = i === last ? this : this.clone(true);\r\n\t\t\tjQuery( insert[i] )[ original ]( elems );\r\n\r\n\t\t\t// Modern browsers can apply jQuery collections as arrays, but oldIE needs a .get()\r\n\t\t\tpush.apply( ret, elems.get() );\r\n\t\t}\r\n\r\n\t\treturn this.pushStack( ret );\r\n\t};\r\n});\r\n\r\n\r\nvar iframe,\r\n\telemdisplay = {};\r\n\r\n/**\r\n * Retrieve the actual display of a element\r\n * @param {String} name nodeName of the element\r\n * @param {Object} doc Document object\r\n */\r\n// Called only from within defaultDisplay\r\nfunction actualDisplay( name, doc ) {\r\n\tvar style,\r\n\t\telem = jQuery( doc.createElement( name ) ).appendTo( doc.body ),\r\n\r\n\t\t// getDefaultComputedStyle might be reliably used only on attached element\r\n\t\tdisplay = window.getDefaultComputedStyle && ( style = window.getDefaultComputedStyle( elem[ 0 ] ) ) ?\r\n\r\n\t\t\t// Use of this method is a temporary fix (more like optmization) until something better comes along,\r\n\t\t\t// since it was removed from specification and supported only in FF\r\n\t\t\tstyle.display : jQuery.css( elem[ 0 ], \"display\" );\r\n\r\n\t// We don't have any data stored on the element,\r\n\t// so use \"detach\" method as fast way to get rid of the element\r\n\telem.detach();\r\n\r\n\treturn display;\r\n}\r\n\r\n/**\r\n * Try to determine the default display value of an element\r\n * @param {String} nodeName\r\n */\r\nfunction defaultDisplay( nodeName ) {\r\n\tvar doc = document,\r\n\t\tdisplay = elemdisplay[ nodeName ];\r\n\r\n\tif ( !display ) {\r\n\t\tdisplay = actualDisplay( nodeName, doc );\r\n\r\n\t\t// If the simple way fails, read from inside an iframe\r\n\t\tif ( display === \"none\" || !display ) {\r\n\r\n\t\t\t// Use the already-created iframe if possible\r\n\t\t\tiframe = (iframe || jQuery( \"<iframe frameborder='0' width='0' height='0'/>\" )).appendTo( doc.documentElement );\r\n\r\n\t\t\t// Always write a new HTML skeleton so Webkit and Firefox don't choke on reuse\r\n\t\t\tdoc = ( iframe[ 0 ].contentWindow || iframe[ 0 ].contentDocument ).document;\r\n\r\n\t\t\t// Support: IE\r\n\t\t\tdoc.write();\r\n\t\t\tdoc.close();\r\n\r\n\t\t\tdisplay = actualDisplay( nodeName, doc );\r\n\t\t\tiframe.detach();\r\n\t\t}\r\n\r\n\t\t// Store the correct default display\r\n\t\telemdisplay[ nodeName ] = display;\r\n\t}\r\n\r\n\treturn display;\r\n}\r\n\r\n\r\n(function() {\r\n\tvar shrinkWrapBlocksVal;\r\n\r\n\tsupport.shrinkWrapBlocks = function() {\r\n\t\tif ( shrinkWrapBlocksVal != null ) {\r\n\t\t\treturn shrinkWrapBlocksVal;\r\n\t\t}\r\n\r\n\t\t// Will be changed later if needed.\r\n\t\tshrinkWrapBlocksVal = false;\r\n\r\n\t\t// Minified: var b,c,d\r\n\t\tvar div, body, container;\r\n\r\n\t\tbody = document.getElementsByTagName( \"body\" )[ 0 ];\r\n\t\tif ( !body || !body.style ) {\r\n\t\t\t// Test fired too early or in an unsupported environment, exit.\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Setup\r\n\t\tdiv = document.createElement( \"div\" );\r\n\t\tcontainer = document.createElement( \"div\" );\r\n\t\tcontainer.style.cssText = \"position:absolute;border:0;width:0;height:0;top:0;left:-9999px\";\r\n\t\tbody.appendChild( container ).appendChild( div );\r\n\r\n\t\t// Support: IE6\r\n\t\t// Check if elements with layout shrink-wrap their children\r\n\t\tif ( typeof div.style.zoom !== strundefined ) {\r\n\t\t\t// Reset CSS: box-sizing; display; margin; border\r\n\t\t\tdiv.style.cssText =\r\n\t\t\t\t// Support: Firefox<29, Android 2.3\r\n\t\t\t\t// Vendor-prefix box-sizing\r\n\t\t\t\t\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;\" +\r\n\t\t\t\t\"box-sizing:content-box;display:block;margin:0;border:0;\" +\r\n\t\t\t\t\"padding:1px;width:1px;zoom:1\";\r\n\t\t\tdiv.appendChild( document.createElement( \"div\" ) ).style.width = \"5px\";\r\n\t\t\tshrinkWrapBlocksVal = div.offsetWidth !== 3;\r\n\t\t}\r\n\r\n\t\tbody.removeChild( container );\r\n\r\n\t\treturn shrinkWrapBlocksVal;\r\n\t};\r\n\r\n})();\r\nvar rmargin = (/^margin/);\r\n\r\nvar rnumnonpx = new RegExp( \"^(\" + pnum + \")(?!px)[a-z%]+$\", \"i\" );\r\n\r\n\r\n\r\nvar getStyles, curCSS,\r\n\trposition = /^(top|right|bottom|left)$/;\r\n\r\nif ( window.getComputedStyle ) {\r\n\tgetStyles = function( elem ) {\r\n\t\treturn elem.ownerDocument.defaultView.getComputedStyle( elem, null );\r\n\t};\r\n\r\n\tcurCSS = function( elem, name, computed ) {\r\n\t\tvar width, minWidth, maxWidth, ret,\r\n\t\t\tstyle = elem.style;\r\n\r\n\t\tcomputed = computed || getStyles( elem );\r\n\r\n\t\t// getPropertyValue is only needed for .css('filter') in IE9, see #12537\r\n\t\tret = computed ? computed.getPropertyValue( name ) || computed[ name ] : undefined;\r\n\r\n\t\tif ( computed ) {\r\n\r\n\t\t\tif ( ret === \"\" && !jQuery.contains( elem.ownerDocument, elem ) ) {\r\n\t\t\t\tret = jQuery.style( elem, name );\r\n\t\t\t}\r\n\r\n\t\t\t// A tribute to the \"awesome hack by Dean Edwards\"\r\n\t\t\t// Chrome < 17 and Safari 5.0 uses \"computed value\" instead of \"used value\" for margin-right\r\n\t\t\t// Safari 5.1.7 (at least) returns percentage for a larger set of values, but width seems to be reliably pixels\r\n\t\t\t// this is against the CSSOM draft spec: http://dev.w3.org/csswg/cssom/#resolved-values\r\n\t\t\tif ( rnumnonpx.test( ret ) && rmargin.test( name ) ) {\r\n\r\n\t\t\t\t// Remember the original values\r\n\t\t\t\twidth = style.width;\r\n\t\t\t\tminWidth = style.minWidth;\r\n\t\t\t\tmaxWidth = style.maxWidth;\r\n\r\n\t\t\t\t// Put in the new values to get a computed value out\r\n\t\t\t\tstyle.minWidth = style.maxWidth = style.width = ret;\r\n\t\t\t\tret = computed.width;\r\n\r\n\t\t\t\t// Revert the changed values\r\n\t\t\t\tstyle.width = width;\r\n\t\t\t\tstyle.minWidth = minWidth;\r\n\t\t\t\tstyle.maxWidth = maxWidth;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Support: IE\r\n\t\t// IE returns zIndex value as an integer.\r\n\t\treturn ret === undefined ?\r\n\t\t\tret :\r\n\t\t\tret + \"\";\r\n\t};\r\n} else if ( document.documentElement.currentStyle ) {\r\n\tgetStyles = function( elem ) {\r\n\t\treturn elem.currentStyle;\r\n\t};\r\n\r\n\tcurCSS = function( elem, name, computed ) {\r\n\t\tvar left, rs, rsLeft, ret,\r\n\t\t\tstyle = elem.style;\r\n\r\n\t\tcomputed = computed || getStyles( elem );\r\n\t\tret = computed ? computed[ name ] : undefined;\r\n\r\n\t\t// Avoid setting ret to empty string here\r\n\t\t// so we don't default to auto\r\n\t\tif ( ret == null && style && style[ name ] ) {\r\n\t\t\tret = style[ name ];\r\n\t\t}\r\n\r\n\t\t// From the awesome hack by Dean Edwards\r\n\t\t// http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291\r\n\r\n\t\t// If we're not dealing with a regular pixel number\r\n\t\t// but a number that has a weird ending, we need to convert it to pixels\r\n\t\t// but not position css attributes, as those are proportional to the parent element instead\r\n\t\t// and we can't measure the parent instead because it might trigger a \"stacking dolls\" problem\r\n\t\tif ( rnumnonpx.test( ret ) && !rposition.test( name ) ) {\r\n\r\n\t\t\t// Remember the original values\r\n\t\t\tleft = style.left;\r\n\t\t\trs = elem.runtimeStyle;\r\n\t\t\trsLeft = rs && rs.left;\r\n\r\n\t\t\t// Put in the new values to get a computed value out\r\n\t\t\tif ( rsLeft ) {\r\n\t\t\t\trs.left = elem.currentStyle.left;\r\n\t\t\t}\r\n\t\t\tstyle.left = name === \"fontSize\" ? \"1em\" : ret;\r\n\t\t\tret = style.pixelLeft + \"px\";\r\n\r\n\t\t\t// Revert the changed values\r\n\t\t\tstyle.left = left;\r\n\t\t\tif ( rsLeft ) {\r\n\t\t\t\trs.left = rsLeft;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Support: IE\r\n\t\t// IE returns zIndex value as an integer.\r\n\t\treturn ret === undefined ?\r\n\t\t\tret :\r\n\t\t\tret + \"\" || \"auto\";\r\n\t};\r\n}\r\n\r\n\r\n\r\n\r\nfunction addGetHookIf( conditionFn, hookFn ) {\r\n\t// Define the hook, we'll check on the first run if it's really needed.\r\n\treturn {\r\n\t\tget: function() {\r\n\t\t\tvar condition = conditionFn();\r\n\r\n\t\t\tif ( condition == null ) {\r\n\t\t\t\t// The test was not ready at this point; screw the hook this time\r\n\t\t\t\t// but check again when needed next time.\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( condition ) {\r\n\t\t\t\t// Hook not needed (or it's not possible to use it due to missing dependency),\r\n\t\t\t\t// remove it.\r\n\t\t\t\t// Since there are no other hooks for marginRight, remove the whole object.\r\n\t\t\t\tdelete this.get;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Hook needed; redefine it so that the support test is not executed again.\r\n\r\n\t\t\treturn (this.get = hookFn).apply( this, arguments );\r\n\t\t}\r\n\t};\r\n}\r\n\r\n\r\n(function() {\r\n\t// Minified: var b,c,d,e,f,g, h,i\r\n\tvar div, style, a, pixelPositionVal, boxSizingReliableVal,\r\n\t\treliableHiddenOffsetsVal, reliableMarginRightVal;\r\n\r\n\t// Setup\r\n\tdiv = document.createElement( \"div\" );\r\n\tdiv.innerHTML = \"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\";\r\n\ta = div.getElementsByTagName( \"a\" )[ 0 ];\r\n\tstyle = a && a.style;\r\n\r\n\t// Finish early in limited (non-browser) environments\r\n\tif ( !style ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tstyle.cssText = \"float:left;opacity:.5\";\r\n\r\n\t// Support: IE<9\r\n\t// Make sure that element opacity exists (as opposed to filter)\r\n\tsupport.opacity = style.opacity === \"0.5\";\r\n\r\n\t// Verify style float existence\r\n\t// (IE uses styleFloat instead of cssFloat)\r\n\tsupport.cssFloat = !!style.cssFloat;\r\n\r\n\tdiv.style.backgroundClip = \"content-box\";\r\n\tdiv.cloneNode( true ).style.backgroundClip = \"\";\r\n\tsupport.clearCloneStyle = div.style.backgroundClip === \"content-box\";\r\n\r\n\t// Support: Firefox<29, Android 2.3\r\n\t// Vendor-prefix box-sizing\r\n\tsupport.boxSizing = style.boxSizing === \"\" || style.MozBoxSizing === \"\" ||\r\n\t\tstyle.WebkitBoxSizing === \"\";\r\n\r\n\tjQuery.extend(support, {\r\n\t\treliableHiddenOffsets: function() {\r\n\t\t\tif ( reliableHiddenOffsetsVal == null ) {\r\n\t\t\t\tcomputeStyleTests();\r\n\t\t\t}\r\n\t\t\treturn reliableHiddenOffsetsVal;\r\n\t\t},\r\n\r\n\t\tboxSizingReliable: function() {\r\n\t\t\tif ( boxSizingReliableVal == null ) {\r\n\t\t\t\tcomputeStyleTests();\r\n\t\t\t}\r\n\t\t\treturn boxSizingReliableVal;\r\n\t\t},\r\n\r\n\t\tpixelPosition: function() {\r\n\t\t\tif ( pixelPositionVal == null ) {\r\n\t\t\t\tcomputeStyleTests();\r\n\t\t\t}\r\n\t\t\treturn pixelPositionVal;\r\n\t\t},\r\n\r\n\t\t// Support: Android 2.3\r\n\t\treliableMarginRight: function() {\r\n\t\t\tif ( reliableMarginRightVal == null ) {\r\n\t\t\t\tcomputeStyleTests();\r\n\t\t\t}\r\n\t\t\treturn reliableMarginRightVal;\r\n\t\t}\r\n\t});\r\n\r\n\tfunction computeStyleTests() {\r\n\t\t// Minified: var b,c,d,j\r\n\t\tvar div, body, container, contents;\r\n\r\n\t\tbody = document.getElementsByTagName( \"body\" )[ 0 ];\r\n\t\tif ( !body || !body.style ) {\r\n\t\t\t// Test fired too early or in an unsupported environment, exit.\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Setup\r\n\t\tdiv = document.createElement( \"div\" );\r\n\t\tcontainer = document.createElement( \"div\" );\r\n\t\tcontainer.style.cssText = \"position:absolute;border:0;width:0;height:0;top:0;left:-9999px\";\r\n\t\tbody.appendChild( container ).appendChild( div );\r\n\r\n\t\tdiv.style.cssText =\r\n\t\t\t// Support: Firefox<29, Android 2.3\r\n\t\t\t// Vendor-prefix box-sizing\r\n\t\t\t\"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;\" +\r\n\t\t\t\"box-sizing:border-box;display:block;margin-top:1%;top:1%;\" +\r\n\t\t\t\"border:1px;padding:1px;width:4px;position:absolute\";\r\n\r\n\t\t// Support: IE<9\r\n\t\t// Assume reasonable values in the absence of getComputedStyle\r\n\t\tpixelPositionVal = boxSizingReliableVal = false;\r\n\t\treliableMarginRightVal = true;\r\n\r\n\t\t// Check for getComputedStyle so that this code is not run in IE<9.\r\n\t\tif ( window.getComputedStyle ) {\r\n\t\t\tpixelPositionVal = ( window.getComputedStyle( div, null ) || {} ).top !== \"1%\";\r\n\t\t\tboxSizingReliableVal =\r\n\t\t\t\t( window.getComputedStyle( div, null ) || { width: \"4px\" } ).width === \"4px\";\r\n\r\n\t\t\t// Support: Android 2.3\r\n\t\t\t// Div with explicit width and no margin-right incorrectly\r\n\t\t\t// gets computed margin-right based on width of container (#3333)\r\n\t\t\t// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right\r\n\t\t\tcontents = div.appendChild( document.createElement( \"div\" ) );\r\n\r\n\t\t\t// Reset CSS: box-sizing; display; margin; border; padding\r\n\t\t\tcontents.style.cssText = div.style.cssText =\r\n\t\t\t\t// Support: Firefox<29, Android 2.3\r\n\t\t\t\t// Vendor-prefix box-sizing\r\n\t\t\t\t\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;\" +\r\n\t\t\t\t\"box-sizing:content-box;display:block;margin:0;border:0;padding:0\";\r\n\t\t\tcontents.style.marginRight = contents.style.width = \"0\";\r\n\t\t\tdiv.style.width = \"1px\";\r\n\r\n\t\t\treliableMarginRightVal =\r\n\t\t\t\t!parseFloat( ( window.getComputedStyle( contents, null ) || {} ).marginRight );\r\n\t\t}\r\n\r\n\t\t// Support: IE8\r\n\t\t// Check if table cells still have offsetWidth/Height when they are set\r\n\t\t// to display:none and there are still other visible table cells in a\r\n\t\t// table row; if so, offsetWidth/Height are not reliable for use when\r\n\t\t// determining if an element has been hidden directly using\r\n\t\t// display:none (it is still safe to use offsets if a parent element is\r\n\t\t// hidden; don safety goggles and see bug #4512 for more information).\r\n\t\tdiv.innerHTML = \"<table><tr><td></td><td>t</td></tr></table>\";\r\n\t\tcontents = div.getElementsByTagName( \"td\" );\r\n\t\tcontents[ 0 ].style.cssText = \"margin:0;border:0;padding:0;display:none\";\r\n\t\treliableHiddenOffsetsVal = contents[ 0 ].offsetHeight === 0;\r\n\t\tif ( reliableHiddenOffsetsVal ) {\r\n\t\t\tcontents[ 0 ].style.display = \"\";\r\n\t\t\tcontents[ 1 ].style.display = \"none\";\r\n\t\t\treliableHiddenOffsetsVal = contents[ 0 ].offsetHeight === 0;\r\n\t\t}\r\n\r\n\t\tbody.removeChild( container );\r\n\t}\r\n\r\n})();\r\n\r\n\r\n// A method for quickly swapping in/out CSS properties to get correct calculations.\r\njQuery.swap = function( elem, options, callback, args ) {\r\n\tvar ret, name,\r\n\t\told = {};\r\n\r\n\t// Remember the old values, and insert the new ones\r\n\tfor ( name in options ) {\r\n\t\told[ name ] = elem.style[ name ];\r\n\t\telem.style[ name ] = options[ name ];\r\n\t}\r\n\r\n\tret = callback.apply( elem, args || [] );\r\n\r\n\t// Revert the old values\r\n\tfor ( name in options ) {\r\n\t\telem.style[ name ] = old[ name ];\r\n\t}\r\n\r\n\treturn ret;\r\n};\r\n\r\n\r\nvar\r\n\t\tralpha = /alpha\\([^)]*\\)/i,\r\n\tropacity = /opacity\\s*=\\s*([^)]*)/,\r\n\r\n\t// swappable if display is none or starts with table except \"table\", \"table-cell\", or \"table-caption\"\r\n\t// see here for display values: https://developer.mozilla.org/en-US/docs/CSS/display\r\n\trdisplayswap = /^(none|table(?!-c[ea]).+)/,\r\n\trnumsplit = new RegExp( \"^(\" + pnum + \")(.*)$\", \"i\" ),\r\n\trrelNum = new RegExp( \"^([+-])=(\" + pnum + \")\", \"i\" ),\r\n\r\n\tcssShow = { position: \"absolute\", visibility: \"hidden\", display: \"block\" },\r\n\tcssNormalTransform = {\r\n\t\tletterSpacing: \"0\",\r\n\t\tfontWeight: \"400\"\r\n\t},\r\n\r\n\tcssPrefixes = [ \"Webkit\", \"O\", \"Moz\", \"ms\" ];\r\n\r\n\r\n// return a css property mapped to a potentially vendor prefixed property\r\nfunction vendorPropName( style, name ) {\r\n\r\n\t// shortcut for names that are not vendor prefixed\r\n\tif ( name in style ) {\r\n\t\treturn name;\r\n\t}\r\n\r\n\t// check for vendor prefixed names\r\n\tvar capName = name.charAt(0).toUpperCase() + name.slice(1),\r\n\t\torigName = name,\r\n\t\ti = cssPrefixes.length;\r\n\r\n\twhile ( i-- ) {\r\n\t\tname = cssPrefixes[ i ] + capName;\r\n\t\tif ( name in style ) {\r\n\t\t\treturn name;\r\n\t\t}\r\n\t}\r\n\r\n\treturn origName;\r\n}\r\n\r\nfunction showHide( elements, show ) {\r\n\tvar display, elem, hidden,\r\n\t\tvalues = [],\r\n\t\tindex = 0,\r\n\t\tlength = elements.length;\r\n\r\n\tfor ( ; index < length; index++ ) {\r\n\t\telem = elements[ index ];\r\n\t\tif ( !elem.style ) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvalues[ index ] = jQuery._data( elem, \"olddisplay\" );\r\n\t\tdisplay = elem.style.display;\r\n\t\tif ( show ) {\r\n\t\t\t// Reset the inline display of this element to learn if it is\r\n\t\t\t// being hidden by cascaded rules or not\r\n\t\t\tif ( !values[ index ] && display === \"none\" ) {\r\n\t\t\t\telem.style.display = \"\";\r\n\t\t\t}\r\n\r\n\t\t\t// Set elements which have been overridden with display: none\r\n\t\t\t// in a stylesheet to whatever the default browser style is\r\n\t\t\t// for such an element\r\n\t\t\tif ( elem.style.display === \"\" && isHidden( elem ) ) {\r\n\t\t\t\tvalues[ index ] = jQuery._data( elem, \"olddisplay\", defaultDisplay(elem.nodeName) );\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\thidden = isHidden( elem );\r\n\r\n\t\t\tif ( display && display !== \"none\" || !hidden ) {\r\n\t\t\t\tjQuery._data( elem, \"olddisplay\", hidden ? display : jQuery.css( elem, \"display\" ) );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Set the display of most of the elements in a second loop\r\n\t// to avoid the constant reflow\r\n\tfor ( index = 0; index < length; index++ ) {\r\n\t\telem = elements[ index ];\r\n\t\tif ( !elem.style ) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif ( !show || elem.style.display === \"none\" || elem.style.display === \"\" ) {\r\n\t\t\telem.style.display = show ? values[ index ] || \"\" : \"none\";\r\n\t\t}\r\n\t}\r\n\r\n\treturn elements;\r\n}\r\n\r\nfunction setPositiveNumber( elem, value, subtract ) {\r\n\tvar matches = rnumsplit.exec( value );\r\n\treturn matches ?\r\n\t\t// Guard against undefined \"subtract\", e.g., when used as in cssHooks\r\n\t\tMath.max( 0, matches[ 1 ] - ( subtract || 0 ) ) + ( matches[ 2 ] || \"px\" ) :\r\n\t\tvalue;\r\n}\r\n\r\nfunction augmentWidthOrHeight( elem, name, extra, isBorderBox, styles ) {\r\n\tvar i = extra === ( isBorderBox ? \"border\" : \"content\" ) ?\r\n\t\t// If we already have the right measurement, avoid augmentation\r\n\t\t4 :\r\n\t\t// Otherwise initialize for horizontal or vertical properties\r\n\t\tname === \"width\" ? 1 : 0,\r\n\r\n\t\tval = 0;\r\n\r\n\tfor ( ; i < 4; i += 2 ) {\r\n\t\t// both box models exclude margin, so add it if we want it\r\n\t\tif ( extra === \"margin\" ) {\r\n\t\t\tval += jQuery.css( elem, extra + cssExpand[ i ], true, styles );\r\n\t\t}\r\n\r\n\t\tif ( isBorderBox ) {\r\n\t\t\t// border-box includes padding, so remove it if we want content\r\n\t\t\tif ( extra === \"content\" ) {\r\n\t\t\t\tval -= jQuery.css( elem, \"padding\" + cssExpand[ i ], true, styles );\r\n\t\t\t}\r\n\r\n\t\t\t// at this point, extra isn't border nor margin, so remove border\r\n\t\t\tif ( extra !== \"margin\" ) {\r\n\t\t\t\tval -= jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// at this point, extra isn't content, so add padding\r\n\t\t\tval += jQuery.css( elem, \"padding\" + cssExpand[ i ], true, styles );\r\n\r\n\t\t\t// at this point, extra isn't content nor padding, so add border\r\n\t\t\tif ( extra !== \"padding\" ) {\r\n\t\t\t\tval += jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn val;\r\n}\r\n\r\nfunction getWidthOrHeight( elem, name, extra ) {\r\n\r\n\t// Start with offset property, which is equivalent to the border-box value\r\n\tvar valueIsBorderBox = true,\r\n\t\tval = name === \"width\" ? elem.offsetWidth : elem.offsetHeight,\r\n\t\tstyles = getStyles( elem ),\r\n\t\tisBorderBox = support.boxSizing && jQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\";\r\n\r\n\t// some non-html elements return undefined for offsetWidth, so check for null/undefined\r\n\t// svg - https://bugzilla.mozilla.org/show_bug.cgi?id=649285\r\n\t// MathML - https://bugzilla.mozilla.org/show_bug.cgi?id=491668\r\n\tif ( val <= 0 || val == null ) {\r\n\t\t// Fall back to computed then uncomputed css if necessary\r\n\t\tval = curCSS( elem, name, styles );\r\n\t\tif ( val < 0 || val == null ) {\r\n\t\t\tval = elem.style[ name ];\r\n\t\t}\r\n\r\n\t\t// Computed unit is not pixels. Stop here and return.\r\n\t\tif ( rnumnonpx.test(val) ) {\r\n\t\t\treturn val;\r\n\t\t}\r\n\r\n\t\t// we need the check for style in case a browser which returns unreliable values\r\n\t\t// for getComputedStyle silently falls back to the reliable elem.style\r\n\t\tvalueIsBorderBox = isBorderBox && ( support.boxSizingReliable() || val === elem.style[ name ] );\r\n\r\n\t\t// Normalize \"\", auto, and prepare for extra\r\n\t\tval = parseFloat( val ) || 0;\r\n\t}\r\n\r\n\t// use the active box-sizing model to add/subtract irrelevant styles\r\n\treturn ( val +\r\n\t\taugmentWidthOrHeight(\r\n\t\t\telem,\r\n\t\t\tname,\r\n\t\t\textra || ( isBorderBox ? \"border\" : \"content\" ),\r\n\t\t\tvalueIsBorderBox,\r\n\t\t\tstyles\r\n\t\t)\r\n\t) + \"px\";\r\n}\r\n\r\njQuery.extend({\r\n\t// Add in style property hooks for overriding the default\r\n\t// behavior of getting and setting a style property\r\n\tcssHooks: {\r\n\t\topacity: {\r\n\t\t\tget: function( elem, computed ) {\r\n\t\t\t\tif ( computed ) {\r\n\t\t\t\t\t// We should always get a number back from opacity\r\n\t\t\t\t\tvar ret = curCSS( elem, \"opacity\" );\r\n\t\t\t\t\treturn ret === \"\" ? \"1\" : ret;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// Don't automatically add \"px\" to these possibly-unitless properties\r\n\tcssNumber: {\r\n\t\t\"columnCount\": true,\r\n\t\t\"fillOpacity\": true,\r\n\t\t\"flexGrow\": true,\r\n\t\t\"flexShrink\": true,\r\n\t\t\"fontWeight\": true,\r\n\t\t\"lineHeight\": true,\r\n\t\t\"opacity\": true,\r\n\t\t\"order\": true,\r\n\t\t\"orphans\": true,\r\n\t\t\"widows\": true,\r\n\t\t\"zIndex\": true,\r\n\t\t\"zoom\": true\r\n\t},\r\n\r\n\t// Add in properties whose names you wish to fix before\r\n\t// setting or getting the value\r\n\tcssProps: {\r\n\t\t// normalize float css property\r\n\t\t\"float\": support.cssFloat ? \"cssFloat\" : \"styleFloat\"\r\n\t},\r\n\r\n\t// Get and set the style property on a DOM Node\r\n\tstyle: function( elem, name, value, extra ) {\r\n\t\t// Don't set styles on text and comment nodes\r\n\t\tif ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Make sure that we're working with the right name\r\n\t\tvar ret, type, hooks,\r\n\t\t\torigName = jQuery.camelCase( name ),\r\n\t\t\tstyle = elem.style;\r\n\r\n\t\tname = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( style, origName ) );\r\n\r\n\t\t// gets hook for the prefixed version\r\n\t\t// followed by the unprefixed version\r\n\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\r\n\r\n\t\t// Check if we're setting a value\r\n\t\tif ( value !== undefined ) {\r\n\t\t\ttype = typeof value;\r\n\r\n\t\t\t// convert relative number strings (+= or -=) to relative numbers. #7345\r\n\t\t\tif ( type === \"string\" && (ret = rrelNum.exec( value )) ) {\r\n\t\t\t\tvalue = ( ret[1] + 1 ) * ret[2] + parseFloat( jQuery.css( elem, name ) );\r\n\t\t\t\t// Fixes bug #9237\r\n\t\t\t\ttype = \"number\";\r\n\t\t\t}\r\n\r\n\t\t\t// Make sure that null and NaN values aren't set. See: #7116\r\n\t\t\tif ( value == null || value !== value ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// If a number was passed in, add 'px' to the (except for certain CSS properties)\r\n\t\t\tif ( type === \"number\" && !jQuery.cssNumber[ origName ] ) {\r\n\t\t\t\tvalue += \"px\";\r\n\t\t\t}\r\n\r\n\t\t\t// Fixes #8908, it can be done more correctly by specifing setters in cssHooks,\r\n\t\t\t// but it would mean to define eight (for every problematic property) identical functions\r\n\t\t\tif ( !support.clearCloneStyle && value === \"\" && name.indexOf(\"background\") === 0 ) {\r\n\t\t\t\tstyle[ name ] = \"inherit\";\r\n\t\t\t}\r\n\r\n\t\t\t// If a hook was provided, use that value, otherwise just set the specified value\r\n\t\t\tif ( !hooks || !(\"set\" in hooks) || (value = hooks.set( elem, value, extra )) !== undefined ) {\r\n\r\n\t\t\t\t// Support: IE\r\n\t\t\t\t// Swallow errors from 'invalid' CSS values (#5509)\r\n\t\t\t\ttry {\r\n\t\t\t\t\tstyle[ name ] = value;\r\n\t\t\t\t} catch(e) {}\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// If a hook was provided get the non-computed value from there\r\n\t\t\tif ( hooks && \"get\" in hooks && (ret = hooks.get( elem, false, extra )) !== undefined ) {\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n\r\n\t\t\t// Otherwise just get the value from the style object\r\n\t\t\treturn style[ name ];\r\n\t\t}\r\n\t},\r\n\r\n\tcss: function( elem, name, extra, styles ) {\r\n\t\tvar num, val, hooks,\r\n\t\t\torigName = jQuery.camelCase( name );\r\n\r\n\t\t// Make sure that we're working with the right name\r\n\t\tname = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( elem.style, origName ) );\r\n\r\n\t\t// gets hook for the prefixed version\r\n\t\t// followed by the unprefixed version\r\n\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\r\n\r\n\t\t// If a hook was provided get the computed value from there\r\n\t\tif ( hooks && \"get\" in hooks ) {\r\n\t\t\tval = hooks.get( elem, true, extra );\r\n\t\t}\r\n\r\n\t\t// Otherwise, if a way to get the computed value exists, use that\r\n\t\tif ( val === undefined ) {\r\n\t\t\tval = curCSS( elem, name, styles );\r\n\t\t}\r\n\r\n\t\t//convert \"normal\" to computed value\r\n\t\tif ( val === \"normal\" && name in cssNormalTransform ) {\r\n\t\t\tval = cssNormalTransform[ name ];\r\n\t\t}\r\n\r\n\t\t// Return, converting to number if forced or a qualifier was provided and val looks numeric\r\n\t\tif ( extra === \"\" || extra ) {\r\n\t\t\tnum = parseFloat( val );\r\n\t\t\treturn extra === true || jQuery.isNumeric( num ) ? num || 0 : val;\r\n\t\t}\r\n\t\treturn val;\r\n\t}\r\n});\r\n\r\njQuery.each([ \"height\", \"width\" ], function( i, name ) {\r\n\tjQuery.cssHooks[ name ] = {\r\n\t\tget: function( elem, computed, extra ) {\r\n\t\t\tif ( computed ) {\r\n\t\t\t\t// certain elements can have dimension info if we invisibly show them\r\n\t\t\t\t// however, it must have a current display style that would benefit from this\r\n\t\t\t\treturn rdisplayswap.test( jQuery.css( elem, \"display\" ) ) && elem.offsetWidth === 0 ?\r\n\t\t\t\t\tjQuery.swap( elem, cssShow, function() {\r\n\t\t\t\t\t\treturn getWidthOrHeight( elem, name, extra );\r\n\t\t\t\t\t}) :\r\n\t\t\t\t\tgetWidthOrHeight( elem, name, extra );\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tset: function( elem, value, extra ) {\r\n\t\t\tvar styles = extra && getStyles( elem );\r\n\t\t\treturn setPositiveNumber( elem, value, extra ?\r\n\t\t\t\taugmentWidthOrHeight(\r\n\t\t\t\t\telem,\r\n\t\t\t\t\tname,\r\n\t\t\t\t\textra,\r\n\t\t\t\t\tsupport.boxSizing && jQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\",\r\n\t\t\t\t\tstyles\r\n\t\t\t\t) : 0\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n});\r\n\r\nif ( !support.opacity ) {\r\n\tjQuery.cssHooks.opacity = {\r\n\t\tget: function( elem, computed ) {\r\n\t\t\t// IE uses filters for opacity\r\n\t\t\treturn ropacity.test( (computed && elem.currentStyle ? elem.currentStyle.filter : elem.style.filter) || \"\" ) ?\r\n\t\t\t\t( 0.01 * parseFloat( RegExp.$1 ) ) + \"\" :\r\n\t\t\t\tcomputed ? \"1\" : \"\";\r\n\t\t},\r\n\r\n\t\tset: function( elem, value ) {\r\n\t\t\tvar style = elem.style,\r\n\t\t\t\tcurrentStyle = elem.currentStyle,\r\n\t\t\t\topacity = jQuery.isNumeric( value ) ? \"alpha(opacity=\" + value * 100 + \")\" : \"\",\r\n\t\t\t\tfilter = currentStyle && currentStyle.filter || style.filter || \"\";\r\n\r\n\t\t\t// IE has trouble with opacity if it does not have layout\r\n\t\t\t// Force it by setting the zoom level\r\n\t\t\tstyle.zoom = 1;\r\n\r\n\t\t\t// if setting opacity to 1, and no other filters exist - attempt to remove filter attribute #6652\r\n\t\t\t// if value === \"\", then remove inline opacity #12685\r\n\t\t\tif ( ( value >= 1 || value === \"\" ) &&\r\n\t\t\t\t\tjQuery.trim( filter.replace( ralpha, \"\" ) ) === \"\" &&\r\n\t\t\t\t\tstyle.removeAttribute ) {\r\n\r\n\t\t\t\t// Setting style.filter to null, \"\" & \" \" still leave \"filter:\" in the cssText\r\n\t\t\t\t// if \"filter:\" is present at all, clearType is disabled, we want to avoid this\r\n\t\t\t\t// style.removeAttribute is IE Only, but so apparently is this code path...\r\n\t\t\t\tstyle.removeAttribute( \"filter\" );\r\n\r\n\t\t\t\t// if there is no filter style applied in a css rule or unset inline opacity, we are done\r\n\t\t\t\tif ( value === \"\" || currentStyle && !currentStyle.filter ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// otherwise, set new filter values\r\n\t\t\tstyle.filter = ralpha.test( filter ) ?\r\n\t\t\t\tfilter.replace( ralpha, opacity ) :\r\n\t\t\t\tfilter + \" \" + opacity;\r\n\t\t}\r\n\t};\r\n}\r\n\r\njQuery.cssHooks.marginRight = addGetHookIf( support.reliableMarginRight,\r\n\tfunction( elem, computed ) {\r\n\t\tif ( computed ) {\r\n\t\t\t// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right\r\n\t\t\t// Work around by temporarily setting element display to inline-block\r\n\t\t\treturn jQuery.swap( elem, { \"display\": \"inline-block\" },\r\n\t\t\t\tcurCSS, [ elem, \"marginRight\" ] );\r\n\t\t}\r\n\t}\r\n);\r\n\r\n// These hooks are used by animate to expand properties\r\njQuery.each({\r\n\tmargin: \"\",\r\n\tpadding: \"\",\r\n\tborder: \"Width\"\r\n}, function( prefix, suffix ) {\r\n\tjQuery.cssHooks[ prefix + suffix ] = {\r\n\t\texpand: function( value ) {\r\n\t\t\tvar i = 0,\r\n\t\t\t\texpanded = {},\r\n\r\n\t\t\t\t// assumes a single number if not a string\r\n\t\t\t\tparts = typeof value === \"string\" ? value.split(\" \") : [ value ];\r\n\r\n\t\t\tfor ( ; i < 4; i++ ) {\r\n\t\t\t\texpanded[ prefix + cssExpand[ i ] + suffix ] =\r\n\t\t\t\t\tparts[ i ] || parts[ i - 2 ] || parts[ 0 ];\r\n\t\t\t}\r\n\r\n\t\t\treturn expanded;\r\n\t\t}\r\n\t};\r\n\r\n\tif ( !rmargin.test( prefix ) ) {\r\n\t\tjQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;\r\n\t}\r\n});\r\n\r\njQuery.fn.extend({\r\n\tcss: function( name, value ) {\r\n\t\treturn access( this, function( elem, name, value ) {\r\n\t\t\tvar styles, len,\r\n\t\t\t\tmap = {},\r\n\t\t\t\ti = 0;\r\n\r\n\t\t\tif ( jQuery.isArray( name ) ) {\r\n\t\t\t\tstyles = getStyles( elem );\r\n\t\t\t\tlen = name.length;\r\n\r\n\t\t\t\tfor ( ; i < len; i++ ) {\r\n\t\t\t\t\tmap[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn map;\r\n\t\t\t}\r\n\r\n\t\t\treturn value !== undefined ?\r\n\t\t\t\tjQuery.style( elem, name, value ) :\r\n\t\t\t\tjQuery.css( elem, name );\r\n\t\t}, name, value, arguments.length > 1 );\r\n\t},\r\n\tshow: function() {\r\n\t\treturn showHide( this, true );\r\n\t},\r\n\thide: function() {\r\n\t\treturn showHide( this );\r\n\t},\r\n\ttoggle: function( state ) {\r\n\t\tif ( typeof state === \"boolean\" ) {\r\n\t\t\treturn state ? this.show() : this.hide();\r\n\t\t}\r\n\r\n\t\treturn this.each(function() {\r\n\t\t\tif ( isHidden( this ) ) {\r\n\t\t\t\tjQuery( this ).show();\r\n\t\t\t} else {\r\n\t\t\t\tjQuery( this ).hide();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n});\r\n\r\n\r\nfunction Tween( elem, options, prop, end, easing ) {\r\n\treturn new Tween.prototype.init( elem, options, prop, end, easing );\r\n}\r\njQuery.Tween = Tween;\r\n\r\nTween.prototype = {\r\n\tconstructor: Tween,\r\n\tinit: function( elem, options, prop, end, easing, unit ) {\r\n\t\tthis.elem = elem;\r\n\t\tthis.prop = prop;\r\n\t\tthis.easing = easing || \"swing\";\r\n\t\tthis.options = options;\r\n\t\tthis.start = this.now = this.cur();\r\n\t\tthis.end = end;\r\n\t\tthis.unit = unit || ( jQuery.cssNumber[ prop ] ? \"\" : \"px\" );\r\n\t},\r\n\tcur: function() {\r\n\t\tvar hooks = Tween.propHooks[ this.prop ];\r\n\r\n\t\treturn hooks && hooks.get ?\r\n\t\t\thooks.get( this ) :\r\n\t\t\tTween.propHooks._default.get( this );\r\n\t},\r\n\trun: function( percent ) {\r\n\t\tvar eased,\r\n\t\t\thooks = Tween.propHooks[ this.prop ];\r\n\r\n\t\tif ( this.options.duration ) {\r\n\t\t\tthis.pos = eased = jQuery.easing[ this.easing ](\r\n\t\t\t\tpercent, this.options.duration * percent, 0, 1, this.options.duration\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.pos = eased = percent;\r\n\t\t}\r\n\t\tthis.now = ( this.end - this.start ) * eased + this.start;\r\n\r\n\t\tif ( this.options.step ) {\r\n\t\t\tthis.options.step.call( this.elem, this.now, this );\r\n\t\t}\r\n\r\n\t\tif ( hooks && hooks.set ) {\r\n\t\t\thooks.set( this );\r\n\t\t} else {\r\n\t\t\tTween.propHooks._default.set( this );\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n};\r\n\r\nTween.prototype.init.prototype = Tween.prototype;\r\n\r\nTween.propHooks = {\r\n\t_default: {\r\n\t\tget: function( tween ) {\r\n\t\t\tvar result;\r\n\r\n\t\t\tif ( tween.elem[ tween.prop ] != null &&\r\n\t\t\t\t(!tween.elem.style || tween.elem.style[ tween.prop ] == null) ) {\r\n\t\t\t\treturn tween.elem[ tween.prop ];\r\n\t\t\t}\r\n\r\n\t\t\t// passing an empty string as a 3rd parameter to .css will automatically\r\n\t\t\t// attempt a parseFloat and fallback to a string if the parse fails\r\n\t\t\t// so, simple values such as \"10px\" are parsed to Float.\r\n\t\t\t// complex values such as \"rotate(1rad)\" are returned as is.\r\n\t\t\tresult = jQuery.css( tween.elem, tween.prop, \"\" );\r\n\t\t\t// Empty strings, null, undefined and \"auto\" are converted to 0.\r\n\t\t\treturn !result || result === \"auto\" ? 0 : result;\r\n\t\t},\r\n\t\tset: function( tween ) {\r\n\t\t\t// use step hook for back compat - use cssHook if its there - use .style if its\r\n\t\t\t// available and use plain properties where available\r\n\t\t\tif ( jQuery.fx.step[ tween.prop ] ) {\r\n\t\t\t\tjQuery.fx.step[ tween.prop ]( tween );\r\n\t\t\t} else if ( tween.elem.style && ( tween.elem.style[ jQuery.cssProps[ tween.prop ] ] != null || jQuery.cssHooks[ tween.prop ] ) ) {\r\n\t\t\t\tjQuery.style( tween.elem, tween.prop, tween.now + tween.unit );\r\n\t\t\t} else {\r\n\t\t\t\ttween.elem[ tween.prop ] = tween.now;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// Support: IE <=9\r\n// Panic based approach to setting things on disconnected nodes\r\n\r\nTween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {\r\n\tset: function( tween ) {\r\n\t\tif ( tween.elem.nodeType && tween.elem.parentNode ) {\r\n\t\t\ttween.elem[ tween.prop ] = tween.now;\r\n\t\t}\r\n\t}\r\n};\r\n\r\njQuery.easing = {\r\n\tlinear: function( p ) {\r\n\t\treturn p;\r\n\t},\r\n\tswing: function( p ) {\r\n\t\treturn 0.5 - Math.cos( p * Math.PI ) / 2;\r\n\t}\r\n};\r\n\r\njQuery.fx = Tween.prototype.init;\r\n\r\n// Back Compat <1.8 extension point\r\njQuery.fx.step = {};\r\n\r\n\r\n\r\n\r\nvar\r\n\tfxNow, timerId,\r\n\trfxtypes = /^(?:toggle|show|hide)$/,\r\n\trfxnum = new RegExp( \"^(?:([+-])=|)(\" + pnum + \")([a-z%]*)$\", \"i\" ),\r\n\trrun = /queueHooks$/,\r\n\tanimationPrefilters = [ defaultPrefilter ],\r\n\ttweeners = {\r\n\t\t\"*\": [ function( prop, value ) {\r\n\t\t\tvar tween = this.createTween( prop, value ),\r\n\t\t\t\ttarget = tween.cur(),\r\n\t\t\t\tparts = rfxnum.exec( value ),\r\n\t\t\t\tunit = parts && parts[ 3 ] || ( jQuery.cssNumber[ prop ] ? \"\" : \"px\" ),\r\n\r\n\t\t\t\t// Starting value computation is required for potential unit mismatches\r\n\t\t\t\tstart = ( jQuery.cssNumber[ prop ] || unit !== \"px\" && +target ) &&\r\n\t\t\t\t\trfxnum.exec( jQuery.css( tween.elem, prop ) ),\r\n\t\t\t\tscale = 1,\r\n\t\t\t\tmaxIterations = 20;\r\n\r\n\t\t\tif ( start && start[ 3 ] !== unit ) {\r\n\t\t\t\t// Trust units reported by jQuery.css\r\n\t\t\t\tunit = unit || start[ 3 ];\r\n\r\n\t\t\t\t// Make sure we update the tween properties later on\r\n\t\t\t\tparts = parts || [];\r\n\r\n\t\t\t\t// Iteratively approximate from a nonzero starting point\r\n\t\t\t\tstart = +target || 1;\r\n\r\n\t\t\t\tdo {\r\n\t\t\t\t\t// If previous iteration zeroed out, double until we get *something*\r\n\t\t\t\t\t// Use a string for doubling factor so we don't accidentally see scale as unchanged below\r\n\t\t\t\t\tscale = scale || \".5\";\r\n\r\n\t\t\t\t\t// Adjust and apply\r\n\t\t\t\t\tstart = start / scale;\r\n\t\t\t\t\tjQuery.style( tween.elem, prop, start + unit );\r\n\r\n\t\t\t\t// Update scale, tolerating zero or NaN from tween.cur()\r\n\t\t\t\t// And breaking the loop if scale is unchanged or perfect, or if we've just had enough\r\n\t\t\t\t} while ( scale !== (scale = tween.cur() / target) && scale !== 1 && --maxIterations );\r\n\t\t\t}\r\n\r\n\t\t\t// Update tween properties\r\n\t\t\tif ( parts ) {\r\n\t\t\t\tstart = tween.start = +start || +target || 0;\r\n\t\t\t\ttween.unit = unit;\r\n\t\t\t\t// If a +=/-= token was provided, we're doing a relative animation\r\n\t\t\t\ttween.end = parts[ 1 ] ?\r\n\t\t\t\t\tstart + ( parts[ 1 ] + 1 ) * parts[ 2 ] :\r\n\t\t\t\t\t+parts[ 2 ];\r\n\t\t\t}\r\n\r\n\t\t\treturn tween;\r\n\t\t} ]\r\n\t};\r\n\r\n// Animations created synchronously will run synchronously\r\nfunction createFxNow() {\r\n\tsetTimeout(function() {\r\n\t\tfxNow = undefined;\r\n\t});\r\n\treturn ( fxNow = jQuery.now() );\r\n}\r\n\r\n// Generate parameters to create a standard animation\r\nfunction genFx( type, includeWidth ) {\r\n\tvar which,\r\n\t\tattrs = { height: type },\r\n\t\ti = 0;\r\n\r\n\t// if we include width, step value is 1 to do all cssExpand values,\r\n\t// if we don't include width, step value is 2 to skip over Left and Right\r\n\tincludeWidth = includeWidth ? 1 : 0;\r\n\tfor ( ; i < 4 ; i += 2 - includeWidth ) {\r\n\t\twhich = cssExpand[ i ];\r\n\t\tattrs[ \"margin\" + which ] = attrs[ \"padding\" + which ] = type;\r\n\t}\r\n\r\n\tif ( includeWidth ) {\r\n\t\tattrs.opacity = attrs.width = type;\r\n\t}\r\n\r\n\treturn attrs;\r\n}\r\n\r\nfunction createTween( value, prop, animation ) {\r\n\tvar tween,\r\n\t\tcollection = ( tweeners[ prop ] || [] ).concat( tweeners[ \"*\" ] ),\r\n\t\tindex = 0,\r\n\t\tlength = collection.length;\r\n\tfor ( ; index < length; index++ ) {\r\n\t\tif ( (tween = collection[ index ].call( animation, prop, value )) ) {\r\n\r\n\t\t\t// we're done with this property\r\n\t\t\treturn tween;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction defaultPrefilter( elem, props, opts ) {\r\n\t/* jshint validthis: true */\r\n\tvar prop, value, toggle, tween, hooks, oldfire, display, checkDisplay,\r\n\t\tanim = this,\r\n\t\torig = {},\r\n\t\tstyle = elem.style,\r\n\t\thidden = elem.nodeType && isHidden( elem ),\r\n\t\tdataShow = jQuery._data( elem, \"fxshow\" );\r\n\r\n\t// handle queue: false promises\r\n\tif ( !opts.queue ) {\r\n\t\thooks = jQuery._queueHooks( elem, \"fx\" );\r\n\t\tif ( hooks.unqueued == null ) {\r\n\t\t\thooks.unqueued = 0;\r\n\t\t\toldfire = hooks.empty.fire;\r\n\t\t\thooks.empty.fire = function() {\r\n\t\t\t\tif ( !hooks.unqueued ) {\r\n\t\t\t\t\toldfire();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\thooks.unqueued++;\r\n\r\n\t\tanim.always(function() {\r\n\t\t\t// doing this makes sure that the complete handler will be called\r\n\t\t\t// before this completes\r\n\t\t\tanim.always(function() {\r\n\t\t\t\thooks.unqueued--;\r\n\t\t\t\tif ( !jQuery.queue( elem, \"fx\" ).length ) {\r\n\t\t\t\t\thooks.empty.fire();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t// height/width overflow pass\r\n\tif ( elem.nodeType === 1 && ( \"height\" in props || \"width\" in props ) ) {\r\n\t\t// Make sure that nothing sneaks out\r\n\t\t// Record all 3 overflow attributes because IE does not\r\n\t\t// change the overflow attribute when overflowX and\r\n\t\t// overflowY are set to the same value\r\n\t\topts.overflow = [ style.overflow, style.overflowX, style.overflowY ];\r\n\r\n\t\t// Set display property to inline-block for height/width\r\n\t\t// animations on inline elements that are having width/height animated\r\n\t\tdisplay = jQuery.css( elem, \"display\" );\r\n\r\n\t\t// Test default display if display is currently \"none\"\r\n\t\tcheckDisplay = display === \"none\" ?\r\n\t\t\tjQuery._data( elem, \"olddisplay\" ) || defaultDisplay( elem.nodeName ) : display;\r\n\r\n\t\tif ( checkDisplay === \"inline\" && jQuery.css( elem, \"float\" ) === \"none\" ) {\r\n\r\n\t\t\t// inline-level elements accept inline-block;\r\n\t\t\t// block-level elements need to be inline with layout\r\n\t\t\tif ( !support.inlineBlockNeedsLayout || defaultDisplay( elem.nodeName ) === \"inline\" ) {\r\n\t\t\t\tstyle.display = \"inline-block\";\r\n\t\t\t} else {\r\n\t\t\t\tstyle.zoom = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif ( opts.overflow ) {\r\n\t\tstyle.overflow = \"hidden\";\r\n\t\tif ( !support.shrinkWrapBlocks() ) {\r\n\t\t\tanim.always(function() {\r\n\t\t\t\tstyle.overflow = opts.overflow[ 0 ];\r\n\t\t\t\tstyle.overflowX = opts.overflow[ 1 ];\r\n\t\t\t\tstyle.overflowY = opts.overflow[ 2 ];\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t// show/hide pass\r\n\tfor ( prop in props ) {\r\n\t\tvalue = props[ prop ];\r\n\t\tif ( rfxtypes.exec( value ) ) {\r\n\t\t\tdelete props[ prop ];\r\n\t\t\ttoggle = toggle || value === \"toggle\";\r\n\t\t\tif ( value === ( hidden ? \"hide\" : \"show\" ) ) {\r\n\r\n\t\t\t\t// If there is dataShow left over from a stopped hide or show and we are going to proceed with show, we should pretend to be hidden\r\n\t\t\t\tif ( value === \"show\" && dataShow && dataShow[ prop ] !== undefined ) {\r\n\t\t\t\t\thidden = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\torig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );\r\n\r\n\t\t// Any non-fx value stops us from restoring the original display value\r\n\t\t} else {\r\n\t\t\tdisplay = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tif ( !jQuery.isEmptyObject( orig ) ) {\r\n\t\tif ( dataShow ) {\r\n\t\t\tif ( \"hidden\" in dataShow ) {\r\n\t\t\t\thidden = dataShow.hidden;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdataShow = jQuery._data( elem, \"fxshow\", {} );\r\n\t\t}\r\n\r\n\t\t// store state if its toggle - enables .stop().toggle() to \"reverse\"\r\n\t\tif ( toggle ) {\r\n\t\t\tdataShow.hidden = !hidden;\r\n\t\t}\r\n\t\tif ( hidden ) {\r\n\t\t\tjQuery( elem ).show();\r\n\t\t} else {\r\n\t\t\tanim.done(function() {\r\n\t\t\t\tjQuery( elem ).hide();\r\n\t\t\t});\r\n\t\t}\r\n\t\tanim.done(function() {\r\n\t\t\tvar prop;\r\n\t\t\tjQuery._removeData( elem, \"fxshow\" );\r\n\t\t\tfor ( prop in orig ) {\r\n\t\t\t\tjQuery.style( elem, prop, orig[ prop ] );\r\n\t\t\t}\r\n\t\t});\r\n\t\tfor ( prop in orig ) {\r\n\t\t\ttween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );\r\n\r\n\t\t\tif ( !( prop in dataShow ) ) {\r\n\t\t\t\tdataShow[ prop ] = tween.start;\r\n\t\t\t\tif ( hidden ) {\r\n\t\t\t\t\ttween.end = tween.start;\r\n\t\t\t\t\ttween.start = prop === \"width\" || prop === \"height\" ? 1 : 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t// If this is a noop like .hide().hide(), restore an overwritten display value\r\n\t} else if ( (display === \"none\" ? defaultDisplay( elem.nodeName ) : display) === \"inline\" ) {\r\n\t\tstyle.display = display;\r\n\t}\r\n}\r\n\r\nfunction propFilter( props, specialEasing ) {\r\n\tvar index, name, easing, value, hooks;\r\n\r\n\t// camelCase, specialEasing and expand cssHook pass\r\n\tfor ( index in props ) {\r\n\t\tname = jQuery.camelCase( index );\r\n\t\teasing = specialEasing[ name ];\r\n\t\tvalue = props[ index ];\r\n\t\tif ( jQuery.isArray( value ) ) {\r\n\t\t\teasing = value[ 1 ];\r\n\t\t\tvalue = props[ index ] = value[ 0 ];\r\n\t\t}\r\n\r\n\t\tif ( index !== name ) {\r\n\t\t\tprops[ name ] = value;\r\n\t\t\tdelete props[ index ];\r\n\t\t}\r\n\r\n\t\thooks = jQuery.cssHooks[ name ];\r\n\t\tif ( hooks && \"expand\" in hooks ) {\r\n\t\t\tvalue = hooks.expand( value );\r\n\t\t\tdelete props[ name ];\r\n\r\n\t\t\t// not quite $.extend, this wont overwrite keys already present.\r\n\t\t\t// also - reusing 'index' from above because we have the correct \"name\"\r\n\t\t\tfor ( index in value ) {\r\n\t\t\t\tif ( !( index in props ) ) {\r\n\t\t\t\t\tprops[ index ] = value[ index ];\r\n\t\t\t\t\tspecialEasing[ index ] = easing;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tspecialEasing[ name ] = easing;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction Animation( elem, properties, options ) {\r\n\tvar result,\r\n\t\tstopped,\r\n\t\tindex = 0,\r\n\t\tlength = animationPrefilters.length,\r\n\t\tdeferred = jQuery.Deferred().always( function() {\r\n\t\t\t// don't match elem in the :animated selector\r\n\t\t\tdelete tick.elem;\r\n\t\t}),\r\n\t\ttick = function() {\r\n\t\t\tif ( stopped ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar currentTime = fxNow || createFxNow(),\r\n\t\t\t\tremaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),\r\n\t\t\t\t// archaic crash bug won't allow us to use 1 - ( 0.5 || 0 ) (#12497)\r\n\t\t\t\ttemp = remaining / animation.duration || 0,\r\n\t\t\t\tpercent = 1 - temp,\r\n\t\t\t\tindex = 0,\r\n\t\t\t\tlength = animation.tweens.length;\r\n\r\n\t\t\tfor ( ; index < length ; index++ ) {\r\n\t\t\t\tanimation.tweens[ index ].run( percent );\r\n\t\t\t}\r\n\r\n\t\t\tdeferred.notifyWith( elem, [ animation, percent, remaining ]);\r\n\r\n\t\t\tif ( percent < 1 && length ) {\r\n\t\t\t\treturn remaining;\r\n\t\t\t} else {\r\n\t\t\t\tdeferred.resolveWith( elem, [ animation ] );\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tanimation = deferred.promise({\r\n\t\t\telem: elem,\r\n\t\t\tprops: jQuery.extend( {}, properties ),\r\n\t\t\topts: jQuery.extend( true, { specialEasing: {} }, options ),\r\n\t\t\toriginalProperties: properties,\r\n\t\t\toriginalOptions: options,\r\n\t\t\tstartTime: fxNow || createFxNow(),\r\n\t\t\tduration: options.duration,\r\n\t\t\ttweens: [],\r\n\t\t\tcreateTween: function( prop, end ) {\r\n\t\t\t\tvar tween = jQuery.Tween( elem, animation.opts, prop, end,\r\n\t\t\t\t\t\tanimation.opts.specialEasing[ prop ] || animation.opts.easing );\r\n\t\t\t\tanimation.tweens.push( tween );\r\n\t\t\t\treturn tween;\r\n\t\t\t},\r\n\t\t\tstop: function( gotoEnd ) {\r\n\t\t\t\tvar index = 0,\r\n\t\t\t\t\t// if we are going to the end, we want to run all the tweens\r\n\t\t\t\t\t// otherwise we skip this part\r\n\t\t\t\t\tlength = gotoEnd ? animation.tweens.length : 0;\r\n\t\t\t\tif ( stopped ) {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\tstopped = true;\r\n\t\t\t\tfor ( ; index < length ; index++ ) {\r\n\t\t\t\t\tanimation.tweens[ index ].run( 1 );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// resolve when we played the last frame\r\n\t\t\t\t// otherwise, reject\r\n\t\t\t\tif ( gotoEnd ) {\r\n\t\t\t\t\tdeferred.resolveWith( elem, [ animation, gotoEnd ] );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdeferred.rejectWith( elem, [ animation, gotoEnd ] );\r\n\t\t\t\t}\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\t\t}),\r\n\t\tprops = animation.props;\r\n\r\n\tpropFilter( props, animation.opts.specialEasing );\r\n\r\n\tfor ( ; index < length ; index++ ) {\r\n\t\tresult = animationPrefilters[ index ].call( animation, elem, props, animation.opts );\r\n\t\tif ( result ) {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\r\n\tjQuery.map( props, createTween, animation );\r\n\r\n\tif ( jQuery.isFunction( animation.opts.start ) ) {\r\n\t\tanimation.opts.start.call( elem, animation );\r\n\t}\r\n\r\n\tjQuery.fx.timer(\r\n\t\tjQuery.extend( tick, {\r\n\t\t\telem: elem,\r\n\t\t\tanim: animation,\r\n\t\t\tqueue: animation.opts.queue\r\n\t\t})\r\n\t);\r\n\r\n\t// attach callbacks from options\r\n\treturn animation.progress( animation.opts.progress )\r\n\t\t.done( animation.opts.done, animation.opts.complete )\r\n\t\t.fail( animation.opts.fail )\r\n\t\t.always( animation.opts.always );\r\n}\r\n\r\njQuery.Animation = jQuery.extend( Animation, {\r\n\ttweener: function( props, callback ) {\r\n\t\tif ( jQuery.isFunction( props ) ) {\r\n\t\t\tcallback = props;\r\n\t\t\tprops = [ \"*\" ];\r\n\t\t} else {\r\n\t\t\tprops = props.split(\" \");\r\n\t\t}\r\n\r\n\t\tvar prop,\r\n\t\t\tindex = 0,\r\n\t\t\tlength = props.length;\r\n\r\n\t\tfor ( ; index < length ; index++ ) {\r\n\t\t\tprop = props[ index ];\r\n\t\t\ttweeners[ prop ] = tweeners[ prop ] || [];\r\n\t\t\ttweeners[ prop ].unshift( callback );\r\n\t\t}\r\n\t},\r\n\r\n\tprefilter: function( callback, prepend ) {\r\n\t\tif ( prepend ) {\r\n\t\t\tanimationPrefilters.unshift( callback );\r\n\t\t} else {\r\n\t\t\tanimationPrefilters.push( callback );\r\n\t\t}\r\n\t}\r\n});\r\n\r\njQuery.speed = function( speed, easing, fn ) {\r\n\tvar opt = speed && typeof speed === \"object\" ? jQuery.extend( {}, speed ) : {\r\n\t\tcomplete: fn || !fn && easing ||\r\n\t\t\tjQuery.isFunction( speed ) && speed,\r\n\t\tduration: speed,\r\n\t\teasing: fn && easing || easing && !jQuery.isFunction( easing ) && easing\r\n\t};\r\n\r\n\topt.duration = jQuery.fx.off ? 0 : typeof opt.duration === \"number\" ? opt.duration :\r\n\t\topt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;\r\n\r\n\t// normalize opt.queue - true/undefined/null -> \"fx\"\r\n\tif ( opt.queue == null || opt.queue === true ) {\r\n\t\topt.queue = \"fx\";\r\n\t}\r\n\r\n\t// Queueing\r\n\topt.old = opt.complete;\r\n\r\n\topt.complete = function() {\r\n\t\tif ( jQuery.isFunction( opt.old ) ) {\r\n\t\t\topt.old.call( this );\r\n\t\t}\r\n\r\n\t\tif ( opt.queue ) {\r\n\t\t\tjQuery.dequeue( this, opt.queue );\r\n\t\t}\r\n\t};\r\n\r\n\treturn opt;\r\n};\r\n\r\njQuery.fn.extend({\r\n\tfadeTo: function( speed, to, easing, callback ) {\r\n\r\n\t\t// show any hidden elements after setting opacity to 0\r\n\t\treturn this.filter( isHidden ).css( \"opacity\", 0 ).show()\r\n\r\n\t\t\t// animate to the value specified\r\n\t\t\t.end().animate({ opacity: to }, speed, easing, callback );\r\n\t},\r\n\tanimate: function( prop, speed, easing, callback ) {\r\n\t\tvar empty = jQuery.isEmptyObject( prop ),\r\n\t\t\toptall = jQuery.speed( speed, easing, callback ),\r\n\t\t\tdoAnimation = function() {\r\n\t\t\t\t// Operate on a copy of prop so per-property easing won't be lost\r\n\t\t\t\tvar anim = Animation( this, jQuery.extend( {}, prop ), optall );\r\n\r\n\t\t\t\t// Empty animations, or finishing resolves immediately\r\n\t\t\t\tif ( empty || jQuery._data( this, \"finish\" ) ) {\r\n\t\t\t\t\tanim.stop( true );\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tdoAnimation.finish = doAnimation;\r\n\r\n\t\treturn empty || optall.queue === false ?\r\n\t\t\tthis.each( doAnimation ) :\r\n\t\t\tthis.queue( optall.queue, doAnimation );\r\n\t},\r\n\tstop: function( type, clearQueue, gotoEnd ) {\r\n\t\tvar stopQueue = function( hooks ) {\r\n\t\t\tvar stop = hooks.stop;\r\n\t\t\tdelete hooks.stop;\r\n\t\t\tstop( gotoEnd );\r\n\t\t};\r\n\r\n\t\tif ( typeof type !== \"string\" ) {\r\n\t\t\tgotoEnd = clearQueue;\r\n\t\t\tclearQueue = type;\r\n\t\t\ttype = undefined;\r\n\t\t}\r\n\t\tif ( clearQueue && type !== false ) {\r\n\t\t\tthis.queue( type || \"fx\", [] );\r\n\t\t}\r\n\r\n\t\treturn this.each(function() {\r\n\t\t\tvar dequeue = true,\r\n\t\t\t\tindex = type != null && type + \"queueHooks\",\r\n\t\t\t\ttimers = jQuery.timers,\r\n\t\t\t\tdata = jQuery._data( this );\r\n\r\n\t\t\tif ( index ) {\r\n\t\t\t\tif ( data[ index ] && data[ index ].stop ) {\r\n\t\t\t\t\tstopQueue( data[ index ] );\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor ( index in data ) {\r\n\t\t\t\t\tif ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {\r\n\t\t\t\t\t\tstopQueue( data[ index ] );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor ( index = timers.length; index--; ) {\r\n\t\t\t\tif ( timers[ index ].elem === this && (type == null || timers[ index ].queue === type) ) {\r\n\t\t\t\t\ttimers[ index ].anim.stop( gotoEnd );\r\n\t\t\t\t\tdequeue = false;\r\n\t\t\t\t\ttimers.splice( index, 1 );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// start the next in the queue if the last step wasn't forced\r\n\t\t\t// timers currently will call their complete callbacks, which will dequeue\r\n\t\t\t// but only if they were gotoEnd\r\n\t\t\tif ( dequeue || !gotoEnd ) {\r\n\t\t\t\tjQuery.dequeue( this, type );\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tfinish: function( type ) {\r\n\t\tif ( type !== false ) {\r\n\t\t\ttype = type || \"fx\";\r\n\t\t}\r\n\t\treturn this.each(function() {\r\n\t\t\tvar index,\r\n\t\t\t\tdata = jQuery._data( this ),\r\n\t\t\t\tqueue = data[ type + \"queue\" ],\r\n\t\t\t\thooks = data[ type + \"queueHooks\" ],\r\n\t\t\t\ttimers = jQuery.timers,\r\n\t\t\t\tlength = queue ? queue.length : 0;\r\n\r\n\t\t\t// enable finishing flag on private data\r\n\t\t\tdata.finish = true;\r\n\r\n\t\t\t// empty the queue first\r\n\t\t\tjQuery.queue( this, type, [] );\r\n\r\n\t\t\tif ( hooks && hooks.stop ) {\r\n\t\t\t\thooks.stop.call( this, true );\r\n\t\t\t}\r\n\r\n\t\t\t// look for any active animations, and finish them\r\n\t\t\tfor ( index = timers.length; index--; ) {\r\n\t\t\t\tif ( timers[ index ].elem === this && timers[ index ].queue === type ) {\r\n\t\t\t\t\ttimers[ index ].anim.stop( true );\r\n\t\t\t\t\ttimers.splice( index, 1 );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// look for any animations in the old queue and finish them\r\n\t\t\tfor ( index = 0; index < length; index++ ) {\r\n\t\t\t\tif ( queue[ index ] && queue[ index ].finish ) {\r\n\t\t\t\t\tqueue[ index ].finish.call( this );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// turn off finishing flag\r\n\t\t\tdelete data.finish;\r\n\t\t});\r\n\t}\r\n});\r\n\r\njQuery.each([ \"toggle\", \"show\", \"hide\" ], function( i, name ) {\r\n\tvar cssFn = jQuery.fn[ name ];\r\n\tjQuery.fn[ name ] = function( speed, easing, callback ) {\r\n\t\treturn speed == null || typeof speed === \"boolean\" ?\r\n\t\t\tcssFn.apply( this, arguments ) :\r\n\t\t\tthis.animate( genFx( name, true ), speed, easing, callback );\r\n\t};\r\n});\r\n\r\n// Generate shortcuts for custom animations\r\njQuery.each({\r\n\tslideDown: genFx(\"show\"),\r\n\tslideUp: genFx(\"hide\"),\r\n\tslideToggle: genFx(\"toggle\"),\r\n\tfadeIn: { opacity: \"show\" },\r\n\tfadeOut: { opacity: \"hide\" },\r\n\tfadeToggle: { opacity: \"toggle\" }\r\n}, function( name, props ) {\r\n\tjQuery.fn[ name ] = function( speed, easing, callback ) {\r\n\t\treturn this.animate( props, speed, easing, callback );\r\n\t};\r\n});\r\n\r\njQuery.timers = [];\r\njQuery.fx.tick = function() {\r\n\tvar timer,\r\n\t\ttimers = jQuery.timers,\r\n\t\ti = 0;\r\n\r\n\tfxNow = jQuery.now();\r\n\r\n\tfor ( ; i < timers.length; i++ ) {\r\n\t\ttimer = timers[ i ];\r\n\t\t// Checks the timer has not already been removed\r\n\t\tif ( !timer() && timers[ i ] === timer ) {\r\n\t\t\ttimers.splice( i--, 1 );\r\n\t\t}\r\n\t}\r\n\r\n\tif ( !timers.length ) {\r\n\t\tjQuery.fx.stop();\r\n\t}\r\n\tfxNow = undefined;\r\n};\r\n\r\njQuery.fx.timer = function( timer ) {\r\n\tjQuery.timers.push( timer );\r\n\tif ( timer() ) {\r\n\t\tjQuery.fx.start();\r\n\t} else {\r\n\t\tjQuery.timers.pop();\r\n\t}\r\n};\r\n\r\njQuery.fx.interval = 13;\r\n\r\njQuery.fx.start = function() {\r\n\tif ( !timerId ) {\r\n\t\ttimerId = setInterval( jQuery.fx.tick, jQuery.fx.interval );\r\n\t}\r\n};\r\n\r\njQuery.fx.stop = function() {\r\n\tclearInterval( timerId );\r\n\ttimerId = null;\r\n};\r\n\r\njQuery.fx.speeds = {\r\n\tslow: 600,\r\n\tfast: 200,\r\n\t// Default speed\r\n\t_default: 400\r\n};\r\n\r\n\r\n// Based off of the plugin by Clint Helfers, with permission.\r\n// http://blindsignals.com/index.php/2009/07/jquery-delay/\r\njQuery.fn.delay = function( time, type ) {\r\n\ttime = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;\r\n\ttype = type || \"fx\";\r\n\r\n\treturn this.queue( type, function( next, hooks ) {\r\n\t\tvar timeout = setTimeout( next, time );\r\n\t\thooks.stop = function() {\r\n\t\t\tclearTimeout( timeout );\r\n\t\t};\r\n\t});\r\n};\r\n\r\n\r\n(function() {\r\n\t// Minified: var a,b,c,d,e\r\n\tvar input, div, select, a, opt;\r\n\r\n\t// Setup\r\n\tdiv = document.createElement( \"div\" );\r\n\tdiv.setAttribute( \"className\", \"t\" );\r\n\tdiv.innerHTML = \"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\";\r\n\ta = div.getElementsByTagName(\"a\")[ 0 ];\r\n\r\n\t// First batch of tests.\r\n\tselect = document.createElement(\"select\");\r\n\topt = select.appendChild( document.createElement(\"option\") );\r\n\tinput = div.getElementsByTagName(\"input\")[ 0 ];\r\n\r\n\ta.style.cssText = \"top:1px\";\r\n\r\n\t// Test setAttribute on camelCase class. If it works, we need attrFixes when doing get/setAttribute (ie6/7)\r\n\tsupport.getSetAttribute = div.className !== \"t\";\r\n\r\n\t// Get the style information from getAttribute\r\n\t// (IE uses .cssText instead)\r\n\tsupport.style = /top/.test( a.getAttribute(\"style\") );\r\n\r\n\t// Make sure that URLs aren't manipulated\r\n\t// (IE normalizes it by default)\r\n\tsupport.hrefNormalized = a.getAttribute(\"href\") === \"/a\";\r\n\r\n\t// Check the default checkbox/radio value (\"\" on WebKit; \"on\" elsewhere)\r\n\tsupport.checkOn = !!input.value;\r\n\r\n\t// Make sure that a selected-by-default option has a working selected property.\r\n\t// (WebKit defaults to false instead of true, IE too, if it's in an optgroup)\r\n\tsupport.optSelected = opt.selected;\r\n\r\n\t// Tests for enctype support on a form (#6743)\r\n\tsupport.enctype = !!document.createElement(\"form\").enctype;\r\n\r\n\t// Make sure that the options inside disabled selects aren't marked as disabled\r\n\t// (WebKit marks them as disabled)\r\n\tselect.disabled = true;\r\n\tsupport.optDisabled = !opt.disabled;\r\n\r\n\t// Support: IE8 only\r\n\t// Check if we can trust getAttribute(\"value\")\r\n\tinput = document.createElement( \"input\" );\r\n\tinput.setAttribute( \"value\", \"\" );\r\n\tsupport.input = input.getAttribute( \"value\" ) === \"\";\r\n\r\n\t// Check if an input maintains its value after becoming a radio\r\n\tinput.value = \"t\";\r\n\tinput.setAttribute( \"type\", \"radio\" );\r\n\tsupport.radioValue = input.value === \"t\";\r\n})();\r\n\r\n\r\nvar rreturn = /\\r/g;\r\n\r\njQuery.fn.extend({\r\n\tval: function( value ) {\r\n\t\tvar hooks, ret, isFunction,\r\n\t\t\telem = this[0];\r\n\r\n\t\tif ( !arguments.length ) {\r\n\t\t\tif ( elem ) {\r\n\t\t\t\thooks = jQuery.valHooks[ elem.type ] || jQuery.valHooks[ elem.nodeName.toLowerCase() ];\r\n\r\n\t\t\t\tif ( hooks && \"get\" in hooks && (ret = hooks.get( elem, \"value\" )) !== undefined ) {\r\n\t\t\t\t\treturn ret;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tret = elem.value;\r\n\r\n\t\t\t\treturn typeof ret === \"string\" ?\r\n\t\t\t\t\t// handle most common string cases\r\n\t\t\t\t\tret.replace(rreturn, \"\") :\r\n\t\t\t\t\t// handle cases where value is null/undef or number\r\n\t\t\t\t\tret == null ? \"\" : ret;\r\n\t\t\t}\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tisFunction = jQuery.isFunction( value );\r\n\r\n\t\treturn this.each(function( i ) {\r\n\t\t\tvar val;\r\n\r\n\t\t\tif ( this.nodeType !== 1 ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( isFunction ) {\r\n\t\t\t\tval = value.call( this, i, jQuery( this ).val() );\r\n\t\t\t} else {\r\n\t\t\t\tval = value;\r\n\t\t\t}\r\n\r\n\t\t\t// Treat null/undefined as \"\"; convert numbers to string\r\n\t\t\tif ( val == null ) {\r\n\t\t\t\tval = \"\";\r\n\t\t\t} else if ( typeof val === \"number\" ) {\r\n\t\t\t\tval += \"\";\r\n\t\t\t} else if ( jQuery.isArray( val ) ) {\r\n\t\t\t\tval = jQuery.map( val, function( value ) {\r\n\t\t\t\t\treturn value == null ? \"\" : value + \"\";\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\thooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];\r\n\r\n\t\t\t// If set returns undefined, fall back to normal setting\r\n\t\t\tif ( !hooks || !(\"set\" in hooks) || hooks.set( this, val, \"value\" ) === undefined ) {\r\n\t\t\t\tthis.value = val;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n});\r\n\r\njQuery.extend({\r\n\tvalHooks: {\r\n\t\toption: {\r\n\t\t\tget: function( elem ) {\r\n\t\t\t\tvar val = jQuery.find.attr( elem, \"value\" );\r\n\t\t\t\treturn val != null ?\r\n\t\t\t\t\tval :\r\n\t\t\t\t\t// Support: IE10-11+\r\n\t\t\t\t\t// option.text throws exceptions (#14686, #14858)\r\n\t\t\t\t\tjQuery.trim( jQuery.text( elem ) );\r\n\t\t\t}\r\n\t\t},\r\n\t\tselect: {\r\n\t\t\tget: function( elem ) {\r\n\t\t\t\tvar value, option,\r\n\t\t\t\t\toptions = elem.options,\r\n\t\t\t\t\tindex = elem.selectedIndex,\r\n\t\t\t\t\tone = elem.type === \"select-one\" || index < 0,\r\n\t\t\t\t\tvalues = one ? null : [],\r\n\t\t\t\t\tmax = one ? index + 1 : options.length,\r\n\t\t\t\t\ti = index < 0 ?\r\n\t\t\t\t\t\tmax :\r\n\t\t\t\t\t\tone ? index : 0;\r\n\r\n\t\t\t\t// Loop through all the selected options\r\n\t\t\t\tfor ( ; i < max; i++ ) {\r\n\t\t\t\t\toption = options[ i ];\r\n\r\n\t\t\t\t\t// oldIE doesn't update selected after form reset (#2551)\r\n\t\t\t\t\tif ( ( option.selected || i === index ) &&\r\n\t\t\t\t\t\t\t// Don't return options that are disabled or in a disabled optgroup\r\n\t\t\t\t\t\t\t( support.optDisabled ? !option.disabled : option.getAttribute(\"disabled\") === null ) &&\r\n\t\t\t\t\t\t\t( !option.parentNode.disabled || !jQuery.nodeName( option.parentNode, \"optgroup\" ) ) ) {\r\n\r\n\t\t\t\t\t\t// Get the specific value for the option\r\n\t\t\t\t\t\tvalue = jQuery( option ).val();\r\n\r\n\t\t\t\t\t\t// We don't need an array for one selects\r\n\t\t\t\t\t\tif ( one ) {\r\n\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Multi-Selects return an array\r\n\t\t\t\t\t\tvalues.push( value );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn values;\r\n\t\t\t},\r\n\r\n\t\t\tset: function( elem, value ) {\r\n\t\t\t\tvar optionSet, option,\r\n\t\t\t\t\toptions = elem.options,\r\n\t\t\t\t\tvalues = jQuery.makeArray( value ),\r\n\t\t\t\t\ti = options.length;\r\n\r\n\t\t\t\twhile ( i-- ) {\r\n\t\t\t\t\toption = options[ i ];\r\n\r\n\t\t\t\t\tif ( jQuery.inArray( jQuery.valHooks.option.get( option ), values ) >= 0 ) {\r\n\r\n\t\t\t\t\t\t// Support: IE6\r\n\t\t\t\t\t\t// When new option element is added to select box we need to\r\n\t\t\t\t\t\t// force reflow of newly added node in order to workaround delay\r\n\t\t\t\t\t\t// of initialization properties\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\toption.selected = optionSet = true;\r\n\r\n\t\t\t\t\t\t} catch ( _ ) {\r\n\r\n\t\t\t\t\t\t\t// Will be executed only in IE6\r\n\t\t\t\t\t\t\toption.scrollHeight;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toption.selected = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Force browsers to behave consistently when non-matching value is set\r\n\t\t\t\tif ( !optionSet ) {\r\n\t\t\t\t\telem.selectedIndex = -1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn options;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// Radios and checkboxes getter/setter\r\njQuery.each([ \"radio\", \"checkbox\" ], function() {\r\n\tjQuery.valHooks[ this ] = {\r\n\t\tset: function( elem, value ) {\r\n\t\t\tif ( jQuery.isArray( value ) ) {\r\n\t\t\t\treturn ( elem.checked = jQuery.inArray( jQuery(elem).val(), value ) >= 0 );\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif ( !support.checkOn ) {\r\n\t\tjQuery.valHooks[ this ].get = function( elem ) {\r\n\t\t\t// Support: Webkit\r\n\t\t\t// \"\" is returned instead of \"on\" if a value isn't specified\r\n\t\t\treturn elem.getAttribute(\"value\") === null ? \"on\" : elem.value;\r\n\t\t};\r\n\t}\r\n});\r\n\r\n\r\n\r\n\r\nvar nodeHook, boolHook,\r\n\tattrHandle = jQuery.expr.attrHandle,\r\n\truseDefault = /^(?:checked|selected)$/i,\r\n\tgetSetAttribute = support.getSetAttribute,\r\n\tgetSetInput = support.input;\r\n\r\njQuery.fn.extend({\r\n\tattr: function( name, value ) {\r\n\t\treturn access( this, jQuery.attr, name, value, arguments.length > 1 );\r\n\t},\r\n\r\n\tremoveAttr: function( name ) {\r\n\t\treturn this.each(function() {\r\n\t\t\tjQuery.removeAttr( this, name );\r\n\t\t});\r\n\t}\r\n});\r\n\r\njQuery.extend({\r\n\tattr: function( elem, name, value ) {\r\n\t\tvar hooks, ret,\r\n\t\t\tnType = elem.nodeType;\r\n\r\n\t\t// don't get/set attributes on text, comment and attribute nodes\r\n\t\tif ( !elem || nType === 3 || nType === 8 || nType === 2 ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Fallback to prop when attributes are not supported\r\n\t\tif ( typeof elem.getAttribute === strundefined ) {\r\n\t\t\treturn jQuery.prop( elem, name, value );\r\n\t\t}\r\n\r\n\t\t// All attributes are lowercase\r\n\t\t// Grab necessary hook if one is defined\r\n\t\tif ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {\r\n\t\t\tname = name.toLowerCase();\r\n\t\t\thooks = jQuery.attrHooks[ name ] ||\r\n\t\t\t\t( jQuery.expr.match.bool.test( name ) ? boolHook : nodeHook );\r\n\t\t}\r\n\r\n\t\tif ( value !== undefined ) {\r\n\r\n\t\t\tif ( value === null ) {\r\n\t\t\t\tjQuery.removeAttr( elem, name );\r\n\r\n\t\t\t} else if ( hooks && \"set\" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ) {\r\n\t\t\t\treturn ret;\r\n\r\n\t\t\t} else {\r\n\t\t\t\telem.setAttribute( name, value + \"\" );\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\r\n\t\t} else if ( hooks && \"get\" in hooks && (ret = hooks.get( elem, name )) !== null ) {\r\n\t\t\treturn ret;\r\n\r\n\t\t} else {\r\n\t\t\tret = jQuery.find.attr( elem, name );\r\n\r\n\t\t\t// Non-existent attributes return null, we normalize to undefined\r\n\t\t\treturn ret == null ?\r\n\t\t\t\tundefined :\r\n\t\t\t\tret;\r\n\t\t}\r\n\t},\r\n\r\n\tremoveAttr: function( elem, value ) {\r\n\t\tvar name, propName,\r\n\t\t\ti = 0,\r\n\t\t\tattrNames = value && value.match( rnotwhite );\r\n\r\n\t\tif ( attrNames && elem.nodeType === 1 ) {\r\n\t\t\twhile ( (name = attrNames[i++]) ) {\r\n\t\t\t\tpropName = jQuery.propFix[ name ] || name;\r\n\r\n\t\t\t\t// Boolean attributes get special treatment (#10870)\r\n\t\t\t\tif ( jQuery.expr.match.bool.test( name ) ) {\r\n\t\t\t\t\t// Set corresponding property to false\r\n\t\t\t\t\tif ( getSetInput && getSetAttribute || !ruseDefault.test( name ) ) {\r\n\t\t\t\t\t\telem[ propName ] = false;\r\n\t\t\t\t\t// Support: IE<9\r\n\t\t\t\t\t// Also clear defaultChecked/defaultSelected (if appropriate)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telem[ jQuery.camelCase( \"default-\" + name ) ] =\r\n\t\t\t\t\t\t\telem[ propName ] = false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t// See #9699 for explanation of this approach (setting first, then removal)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjQuery.attr( elem, name, \"\" );\r\n\t\t\t\t}\r\n\r\n\t\t\t\telem.removeAttribute( getSetAttribute ? name : propName );\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tattrHooks: {\r\n\t\ttype: {\r\n\t\t\tset: function( elem, value ) {\r\n\t\t\t\tif ( !support.radioValue && value === \"radio\" && jQuery.nodeName(elem, \"input\") ) {\r\n\t\t\t\t\t// Setting the type on a radio button after the value resets the value in IE6-9\r\n\t\t\t\t\t// Reset value to default in case type is set after value during creation\r\n\t\t\t\t\tvar val = elem.value;\r\n\t\t\t\t\telem.setAttribute( \"type\", value );\r\n\t\t\t\t\tif ( val ) {\r\n\t\t\t\t\t\telem.value = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// Hook for boolean attributes\r\nboolHook = {\r\n\tset: function( elem, value, name ) {\r\n\t\tif ( value === false ) {\r\n\t\t\t// Remove boolean attributes when set to false\r\n\t\t\tjQuery.removeAttr( elem, name );\r\n\t\t} else if ( getSetInput && getSetAttribute || !ruseDefault.test( name ) ) {\r\n\t\t\t// IE<8 needs the *property* name\r\n\t\t\telem.setAttribute( !getSetAttribute && jQuery.propFix[ name ] || name, name );\r\n\r\n\t\t// Use defaultChecked and defaultSelected for oldIE\r\n\t\t} else {\r\n\t\t\telem[ jQuery.camelCase( \"default-\" + name ) ] = elem[ name ] = true;\r\n\t\t}\r\n\r\n\t\treturn name;\r\n\t}\r\n};\r\n\r\n// Retrieve booleans specially\r\njQuery.each( jQuery.expr.match.bool.source.match( /\\w+/g ), function( i, name ) {\r\n\r\n\tvar getter = attrHandle[ name ] || jQuery.find.attr;\r\n\r\n\tattrHandle[ name ] = getSetInput && getSetAttribute || !ruseDefault.test( name ) ?\r\n\t\tfunction( elem, name, isXML ) {\r\n\t\t\tvar ret, handle;\r\n\t\t\tif ( !isXML ) {\r\n\t\t\t\t// Avoid an infinite loop by temporarily removing this function from the getter\r\n\t\t\t\thandle = attrHandle[ name ];\r\n\t\t\t\tattrHandle[ name ] = ret;\r\n\t\t\t\tret = getter( elem, name, isXML ) != null ?\r\n\t\t\t\t\tname.toLowerCase() :\r\n\t\t\t\t\tnull;\r\n\t\t\t\tattrHandle[ name ] = handle;\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t} :\r\n\t\tfunction( elem, name, isXML ) {\r\n\t\t\tif ( !isXML ) {\r\n\t\t\t\treturn elem[ jQuery.camelCase( \"default-\" + name ) ] ?\r\n\t\t\t\t\tname.toLowerCase() :\r\n\t\t\t\t\tnull;\r\n\t\t\t}\r\n\t\t};\r\n});\r\n\r\n// fix oldIE attroperties\r\nif ( !getSetInput || !getSetAttribute ) {\r\n\tjQuery.attrHooks.value = {\r\n\t\tset: function( elem, value, name ) {\r\n\t\t\tif ( jQuery.nodeName( elem, \"input\" ) ) {\r\n\t\t\t\t// Does not return so that setAttribute is also used\r\n\t\t\t\telem.defaultValue = value;\r\n\t\t\t} else {\r\n\t\t\t\t// Use nodeHook if defined (#1954); otherwise setAttribute is fine\r\n\t\t\t\treturn nodeHook && nodeHook.set( elem, value, name );\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\n// IE6/7 do not support getting/setting some attributes with get/setAttribute\r\nif ( !getSetAttribute ) {\r\n\r\n\t// Use this for any attribute in IE6/7\r\n\t// This fixes almost every IE6/7 issue\r\n\tnodeHook = {\r\n\t\tset: function( elem, value, name ) {\r\n\t\t\t// Set the existing or create a new attribute node\r\n\t\t\tvar ret = elem.getAttributeNode( name );\r\n\t\t\tif ( !ret ) {\r\n\t\t\t\telem.setAttributeNode(\r\n\t\t\t\t\t(ret = elem.ownerDocument.createAttribute( name ))\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tret.value = value += \"\";\r\n\r\n\t\t\t// Break association with cloned elements by also using setAttribute (#9646)\r\n\t\t\tif ( name === \"value\" || value === elem.getAttribute( name ) ) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Some attributes are constructed with empty-string values when not defined\r\n\tattrHandle.id = attrHandle.name = attrHandle.coords =\r\n\t\tfunction( elem, name, isXML ) {\r\n\t\t\tvar ret;\r\n\t\t\tif ( !isXML ) {\r\n\t\t\t\treturn (ret = elem.getAttributeNode( name )) && ret.value !== \"\" ?\r\n\t\t\t\t\tret.value :\r\n\t\t\t\t\tnull;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t// Fixing value retrieval on a button requires this module\r\n\tjQuery.valHooks.button = {\r\n\t\tget: function( elem, name ) {\r\n\t\t\tvar ret = elem.getAttributeNode( name );\r\n\t\t\tif ( ret && ret.specified ) {\r\n\t\t\t\treturn ret.value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tset: nodeHook.set\r\n\t};\r\n\r\n\t// Set contenteditable to false on removals(#10429)\r\n\t// Setting to empty string throws an error as an invalid value\r\n\tjQuery.attrHooks.contenteditable = {\r\n\t\tset: function( elem, value, name ) {\r\n\t\t\tnodeHook.set( elem, value === \"\" ? false : value, name );\r\n\t\t}\r\n\t};\r\n\r\n\t// Set width and height to auto instead of 0 on empty string( Bug #8150 )\r\n\t// This is for removals\r\n\tjQuery.each([ \"width\", \"height\" ], function( i, name ) {\r\n\t\tjQuery.attrHooks[ name ] = {\r\n\t\t\tset: function( elem, value ) {\r\n\t\t\t\tif ( value === \"\" ) {\r\n\t\t\t\t\telem.setAttribute( name, \"auto\" );\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t});\r\n}\r\n\r\nif ( !support.style ) {\r\n\tjQuery.attrHooks.style = {\r\n\t\tget: function( elem ) {\r\n\t\t\t// Return undefined in the case of empty string\r\n\t\t\t// Note: IE uppercases css property names, but if we were to .toLowerCase()\r\n\t\t\t// .cssText, that would destroy case senstitivity in URL's, like in \"background\"\r\n\t\t\treturn elem.style.cssText || undefined;\r\n\t\t},\r\n\t\tset: function( elem, value ) {\r\n\t\t\treturn ( elem.style.cssText = value + \"\" );\r\n\t\t}\r\n\t};\r\n}\r\n\r\n\r\n\r\n\r\nvar rfocusable = /^(?:input|select|textarea|button|object)$/i,\r\n\trclickable = /^(?:a|area)$/i;\r\n\r\njQuery.fn.extend({\r\n\tprop: function( name, value ) {\r\n\t\treturn access( this, jQuery.prop, name, value, arguments.length > 1 );\r\n\t},\r\n\r\n\tremoveProp: function( name ) {\r\n\t\tname = jQuery.propFix[ name ] || name;\r\n\t\treturn this.each(function() {\r\n\t\t\t// try/catch handles cases where IE balks (such as removing a property on window)\r\n\t\t\ttry {\r\n\t\t\t\tthis[ name ] = undefined;\r\n\t\t\t\tdelete this[ name ];\r\n\t\t\t} catch( e ) {}\r\n\t\t});\r\n\t}\r\n});\r\n\r\njQuery.extend({\r\n\tpropFix: {\r\n\t\t\"for\": \"htmlFor\",\r\n\t\t\"class\": \"className\"\r\n\t},\r\n\r\n\tprop: function( elem, name, value ) {\r\n\t\tvar ret, hooks, notxml,\r\n\t\t\tnType = elem.nodeType;\r\n\r\n\t\t// don't get/set properties on text, comment and attribute nodes\r\n\t\tif ( !elem || nType === 3 || nType === 8 || nType === 2 ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tnotxml = nType !== 1 || !jQuery.isXMLDoc( elem );\r\n\r\n\t\tif ( notxml ) {\r\n\t\t\t// Fix name and attach hooks\r\n\t\t\tname = jQuery.propFix[ name ] || name;\r\n\t\t\thooks = jQuery.propHooks[ name ];\r\n\t\t}\r\n\r\n\t\tif ( value !== undefined ) {\r\n\t\t\treturn hooks && \"set\" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ?\r\n\t\t\t\tret :\r\n\t\t\t\t( elem[ name ] = value );\r\n\r\n\t\t} else {\r\n\t\t\treturn hooks && \"get\" in hooks && (ret = hooks.get( elem, name )) !== null ?\r\n\t\t\t\tret :\r\n\t\t\t\telem[ name ];\r\n\t\t}\r\n\t},\r\n\r\n\tpropHooks: {\r\n\t\ttabIndex: {\r\n\t\t\tget: function( elem ) {\r\n\t\t\t\t// elem.tabIndex doesn't always return the correct value when it hasn't been explicitly set\r\n\t\t\t\t// http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/\r\n\t\t\t\t// Use proper attribute retrieval(#12072)\r\n\t\t\t\tvar tabindex = jQuery.find.attr( elem, \"tabindex\" );\r\n\r\n\t\t\t\treturn tabindex ?\r\n\t\t\t\t\tparseInt( tabindex, 10 ) :\r\n\t\t\t\t\trfocusable.test( elem.nodeName ) || rclickable.test( elem.nodeName ) && elem.href ?\r\n\t\t\t\t\t\t0 :\r\n\t\t\t\t\t\t-1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// Some attributes require a special call on IE\r\n// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx\r\nif ( !support.hrefNormalized ) {\r\n\t// href/src property should get the full normalized URL (#10299/#12915)\r\n\tjQuery.each([ \"href\", \"src\" ], function( i, name ) {\r\n\t\tjQuery.propHooks[ name ] = {\r\n\t\t\tget: function( elem ) {\r\n\t\t\t\treturn elem.getAttribute( name, 4 );\r\n\t\t\t}\r\n\t\t};\r\n\t});\r\n}\r\n\r\n// Support: Safari, IE9+\r\n// mis-reports the default selected property of an option\r\n// Accessing the parent's selectedIndex property fixes it\r\nif ( !support.optSelected ) {\r\n\tjQuery.propHooks.selected = {\r\n\t\tget: function( elem ) {\r\n\t\t\tvar parent = elem.parentNode;\r\n\r\n\t\t\tif ( parent ) {\r\n\t\t\t\tparent.selectedIndex;\r\n\r\n\t\t\t\t// Make sure that it also works with optgroups, see #5701\r\n\t\t\t\tif ( parent.parentNode ) {\r\n\t\t\t\t\tparent.parentNode.selectedIndex;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n}\r\n\r\njQuery.each([\r\n\t\"tabIndex\",\r\n\t\"readOnly\",\r\n\t\"maxLength\",\r\n\t\"cellSpacing\",\r\n\t\"cellPadding\",\r\n\t\"rowSpan\",\r\n\t\"colSpan\",\r\n\t\"useMap\",\r\n\t\"frameBorder\",\r\n\t\"contentEditable\"\r\n], function() {\r\n\tjQuery.propFix[ this.toLowerCase() ] = this;\r\n});\r\n\r\n// IE6/7 call enctype encoding\r\nif ( !support.enctype ) {\r\n\tjQuery.propFix.enctype = \"encoding\";\r\n}\r\n\r\n\r\n\r\n\r\nvar rclass = /[\\t\\r\\n\\f]/g;\r\n\r\njQuery.fn.extend({\r\n\taddClass: function( value ) {\r\n\t\tvar classes, elem, cur, clazz, j, finalValue,\r\n\t\t\ti = 0,\r\n\t\t\tlen = this.length,\r\n\t\t\tproceed = typeof value === \"string\" && value;\r\n\r\n\t\tif ( jQuery.isFunction( value ) ) {\r\n\t\t\treturn this.each(function( j ) {\r\n\t\t\t\tjQuery( this ).addClass( value.call( this, j, this.className ) );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif ( proceed ) {\r\n\t\t\t// The disjunction here is for better compressibility (see removeClass)\r\n\t\t\tclasses = ( value || \"\" ).match( rnotwhite ) || [];\r\n\r\n\t\t\tfor ( ; i < len; i++ ) {\r\n\t\t\t\telem = this[ i ];\r\n\t\t\t\tcur = elem.nodeType === 1 && ( elem.className ?\r\n\t\t\t\t\t( \" \" + elem.className + \" \" ).replace( rclass, \" \" ) :\r\n\t\t\t\t\t\" \"\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif ( cur ) {\r\n\t\t\t\t\tj = 0;\r\n\t\t\t\t\twhile ( (clazz = classes[j++]) ) {\r\n\t\t\t\t\t\tif ( cur.indexOf( \" \" + clazz + \" \" ) < 0 ) {\r\n\t\t\t\t\t\t\tcur += clazz + \" \";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// only assign if different to avoid unneeded rendering.\r\n\t\t\t\t\tfinalValue = jQuery.trim( cur );\r\n\t\t\t\t\tif ( elem.className !== finalValue ) {\r\n\t\t\t\t\t\telem.className = finalValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\tremoveClass: function( value ) {\r\n\t\tvar classes, elem, cur, clazz, j, finalValue,\r\n\t\t\ti = 0,\r\n\t\t\tlen = this.length,\r\n\t\t\tproceed = arguments.length === 0 || typeof value === \"string\" && value;\r\n\r\n\t\tif ( jQuery.isFunction( value ) ) {\r\n\t\t\treturn this.each(function( j ) {\r\n\t\t\t\tjQuery( this ).removeClass( value.call( this, j, this.className ) );\r\n\t\t\t});\r\n\t\t}\r\n\t\tif ( proceed ) {\r\n\t\t\tclasses = ( value || \"\" ).match( rnotwhite ) || [];\r\n\r\n\t\t\tfor ( ; i < len; i++ ) {\r\n\t\t\t\telem = this[ i ];\r\n\t\t\t\t// This expression is here for better compressibility (see addClass)\r\n\t\t\t\tcur = elem.nodeType === 1 && ( elem.className ?\r\n\t\t\t\t\t( \" \" + elem.className + \" \" ).replace( rclass, \" \" ) :\r\n\t\t\t\t\t\"\"\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif ( cur ) {\r\n\t\t\t\t\tj = 0;\r\n\t\t\t\t\twhile ( (clazz = classes[j++]) ) {\r\n\t\t\t\t\t\t// Remove *all* instances\r\n\t\t\t\t\t\twhile ( cur.indexOf( \" \" + clazz + \" \" ) >= 0 ) {\r\n\t\t\t\t\t\t\tcur = cur.replace( \" \" + clazz + \" \", \" \" );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// only assign if different to avoid unneeded rendering.\r\n\t\t\t\t\tfinalValue = value ? jQuery.trim( cur ) : \"\";\r\n\t\t\t\t\tif ( elem.className !== finalValue ) {\r\n\t\t\t\t\t\telem.className = finalValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\ttoggleClass: function( value, stateVal ) {\r\n\t\tvar type = typeof value;\r\n\r\n\t\tif ( typeof stateVal === \"boolean\" && type === \"string\" ) {\r\n\t\t\treturn stateVal ? this.addClass( value ) : this.removeClass( value );\r\n\t\t}\r\n\r\n\t\tif ( jQuery.isFunction( value ) ) {\r\n\t\t\treturn this.each(function( i ) {\r\n\t\t\t\tjQuery( this ).toggleClass( value.call(this, i, this.className, stateVal), stateVal );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this.each(function() {\r\n\t\t\tif ( type === \"string\" ) {\r\n\t\t\t\t// toggle individual class names\r\n\t\t\t\tvar className,\r\n\t\t\t\t\ti = 0,\r\n\t\t\t\t\tself = jQuery( this ),\r\n\t\t\t\t\tclassNames = value.match( rnotwhite ) || [];\r\n\r\n\t\t\t\twhile ( (className = classNames[ i++ ]) ) {\r\n\t\t\t\t\t// check each className given, space separated list\r\n\t\t\t\t\tif ( self.hasClass( className ) ) {\r\n\t\t\t\t\t\tself.removeClass( className );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.addClass( className );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t// Toggle whole class name\r\n\t\t\t} else if ( type === strundefined || type === \"boolean\" ) {\r\n\t\t\t\tif ( this.className ) {\r\n\t\t\t\t\t// store className if set\r\n\t\t\t\t\tjQuery._data( this, \"__className__\", this.className );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If the element has a class name or if we're passed \"false\",\r\n\t\t\t\t// then remove the whole classname (if there was one, the above saved it).\r\n\t\t\t\t// Otherwise bring back whatever was previously saved (if anything),\r\n\t\t\t\t// falling back to the empty string if nothing was stored.\r\n\t\t\t\tthis.className = this.className || value === false ? \"\" : jQuery._data( this, \"__className__\" ) || \"\";\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\thasClass: function( selector ) {\r\n\t\tvar className = \" \" + selector + \" \",\r\n\t\t\ti = 0,\r\n\t\t\tl = this.length;\r\n\t\tfor ( ; i < l; i++ ) {\r\n\t\t\tif ( this[i].nodeType === 1 && (\" \" + this[i].className + \" \").replace(rclass, \" \").indexOf( className ) >= 0 ) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n});\r\n\r\n\r\n\r\n\r\n// Return jQuery for attributes-only inclusion\r\n\r\n\r\njQuery.each( (\"blur focus focusin focusout load resize scroll unload click dblclick \" +\r\n\t\"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave \" +\r\n\t\"change select submit keydown keypress keyup error contextmenu\").split(\" \"), function( i, name ) {\r\n\r\n\t// Handle event binding\r\n\tjQuery.fn[ name ] = function( data, fn ) {\r\n\t\treturn arguments.length > 0 ?\r\n\t\t\tthis.on( name, null, data, fn ) :\r\n\t\t\tthis.trigger( name );\r\n\t};\r\n});\r\n\r\njQuery.fn.extend({\r\n\thover: function( fnOver, fnOut ) {\r\n\t\treturn this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );\r\n\t},\r\n\r\n\tbind: function( types, data, fn ) {\r\n\t\treturn this.on( types, null, data, fn );\r\n\t},\r\n\tunbind: function( types, fn ) {\r\n\t\treturn this.off( types, null, fn );\r\n\t},\r\n\r\n\tdelegate: function( selector, types, data, fn ) {\r\n\t\treturn this.on( types, selector, data, fn );\r\n\t},\r\n\tundelegate: function( selector, types, fn ) {\r\n\t\t// ( namespace ) or ( selector, types [, fn] )\r\n\t\treturn arguments.length === 1 ? this.off( selector, \"**\" ) : this.off( types, selector || \"**\", fn );\r\n\t}\r\n});\r\n\r\n\r\nvar nonce = jQuery.now();\r\n\r\nvar rquery = (/\\?/);\r\n\r\n\r\n\r\nvar rvalidtokens = /(,)|(\\[|{)|(}|])|\"(?:[^\"\\\\\\r\\n]|\\\\[\"\\\\\\/bfnrt]|\\\\u[\\da-fA-F]{4})*\"\\s*:?|true|false|null|-?(?!0\\d)\\d+(?:\\.\\d+|)(?:[eE][+-]?\\d+|)/g;\r\n\r\njQuery.parseJSON = function( data ) {\r\n\t// Attempt to parse using the native JSON parser first\r\n\tif ( window.JSON && window.JSON.parse ) {\r\n\t\t// Support: Android 2.3\r\n\t\t// Workaround failure to string-cast null input\r\n\t\treturn window.JSON.parse( data + \"\" );\r\n\t}\r\n\r\n\tvar requireNonComma,\r\n\t\tdepth = null,\r\n\t\tstr = jQuery.trim( data + \"\" );\r\n\r\n\t// Guard against invalid (and possibly dangerous) input by ensuring that nothing remains\r\n\t// after removing valid tokens\r\n\treturn str && !jQuery.trim( str.replace( rvalidtokens, function( token, comma, open, close ) {\r\n\r\n\t\t// Force termination if we see a misplaced comma\r\n\t\tif ( requireNonComma && comma ) {\r\n\t\t\tdepth = 0;\r\n\t\t}\r\n\r\n\t\t// Perform no more replacements after returning to outermost depth\r\n\t\tif ( depth === 0 ) {\r\n\t\t\treturn token;\r\n\t\t}\r\n\r\n\t\t// Commas must not follow \"[\", \"{\", or \",\"\r\n\t\trequireNonComma = open || comma;\r\n\r\n\t\t// Determine new depth\r\n\t\t// array/object open (\"[\" or \"{\"): depth += true - false (increment)\r\n\t\t// array/object close (\"]\" or \"}\"): depth += false - true (decrement)\r\n\t\t// other cases (\",\" or primitive): depth += true - true (numeric cast)\r\n\t\tdepth += !close - !open;\r\n\r\n\t\t// Remove this token\r\n\t\treturn \"\";\r\n\t}) ) ?\r\n\t\t( Function( \"return \" + str ) )() :\r\n\t\tjQuery.error( \"Invalid JSON: \" + data );\r\n};\r\n\r\n\r\n// Cross-browser xml parsing\r\njQuery.parseXML = function( data ) {\r\n\tvar xml, tmp;\r\n\tif ( !data || typeof data !== \"string\" ) {\r\n\t\treturn null;\r\n\t}\r\n\ttry {\r\n\t\tif ( window.DOMParser ) { // Standard\r\n\t\t\ttmp = new DOMParser();\r\n\t\t\txml = tmp.parseFromString( data, \"text/xml\" );\r\n\t\t} else { // IE\r\n\t\t\txml = new ActiveXObject( \"Microsoft.XMLDOM\" );\r\n\t\t\txml.async = \"false\";\r\n\t\t\txml.loadXML( data );\r\n\t\t}\r\n\t} catch( e ) {\r\n\t\txml = undefined;\r\n\t}\r\n\tif ( !xml || !xml.documentElement || xml.getElementsByTagName( \"parsererror\" ).length ) {\r\n\t\tjQuery.error( \"Invalid XML: \" + data );\r\n\t}\r\n\treturn xml;\r\n};\r\n\r\n\r\nvar\r\n\t// Document location\r\n\tajaxLocParts,\r\n\tajaxLocation,\r\n\r\n\trhash = /#.*$/,\r\n\trts = /([?&])_=[^&]*/,\r\n\trheaders = /^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/mg, // IE leaves an \\r character at EOL\r\n\t// #7653, #8125, #8152: local protocol detection\r\n\trlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,\r\n\trnoContent = /^(?:GET|HEAD)$/,\r\n\trprotocol = /^\\/\\//,\r\n\trurl = /^([\\w.+-]+:)(?:\\/\\/(?:[^\\/?#]*@|)([^\\/?#:]*)(?::(\\d+)|)|)/,\r\n\r\n\t/* Prefilters\r\n\t * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)\r\n\t * 2) These are called:\r\n\t *    - BEFORE asking for a transport\r\n\t *    - AFTER param serialization (s.data is a string if s.processData is true)\r\n\t * 3) key is the dataType\r\n\t * 4) the catchall symbol \"*\" can be used\r\n\t * 5) execution will start with transport dataType and THEN continue down to \"*\" if needed\r\n\t */\r\n\tprefilters = {},\r\n\r\n\t/* Transports bindings\r\n\t * 1) key is the dataType\r\n\t * 2) the catchall symbol \"*\" can be used\r\n\t * 3) selection will start with transport dataType and THEN go to \"*\" if needed\r\n\t */\r\n\ttransports = {},\r\n\r\n\t// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression\r\n\tallTypes = \"*/\".concat(\"*\");\r\n\r\n// #8138, IE may throw an exception when accessing\r\n// a field from window.location if document.domain has been set\r\ntry {\r\n\tajaxLocation = location.href;\r\n} catch( e ) {\r\n\t// Use the href attribute of an A element\r\n\t// since IE will modify it given document.location\r\n\tajaxLocation = document.createElement( \"a\" );\r\n\tajaxLocation.href = \"\";\r\n\tajaxLocation = ajaxLocation.href;\r\n}\r\n\r\n// Segment location into parts\r\najaxLocParts = rurl.exec( ajaxLocation.toLowerCase() ) || [];\r\n\r\n// Base \"constructor\" for jQuery.ajaxPrefilter and jQuery.ajaxTransport\r\nfunction addToPrefiltersOrTransports( structure ) {\r\n\r\n\t// dataTypeExpression is optional and defaults to \"*\"\r\n\treturn function( dataTypeExpression, func ) {\r\n\r\n\t\tif ( typeof dataTypeExpression !== \"string\" ) {\r\n\t\t\tfunc = dataTypeExpression;\r\n\t\t\tdataTypeExpression = \"*\";\r\n\t\t}\r\n\r\n\t\tvar dataType,\r\n\t\t\ti = 0,\r\n\t\t\tdataTypes = dataTypeExpression.toLowerCase().match( rnotwhite ) || [];\r\n\r\n\t\tif ( jQuery.isFunction( func ) ) {\r\n\t\t\t// For each dataType in the dataTypeExpression\r\n\t\t\twhile ( (dataType = dataTypes[i++]) ) {\r\n\t\t\t\t// Prepend if requested\r\n\t\t\t\tif ( dataType.charAt( 0 ) === \"+\" ) {\r\n\t\t\t\t\tdataType = dataType.slice( 1 ) || \"*\";\r\n\t\t\t\t\t(structure[ dataType ] = structure[ dataType ] || []).unshift( func );\r\n\r\n\t\t\t\t// Otherwise append\r\n\t\t\t\t} else {\r\n\t\t\t\t\t(structure[ dataType ] = structure[ dataType ] || []).push( func );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\n// Base inspection function for prefilters and transports\r\nfunction inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {\r\n\r\n\tvar inspected = {},\r\n\t\tseekingTransport = ( structure === transports );\r\n\r\n\tfunction inspect( dataType ) {\r\n\t\tvar selected;\r\n\t\tinspected[ dataType ] = true;\r\n\t\tjQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {\r\n\t\t\tvar dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );\r\n\t\t\tif ( typeof dataTypeOrTransport === \"string\" && !seekingTransport && !inspected[ dataTypeOrTransport ] ) {\r\n\t\t\t\toptions.dataTypes.unshift( dataTypeOrTransport );\r\n\t\t\t\tinspect( dataTypeOrTransport );\r\n\t\t\t\treturn false;\r\n\t\t\t} else if ( seekingTransport ) {\r\n\t\t\t\treturn !( selected = dataTypeOrTransport );\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn selected;\r\n\t}\r\n\r\n\treturn inspect( options.dataTypes[ 0 ] ) || !inspected[ \"*\" ] && inspect( \"*\" );\r\n}\r\n\r\n// A special extend for ajax options\r\n// that takes \"flat\" options (not to be deep extended)\r\n// Fixes #9887\r\nfunction ajaxExtend( target, src ) {\r\n\tvar deep, key,\r\n\t\tflatOptions = jQuery.ajaxSettings.flatOptions || {};\r\n\r\n\tfor ( key in src ) {\r\n\t\tif ( src[ key ] !== undefined ) {\r\n\t\t\t( flatOptions[ key ] ? target : ( deep || (deep = {}) ) )[ key ] = src[ key ];\r\n\t\t}\r\n\t}\r\n\tif ( deep ) {\r\n\t\tjQuery.extend( true, target, deep );\r\n\t}\r\n\r\n\treturn target;\r\n}\r\n\r\n/* Handles responses to an ajax request:\r\n * - finds the right dataType (mediates between content-type and expected dataType)\r\n * - returns the corresponding response\r\n */\r\nfunction ajaxHandleResponses( s, jqXHR, responses ) {\r\n\tvar firstDataType, ct, finalDataType, type,\r\n\t\tcontents = s.contents,\r\n\t\tdataTypes = s.dataTypes;\r\n\r\n\t// Remove auto dataType and get content-type in the process\r\n\twhile ( dataTypes[ 0 ] === \"*\" ) {\r\n\t\tdataTypes.shift();\r\n\t\tif ( ct === undefined ) {\r\n\t\t\tct = s.mimeType || jqXHR.getResponseHeader(\"Content-Type\");\r\n\t\t}\r\n\t}\r\n\r\n\t// Check if we're dealing with a known content-type\r\n\tif ( ct ) {\r\n\t\tfor ( type in contents ) {\r\n\t\t\tif ( contents[ type ] && contents[ type ].test( ct ) ) {\r\n\t\t\t\tdataTypes.unshift( type );\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Check to see if we have a response for the expected dataType\r\n\tif ( dataTypes[ 0 ] in responses ) {\r\n\t\tfinalDataType = dataTypes[ 0 ];\r\n\t} else {\r\n\t\t// Try convertible dataTypes\r\n\t\tfor ( type in responses ) {\r\n\t\t\tif ( !dataTypes[ 0 ] || s.converters[ type + \" \" + dataTypes[0] ] ) {\r\n\t\t\t\tfinalDataType = type;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif ( !firstDataType ) {\r\n\t\t\t\tfirstDataType = type;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Or just use first one\r\n\t\tfinalDataType = finalDataType || firstDataType;\r\n\t}\r\n\r\n\t// If we found a dataType\r\n\t// We add the dataType to the list if needed\r\n\t// and return the corresponding response\r\n\tif ( finalDataType ) {\r\n\t\tif ( finalDataType !== dataTypes[ 0 ] ) {\r\n\t\t\tdataTypes.unshift( finalDataType );\r\n\t\t}\r\n\t\treturn responses[ finalDataType ];\r\n\t}\r\n}\r\n\r\n/* Chain conversions given the request and the original response\r\n * Also sets the responseXXX fields on the jqXHR instance\r\n */\r\nfunction ajaxConvert( s, response, jqXHR, isSuccess ) {\r\n\tvar conv2, current, conv, tmp, prev,\r\n\t\tconverters = {},\r\n\t\t// Work with a copy of dataTypes in case we need to modify it for conversion\r\n\t\tdataTypes = s.dataTypes.slice();\r\n\r\n\t// Create converters map with lowercased keys\r\n\tif ( dataTypes[ 1 ] ) {\r\n\t\tfor ( conv in s.converters ) {\r\n\t\t\tconverters[ conv.toLowerCase() ] = s.converters[ conv ];\r\n\t\t}\r\n\t}\r\n\r\n\tcurrent = dataTypes.shift();\r\n\r\n\t// Convert to each sequential dataType\r\n\twhile ( current ) {\r\n\r\n\t\tif ( s.responseFields[ current ] ) {\r\n\t\t\tjqXHR[ s.responseFields[ current ] ] = response;\r\n\t\t}\r\n\r\n\t\t// Apply the dataFilter if provided\r\n\t\tif ( !prev && isSuccess && s.dataFilter ) {\r\n\t\t\tresponse = s.dataFilter( response, s.dataType );\r\n\t\t}\r\n\r\n\t\tprev = current;\r\n\t\tcurrent = dataTypes.shift();\r\n\r\n\t\tif ( current ) {\r\n\r\n\t\t\t// There's only work to do if current dataType is non-auto\r\n\t\t\tif ( current === \"*\" ) {\r\n\r\n\t\t\t\tcurrent = prev;\r\n\r\n\t\t\t// Convert response if prev dataType is non-auto and differs from current\r\n\t\t\t} else if ( prev !== \"*\" && prev !== current ) {\r\n\r\n\t\t\t\t// Seek a direct converter\r\n\t\t\t\tconv = converters[ prev + \" \" + current ] || converters[ \"* \" + current ];\r\n\r\n\t\t\t\t// If none found, seek a pair\r\n\t\t\t\tif ( !conv ) {\r\n\t\t\t\t\tfor ( conv2 in converters ) {\r\n\r\n\t\t\t\t\t\t// If conv2 outputs current\r\n\t\t\t\t\t\ttmp = conv2.split( \" \" );\r\n\t\t\t\t\t\tif ( tmp[ 1 ] === current ) {\r\n\r\n\t\t\t\t\t\t\t// If prev can be converted to accepted input\r\n\t\t\t\t\t\t\tconv = converters[ prev + \" \" + tmp[ 0 ] ] ||\r\n\t\t\t\t\t\t\t\tconverters[ \"* \" + tmp[ 0 ] ];\r\n\t\t\t\t\t\t\tif ( conv ) {\r\n\t\t\t\t\t\t\t\t// Condense equivalence converters\r\n\t\t\t\t\t\t\t\tif ( conv === true ) {\r\n\t\t\t\t\t\t\t\t\tconv = converters[ conv2 ];\r\n\r\n\t\t\t\t\t\t\t\t// Otherwise, insert the intermediate dataType\r\n\t\t\t\t\t\t\t\t} else if ( converters[ conv2 ] !== true ) {\r\n\t\t\t\t\t\t\t\t\tcurrent = tmp[ 0 ];\r\n\t\t\t\t\t\t\t\t\tdataTypes.unshift( tmp[ 1 ] );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Apply converter (if not an equivalence)\r\n\t\t\t\tif ( conv !== true ) {\r\n\r\n\t\t\t\t\t// Unless errors are allowed to bubble, catch and return them\r\n\t\t\t\t\tif ( conv && s[ \"throws\" ] ) {\r\n\t\t\t\t\t\tresponse = conv( response );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tresponse = conv( response );\r\n\t\t\t\t\t\t} catch ( e ) {\r\n\t\t\t\t\t\t\treturn { state: \"parsererror\", error: conv ? e : \"No conversion from \" + prev + \" to \" + current };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn { state: \"success\", data: response };\r\n}\r\n\r\njQuery.extend({\r\n\r\n\t// Counter for holding the number of active queries\r\n\tactive: 0,\r\n\r\n\t// Last-Modified header cache for next request\r\n\tlastModified: {},\r\n\tetag: {},\r\n\r\n\tajaxSettings: {\r\n\t\turl: ajaxLocation,\r\n\t\ttype: \"GET\",\r\n\t\tisLocal: rlocalProtocol.test( ajaxLocParts[ 1 ] ),\r\n\t\tglobal: true,\r\n\t\tprocessData: true,\r\n\t\tasync: true,\r\n\t\tcontentType: \"application/x-www-form-urlencoded; charset=UTF-8\",\r\n\t\t/*\r\n\t\ttimeout: 0,\r\n\t\tdata: null,\r\n\t\tdataType: null,\r\n\t\tusername: null,\r\n\t\tpassword: null,\r\n\t\tcache: null,\r\n\t\tthrows: false,\r\n\t\ttraditional: false,\r\n\t\theaders: {},\r\n\t\t*/\r\n\r\n\t\taccepts: {\r\n\t\t\t\"*\": allTypes,\r\n\t\t\ttext: \"text/plain\",\r\n\t\t\thtml: \"text/html\",\r\n\t\t\txml: \"application/xml, text/xml\",\r\n\t\t\tjson: \"application/json, text/javascript\"\r\n\t\t},\r\n\r\n\t\tcontents: {\r\n\t\t\txml: /xml/,\r\n\t\t\thtml: /html/,\r\n\t\t\tjson: /json/\r\n\t\t},\r\n\r\n\t\tresponseFields: {\r\n\t\t\txml: \"responseXML\",\r\n\t\t\ttext: \"responseText\",\r\n\t\t\tjson: \"responseJSON\"\r\n\t\t},\r\n\r\n\t\t// Data converters\r\n\t\t// Keys separate source (or catchall \"*\") and destination types with a single space\r\n\t\tconverters: {\r\n\r\n\t\t\t// Convert anything to text\r\n\t\t\t\"* text\": String,\r\n\r\n\t\t\t// Text to html (true = no transformation)\r\n\t\t\t\"text html\": true,\r\n\r\n\t\t\t// Evaluate text as a json expression\r\n\t\t\t\"text json\": jQuery.parseJSON,\r\n\r\n\t\t\t// Parse text as xml\r\n\t\t\t\"text xml\": jQuery.parseXML\r\n\t\t},\r\n\r\n\t\t// For options that shouldn't be deep extended:\r\n\t\t// you can add your own custom options here if\r\n\t\t// and when you create one that shouldn't be\r\n\t\t// deep extended (see ajaxExtend)\r\n\t\tflatOptions: {\r\n\t\t\turl: true,\r\n\t\t\tcontext: true\r\n\t\t}\r\n\t},\r\n\r\n\t// Creates a full fledged settings object into target\r\n\t// with both ajaxSettings and settings fields.\r\n\t// If target is omitted, writes into ajaxSettings.\r\n\tajaxSetup: function( target, settings ) {\r\n\t\treturn settings ?\r\n\r\n\t\t\t// Building a settings object\r\n\t\t\tajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :\r\n\r\n\t\t\t// Extending ajaxSettings\r\n\t\t\tajaxExtend( jQuery.ajaxSettings, target );\r\n\t},\r\n\r\n\tajaxPrefilter: addToPrefiltersOrTransports( prefilters ),\r\n\tajaxTransport: addToPrefiltersOrTransports( transports ),\r\n\r\n\t// Main method\r\n\tajax: function( url, options ) {\r\n\r\n\t\t// If url is an object, simulate pre-1.5 signature\r\n\t\tif ( typeof url === \"object\" ) {\r\n\t\t\toptions = url;\r\n\t\t\turl = undefined;\r\n\t\t}\r\n\r\n\t\t// Force options to be an object\r\n\t\toptions = options || {};\r\n\r\n\t\tvar // Cross-domain detection vars\r\n\t\t\tparts,\r\n\t\t\t// Loop variable\r\n\t\t\ti,\r\n\t\t\t// URL without anti-cache param\r\n\t\t\tcacheURL,\r\n\t\t\t// Response headers as string\r\n\t\t\tresponseHeadersString,\r\n\t\t\t// timeout handle\r\n\t\t\ttimeoutTimer,\r\n\r\n\t\t\t// To know if global events are to be dispatched\r\n\t\t\tfireGlobals,\r\n\r\n\t\t\ttransport,\r\n\t\t\t// Response headers\r\n\t\t\tresponseHeaders,\r\n\t\t\t// Create the final options object\r\n\t\t\ts = jQuery.ajaxSetup( {}, options ),\r\n\t\t\t// Callbacks context\r\n\t\t\tcallbackContext = s.context || s,\r\n\t\t\t// Context for global events is callbackContext if it is a DOM node or jQuery collection\r\n\t\t\tglobalEventContext = s.context && ( callbackContext.nodeType || callbackContext.jquery ) ?\r\n\t\t\t\tjQuery( callbackContext ) :\r\n\t\t\t\tjQuery.event,\r\n\t\t\t// Deferreds\r\n\t\t\tdeferred = jQuery.Deferred(),\r\n\t\t\tcompleteDeferred = jQuery.Callbacks(\"once memory\"),\r\n\t\t\t// Status-dependent callbacks\r\n\t\t\tstatusCode = s.statusCode || {},\r\n\t\t\t// Headers (they are sent all at once)\r\n\t\t\trequestHeaders = {},\r\n\t\t\trequestHeadersNames = {},\r\n\t\t\t// The jqXHR state\r\n\t\t\tstate = 0,\r\n\t\t\t// Default abort message\r\n\t\t\tstrAbort = \"canceled\",\r\n\t\t\t// Fake xhr\r\n\t\t\tjqXHR = {\r\n\t\t\t\treadyState: 0,\r\n\r\n\t\t\t\t// Builds headers hashtable if needed\r\n\t\t\t\tgetResponseHeader: function( key ) {\r\n\t\t\t\t\tvar match;\r\n\t\t\t\t\tif ( state === 2 ) {\r\n\t\t\t\t\t\tif ( !responseHeaders ) {\r\n\t\t\t\t\t\t\tresponseHeaders = {};\r\n\t\t\t\t\t\t\twhile ( (match = rheaders.exec( responseHeadersString )) ) {\r\n\t\t\t\t\t\t\t\tresponseHeaders[ match[1].toLowerCase() ] = match[ 2 ];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmatch = responseHeaders[ key.toLowerCase() ];\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn match == null ? null : match;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Raw string\r\n\t\t\t\tgetAllResponseHeaders: function() {\r\n\t\t\t\t\treturn state === 2 ? responseHeadersString : null;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Caches the header\r\n\t\t\t\tsetRequestHeader: function( name, value ) {\r\n\t\t\t\t\tvar lname = name.toLowerCase();\r\n\t\t\t\t\tif ( !state ) {\r\n\t\t\t\t\t\tname = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;\r\n\t\t\t\t\t\trequestHeaders[ name ] = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Overrides response content-type header\r\n\t\t\t\toverrideMimeType: function( type ) {\r\n\t\t\t\t\tif ( !state ) {\r\n\t\t\t\t\t\ts.mimeType = type;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Status-dependent callbacks\r\n\t\t\t\tstatusCode: function( map ) {\r\n\t\t\t\t\tvar code;\r\n\t\t\t\t\tif ( map ) {\r\n\t\t\t\t\t\tif ( state < 2 ) {\r\n\t\t\t\t\t\t\tfor ( code in map ) {\r\n\t\t\t\t\t\t\t\t// Lazy-add the new callback in a way that preserves old ones\r\n\t\t\t\t\t\t\t\tstatusCode[ code ] = [ statusCode[ code ], map[ code ] ];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Execute the appropriate callbacks\r\n\t\t\t\t\t\t\tjqXHR.always( map[ jqXHR.status ] );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Cancel the request\r\n\t\t\t\tabort: function( statusText ) {\r\n\t\t\t\t\tvar finalText = statusText || strAbort;\r\n\t\t\t\t\tif ( transport ) {\r\n\t\t\t\t\t\ttransport.abort( finalText );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdone( 0, finalText );\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t// Attach deferreds\r\n\t\tdeferred.promise( jqXHR ).complete = completeDeferred.add;\r\n\t\tjqXHR.success = jqXHR.done;\r\n\t\tjqXHR.error = jqXHR.fail;\r\n\r\n\t\t// Remove hash character (#7531: and string promotion)\r\n\t\t// Add protocol if not provided (#5866: IE7 issue with protocol-less urls)\r\n\t\t// Handle falsy url in the settings object (#10093: consistency with old signature)\r\n\t\t// We also use the url parameter if available\r\n\t\ts.url = ( ( url || s.url || ajaxLocation ) + \"\" ).replace( rhash, \"\" ).replace( rprotocol, ajaxLocParts[ 1 ] + \"//\" );\r\n\r\n\t\t// Alias method option to type as per ticket #12004\r\n\t\ts.type = options.method || options.type || s.method || s.type;\r\n\r\n\t\t// Extract dataTypes list\r\n\t\ts.dataTypes = jQuery.trim( s.dataType || \"*\" ).toLowerCase().match( rnotwhite ) || [ \"\" ];\r\n\r\n\t\t// A cross-domain request is in order when we have a protocol:host:port mismatch\r\n\t\tif ( s.crossDomain == null ) {\r\n\t\t\tparts = rurl.exec( s.url.toLowerCase() );\r\n\t\t\ts.crossDomain = !!( parts &&\r\n\t\t\t\t( parts[ 1 ] !== ajaxLocParts[ 1 ] || parts[ 2 ] !== ajaxLocParts[ 2 ] ||\r\n\t\t\t\t\t( parts[ 3 ] || ( parts[ 1 ] === \"http:\" ? \"80\" : \"443\" ) ) !==\r\n\t\t\t\t\t\t( ajaxLocParts[ 3 ] || ( ajaxLocParts[ 1 ] === \"http:\" ? \"80\" : \"443\" ) ) )\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Convert data if not already a string\r\n\t\tif ( s.data && s.processData && typeof s.data !== \"string\" ) {\r\n\t\t\ts.data = jQuery.param( s.data, s.traditional );\r\n\t\t}\r\n\r\n\t\t// Apply prefilters\r\n\t\tinspectPrefiltersOrTransports( prefilters, s, options, jqXHR );\r\n\r\n\t\t// If request was aborted inside a prefilter, stop there\r\n\t\tif ( state === 2 ) {\r\n\t\t\treturn jqXHR;\r\n\t\t}\r\n\r\n\t\t// We can fire global events as of now if asked to\r\n\t\tfireGlobals = s.global;\r\n\r\n\t\t// Watch for a new set of requests\r\n\t\tif ( fireGlobals && jQuery.active++ === 0 ) {\r\n\t\t\tjQuery.event.trigger(\"ajaxStart\");\r\n\t\t}\r\n\r\n\t\t// Uppercase the type\r\n\t\ts.type = s.type.toUpperCase();\r\n\r\n\t\t// Determine if request has content\r\n\t\ts.hasContent = !rnoContent.test( s.type );\r\n\r\n\t\t// Save the URL in case we're toying with the If-Modified-Since\r\n\t\t// and/or If-None-Match header later on\r\n\t\tcacheURL = s.url;\r\n\r\n\t\t// More options handling for requests with no content\r\n\t\tif ( !s.hasContent ) {\r\n\r\n\t\t\t// If data is available, append data to url\r\n\t\t\tif ( s.data ) {\r\n\t\t\t\tcacheURL = ( s.url += ( rquery.test( cacheURL ) ? \"&\" : \"?\" ) + s.data );\r\n\t\t\t\t// #9682: remove data so that it's not used in an eventual retry\r\n\t\t\t\tdelete s.data;\r\n\t\t\t}\r\n\r\n\t\t\t// Add anti-cache in url if needed\r\n\t\t\tif ( s.cache === false ) {\r\n\t\t\t\ts.url = rts.test( cacheURL ) ?\r\n\r\n\t\t\t\t\t// If there is already a '_' parameter, set its value\r\n\t\t\t\t\tcacheURL.replace( rts, \"$1_=\" + nonce++ ) :\r\n\r\n\t\t\t\t\t// Otherwise add one to the end\r\n\t\t\t\t\tcacheURL + ( rquery.test( cacheURL ) ? \"&\" : \"?\" ) + \"_=\" + nonce++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\r\n\t\tif ( s.ifModified ) {\r\n\t\t\tif ( jQuery.lastModified[ cacheURL ] ) {\r\n\t\t\t\tjqXHR.setRequestHeader( \"If-Modified-Since\", jQuery.lastModified[ cacheURL ] );\r\n\t\t\t}\r\n\t\t\tif ( jQuery.etag[ cacheURL ] ) {\r\n\t\t\t\tjqXHR.setRequestHeader( \"If-None-Match\", jQuery.etag[ cacheURL ] );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Set the correct header, if data is being sent\r\n\t\tif ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {\r\n\t\t\tjqXHR.setRequestHeader( \"Content-Type\", s.contentType );\r\n\t\t}\r\n\r\n\t\t// Set the Accepts header for the server, depending on the dataType\r\n\t\tjqXHR.setRequestHeader(\r\n\t\t\t\"Accept\",\r\n\t\t\ts.dataTypes[ 0 ] && s.accepts[ s.dataTypes[0] ] ?\r\n\t\t\t\ts.accepts[ s.dataTypes[0] ] + ( s.dataTypes[ 0 ] !== \"*\" ? \", \" + allTypes + \"; q=0.01\" : \"\" ) :\r\n\t\t\t\ts.accepts[ \"*\" ]\r\n\t\t);\r\n\r\n\t\t// Check for headers option\r\n\t\tfor ( i in s.headers ) {\r\n\t\t\tjqXHR.setRequestHeader( i, s.headers[ i ] );\r\n\t\t}\r\n\r\n\t\t// Allow custom headers/mimetypes and early abort\r\n\t\tif ( s.beforeSend && ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {\r\n\t\t\t// Abort if not done already and return\r\n\t\t\treturn jqXHR.abort();\r\n\t\t}\r\n\r\n\t\t// aborting is no longer a cancellation\r\n\t\tstrAbort = \"abort\";\r\n\r\n\t\t// Install callbacks on deferreds\r\n\t\tfor ( i in { success: 1, error: 1, complete: 1 } ) {\r\n\t\t\tjqXHR[ i ]( s[ i ] );\r\n\t\t}\r\n\r\n\t\t// Get transport\r\n\t\ttransport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );\r\n\r\n\t\t// If no transport, we auto-abort\r\n\t\tif ( !transport ) {\r\n\t\t\tdone( -1, \"No Transport\" );\r\n\t\t} else {\r\n\t\t\tjqXHR.readyState = 1;\r\n\r\n\t\t\t// Send global event\r\n\t\t\tif ( fireGlobals ) {\r\n\t\t\t\tglobalEventContext.trigger( \"ajaxSend\", [ jqXHR, s ] );\r\n\t\t\t}\r\n\t\t\t// Timeout\r\n\t\t\tif ( s.async && s.timeout > 0 ) {\r\n\t\t\t\ttimeoutTimer = setTimeout(function() {\r\n\t\t\t\t\tjqXHR.abort(\"timeout\");\r\n\t\t\t\t}, s.timeout );\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tstate = 1;\r\n\t\t\t\ttransport.send( requestHeaders, done );\r\n\t\t\t} catch ( e ) {\r\n\t\t\t\t// Propagate exception as error if not done\r\n\t\t\t\tif ( state < 2 ) {\r\n\t\t\t\t\tdone( -1, e );\r\n\t\t\t\t// Simply rethrow otherwise\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow e;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Callback for when everything is done\r\n\t\tfunction done( status, nativeStatusText, responses, headers ) {\r\n\t\t\tvar isSuccess, success, error, response, modified,\r\n\t\t\t\tstatusText = nativeStatusText;\r\n\r\n\t\t\t// Called once\r\n\t\t\tif ( state === 2 ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// State is \"done\" now\r\n\t\t\tstate = 2;\r\n\r\n\t\t\t// Clear timeout if it exists\r\n\t\t\tif ( timeoutTimer ) {\r\n\t\t\t\tclearTimeout( timeoutTimer );\r\n\t\t\t}\r\n\r\n\t\t\t// Dereference transport for early garbage collection\r\n\t\t\t// (no matter how long the jqXHR object will be used)\r\n\t\t\ttransport = undefined;\r\n\r\n\t\t\t// Cache response headers\r\n\t\t\tresponseHeadersString = headers || \"\";\r\n\r\n\t\t\t// Set readyState\r\n\t\t\tjqXHR.readyState = status > 0 ? 4 : 0;\r\n\r\n\t\t\t// Determine if successful\r\n\t\t\tisSuccess = status >= 200 && status < 300 || status === 304;\r\n\r\n\t\t\t// Get response data\r\n\t\t\tif ( responses ) {\r\n\t\t\t\tresponse = ajaxHandleResponses( s, jqXHR, responses );\r\n\t\t\t}\r\n\r\n\t\t\t// Convert no matter what (that way responseXXX fields are always set)\r\n\t\t\tresponse = ajaxConvert( s, response, jqXHR, isSuccess );\r\n\r\n\t\t\t// If successful, handle type chaining\r\n\t\t\tif ( isSuccess ) {\r\n\r\n\t\t\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\r\n\t\t\t\tif ( s.ifModified ) {\r\n\t\t\t\t\tmodified = jqXHR.getResponseHeader(\"Last-Modified\");\r\n\t\t\t\t\tif ( modified ) {\r\n\t\t\t\t\t\tjQuery.lastModified[ cacheURL ] = modified;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmodified = jqXHR.getResponseHeader(\"etag\");\r\n\t\t\t\t\tif ( modified ) {\r\n\t\t\t\t\t\tjQuery.etag[ cacheURL ] = modified;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// if no content\r\n\t\t\t\tif ( status === 204 || s.type === \"HEAD\" ) {\r\n\t\t\t\t\tstatusText = \"nocontent\";\r\n\r\n\t\t\t\t// if not modified\r\n\t\t\t\t} else if ( status === 304 ) {\r\n\t\t\t\t\tstatusText = \"notmodified\";\r\n\r\n\t\t\t\t// If we have data, let's convert it\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstatusText = response.state;\r\n\t\t\t\t\tsuccess = response.data;\r\n\t\t\t\t\terror = response.error;\r\n\t\t\t\t\tisSuccess = !error;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// We extract error from statusText\r\n\t\t\t\t// then normalize statusText and status for non-aborts\r\n\t\t\t\terror = statusText;\r\n\t\t\t\tif ( status || !statusText ) {\r\n\t\t\t\t\tstatusText = \"error\";\r\n\t\t\t\t\tif ( status < 0 ) {\r\n\t\t\t\t\t\tstatus = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Set data for the fake xhr object\r\n\t\t\tjqXHR.status = status;\r\n\t\t\tjqXHR.statusText = ( nativeStatusText || statusText ) + \"\";\r\n\r\n\t\t\t// Success/Error\r\n\t\t\tif ( isSuccess ) {\r\n\t\t\t\tdeferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );\r\n\t\t\t} else {\r\n\t\t\t\tdeferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );\r\n\t\t\t}\r\n\r\n\t\t\t// Status-dependent callbacks\r\n\t\t\tjqXHR.statusCode( statusCode );\r\n\t\t\tstatusCode = undefined;\r\n\r\n\t\t\tif ( fireGlobals ) {\r\n\t\t\t\tglobalEventContext.trigger( isSuccess ? \"ajaxSuccess\" : \"ajaxError\",\r\n\t\t\t\t\t[ jqXHR, s, isSuccess ? success : error ] );\r\n\t\t\t}\r\n\r\n\t\t\t// Complete\r\n\t\t\tcompleteDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );\r\n\r\n\t\t\tif ( fireGlobals ) {\r\n\t\t\t\tglobalEventContext.trigger( \"ajaxComplete\", [ jqXHR, s ] );\r\n\t\t\t\t// Handle the global AJAX counter\r\n\t\t\t\tif ( !( --jQuery.active ) ) {\r\n\t\t\t\t\tjQuery.event.trigger(\"ajaxStop\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn jqXHR;\r\n\t},\r\n\r\n\tgetJSON: function( url, data, callback ) {\r\n\t\treturn jQuery.get( url, data, callback, \"json\" );\r\n\t},\r\n\r\n\tgetScript: function( url, callback ) {\r\n\t\treturn jQuery.get( url, undefined, callback, \"script\" );\r\n\t}\r\n});\r\n\r\njQuery.each( [ \"get\", \"post\" ], function( i, method ) {\r\n\tjQuery[ method ] = function( url, data, callback, type ) {\r\n\t\t// shift arguments if data argument was omitted\r\n\t\tif ( jQuery.isFunction( data ) ) {\r\n\t\t\ttype = type || callback;\r\n\t\t\tcallback = data;\r\n\t\t\tdata = undefined;\r\n\t\t}\r\n\r\n\t\treturn jQuery.ajax({\r\n\t\t\turl: url,\r\n\t\t\ttype: method,\r\n\t\t\tdataType: type,\r\n\t\t\tdata: data,\r\n\t\t\tsuccess: callback\r\n\t\t});\r\n\t};\r\n});\r\n\r\n// Attach a bunch of functions for handling common AJAX events\r\njQuery.each( [ \"ajaxStart\", \"ajaxStop\", \"ajaxComplete\", \"ajaxError\", \"ajaxSuccess\", \"ajaxSend\" ], function( i, type ) {\r\n\tjQuery.fn[ type ] = function( fn ) {\r\n\t\treturn this.on( type, fn );\r\n\t};\r\n});\r\n\r\n\r\njQuery._evalUrl = function( url ) {\r\n\treturn jQuery.ajax({\r\n\t\turl: url,\r\n\t\ttype: \"GET\",\r\n\t\tdataType: \"script\",\r\n\t\tasync: false,\r\n\t\tglobal: false,\r\n\t\t\"throws\": true\r\n\t});\r\n};\r\n\r\n\r\njQuery.fn.extend({\r\n\twrapAll: function( html ) {\r\n\t\tif ( jQuery.isFunction( html ) ) {\r\n\t\t\treturn this.each(function(i) {\r\n\t\t\t\tjQuery(this).wrapAll( html.call(this, i) );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif ( this[0] ) {\r\n\t\t\t// The elements to wrap the target around\r\n\t\t\tvar wrap = jQuery( html, this[0].ownerDocument ).eq(0).clone(true);\r\n\r\n\t\t\tif ( this[0].parentNode ) {\r\n\t\t\t\twrap.insertBefore( this[0] );\r\n\t\t\t}\r\n\r\n\t\t\twrap.map(function() {\r\n\t\t\t\tvar elem = this;\r\n\r\n\t\t\t\twhile ( elem.firstChild && elem.firstChild.nodeType === 1 ) {\r\n\t\t\t\t\telem = elem.firstChild;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn elem;\r\n\t\t\t}).append( this );\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\twrapInner: function( html ) {\r\n\t\tif ( jQuery.isFunction( html ) ) {\r\n\t\t\treturn this.each(function(i) {\r\n\t\t\t\tjQuery(this).wrapInner( html.call(this, i) );\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this.each(function() {\r\n\t\t\tvar self = jQuery( this ),\r\n\t\t\t\tcontents = self.contents();\r\n\r\n\t\t\tif ( contents.length ) {\r\n\t\t\t\tcontents.wrapAll( html );\r\n\r\n\t\t\t} else {\r\n\t\t\t\tself.append( html );\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\twrap: function( html ) {\r\n\t\tvar isFunction = jQuery.isFunction( html );\r\n\r\n\t\treturn this.each(function(i) {\r\n\t\t\tjQuery( this ).wrapAll( isFunction ? html.call(this, i) : html );\r\n\t\t});\r\n\t},\r\n\r\n\tunwrap: function() {\r\n\t\treturn this.parent().each(function() {\r\n\t\t\tif ( !jQuery.nodeName( this, \"body\" ) ) {\r\n\t\t\t\tjQuery( this ).replaceWith( this.childNodes );\r\n\t\t\t}\r\n\t\t}).end();\r\n\t}\r\n});\r\n\r\n\r\njQuery.expr.filters.hidden = function( elem ) {\r\n\t// Support: Opera <= 12.12\r\n\t// Opera reports offsetWidths and offsetHeights less than zero on some elements\r\n\treturn elem.offsetWidth <= 0 && elem.offsetHeight <= 0 ||\r\n\t\t(!support.reliableHiddenOffsets() &&\r\n\t\t\t((elem.style && elem.style.display) || jQuery.css( elem, \"display\" )) === \"none\");\r\n};\r\n\r\njQuery.expr.filters.visible = function( elem ) {\r\n\treturn !jQuery.expr.filters.hidden( elem );\r\n};\r\n\r\n\r\n\r\n\r\nvar r20 = /%20/g,\r\n\trbracket = /\\[\\]$/,\r\n\trCRLF = /\\r?\\n/g,\r\n\trsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,\r\n\trsubmittable = /^(?:input|select|textarea|keygen)/i;\r\n\r\nfunction buildParams( prefix, obj, traditional, add ) {\r\n\tvar name;\r\n\r\n\tif ( jQuery.isArray( obj ) ) {\r\n\t\t// Serialize array item.\r\n\t\tjQuery.each( obj, function( i, v ) {\r\n\t\t\tif ( traditional || rbracket.test( prefix ) ) {\r\n\t\t\t\t// Treat each array item as a scalar.\r\n\t\t\t\tadd( prefix, v );\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// Item is non-scalar (array or object), encode its numeric index.\r\n\t\t\t\tbuildParams( prefix + \"[\" + ( typeof v === \"object\" ? i : \"\" ) + \"]\", v, traditional, add );\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t} else if ( !traditional && jQuery.type( obj ) === \"object\" ) {\r\n\t\t// Serialize object item.\r\n\t\tfor ( name in obj ) {\r\n\t\t\tbuildParams( prefix + \"[\" + name + \"]\", obj[ name ], traditional, add );\r\n\t\t}\r\n\r\n\t} else {\r\n\t\t// Serialize scalar item.\r\n\t\tadd( prefix, obj );\r\n\t}\r\n}\r\n\r\n// Serialize an array of form elements or a set of\r\n// key/values into a query string\r\njQuery.param = function( a, traditional ) {\r\n\tvar prefix,\r\n\t\ts = [],\r\n\t\tadd = function( key, value ) {\r\n\t\t\t// If value is a function, invoke it and return its value\r\n\t\t\tvalue = jQuery.isFunction( value ) ? value() : ( value == null ? \"\" : value );\r\n\t\t\ts[ s.length ] = encodeURIComponent( key ) + \"=\" + encodeURIComponent( value );\r\n\t\t};\r\n\r\n\t// Set traditional to true for jQuery <= 1.3.2 behavior.\r\n\tif ( traditional === undefined ) {\r\n\t\ttraditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;\r\n\t}\r\n\r\n\t// If an array was passed in, assume that it is an array of form elements.\r\n\tif ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {\r\n\t\t// Serialize the form elements\r\n\t\tjQuery.each( a, function() {\r\n\t\t\tadd( this.name, this.value );\r\n\t\t});\r\n\r\n\t} else {\r\n\t\t// If traditional, encode the \"old\" way (the way 1.3.2 or older\r\n\t\t// did it), otherwise encode params recursively.\r\n\t\tfor ( prefix in a ) {\r\n\t\t\tbuildParams( prefix, a[ prefix ], traditional, add );\r\n\t\t}\r\n\t}\r\n\r\n\t// Return the resulting serialization\r\n\treturn s.join( \"&\" ).replace( r20, \"+\" );\r\n};\r\n\r\njQuery.fn.extend({\r\n\tserialize: function() {\r\n\t\treturn jQuery.param( this.serializeArray() );\r\n\t},\r\n\tserializeArray: function() {\r\n\t\treturn this.map(function() {\r\n\t\t\t// Can add propHook for \"elements\" to filter or add form elements\r\n\t\t\tvar elements = jQuery.prop( this, \"elements\" );\r\n\t\t\treturn elements ? jQuery.makeArray( elements ) : this;\r\n\t\t})\r\n\t\t.filter(function() {\r\n\t\t\tvar type = this.type;\r\n\t\t\t// Use .is(\":disabled\") so that fieldset[disabled] works\r\n\t\t\treturn this.name && !jQuery( this ).is( \":disabled\" ) &&\r\n\t\t\t\trsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&\r\n\t\t\t\t( this.checked || !rcheckableType.test( type ) );\r\n\t\t})\r\n\t\t.map(function( i, elem ) {\r\n\t\t\tvar val = jQuery( this ).val();\r\n\r\n\t\t\treturn val == null ?\r\n\t\t\t\tnull :\r\n\t\t\t\tjQuery.isArray( val ) ?\r\n\t\t\t\t\tjQuery.map( val, function( val ) {\r\n\t\t\t\t\t\treturn { name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\r\n\t\t\t\t\t}) :\r\n\t\t\t\t\t{ name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\r\n\t\t}).get();\r\n\t}\r\n});\r\n\r\n\r\n// Create the request object\r\n// (This is still attached to ajaxSettings for backward compatibility)\r\njQuery.ajaxSettings.xhr = window.ActiveXObject !== undefined ?\r\n\t// Support: IE6+\r\n\tfunction() {\r\n\r\n\t\t// XHR cannot access local files, always use ActiveX for that case\r\n\t\treturn !this.isLocal &&\r\n\r\n\t\t\t// Support: IE7-8\r\n\t\t\t// oldIE XHR does not support non-RFC2616 methods (#13240)\r\n\t\t\t// See http://msdn.microsoft.com/en-us/library/ie/ms536648(v=vs.85).aspx\r\n\t\t\t// and http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9\r\n\t\t\t// Although this check for six methods instead of eight\r\n\t\t\t// since IE also does not support \"trace\" and \"connect\"\r\n\t\t\t/^(get|post|head|put|delete|options)$/i.test( this.type ) &&\r\n\r\n\t\t\tcreateStandardXHR() || createActiveXHR();\r\n\t} :\r\n\t// For all other browsers, use the standard XMLHttpRequest object\r\n\tcreateStandardXHR;\r\n\r\nvar xhrId = 0,\r\n\txhrCallbacks = {},\r\n\txhrSupported = jQuery.ajaxSettings.xhr();\r\n\r\n// Support: IE<10\r\n// Open requests must be manually aborted on unload (#5280)\r\nif ( window.ActiveXObject ) {\r\n\tjQuery( window ).on( \"unload\", function() {\r\n\t\tfor ( var key in xhrCallbacks ) {\r\n\t\t\txhrCallbacks[ key ]( undefined, true );\r\n\t\t}\r\n\t});\r\n}\r\n\r\n// Determine support properties\r\nsupport.cors = !!xhrSupported && ( \"withCredentials\" in xhrSupported );\r\nxhrSupported = support.ajax = !!xhrSupported;\r\n\r\n// Create transport if the browser can provide an xhr\r\nif ( xhrSupported ) {\r\n\r\n\tjQuery.ajaxTransport(function( options ) {\r\n\t\t// Cross domain only allowed if supported through XMLHttpRequest\r\n\t\tif ( !options.crossDomain || support.cors ) {\r\n\r\n\t\t\tvar callback;\r\n\r\n\t\t\treturn {\r\n\t\t\t\tsend: function( headers, complete ) {\r\n\t\t\t\t\tvar i,\r\n\t\t\t\t\t\txhr = options.xhr(),\r\n\t\t\t\t\t\tid = ++xhrId;\r\n\r\n\t\t\t\t\t// Open the socket\r\n\t\t\t\t\txhr.open( options.type, options.url, options.async, options.username, options.password );\r\n\r\n\t\t\t\t\t// Apply custom fields if provided\r\n\t\t\t\t\tif ( options.xhrFields ) {\r\n\t\t\t\t\t\tfor ( i in options.xhrFields ) {\r\n\t\t\t\t\t\t\txhr[ i ] = options.xhrFields[ i ];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Override mime type if needed\r\n\t\t\t\t\tif ( options.mimeType && xhr.overrideMimeType ) {\r\n\t\t\t\t\t\txhr.overrideMimeType( options.mimeType );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// X-Requested-With header\r\n\t\t\t\t\t// For cross-domain requests, seeing as conditions for a preflight are\r\n\t\t\t\t\t// akin to a jigsaw puzzle, we simply never set it to be sure.\r\n\t\t\t\t\t// (it can always be set on a per-request basis or even using ajaxSetup)\r\n\t\t\t\t\t// For same-domain requests, won't change header if already provided.\r\n\t\t\t\t\tif ( !options.crossDomain && !headers[\"X-Requested-With\"] ) {\r\n\t\t\t\t\t\theaders[\"X-Requested-With\"] = \"XMLHttpRequest\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Set headers\r\n\t\t\t\t\tfor ( i in headers ) {\r\n\t\t\t\t\t\t// Support: IE<9\r\n\t\t\t\t\t\t// IE's ActiveXObject throws a 'Type Mismatch' exception when setting\r\n\t\t\t\t\t\t// request header to a null-value.\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t// To keep consistent with other XHR implementations, cast the value\r\n\t\t\t\t\t\t// to string and ignore `undefined`.\r\n\t\t\t\t\t\tif ( headers[ i ] !== undefined ) {\r\n\t\t\t\t\t\t\txhr.setRequestHeader( i, headers[ i ] + \"\" );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Do send the request\r\n\t\t\t\t\t// This may raise an exception which is actually\r\n\t\t\t\t\t// handled in jQuery.ajax (so no try/catch here)\r\n\t\t\t\t\txhr.send( ( options.hasContent && options.data ) || null );\r\n\r\n\t\t\t\t\t// Listener\r\n\t\t\t\t\tcallback = function( _, isAbort ) {\r\n\t\t\t\t\t\tvar status, statusText, responses;\r\n\r\n\t\t\t\t\t\t// Was never called and is aborted or complete\r\n\t\t\t\t\t\tif ( callback && ( isAbort || xhr.readyState === 4 ) ) {\r\n\t\t\t\t\t\t\t// Clean up\r\n\t\t\t\t\t\t\tdelete xhrCallbacks[ id ];\r\n\t\t\t\t\t\t\tcallback = undefined;\r\n\t\t\t\t\t\t\txhr.onreadystatechange = jQuery.noop;\r\n\r\n\t\t\t\t\t\t\t// Abort manually if needed\r\n\t\t\t\t\t\t\tif ( isAbort ) {\r\n\t\t\t\t\t\t\t\tif ( xhr.readyState !== 4 ) {\r\n\t\t\t\t\t\t\t\t\txhr.abort();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tresponses = {};\r\n\t\t\t\t\t\t\t\tstatus = xhr.status;\r\n\r\n\t\t\t\t\t\t\t\t// Support: IE<10\r\n\t\t\t\t\t\t\t\t// Accessing binary-data responseText throws an exception\r\n\t\t\t\t\t\t\t\t// (#11426)\r\n\t\t\t\t\t\t\t\tif ( typeof xhr.responseText === \"string\" ) {\r\n\t\t\t\t\t\t\t\t\tresponses.text = xhr.responseText;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// Firefox throws an exception when accessing\r\n\t\t\t\t\t\t\t\t// statusText for faulty cross-domain requests\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tstatusText = xhr.statusText;\r\n\t\t\t\t\t\t\t\t} catch( e ) {\r\n\t\t\t\t\t\t\t\t\t// We normalize with Webkit giving an empty statusText\r\n\t\t\t\t\t\t\t\t\tstatusText = \"\";\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// Filter status for non standard behaviors\r\n\r\n\t\t\t\t\t\t\t\t// If the request is local and we have data: assume a success\r\n\t\t\t\t\t\t\t\t// (success with no data won't get notified, that's the best we\r\n\t\t\t\t\t\t\t\t// can do given current implementations)\r\n\t\t\t\t\t\t\t\tif ( !status && options.isLocal && !options.crossDomain ) {\r\n\t\t\t\t\t\t\t\t\tstatus = responses.text ? 200 : 404;\r\n\t\t\t\t\t\t\t\t// IE - #1450: sometimes returns 1223 when it should be 204\r\n\t\t\t\t\t\t\t\t} else if ( status === 1223 ) {\r\n\t\t\t\t\t\t\t\t\tstatus = 204;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Call complete if needed\r\n\t\t\t\t\t\tif ( responses ) {\r\n\t\t\t\t\t\t\tcomplete( status, statusText, responses, xhr.getAllResponseHeaders() );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif ( !options.async ) {\r\n\t\t\t\t\t\t// if we're in sync mode we fire the callback\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t} else if ( xhr.readyState === 4 ) {\r\n\t\t\t\t\t\t// (IE6 & IE7) if it's in cache and has been\r\n\t\t\t\t\t\t// retrieved directly we need to fire the callback\r\n\t\t\t\t\t\tsetTimeout( callback );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Add to the list of active xhr callbacks\r\n\t\t\t\t\t\txhr.onreadystatechange = xhrCallbacks[ id ] = callback;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\tabort: function() {\r\n\t\t\t\t\tif ( callback ) {\r\n\t\t\t\t\t\tcallback( undefined, true );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t});\r\n}\r\n\r\n// Functions to create xhrs\r\nfunction createStandardXHR() {\r\n\ttry {\r\n\t\treturn new window.XMLHttpRequest();\r\n\t} catch( e ) {}\r\n}\r\n\r\nfunction createActiveXHR() {\r\n\ttry {\r\n\t\treturn new window.ActiveXObject( \"Microsoft.XMLHTTP\" );\r\n\t} catch( e ) {}\r\n}\r\n\r\n\r\n\r\n\r\n// Install script dataType\r\njQuery.ajaxSetup({\r\n\taccepts: {\r\n\t\tscript: \"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"\r\n\t},\r\n\tcontents: {\r\n\t\tscript: /(?:java|ecma)script/\r\n\t},\r\n\tconverters: {\r\n\t\t\"text script\": function( text ) {\r\n\t\t\tjQuery.globalEval( text );\r\n\t\t\treturn text;\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// Handle cache's special case and global\r\njQuery.ajaxPrefilter( \"script\", function( s ) {\r\n\tif ( s.cache === undefined ) {\r\n\t\ts.cache = false;\r\n\t}\r\n\tif ( s.crossDomain ) {\r\n\t\ts.type = \"GET\";\r\n\t\ts.global = false;\r\n\t}\r\n});\r\n\r\n// Bind script tag hack transport\r\njQuery.ajaxTransport( \"script\", function(s) {\r\n\r\n\t// This transport only deals with cross domain requests\r\n\tif ( s.crossDomain ) {\r\n\r\n\t\tvar script,\r\n\t\t\thead = document.head || jQuery(\"head\")[0] || document.documentElement;\r\n\r\n\t\treturn {\r\n\r\n\t\t\tsend: function( _, callback ) {\r\n\r\n\t\t\t\tscript = document.createElement(\"script\");\r\n\r\n\t\t\t\tscript.async = true;\r\n\r\n\t\t\t\tif ( s.scriptCharset ) {\r\n\t\t\t\t\tscript.charset = s.scriptCharset;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscript.src = s.url;\r\n\r\n\t\t\t\t// Attach handlers for all browsers\r\n\t\t\t\tscript.onload = script.onreadystatechange = function( _, isAbort ) {\r\n\r\n\t\t\t\t\tif ( isAbort || !script.readyState || /loaded|complete/.test( script.readyState ) ) {\r\n\r\n\t\t\t\t\t\t// Handle memory leak in IE\r\n\t\t\t\t\t\tscript.onload = script.onreadystatechange = null;\r\n\r\n\t\t\t\t\t\t// Remove the script\r\n\t\t\t\t\t\tif ( script.parentNode ) {\r\n\t\t\t\t\t\t\tscript.parentNode.removeChild( script );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Dereference the script\r\n\t\t\t\t\t\tscript = null;\r\n\r\n\t\t\t\t\t\t// Callback if not abort\r\n\t\t\t\t\t\tif ( !isAbort ) {\r\n\t\t\t\t\t\t\tcallback( 200, \"success\" );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Circumvent IE6 bugs with base elements (#2709 and #4378) by prepending\r\n\t\t\t\t// Use native DOM manipulation to avoid our domManip AJAX trickery\r\n\t\t\t\thead.insertBefore( script, head.firstChild );\r\n\t\t\t},\r\n\r\n\t\t\tabort: function() {\r\n\t\t\t\tif ( script ) {\r\n\t\t\t\t\tscript.onload( undefined, true );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n});\r\n\r\n\r\n\r\n\r\nvar oldCallbacks = [],\r\n\trjsonp = /(=)\\?(?=&|$)|\\?\\?/;\r\n\r\n// Default jsonp settings\r\njQuery.ajaxSetup({\r\n\tjsonp: \"callback\",\r\n\tjsonpCallback: function() {\r\n\t\tvar callback = oldCallbacks.pop() || ( jQuery.expando + \"_\" + ( nonce++ ) );\r\n\t\tthis[ callback ] = true;\r\n\t\treturn callback;\r\n\t}\r\n});\r\n\r\n// Detect, normalize options and install callbacks for jsonp requests\r\njQuery.ajaxPrefilter( \"json jsonp\", function( s, originalSettings, jqXHR ) {\r\n\r\n\tvar callbackName, overwritten, responseContainer,\r\n\t\tjsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?\r\n\t\t\t\"url\" :\r\n\t\t\ttypeof s.data === \"string\" && !( s.contentType || \"\" ).indexOf(\"application/x-www-form-urlencoded\") && rjsonp.test( s.data ) && \"data\"\r\n\t\t);\r\n\r\n\t// Handle iff the expected data type is \"jsonp\" or we have a parameter to set\r\n\tif ( jsonProp || s.dataTypes[ 0 ] === \"jsonp\" ) {\r\n\r\n\t\t// Get callback name, remembering preexisting value associated with it\r\n\t\tcallbackName = s.jsonpCallback = jQuery.isFunction( s.jsonpCallback ) ?\r\n\t\t\ts.jsonpCallback() :\r\n\t\t\ts.jsonpCallback;\r\n\r\n\t\t// Insert callback into url or form data\r\n\t\tif ( jsonProp ) {\r\n\t\t\ts[ jsonProp ] = s[ jsonProp ].replace( rjsonp, \"$1\" + callbackName );\r\n\t\t} else if ( s.jsonp !== false ) {\r\n\t\t\ts.url += ( rquery.test( s.url ) ? \"&\" : \"?\" ) + s.jsonp + \"=\" + callbackName;\r\n\t\t}\r\n\r\n\t\t// Use data converter to retrieve json after script execution\r\n\t\ts.converters[\"script json\"] = function() {\r\n\t\t\tif ( !responseContainer ) {\r\n\t\t\t\tjQuery.error( callbackName + \" was not called\" );\r\n\t\t\t}\r\n\t\t\treturn responseContainer[ 0 ];\r\n\t\t};\r\n\r\n\t\t// force json dataType\r\n\t\ts.dataTypes[ 0 ] = \"json\";\r\n\r\n\t\t// Install callback\r\n\t\toverwritten = window[ callbackName ];\r\n\t\twindow[ callbackName ] = function() {\r\n\t\t\tresponseContainer = arguments;\r\n\t\t};\r\n\r\n\t\t// Clean-up function (fires after converters)\r\n\t\tjqXHR.always(function() {\r\n\t\t\t// Restore preexisting value\r\n\t\t\twindow[ callbackName ] = overwritten;\r\n\r\n\t\t\t// Save back as free\r\n\t\t\tif ( s[ callbackName ] ) {\r\n\t\t\t\t// make sure that re-using the options doesn't screw things around\r\n\t\t\t\ts.jsonpCallback = originalSettings.jsonpCallback;\r\n\r\n\t\t\t\t// save the callback name for future use\r\n\t\t\t\toldCallbacks.push( callbackName );\r\n\t\t\t}\r\n\r\n\t\t\t// Call if it was a function and we have a response\r\n\t\t\tif ( responseContainer && jQuery.isFunction( overwritten ) ) {\r\n\t\t\t\toverwritten( responseContainer[ 0 ] );\r\n\t\t\t}\r\n\r\n\t\t\tresponseContainer = overwritten = undefined;\r\n\t\t});\r\n\r\n\t\t// Delegate to script\r\n\t\treturn \"script\";\r\n\t}\r\n});\r\n\r\n\r\n\r\n\r\n// data: string of html\r\n// context (optional): If specified, the fragment will be created in this context, defaults to document\r\n// keepScripts (optional): If true, will include scripts passed in the html string\r\njQuery.parseHTML = function( data, context, keepScripts ) {\r\n\tif ( !data || typeof data !== \"string\" ) {\r\n\t\treturn null;\r\n\t}\r\n\tif ( typeof context === \"boolean\" ) {\r\n\t\tkeepScripts = context;\r\n\t\tcontext = false;\r\n\t}\r\n\tcontext = context || document;\r\n\r\n\tvar parsed = rsingleTag.exec( data ),\r\n\t\tscripts = !keepScripts && [];\r\n\r\n\t// Single tag\r\n\tif ( parsed ) {\r\n\t\treturn [ context.createElement( parsed[1] ) ];\r\n\t}\r\n\r\n\tparsed = jQuery.buildFragment( [ data ], context, scripts );\r\n\r\n\tif ( scripts && scripts.length ) {\r\n\t\tjQuery( scripts ).remove();\r\n\t}\r\n\r\n\treturn jQuery.merge( [], parsed.childNodes );\r\n};\r\n\r\n\r\n// Keep a copy of the old load method\r\nvar _load = jQuery.fn.load;\r\n\r\n/**\r\n * Load a url into a page\r\n */\r\njQuery.fn.load = function( url, params, callback ) {\r\n\tif ( typeof url !== \"string\" && _load ) {\r\n\t\treturn _load.apply( this, arguments );\r\n\t}\r\n\r\n\tvar selector, response, type,\r\n\t\tself = this,\r\n\t\toff = url.indexOf(\" \");\r\n\r\n\tif ( off >= 0 ) {\r\n\t\tselector = jQuery.trim( url.slice( off, url.length ) );\r\n\t\turl = url.slice( 0, off );\r\n\t}\r\n\r\n\t// If it's a function\r\n\tif ( jQuery.isFunction( params ) ) {\r\n\r\n\t\t// We assume that it's the callback\r\n\t\tcallback = params;\r\n\t\tparams = undefined;\r\n\r\n\t// Otherwise, build a param string\r\n\t} else if ( params && typeof params === \"object\" ) {\r\n\t\ttype = \"POST\";\r\n\t}\r\n\r\n\t// If we have elements to modify, make the request\r\n\tif ( self.length > 0 ) {\r\n\t\tjQuery.ajax({\r\n\t\t\turl: url,\r\n\r\n\t\t\t// if \"type\" variable is undefined, then \"GET\" method will be used\r\n\t\t\ttype: type,\r\n\t\t\tdataType: \"html\",\r\n\t\t\tdata: params\r\n\t\t}).done(function( responseText ) {\r\n\r\n\t\t\t// Save response for use in complete callback\r\n\t\t\tresponse = arguments;\r\n\r\n\t\t\tself.html( selector ?\r\n\r\n\t\t\t\t// If a selector was specified, locate the right elements in a dummy div\r\n\t\t\t\t// Exclude scripts to avoid IE 'Permission Denied' errors\r\n\t\t\t\tjQuery(\"<div>\").append( jQuery.parseHTML( responseText ) ).find( selector ) :\r\n\r\n\t\t\t\t// Otherwise use the full result\r\n\t\t\t\tresponseText );\r\n\r\n\t\t}).complete( callback && function( jqXHR, status ) {\r\n\t\t\tself.each( callback, response || [ jqXHR.responseText, status, jqXHR ] );\r\n\t\t});\r\n\t}\r\n\r\n\treturn this;\r\n};\r\n\r\n\r\n\r\n\r\njQuery.expr.filters.animated = function( elem ) {\r\n\treturn jQuery.grep(jQuery.timers, function( fn ) {\r\n\t\treturn elem === fn.elem;\r\n\t}).length;\r\n};\r\n\r\n\r\n\r\n\r\n\r\nvar docElem = window.document.documentElement;\r\n\r\n/**\r\n * Gets a window from an element\r\n */\r\nfunction getWindow( elem ) {\r\n\treturn jQuery.isWindow( elem ) ?\r\n\t\telem :\r\n\t\telem.nodeType === 9 ?\r\n\t\t\telem.defaultView || elem.parentWindow :\r\n\t\t\tfalse;\r\n}\r\n\r\njQuery.offset = {\r\n\tsetOffset: function( elem, options, i ) {\r\n\t\tvar curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,\r\n\t\t\tposition = jQuery.css( elem, \"position\" ),\r\n\t\t\tcurElem = jQuery( elem ),\r\n\t\t\tprops = {};\r\n\r\n\t\t// set position first, in-case top/left are set even on static elem\r\n\t\tif ( position === \"static\" ) {\r\n\t\t\telem.style.position = \"relative\";\r\n\t\t}\r\n\r\n\t\tcurOffset = curElem.offset();\r\n\t\tcurCSSTop = jQuery.css( elem, \"top\" );\r\n\t\tcurCSSLeft = jQuery.css( elem, \"left\" );\r\n\t\tcalculatePosition = ( position === \"absolute\" || position === \"fixed\" ) &&\r\n\t\t\tjQuery.inArray(\"auto\", [ curCSSTop, curCSSLeft ] ) > -1;\r\n\r\n\t\t// need to be able to calculate position if either top or left is auto and position is either absolute or fixed\r\n\t\tif ( calculatePosition ) {\r\n\t\t\tcurPosition = curElem.position();\r\n\t\t\tcurTop = curPosition.top;\r\n\t\t\tcurLeft = curPosition.left;\r\n\t\t} else {\r\n\t\t\tcurTop = parseFloat( curCSSTop ) || 0;\r\n\t\t\tcurLeft = parseFloat( curCSSLeft ) || 0;\r\n\t\t}\r\n\r\n\t\tif ( jQuery.isFunction( options ) ) {\r\n\t\t\toptions = options.call( elem, i, curOffset );\r\n\t\t}\r\n\r\n\t\tif ( options.top != null ) {\r\n\t\t\tprops.top = ( options.top - curOffset.top ) + curTop;\r\n\t\t}\r\n\t\tif ( options.left != null ) {\r\n\t\t\tprops.left = ( options.left - curOffset.left ) + curLeft;\r\n\t\t}\r\n\r\n\t\tif ( \"using\" in options ) {\r\n\t\t\toptions.using.call( elem, props );\r\n\t\t} else {\r\n\t\t\tcurElem.css( props );\r\n\t\t}\r\n\t}\r\n};\r\n\r\njQuery.fn.extend({\r\n\toffset: function( options ) {\r\n\t\tif ( arguments.length ) {\r\n\t\t\treturn options === undefined ?\r\n\t\t\t\tthis :\r\n\t\t\t\tthis.each(function( i ) {\r\n\t\t\t\t\tjQuery.offset.setOffset( this, options, i );\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tvar docElem, win,\r\n\t\t\tbox = { top: 0, left: 0 },\r\n\t\t\telem = this[ 0 ],\r\n\t\t\tdoc = elem && elem.ownerDocument;\r\n\r\n\t\tif ( !doc ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdocElem = doc.documentElement;\r\n\r\n\t\t// Make sure it's not a disconnected DOM node\r\n\t\tif ( !jQuery.contains( docElem, elem ) ) {\r\n\t\t\treturn box;\r\n\t\t}\r\n\r\n\t\t// If we don't have gBCR, just use 0,0 rather than error\r\n\t\t// BlackBerry 5, iOS 3 (original iPhone)\r\n\t\tif ( typeof elem.getBoundingClientRect !== strundefined ) {\r\n\t\t\tbox = elem.getBoundingClientRect();\r\n\t\t}\r\n\t\twin = getWindow( doc );\r\n\t\treturn {\r\n\t\t\ttop: box.top  + ( win.pageYOffset || docElem.scrollTop )  - ( docElem.clientTop  || 0 ),\r\n\t\t\tleft: box.left + ( win.pageXOffset || docElem.scrollLeft ) - ( docElem.clientLeft || 0 )\r\n\t\t};\r\n\t},\r\n\r\n\tposition: function() {\r\n\t\tif ( !this[ 0 ] ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar offsetParent, offset,\r\n\t\t\tparentOffset = { top: 0, left: 0 },\r\n\t\t\telem = this[ 0 ];\r\n\r\n\t\t// fixed elements are offset from window (parentOffset = {top:0, left: 0}, because it is its only offset parent\r\n\t\tif ( jQuery.css( elem, \"position\" ) === \"fixed\" ) {\r\n\t\t\t// we assume that getBoundingClientRect is available when computed position is fixed\r\n\t\t\toffset = elem.getBoundingClientRect();\r\n\t\t} else {\r\n\t\t\t// Get *real* offsetParent\r\n\t\t\toffsetParent = this.offsetParent();\r\n\r\n\t\t\t// Get correct offsets\r\n\t\t\toffset = this.offset();\r\n\t\t\tif ( !jQuery.nodeName( offsetParent[ 0 ], \"html\" ) ) {\r\n\t\t\t\tparentOffset = offsetParent.offset();\r\n\t\t\t}\r\n\r\n\t\t\t// Add offsetParent borders\r\n\t\t\tparentOffset.top  += jQuery.css( offsetParent[ 0 ], \"borderTopWidth\", true );\r\n\t\t\tparentOffset.left += jQuery.css( offsetParent[ 0 ], \"borderLeftWidth\", true );\r\n\t\t}\r\n\r\n\t\t// Subtract parent offsets and element margins\r\n\t\t// note: when an element has margin: auto the offsetLeft and marginLeft\r\n\t\t// are the same in Safari causing offset.left to incorrectly be 0\r\n\t\treturn {\r\n\t\t\ttop:  offset.top  - parentOffset.top - jQuery.css( elem, \"marginTop\", true ),\r\n\t\t\tleft: offset.left - parentOffset.left - jQuery.css( elem, \"marginLeft\", true)\r\n\t\t};\r\n\t},\r\n\r\n\toffsetParent: function() {\r\n\t\treturn this.map(function() {\r\n\t\t\tvar offsetParent = this.offsetParent || docElem;\r\n\r\n\t\t\twhile ( offsetParent && ( !jQuery.nodeName( offsetParent, \"html\" ) && jQuery.css( offsetParent, \"position\" ) === \"static\" ) ) {\r\n\t\t\t\toffsetParent = offsetParent.offsetParent;\r\n\t\t\t}\r\n\t\t\treturn offsetParent || docElem;\r\n\t\t});\r\n\t}\r\n});\r\n\r\n// Create scrollLeft and scrollTop methods\r\njQuery.each( { scrollLeft: \"pageXOffset\", scrollTop: \"pageYOffset\" }, function( method, prop ) {\r\n\tvar top = /Y/.test( prop );\r\n\r\n\tjQuery.fn[ method ] = function( val ) {\r\n\t\treturn access( this, function( elem, method, val ) {\r\n\t\t\tvar win = getWindow( elem );\r\n\r\n\t\t\tif ( val === undefined ) {\r\n\t\t\t\treturn win ? (prop in win) ? win[ prop ] :\r\n\t\t\t\t\twin.document.documentElement[ method ] :\r\n\t\t\t\t\telem[ method ];\r\n\t\t\t}\r\n\r\n\t\t\tif ( win ) {\r\n\t\t\t\twin.scrollTo(\r\n\t\t\t\t\t!top ? val : jQuery( win ).scrollLeft(),\r\n\t\t\t\t\ttop ? val : jQuery( win ).scrollTop()\r\n\t\t\t\t);\r\n\r\n\t\t\t} else {\r\n\t\t\t\telem[ method ] = val;\r\n\t\t\t}\r\n\t\t}, method, val, arguments.length, null );\r\n\t};\r\n});\r\n\r\n// Add the top/left cssHooks using jQuery.fn.position\r\n// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084\r\n// getComputedStyle returns percent when specified for top/left/bottom/right\r\n// rather than make the css module depend on the offset module, we just check for it here\r\njQuery.each( [ \"top\", \"left\" ], function( i, prop ) {\r\n\tjQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,\r\n\t\tfunction( elem, computed ) {\r\n\t\t\tif ( computed ) {\r\n\t\t\t\tcomputed = curCSS( elem, prop );\r\n\t\t\t\t// if curCSS returns percentage, fallback to offset\r\n\t\t\t\treturn rnumnonpx.test( computed ) ?\r\n\t\t\t\t\tjQuery( elem ).position()[ prop ] + \"px\" :\r\n\t\t\t\t\tcomputed;\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n});\r\n\r\n\r\n// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods\r\njQuery.each( { Height: \"height\", Width: \"width\" }, function( name, type ) {\r\n\tjQuery.each( { padding: \"inner\" + name, content: type, \"\": \"outer\" + name }, function( defaultExtra, funcName ) {\r\n\t\t// margin is only for outerHeight, outerWidth\r\n\t\tjQuery.fn[ funcName ] = function( margin, value ) {\r\n\t\t\tvar chainable = arguments.length && ( defaultExtra || typeof margin !== \"boolean\" ),\r\n\t\t\t\textra = defaultExtra || ( margin === true || value === true ? \"margin\" : \"border\" );\r\n\r\n\t\t\treturn access( this, function( elem, type, value ) {\r\n\t\t\t\tvar doc;\r\n\r\n\t\t\t\tif ( jQuery.isWindow( elem ) ) {\r\n\t\t\t\t\t// As of 5/8/2012 this will yield incorrect results for Mobile Safari, but there\r\n\t\t\t\t\t// isn't a whole lot we can do. See pull request at this URL for discussion:\r\n\t\t\t\t\t// https://github.com/jquery/jquery/pull/764\r\n\t\t\t\t\treturn elem.document.documentElement[ \"client\" + name ];\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Get document width or height\r\n\t\t\t\tif ( elem.nodeType === 9 ) {\r\n\t\t\t\t\tdoc = elem.documentElement;\r\n\r\n\t\t\t\t\t// Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height], whichever is greatest\r\n\t\t\t\t\t// unfortunately, this causes bug #3838 in IE6/8 only, but there is currently no good, small way to fix it.\r\n\t\t\t\t\treturn Math.max(\r\n\t\t\t\t\t\telem.body[ \"scroll\" + name ], doc[ \"scroll\" + name ],\r\n\t\t\t\t\t\telem.body[ \"offset\" + name ], doc[ \"offset\" + name ],\r\n\t\t\t\t\t\tdoc[ \"client\" + name ]\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn value === undefined ?\r\n\t\t\t\t\t// Get width or height on the element, requesting but not forcing parseFloat\r\n\t\t\t\t\tjQuery.css( elem, type, extra ) :\r\n\r\n\t\t\t\t\t// Set width or height on the element\r\n\t\t\t\t\tjQuery.style( elem, type, value, extra );\r\n\t\t\t}, type, chainable ? margin : undefined, chainable, null );\r\n\t\t};\r\n\t});\r\n});\r\n\r\n\r\n// The number of elements contained in the matched element set\r\njQuery.fn.size = function() {\r\n\treturn this.length;\r\n};\r\n\r\njQuery.fn.andSelf = jQuery.fn.addBack;\r\n\r\n\r\n\r\n\r\n// Register as a named AMD module, since jQuery can be concatenated with other\r\n// files that may use define, but not via a proper concatenation script that\r\n// understands anonymous AMD modules. A named AMD is safest and most robust\r\n// way to register. Lowercase jquery is used because AMD module names are\r\n// derived from file names, and jQuery is normally delivered in a lowercase\r\n// file name. Do this after creating the global so that if an AMD module wants\r\n// to call noConflict to hide this version of jQuery, it will work.\r\n\r\n// Note that for maximum portability, libraries that are not jQuery should\r\n// declare themselves as anonymous modules, and avoid setting a global if an\r\n// AMD loader is present. jQuery is a special case. For more information, see\r\n// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon\r\n\r\nif ( typeof define === \"function\" && define.amd ) {\r\n\tdefine( \"jquery\", [], function() {\r\n\t\treturn jQuery;\r\n\t});\r\n}\r\n\r\n\r\n\r\n\r\nvar\r\n\t// Map over jQuery in case of overwrite\r\n\t_jQuery = window.jQuery,\r\n\r\n\t// Map over the $ in case of overwrite\r\n\t_$ = window.$;\r\n\r\njQuery.noConflict = function( deep ) {\r\n\tif ( window.$ === jQuery ) {\r\n\t\twindow.$ = _$;\r\n\t}\r\n\r\n\tif ( deep && window.jQuery === jQuery ) {\r\n\t\twindow.jQuery = _jQuery;\r\n\t}\r\n\r\n\treturn jQuery;\r\n};\r\n\r\n// Expose jQuery and $ identifiers, even in\r\n// AMD (#7102#comment:10, https://github.com/jquery/jquery/pull/557)\r\n// and CommonJS for browser emulators (#13566)\r\nif ( typeof noGlobal === strundefined ) {\r\n\twindow.jQuery = window.$ = jQuery;\r\n}\r\n\r\n\r\n\r\n\r\nreturn jQuery;\r\n\r\n}));\r\n","/*!\r\n * jQuery Migrate - v1.2.1 - 2013-05-08\r\n * https://github.com/jquery/jquery-migrate\r\n * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors; Licensed MIT\r\n */\r\n;\r\n(function( jQuery, window, undefined ) {\r\n// See http://bugs.jquery.com/ticket/13335\r\n// \"use strict\";\r\n\r\n\r\nvar warnedAbout = {};\r\n\r\n// List of warnings already given; public read only\r\njQuery.migrateWarnings = [];\r\n\r\n// Set to true to prevent console output; migrateWarnings still maintained\r\n// jQuery.migrateMute = false;\r\n\r\n// Show a message on the console so devs know we're active\r\nif ( !jQuery.migrateMute && window.console && window.console.log ) {\r\n\twindow.console.log(\"JQMIGRATE: Logging is active\");\r\n}\r\n\r\n// Set to false to disable traces that appear with warnings\r\nif ( jQuery.migrateTrace === undefined ) {\r\n\tjQuery.migrateTrace = true;\r\n}\r\n\r\n// Forget any warnings we've already given; public\r\njQuery.migrateReset = function() {\r\n\twarnedAbout = {};\r\n\tjQuery.migrateWarnings.length = 0;\r\n};\r\n\r\nfunction migrateWarn( msg) {\r\n\tvar console = window.console;\r\n\tif ( !warnedAbout[ msg ] ) {\r\n\t\twarnedAbout[ msg ] = true;\r\n\t\tjQuery.migrateWarnings.push( msg );\r\n\t\tif ( console && console.warn && !jQuery.migrateMute ) {\r\n\t\t\tconsole.warn( \"JQMIGRATE: \" + msg );\r\n\t\t\tif ( jQuery.migrateTrace && console.trace ) {\r\n\t\t\t\tconsole.trace();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction migrateWarnProp( obj, prop, value, msg ) {\r\n\tif ( Object.defineProperty ) {\r\n\t\t// On ES5 browsers (non-oldIE), warn if the code tries to get prop;\r\n\t\t// allow property to be overwritten in case some other plugin wants it\r\n\t\ttry {\r\n\t\t\tObject.defineProperty( obj, prop, {\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tget: function() {\r\n\t\t\t\t\tmigrateWarn( msg );\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t},\r\n\t\t\t\tset: function( newValue ) {\r\n\t\t\t\t\tmigrateWarn( msg );\r\n\t\t\t\t\tvalue = newValue;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t} catch( err ) {\r\n\t\t\t// IE8 is a dope about Object.defineProperty, can't warn there\r\n\t\t}\r\n\t}\r\n\r\n\t// Non-ES5 (or broken) browser; just set the property\r\n\tjQuery._definePropertyBroken = true;\r\n\tobj[ prop ] = value;\r\n}\r\n\r\nif ( document.compatMode === \"BackCompat\" ) {\r\n\t// jQuery has never supported or tested Quirks Mode\r\n\tmigrateWarn( \"jQuery is not compatible with Quirks Mode\" );\r\n}\r\n\r\n\r\nvar attrFn = jQuery( \"<input/>\", { size: 1 } ).attr(\"size\") && jQuery.attrFn,\r\n\toldAttr = jQuery.attr,\r\n\tvalueAttrGet = jQuery.attrHooks.value && jQuery.attrHooks.value.get ||\r\n\t\tfunction() { return null; },\r\n\tvalueAttrSet = jQuery.attrHooks.value && jQuery.attrHooks.value.set ||\r\n\t\tfunction() { return undefined; },\r\n\trnoType = /^(?:input|button)$/i,\r\n\trnoAttrNodeType = /^[238]$/,\r\n\trboolean = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,\r\n\truseDefault = /^(?:checked|selected)$/i;\r\n\r\n// jQuery.attrFn\r\nmigrateWarnProp( jQuery, \"attrFn\", attrFn || {}, \"jQuery.attrFn is deprecated\" );\r\n\r\njQuery.attr = function( elem, name, value, pass ) {\r\n\tvar lowerName = name.toLowerCase(),\r\n\t\tnType = elem && elem.nodeType;\r\n\r\n\tif ( pass ) {\r\n\t\t// Since pass is used internally, we only warn for new jQuery\r\n\t\t// versions where there isn't a pass arg in the formal params\r\n\t\tif ( oldAttr.length < 4 ) {\r\n\t\t\tmigrateWarn(\"jQuery.fn.attr( props, pass ) is deprecated\");\r\n\t\t}\r\n\t\tif ( elem && !rnoAttrNodeType.test( nType ) &&\r\n\t\t\t(attrFn ? name in attrFn : jQuery.isFunction(jQuery.fn[name])) ) {\r\n\t\t\treturn jQuery( elem )[ name ]( value );\r\n\t\t}\r\n\t}\r\n\r\n\t// Warn if user tries to set `type`, since it breaks on IE 6/7/8; by checking\r\n\t// for disconnected elements we don't warn on $( \"<button>\", { type: \"button\" } ).\r\n\tif ( name === \"type\" && value !== undefined && rnoType.test( elem.nodeName ) && elem.parentNode ) {\r\n\t\tmigrateWarn(\"Can't change the 'type' of an input or button in IE 6/7/8\");\r\n\t}\r\n\r\n\t// Restore boolHook for boolean property/attribute synchronization\r\n\tif ( !jQuery.attrHooks[ lowerName ] && rboolean.test( lowerName ) ) {\r\n\t\tjQuery.attrHooks[ lowerName ] = {\r\n\t\t\tget: function( elem, name ) {\r\n\t\t\t\t// Align boolean attributes with corresponding properties\r\n\t\t\t\t// Fall back to attribute presence where some booleans are not supported\r\n\t\t\t\tvar attrNode,\r\n\t\t\t\t\tproperty = jQuery.prop( elem, name );\r\n\t\t\t\treturn property === true || typeof property !== \"boolean\" &&\r\n\t\t\t\t\t( attrNode = elem.getAttributeNode(name) ) && attrNode.nodeValue !== false ?\r\n\r\n\t\t\t\t\tname.toLowerCase() :\r\n\t\t\t\t\tundefined;\r\n\t\t\t},\r\n\t\t\tset: function( elem, value, name ) {\r\n\t\t\t\tvar propName;\r\n\t\t\t\tif ( value === false ) {\r\n\t\t\t\t\t// Remove boolean attributes when set to false\r\n\t\t\t\t\tjQuery.removeAttr( elem, name );\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// value is true since we know at this point it's type boolean and not false\r\n\t\t\t\t\t// Set boolean attributes to the same name and set the DOM property\r\n\t\t\t\t\tpropName = jQuery.propFix[ name ] || name;\r\n\t\t\t\t\tif ( propName in elem ) {\r\n\t\t\t\t\t\t// Only set the IDL specifically if it already exists on the element\r\n\t\t\t\t\t\telem[ propName ] = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telem.setAttribute( name, name.toLowerCase() );\r\n\t\t\t\t}\r\n\t\t\t\treturn name;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Warn only for attributes that can remain distinct from their properties post-1.9\r\n\t\tif ( ruseDefault.test( lowerName ) ) {\r\n\t\t\tmigrateWarn( \"jQuery.fn.attr('\" + lowerName + \"') may use property instead of attribute\" );\r\n\t\t}\r\n\t}\r\n\r\n\treturn oldAttr.call( jQuery, elem, name, value );\r\n};\r\n\r\n// attrHooks: value\r\njQuery.attrHooks.value = {\r\n\tget: function( elem, name ) {\r\n\t\tvar nodeName = ( elem.nodeName || \"\" ).toLowerCase();\r\n\t\tif ( nodeName === \"button\" ) {\r\n\t\t\treturn valueAttrGet.apply( this, arguments );\r\n\t\t}\r\n\t\tif ( nodeName !== \"input\" && nodeName !== \"option\" ) {\r\n\t\t\tmigrateWarn(\"jQuery.fn.attr('value') no longer gets properties\");\r\n\t\t}\r\n\t\treturn name in elem ?\r\n\t\t\telem.value :\r\n\t\t\tnull;\r\n\t},\r\n\tset: function( elem, value ) {\r\n\t\tvar nodeName = ( elem.nodeName || \"\" ).toLowerCase();\r\n\t\tif ( nodeName === \"button\" ) {\r\n\t\t\treturn valueAttrSet.apply( this, arguments );\r\n\t\t}\r\n\t\tif ( nodeName !== \"input\" && nodeName !== \"option\" ) {\r\n\t\t\tmigrateWarn(\"jQuery.fn.attr('value', val) no longer sets properties\");\r\n\t\t}\r\n\t\t// Does not return so that setAttribute is also used\r\n\t\telem.value = value;\r\n\t}\r\n};\r\n\r\n\r\nvar matched, browser,\r\n\toldInit = jQuery.fn.init,\r\n\toldParseJSON = jQuery.parseJSON,\r\n\t// Note: XSS check is done below after string is trimmed\r\n\trquickExpr = /^([^<]*)(<[\\w\\W]+>)([^>]*)$/;\r\n\r\n// $(html) \"looks like html\" rule change\r\njQuery.fn.init = function( selector, context, rootjQuery ) {\r\n\tvar match;\r\n\r\n\tif ( selector && typeof selector === \"string\" && !jQuery.isPlainObject( context ) &&\r\n\t\t\t(match = rquickExpr.exec( jQuery.trim( selector ) )) && match[ 0 ] ) {\r\n\t\t// This is an HTML string according to the \"old\" rules; is it still?\r\n\t\tif ( selector.charAt( 0 ) !== \"<\" ) {\r\n\t\t\tmigrateWarn(\"$(html) HTML strings must start with '<' character\");\r\n\t\t}\r\n\t\tif ( match[ 3 ] ) {\r\n\t\t\tmigrateWarn(\"$(html) HTML text after last tag is ignored\");\r\n\t\t}\r\n\t\t// Consistently reject any HTML-like string starting with a hash (#9521)\r\n\t\t// Note that this may break jQuery 1.6.x code that otherwise would work.\r\n\t\tif ( match[ 0 ].charAt( 0 ) === \"#\" ) {\r\n\t\t\tmigrateWarn(\"HTML string cannot start with a '#' character\");\r\n\t\t\tjQuery.error(\"JQMIGRATE: Invalid selector string (XSS)\");\r\n\t\t}\r\n\t\t// Now process using loose rules; let pre-1.8 play too\r\n\t\tif ( context && context.context ) {\r\n\t\t\t// jQuery object as context; parseHTML expects a DOM object\r\n\t\t\tcontext = context.context;\r\n\t\t}\r\n\t\tif ( jQuery.parseHTML ) {\r\n\t\t\treturn oldInit.call( this, jQuery.parseHTML( match[ 2 ], context, true ),\r\n\t\t\t\t\tcontext, rootjQuery );\r\n\t\t}\r\n\t}\r\n\treturn oldInit.apply( this, arguments );\r\n};\r\njQuery.fn.init.prototype = jQuery.fn;\r\n\r\n// Let $.parseJSON(falsy_value) return null\r\njQuery.parseJSON = function( json ) {\r\n\tif ( !json && json !== null ) {\r\n\t\tmigrateWarn(\"jQuery.parseJSON requires a valid JSON string\");\r\n\t\treturn null;\r\n\t}\r\n\treturn oldParseJSON.apply( this, arguments );\r\n};\r\n\r\njQuery.uaMatch = function( ua ) {\r\n\tua = ua.toLowerCase();\r\n\r\n\tvar match = /(chrome)[ \\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t/(webkit)[ \\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t/(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t/(msie) ([\\w.]+)/.exec( ua ) ||\r\n\t\tua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec( ua ) ||\r\n\t\t[];\r\n\r\n\treturn {\r\n\t\tbrowser: match[ 1 ] || \"\",\r\n\t\tversion: match[ 2 ] || \"0\"\r\n\t};\r\n};\r\n\r\n// Don't clobber any existing jQuery.browser in case it's different\r\nif ( !jQuery.browser ) {\r\n\tmatched = jQuery.uaMatch( navigator.userAgent );\r\n\tbrowser = {};\r\n\r\n\tif ( matched.browser ) {\r\n\t\tbrowser[ matched.browser ] = true;\r\n\t\tbrowser.version = matched.version;\r\n\t}\r\n\r\n\t// Chrome is Webkit, but Webkit is also Safari.\r\n\tif ( browser.chrome ) {\r\n\t\tbrowser.webkit = true;\r\n\t} else if ( browser.webkit ) {\r\n\t\tbrowser.safari = true;\r\n\t}\r\n\r\n\tjQuery.browser = browser;\r\n}\r\n\r\n// Warn if the code tries to get jQuery.browser\r\nmigrateWarnProp( jQuery, \"browser\", jQuery.browser, \"jQuery.browser is deprecated\" );\r\n\r\njQuery.sub = function() {\r\n\tfunction jQuerySub( selector, context ) {\r\n\t\treturn new jQuerySub.fn.init( selector, context );\r\n\t}\r\n\tjQuery.extend( true, jQuerySub, this );\r\n\tjQuerySub.superclass = this;\r\n\tjQuerySub.fn = jQuerySub.prototype = this();\r\n\tjQuerySub.fn.constructor = jQuerySub;\r\n\tjQuerySub.sub = this.sub;\r\n\tjQuerySub.fn.init = function init( selector, context ) {\r\n\t\tif ( context && context instanceof jQuery && !(context instanceof jQuerySub) ) {\r\n\t\t\tcontext = jQuerySub( context );\r\n\t\t}\r\n\r\n\t\treturn jQuery.fn.init.call( this, selector, context, rootjQuerySub );\r\n\t};\r\n\tjQuerySub.fn.init.prototype = jQuerySub.fn;\r\n\tvar rootjQuerySub = jQuerySub(document);\r\n\tmigrateWarn( \"jQuery.sub() is deprecated\" );\r\n\treturn jQuerySub;\r\n};\r\n\r\n\r\n// Ensure that $.ajax gets the new parseJSON defined in core.js\r\njQuery.ajaxSetup({\r\n\tconverters: {\r\n\t\t\"text json\": jQuery.parseJSON\r\n\t}\r\n});\r\n\r\n\r\nvar oldFnData = jQuery.fn.data;\r\n\r\njQuery.fn.data = function( name ) {\r\n\tvar ret, evt,\r\n\t\telem = this[0];\r\n\r\n\t// Handles 1.7 which has this behavior and 1.8 which doesn't\r\n\tif ( elem && name === \"events\" && arguments.length === 1 ) {\r\n\t\tret = jQuery.data( elem, name );\r\n\t\tevt = jQuery._data( elem, name );\r\n\t\tif ( ( ret === undefined || ret === evt ) && evt !== undefined ) {\r\n\t\t\tmigrateWarn(\"Use of jQuery.fn.data('events') is deprecated\");\r\n\t\t\treturn evt;\r\n\t\t}\r\n\t}\r\n\treturn oldFnData.apply( this, arguments );\r\n};\r\n\r\n\r\nvar rscriptType = /\\/(java|ecma)script/i,\r\n\toldSelf = jQuery.fn.andSelf || jQuery.fn.addBack;\r\n\r\njQuery.fn.andSelf = function() {\r\n\tmigrateWarn(\"jQuery.fn.andSelf() replaced by jQuery.fn.addBack()\");\r\n\treturn oldSelf.apply( this, arguments );\r\n};\r\n\r\n// Since jQuery.clean is used internally on older versions, we only shim if it's missing\r\nif ( !jQuery.clean ) {\r\n\tjQuery.clean = function( elems, context, fragment, scripts ) {\r\n\t\t// Set context per 1.8 logic\r\n\t\tcontext = context || document;\r\n\t\tcontext = !context.nodeType && context[0] || context;\r\n\t\tcontext = context.ownerDocument || context;\r\n\r\n\t\tmigrateWarn(\"jQuery.clean() is deprecated\");\r\n\r\n\t\tvar i, elem, handleScript, jsTags,\r\n\t\t\tret = [];\r\n\r\n\t\tjQuery.merge( ret, jQuery.buildFragment( elems, context ).childNodes );\r\n\r\n\t\t// Complex logic lifted directly from jQuery 1.8\r\n\t\tif ( fragment ) {\r\n\t\t\t// Special handling of each script element\r\n\t\t\thandleScript = function( elem ) {\r\n\t\t\t\t// Check if we consider it executable\r\n\t\t\t\tif ( !elem.type || rscriptType.test( elem.type ) ) {\r\n\t\t\t\t\t// Detach the script and store it in the scripts array (if provided) or the fragment\r\n\t\t\t\t\t// Return truthy to indicate that it has been handled\r\n\t\t\t\t\treturn scripts ?\r\n\t\t\t\t\t\tscripts.push( elem.parentNode ? elem.parentNode.removeChild( elem ) : elem ) :\r\n\t\t\t\t\t\tfragment.appendChild( elem );\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( i = 0; (elem = ret[i]) != null; i++ ) {\r\n\t\t\t\t// Check if we're done after handling an executable script\r\n\t\t\t\tif ( !( jQuery.nodeName( elem, \"script\" ) && handleScript( elem ) ) ) {\r\n\t\t\t\t\t// Append to fragment and handle embedded scripts\r\n\t\t\t\t\tfragment.appendChild( elem );\r\n\t\t\t\t\tif ( typeof elem.getElementsByTagName !== \"undefined\" ) {\r\n\t\t\t\t\t\t// handleScript alters the DOM, so use jQuery.merge to ensure snapshot iteration\r\n\t\t\t\t\t\tjsTags = jQuery.grep( jQuery.merge( [], elem.getElementsByTagName(\"script\") ), handleScript );\r\n\r\n\t\t\t\t\t\t// Splice the scripts into ret after their former ancestor and advance our index beyond them\r\n\t\t\t\t\t\tret.splice.apply( ret, [i + 1, 0].concat( jsTags ) );\r\n\t\t\t\t\t\ti += jsTags.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn ret;\r\n\t};\r\n}\r\n\r\nvar eventAdd = jQuery.event.add,\r\n\teventRemove = jQuery.event.remove,\r\n\teventTrigger = jQuery.event.trigger,\r\n\toldToggle = jQuery.fn.toggle,\r\n\toldLive = jQuery.fn.live,\r\n\toldDie = jQuery.fn.die,\r\n\tajaxEvents = \"ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess\",\r\n\trajaxEvent = new RegExp( \"\\\\b(?:\" + ajaxEvents + \")\\\\b\" ),\r\n\trhoverHack = /(?:^|\\s)hover(\\.\\S+|)\\b/,\r\n\thoverHack = function( events ) {\r\n\t\tif ( typeof( events ) !== \"string\" || jQuery.event.special.hover ) {\r\n\t\t\treturn events;\r\n\t\t}\r\n\t\tif ( rhoverHack.test( events ) ) {\r\n\t\t\tmigrateWarn(\"'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'\");\r\n\t\t}\r\n\t\treturn events && events.replace( rhoverHack, \"mouseenter$1 mouseleave$1\" );\r\n\t};\r\n\r\n// Event props removed in 1.9, put them back if needed; no practical way to warn them\r\nif ( jQuery.event.props && jQuery.event.props[ 0 ] !== \"attrChange\" ) {\r\n\tjQuery.event.props.unshift( \"attrChange\", \"attrName\", \"relatedNode\", \"srcElement\" );\r\n}\r\n\r\n// Undocumented jQuery.event.handle was \"deprecated\" in jQuery 1.7\r\nif ( jQuery.event.dispatch ) {\r\n\tmigrateWarnProp( jQuery.event, \"handle\", jQuery.event.dispatch, \"jQuery.event.handle is undocumented and deprecated\" );\r\n}\r\n\r\n// Support for 'hover' pseudo-event and ajax event warnings\r\njQuery.event.add = function( elem, types, handler, data, selector ){\r\n\tif ( elem !== document && rajaxEvent.test( types ) ) {\r\n\t\tmigrateWarn( \"AJAX events should be attached to document: \" + types );\r\n\t}\r\n\teventAdd.call( this, elem, hoverHack( types || \"\" ), handler, data, selector );\r\n};\r\njQuery.event.remove = function( elem, types, handler, selector, mappedTypes ){\r\n\teventRemove.call( this, elem, hoverHack( types ) || \"\", handler, selector, mappedTypes );\r\n};\r\n\r\njQuery.fn.error = function() {\r\n\tvar args = Array.prototype.slice.call( arguments, 0);\r\n\tmigrateWarn(\"jQuery.fn.error() is deprecated\");\r\n\targs.splice( 0, 0, \"error\" );\r\n\tif ( arguments.length ) {\r\n\t\treturn this.bind.apply( this, args );\r\n\t}\r\n\t// error event should not bubble to window, although it does pre-1.7\r\n\tthis.triggerHandler.apply( this, args );\r\n\treturn this;\r\n};\r\n\r\njQuery.fn.toggle = function( fn, fn2 ) {\r\n\r\n\t// Don't mess with animation or css toggles\r\n\tif ( !jQuery.isFunction( fn ) || !jQuery.isFunction( fn2 ) ) {\r\n\t\treturn oldToggle.apply( this, arguments );\r\n\t}\r\n\tmigrateWarn(\"jQuery.fn.toggle(handler, handler...) is deprecated\");\r\n\r\n\t// Save reference to arguments for access in closure\r\n\tvar args = arguments,\r\n\t\tguid = fn.guid || jQuery.guid++,\r\n\t\ti = 0,\r\n\t\ttoggler = function( event ) {\r\n\t\t\t// Figure out which function to execute\r\n\t\t\tvar lastToggle = ( jQuery._data( this, \"lastToggle\" + fn.guid ) || 0 ) % i;\r\n\t\t\tjQuery._data( this, \"lastToggle\" + fn.guid, lastToggle + 1 );\r\n\r\n\t\t\t// Make sure that clicks stop\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\t// and execute the function\r\n\t\t\treturn args[ lastToggle ].apply( this, arguments ) || false;\r\n\t\t};\r\n\r\n\t// link all the functions, so any of them can unbind this click handler\r\n\ttoggler.guid = guid;\r\n\twhile ( i < args.length ) {\r\n\t\targs[ i++ ].guid = guid;\r\n\t}\r\n\r\n\treturn this.click( toggler );\r\n};\r\n\r\njQuery.fn.live = function( types, data, fn ) {\r\n\tmigrateWarn(\"jQuery.fn.live() is deprecated\");\r\n\tif ( oldLive ) {\r\n\t\treturn oldLive.apply( this, arguments );\r\n\t}\r\n\tjQuery( this.context ).on( types, this.selector, data, fn );\r\n\treturn this;\r\n};\r\n\r\njQuery.fn.die = function( types, fn ) {\r\n\tmigrateWarn(\"jQuery.fn.die() is deprecated\");\r\n\tif ( oldDie ) {\r\n\t\treturn oldDie.apply( this, arguments );\r\n\t}\r\n\tjQuery( this.context ).off( types, this.selector || \"**\", fn );\r\n\treturn this;\r\n};\r\n\r\n// Turn global events into document-triggered events\r\njQuery.event.trigger = function( event, data, elem, onlyHandlers  ){\r\n\tif ( !elem && !rajaxEvent.test( event ) ) {\r\n\t\tmigrateWarn( \"Global events are undocumented and deprecated\" );\r\n\t}\r\n\treturn eventTrigger.call( this,  event, data, elem || document, onlyHandlers  );\r\n};\r\njQuery.each( ajaxEvents.split(\"|\"),\r\n\tfunction( _, name ) {\r\n\t\tjQuery.event.special[ name ] = {\r\n\t\t\tsetup: function() {\r\n\t\t\t\tvar elem = this;\r\n\r\n\t\t\t\t// The document needs no shimming; must be !== for oldIE\r\n\t\t\t\tif ( elem !== document ) {\r\n\t\t\t\t\tjQuery.event.add( document, name + \".\" + jQuery.guid, function() {\r\n\t\t\t\t\t\tjQuery.event.trigger( name, null, elem, true );\r\n\t\t\t\t\t});\r\n\t\t\t\t\tjQuery._data( this, name, jQuery.guid++ );\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tteardown: function() {\r\n\t\t\t\tif ( this !== document ) {\r\n\t\t\t\t\tjQuery.event.remove( document, name + \".\" + jQuery._data( this, name ) );\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n);\r\n\r\n\r\n})( jQuery, window );","/*! jQuery UI - v1.11.1 - 2014-08-13\r\n* http://jqueryui.com\r\n* Includes: core.js, widget.js, mouse.js, position.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, draggable.js, droppable.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js, menu.js, progressbar.js, resizable.js, selectable.js, selectmenu.js, slider.js, sortable.js, spinner.js, tabs.js, tooltip.js\r\n* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */\r\n;\r\n(function(e){\"function\"==typeof define&&define.amd?define([\"jquery\"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return\"area\"===r?(n=t.parentNode,a=n.name,t.href&&a&&\"map\"===n.nodeName.toLowerCase()?(o=e(\"img[usemap='#\"+a+\"']\")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:\"a\"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return\"hidden\"===e.css(this,\"visibility\")}).length}function s(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css(\"position\"),(\"absolute\"===t||\"relative\"===t||\"fixed\"===t)&&(i=parseInt(e.css(\"zIndex\"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId=\"ui-datepicker-div\",this._inlineClass=\"ui-datepicker-inline\",this._appendClass=\"ui-datepicker-append\",this._triggerClass=\"ui-datepicker-trigger\",this._dialogClass=\"ui-datepicker-dialog\",this._disableClass=\"ui-datepicker-disabled\",this._unselectableClass=\"ui-datepicker-unselectable\",this._currentClass=\"ui-datepicker-current-day\",this._dayOverClass=\"ui-datepicker-days-cell-over\",this.regional=[],this.regional[\"\"]={closeText:\"Done\",prevText:\"Prev\",nextText:\"Next\",currentText:\"Today\",monthNames:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],monthNamesShort:[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],dayNames:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],dayNamesShort:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],dayNamesMin:[\"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\"],weekHeader:\"Wk\",dateFormat:\"mm/dd/yy\",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:\"\"},this._defaults={showOn:\"focus\",showAnim:\"fadeIn\",showOptions:{},defaultDate:null,appendText:\"\",buttonText:\"...\",buttonImage:\"\",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:\"c-10:c+10\",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:\"+10\",minDate:null,maxDate:null,duration:\"fast\",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:\"\",altFormat:\"\",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[\"\"]),this.regional.en=e.extend(!0,{},this.regional[\"\"]),this.regional[\"en-US\"]=e.extend(!0,{},this.regional.en),this.dpDiv=a(e(\"<div id='\"+this._mainDivId+\"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>\"))}function a(t){var i=\"button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a\";return t.delegate(i,\"mouseout\",function(){e(this).removeClass(\"ui-state-hover\"),-1!==this.className.indexOf(\"ui-datepicker-prev\")&&e(this).removeClass(\"ui-datepicker-prev-hover\"),-1!==this.className.indexOf(\"ui-datepicker-next\")&&e(this).removeClass(\"ui-datepicker-next-hover\")}).delegate(i,\"mouseover\",o)}function o(){e.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(e(this).parents(\".ui-datepicker-calendar\").find(\"a\").removeClass(\"ui-state-hover\"),e(this).addClass(\"ui-state-hover\"),-1!==this.className.indexOf(\"ui-datepicker-prev\")&&e(this).addClass(\"ui-datepicker-prev-hover\"),-1!==this.className.indexOf(\"ui-datepicker-next\")&&e(this).addClass(\"ui-datepicker-next-hover\"))}function r(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}function h(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger(\"change\")}}e.ui=e.ui||{},e.extend(e.ui,{version:\"1.11.1\",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css(\"position\"),s=\"absolute\"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&\"static\"===t.css(\"position\")?!1:n.test(t.css(\"overflow\")+t.css(\"overflow-y\")+t.css(\"overflow-x\"))}).eq(0);return\"fixed\"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id=\"ui-id-\"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\\d+$/.test(this.id)&&e(this).removeAttr(\"id\")})}}),e.extend(e.expr[\":\"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,\"tabindex\")))},tabbable:function(i){var s=e.attr(i,\"tabindex\"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e(\"<a>\").outerWidth(1).jquery||e.each([\"Width\",\"Height\"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,\"padding\"+this))||0,s&&(i-=parseFloat(e.css(t,\"border\"+this+\"Width\"))||0),a&&(i-=parseFloat(e.css(t,\"margin\"+this))||0)}),i}var n=\"Width\"===i?[\"Left\",\"Right\"]:[\"Top\",\"Bottom\"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn[\"inner\"+i]=function(t){return void 0===t?o[\"inner\"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+\"px\")})},e.fn[\"outer\"+i]=function(t,n){return\"number\"!=typeof t?o[\"outer\"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+\"px\")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e(\"<a>\").data(\"a-b\",\"a\").removeData(\"a-b\").data(\"a-b\")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return\"number\"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e=\"onselectstart\"in document.createElement(\"div\")?\"selectstart\":\"mousedown\";return function(){return this.bind(e+\".ui-disableSelection\",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(\".ui-disableSelection\")},zIndex:function(t){if(void 0!==t)return this.css(\"zIndex\",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css(\"position\"),(\"absolute\"===i||\"relative\"===i||\"fixed\"===i)&&(s=parseInt(n.css(\"zIndex\"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var l=0,u=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,\"events\"),s&&s.remove&&e(n).triggerHandler(\"remove\")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(\".\")[0];return t=t.split(\".\")[1],n=l+\"-\"+t,s||(s=i,i=e.Widget),e.expr[\":\"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+\".\"+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,n=u.call(arguments,1),a=0,o=n.length;o>a;a++)for(i in n[a])s=n[a][i],n[a].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(n){var a=\"string\"==typeof n,o=u.call(arguments,1),r=this;return n=!a&&o.length?e.widget.extend.apply(null,[n].concat(o)):n,a?this.each(function(){var i,a=e.data(this,s);return\"instance\"===n?(r=a,!1):a?e.isFunction(a[n])&&\"_\"!==n.charAt(0)?(i=a[n].apply(a,o),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):e.error(\"no such method '\"+n+\"' for \"+t+\" widget instance\"):e.error(\"cannot call methods on \"+t+\" prior to initialization; \"+\"attempted to call method '\"+n+\"'\")}):this.each(function(){var t=e.data(this,s);t?(t.option(n||{}),t._init&&t._init()):e.data(this,s,new i(n,this))}),r}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:\"widget\",widgetEventPrefix:\"\",defaultElement:\"<div>\",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=l++,this.eventNamespace=\".\"+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger(\"create\",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr(\"aria-disabled\").removeClass(this.widgetFullName+\"-disabled \"+\"ui-state-disabled\"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass(\"ui-state-hover\"),this.focusable.removeClass(\"ui-state-focus\")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if(\"string\"==typeof t)if(o={},s=t.split(\".\"),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,\"disabled\"===e&&(this.widget().toggleClass(this.widgetFullName+\"-disabled\",!!t),t&&(this.hoverable.removeClass(\"ui-state-hover\"),this.focusable.removeClass(\"ui-state-focus\"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;\"boolean\"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass(\"ui-state-disabled\")?(\"string\"==typeof o?a[o]:o).apply(a,arguments):void 0}\"string\"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\\w:-]*)\\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(e,t){t=(t||\"\").split(\" \").join(this.eventNamespace+\" \")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return(\"string\"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass(\"ui-state-hover\")},mouseleave:function(t){e(t.currentTarget).removeClass(\"ui-state-hover\")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass(\"ui-state-focus\")},focusout:function(t){e(t.currentTarget).removeClass(\"ui-state-focus\")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:\"fadeIn\",hide:\"fadeOut\"},function(t,i){e.Widget.prototype[\"_\"+t]=function(s,n,a){\"string\"==typeof n&&(n={effect:n});var o,r=n?n===!0||\"number\"==typeof n?i:n.effect||i:t;n=n||{},\"number\"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var d=!1;e(document).mouseup(function(){d=!1}),e.widget(\"ui.mouse\",{version:\"1.11.1\",options:{cancel:\"input,textarea,button,select,option\",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind(\"mousedown.\"+this.widgetName,function(e){return t._mouseDown(e)}).bind(\"click.\"+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+\".preventClickEvent\")?(e.removeData(i.target,t.widgetName+\".preventClickEvent\"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind(\".\"+this.widgetName),this._mouseMoveDelegate&&this.document.unbind(\"mousemove.\"+this.widgetName,this._mouseMoveDelegate).unbind(\"mouseup.\"+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n=\"string\"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+\".preventClickEvent\")&&e.removeData(t.target,this.widgetName+\".preventClickEvent\"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind(\"mousemove.\"+this.widgetName,this._mouseMoveDelegate).bind(\"mouseup.\"+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return this.document.unbind(\"mousemove.\"+this.widgetName,this._mouseMoveDelegate).unbind(\"mouseup.\"+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+\".preventClickEvent\",!0),this._mouseStop(t)),d=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,d=/[\\+\\-]\\d+(\\.[\\d]+)?%?/,c=/^\\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==n)return n;var t,i,s=e(\"<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>\"),a=s.children()[0];return e(\"body\").append(s),t=a.offsetWidth,s.css(\"overflow\",\"scroll\"),i=a.offsetWidth,t===i&&(i=s[0].clientWidth),s.remove(),n=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?\"\":t.element.css(\"overflow-x\"),s=t.isWindow||t.isDocument?\"\":t.element.css(\"overflow-y\"),n=\"scroll\"===i||\"auto\"===i&&t.width<t.element[0].scrollWidth,a=\"scroll\"===s||\"auto\"===s&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},e.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=e.extend({},n);var p,m,g,v,y,b,_=e(n.of),x=e.position.getWithinInfo(n.within),w=e.position.getScrollInfo(x),k=(n.collision||\"flip\").split(\" \"),T={};return b=s(_),_[0].preventDefault&&(n.at=\"left top\"),m=b.width,g=b.height,v=b.offset,y=e.extend({},v),e.each([\"my\",\"at\"],function(){var e,t,i=(n[this]||\"\").split(\" \");1===i.length&&(i=l.test(i[0])?i.concat([\"center\"]):u.test(i[0])?[\"center\"].concat(i):[\"center\",\"center\"]),i[0]=l.test(i[0])?i[0]:\"center\",i[1]=u.test(i[1])?i[1]:\"center\",e=d.exec(i[0]),t=d.exec(i[1]),T[this]=[e?e[0]:0,t?t[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),\"right\"===n.at[0]?y.left+=m:\"center\"===n.at[0]&&(y.left+=m/2),\"bottom\"===n.at[1]?y.top+=g:\"center\"===n.at[1]&&(y.top+=g/2),p=t(T.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var s,l,u=e(this),d=u.outerWidth(),c=u.outerHeight(),f=i(this,\"marginLeft\"),b=i(this,\"marginTop\"),D=d+f+i(this,\"marginRight\")+w.width,S=c+b+i(this,\"marginBottom\")+w.height,M=e.extend({},y),N=t(T.my,u.outerWidth(),u.outerHeight());\"right\"===n.my[0]?M.left-=d:\"center\"===n.my[0]&&(M.left-=d/2),\"bottom\"===n.my[1]?M.top-=c:\"center\"===n.my[1]&&(M.top-=c/2),M.left+=N[0],M.top+=N[1],a||(M.left=h(M.left),M.top=h(M.top)),s={marginLeft:f,marginTop:b},e.each([\"left\",\"top\"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](M,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:c,collisionPosition:s,collisionWidth:D,collisionHeight:S,offset:[p[0]+N[0],p[1]+N[1]],my:n.my,at:n.at,within:x,elem:u})}),n.using&&(l=function(e){var t=v.left-M.left,i=t+m-d,s=v.top-M.top,a=s+g-c,h={target:{element:_,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:M.left,top:M.top,width:d,height:c},horizontal:0>i?\"left\":t>0?\"right\":\"center\",vertical:0>a?\"top\":s>0?\"bottom\":\"middle\"};d>m&&m>r(t+i)&&(h.horizontal=\"center\"),c>g&&g>r(s+a)&&(h.vertical=\"middle\"),h.important=o(r(t),r(i))>o(r(s),r(a))?\"horizontal\":\"vertical\",n.using.call(this,e,h)}),u.offset(e.extend(M,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=e.left-t.collisionPosition.marginLeft,h=n-r,l=r+t.collisionWidth-a-n;t.collisionWidth>a?h>0&&0>=l?(i=e.left+h+t.collisionWidth-a-n,e.left+=h-i):e.left=l>0&&0>=h?n:h>l?n+a-t.collisionWidth:n:h>0?e.left+=h:l>0?e.left-=l:e.left=o(e.left-r,e.left)},top:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,h=n-r,l=r+t.collisionHeight-a-n;t.collisionHeight>a?h>0&&0>=l?(i=e.top+h+t.collisionHeight-a-n,e.top+=h-i):e.top=l>0&&0>=h?n:h>l?n+a-t.collisionHeight:n:h>0?e.top+=h:l>0?e.top-=l:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,d=l+t.collisionWidth-o-h,c=\"left\"===t.my[0]?-t.elemWidth:\"right\"===t.my[0]?t.elemWidth:0,p=\"left\"===t.at[0]?t.targetWidth:\"right\"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+c+p+f+t.collisionWidth-o-a,(0>i||r(u)>i)&&(e.left+=c+p+f)):d>0&&(s=e.left-t.collisionPosition.marginLeft+c+p+f-h,(s>0||d>r(s))&&(e.left+=c+p+f))},top:function(e,t){var i,s,n=t.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,d=l+t.collisionHeight-o-h,c=\"top\"===t.my[1],p=c?-t.elemHeight:\"bottom\"===t.my[1]?t.elemHeight:0,f=\"top\"===t.at[1]?t.targetHeight:\"bottom\"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-o-a,e.top+p+f+m>u&&(0>s||r(u)>s)&&(e.top+=p+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,e.top+p+f+m>d&&(i>0||d>r(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,n,o,r=document.getElementsByTagName(\"body\")[0],h=document.createElement(\"div\");t=document.createElement(r?\"div\":\"body\"),s={visibility:\"hidden\",width:0,height:0,border:0,margin:0,background:\"none\"},r&&e.extend(s,{position:\"absolute\",left:\"-1000px\",top:\"-1000px\"});for(o in s)t.style[o]=s[o];t.appendChild(h),i=r||document.documentElement,i.insertBefore(t,i.firstChild),h.style.cssText=\"position: absolute; left: 10.7432222px;\",n=e(h).offset().left,a=n>10&&11>n,t.innerHTML=\"\",i.removeChild(t)}()}(),e.ui.position,e.widget(\"ui.accordion\",{version:\"1.11.1\",options:{active:0,animate:{},collapsible:!1,event:\"click\",header:\"> li > :first-child,> :not(li):even\",heightStyle:\"auto\",icons:{activeHeader:\"ui-icon-triangle-1-s\",header:\"ui-icon-triangle-1-e\"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:\"hide\",borderBottomWidth:\"hide\",paddingTop:\"hide\",paddingBottom:\"hide\",height:\"hide\"},showProps:{borderTopWidth:\"show\",borderBottomWidth:\"show\",paddingTop:\"show\",paddingBottom:\"show\",height:\"show\"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass(\"ui-accordion ui-widget ui-helper-reset\").attr(\"role\",\"tablist\"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e(\"<span>\").addClass(\"ui-accordion-header-icon ui-icon \"+t.header).prependTo(this.headers),this.active.children(\".ui-accordion-header-icon\").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass(\"ui-accordion-icons\"))},_destroyIcons:function(){this.headers.removeClass(\"ui-accordion-icons\").children(\".ui-accordion-header-icon\").remove()},_destroy:function(){var e;this.element.removeClass(\"ui-accordion ui-widget ui-helper-reset\").removeAttr(\"role\"),this.headers.removeClass(\"ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top\").removeAttr(\"role\").removeAttr(\"aria-expanded\").removeAttr(\"aria-selected\").removeAttr(\"aria-controls\").removeAttr(\"tabIndex\").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass(\"ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled\").css(\"display\",\"\").removeAttr(\"role\").removeAttr(\"aria-hidden\").removeAttr(\"aria-labelledby\").removeUniqueId(),\"content\"!==this.options.heightStyle&&e.css(\"height\",\"\")},_setOption:function(e,t){return\"active\"===e?(this._activate(t),void 0):(\"event\"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),\"collapsible\"!==e||t||this.options.active!==!1||this._activate(0),\"icons\"===e&&(this._destroyIcons(),t&&this._createIcons()),\"disabled\"===e&&(this.element.toggleClass(\"ui-state-disabled\",!!t).attr(\"aria-disabled\",t),this.headers.add(this.headers.next()).toggleClass(\"ui-state-disabled\",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,s=this.headers.length,n=this.headers.index(t.target),a=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(e(t.target).attr(\"tabIndex\",-1),e(a).attr(\"tabIndex\",0),a.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(\".ui-state-disabled\").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass(\"ui-accordion-header ui-state-default ui-corner-all\"),this.headers.next().addClass(\"ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom\").filter(\":not(.ui-accordion-content-active)\").hide()},_refresh:function(){var t,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active).addClass(\"ui-accordion-header-active ui-state-active ui-corner-top\").removeClass(\"ui-corner-all\"),this.active.next().addClass(\"ui-accordion-content-active\").show(),this.headers.attr(\"role\",\"tab\").each(function(){var t=e(this),i=t.uniqueId().attr(\"id\"),s=t.next(),n=s.uniqueId().attr(\"id\");t.attr(\"aria-controls\",n),s.attr(\"aria-labelledby\",i)}).next().attr(\"role\",\"tabpanel\"),this.headers.not(this.active).attr({\"aria-selected\":\"false\",\"aria-expanded\":\"false\",tabIndex:-1}).next().attr({\"aria-hidden\":\"true\"}).hide(),this.active.length?this.active.attr({\"aria-selected\":\"true\",\"aria-expanded\":\"true\",tabIndex:0}).next().attr({\"aria-hidden\":\"false\"}):this.headers.eq(0).attr(\"tabIndex\",0),this._createIcons(),this._setupEvents(i.event),\"fill\"===s?(t=n.height(),this.element.siblings(\":visible\").each(function(){var i=e(this),s=i.css(\"position\");\"absolute\"!==s&&\"fixed\"!==s&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css(\"overflow\",\"auto\")):\"auto\"===s&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css(\"height\",\"\").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return\"number\"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:\"_keydown\"};t&&e.each(t.split(\" \"),function(e,t){i[t]=\"_eventHandler\"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:\"_panelKeyDown\"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?e():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?e():n,newPanel:r};t.preventDefault(),a&&!i.collapsible||this._trigger(\"beforeActivate\",t,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?e():n,this._toggle(l),s.removeClass(\"ui-accordion-header-active ui-state-active\"),i.icons&&s.children(\".ui-accordion-header-icon\").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass(\"ui-corner-all\").addClass(\"ui-accordion-header-active ui-state-active ui-corner-top\"),i.icons&&n.children(\".ui-accordion-header-icon\").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass(\"ui-accordion-content-active\")))},_toggle:function(t){var i=t.newPanel,s=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,t):(s.hide(),i.show(),this._toggleComplete(t)),s.attr({\"aria-hidden\":\"true\"}),s.prev().attr(\"aria-selected\",\"false\"),i.length&&s.length?s.prev().attr({tabIndex:-1,\"aria-expanded\":\"false\"}):i.length&&this.headers.filter(function(){return 0===e(this).attr(\"tabIndex\")}).attr(\"tabIndex\",-1),i.attr(\"aria-hidden\",\"false\").prev().attr({\"aria-selected\":\"true\",tabIndex:0,\"aria-expanded\":\"true\"})},_animate:function(e,t,i){var s,n,a,o=this,r=0,h=e.length&&(!t.length||e.index()<t.index()),l=this.options.animate||{},u=h&&l.down||l,d=function(){o._toggleComplete(i)};return\"number\"==typeof u&&(a=u),\"string\"==typeof u&&(n=u),n=n||u.easing||l.easing,a=a||u.duration||l.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(this.hideProps,{duration:a,easing:n,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:a,easing:n,complete:d,step:function(e,i){i.now=Math.round(e),\"height\"!==i.prop?r+=i.now:\"content\"!==o.options.heightStyle&&(i.now=Math.round(s-t.outerHeight()-r),r=0)}}),void 0):t.animate(this.hideProps,a,n,d):e.animate(this.showProps,a,n,d)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass(\"ui-accordion-content-active\").prev().removeClass(\"ui-corner-top\").addClass(\"ui-corner-all\"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger(\"activate\",null,e)}}),e.widget(\"ui.menu\",{version:\"1.11.1\",defaultElement:\"<ul>\",delay:300,options:{icons:{submenu:\"ui-icon-carat-1-e\"},items:\"> *\",menus:\"ul\",position:{my:\"left-1 top\",at:\"right top\"},role:\"menu\",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass(\"ui-menu ui-widget ui-widget-content\").toggleClass(\"ui-menu-icons\",!!this.element.find(\".ui-icon\").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass(\"ui-state-disabled\").attr(\"aria-disabled\",\"true\"),this._on({\"mousedown .ui-menu-item\":function(e){e.preventDefault()},\"click .ui-menu-item\":function(t){var i=e(t.target);!this.mouseHandled&&i.not(\".ui-state-disabled\").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(\".ui-menu\").length?this.expand(t):!this.element.is(\":focus\")&&e(this.document[0].activeElement).closest(\".ui-menu\").length&&(this.element.trigger(\"focus\",[!0]),this.active&&1===this.active.parents(\".ui-menu\").length&&clearTimeout(this.timer)))},\"mouseenter .ui-menu-item\":function(t){var i=e(t.currentTarget);i.siblings(\".ui-state-active\").removeClass(\"ui-state-active\"),this.focus(t,i)},mouseleave:\"collapseAll\",\"mouseleave .ui-menu\":\"collapseAll\",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:\"_keydown\"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1\r\n}})},_destroy:function(){this.element.removeAttr(\"aria-activedescendant\").find(\".ui-menu\").addBack().removeClass(\"ui-menu ui-widget ui-widget-content ui-menu-icons ui-front\").removeAttr(\"role\").removeAttr(\"tabIndex\").removeAttr(\"aria-labelledby\").removeAttr(\"aria-expanded\").removeAttr(\"aria-hidden\").removeAttr(\"aria-disabled\").removeUniqueId().show(),this.element.find(\".ui-menu-item\").removeClass(\"ui-menu-item\").removeAttr(\"role\").removeAttr(\"aria-disabled\").removeUniqueId().removeClass(\"ui-state-hover\").removeAttr(\"tabIndex\").removeAttr(\"role\").removeAttr(\"aria-haspopup\").children().each(function(){var t=e(this);t.data(\"ui-menu-submenu-carat\")&&t.remove()}),this.element.find(\".ui-menu-divider\").removeClass(\"ui-menu-divider ui-widget-content\")},_keydown:function(t){function i(e){return e.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g,\"\\\\$&\")}var s,n,a,o,r,h=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move(\"first\",\"first\",t);break;case e.ui.keyCode.END:this._move(\"last\",\"last\",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(\".ui-state-disabled\")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:h=!1,n=this.previousFilter||\"\",a=String.fromCharCode(t.keyCode),o=!1,clearTimeout(this.filterTimer),a===n?o=!0:a=n+a,r=RegExp(\"^\"+i(a),\"i\"),s=this.activeMenu.find(this.options.items).filter(function(){return r.test(e(this).text())}),s=o&&-1!==s.index(this.active.next())?this.active.nextAll(\".ui-menu-item\"):s,s.length||(a=String.fromCharCode(t.keyCode),r=RegExp(\"^\"+i(a),\"i\"),s=this.activeMenu.find(this.options.items).filter(function(){return r.test(e(this).text())})),s.length?(this.focus(t,s),s.length>1?(this.previousFilter=a,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}h&&t.preventDefault()},_activate:function(e){this.active.is(\".ui-state-disabled\")||(this.active.is(\"[aria-haspopup='true']\")?this.expand(e):this.select(e))},refresh:function(){var t,i,s=this,n=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass(\"ui-menu-icons\",!!this.element.find(\".ui-icon\").length),a.filter(\":not(.ui-menu)\").addClass(\"ui-menu ui-widget ui-widget-content ui-front\").hide().attr({role:this.options.role,\"aria-hidden\":\"true\",\"aria-expanded\":\"false\"}).each(function(){var t=e(this),i=t.parent(),s=e(\"<span>\").addClass(\"ui-menu-icon ui-icon \"+n).data(\"ui-menu-submenu-carat\",!0);i.attr(\"aria-haspopup\",\"true\").prepend(s),t.attr(\"aria-labelledby\",i.attr(\"id\"))}),t=a.add(this.element),i=t.find(this.options.items),i.not(\".ui-menu-item\").each(function(){var t=e(this);s._isDivider(t)&&t.addClass(\"ui-widget-content ui-menu-divider\")}),i.not(\".ui-menu-item, .ui-menu-divider\").addClass(\"ui-menu-item\").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(\".ui-state-disabled\").attr(\"aria-disabled\",\"true\"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:\"menuitem\",listbox:\"option\"}[this.options.role]},_setOption:function(e,t){\"icons\"===e&&this.element.find(\".ui-menu-icon\").removeClass(this.options.icons.submenu).addClass(t.submenu),\"disabled\"===e&&this.element.toggleClass(\"ui-state-disabled\",!!t).attr(\"aria-disabled\",t),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&\"focus\"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.addClass(\"ui-state-focus\").removeClass(\"ui-state-active\"),this.options.role&&this.element.attr(\"aria-activedescendant\",s.attr(\"id\")),this.active.parent().closest(\".ui-menu-item\").addClass(\"ui-state-active\"),e&&\"keydown\"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(\".ui-menu\"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger(\"focus\",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],\"borderTopWidth\"))||0,s=parseFloat(e.css(this.activeMenu[0],\"paddingTop\"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=t.outerHeight(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass(\"ui-state-focus\"),this.active=null,this._trigger(\"blur\",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),\"true\"===e.attr(\"aria-hidden\")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(\".ui-menu\").not(t.parents(\".ui-menu\")).hide().attr(\"aria-hidden\",\"true\"),t.show().removeAttr(\"aria-hidden\").attr(\"aria-expanded\",\"true\").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(\".ui-menu\"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(\".ui-menu\").hide().attr(\"aria-hidden\",\"true\").attr(\"aria-expanded\",\"false\").end().find(\".ui-state-active\").not(\".ui-state-focus\").removeClass(\"ui-state-active\")},_closeOnDocumentClick:function(t){return!e(t.target).closest(\".ui-menu\").length},_isDivider:function(e){return!/[^\\-\\u2014\\u2013\\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(\".ui-menu-item\",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(\".ui-menu \").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move(\"next\",\"first\",e)},previous:function(e){this._move(\"prev\",\"last\",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(\".ui-menu-item\").length},isLastItem:function(){return this.active&&!this.active.nextAll(\".ui-menu-item\").length},_move:function(e,t,i){var s;this.active&&(s=\"first\"===e||\"last\"===e?this.active[\"first\"===e?\"prevAll\":\"nextAll\"](\".ui-menu-item\").eq(-1):this.active[e+\"All\"](\".ui-menu-item\").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(\".ui-menu-item\").each(function(){return i=e(this),0>i.offset().top-s-n}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?\"last\":\"first\"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(\".ui-menu-item\").each(function(){return i=e(this),i.offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop(\"scrollHeight\")},select:function(t){this.active=this.active||e(t.target).closest(\".ui-menu-item\");var i={item:this.active};this.active.has(\".ui-menu\").length||this.collapseAll(t,!0),this._trigger(\"select\",t,i)}}),e.widget(\"ui.autocomplete\",{version:\"1.11.1\",defaultElement:\"<input>\",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:\"left top\",at:\"left bottom\",collision:\"none\"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),a=\"textarea\"===n,o=\"input\"===n;this.isMultiLine=a?!0:o?!1:this.element.prop(\"isContentEditable\"),this.valueMethod=this.element[a||o?\"val\":\"text\"],this.isNewMenu=!0,this.element.addClass(\"ui-autocomplete-input\").attr(\"autocomplete\",\"off\"),this._on(this.element,{keydown:function(n){if(this.element.prop(\"readOnly\"))return t=!0,s=!0,i=!0,void 0;t=!1,s=!1,i=!1;var a=e.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:t=!0,this._move(\"previousPage\",n);break;case a.PAGE_DOWN:t=!0,this._move(\"nextPage\",n);break;case a.UP:t=!0,this._keyEvent(\"previous\",n);break;case a.DOWN:t=!0,this._keyEvent(\"next\",n);break;case a.ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(\":visible\")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(\":visible\"))&&s.preventDefault(),void 0;if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move(\"previousPage\",s);break;case n.PAGE_DOWN:this._move(\"nextPage\",s);break;case n.UP:this._keyEvent(\"previous\",s);break;case n.DOWN:this._keyEvent(\"next\",s)}}},input:function(e){return s?(s=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e(\"<ul>\").addClass(\"ui-autocomplete ui-front\").appendTo(this._appendTo()).menu({role:null}).hide().menu(\"instance\"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(\".ui-menu-item\").length||this._delay(function(){var t=this;this.document.one(\"mousedown\",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),this.document.one(\"mousemove\",function(){e(t.target).trigger(t.originalEvent)}),void 0):(n=i.item.data(\"ui-autocomplete-item\"),!1!==this._trigger(\"focus\",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),s=i.item.attr(\"aria-label\")||n.value,s&&e.trim(s).length&&(this.liveRegion.children().hide(),e(\"<div>\").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,t){var i=t.item.data(\"ui-autocomplete-item\"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger(\"select\",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e(\"<span>\",{role:\"status\",\"aria-live\":\"assertive\",\"aria-relevant\":\"additions\"}).addClass(\"ui-helper-hidden-accessible\").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr(\"autocomplete\")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass(\"ui-autocomplete-input\").removeAttr(\"autocomplete\"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),\"source\"===e&&this._initSource(),\"appendTo\"===e&&this.menu.element.appendTo(this._appendTo()),\"disabled\"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(\".ui-front\")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):\"string\"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:\"json\",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(\":visible\"),s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!s)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger(\"search\",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass(\"ui-autocomplete-loading\"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass(\"ui-autocomplete-loading\")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger(\"response\",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger(\"open\")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(\":visible\")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger(\"close\",e))},_change:function(e){this.previous!==this._value()&&this._trigger(\"change\",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return\"string\"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width(\"\").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data(\"ui-autocomplete-item\",t)},_renderItem:function(t,i){return e(\"<li>\").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(\":visible\")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(\":visible\"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g,\"\\\\$&\")},filter:function(t,i){var s=RegExp(e.ui.autocomplete.escapeRegex(i),\"i\");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget(\"ui.autocomplete\",e.ui.autocomplete,{options:{messages:{noResults:\"No search results.\",results:function(e){return e+(e>1?\" results are\":\" result is\")+\" available, use up and down arrow keys to navigate.\"}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e(\"<div>\").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete;var c,p=\"ui-button ui-widget ui-state-default ui-corner-all\",f=\"ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only\",m=function(){var t=e(this);setTimeout(function(){t.find(\":ui-button\").button(\"refresh\")},1)},g=function(t){var i=t.name,s=t.form,n=e([]);return i&&(i=i.replace(/'/g,\"\\\\'\"),n=s?e(s).find(\"[name='\"+i+\"'][type=radio]\"):e(\"[name='\"+i+\"'][type=radio]\",t.ownerDocument).filter(function(){return!this.form})),n};e.widget(\"ui.button\",{version:\"1.11.1\",defaultElement:\"<button>\",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest(\"form\").unbind(\"reset\"+this.eventNamespace).bind(\"reset\"+this.eventNamespace,m),\"boolean\"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop(\"disabled\"):this.element.prop(\"disabled\",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr(\"title\");var t=this,i=this.options,s=\"checkbox\"===this.type||\"radio\"===this.type,n=s?\"\":\"ui-state-active\";null===i.label&&(i.label=\"input\"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr(\"role\",\"button\").bind(\"mouseenter\"+this.eventNamespace,function(){i.disabled||this===c&&e(this).addClass(\"ui-state-active\")}).bind(\"mouseleave\"+this.eventNamespace,function(){i.disabled||e(this).removeClass(n)}).bind(\"click\"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass(\"ui-state-focus\")},blur:function(){this.buttonElement.removeClass(\"ui-state-focus\")}}),s&&this.element.bind(\"change\"+this.eventNamespace,function(){t.refresh()}),\"checkbox\"===this.type?this.buttonElement.bind(\"click\"+this.eventNamespace,function(){return i.disabled?!1:void 0}):\"radio\"===this.type?this.buttonElement.bind(\"click\"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass(\"ui-state-active\"),t.buttonElement.attr(\"aria-pressed\",\"true\");var s=t.element[0];g(s).not(s).map(function(){return e(this).button(\"widget\")[0]}).removeClass(\"ui-state-active\").attr(\"aria-pressed\",\"false\")}):(this.buttonElement.bind(\"mousedown\"+this.eventNamespace,function(){return i.disabled?!1:(e(this).addClass(\"ui-state-active\"),c=this,t.document.one(\"mouseup\",function(){c=null}),void 0)}).bind(\"mouseup\"+this.eventNamespace,function(){return i.disabled?!1:(e(this).removeClass(\"ui-state-active\"),void 0)}).bind(\"keydown\"+this.eventNamespace,function(t){return i.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass(\"ui-state-active\"),void 0)}).bind(\"keyup\"+this.eventNamespace+\" blur\"+this.eventNamespace,function(){e(this).removeClass(\"ui-state-active\")}),this.buttonElement.is(\"a\")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption(\"disabled\",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is(\"[type=checkbox]\")?\"checkbox\":this.element.is(\"[type=radio]\")?\"radio\":this.element.is(\"input\")?\"input\":\"button\",\"checkbox\"===this.type||\"radio\"===this.type?(e=this.element.parents().last(),t=\"label[for='\"+this.element.attr(\"id\")+\"']\",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass(\"ui-helper-hidden-accessible\"),i=this.element.is(\":checked\"),i&&this.buttonElement.addClass(\"ui-state-active\"),this.buttonElement.prop(\"aria-pressed\",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass(\"ui-helper-hidden-accessible\"),this.buttonElement.removeClass(p+\" ui-state-active \"+f).removeAttr(\"role\").removeAttr(\"aria-pressed\").html(this.buttonElement.find(\".ui-button-text\").html()),this.hasTitle||this.buttonElement.removeAttr(\"title\")},_setOption:function(e,t){return this._super(e,t),\"disabled\"===e?(this.widget().toggleClass(\"ui-state-disabled\",!!t),this.element.prop(\"disabled\",!!t),t&&(\"checkbox\"===this.type||\"radio\"===this.type?this.buttonElement.removeClass(\"ui-state-focus\"):this.buttonElement.removeClass(\"ui-state-focus ui-state-active\")),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is(\"input, button\")?this.element.is(\":disabled\"):this.element.hasClass(\"ui-button-disabled\");t!==this.options.disabled&&this._setOption(\"disabled\",t),\"radio\"===this.type?g(this.element[0]).each(function(){e(this).is(\":checked\")?e(this).button(\"widget\").addClass(\"ui-state-active\").attr(\"aria-pressed\",\"true\"):e(this).button(\"widget\").removeClass(\"ui-state-active\").attr(\"aria-pressed\",\"false\")}):\"checkbox\"===this.type&&(this.element.is(\":checked\")?this.buttonElement.addClass(\"ui-state-active\").attr(\"aria-pressed\",\"true\"):this.buttonElement.removeClass(\"ui-state-active\").attr(\"aria-pressed\",\"false\"))},_resetButton:function(){if(\"input\"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(f),i=e(\"<span></span>\",this.document[0]).addClass(\"ui-button-text\").html(this.options.label).appendTo(t.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push(\"ui-button-text-icon\"+(n?\"s\":s.primary?\"-primary\":\"-secondary\")),s.primary&&t.prepend(\"<span class='ui-button-icon-primary ui-icon \"+s.primary+\"'></span>\"),s.secondary&&t.append(\"<span class='ui-button-icon-secondary ui-icon \"+s.secondary+\"'></span>\"),this.options.text||(a.push(n?\"ui-button-icons-only\":\"ui-button-icon-only\"),this.hasTitle||t.attr(\"title\",e.trim(i)))):a.push(\"ui-button-text-only\"),t.addClass(a.join(\" \"))}}),e.widget(\"ui.buttonset\",{version:\"1.11.1\",options:{items:\"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)\"},_create:function(){this.element.addClass(\"ui-buttonset\")},_init:function(){this.refresh()},_setOption:function(e,t){\"disabled\"===e&&this.buttons.button(\"option\",e,t),this._super(e,t)},refresh:function(){var t=\"rtl\"===this.element.css(\"direction\"),i=this.element.find(this.options.items),s=i.filter(\":ui-button\");i.not(\":ui-button\").button(),s.button(\"refresh\"),this.buttons=i.map(function(){return e(this).button(\"widget\")[0]}).removeClass(\"ui-corner-all ui-corner-left ui-corner-right\").filter(\":first\").addClass(t?\"ui-corner-right\":\"ui-corner-left\").end().filter(\":last\").addClass(t?\"ui-corner-left\":\"ui-corner-right\").end().end()},_destroy:function(){this.element.removeClass(\"ui-buttonset\"),this.buttons.map(function(){return e(this).button(\"widget\")[0]}).removeClass(\"ui-corner-left ui-corner-right\").end().button(\"destroy\")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:\"1.11.1\"}});var v;e.extend(n.prototype,{markerClassName:\"hasDatepicker\",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return r(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n=\"div\"===s||\"span\"===s,t.id||(this.uuid+=1,t.id=\"dp\"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),\"input\"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var s=t[0].id.replace(/([^A-Za-z0-9_\\-])/g,\"\\\\\\\\$1\");return{id:s,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(e(\"<div class='\"+this._inlineClass+\" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>\")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,\"datepicker\",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,\"appendText\"),r=this._get(i,\"isRTL\");i.append&&i.append.remove(),o&&(i.append=e(\"<span class='\"+this._appendClass+\"'>\"+o+\"</span>\"),t[r?\"before\":\"after\"](i.append)),t.unbind(\"focus\",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,\"showOn\"),(\"focus\"===s||\"both\"===s)&&t.focus(this._showDatepicker),(\"button\"===s||\"both\"===s)&&(n=this._get(i,\"buttonText\"),a=this._get(i,\"buttonImage\"),i.trigger=e(this._get(i,\"buttonImageOnly\")?e(\"<img/>\").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e(\"<button type='button'></button>\").addClass(this._triggerClass).html(a?e(\"<img/>\").attr({src:a,alt:n,title:n}):n)),t[r?\"before\":\"after\"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,\"autoSize\")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,\"dateFormat\");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?\"monthNames\":\"monthNamesShort\"))),a.setDate(t(this._get(e,o.match(/DD/)?\"dayNames\":\"dayNamesShort\"))+20-a.getDay())),e.input.attr(\"size\",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,\"datepicker\",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css(\"display\",\"block\"))},_dialogDatepicker:function(t,i,s,n,a){var o,h,l,u,d,c=this._dialogInst;return c||(this.uuid+=1,o=\"dp\"+this.uuid,this._dialogInput=e(\"<input type='text' id='\"+o+\"' style='position: absolute; top: -100px; width: 0px;'/>\"),this._dialogInput.keydown(this._doKeyDown),e(\"body\").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],\"datepicker\",c)),r(c.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+d]),this._dialogInput.css(\"left\",this._pos[0]+20+\"px\").css(\"top\",this._pos[1]+\"px\"),c.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],\"datepicker\",c),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,\"datepicker\");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,\"datepicker\"),\"input\"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind(\"focus\",this._showDatepicker).unbind(\"keydown\",this._doKeyDown).unbind(\"keypress\",this._doKeyPress).unbind(\"keyup\",this._doKeyUp)):(\"div\"===i||\"span\"===i)&&s.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,\"datepicker\");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),\"input\"===i?(t.disabled=!1,a.trigger.filter(\"button\").each(function(){this.disabled=!1}).end().filter(\"img\").css({opacity:\"1.0\",cursor:\"\"})):(\"div\"===i||\"span\"===i)&&(s=n.children(\".\"+this._inlineClass),s.children().removeClass(\"ui-state-disabled\"),s.find(\"select.ui-datepicker-month, select.ui-datepicker-year\").prop(\"disabled\",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,\"datepicker\");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),\"input\"===i?(t.disabled=!0,a.trigger.filter(\"button\").each(function(){this.disabled=!0}).end().filter(\"img\").css({opacity:\"0.5\",cursor:\"default\"})):(\"div\"===i||\"span\"===i)&&(s=n.children(\".\"+this._inlineClass),s.children().addClass(\"ui-state-disabled\"),s.find(\"select.ui-datepicker-month, select.ui-datepicker-year\").prop(\"disabled\",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,\"datepicker\")}catch(i){throw\"Missing instance data for this datepicker\"}},_optionDatepicker:function(t,i,s){var n,a,o,h,l=this._getInst(t);return 2===arguments.length&&\"string\"==typeof i?\"defaults\"===i?e.extend({},e.datepicker._defaults):l?\"all\"===i?e.extend({},l.settings):this._get(l,i):null:(n=i||{},\"string\"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(l,\"min\"),h=this._getMinMaxDate(l,\"max\"),r(l.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),\"disabled\"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,a),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(\".ui-datepicker-rtl\");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e(\"td.\"+e.datepicker._dayOverClass+\":not(.\"+e.datepicker._currentClass+\")\",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,\"onSelect\"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,\"stepBigMonths\"):-e.datepicker._get(a,\"stepMonths\"),\"M\");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,\"stepBigMonths\"):+e.datepicker._get(a,\"stepMonths\"),\"M\");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,\"D\"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,\"stepBigMonths\"):-e.datepicker._get(a,\"stepMonths\"),\"M\");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,\"D\"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,\"D\"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,\"stepBigMonths\"):+e.datepicker._get(a,\"stepMonths\"),\"M\");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,\"D\"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,\"constrainInput\")?(i=e.datepicker._possibleChars(e.datepicker._get(n,\"dateFormat\")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||\" \">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,\"dateFormat\"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))\r\n}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,\"input\"!==t.nodeName.toLowerCase()&&(t=e(\"input\",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,n,a,o,h,l,u;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,\"beforeShow\"),a=n?n.apply(t,[t,i]):{},a!==!1&&(r(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=\"\"),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|=\"fixed\"===e(this).css(\"position\"),!o}),h={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:\"absolute\",display:\"block\",top:\"-1000px\"}),e.datepicker._updateDatepicker(i),h=e.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?\"static\":o?\"fixed\":\"absolute\",display:\"none\",left:h.left+\"px\",top:h.top+\"px\"}),i.inline||(l=e.datepicker._get(i,\"showAnim\"),u=e.datepicker._get(i,\"duration\"),i.dpDiv.css(\"z-index\",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,\"showOptions\"),u):i.dpDiv[l||\"show\"](l?u:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,v=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),n=s[1],a=17,r=t.dpDiv.find(\".\"+this._dayOverClass+\" a\");r.length>0&&o.apply(r.get(0)),t.dpDiv.removeClass(\"ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4\").width(\"\"),n>1&&t.dpDiv.addClass(\"ui-datepicker-multi-\"+n).css(\"width\",a*n+\"em\"),t.dpDiv[(1!==s[0]||1!==s[1]?\"add\":\"remove\")+\"Class\"](\"ui-datepicker-multi\"),t.dpDiv[(this._get(t,\"isRTL\")?\"add\":\"remove\")+\"Class\"](\"ui-datepicker-rtl\"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find(\"select.ui-datepicker-year:first\").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(\":visible\")&&!e.input.is(\":disabled\")&&!e.input.is(\":focus\")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,\"isRTL\")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,\"isRTL\");t&&(\"hidden\"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?\"previousSibling\":\"nextSibling\"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,o=this._curInst;!o||t&&o!==e.data(t,\"datepicker\")||this._datepickerShowing&&(i=this._get(o,\"showAnim\"),s=this._get(o,\"duration\"),n=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,\"showOptions\"),s,n):o.dpDiv[\"slideDown\"===i?\"slideUp\":\"fadeIn\"===i?\"fadeOut\":\"hide\"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,\"onClose\"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():\"\",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:\"absolute\",left:\"0\",top:\"-100px\"}),e.blockUI&&(e.unblockUI(),e(\"body\").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(\".ui-datepicker-calendar\")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents(\"#\"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest(\".\"+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+(\"M\"===s?this._get(a,\"showCurrentAtPos\"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,\"gotoCurrent\")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a[\"selected\"+(\"M\"===s?\"Month\":\"Year\")]=a[\"draw\"+(\"M\"===s?\"Month\":\"Year\")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e(\"a\",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,\"\")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,\"onSelect\"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger(\"change\"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],\"object\"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,\"altField\");a&&(i=this._get(t,\"altFormat\")||this._get(t,\"dateFormat\"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,\"\"]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw\"Invalid arguments\";if(i=\"object\"==typeof i?\"\"+i:i+\"\",\"\"===i)return null;var n,a,o,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u=\"string\"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,c=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},x=function(e){var t=_(e),s=\"@\"===e?14:\"!\"===e?20:\"y\"===e&&t?4:\"o\"===e?3:2,n=\"y\"===e?s:1,a=RegExp(\"^\\\\d{\"+n+\",\"+s+\"}\"),o=i.substring(h).match(a);if(!o)throw\"Missing number at position \"+h;return h+=o[0].length,parseInt(o[0],10)},w=function(t,s,n){var a=-1,o=e.map(_(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var s=t[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(a=t[0],h+=s.length,!1):void 0}),-1!==a)return a+1;throw\"Unknown name at position \"+h},k=function(){if(i.charAt(h)!==t.charAt(n))throw\"Unexpected literal at position \"+h;h++};for(n=0;t.length>n;n++)if(b)\"'\"!==t.charAt(n)||_(\"'\")?k():b=!1;else switch(t.charAt(n)){case\"d\":v=x(\"d\");break;case\"D\":w(\"D\",d,c);break;case\"o\":y=x(\"o\");break;case\"m\":g=x(\"m\");break;case\"M\":g=w(\"M\",p,f);break;case\"y\":m=x(\"y\");break;case\"@\":r=new Date(x(\"@\")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case\"!\":r=new Date((x(\"!\")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case\"'\":_(\"'\")?k():b=!0;break;default:k()}if(i.length>h&&(o=i.substr(h),!/^\\s+/.test(o)))throw\"Extra/unparsed characters found in date: \"+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),y>-1)for(g=1,v=y;;){if(a=this._getDaysInMonth(m,g-1),a>=v)break;g++,v-=a}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw\"Invalid date\";return r},ATOM:\"yy-mm-dd\",COOKIE:\"D, dd M yy\",ISO_8601:\"yy-mm-dd\",RFC_822:\"D, d M y\",RFC_850:\"DD, dd-M-y\",RFC_1036:\"D, d M y\",RFC_1123:\"D, d M yy\",RFC_2822:\"D, d M yy\",RSS:\"D, d M y\",TICKS:\"!\",TIMESTAMP:\"@\",W3C:\"yy-mm-dd\",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return\"\";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=\"\"+t;if(h(e))for(;i>s.length;)s=\"0\"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d=\"\",c=!1;if(t)for(s=0;e.length>s;s++)if(c)\"'\"!==e.charAt(s)||h(\"'\")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case\"d\":d+=l(\"d\",t.getDate(),2);break;case\"D\":d+=u(\"D\",t.getDay(),n,a);break;case\"o\":d+=l(\"o\",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case\"m\":d+=l(\"m\",t.getMonth()+1,2);break;case\"M\":d+=u(\"M\",t.getMonth(),o,r);break;case\"y\":d+=h(\"y\")?t.getFullYear():(10>t.getYear()%100?\"0\":\"\")+t.getYear()%100;break;case\"@\":d+=t.getTime();break;case\"!\":d+=1e4*t.getTime()+this._ticksTo1970;break;case\"'\":h(\"'\")?d+=\"'\":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i=\"\",s=!1,n=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)\"'\"!==e.charAt(t)||n(\"'\")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case\"d\":case\"m\":case\"y\":case\"@\":i+=\"0123456789\";break;case\"D\":case\"M\":return null;case\"'\":n(\"'\")?i+=\"'\":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,\"dateFormat\"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?\"\":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,\"defaultDate\"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,\"dateFormat\"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\\-]?[0-9]+)\\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||\"d\"){case\"d\":case\"D\":r+=parseInt(l[1],10);break;case\"w\":case\"W\":r+=7*parseInt(l[1],10);break;case\"m\":case\"M\":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case\"y\":case\"Y\":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||\"\"===i?s:\"string\"==typeof i?a(i):\"number\"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&\"Invalid Date\"==\"\"+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?\"\":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&\"\"===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,\"stepMonths\"),s=\"#\"+t.id.replace(/\\\\\\\\/g,\"\\\\\");t.dpDiv.find(\"[data-handler]\").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,\"M\")},next:function(){e.datepicker._adjustDate(s,+i,\"M\")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute(\"data-month\"),+this.getAttribute(\"data-year\"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,\"M\"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,\"Y\"),!1}};e(this).bind(this.getAttribute(\"data-event\"),t[this.getAttribute(\"data-handler\")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,h,l,u,d,c,p,f,m,g,v,y,b,_,x,w,k,T,D,S,M,N,C,A,I,P,z,H,F,E,j,O,W,L=new Date,R=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),Y=this._get(e,\"isRTL\"),B=this._get(e,\"showButtonPanel\"),J=this._get(e,\"hideIfNoPrevNext\"),q=this._get(e,\"navigationAsDateFormat\"),K=this._getNumberOfMonths(e),V=this._get(e,\"showCurrentAtPos\"),U=this._get(e,\"stepMonths\"),Q=1!==K[0]||1!==K[1],G=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,\"min\"),$=this._getMinMaxDate(e,\"max\"),Z=e.drawMonth-V,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-K[0]*K[1]+1,$.getDate())),t=X&&X>t?X:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,\"prevText\"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-U,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?\"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='\"+i+\"'><span class='ui-icon ui-icon-circle-triangle-\"+(Y?\"e\":\"w\")+\"'>\"+i+\"</span></a>\":J?\"\":\"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='\"+i+\"'><span class='ui-icon ui-icon-circle-triangle-\"+(Y?\"e\":\"w\")+\"'>\"+i+\"</span></a>\",n=this._get(e,\"nextText\"),n=q?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z+U,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Z)?\"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='\"+n+\"'><span class='ui-icon ui-icon-circle-triangle-\"+(Y?\"w\":\"e\")+\"'>\"+n+\"</span></a>\":J?\"\":\"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='\"+n+\"'><span class='ui-icon ui-icon-circle-triangle-\"+(Y?\"w\":\"e\")+\"'>\"+n+\"</span></a>\",o=this._get(e,\"currentText\"),r=this._get(e,\"gotoCurrent\")&&e.currentDay?G:R,o=q?this.formatDate(o,r,this._getFormatConfig(e)):o,h=e.inline?\"\":\"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>\"+this._get(e,\"closeText\")+\"</button>\",l=B?\"<div class='ui-datepicker-buttonpane ui-widget-content'>\"+(Y?h:\"\")+(this._isInRange(e,r)?\"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>\"+o+\"</button>\":\"\")+(Y?\"\":h)+\"</div>\":\"\",u=parseInt(this._get(e,\"firstDay\"),10),u=isNaN(u)?0:u,d=this._get(e,\"showWeek\"),c=this._get(e,\"dayNames\"),p=this._get(e,\"dayNamesMin\"),f=this._get(e,\"monthNames\"),m=this._get(e,\"monthNamesShort\"),g=this._get(e,\"beforeShowDay\"),v=this._get(e,\"showOtherMonths\"),y=this._get(e,\"selectOtherMonths\"),b=this._getDefaultDate(e),_=\"\",w=0;K[0]>w;w++){for(k=\"\",this.maxRows=4,T=0;K[1]>T;T++){if(D=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),S=\" ui-corner-all\",M=\"\",Q){if(M+=\"<div class='ui-datepicker-group\",K[1]>1)switch(T){case 0:M+=\" ui-datepicker-group-first\",S=\" ui-corner-\"+(Y?\"right\":\"left\");break;case K[1]-1:M+=\" ui-datepicker-group-last\",S=\" ui-corner-\"+(Y?\"left\":\"right\");break;default:M+=\" ui-datepicker-group-middle\",S=\"\"}M+=\"'>\"}for(M+=\"<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix\"+S+\"'>\"+(/all|left/.test(S)&&0===w?Y?a:s:\"\")+(/all|right/.test(S)&&0===w?Y?s:a:\"\")+this._generateMonthYearHeader(e,Z,et,X,$,w>0||T>0,f,m)+\"</div><table class='ui-datepicker-calendar'><thead>\"+\"<tr>\",N=d?\"<th class='ui-datepicker-week-col'>\"+this._get(e,\"weekHeader\")+\"</th>\":\"\",x=0;7>x;x++)C=(x+u)%7,N+=\"<th scope='col'\"+((x+u+6)%7>=5?\" class='ui-datepicker-week-end'\":\"\")+\">\"+\"<span title='\"+c[C]+\"'>\"+p[C]+\"</span></th>\";for(M+=N+\"</tr></thead><tbody>\",A=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),I=(this._getFirstDayOfMonth(et,Z)-u+7)%7,P=Math.ceil((I+A)/7),z=Q?this.maxRows>P?this.maxRows:P:P,this.maxRows=z,H=this._daylightSavingAdjust(new Date(et,Z,1-I)),F=0;z>F;F++){for(M+=\"<tr>\",E=d?\"<td class='ui-datepicker-week-col'>\"+this._get(e,\"calculateWeek\")(H)+\"</td>\":\"\",x=0;7>x;x++)j=g?g.apply(e.input?e.input[0]:null,[H]):[!0,\"\"],O=H.getMonth()!==Z,W=O&&!y||!j[0]||X&&X>H||$&&H>$,E+=\"<td class='\"+((x+u+6)%7>=5?\" ui-datepicker-week-end\":\"\")+(O?\" ui-datepicker-other-month\":\"\")+(H.getTime()===D.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===H.getTime()&&b.getTime()===D.getTime()?\" \"+this._dayOverClass:\"\")+(W?\" \"+this._unselectableClass+\" ui-state-disabled\":\"\")+(O&&!v?\"\":\" \"+j[1]+(H.getTime()===G.getTime()?\" \"+this._currentClass:\"\")+(H.getTime()===R.getTime()?\" ui-datepicker-today\":\"\"))+\"'\"+(O&&!v||!j[2]?\"\":\" title='\"+j[2].replace(/'/g,\"&#39;\")+\"'\")+(W?\"\":\" data-handler='selectDay' data-event='click' data-month='\"+H.getMonth()+\"' data-year='\"+H.getFullYear()+\"'\")+\">\"+(O&&!v?\"&#xa0;\":W?\"<span class='ui-state-default'>\"+H.getDate()+\"</span>\":\"<a class='ui-state-default\"+(H.getTime()===R.getTime()?\" ui-state-highlight\":\"\")+(H.getTime()===G.getTime()?\" ui-state-active\":\"\")+(O?\" ui-priority-secondary\":\"\")+\"' href='#'>\"+H.getDate()+\"</a>\")+\"</td>\",H.setDate(H.getDate()+1),H=this._daylightSavingAdjust(H);M+=E+\"</tr>\"}Z++,Z>11&&(Z=0,et++),M+=\"</tbody></table>\"+(Q?\"</div>\"+(K[0]>0&&T===K[1]-1?\"<div class='ui-datepicker-row-break'></div>\":\"\"):\"\"),k+=M}_+=k}return _+=l,e._keyEvent=!1,_},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var h,l,u,d,c,p,f,m,g=this._get(e,\"changeMonth\"),v=this._get(e,\"changeYear\"),y=this._get(e,\"showMonthAfterYear\"),b=\"<div class='ui-datepicker-title'>\",_=\"\";if(a||!g)_+=\"<span class='ui-datepicker-month'>\"+o[t]+\"</span>\";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,_+=\"<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>\",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(_+=\"<option value='\"+u+\"'\"+(u===t?\" selected='selected'\":\"\")+\">\"+r[u]+\"</option>\");_+=\"</select>\"}if(y||(b+=_+(!a&&g&&v?\"\":\"&#xa0;\")),!e.yearshtml)if(e.yearshtml=\"\",a||!v)b+=\"<span class='ui-datepicker-year'>\"+i+\"</span>\";else{for(d=this._get(e,\"yearRange\").split(\":\"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||\"\")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+=\"<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>\";m>=f;f++)e.yearshtml+=\"<option value='\"+f+\"'\"+(f===i?\" selected='selected'\":\"\")+\">\"+f+\"</option>\";e.yearshtml+=\"</select>\",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,\"yearSuffix\"),y&&(b+=(!a&&g&&v?\"\":\"&#xa0;\")+_),b+=\"</div>\"},_adjustInstDate:function(e,t,i){var s=e.drawYear+(\"Y\"===i?t:0),n=e.drawMonth+(\"M\"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+(\"D\"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(\"M\"===i||\"Y\"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,\"min\"),s=this._getMinMaxDate(e,\"max\"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,\"onChangeMonthYear\");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,\"numberOfMonths\");return null==t?[1,1]:\"number\"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+\"Date\"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,\"min\"),a=this._getMinMaxDate(e,\"max\"),o=null,r=null,h=this._get(e,\"yearRange\");return h&&(i=h.split(\":\"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\\-].*/)&&(o+=s),i[1].match(/[+\\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,\"shortYearCutoff\");return t=\"string\"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,\"dayNamesShort\"),dayNames:this._get(e,\"dayNames\"),monthNamesShort:this._get(e,\"monthNamesShort\"),monthNames:this._get(e,\"monthNames\")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?\"object\"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,\"dateFormat\"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e(\"#\"+e.datepicker._mainDivId).length&&e(\"body\").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return\"string\"!=typeof t||\"isDisabled\"!==t&&\"getDate\"!==t&&\"widget\"!==t?\"option\"===t&&2===arguments.length&&\"string\"==typeof arguments[1]?e.datepicker[\"_\"+t+\"Datepicker\"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){\"string\"==typeof t?e.datepicker[\"_\"+t+\"Datepicker\"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker[\"_\"+t+\"Datepicker\"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version=\"1.11.1\",e.datepicker,e.widget(\"ui.draggable\",e.ui.mouse,{version:\"1.11.1\",widgetEventPrefix:\"drag\",options:{addClasses:!0,appendTo:\"parent\",axis:!1,connectToSortable:!1,containment:!1,cursor:\"auto\",cursorAt:!1,grid:!1,handle:!1,helper:\"original\",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:\"default\",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:\"both\",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){\"original\"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css(\"position\"))||(this.element[0].style.position=\"relative\"),this.options.addClasses&&this.element.addClass(\"ui-draggable\"),this.options.disabled&&this.element.addClass(\"ui-draggable-disabled\"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),\"handle\"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(\".ui-draggable-dragging\")?(this.destroyOnClear=!0,void 0):(this.element.removeClass(\"ui-draggable ui-draggable-dragging ui-draggable-disabled\"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.document[0],s=this.options;try{i.activeElement&&\"body\"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(n){}return this.helper||s.disabled||e(t.target).closest(\".ui-resizable-handle\").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(s.iframeFix===!0?\"iframe\":s.iframeFix).each(function(){e(\"<div class='ui-draggable-iframeFix' style='background: #fff;'></div>\").css({width:this.offsetWidth+\"px\",height:this.offsetHeight+\"px\",position:\"absolute\",opacity:\"0.001\",zIndex:1e3}).css(e(this).offset()).appendTo(\"body\")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass(\"ui-draggable-dragging\"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css(\"position\"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css(\"position\"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger(\"start\",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if(\"fixed\"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo(\"absolute\"),!i){var s=this._uiHash();if(this._trigger(\"drag\",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+\"px\",this.helper[0].style.top=this.position.top+\"px\",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),\"invalid\"===this.options.revert&&!s||\"valid\"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger(\"stop\",t)!==!1&&i._clear()}):this._trigger(\"stop\",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e(\"div.ui-draggable-iframeFix\").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(\".ui-draggable-dragging\")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass(\"ui-draggable-handle\")},_removeHandleClassName:function(){this.handleElement.removeClass(\"ui-draggable-handle\")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):\"clone\"===i.helper?this.element.clone().removeAttr(\"id\"):this.element;return s.parents(\"body\").length||s.appendTo(\"parent\"===i.appendTo?this.element[0].parentNode:i.appendTo),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css(\"position\"))||s.css(\"position\",\"absolute\"),s},_adjustOffsetFromHelper:function(t){\"string\"==typeof t&&(t=t.split(\" \")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),\"left\"in t&&(this.offset.click.left=t.left+this.margins.left),\"right\"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),\"top\"in t&&(this.offset.click.top=t.top+this.margins.top),\"bottom\"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return\"absolute\"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css(\"borderTopWidth\"),10)||0),left:t.left+(parseInt(this.offsetParent.css(\"borderLeftWidth\"),10)||0)}},_getRelativeOffset:function(){if(\"relative\"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css(\"top\"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css(\"left\"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css(\"marginLeft\"),10)||0,top:parseInt(this.element.css(\"marginTop\"),10)||0,right:parseInt(this.element.css(\"marginRight\"),10)||0,bottom:parseInt(this.element.css(\"marginBottom\"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?\"window\"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):\"document\"===n.containment?(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):(\"parent\"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t=\"hidden\"!==i.css(\"overflow\"),this.containment=[(parseInt(i.css(\"borderLeftWidth\"),10)||0)+(parseInt(i.css(\"paddingLeft\"),10)||0),(parseInt(i.css(\"borderTopWidth\"),10)||0)+(parseInt(i.css(\"paddingTop\"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css(\"borderRightWidth\"),10)||0)-(parseInt(i.css(\"paddingRight\"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css(\"borderBottomWidth\"),10)||0)-(parseInt(i.css(\"paddingBottom\"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var i=\"absolute\"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-(\"fixed\"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-(\"fixed\"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}\r\n},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),\"y\"===o.axis&&(h=this.originalPageX),\"x\"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(\"fixed\"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(\"fixed\"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass(\"ui-draggable-dragging\"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),\"drag\"===t&&(this.positionAbs=this._convertPositionTo(\"absolute\")),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add(\"draggable\",\"connectToSortable\",{start:function(t,i,s){var n=s.options,a=e.extend({},i,{item:s.element});s.sortables=[],e(n.connectToSortable).each(function(){var i=e(this).sortable(\"instance\");i&&!i.options.disabled&&(s.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger(\"activate\",t,a))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});e.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,\"original\"===s.options.helper&&this.instance.currentItem.css({top:\"auto\",left:\"auto\"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger(\"deactivate\",t,n))})},drag:function(t,i,s){var n=this;e.each(s.sortables,function(){var a=!1,o=this;this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(a=!0,e.each(s.sortables,function(){return this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(a=!1),a})),a?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(n).clone().removeAttr(\"id\").appendTo(this.instance.element).data(\"ui-sortable-item\",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger(\"toSortable\",t),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger(\"out\",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger(\"fromSortable\",t),s.dropped=!1)})}}),e.ui.plugin.add(\"draggable\",\"cursor\",{start:function(t,i,s){var n=e(\"body\"),a=s.options;n.css(\"cursor\")&&(a._cursor=n.css(\"cursor\")),n.css(\"cursor\",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e(\"body\").css(\"cursor\",n._cursor)}}),e.ui.plugin.add(\"draggable\",\"opacity\",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css(\"opacity\")&&(a._opacity=n.css(\"opacity\")),n.css(\"opacity\",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css(\"opacity\",n._opacity)}}),e.ui.plugin.add(\"draggable\",\"scroll\",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&\"HTML\"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&\"HTML\"!==o.tagName?(n.axis&&\"x\"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&\"y\"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&\"x\"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&\"y\"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add(\"draggable\",\"snap\",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||\":data(ui-draggable)\":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,h,l,u,d,c,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left,l=h+s.snapElements[c].width,u=s.snapElements[c].top,d=u+s.snapElements[c].height,h-m>v||g>l+m||u-m>b||y>d+m||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):(\"inner\"!==f.snapMode&&(n=m>=Math.abs(u-b),a=m>=Math.abs(d-y),o=m>=Math.abs(h-v),r=m>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo(\"relative\",{top:u-s.helperProportions.height,left:0}).top-s.margins.top),a&&(i.position.top=s._convertPositionTo(\"relative\",{top:d,left:0}).top-s.margins.top),o&&(i.position.left=s._convertPositionTo(\"relative\",{top:0,left:h-s.helperProportions.width}).left-s.margins.left),r&&(i.position.left=s._convertPositionTo(\"relative\",{top:0,left:l}).left-s.margins.left)),p=n||a||o||r,\"outer\"!==f.snapMode&&(n=m>=Math.abs(u-y),a=m>=Math.abs(d-b),o=m>=Math.abs(h-g),r=m>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo(\"relative\",{top:u,left:0}).top-s.margins.top),a&&(i.position.top=s._convertPositionTo(\"relative\",{top:d-s.helperProportions.height,left:0}).top-s.margins.top),o&&(i.position.left=s._convertPositionTo(\"relative\",{top:0,left:h}).left-s.margins.left),r&&(i.position.left=s._convertPositionTo(\"relative\",{top:0,left:l-s.helperProportions.width}).left-s.margins.left)),!s.snapElements[c].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=n||a||o||r||p)}}),e.ui.plugin.add(\"draggable\",\"stack\",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css(\"zIndex\"),10)||0)-(parseInt(e(i).css(\"zIndex\"),10)||0)});o.length&&(n=parseInt(e(o[0]).css(\"zIndex\"),10)||0,e(o).each(function(t){e(this).css(\"zIndex\",n+t)}),this.css(\"zIndex\",n+o.length))}}),e.ui.plugin.add(\"draggable\",\"zIndex\",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css(\"zIndex\")&&(a._zIndex=n.css(\"zIndex\")),n.css(\"zIndex\",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css(\"zIndex\",n._zIndex)}}),e.ui.draggable,e.widget(\"ui.resizable\",e.ui.mouse,{version:\"1.11.1\",widgetEventPrefix:\"resize\",options:{alsoResize:!1,animate:!1,animateDuration:\"slow\",animateEasing:\"swing\",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:\"e,s,se\",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if(\"hidden\"===e(t).css(\"overflow\"))return!1;var s=i&&\"left\"===i?\"scrollLeft\":\"scrollTop\",n=!1;return t[s]>0?!0:(t[s]=1,n=t[s]>0,t[s]=0,n)},_create:function(){var t,i,s,n,a,o=this,r=this.options;if(this.element.addClass(\"ui-resizable\"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||\"ui-resizable-helper\":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e(\"<div class='ui-wrapper' style='overflow: hidden;'></div>\").css({position:this.element.css(\"position\"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css(\"top\"),left:this.element.css(\"left\")})),this.element=this.element.parent().data(\"ui-resizable\",this.element.resizable(\"instance\")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css(\"marginLeft\"),marginTop:this.originalElement.css(\"marginTop\"),marginRight:this.originalElement.css(\"marginRight\"),marginBottom:this.originalElement.css(\"marginBottom\")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css(\"resize\"),this.originalElement.css(\"resize\",\"none\"),this._proportionallyResizeElements.push(this.originalElement.css({position:\"static\",zoom:1,display:\"block\"})),this.originalElement.css({margin:this.originalElement.css(\"margin\")}),this._proportionallyResize()),this.handles=r.handles||(e(\".ui-resizable-handle\",this.element).length?{n:\".ui-resizable-n\",e:\".ui-resizable-e\",s:\".ui-resizable-s\",w:\".ui-resizable-w\",se:\".ui-resizable-se\",sw:\".ui-resizable-sw\",ne:\".ui-resizable-ne\",nw:\".ui-resizable-nw\"}:\"e,s,se\"),this.handles.constructor===String)for(\"all\"===this.handles&&(this.handles=\"n,e,s,w,se,sw,ne,nw\"),t=this.handles.split(\",\"),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),a=\"ui-resizable-\"+s,n=e(\"<div class='ui-resizable-handle \"+a+\"'></div>\"),n.css({zIndex:r.zIndex}),\"se\"===s&&n.addClass(\"ui-icon ui-icon-gripsmall-diagonal-se\"),this.handles[s]=\".ui-resizable-\"+s,this.element.append(n);this._renderAxis=function(t){var i,s,n,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=this.element.children(this.handles[i]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(s=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=[\"padding\",/ne|nw|n/.test(i)?\"Top\":/se|sw|s/.test(i)?\"Bottom\":/^e$/.test(i)?\"Right\":\"Left\"].join(\"\"),t.css(n,a),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(\".ui-resizable-handle\",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:\"se\")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass(\"ui-resizable-autohide\").mouseenter(function(){r.disabled||(e(this).removeClass(\"ui-resizable-autohide\"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(e(this).addClass(\"ui-resizable-autohide\"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass(\"ui-resizable ui-resizable-disabled ui-resizable-resizing\").removeData(\"resizable\").removeData(\"ui-resizable\").unbind(\".resizable\").find(\".ui-resizable-handle\").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css(\"position\"),width:t.outerWidth(),height:t.outerHeight(),top:t.css(\"top\"),left:t.css(\"left\")}).insertAfter(t),t.remove()),this.originalElement.css(\"resize\",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var i,s,n,a=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css(\"left\")),s=this._num(this.helper.css(\"top\")),a.containment&&(i+=e(a.containment).scrollLeft()||0,s+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=\"number\"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(\".ui-resizable-\"+this.axis).css(\"cursor\"),e(\"body\").css(\"cursor\",\"auto\"===n?this.axis+\"-resize\":n),o.addClass(\"ui-resizable-resizing\"),this._propagate(\"start\",t),!0},_mouseDrag:function(t){var i,s,n=this.originalMousePosition,a=this.axis,o=t.pageX-n.left||0,r=t.pageY-n.top||0,h=this._change[a];return this._updatePrevProperties(),h?(i=h.apply(this,[t,o,r]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate(\"resize\",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger(\"resize\",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],\"left\")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css(\"left\"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css(\"top\"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e(\"body\").css(\"cursor\",\"auto\"),this.element.removeClass(\"ui-resizable-resizing\"),this._propagate(\"stop\",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+\"px\"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+\"px\"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+\"px\"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+\"px\"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,s,n,a,o=this.options;a={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,i=a.maxHeight*this.aspectRatio,n=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),s>a.minHeight&&(a.minHeight=s),a.maxWidth>i&&(a.maxWidth=i),a.maxHeight>n&&(a.maxHeight=n)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,s=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),\"sw\"===s&&(e.left=t.left+(i.width-e.width),e.top=null),\"nw\"===s&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,s=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,r=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return a&&(e.width=t.minWidth),o&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),a&&l&&(e.left=r-t.minWidth),s&&l&&(e.left=r-t.maxWidth),o&&u&&(e.top=h-t.minHeight),n&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],s=[e.css(\"borderTopWidth\"),e.css(\"borderRightWidth\"),e.css(\"borderBottomWidth\"),e.css(\"borderLeftWidth\")],n=[e.css(\"paddingTop\"),e.css(\"paddingRight\"),e.css(\"paddingBottom\"),e.css(\"paddingLeft\")];4>t;t++)i[t]=parseInt(s[t],10)||0,i[t]+=parseInt(n[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e(\"<div style='overflow:hidden;'></div>\"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:\"absolute\",left:this.elementOffset.left+\"px\",top:this.elementOffset.top+\"px\",zIndex:++i.zIndex}),this.helper.appendTo(\"body\").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),\"resize\"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add(\"resizable\",\"animate\",{stop:function(t){var i=e(this).resizable(\"instance\"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&i._hasScroll(n[0],\"left\")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css(\"left\"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css(\"top\"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css(\"width\"),10),height:parseInt(i.element.css(\"height\"),10),top:parseInt(i.element.css(\"top\"),10),left:parseInt(i.element.css(\"left\"),10)};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate(\"resize\",t)}})}}),e.ui.plugin.add(\"resizable\",\"containment\",{start:function(){var t,i,s,n,a,o,r,h=e(this).resizable(\"instance\"),l=h.options,u=h.element,d=l.containment,c=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;c&&(h.containerElement=e(c),/document/.test(d)||d===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(c),i=[],e([\"Top\",\"Right\",\"Left\",\"Bottom\"]).each(function(e,s){i[e]=h._num(t.css(\"padding\"+s))}),h.containerOffset=t.offset(),h.containerPosition=t.position(),h.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,a=h.containerSize.width,o=h._hasScroll(c,\"left\")?c.scrollWidth:a,r=h._hasScroll(c)?c.scrollHeight:n,h.parentData={element:c,left:s.left,top:s.top,width:o,height:r}))},resize:function(t){var i,s,n,a,o=e(this).resizable(\"instance\"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,d={top:0,left:0},c=o.containerElement,p=!0;c[0]!==document&&/static/.test(c.css(\"position\"))&&(d=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-d.left),u&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?h.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css(\"position\")),n&&a?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-h.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-h.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var t=e(this).resizable(\"instance\"),i=t.options,s=t.containerOffset,n=t.containerPosition,a=t.containerElement,o=e(t.helper),r=o.offset(),h=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css(\"position\"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(a.css(\"position\"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),e.ui.plugin.add(\"resizable\",\"alsoResize\",{start:function(){var t=e(this).resizable(\"instance\"),i=t.options,s=function(t){e(t).each(function(){var t=e(this);t.data(\"ui-resizable-alsoresize\",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css(\"left\"),10),top:parseInt(t.css(\"top\"),10)})})};\"object\"!=typeof i.alsoResize||i.alsoResize.parentNode?s(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)})},resize:function(t,i){var s=e(this).resizable(\"instance\"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0},h=function(t,s){e(t).each(function(){var t=e(this),n=e(this).data(\"ui-resizable-alsoresize\"),a={},o=s&&s.length?s:t.parents(i.originalElement[0]).length?[\"width\",\"height\"]:[\"width\",\"height\",\"top\",\"left\"];e.each(o,function(e,t){var i=(n[t]||0)+(r[t]||0);i&&i>=0&&(a[t]=i||null)}),t.css(a)})};\"object\"!=typeof n.alsoResize||n.alsoResize.nodeType?h(n.alsoResize):e.each(n.alsoResize,function(e,t){h(e,t)})},stop:function(){e(this).removeData(\"resizable-alsoresize\")}}),e.ui.plugin.add(\"resizable\",\"ghost\",{start:function(){var t=e(this).resizable(\"instance\"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:\"block\",position:\"relative\",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass(\"ui-resizable-ghost\").addClass(\"string\"==typeof i.ghost?i.ghost:\"\"),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable(\"instance\");t.ghost&&t.ghost.css({position:\"relative\",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable(\"instance\");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add(\"resizable\",\"grid\",{resize:function(){var t,i=e(this).resizable(\"instance\"),s=i.options,n=i.size,a=i.originalSize,o=i.originalPosition,r=i.axis,h=\"number\"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,u=h[1]||1,d=Math.round((n.width-a.width)/l)*l,c=Math.round((n.height-a.height)/u)*u,p=a.width+d,f=a.height+c,m=s.maxWidth&&p>s.maxWidth,g=s.maxHeight&&f>s.maxHeight,v=s.minWidth&&s.minWidth>p,y=s.minHeight&&s.minHeight>f;s.grid=h,v&&(p+=l),y&&(f+=u),m&&(p-=l),g&&(f-=u),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-c):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-d):((0>=f-u||0>=p-l)&&(t=i._getPaddingPlusBorderDimensions(this)),f-u>0?(i.size.height=f,i.position.top=o.top-c):(f=u-t.height,i.size.height=f,i.position.top=o.top+a.height-f),p-l>0?(i.size.width=p,i.position.left=o.left-d):(p=u-t.height,i.size.width=p,i.position.left=o.left+a.width-p))}}),e.ui.resizable,e.widget(\"ui.dialog\",{version:\"1.11.1\",options:{appendTo:\"body\",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:\"Close\",dialogClass:\"\",draggable:!0,hide:null,height:\"auto\",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:\"center\",at:\"center\",of:window,collision:\"fit\",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css(\"top\",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr(\"title\"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr(\"title\").addClass(\"ui-dialog-content ui-widget-content\").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||\"body\").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass(\"ui-dialog-content ui-widget-content\").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr(\"title\",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,s=this;if(this._isOpen&&this._trigger(\"beforeClose\",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(\":focusable\").focus().length)try{i=this.document[0].activeElement,i&&\"body\"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger(\"close\",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var s=!1,n=this.uiDialog.siblings(\".ui-front:visible\").map(function(){return+e(this).css(\"z-index\")}).get(),a=Math.max.apply(null,n);return a>=+this.uiDialog.css(\"z-index\")&&(this.uiDialog.css(\"z-index\",a+1),s=!0),s&&!i&&this._trigger(\"focus\",t),s},open:function(){var t=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css(\"z-index\",this.uiDialog.css(\"z-index\")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger(\"focus\")}),this._makeFocusTarget(),this._trigger(\"open\"),void 0)},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find(\"[autofocus]\")),e.length||(e=this.element.find(\":tabbable\")),e.length||(e=this.uiDialogButtonPane.find(\":tabbable\")),e.length||(e=this.uiDialogTitlebarClose.filter(\":tabbable\")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e(\"<div>\").addClass(\"ui-dialog ui-widget ui-widget-content ui-corner-all ui-front \"+this.options.dialogClass).hide().attr({tabIndex:-1,role:\"dialog\"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;\r\nif(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(\":tabbable\"),s=i.filter(\":first\"),n=i.filter(\":last\");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==s[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.focus()}),t.preventDefault()):(this._delay(function(){s.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find(\"[aria-describedby]\").length||this.uiDialog.attr({\"aria-describedby\":this.element.uniqueId().attr(\"id\")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e(\"<div>\").addClass(\"ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix\").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(\".ui-dialog-titlebar-close\")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e(\"<button type='button'></button>\").button({label:this.options.closeText,icons:{primary:\"ui-icon-closethick\"},text:!1}).addClass(\"ui-dialog-titlebar-close\").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e(\"<span>\").uniqueId().addClass(\"ui-dialog-title\").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({\"aria-labelledby\":t.attr(\"id\")})},_title:function(e){this.options.title||e.html(\"&#160;\"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e(\"<div>\").addClass(\"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix\"),this.uiButtonSet=e(\"<div>\").addClass(\"ui-dialog-buttonset\").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?(this.uiDialog.removeClass(\"ui-dialog-buttons\"),void 0):(e.each(i,function(i,s){var n,a;s=e.isFunction(s)?{click:s,text:i}:s,s=e.extend({type:\"button\"},s),n=s.click,s.click=function(){n.apply(t.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,e(\"<button></button>\",s).button(a).appendTo(t.uiButtonSet)}),this.uiDialog.addClass(\"ui-dialog-buttons\"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:\".ui-dialog-content, .ui-dialog-titlebar-close\",handle:\".ui-dialog-titlebar\",containment:\"document\",start:function(s,n){e(this).addClass(\"ui-dialog-dragging\"),i._blockFrames(),i._trigger(\"dragStart\",s,t(n))},drag:function(e,s){i._trigger(\"drag\",e,t(s))},stop:function(n,a){var o=a.offset.left-i.document.scrollLeft(),r=a.offset.top-i.document.scrollTop();s.position={my:\"left top\",at:\"left\"+(o>=0?\"+\":\"\")+o+\" \"+\"top\"+(r>=0?\"+\":\"\")+r,of:i.window},e(this).removeClass(\"ui-dialog-dragging\"),i._unblockFrames(),i._trigger(\"dragStop\",n,t(a))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css(\"position\"),o=\"string\"==typeof n?n:\"n,e,s,w,se,sw,ne,nw\";this.uiDialog.resizable({cancel:\".ui-dialog-content\",containment:\"document\",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){e(this).addClass(\"ui-dialog-resizing\"),i._blockFrames(),i._trigger(\"resizeStart\",s,t(n))},resize:function(e,s){i._trigger(\"resize\",e,t(s))},stop:function(n,a){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),h=o.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:\"left top\",at:\"left\"+(r>=0?\"+\":\"\")+r+\" \"+\"top\"+(h>=0?\"+\":\"\")+h,of:i.window},e(this).removeClass(\"ui-dialog-resizing\"),i._unblockFrames(),i._trigger(\"resizeStop\",n,t(a))}}).css(\"position\",a)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data(\"ui-dialog-instances\");return e||(e=[],this.document.data(\"ui-dialog-instances\",e)),e},_minHeight:function(){var e=this.options;return\"auto\"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(\":visible\");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,n={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(s=!0),e in i.resizableRelatedOptions&&(n[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(\":data(ui-resizable)\")&&this.uiDialog.resizable(\"option\",n)},_setOption:function(e,t){var i,s,n=this.uiDialog;\"dialogClass\"===e&&n.removeClass(this.options.dialogClass).addClass(t),\"disabled\"!==e&&(this._super(e,t),\"appendTo\"===e&&this.uiDialog.appendTo(this._appendTo()),\"buttons\"===e&&this._createButtons(),\"closeText\"===e&&this.uiDialogTitlebarClose.button({label:\"\"+t}),\"draggable\"===e&&(i=n.is(\":data(ui-draggable)\"),i&&!t&&n.draggable(\"destroy\"),!i&&t&&this._makeDraggable()),\"position\"===e&&this._position(),\"resizable\"===e&&(s=n.is(\":data(ui-resizable)\"),s&&!t&&n.resizable(\"destroy\"),s&&\"string\"==typeof t&&n.resizable(\"option\",\"handles\",t),s||t===!1||this._makeResizable()),\"title\"===e&&this._title(this.uiDialogTitlebar.find(\".ui-dialog-title\")))},_size:function(){var e,t,i,s=this.options;this.element.show().css({width:\"auto\",minHeight:0,maxHeight:\"none\",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),e=this.uiDialog.css({height:\"auto\",width:s.width}).outerHeight(),t=Math.max(0,s.minHeight-e),i=\"number\"==typeof s.maxHeight?Math.max(0,s.maxHeight-e):\"none\",\"auto\"===s.height?this.element.css({minHeight:t,maxHeight:i,height:\"auto\"}):this.element.height(Math.max(0,s.height-e)),this.uiDialog.is(\":data(ui-resizable)\")&&this.uiDialog.resizable(\"option\",\"minHeight\",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find(\"iframe\").map(function(){var t=e(this);return e(\"<div>\").css({position:\"absolute\",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(\".ui-dialog\").length?!0:!!e(t.target).closest(\".ui-datepicker\").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data(\"ui-dialog-overlays\")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e(\"<div>\").addClass(\"ui-widget-overlay ui-front\").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:\"_keepFocus\"}),this.document.data(\"ui-dialog-overlays\",(this.document.data(\"ui-dialog-overlays\")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data(\"ui-dialog-overlays\")-1;e?this.document.data(\"ui-dialog-overlays\",e):this.document.unbind(\"focusin\").removeData(\"ui-dialog-overlays\"),this.overlay.remove(),this.overlay=null}}}),e.widget(\"ui.droppable\",{version:\"1.11.1\",widgetEventPrefix:\"drop\",options:{accept:\"*\",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:\"default\",tolerance:\"intersect\",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass(\"ui-droppable\")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass(\"ui-droppable ui-droppable-disabled\")},_setOption:function(t,i){if(\"accept\"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if(\"scope\"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger(\"activate\",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger(\"deactivate\",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger(\"over\",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger(\"out\",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(\":data(ui-droppable)\").not(\".ui-draggable-dragging\").each(function(){var i=e(this).droppable(\"instance\");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger(\"drop\",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,s,n){if(!i.offset)return!1;var a=(t.positionAbs||t.position.absolute).left,o=(t.positionAbs||t.position.absolute).top,r=a+t.helperProportions.width,h=o+t.helperProportions.height,l=i.offset.left,u=i.offset.top,d=l+i.proportions().width,c=u+i.proportions().height;switch(s){case\"fit\":return a>=l&&d>=r&&o>=u&&c>=h;case\"intersect\":return a+t.helperProportions.width/2>l&&d>r-t.helperProportions.width/2&&o+t.helperProportions.height/2>u&&c>h-t.helperProportions.height/2;case\"pointer\":return e(n.pageY,u,i.proportions().height)&&e(n.pageX,l,i.proportions().width);case\"touch\":return(o>=u&&c>=o||h>=u&&c>=h||u>o&&h>c)&&(a>=l&&d>=a||r>=l&&d>=r||l>a&&r>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{\"default\":[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(\":data(ui-droppable)\").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue e}a[s].visible=\"none\"!==a[s].element.css(\"display\"),a[s].visible&&(\"mousedown\"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil(\"body\").bind(\"scroll.droppable\",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance,i),r=!o&&this.isover?\"isout\":o&&!this.isover?\"isover\":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(\":data(ui-droppable)\").filter(function(){return e(this).droppable(\"instance\").options.scope===n}),a.length&&(s=e(a[0]).droppable(\"instance\"),s.greedyChild=\"isover\"===r)),s&&\"isover\"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this[\"isout\"===r?\"isover\":\"isout\"]=!1,this[\"isover\"===r?\"_over\":\"_out\"].call(this,i),s&&\"isout\"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil(\"body\").unbind(\"scroll.droppable\"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable;var y=\"ui-effects-\",b=e;e.effects={effect:{}},function(e,t){function i(e,t,i){var s=d[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(e,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||\"rgba\";return h?(o=s[l](h),s[u[l].cache]=o[u[l].cache],n=s._rgba=o._rgba,!1):t}),n.length?(\"0,0,0,0\"===n.join()&&e.extend(n,a.transparent),s):a[i]}function n(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var a,o=\"backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor\",r=/^([\\-+])=\\s*(\\d+\\.?\\d*)/,h=[{re:/rgba?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*(?:,\\s*(\\d?(?:\\.\\d+)?)\\s*)?\\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\\(\\s*(\\d+(?:\\.\\d+)?)\\%\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*(?:,\\s*(\\d?(?:\\.\\d+)?)\\s*)?\\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\\(\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*(?:,\\s*(\\d?(?:\\.\\d+)?)\\s*)?\\)/,space:\"hsla\",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,s,n){return new e.Color.fn.parse(t,i,s,n)},u={rgba:{props:{red:{idx:0,type:\"byte\"},green:{idx:1,type:\"byte\"},blue:{idx:2,type:\"byte\"}}},hsla:{props:{hue:{idx:0,type:\"degrees\"},saturation:{idx:1,type:\"percent\"},lightness:{idx:2,type:\"percent\"}}}},d={\"byte\":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=l.support={},p=e(\"<p>\")[0],f=e.each;p.style.cssText=\"background-color:rgba(1,1,1,.5)\",c.rgba=p.style.backgroundColor.indexOf(\"rgba\")>-1,f(u,function(e,t){t.cache=\"_\"+e,t.props.alpha={idx:3,type:\"percent\",def:1}}),l.fn=e.extend(l.prototype,{parse:function(n,o,r,h){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(o),o=t);var d=this,c=e.type(n),p=this._rgba=[];return o!==t&&(n=[n,o,r,h],c=\"array\"),\"string\"===c?this.parse(s(n)||a._default):\"array\"===c?(f(u.rgba.props,function(e,t){p[t.idx]=i(n[t.idx],t)}),this):\"object\"===c?(n instanceof l?f(u,function(e,t){n[t.cache]&&(d[t.cache]=n[t.cache].slice())}):f(u,function(t,s){var a=s.cache;f(s.props,function(e,t){if(!d[a]&&s.to){if(\"alpha\"===e||null==n[e])return;d[a]=s.to(d._rgba)}d[a][t.idx]=i(n[e],t,!0)}),d[a]&&0>e.inArray(null,d[a].slice(0,3))&&(d[a][3]=1,s.from&&(d._rgba=s.from(d[a])))}),this):t},is:function(e){var i=l(e),s=!0,n=this;return f(u,function(e,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(e,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:t})),s}),s},_space:function(){var e=[],t=this;return f(u,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var s=l(e),n=s._space(),a=u[n],o=0===this.alpha()?l(\"transparent\"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(e,n){var a=n.idx,o=r[a],l=s[a],u=d[n.type]||{};null!==l&&(null===o?h[a]=l:(u.mod&&(l-o>u.mod/2?o+=u.mod:o-l>u.mod/2&&(o-=u.mod)),h[a]=i((l-o)*t+o,n)))}),this[n](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(t)._rgba;return l(e.map(i,function(e,t){return(1-s)*n[t]+s*e}))},toRgbaString:function(){var t=\"rgba(\",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t=\"rgb(\"),t+i.join()+\")\"},toHslaString:function(){var t=\"hsla(\",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+\"%\"),e});return 1===i[3]&&(i.pop(),t=\"hsl(\"),t+i.join()+\")\"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),\"#\"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?\"0\"+e:e}).join(\"\")},toString:function(){return 0===this._rgba[3]?\"transparent\":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,n=e[1]/255,a=e[2]/255,o=e[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,u=r+h,d=.5*u;return t=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=d?l/u:l/(2-u),[Math.round(t)%360,i,d,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],a=e[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,t+1/3)),Math.round(255*n(r,o,t)),Math.round(255*n(r,o,t-1/3)),a]},f(u,function(s,n){var a=n.props,o=n.cache,h=n.to,u=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===t)return this[o].slice();var n,r=e.type(s),d=\"array\"===r||\"object\"===r?s:arguments,c=this[o].slice();return f(a,function(e,t){var s=d[\"object\"===r?e:t.idx];null==s&&(s=c[t.idx]),c[t.idx]=i(s,t)}),u?(n=l(u(c)),n[o]=c,n):l(c)},f(a,function(t,i){l.fn[t]||(l.fn[t]=function(n){var a,o=e.type(n),h=\"alpha\"===t?this._hsla?\"hsla\":\"rgba\":s,l=this[h](),u=l[i.idx];return\"undefined\"===o?u:(\"function\"===o&&(n=n.call(this,u),o=e.type(n)),null==n&&i.empty?this:(\"string\"===o&&(a=r.exec(n),a&&(n=u+parseFloat(a[2])*(\"+\"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(t){var i=t.split(\" \");f(i,function(t,i){e.cssHooks[i]={set:function(t,n){var a,o,r=\"\";if(\"transparent\"!==n&&(\"string\"!==e.type(n)||(a=s(n)))){if(n=l(a||n),!c.rgba&&1!==n._rgba[3]){for(o=\"backgroundColor\"===i?t.parentNode:t;(\"\"===r||\"transparent\"===r)&&o&&o.style;)try{r=e.css(o,\"backgroundColor\"),o=o.parentNode}catch(h){}n=n.blend(r&&\"transparent\"!==r?r:\"_default\")}n=n.toRgbaString()}try{t.style[i]=n}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return f([\"Top\",\"Right\",\"Bottom\",\"Left\"],function(i,s){t[\"border\"+s+\"Color\"]=e}),t}},a=e.Color.names={aqua:\"#00ffff\",black:\"#000000\",blue:\"#0000ff\",fuchsia:\"#ff00ff\",gray:\"#808080\",green:\"#008000\",lime:\"#00ff00\",maroon:\"#800000\",navy:\"#000080\",olive:\"#808000\",purple:\"#800080\",red:\"#ff0000\",silver:\"#c0c0c0\",teal:\"#008080\",white:\"#ffffff\",yellow:\"#ffff00\",transparent:[null,null,null,0],_default:\"#ffffff\"}}(b),function(){function t(t){var i,s,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],\"string\"==typeof n[i]&&(a[e.camelCase(i)]=n[i]);else for(i in n)\"string\"==typeof n[i]&&(a[i]=n[i]);return a}function i(t,i){var s,a,o={};for(s in i)a=i[s],t[s]!==a&&(n[s]||(e.fx.step[s]||!isNaN(parseFloat(a)))&&(o[s]=a));return o}var s=[\"add\",\"remove\",\"toggle\"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each([\"borderLeftStyle\",\"borderRightStyle\",\"borderBottomStyle\",\"borderTopStyle\"],function(t,i){e.fx.step[i]=function(e){(\"none\"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(b.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(n,a,o,r){var h=e.speed(a,o,r);return this.queue(function(){var a,o=e(this),r=o.attr(\"class\")||\"\",l=h.children?o.find(\"*\").addBack():o;l=l.map(function(){var i=e(this);return{el:i,start:t(this)}}),a=function(){e.each(s,function(e,t){n[t]&&o[t+\"Class\"](n[t])})},a(),l=l.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr(\"class\",r),l=l.map(function(){var t=this,i=e.Deferred(),s=e.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,\"\")})}),h.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(i,s,n,a){return s?e.effects.animateClass.call(this,{add:i},s,n,a):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,s,n,a){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},s,n,a):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,s,n,a,o){return\"boolean\"==typeof s||void 0===s?n?e.effects.animateClass.call(this,s?{add:i}:{remove:i},n,a,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},s,n,a)}}(e.fn.toggleClass),switchClass:function(t,i,s,n,a){return e.effects.animateClass.call(this,{add:i,remove:t},s,n,a)}})}(),function(){function t(t,i,s,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,s=null,i={}),(\"number\"==typeof i||e.fx.speeds[i])&&(n=s,s=i,i={}),e.isFunction(s)&&(n=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:\"number\"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=n||i.complete,t}function i(t){return!t||\"number\"==typeof t||e.fx.speeds[t]?!0:\"string\"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:\"object\"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:\"1.11.1\",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(y+t[i],e[0].style[t[i]])},restore:function(e,t){var i,s;for(s=0;t.length>s;s++)null!==t[s]&&(i=e.data(y+t[s]),void 0===i&&(i=\"\"),e.css(t[s],i))},setMode:function(e,t){return\"toggle\"===t&&(t=e.is(\":hidden\")?\"show\":\"hide\"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case\"top\":i=0;break;case\"middle\":i=.5;break;case\"bottom\":i=1;break;default:i=e[0]/t.height}switch(e[1]){case\"left\":s=0;break;case\"center\":s=.5;break;case\"right\":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(\".ui-effects-wrapper\"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),\"float\":t.css(\"float\")},s=e(\"<div></div>\").addClass(\"ui-effects-wrapper\").css({fontSize:\"100%\",background:\"transparent\",border:\"none\",margin:0,padding:0}),n={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return t.wrap(s),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),s=t.parent(),\"static\"===t.css(\"position\")?(s.css({position:\"relative\"}),t.css({position:\"relative\"})):(e.extend(i,{position:t.css(\"position\"),zIndex:t.css(\"z-index\")}),e.each([\"top\",\"left\",\"bottom\",\"right\"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]=\"auto\")}),t.css({position:\"relative\",top:0,left:0,right:\"auto\",bottom:\"auto\"})),t.css(n),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(\".ui-effects-wrapper\")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,n){return n=n||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(a)&&a.call(n[0]),e.isFunction(t)&&t()}var n=e(this),a=s.complete,r=s.mode;(n.is(\":hidden\")?\"hide\"===r:\"show\"===r)?(n[r](),i()):o.call(n[0],s,i)}var s=t.apply(this,arguments),n=s.mode,a=s.queue,o=e.effects.effect[s.effect];return e.fx.off||!o?n?this[n](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):a===!1?this.each(i):this.queue(a||\"fx\",i)},show:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode=\"show\",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode=\"hide\",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(s){if(i(s)||\"boolean\"==typeof s)return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode=\"toggle\",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),s=[];return e.each([\"em\",\"px\",\"%\",\"pt\"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each([\"Quad\",\"Cubic\",\"Quart\",\"Quint\",\"Expo\"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing[\"easeIn\"+t]=i,e.easing[\"easeOut\"+t]=function(e){return 1-i(1-e)},e.easing[\"easeInOut\"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}(),e.effects,e.effects.effect.blind=function(t,i){var s,n,a,o=e(this),r=/up|down|vertical/,h=/up|left|vertical|horizontal/,l=[\"position\",\"top\",\"bottom\",\"left\",\"right\",\"height\",\"width\"],u=e.effects.setMode(o,t.mode||\"hide\"),d=t.direction||\"up\",c=r.test(d),p=c?\"height\":\"width\",f=c?\"top\":\"left\",m=h.test(d),g={},v=\"show\"===u;o.parent().is(\".ui-effects-wrapper\")?e.effects.save(o.parent(),l):e.effects.save(o,l),o.show(),s=e.effects.createWrapper(o).css({overflow:\"hidden\"}),n=s[p](),a=parseFloat(s.css(f))||0,g[p]=v?n:0,m||(o.css(c?\"bottom\":\"right\",0).css(c?\"top\":\"left\",\"auto\").css({position:\"absolute\"}),g[f]=v?a:n+a),v&&(s.css(p,0),m||s.css(f,a+n)),s.animate(g,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){\"hide\"===u&&o.hide(),e.effects.restore(o,l),e.effects.removeWrapper(o),i()}})},e.effects.effect.bounce=function(t,i){var s,n,a,o=e(this),r=[\"position\",\"top\",\"bottom\",\"left\",\"right\",\"height\",\"width\"],h=e.effects.setMode(o,t.mode||\"effect\"),l=\"hide\"===h,u=\"show\"===h,d=t.direction||\"up\",c=t.distance,p=t.times||5,f=2*p+(u||l?1:0),m=t.duration/f,g=t.easing,v=\"up\"===d||\"down\"===d?\"top\":\"left\",y=\"up\"===d||\"left\"===d,b=o.queue(),_=b.length;for((u||l)&&r.push(\"opacity\"),e.effects.save(o,r),o.show(),e.effects.createWrapper(o),c||(c=o[\"top\"===v?\"outerHeight\":\"outerWidth\"]()/3),u&&(a={opacity:1},a[v]=0,o.css(\"opacity\",0).css(v,y?2*-c:2*c).animate(a,m,g)),l&&(c/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(y?\"-=\":\"+=\")+c,o.animate(n,m,g).animate(a,m,g),c=l?2*c:c/2;l&&(n={opacity:0},n[v]=(y?\"-=\":\"+=\")+c,o.animate(n,m,g)),o.queue(function(){l&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}),_>1&&b.splice.apply(b,[1,0].concat(b.splice(_,f+1))),o.dequeue()},e.effects.effect.clip=function(t,i){var s,n,a,o=e(this),r=[\"position\",\"top\",\"bottom\",\"left\",\"right\",\"height\",\"width\"],h=e.effects.setMode(o,t.mode||\"hide\"),l=\"show\"===h,u=t.direction||\"vertical\",d=\"vertical\"===u,c=d?\"height\":\"width\",p=d?\"top\":\"left\",f={};e.effects.save(o,r),o.show(),s=e.effects.createWrapper(o).css({overflow:\"hidden\"}),n=\"IMG\"===o[0].tagName?s:o,a=n[c](),l&&(n.css(c,0),n.css(p,a/2)),f[c]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){l||o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}})},e.effects.effect.drop=function(t,i){var s,n=e(this),a=[\"position\",\"top\",\"bottom\",\"left\",\"right\",\"opacity\",\"height\",\"width\"],o=e.effects.setMode(n,t.mode||\"hide\"),r=\"show\"===o,h=t.direction||\"left\",l=\"up\"===h||\"down\"===h?\"top\":\"left\",u=\"up\"===h||\"left\"===h?\"pos\":\"neg\",d={opacity:r?1:0};e.effects.save(n,a),n.show(),e.effects.createWrapper(n),s=t.distance||n[\"top\"===l?\"outerHeight\":\"outerWidth\"](!0)/2,r&&n.css(\"opacity\",0).css(l,\"pos\"===u?-s:s),d[l]=(r?\"pos\"===u?\"+=\":\"-=\":\"pos\"===u?\"-=\":\"+=\")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){\"hide\"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===d*c&&n()}function n(){p.css({visibility:\"visible\"}),e(b).remove(),m||p.hide(),i()}var a,o,r,h,l,u,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,p=e(this),f=e.effects.setMode(p,t.mode||\"hide\"),m=\"show\"===f,g=p.show().css(\"visibility\",\"hidden\").offset(),v=Math.ceil(p.outerWidth()/c),y=Math.ceil(p.outerHeight()/d),b=[];for(a=0;d>a;a++)for(h=g.top+a*y,u=a-(d-1)/2,o=0;c>o;o++)r=g.left+o*v,l=o-(c-1)/2,p.clone().appendTo(\"body\").wrap(\"<div></div>\").css({position:\"absolute\",visibility:\"visible\",left:-o*v,top:-a*y}).parent().addClass(\"ui-effects-explode\").css({position:\"absolute\",overflow:\"hidden\",width:v,height:y,left:r+(m?l*v:0),top:h+(m?u*y:0),opacity:m?0:1}).animate({left:r+(m?0:l*v),top:h+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,s)},e.effects.effect.fade=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||\"toggle\");s.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})},e.effects.effect.fold=function(t,i){var s,n,a=e(this),o=[\"position\",\"top\",\"bottom\",\"left\",\"right\",\"height\",\"width\"],r=e.effects.setMode(a,t.mode||\"hide\"),h=\"show\"===r,l=\"hide\"===r,u=t.size||15,d=/([0-9]+)%/.exec(u),c=!!t.horizFirst,p=h!==c,f=p?[\"width\",\"height\"]:[\"height\",\"width\"],m=t.duration/2,g={},v={};e.effects.save(a,o),a.show(),s=e.effects.createWrapper(a).css({overflow:\"hidden\"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],d&&(u=parseInt(d[1],10)/100*n[l?0:1]),h&&s.css(c?{height:0,width:u}:{height:u,width:0}),g[f[0]]=h?n[0]:u,v[f[1]]=h?n[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){l&&a.hide(),e.effects.restore(a,o),e.effects.removeWrapper(a),i()})},e.effects.effect.highlight=function(t,i){var s=e(this),n=[\"backgroundImage\",\"backgroundColor\",\"opacity\"],a=e.effects.setMode(s,t.mode||\"show\"),o={backgroundColor:s.css(\"backgroundColor\")};\"hide\"===a&&(o.opacity=0),e.effects.save(s,n),s.show().css({backgroundImage:\"none\",backgroundColor:t.color||\"#ffff99\"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){\"hide\"===a&&s.hide(),e.effects.restore(s,n),i()}})},e.effects.effect.size=function(t,i){var s,n,a,o=e(this),r=[\"position\",\"top\",\"bottom\",\"left\",\"right\",\"width\",\"height\",\"overflow\",\"opacity\"],h=[\"position\",\"top\",\"bottom\",\"left\",\"right\",\"overflow\",\"opacity\"],l=[\"width\",\"height\",\"overflow\"],u=[\"fontSize\"],d=[\"borderTopWidth\",\"borderBottomWidth\",\"paddingTop\",\"paddingBottom\"],c=[\"borderLeftWidth\",\"borderRightWidth\",\"paddingLeft\",\"paddingRight\"],p=e.effects.setMode(o,t.mode||\"effect\"),f=t.restore||\"effect\"!==p,m=t.scale||\"both\",g=t.origin||[\"middle\",\"center\"],v=o.css(\"position\"),y=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};\"show\"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},\"toggle\"===t.mode&&\"show\"===p?(o.from=t.to||b,o.to=t.from||s):(o.from=t.from||(\"show\"===p?b:s),o.to=t.to||(\"hide\"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},(\"box\"===m||\"both\"===m)&&(a.from.y!==a.to.y&&(y=y.concat(d),o.from=e.effects.setTransition(o,d,a.from.y,o.from),o.to=e.effects.setTransition(o,d,a.to.y,o.to)),a.from.x!==a.to.x&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,a.from.x,o.from),o.to=e.effects.setTransition(o,c,a.to.x,o.to))),(\"content\"===m||\"both\"===m)&&a.from.y!==a.to.y&&(y=y.concat(u).concat(l),o.from=e.effects.setTransition(o,u,a.from.y,o.from),o.to=e.effects.setTransition(o,u,a.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css(\"overflow\",\"hidden\").css(o.from),g&&(n=e.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),(\"content\"===m||\"both\"===m)&&(d=d.concat([\"marginTop\",\"marginBottom\"]).concat(u),c=c.concat([\"marginLeft\",\"marginRight\"]),l=r.concat(d).concat(c),o.find(\"*[width]\").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};\r\nf&&e.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,d,a.from.y,i.from),i.to=e.effects.setTransition(i,d,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,c,a.from.x,i.from),i.to=e.effects.setTransition(i,c,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css(\"opacity\",o.from.opacity),\"hide\"===p&&o.hide(),e.effects.restore(o,y),f||(\"static\"===v?o.css({position:\"relative\",top:o.to.top,left:o.to.left}):e.each([\"top\",\"left\"],function(e,t){o.css(t,function(t,i){var s=parseInt(i,10),n=e?o.to.left:o.to.top;return\"auto\"===i?n+\"px\":s+n+\"px\"})})),e.effects.removeWrapper(o),i()}})},e.effects.effect.scale=function(t,i){var s=e(this),n=e.extend(!0,{},t),a=e.effects.setMode(s,t.mode||\"effect\"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:\"hide\"===a?0:100),r=t.direction||\"both\",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:\"horizontal\"!==r?o/100:1,x:\"vertical\"!==r?o/100:1};n.effect=\"size\",n.queue=!1,n.complete=i,\"effect\"!==a&&(n.origin=h||[\"middle\",\"center\"],n.restore=!0),n.from=t.from||(\"show\"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},n.fade&&(\"show\"===a&&(n.from.opacity=0,n.to.opacity=1),\"hide\"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},e.effects.effect.puff=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||\"hide\"),a=\"hide\"===n,o=parseInt(t.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:\"scale\",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(t)},e.effects.effect.pulsate=function(t,i){var s,n=e(this),a=e.effects.setMode(n,t.mode||\"show\"),o=\"show\"===a,r=\"hide\"===a,h=o||\"hide\"===a,l=2*(t.times||5)+(h?1:0),u=t.duration/l,d=0,c=n.queue(),p=c.length;for((o||!n.is(\":visible\"))&&(n.css(\"opacity\",0).show(),d=1),s=1;l>s;s++)n.animate({opacity:d},u,t.easing),d=1-d;n.animate({opacity:d},u,t.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&c.splice.apply(c,[1,0].concat(c.splice(p,l+1))),n.dequeue()},e.effects.effect.shake=function(t,i){var s,n=e(this),a=[\"position\",\"top\",\"bottom\",\"left\",\"right\",\"height\",\"width\"],o=e.effects.setMode(n,t.mode||\"effect\"),r=t.direction||\"left\",h=t.distance||20,l=t.times||3,u=2*l+1,d=Math.round(t.duration/u),c=\"up\"===r||\"down\"===r?\"top\":\"left\",p=\"up\"===r||\"left\"===r,f={},m={},g={},v=n.queue(),y=v.length;for(e.effects.save(n,a),n.show(),e.effects.createWrapper(n),f[c]=(p?\"-=\":\"+=\")+h,m[c]=(p?\"+=\":\"-=\")+2*h,g[c]=(p?\"-=\":\"+=\")+2*h,n.animate(f,d,t.easing),s=1;l>s;s++)n.animate(m,d,t.easing).animate(g,d,t.easing);n.animate(m,d,t.easing).animate(f,d/2,t.easing).queue(function(){\"hide\"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),n.dequeue()},e.effects.effect.slide=function(t,i){var s,n=e(this),a=[\"position\",\"top\",\"bottom\",\"left\",\"right\",\"width\",\"height\"],o=e.effects.setMode(n,t.mode||\"show\"),r=\"show\"===o,h=t.direction||\"left\",l=\"up\"===h||\"down\"===h?\"top\":\"left\",u=\"up\"===h||\"left\"===h,d={};e.effects.save(n,a),n.show(),s=t.distance||n[\"top\"===l?\"outerHeight\":\"outerWidth\"](!0),e.effects.createWrapper(n).css({overflow:\"hidden\"}),r&&n.css(l,u?isNaN(s)?\"-\"+s:-s:s),d[l]=(r?u?\"+=\":\"-=\":u?\"-=\":\"+=\")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){\"hide\"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.transfer=function(t,i){var s=e(this),n=e(t.to),a=\"fixed\"===n.css(\"position\"),o=e(\"body\"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),u={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},d=s.offset(),c=e(\"<div class='ui-effects-transfer'></div>\").appendTo(document.body).addClass(t.className).css({top:d.top-r,left:d.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?\"fixed\":\"absolute\"}).animate(u,t.duration,t.easing,function(){c.remove(),i()})},e.widget(\"ui.progressbar\",{version:\"1.11.1\",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass(\"ui-progressbar ui-widget ui-widget-content ui-corner-all\").attr({role:\"progressbar\",\"aria-valuemin\":this.min}),this.valueDiv=e(\"<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>\").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass(\"ui-progressbar ui-widget ui-widget-content ui-corner-all\").removeAttr(\"role\").removeAttr(\"aria-valuemin\").removeAttr(\"aria-valuemax\").removeAttr(\"aria-valuenow\"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,\"number\"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){\"max\"===e&&(t=Math.max(this.min,t)),\"disabled\"===e&&this.element.toggleClass(\"ui-state-disabled\",!!t).attr(\"aria-disabled\",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass(\"ui-corner-right\",t===this.options.max).width(i.toFixed(0)+\"%\"),this.element.toggleClass(\"ui-progressbar-indeterminate\",this.indeterminate),this.indeterminate?(this.element.removeAttr(\"aria-valuenow\"),this.overlayDiv||(this.overlayDiv=e(\"<div class='ui-progressbar-overlay'></div>\").appendTo(this.valueDiv))):(this.element.attr({\"aria-valuemax\":this.options.max,\"aria-valuenow\":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger(\"change\")),t===this.options.max&&this._trigger(\"complete\")}}),e.widget(\"ui.selectable\",e.ui.mouse,{version:\"1.11.1\",options:{appendTo:\"body\",autoRefresh:!0,distance:0,filter:\"*\",tolerance:\"touch\",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass(\"ui-selectable\"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass(\"ui-selectee\"),t.each(function(){var t=e(this),i=t.offset();e.data(this,\"selectable-item\",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass(\"ui-selected\"),selecting:t.hasClass(\"ui-selecting\"),unselecting:t.hasClass(\"ui-unselecting\")})})},this.refresh(),this.selectees=t.addClass(\"ui-selectee\"),this._mouseInit(),this.helper=e(\"<div class='ui-selectable-helper'></div>\")},_destroy:function(){this.selectees.removeClass(\"ui-selectee\").removeData(\"selectable-item\"),this.element.removeClass(\"ui-selectable ui-selectable-disabled\"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger(\"start\",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(\".ui-selected\").each(function(){var s=e.data(this,\"selectable-item\");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass(\"ui-selected\"),s.selected=!1,s.$element.addClass(\"ui-unselecting\"),s.unselecting=!0,i._trigger(\"unselecting\",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,n=e.data(this,\"selectable-item\");return n?(s=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass(\"ui-selected\"),n.$element.removeClass(s?\"ui-unselecting\":\"ui-selected\").addClass(s?\"ui-selecting\":\"ui-unselecting\"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger(\"selecting\",t,{selecting:n.element}):i._trigger(\"unselecting\",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=t.pageX,h=t.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=e.data(this,\"selectable-item\"),l=!1;i&&i.element!==s.element[0]&&(\"touch\"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):\"fit\"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass(\"ui-selected\"),i.selected=!1),i.unselecting&&(i.$element.removeClass(\"ui-unselecting\"),i.unselecting=!1),i.selecting||(i.$element.addClass(\"ui-selecting\"),i.selecting=!0,s._trigger(\"selecting\",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass(\"ui-selecting\"),i.selecting=!1,i.$element.addClass(\"ui-selected\"),i.selected=!0):(i.$element.removeClass(\"ui-selecting\"),i.selecting=!1,i.startselected&&(i.$element.addClass(\"ui-unselecting\"),i.unselecting=!0),s._trigger(\"unselecting\",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass(\"ui-selected\"),i.selected=!1,i.$element.addClass(\"ui-unselecting\"),i.unselecting=!0,s._trigger(\"unselecting\",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(\".ui-unselecting\",this.element[0]).each(function(){var s=e.data(this,\"selectable-item\");s.$element.removeClass(\"ui-unselecting\"),s.unselecting=!1,s.startselected=!1,i._trigger(\"unselected\",t,{unselected:s.element})}),e(\".ui-selecting\",this.element[0]).each(function(){var s=e.data(this,\"selectable-item\");s.$element.removeClass(\"ui-selecting\").addClass(\"ui-selected\"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger(\"selected\",t,{selected:s.element})}),this._trigger(\"stop\",t),this.helper.remove(),!1}}),e.widget(\"ui.selectmenu\",{version:\"1.11.1\",defaultElement:\"<select>\",options:{appendTo:null,disabled:null,icons:{button:\"ui-icon-triangle-1-s\"},position:{my:\"left top\",at:\"left bottom\",collision:\"none\"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr(\"id\");this.ids={element:e,button:e+\"-button\",menu:e+\"-menu\"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this,i=this.element.attr(\"tabindex\");this.label=e(\"label[for='\"+this.ids.element+\"']\").attr(\"for\",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e(\"<span>\",{\"class\":\"ui-selectmenu-button ui-widget ui-state-default ui-corner-all\",tabindex:i||this.options.disabled?-1:0,id:this.ids.button,role:\"combobox\",\"aria-expanded\":\"false\",\"aria-autocomplete\":\"list\",\"aria-owns\":this.ids.menu,\"aria-haspopup\":\"true\"}).insertAfter(this.element),e(\"<span>\",{\"class\":\"ui-icon \"+this.options.icons.button}).prependTo(this.button),this.buttonText=e(\"<span>\",{\"class\":\"ui-selectmenu-text\"}).appendTo(this.button),this._setText(this.buttonText,this.element.find(\"option:selected\").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one(\"focusin\",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e(\"<ul>\",{\"aria-hidden\":\"true\",\"aria-labelledby\":this.ids.button,id:this.ids.menu}),this.menuWrap=e(\"<div>\",{\"class\":\"ui-selectmenu-menu ui-front\"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:\"listbox\",select:function(e,i){e.preventDefault(),t._select(i.item.data(\"ui-selectmenu-item\"),e)},focus:function(e,i){var s=i.item.data(\"ui-selectmenu-item\");null!=t.focusIndex&&s.index!==t.focusIndex&&(t._trigger(\"focus\",e,{item:s}),t.isOpen||t._select(s,e)),t.focusIndex=s.index,t.button.attr(\"aria-activedescendant\",t.menuItems.eq(s.index).attr(\"id\"))}}).menu(\"instance\"),this.menu.addClass(\"ui-corner-bottom\").removeClass(\"ui-corner-all\"),this.menuInstance._off(this.menu,\"mouseleave\"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find(\"option\");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find(\"li\").not(\".ui-selectmenu-optgroup\"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data(\"ui-selectmenu-item\")),this._setOption(\"disabled\",this.element.prop(\"disabled\")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(\".ui-state-focus\").removeClass(\"ui-state-focus\"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger(\"open\",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this._off(this.document),this._trigger(\"close\",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,i){var s=this,n=\"\";e.each(i,function(i,a){a.optgroup!==n&&(e(\"<li>\",{\"class\":\"ui-selectmenu-optgroup ui-menu-divider\"+(a.element.parent(\"optgroup\").prop(\"disabled\")?\" ui-state-disabled\":\"\"),text:a.optgroup}).appendTo(t),n=a.optgroup),s._renderItemData(t,a)})},_renderItemData:function(e,t){return this._renderItem(e,t).data(\"ui-selectmenu-item\",t)},_renderItem:function(t,i){var s=e(\"<li>\");return i.disabled&&s.addClass(\"ui-state-disabled\"),this._setText(s,i.label),s.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html(\"&#160;\")},_move:function(e,t){var i,s,n=\".ui-menu-item\";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),n+=\":not(.ui-state-disabled)\"),s=\"first\"===e||\"last\"===e?i[\"first\"===e?\"prevAll\":\"nextAll\"](n).eq(-1):i[e+\"All\"](n).eq(0),s.length&&this.menuInstance.focus(t,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?\"close\":\"open\"](e)},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(\".ui-selectmenu-menu, #\"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(e){e.preventDefault()},click:\"_toggle\",keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move(\"prev\",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move(\"next\",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move(\"prev\",t);break;case e.ui.keyCode.RIGHT:this._move(\"next\",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move(\"first\",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move(\"last\",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass(\"ui-state-disabled\")||this._select(t.data(\"ui-selectmenu-item\"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger(\"select\",t,{item:e}),e.index!==i&&this._trigger(\"change\",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr(\"id\");this.button.attr({\"aria-labelledby\":t,\"aria-activedescendant\":t}),this.menu.attr(\"aria-activedescendant\",t)},_setOption:function(e,t){\"icons\"===e&&this.button.find(\"span.ui-icon\").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),\"appendTo\"===e&&this.menuWrap.appendTo(this._appendTo()),\"disabled\"===e&&(this.menuInstance.option(\"disabled\",t),this.button.toggleClass(\"ui-state-disabled\",t).attr(\"aria-disabled\",t),this.element.prop(\"disabled\",t),t?(this.button.attr(\"tabindex\",-1),this.close()):this.button.attr(\"tabindex\",0)),\"width\"===e&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(\".ui-front\")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass(\"ui-corner-top\",this.isOpen).toggleClass(\"ui-corner-all\",!this.isOpen).attr(\"aria-expanded\",this.isOpen),this.menuWrap.toggleClass(\"ui-selectmenu-open\",this.isOpen),this.menu.attr(\"aria-hidden\",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width(\"\").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop(\"disabled\")}},_parseOptions:function(t){var i=[];t.each(function(t,s){var n=e(s),a=n.parent(\"optgroup\");i.push({element:n,index:t,value:n.attr(\"value\"),label:n.text(),optgroup:a.attr(\"label\")||\"\",disabled:a.prop(\"disabled\")||n.prop(\"disabled\")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr(\"for\",this.ids.element)}}),e.widget(\"ui.slider\",e.ui.mouse,{version:\"1.11.1\",widgetEventPrefix:\"slide\",options:{animate:!1,distance:0,max:100,min:0,orientation:\"horizontal\",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass(\"ui-slider ui-slider-\"+this.orientation+\" ui-widget\"+\" ui-widget-content\"+\" ui-corner-all\"),this._refresh(),this._setOption(\"disabled\",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,s=this.options,n=this.element.find(\".ui-slider-handle\").addClass(\"ui-state-default ui-corner-all\"),a=\"<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>\",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;i>t;t++)o.push(a);this.handles=n.add(e(o.join(\"\")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data(\"ui-slider-handle-index\",t)})},_createRange:function(){var t=this.options,i=\"\";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass(\"ui-slider-range-min ui-slider-range-max\").css({left:\"\",bottom:\"\"}):(this.range=e(\"<div></div>\").appendTo(this.element),i=\"ui-slider-range ui-widget-header ui-corner-all\"),this.range.addClass(i+(\"min\"===t.range||\"max\"===t.range?\" ui-slider-range-\"+t.range:\"\"))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass(\"ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all\"),this._mouseDestroy()},_mouseCapture:function(t){var i,s,n,a,o,r,h,l,u=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(s-u.values(t));(n>i||n===i&&(t===u._lastChangedValue||u.values(t)===d.min))&&(n=i,a=e(this),o=t)}),r=this._start(t,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass(\"ui-state-active\").focus(),h=a.offset(),l=!e(t.target).parents().addBack().is(\".ui-slider-handle\"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-h.left-a.width()/2,top:t.pageY-h.top-a.height()/2-(parseInt(a.css(\"borderTopWidth\"),10)||0)-(parseInt(a.css(\"borderBottomWidth\"),10)||0)+(parseInt(a.css(\"marginTop\"),10)||0)},this.handles.hasClass(\"ui-state-hover\")||this._slide(t,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass(\"ui-state-active\"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=\"vertical\"===this.options.orientation?\"vertical\":\"horizontal\"},_normValueFromMouse:function(e){var t,i,s,n,a;return\"horizontal\"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/t,s>1&&(s=1),0>s&&(s=0),\"vertical\"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger(\"start\",e,i)},_slide:function(e,t,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>s||1===t&&s>i)&&(i=s),i!==this.values(t)&&(n=this.values(),n[t]=i,a=this._trigger(\"slide\",e,{handle:this.handles[t],value:i,values:n}),s=this.values(t?0:1),a!==!1&&this.values(t,i))):i!==this.value()&&(a=this._trigger(\"slide\",e,{handle:this.handles[t],value:i}),a!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger(\"stop\",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger(\"change\",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var s,n,a;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(t,i){var s,n=0;switch(\"range\"===t&&this.options.range===!0&&(\"min\"===i?(this.options.value=this._values(0),this.options.values=null):\"max\"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),\"disabled\"===t&&this.element.toggleClass(\"ui-state-disabled\",!!i),this._super(t,i),t){case\"orientation\":this._detectOrientation(),this.element.removeClass(\"ui-slider-horizontal ui-slider-vertical\").addClass(\"ui-slider-\"+this.orientation),this._refreshValue(),this.handles.css(\"horizontal\"===i?\"bottom\":\"left\",\"\");break;case\"value\":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case\"values\":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case\"min\":case\"max\":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case\"range\":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,s;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,s=e-i;return 2*Math.abs(i)>=t&&(s+=i>0?t:-t),parseFloat(s.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u[\"horizontal\"===h.orientation?\"left\":\"bottom\"]=i+\"%\",e(this).stop(1,1)[l?\"animate\":\"css\"](u,r.animate),h.options.range===!0&&(\"horizontal\"===h.orientation?(0===s&&h.range.stop(1,1)[l?\"animate\":\"css\"]({left:i+\"%\"},r.animate),1===s&&h.range[l?\"animate\":\"css\"]({width:i-t+\"%\"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?\"animate\":\"css\"]({bottom:i+\"%\"},r.animate),1===s&&h.range[l?\"animate\":\"css\"]({height:i-t+\"%\"},{queue:!1,duration:r.animate}))),t=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u[\"horizontal\"===this.orientation?\"left\":\"bottom\"]=i+\"%\",this.handle.stop(1,1)[l?\"animate\":\"css\"](u,r.animate),\"min\"===o&&\"horizontal\"===this.orientation&&this.range.stop(1,1)[l?\"animate\":\"css\"]({width:i+\"%\"},r.animate),\"max\"===o&&\"horizontal\"===this.orientation&&this.range[l?\"animate\":\"css\"]({width:100-i+\"%\"},{queue:!1,duration:r.animate}),\"min\"===o&&\"vertical\"===this.orientation&&this.range.stop(1,1)[l?\"animate\":\"css\"]({height:i+\"%\"},r.animate),\"max\"===o&&\"vertical\"===this.orientation&&this.range[l?\"animate\":\"css\"]({height:100-i+\"%\"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(t){var i,s,n,a,o=e(t.target).data(\"ui-slider-handle-index\");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass(\"ui-state-active\"),i=this._start(t,o),i===!1))return}switch(a=this.options.step,s=n=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-a)}this._slide(t,o,n)},keyup:function(t){var i=e(t.target).data(\"ui-slider-handle-index\");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass(\"ui-state-active\"))}}}),e.widget(\"ui.sortable\",e.ui.mouse,{version:\"1.11.1\",widgetEventPrefix:\"sort\",ready:!1,options:{appendTo:\"parent\",axis:!1,connectWith:!1,containment:!1,cursor:\"auto\",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:\"original\",items:\"> *\",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:\"default\",tolerance:\"intersect\",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css(\"float\"))||/inline|table-cell/.test(e.css(\"display\"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass(\"ui-sortable\"),this.refresh(),this.floating=this.items.length?\"x\"===e.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),\"handle\"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(\".ui-sortable-handle\").removeClass(\"ui-sortable-handle\"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass(\"ui-sortable-handle\")})},_destroy:function(){this.element.removeClass(\"ui-sortable ui-sortable-disabled\").find(\".ui-sortable-handle\").removeClass(\"ui-sortable-handle\"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+\"-item\");return this},_mouseCapture:function(t,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||\"static\"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+\"-item\")===a?(s=e(this),!1):void 0}),e.data(t.target,a.widgetName+\"-item\")===a&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find(\"*\").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css(\"position\",\"absolute\"),this.cssPosition=this.helper.css(\"position\"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&\"auto\"!==o.cursor&&(a=this.document.find(\"body\"),this.storedCursor=a.css(\"cursor\"),a.css(\"cursor\",o.cursor),this.storedStylesheet=e(\"<style>*{ cursor: \"+o.cursor+\" !important; }</style>\").appendTo(a)),o.opacity&&(this.helper.css(\"opacity\")&&(this._storedOpacity=this.helper.css(\"opacity\")),this.helper.css(\"opacity\",o.opacity)),o.zIndex&&(this.helper.css(\"zIndex\")&&(this._storedZIndex=this.helper.css(\"zIndex\")),this.helper.css(\"zIndex\",o.zIndex)),this.scrollParent[0]!==document&&\"HTML\"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger(\"start\",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger(\"activate\",t,this._uiHash(this));\r\nreturn e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass(\"ui-sortable-helper\"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo(\"absolute\"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&\"HTML\"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo(\"absolute\"),this.options.axis&&\"y\"===this.options.axis||(this.helper[0].style.left=this.position.left+\"px\"),this.options.axis&&\"x\"===this.options.axis||(this.helper[0].style.top=this.position.top+\"px\"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?\"next\":\"prev\"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&(\"semi-dynamic\"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===a?\"down\":\"up\",\"pointer\"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger(\"change\",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger(\"sort\",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&\"x\"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),a&&\"y\"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),\"original\"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass(\"ui-sortable-helper\"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger(\"deactivate\",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger(\"out\",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),\"original\"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||\"id\")||\"\").match(t.expression||/(.+)[\\-=_](.+)/);i&&s.push((t.key||i[1]+\"[]\")+\"=\"+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+\"=\"),s.join(\"&\")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||\"id\")||\"\")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=e.left,o=a+e.width,r=e.top,h=r+e.height,l=this.offset.click.top,u=this.offset.click.left,d=\"x\"===this.options.axis||s+l>r&&h>s+l,c=\"y\"===this.options.axis||t+u>a&&o>t+u,p=d&&c;return\"pointer\"===this.options.tolerance||this.options.forcePointerForContainers||\"pointer\"!==this.options.tolerance&&this.helperProportions[this.floating?\"width\":\"height\"]>e[this.floating?\"width\":\"height\"]?p:t+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t=\"x\"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i=\"y\"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&\"right\"===a||\"down\"===n?2:1:n&&(\"down\"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?\"right\"===n&&i||\"left\"===n&&!i:s&&(\"down\"===s&&t||\"up\"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?\"down\":\"up\")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?\"right\":\"left\")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(a=e(l[s]),n=a.length-1;n>=0;n--)o=e.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(\".ui-sortable-helper\").not(\".ui-sortable-placeholder\"),o]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(\".ui-sortable-helper\").not(\".ui-sortable-placeholder\"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(\":data(\"+this.widgetName+\"-item)\");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=e(c[i]),s=n.length-1;s>=0;s--)a=e.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(o=d[i][1],r=d[i][0],s=0,l=r.length;l>s;s++)h=e(r[s]),h.data(this.widgetName+\"-item\",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e(\"<\"+s+\">\",t.document[0]).addClass(i||t.currentItem[0].className+\" ui-sortable-placeholder\").removeClass(\"ui-sortable-helper\");return\"tr\"===s?t.currentItem.children().each(function(){e(\"<td>&#160;</td>\",t.document[0]).attr(\"colspan\",e(this).attr(\"colspan\")||1).appendTo(n)}):\"img\"===s&&n.attr(\"src\",t.currentItem.attr(\"src\")),i||n.css(\"visibility\",\"hidden\"),n},update:function(e,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css(\"paddingTop\")||0,10)-parseInt(t.currentItem.css(\"paddingBottom\")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css(\"paddingLeft\")||0,10)-parseInt(t.currentItem.css(\"paddingRight\")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var i,s,n,a,o,r,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger(\"out\",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger(\"over\",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=c.floating||this._isFloating(this.currentItem),o=u?\"left\":\"top\",r=u?\"width\":\"height\",d=u?\"clientX\":\"clientY\",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,t[d]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(t[d]-h)&&(n=Math.abs(t[d]-h),a=this.items[s],this.direction=l?\"up\":\"down\"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger(\"change\",t,this._uiHash()),this.containers[p]._trigger(\"change\",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger(\"over\",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):\"clone\"===i.helper?this.currentItem.clone():this.currentItem;return s.parents(\"body\").length||e(\"parent\"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css(\"position\"),top:this.currentItem.css(\"top\"),left:this.currentItem.css(\"left\")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){\"string\"==typeof t&&(t=t.split(\" \")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),\"left\"in t&&(this.offset.click.left=t.left+this.margins.left),\"right\"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),\"top\"in t&&(this.offset.click.top=t.top+this.margins.top),\"bottom\"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return\"absolute\"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&\"html\"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css(\"borderTopWidth\"),10)||0),left:t.left+(parseInt(this.offsetParent.css(\"borderLeftWidth\"),10)||0)}},_getRelativeOffset:function(){if(\"relative\"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css(\"top\"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css(\"left\"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css(\"marginLeft\"),10)||0,top:parseInt(this.currentItem.css(\"marginTop\"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;\"parent\"===n.containment&&(n.containment=this.helper[0].parentNode),(\"document\"===n.containment||\"window\"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(\"document\"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e(\"document\"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s=\"hidden\"!==e(t).css(\"overflow\"),this.containment=[i.left+(parseInt(e(t).css(\"borderLeftWidth\"),10)||0)+(parseInt(e(t).css(\"paddingLeft\"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css(\"borderTopWidth\"),10)||0)+(parseInt(e(t).css(\"paddingTop\"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css(\"borderLeftWidth\"),10)||0)-(parseInt(e(t).css(\"paddingRight\"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css(\"borderTopWidth\"),10)||0)-(parseInt(e(t).css(\"paddingBottom\"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s=\"absolute\"===t?1:-1,n=\"absolute\"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-(\"fixed\"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-(\"fixed\"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,a=t.pageX,o=t.pageY,r=\"absolute\"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return\"relative\"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(\"fixed\"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(\"fixed\"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],\"down\"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)(\"auto\"===this._storedCSS[s]||\"static\"===this._storedCSS[s])&&(this._storedCSS[s]=\"\");this.currentItem.css(this._storedCSS).removeClass(\"ui-sortable-helper\")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger(\"receive\",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(\".ui-sortable-helper\")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger(\"update\",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger(\"remove\",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger(\"receive\",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger(\"update\",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i(\"deactivate\",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i(\"out\",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find(\"body\").css(\"cursor\",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css(\"opacity\",this._storedOpacity),this._storedZIndex&&this.helper.css(\"zIndex\",\"auto\"===this._storedZIndex?\"\":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger(\"beforeStop\",e,this._uiHash()),s=0;n.length>s;s++)n[s].call(this,e);this._trigger(\"stop\",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger(\"beforeStop\",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(s=0;n.length>s;s++)n[s].call(this,e);this._trigger(\"stop\",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.widget(\"ui.spinner\",{version:\"1.11.1\",defaultElement:\"<input>\",widgetEventPrefix:\"spin\",options:{culture:null,icons:{down:\"ui-icon-triangle-1-s\",up:\"ui-icon-triangle-1-n\"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption(\"max\",this.options.max),this._setOption(\"min\",this.options.min),this._setOption(\"step\",this.options.step),\"\"!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr(\"autocomplete\")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each([\"min\",\"max\",\"step\"],function(e,s){var n=i.attr(s);void 0!==n&&n.length&&(t[s]=n)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:\"_stop\",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger(\"change\",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},\"mousedown .ui-spinner-button\":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass(\"ui-spinner-up\")?1:-1,t)},\"mouseup .ui-spinner-button\":\"_stop\",\"mouseenter .ui-spinner-button\":function(t){return e(t.currentTarget).hasClass(\"ui-state-active\")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass(\"ui-spinner-up\")?1:-1,t),void 0):void 0},\"mouseleave .ui-spinner-button\":\"_stop\"},_draw:function(){var e=this.uiSpinner=this.element.addClass(\"ui-spinner-input\").attr(\"autocomplete\",\"off\").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr(\"role\",\"spinbutton\"),this.buttons=e.find(\".ui-spinner-button\").attr(\"tabIndex\",-1).button().removeClass(\"ui-corner-all\"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var i=this.options,s=e.ui.keyCode;switch(t.keyCode){case s.UP:return this._repeat(null,1,t),!0;case s.DOWN:return this._repeat(null,-1,t),!0;case s.PAGE_UP:return this._repeat(null,i.page,t),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return\"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>\"},_buttonHtml:function(){return\"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon \"+this.options.icons.up+\"'>&#9650;</span>\"+\"</a>\"+\"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>\"+\"<span class='ui-icon \"+this.options.icons.down+\"'>&#9660;</span>\"+\"</a>\"},_start:function(e){return this.spinning||this._trigger(\"start\",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger(\"spin\",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=\"\"+e,i=t.indexOf(\".\");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,s=this.options;return t=null!==s.min?s.min:0,i=e-t,i=Math.round(i/s.step)*s.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==s.max&&e>s.max?s.max:null!==s.min&&s.min>e?s.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger(\"stop\",e))},_setOption:function(e,t){if(\"culture\"===e||\"numberFormat\"===e){var i=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(i)),void 0}(\"max\"===e||\"min\"===e||\"step\"===e)&&\"string\"==typeof t&&(t=this._parse(t)),\"icons\"===e&&(this.buttons.first().find(\".ui-icon\").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(\".ui-icon\").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),\"disabled\"===e&&(this.widget().toggleClass(\"ui-state-disabled\",!!t),this.element.prop(\"disabled\",!!t),this.buttons.button(t?\"disable\":\"enable\"))},_setOptions:h(function(e){this._super(e)}),_parse:function(e){return\"string\"==typeof e&&\"\"!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),\"\"===e||isNaN(e)?null:e},_format:function(e){return\"\"===e?\"\":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({\"aria-valuemin\":this.options.min,\"aria-valuemax\":this.options.max,\"aria-valuenow\":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var i;\"\"!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass(\"ui-spinner-input\").prop(\"disabled\",!1).removeAttr(\"autocomplete\").removeAttr(\"role\").removeAttr(\"aria-valuemin\").removeAttr(\"aria-valuemax\").removeAttr(\"aria-valuenow\"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:h(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:h(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:h(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(h(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget(\"ui.tabs\",{version:\"1.11.1\",delay:300,options:{active:null,collapsible:!1,event:\"click\",heightStyle:\"content\",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var i,s;t=t.cloneNode(!1),i=t.href.replace(e,\"\"),s=location.href.replace(e,\"\");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return t.hash.length>1&&i===s}}(),_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass(\"ui-tabs ui-widget ui-widget-content ui-corner-all\").toggleClass(\"ui-tabs-collapsible\",i.collapsible),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(\".ui-state-disabled\"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===t&&(s&&this.tabs.each(function(i,n){return e(n).attr(\"aria-controls\")===s?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(\".ui-tabs-active\"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest(\"li\"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:s++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,s--;break;case e.ui.keyCode.END:s=this.anchors.length-1;break;case e.ui.keyCode.HOME:s=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),t.ctrlKey||(i.attr(\"aria-selected\",\"false\"),this.tabs.eq(s).attr(\"aria-selected\",\"true\"),this.activating=this._delay(function(){this.option(\"active\",s)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function s(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(s(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return\"active\"===e?(this._activate(t),void 0):\"disabled\"===e?(this._setupDisabled(t),void 0):(this._super(e,t),\"collapsible\"===e&&(this.element.toggleClass(\"ui-tabs-collapsible\",t),t||this.options.active!==!1||this._activate(0)),\"event\"===e&&this._setupEvents(t),\"heightStyle\"===e&&this._setupHeightStyle(t),void 0)},_sanitizeSelector:function(e){return e?e.replace(/[!\"$%&'()*+,.\\/:;<=>?@\\[\\]\\^`{|}~]/g,\"\\\\$&\"):\"\"},refresh:function(){var t=this.options,i=this.tablist.children(\":has(a[href])\");t.disabled=e.map(i.filter(\".ui-state-disabled\"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({\"aria-selected\":\"false\",\"aria-expanded\":\"false\",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({\"aria-hidden\":\"true\"}),this.active.length?(this.active.addClass(\"ui-tabs-active ui-state-active\").attr({\"aria-selected\":\"true\",\"aria-expanded\":\"true\",tabIndex:0}),this._getPanelForTab(this.active).show().attr({\"aria-hidden\":\"false\"})):this.tabs.eq(0).attr(\"tabIndex\",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass(\"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all\").attr(\"role\",\"tablist\").delegate(\"> li\",\"mousedown\"+this.eventNamespace,function(t){e(this).is(\".ui-state-disabled\")&&t.preventDefault()}).delegate(\".ui-tabs-anchor\",\"focus\"+this.eventNamespace,function(){e(this).closest(\"li\").is(\".ui-state-disabled\")&&this.blur()}),this.tabs=this.tablist.find(\"> li:has(a[href])\").addClass(\"ui-state-default ui-corner-top\").attr({role:\"tab\",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e(\"a\",this)[0]\r\n}).addClass(\"ui-tabs-anchor\").attr({role:\"presentation\",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,s){var n,a,o,r=e(s).uniqueId().attr(\"id\"),h=e(s).closest(\"li\"),l=h.attr(\"aria-controls\");t._isLocal(s)?(n=s.hash,o=n.substring(1),a=t.element.find(t._sanitizeSelector(n))):(o=h.attr(\"aria-controls\")||e({}).uniqueId()[0].id,n=\"#\"+o,a=t.element.find(n),a.length||(a=t._createPanel(o),a.insertAfter(t.panels[i-1]||t.tablist)),a.attr(\"aria-live\",\"polite\")),a.length&&(t.panels=t.panels.add(a)),l&&h.data(\"ui-tabs-aria-controls\",l),h.attr({\"aria-controls\":o,\"aria-labelledby\":r}),a.attr(\"aria-labelledby\",r)}),this.panels.addClass(\"ui-tabs-panel ui-widget-content ui-corner-bottom\").attr(\"role\",\"tabpanel\")},_getList:function(){return this.tablist||this.element.find(\"ol,ul\").eq(0)},_createPanel:function(t){return e(\"<div>\").attr(\"id\",t).addClass(\"ui-tabs-panel ui-widget-content ui-corner-bottom\").data(\"ui-tabs-destroy\",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,s=0;i=this.tabs[s];s++)t===!0||-1!==e.inArray(s,t)?e(i).addClass(\"ui-state-disabled\").attr(\"aria-disabled\",\"true\"):e(i).removeClass(\"ui-state-disabled\").removeAttr(\"aria-disabled\");this.options.disabled=t},_setupEvents:function(t){var i={};t&&e.each(t.split(\" \"),function(e,t){i[t]=\"_eventHandler\"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:\"_tabKeydown\"}),this._on(this.panels,{keydown:\"_panelKeydown\"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,s=this.element.parent();\"fill\"===t?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(\":visible\").each(function(){var t=e(this),s=t.css(\"position\");\"absolute\"!==s&&\"fixed\"!==s&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css(\"overflow\",\"auto\")):\"auto\"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height(\"\").height())}).height(i))},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n.closest(\"li\"),o=a[0]===s[0],r=o&&i.collapsible,h=r?e():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):e(),u={oldTab:s,oldPanel:l,newTab:r?e():a,newPanel:h};t.preventDefault(),a.hasClass(\"ui-state-disabled\")||a.hasClass(\"ui-tabs-loading\")||this.running||o&&!i.collapsible||this._trigger(\"beforeActivate\",t,u)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?e():a,this.xhr&&this.xhr.abort(),l.length||h.length||e.error(\"jQuery UI Tabs: Mismatching fragment identifier.\"),h.length&&this.load(this.tabs.index(a),t),this._toggle(t,u))},_toggle:function(t,i){function s(){a.running=!1,a._trigger(\"activate\",t,i)}function n(){i.newTab.closest(\"li\").addClass(\"ui-tabs-active ui-state-active\"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest(\"li\").removeClass(\"ui-tabs-active ui-state-active\"),n()}):(i.oldTab.closest(\"li\").removeClass(\"ui-tabs-active ui-state-active\"),r.hide(),n()),r.attr(\"aria-hidden\",\"true\"),i.oldTab.attr({\"aria-selected\":\"false\",\"aria-expanded\":\"false\"}),o.length&&r.length?i.oldTab.attr(\"tabIndex\",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr(\"tabIndex\")}).attr(\"tabIndex\",-1),o.attr(\"aria-hidden\",\"false\"),i.newTab.attr({\"aria-selected\":\"true\",\"aria-expanded\":\"true\",tabIndex:0})},_activate:function(t){var i,s=this._findActive(t);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(\".ui-tabs-anchor\")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return\"string\"==typeof e&&(e=this.anchors.index(this.anchors.filter(\"[href$='\"+e+\"']\"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass(\"ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible\"),this.tablist.removeClass(\"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all\").removeAttr(\"role\"),this.anchors.removeClass(\"ui-tabs-anchor\").removeAttr(\"role\").removeAttr(\"tabIndex\").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){e.data(this,\"ui-tabs-destroy\")?e(this).remove():e(this).removeClass(\"ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel\").removeAttr(\"tabIndex\").removeAttr(\"aria-live\").removeAttr(\"aria-busy\").removeAttr(\"aria-selected\").removeAttr(\"aria-labelledby\").removeAttr(\"aria-hidden\").removeAttr(\"aria-expanded\").removeAttr(\"role\")}),this.tabs.each(function(){var t=e(this),i=t.data(\"ui-tabs-aria-controls\");i?t.attr(\"aria-controls\",i).removeData(\"ui-tabs-aria-controls\"):t.removeAttr(\"aria-controls\")}),this.panels.show(),\"content\"!==this.options.heightStyle&&this.panels.css(\"height\",\"\")},enable:function(t){var i=this.options.disabled;i!==!1&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(t,i){t=this._getIndex(t);var s=this,n=this.tabs.eq(t),a=n.find(\".ui-tabs-anchor\"),o=this._getPanelForTab(n),r={tab:n,panel:o};this._isLocal(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,i,r)),this.xhr&&\"canceled\"!==this.xhr.statusText&&(n.addClass(\"ui-tabs-loading\"),o.attr(\"aria-busy\",\"true\"),this.xhr.success(function(e){setTimeout(function(){o.html(e),s._trigger(\"load\",i,r)},1)}).complete(function(e,t){setTimeout(function(){\"abort\"===t&&s.panels.stop(!1,!0),n.removeClass(\"ui-tabs-loading\"),o.removeAttr(\"aria-busy\"),e===s.xhr&&delete s.xhr},1)})))},_ajaxSettings:function(t,i,s){var n=this;return{url:t.attr(\"href\"),beforeSend:function(t,a){return n._trigger(\"beforeLoad\",i,e.extend({jqXHR:t,ajaxSettings:a},s))}}},_getPanelForTab:function(t){var i=e(t).attr(\"aria-controls\");return this.element.find(this._sanitizeSelector(\"#\"+i))}}),e.widget(\"ui.tooltip\",{version:\"1.11.1\",options:{content:function(){var t=e(this).attr(\"title\")||\"\";return e(\"<a>\").text(t).html()},hide:!0,items:\"[title]:not([disabled])\",position:{my:\"left top+15\",at:\"left bottom\",collision:\"flipfit flip\"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var s=(t.attr(\"aria-describedby\")||\"\").split(/\\s+/);s.push(i),t.data(\"ui-tooltip-id\",i).attr(\"aria-describedby\",e.trim(s.join(\" \")))},_removeDescribedBy:function(t){var i=t.data(\"ui-tooltip-id\"),s=(t.attr(\"aria-describedby\")||\"\").split(/\\s+/),n=e.inArray(i,s);-1!==n&&s.splice(n,1),t.removeData(\"ui-tooltip-id\"),s=e.trim(s.join(\" \")),s?t.attr(\"aria-describedby\",s):t.removeAttr(\"aria-describedby\")},_create:function(){this._on({mouseover:\"open\",focusin:\"open\"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e(\"<div>\").attr({role:\"log\",\"aria-live\":\"assertive\",\"aria-relevant\":\"additions\"}).addClass(\"ui-helper-hidden-accessible\").appendTo(this.document[0].body)},_setOption:function(t,i){var s=this;return\"disabled\"===t?(this[i?\"_disable\":\"_enable\"](),this.options[t]=i,void 0):(this._super(t,i),\"content\"===t&&e.each(this.tooltips,function(e,t){s._updateContent(t)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event(\"blur\");n.target=n.currentTarget=s[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is(\"[title]\")&&t.data(\"ui-tooltip-title\",t.attr(\"title\")).removeAttr(\"title\")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data(\"ui-tooltip-title\")&&t.attr(\"title\",t.data(\"ui-tooltip-title\"))})},open:function(t){var i=this,s=e(t?t.target:this.element).closest(this.options.items);s.length&&!s.data(\"ui-tooltip-id\")&&(s.attr(\"title\")&&s.data(\"ui-tooltip-title\",s.attr(\"title\")),s.data(\"ui-tooltip-open\",!0),t&&\"mouseover\"===t.type&&s.parents().each(function(){var t,s=e(this);s.data(\"ui-tooltip-open\")&&(t=e.Event(\"blur\"),t.target=t.currentTarget=this,i.close(t,!0)),s.attr(\"title\")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr(\"title\")},s.attr(\"title\",\"\"))}),this._updateContent(s,t))},_updateContent:function(e,t){var i,s=this.options.content,n=this,a=t?t.type:null;return\"string\"==typeof s?this._open(t,e,s):(i=s.call(e[0],function(i){e.data(\"ui-tooltip-open\")&&n._delay(function(){t&&(t.type=a),this._open(t,e,i)})}),i&&this._open(t,e,i),void 0)},_open:function(t,i,s){function n(e){l.of=e,a.is(\":hidden\")||a.position(l)}var a,o,r,h,l=e.extend({},this.options.position);if(s){if(a=this._find(i),a.length)return a.find(\".ui-tooltip-content\").html(s),void 0;i.is(\"[title]\")&&(t&&\"mouseover\"===t.type?i.attr(\"title\",\"\"):i.removeAttr(\"title\")),a=this._tooltip(i),this._addDescribedBy(i,a.attr(\"id\")),a.find(\".ui-tooltip-content\").html(s),this.liveRegion.children().hide(),s.clone?(h=s.clone(),h.removeAttr(\"id\").find(\"[id]\").removeAttr(\"id\")):h=s,e(\"<div>\").html(h).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:n}),n(t)):a.position(e.extend({of:i},this.options.position)),this.hiding=!1,this.closing=!1,a.hide(),this._show(a,this.options.show),this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){a.is(\":visible\")&&(n(l.of),clearInterval(r))},e.fx.interval)),this._trigger(\"open\",t,{tooltip:a}),o={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var s=e.Event(t);s.currentTarget=i[0],this.close(s,!0)}}},i[0]!==this.element[0]&&(o.remove=function(){this._removeTooltip(a)}),t&&\"mouseover\"!==t.type||(o.mouseleave=\"close\"),t&&\"focusin\"!==t.type||(o.focusout=\"close\"),this._on(!0,i,o)}},close:function(t){var i=this,s=e(t?t.currentTarget:this.element),n=this._find(s);this.closing||(clearInterval(this.delayedShow),s.data(\"ui-tooltip-title\")&&!s.attr(\"title\")&&s.attr(\"title\",s.data(\"ui-tooltip-title\")),this._removeDescribedBy(s),this.hiding=!0,n.stop(!0),this._hide(n,this.options.hide,function(){i._removeTooltip(e(this)),this.hiding=!1,this.closing=!1}),s.removeData(\"ui-tooltip-open\"),this._off(s,\"mouseleave focusout keyup\"),s[0]!==this.element[0]&&this._off(s,\"remove\"),this._off(this.document,\"mousemove\"),t&&\"mouseleave\"===t.type&&e.each(this.parents,function(t,s){e(s.element).attr(\"title\",s.title),delete i.parents[t]}),this.closing=!0,this._trigger(\"close\",t,{tooltip:n}),this.hiding||(this.closing=!1))},_tooltip:function(t){var i=e(\"<div>\").attr(\"role\",\"tooltip\").addClass(\"ui-tooltip ui-widget ui-corner-all ui-widget-content \"+(this.options.tooltipClass||\"\")),s=i.uniqueId().attr(\"id\");return e(\"<div>\").addClass(\"ui-tooltip-content\").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[s]=t,i},_find:function(t){var i=t.data(\"ui-tooltip-id\");return i?e(\"#\"+i):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr(\"id\")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event(\"blur\");n.target=n.currentTarget=s[0],t.close(n,!0),e(\"#\"+i).remove(),s.data(\"ui-tooltip-title\")&&(s.attr(\"title\")||s.attr(\"title\",s.data(\"ui-tooltip-title\")),s.removeData(\"ui-tooltip-title\"))}),this.liveRegion.remove()}})});","/*! \r\n * jquery.event.drag - v 2.2\r\n * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com\r\n * Open Source MIT License - http://threedubmedia.com/code/license\r\n */\r\n// Created: 2008-06-04 \r\n// Updated: 2012-05-21\r\n// REQUIRES: jquery 1.7.x\r\n\r\n;(function( $ ){\r\n\r\n// add the jquery instance method\r\n$.fn.drag = function( str, arg, opts ){\r\n\t// figure out the event type\r\n\tvar type = typeof str == \"string\" ? str : \"\",\r\n\t// figure out the event handler...\r\n\tfn = $.isFunction( str ) ? str : $.isFunction( arg ) ? arg : null;\r\n\t// fix the event type\r\n\tif ( type.indexOf(\"drag\") !== 0 ) \r\n\t\ttype = \"drag\"+ type;\r\n\t// were options passed\r\n\topts = ( str == fn ? arg : opts ) || {};\r\n\t// trigger or bind event handler\r\n\treturn fn ? this.bind( type, opts, fn ) : this.trigger( type );\r\n};\r\n\r\n// local refs (increase compression)\r\nvar $event = $.event, \r\n$special = $event.special,\r\n// configure the drag special event \r\ndrag = $special.drag = {\r\n\t\r\n\t// these are the default settings\r\n\tdefaults: {\r\n\t\twhich: 1, // mouse button pressed to start drag sequence\r\n\t\tdistance: 0, // distance dragged before dragstart\r\n\t\tnot: ':input', // selector to suppress dragging on target elements\r\n\t\thandle: null, // selector to match handle target elements\r\n\t\trelative: false, // true to use \"position\", false to use \"offset\"\r\n\t\tdrop: true, // false to suppress drop events, true or selector to allow\r\n\t\tclick: false // false to suppress click events after dragend (no proxy)\r\n\t},\r\n\t\r\n\t// the key name for stored drag data\r\n\tdatakey: \"dragdata\",\r\n\t\r\n\t// prevent bubbling for better performance\r\n\tnoBubble: true,\r\n\t\r\n\t// count bound related events\r\n\tadd: function( obj ){ \r\n\t\t// read the interaction data\r\n\t\tvar data = $.data( this, drag.datakey ),\r\n\t\t// read any passed options \r\n\t\topts = obj.data || {};\r\n\t\t// count another realted event\r\n\t\tdata.related += 1;\r\n\t\t// extend data options bound with this event\r\n\t\t// don't iterate \"opts\" in case it is a node \r\n\t\t$.each( drag.defaults, function( key, def ){\r\n\t\t\tif ( opts[ key ] !== undefined )\r\n\t\t\t\tdata[ key ] = opts[ key ];\r\n\t\t});\r\n\t},\r\n\t\r\n\t// forget unbound related events\r\n\tremove: function(){\r\n\t\t$.data( this, drag.datakey ).related -= 1;\r\n\t},\r\n\t\r\n\t// configure interaction, capture settings\r\n\tsetup: function(){\r\n\t\t// check for related events\r\n\t\tif ( $.data( this, drag.datakey ) ) \r\n\t\t\treturn;\r\n\t\t// initialize the drag data with copied defaults\r\n\t\tvar data = $.extend({ related:0 }, drag.defaults );\r\n\t\t// store the interaction data\r\n\t\t$.data( this, drag.datakey, data );\r\n\t\t// bind the mousedown event, which starts drag interactions\r\n\t\t$event.add( this, \"touchstart mousedown\", drag.init, data );\r\n\t\t// prevent image dragging in IE...\r\n\t\tif ( this.attachEvent ) \r\n\t\t\tthis.attachEvent(\"ondragstart\", drag.dontstart ); \r\n\t},\r\n\t\r\n\t// destroy configured interaction\r\n\tteardown: function(){\r\n\t\tvar data = $.data( this, drag.datakey ) || {};\r\n\t\t// check for related events\r\n\t\tif ( data.related ) \r\n\t\t\treturn;\r\n\t\t// remove the stored data\r\n\t\t$.removeData( this, drag.datakey );\r\n\t\t// remove the mousedown event\r\n\t\t$event.remove( this, \"touchstart mousedown\", drag.init );\r\n\t\t// enable text selection\r\n\t\tdrag.textselect( true ); \r\n\t\t// un-prevent image dragging in IE...\r\n\t\tif ( this.detachEvent ) \r\n\t\t\tthis.detachEvent(\"ondragstart\", drag.dontstart ); \r\n\t},\r\n\t\t\r\n\t// initialize the interaction\r\n\tinit: function( event ){ \r\n\t\t// sorry, only one touch at a time\r\n\t\tif ( drag.touched ) \r\n\t\t\treturn;\r\n\t\t// the drag/drop interaction data\r\n\t\tvar dd = event.data, results;\r\n\t\t// check the which directive\r\n\t\tif ( event.which != 0 && dd.which > 0 && event.which != dd.which ) \r\n\t\t\treturn; \r\n\t\t// check for suppressed selector\r\n\t\tif ( $( event.target ).is( dd.not ) ) \r\n\t\t\treturn;\r\n\t\t// check for handle selector\r\n\t\tif ( dd.handle && !$( event.target ).closest( dd.handle, event.currentTarget ).length ) \r\n\t\t\treturn;\r\n\r\n\t\tdrag.touched = event.type == 'touchstart' ? this : null;\r\n\t\tdd.propagates = 1;\r\n\t\tdd.mousedown = this;\r\n\t\tdd.interactions = [ drag.interaction( this, dd ) ];\r\n\t\tdd.target = event.target;\r\n\t\tdd.pageX = event.pageX;\r\n\t\tdd.pageY = event.pageY;\r\n\t\tdd.dragging = null;\r\n\t\t// handle draginit event... \r\n\t\tresults = drag.hijack( event, \"draginit\", dd );\r\n\t\t// early cancel\r\n\t\tif ( !dd.propagates )\r\n\t\t\treturn;\r\n\t\t// flatten the result set\r\n\t\tresults = drag.flatten( results );\r\n\t\t// insert new interaction elements\r\n\t\tif ( results && results.length ){\r\n\t\t\tdd.interactions = [];\r\n\t\t\t$.each( results, function(){\r\n\t\t\t\tdd.interactions.push( drag.interaction( this, dd ) );\r\n\t\t\t});\r\n\t\t}\r\n\t\t// remember how many interactions are propagating\r\n\t\tdd.propagates = dd.interactions.length;\r\n\t\t// locate and init the drop targets\r\n\t\tif ( dd.drop !== false && $special.drop ) \r\n\t\t\t$special.drop.handler( event, dd );\r\n\t\t// disable text selection\r\n\t\tdrag.textselect( false ); \r\n\t\t// bind additional events...\r\n\t\tif ( drag.touched )\r\n\t\t\t$event.add( drag.touched, \"touchmove touchend\", drag.handler, dd );\r\n\t\telse \r\n\t\t\t$event.add( document, \"mousemove mouseup\", drag.handler, dd );\r\n\t\t// helps prevent text selection or scrolling\r\n\t\tif ( !drag.touched || dd.live )\r\n\t\t\treturn false;\r\n\t},\t\r\n\t\r\n\t// returns an interaction object\r\n\tinteraction: function( elem, dd ){\r\n\t\tvar offset = $( elem )[ dd.relative ? \"position\" : \"offset\" ]() || { top:0, left:0 };\r\n\t\treturn {\r\n\t\t\tdrag: elem, \r\n\t\t\tcallback: new drag.callback(), \r\n\t\t\tdroppable: [],\r\n\t\t\toffset: offset\r\n\t\t};\r\n\t},\r\n\t\r\n\t// handle drag-releatd DOM events\r\n\thandler: function( event ){ \r\n\t\t// read the data before hijacking anything\r\n\t\tvar dd = event.data;\t\r\n\t\t// handle various events\r\n\t\tswitch ( event.type ){\r\n\t\t\t// mousemove, check distance, start dragging\r\n\t\t\tcase !dd.dragging && 'touchmove': \r\n\t\t\t\tevent.preventDefault();\r\n\t\t\tcase !dd.dragging && 'mousemove':\r\n\t\t\t\t//  drag tolerance, x� + y� = distance�\r\n\t\t\t\tif ( Math.pow(  event.pageX-dd.pageX, 2 ) + Math.pow(  event.pageY-dd.pageY, 2 ) < Math.pow( dd.distance, 2 ) ) \r\n\t\t\t\t\tbreak; // distance tolerance not reached\r\n\t\t\t\tevent.target = dd.target; // force target from \"mousedown\" event (fix distance issue)\r\n\t\t\t\tdrag.hijack( event, \"dragstart\", dd ); // trigger \"dragstart\"\r\n\t\t\t\tif ( dd.propagates ) // \"dragstart\" not rejected\r\n\t\t\t\t\tdd.dragging = true; // activate interaction\r\n\t\t\t// mousemove, dragging\r\n\t\t\tcase 'touchmove':\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\tcase 'mousemove':\r\n\t\t\t\tif ( dd.dragging ){\r\n\t\t\t\t\t// trigger \"drag\"\t\t\r\n\t\t\t\t\tdrag.hijack( event, \"drag\", dd );\r\n\t\t\t\t\tif ( dd.propagates ){\r\n\t\t\t\t\t\t// manage drop events\r\n\t\t\t\t\t\tif ( dd.drop !== false && $special.drop )\r\n\t\t\t\t\t\t\t$special.drop.handler( event, dd ); // \"dropstart\", \"dropend\"\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tbreak; // \"drag\" not rejected, stop\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.type = \"mouseup\"; // helps \"drop\" handler behave\r\n\t\t\t\t}\r\n\t\t\t// mouseup, stop dragging\r\n\t\t\tcase 'touchend': \r\n\t\t\tcase 'mouseup': \r\n\t\t\tdefault:\r\n\t\t\t\tif ( drag.touched )\r\n\t\t\t\t\t$event.remove( drag.touched, \"touchmove touchend\", drag.handler ); // remove touch events\r\n\t\t\t\telse \r\n\t\t\t\t\t$event.remove( document, \"mousemove mouseup\", drag.handler ); // remove page events\t\r\n\t\t\t\tif ( dd.dragging ){\r\n\t\t\t\t\tif ( dd.drop !== false && $special.drop )\r\n\t\t\t\t\t\t$special.drop.handler( event, dd ); // \"drop\"\r\n\t\t\t\t\tdrag.hijack( event, \"dragend\", dd ); // trigger \"dragend\"\t\r\n\t\t\t\t}\r\n\t\t\t\tdrag.textselect( true ); // enable text selection\r\n\t\t\t\t// if suppressing click events...\r\n\t\t\t\tif ( dd.click === false && dd.dragging )\r\n\t\t\t\t\t$.data( dd.mousedown, \"suppress.click\", new Date().getTime() + 5 );\r\n\t\t\t\tdd.dragging = drag.touched = false; // deactivate element\t\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t},\r\n\t\t\r\n\t// re-use event object for custom events\r\n\thijack: function( event, type, dd, x, elem ){\r\n\t\t// not configured\r\n\t\tif ( !dd ) \r\n\t\t\treturn;\r\n\t\t// remember the original event and type\r\n\t\tvar orig = { event:event.originalEvent, type:event.type },\r\n\t\t// is the event drag related or drog related?\r\n\t\tmode = type.indexOf(\"drop\") ? \"drag\" : \"drop\",\r\n\t\t// iteration vars\r\n\t\tresult, i = x || 0, ia, $elems, callback,\r\n\t\tlen = !isNaN( x ) ? x : dd.interactions.length;\r\n\t\t// modify the event type\r\n\t\tevent.type = type;\r\n\t\t// remove the original event\r\n\t\tevent.originalEvent = null;\r\n\t\t// initialize the results\r\n\t\tdd.results = [];\r\n\t\t// handle each interacted element\r\n\t\tdo if ( ia = dd.interactions[ i ] ){\r\n\t\t\t// validate the interaction\r\n\t\t\tif ( type !== \"dragend\" && ia.cancelled )\r\n\t\t\t\tcontinue;\r\n\t\t\t// set the dragdrop properties on the event object\r\n\t\t\tcallback = drag.properties( event, dd, ia );\r\n\t\t\t// prepare for more results\r\n\t\t\tia.results = [];\r\n\t\t\t// handle each element\r\n\t\t\t$( elem || ia[ mode ] || dd.droppable ).each(function( p, subject ){\r\n\t\t\t\t// identify drag or drop targets individually\r\n\t\t\t\tcallback.target = subject;\r\n\t\t\t\t// force propagtion of the custom event\r\n\t\t\t\tevent.isPropagationStopped = function(){ return false; };\r\n\t\t\t\t// handle the event\t\r\n\t\t\t\tresult = subject ? $event.dispatch.call( subject, event, callback ) : null;\r\n\t\t\t\t// stop the drag interaction for this element\r\n\t\t\t\tif ( result === false ){\r\n\t\t\t\t\tif ( mode == \"drag\" ){\r\n\t\t\t\t\t\tia.cancelled = true;\r\n\t\t\t\t\t\tdd.propagates -= 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( type == \"drop\" ){\r\n\t\t\t\t\t\tia[ mode ][p] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// assign any dropinit elements\r\n\t\t\t\telse if ( type == \"dropinit\" )\r\n\t\t\t\t\tia.droppable.push( drag.element( result ) || subject );\r\n\t\t\t\t// accept a returned proxy element \r\n\t\t\t\tif ( type == \"dragstart\" )\r\n\t\t\t\t\tia.proxy = $( drag.element( result ) || ia.drag )[0];\r\n\t\t\t\t// remember this result\t\r\n\t\t\t\tia.results.push( result );\r\n\t\t\t\t// forget the event result, for recycling\r\n\t\t\t\tdelete event.result;\r\n\t\t\t\t// break on cancelled handler\r\n\t\t\t\tif ( type !== \"dropinit\" )\r\n\t\t\t\t\treturn result;\r\n\t\t\t});\t\r\n\t\t\t// flatten the results\t\r\n\t\t\tdd.results[ i ] = drag.flatten( ia.results );\t\r\n\t\t\t// accept a set of valid drop targets\r\n\t\t\tif ( type == \"dropinit\" )\r\n\t\t\t\tia.droppable = drag.flatten( ia.droppable );\r\n\t\t\t// locate drop targets\r\n\t\t\tif ( type == \"dragstart\" && !ia.cancelled )\r\n\t\t\t\tcallback.update(); \r\n\t\t}\r\n\t\twhile ( ++i < len )\r\n\t\t// restore the original event & type\r\n\t\tevent.type = orig.type;\r\n\t\tevent.originalEvent = orig.event;\r\n\t\t// return all handler results\r\n\t\treturn drag.flatten( dd.results );\r\n\t},\r\n\t\t\r\n\t// extend the callback object with drag/drop properties...\r\n\tproperties: function( event, dd, ia ){\t\t\r\n\t\tvar obj = ia.callback;\r\n\t\t// elements\r\n\t\tobj.drag = ia.drag;\r\n\t\tobj.proxy = ia.proxy || ia.drag;\r\n\t\t// starting mouse position\r\n\t\tobj.startX = dd.pageX;\r\n\t\tobj.startY = dd.pageY;\r\n\t\t// current distance dragged\r\n\t\tobj.deltaX = event.pageX - dd.pageX;\r\n\t\tobj.deltaY = event.pageY - dd.pageY;\r\n\t\t// original element position\r\n\t\tobj.originalX = ia.offset.left;\r\n\t\tobj.originalY = ia.offset.top;\r\n\t\t// adjusted element position\r\n\t\tobj.offsetX = obj.originalX + obj.deltaX; \r\n\t\tobj.offsetY = obj.originalY + obj.deltaY;\r\n\t\t// assign the drop targets information\r\n\t\tobj.drop = drag.flatten( ( ia.drop || [] ).slice() );\r\n\t\tobj.available = drag.flatten( ( ia.droppable || [] ).slice() );\r\n\t\treturn obj;\t\r\n\t},\r\n\t\r\n\t// determine is the argument is an element or jquery instance\r\n\telement: function( arg ){\r\n\t\tif ( arg && ( arg.jquery || arg.nodeType == 1 ) )\r\n\t\t\treturn arg;\r\n\t},\r\n\t\r\n\t// flatten nested jquery objects and arrays into a single dimension array\r\n\tflatten: function( arr ){\r\n\t\treturn $.map( arr, function( member ){\r\n\t\t\treturn member && member.jquery ? $.makeArray( member ) : \r\n\t\t\t\tmember && member.length ? drag.flatten( member ) : member;\r\n\t\t});\r\n\t},\r\n\t\r\n\t// toggles text selection attributes ON (true) or OFF (false)\r\n\ttextselect: function( bool ){ \r\n\t\t$( document )[ bool ? \"unbind\" : \"bind\" ](\"selectstart\", drag.dontstart )\r\n\t\t\t.css(\"MozUserSelect\", bool ? \"\" : \"none\" );\r\n\t\t// .attr(\"unselectable\", bool ? \"off\" : \"on\" )\r\n\t\tdocument.unselectable = bool ? \"off\" : \"on\"; \r\n\t},\r\n\t\r\n\t// suppress \"selectstart\" and \"ondragstart\" events\r\n\tdontstart: function(){ \r\n\t\treturn false; \r\n\t},\r\n\t\r\n\t// a callback instance contructor\r\n\tcallback: function(){}\r\n\t\r\n};\r\n\r\n// callback methods\r\ndrag.callback.prototype = {\r\n\tupdate: function(){\r\n\t\tif ( $special.drop && this.available.length )\r\n\t\t\t$.each( this.available, function( i ){\r\n\t\t\t\t$special.drop.locate( this, i );\r\n\t\t\t});\r\n\t}\r\n};\r\n\r\n// patch $.event.$dispatch to allow suppressing clicks\r\nvar $dispatch = $event.dispatch;\r\n$event.dispatch = function( event ){\r\n\tif ( $.data( this, \"suppress.\"+ event.type ) - new Date().getTime() > 0 ){\r\n\t\t$.removeData( this, \"suppress.\"+ event.type );\r\n\t\treturn;\r\n\t}\r\n\treturn $dispatch.apply( this, arguments );\r\n};\r\n\r\n// event fix hooks for touch events...\r\nvar touchHooks = \r\n$event.fixHooks.touchstart = \r\n$event.fixHooks.touchmove = \r\n$event.fixHooks.touchend =\r\n$event.fixHooks.touchcancel = {\r\n\tprops: \"clientX clientY pageX pageY screenX screenY\".split( \" \" ),\r\n\tfilter: function( event, orig ) {\r\n\t\tif ( orig ){\r\n\t\t\tvar touched = ( orig.touches && orig.touches[0] )\r\n\t\t\t\t|| ( orig.changedTouches && orig.changedTouches[0] )\r\n\t\t\t\t|| null; \r\n\t\t\t// iOS webkit: touchstart, touchmove, touchend\r\n\t\t\tif ( touched ) \r\n\t\t\t\t$.each( touchHooks.props, function( i, prop ){\r\n\t\t\t\t\tevent[ prop ] = touched[ prop ];\r\n\t\t\t\t});\r\n\t\t}\r\n\t\treturn event;\r\n\t}\r\n};\r\n\r\n// share the same special event configuration with related events...\r\n$special.draginit = $special.dragstart = $special.dragend = drag;\r\n\r\n})( jQuery );","/*\r\n * Gritter for jQuery\r\n * http://www.boedesign.com/\r\n *\r\n * Copyright (c) 2012 Jordan Boesch\r\n * Dual licensed under the MIT and GPL licenses.\r\n *\r\n * Date: February 24, 2012\r\n * Version: 1.7.4\r\n */\r\n;\r\n(function($){\r\n \t\r\n\t/**\r\n\t* Set it up as an object under the jQuery namespace\r\n\t*/\r\n\t$.gritter = {};\r\n\t\r\n\t/**\r\n\t* Set up global options that the user can over-ride\r\n\t*/\r\n\t$.gritter.options = {\r\n        position: '',\r\n        class_name: '', // could be set to 'gritter-light' to use white notifications\r\n\t\tfade_in_speed: 'medium', // how fast notifications fade in\r\n\t\tfade_out_speed: 1000, // how fast the notices fade out\r\n\t\ttime: 6000 // hang on the screen for...\r\n\t}\r\n\t\r\n\t/**\r\n\t* Add a gritter notification to the screen\r\n\t* @see Gritter#add();\r\n\t*/\r\n\t$.gritter.add = function(params){\r\n\r\n\t\ttry {\r\n\t\t\treturn Gritter.add(params || {});\r\n\t\t} catch(e) {\r\n\t\t\r\n\t\t\tvar err = 'Gritter Error: ' + e;\r\n\t\t\t(typeof(console) != 'undefined' && console.error) ? \r\n\t\t\t\tconsole.error(err, params) : \r\n\t\t\t\talert(err);\r\n\t\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t* Remove a gritter notification from the screen\r\n\t* @see Gritter#removeSpecific();\r\n\t*/\r\n\t$.gritter.remove = function(id, params){\r\n\t\tGritter.removeSpecific(id, params || {});\r\n\t}\r\n\t\r\n\t/**\r\n\t* Remove all notifications\r\n\t* @see Gritter#stop();\r\n\t*/\r\n\t$.gritter.removeAll = function(params){\r\n\t\tGritter.stop(params || {});\r\n\t}\r\n\t\r\n\t/**\r\n\t* Big fat Gritter object\r\n\t* @constructor (not really since its object literal)\r\n\t*/\r\n\tvar Gritter = {\r\n\t    \r\n\t\t// Public - options to over-ride with $.gritter.options in \"add\"\r\n        position: '',\r\n\t\tfade_in_speed: '',\r\n\t\tfade_out_speed: '',\r\n\t\ttime: '',\r\n\t    \r\n\t\t// Private - no touchy the private parts\r\n\t\t_custom_timer: 0,\r\n\t\t_item_count: 0,\r\n\t\t_is_setup: 0,\r\n\t\t_tpl_close: '<div class=\"gritter-close\"></div>',\r\n\t\t_tpl_item: '<div id=\"gritter-item-[[number]]\" class=\"gritter-item-wrapper [[item_class]]\" style=\"display:none\"><div class=\"gritter-top\"></div><div class=\"gritter-item\">[[close]][[image]]<div class=\"[[class_name]]\"><span class=\"gritter-title\">[[username]]</span><p>[[text]]</p></div><div style=\"clear:both\"></div></div><div class=\"gritter-bottom\"></div></div>',\r\n\t\t_tpl_wrap: '<div id=\"gritter-notice-wrapper\"></div>',\r\n\t    \r\n\t\t/**\r\n\t\t* Add a gritter notification to the screen\r\n\t\t* @param {Object} params The object that contains all the options for drawing the notification\r\n\t\t* @return {Integer} The specific numeric id to that gritter notification\r\n\t\t*/\r\n\t\tadd: function(params){\r\n\t        \r\n\t\t\t// We might have some issues if we don't have a title or text!\r\n\t\t\tif(!params.title || !params.text){\r\n\t\t\t\tthrow 'You need to fill out the first 2 params: \"title\" and \"text\"'; \r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Check the options and set them once\r\n\t\t\tif(!this._is_setup){\r\n\t\t\t\tthis._runSetup();\r\n\t\t\t}\r\n\t        \r\n\t\t\t// Basics\r\n\t\t\tvar user = params.title, \r\n\t\t\t\ttext = params.text,\r\n\t\t\t\timage = params.image || '',\r\n\t\t\t\tsticky = params.sticky || false,\r\n\t\t\t\titem_class = params.class_name || $.gritter.options.class_name,\r\n                position = $.gritter.options.position,\r\n\t\t\t\ttime_alive = params.time || '';\r\n\r\n\t\t\tthis._verifyWrapper();\r\n\t\t\t\r\n\t\t\tthis._item_count++;\r\n\t\t\tvar number = this._item_count, \r\n\t\t\t\ttmp = this._tpl_item;\r\n\t\t\t\r\n\t\t\t// Assign callbacks\r\n\t\t\t$(['before_open', 'after_open', 'before_close', 'after_close']).each(function(i, val){\r\n\t\t\t\tGritter['_' + val + '_' + number] = ($.isFunction(params[val])) ? params[val] : function(){}\r\n\t\t\t});\r\n\r\n\t\t\t// Reset\r\n\t\t\tthis._custom_timer = 0;\r\n\t\t\t\r\n\t\t\t// A custom fade time set\r\n\t\t\tif(time_alive){\r\n\t\t\t\tthis._custom_timer = time_alive;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar image_str = (image != '') ? '<img src=\"' + image + '\" class=\"gritter-image\" />' : '',\r\n\t\t\t\tclass_name = (image != '') ? 'gritter-with-image' : 'gritter-without-image';\r\n\t\t\t\r\n\t\t\t// String replacements on the template\r\n\t\t\ttmp = this._str_replace(\r\n\t\t\t\t['[[username]]', '[[text]]', '[[close]]', '[[image]]', '[[number]]', '[[class_name]]', '[[item_class]]'],\r\n\t\t\t\t[user, text, this._tpl_close, image_str, this._item_count, class_name, item_class], tmp\r\n\t\t\t);\r\n\r\n            // If it's false, don't show another gritter message\r\n\t\t\tif(this['_before_open_' + number]() === false){\r\n                return false;\r\n            }\r\n\r\n\t\t\t$('#gritter-notice-wrapper').addClass(position).append(tmp);\r\n\t\t\t\r\n\t\t\tvar item = $('#gritter-item-' + this._item_count);\r\n\t\t\t\r\n\t\t\titem.fadeIn(this.fade_in_speed, function(){\r\n\t\t\t\tGritter['_after_open_' + number]($(this));\r\n\t\t\t});\r\n\t        \r\n\t\t\tif(!sticky){\r\n\t\t\t\tthis._setFadeTimer(item, number);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Bind the hover/unhover states\r\n\t\t\t$(item).bind('mouseenter mouseleave', function(event){\r\n\t\t\t\tif(event.type == 'mouseenter'){\r\n\t\t\t\t\tif(!sticky){ \r\n\t\t\t\t\t\tGritter._restoreItemIfFading($(this), number);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(!sticky){\r\n\t\t\t\t\t\tGritter._setFadeTimer($(this), number);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tGritter._hoverState($(this), event.type);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// Clicking (X) makes the perdy thing close\r\n\t\t\t$(item).find('.gritter-close').click(function(){\r\n\t\t\t\tGritter.removeSpecific(number, {}, null, true);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\treturn number;\r\n\t    \r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* If we don't have any more gritter notifications, get rid of the wrapper using this check\r\n\t\t* @private\r\n\t\t* @param {Integer} unique_id The ID of the element that was just deleted, use it for a callback\r\n\t\t* @param {Object} e The jQuery element that we're going to perform the remove() action on\r\n\t\t* @param {Boolean} manual_close Did we close the gritter dialog with the (X) button\r\n        */\r\n\t\t_countRemoveWrapper: function(unique_id, e, manual_close){\r\n\t\t    \r\n\t\t\t// Remove it then run the callback function\r\n\t\t\te.remove();\r\n\t\t\tthis['_after_close_' + unique_id](e, manual_close);\r\n\t\t\t\r\n\t\t\t// Check if the wrapper is empty, if it is.. remove the wrapper\r\n\t\t\tif($('.gritter-item-wrapper').length == 0){\r\n\t\t\t\t$('#gritter-notice-wrapper').remove();\r\n\t\t\t}\r\n\t\t\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* Fade out an element after it's been on the screen for x amount of time\r\n\t\t* @private\r\n\t\t* @param {Object} e The jQuery element to get rid of\r\n\t\t* @param {Integer} unique_id The id of the element to remove\r\n\t\t* @param {Object} params An optional list of params to set fade speeds etc.\r\n\t\t* @param {Boolean} unbind_events Unbind the mouseenter/mouseleave events if they click (X)\r\n\t\t*/\r\n\t\t_fade: function(e, unique_id, params, unbind_events){\r\n\r\n\t\t\tvar params = params || {},\r\n\t\t\t\tfade = (typeof(params.fade) != 'undefined') ? params.fade : true,\r\n\t\t\t\tfade_out_speed = params.speed || this.fade_out_speed,\r\n                manual_close = unbind_events;\r\n\r\n\t\t\tthis['_before_close_' + unique_id](e, manual_close);\r\n\t\t\t\r\n\t\t\t// If this is true, then we are coming from clicking the (X)\r\n\t\t\tif(unbind_events){\r\n\t\t\t\te.unbind('mouseenter mouseleave');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Fade it out or remove it\r\n\t\t\tif(fade){\r\n\t\t\t\r\n\t\t\t\te.animate({\r\n\t\t\t\t\topacity: 0\r\n\t\t\t\t}, fade_out_speed, function(){\r\n\t\t\t\t\te.animate({ height: 0 }, 300, function(){\r\n\t\t\t\t\t\tGritter._countRemoveWrapper(unique_id, e, manual_close);\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t\r\n\t\t\t\tthis._countRemoveWrapper(unique_id, e);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\t\t    \r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* Perform actions based on the type of bind (mouseenter, mouseleave) \r\n\t\t* @private\r\n\t\t* @param {Object} e The jQuery element\r\n\t\t* @param {String} type The type of action we're performing: mouseenter or mouseleave\r\n\t\t*/\r\n\t\t_hoverState: function(e, type){\r\n\t\t\t\r\n\t\t\t// Change the border styles and add the (X) close button when you hover\r\n\t\t\tif(type == 'mouseenter'){\r\n\t\t    \t\r\n\t\t\t\te.addClass('hover');\r\n\t\t\t\t\r\n\t\t\t\t// Show close button\r\n\t\t\t\te.find('.gritter-close').show();\r\n\t\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\t// Remove the border styles and hide (X) close button when you mouse out\r\n\t\t\telse {\r\n\t\t\t\t\r\n\t\t\t\te.removeClass('hover');\r\n\t\t\t\t\r\n\t\t\t\t// Hide close button\r\n\t\t\t\te.find('.gritter-close').hide();\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t    \r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* Remove a specific notification based on an ID\r\n\t\t* @param {Integer} unique_id The ID used to delete a specific notification\r\n\t\t* @param {Object} params A set of options passed in to determine how to get rid of it\r\n\t\t* @param {Object} e The jQuery element that we're \"fading\" then removing\r\n\t\t* @param {Boolean} unbind_events If we clicked on the (X) we set this to true to unbind mouseenter/mouseleave\r\n\t\t*/\r\n\t\tremoveSpecific: function(unique_id, params, e, unbind_events){\r\n\t\t\t\r\n\t\t\tif(!e){\r\n\t\t\t\tvar e = $('#gritter-item-' + unique_id);\r\n\t\t\t}\r\n\r\n\t\t\t// We set the fourth param to let the _fade function know to \r\n\t\t\t// unbind the \"mouseleave\" event.  Once you click (X) there's no going back!\r\n\t\t\tthis._fade(e, unique_id, params || {}, unbind_events);\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* If the item is fading out and we hover over it, restore it!\r\n\t\t* @private\r\n\t\t* @param {Object} e The HTML element to remove\r\n\t\t* @param {Integer} unique_id The ID of the element\r\n\t\t*/\r\n\t\t_restoreItemIfFading: function(e, unique_id){\r\n\t\t\t\r\n\t\t\tclearTimeout(this['_int_id_' + unique_id]);\r\n\t\t\te.stop().css({ opacity: '', height: '' });\r\n\t\t    \r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* Setup the global options - only once\r\n\t\t* @private\r\n\t\t*/\r\n\t\t_runSetup: function(){\r\n\t\t\r\n\t\t\tfor(opt in $.gritter.options){\r\n\t\t\t\tthis[opt] = $.gritter.options[opt];\r\n\t\t\t}\r\n\t\t\tthis._is_setup = 1;\r\n\t\t    \r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* Set the notification to fade out after a certain amount of time\r\n\t\t* @private\r\n\t\t* @param {Object} item The HTML element we're dealing with\r\n\t\t* @param {Integer} unique_id The ID of the element\r\n\t\t*/\r\n\t\t_setFadeTimer: function(e, unique_id){\r\n\t\t\t\r\n\t\t\tvar timer_str = (this._custom_timer) ? this._custom_timer : this.time;\r\n\t\t\tthis['_int_id_' + unique_id] = setTimeout(function(){ \r\n\t\t\t\tGritter._fade(e, unique_id);\r\n\t\t\t}, timer_str);\r\n\t\t\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* Bring everything to a halt\r\n\t\t* @param {Object} params A list of callback functions to pass when all notifications are removed\r\n\t\t*/  \r\n\t\tstop: function(params){\r\n\t\t\t\r\n\t\t\t// callbacks (if passed)\r\n\t\t\tvar before_close = ($.isFunction(params.before_close)) ? params.before_close : function(){};\r\n\t\t\tvar after_close = ($.isFunction(params.after_close)) ? params.after_close : function(){};\r\n\t\t\t\r\n\t\t\tvar wrap = $('#gritter-notice-wrapper');\r\n\t\t\tbefore_close(wrap);\r\n\t\t\twrap.fadeOut(function(){\r\n\t\t\t\t$(this).remove();\r\n\t\t\t\tafter_close();\r\n\t\t\t});\r\n\t\t\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* An extremely handy PHP function ported to JS, works well for templating\r\n\t\t* @private\r\n\t\t* @param {String/Array} search A list of things to search for\r\n\t\t* @param {String/Array} replace A list of things to replace the searches with\r\n\t\t* @return {String} sa The output\r\n\t\t*/  \r\n\t\t_str_replace: function(search, replace, subject, count){\r\n\t\t\r\n\t\t\tvar i = 0, j = 0, temp = '', repl = '', sl = 0, fl = 0,\r\n\t\t\t\tf = [].concat(search),\r\n\t\t\t\tr = [].concat(replace),\r\n\t\t\t\ts = subject,\r\n\t\t\t\tra = r instanceof Array, sa = s instanceof Array;\r\n\t\t\ts = [].concat(s);\r\n\t\t\t\r\n\t\t\tif(count){\r\n\t\t\t\tthis.window[count] = 0;\r\n\t\t\t}\r\n\t\t\r\n\t\t\tfor(i = 0, sl = s.length; i < sl; i++){\r\n\t\t\t\t\r\n\t\t\t\tif(s[i] === ''){\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t        for (j = 0, fl = f.length; j < fl; j++){\r\n\t\t\t\t\t\r\n\t\t\t\t\ttemp = s[i] + '';\r\n\t\t\t\t\trepl = ra ? (r[j] !== undefined ? r[j] : '') : r[0];\r\n\t\t\t\t\ts[i] = (temp).split(f[j]).join(repl);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(count && s[i] !== temp){\r\n\t\t\t\t\t\tthis.window[count] += (temp.length-s[i].length) / f[j].length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn sa ? s : s[0];\r\n\t\t    \r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t* A check to make sure we have something to wrap our notices with\r\n\t\t* @private\r\n\t\t*/  \r\n\t\t_verifyWrapper: function(){\r\n\t\t  \r\n\t\t\tif($('#gritter-notice-wrapper').length == 0){\r\n\t\t\t\t$('body').append(this._tpl_wrap);\r\n\t\t\t}\r\n\t\t\r\n\t\t}\r\n\t    \r\n\t}\r\n\t\r\n})(jQuery);\r\n","/*!\r\n* Bootstrap.js by @fat & @mdo\r\n* Copyright 2012 Twitter, Inc.\r\n* http://www.apache.org/licenses/LICENSE-2.0.txt\r\n*/\r\n!function(e){\"use strict\";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement(\"bootstrap\"),t={WebkitTransition:\"webkitTransitionEnd\",MozTransition:\"transitionend\",OTransition:\"oTransitionEnd otransitionend\",transition:\"transitionend\"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){\"use strict\";var t='[data-dismiss=\"alert\"]',n=function(n){e(n).on(\"click\",t,this.close)};n.prototype.close=function(t){function s(){i.trigger(\"closed\").remove()}var n=e(this),r=n.attr(\"data-target\"),i;r||(r=n.attr(\"href\"),r=r&&r.replace(/.*(?=#[^\\s]*$)/,\"\")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass(\"alert\")?n:n.parent()),i.trigger(t=e.Event(\"close\"));if(t.isDefaultPrevented())return;i.removeClass(\"in\"),e.support.transition&&i.hasClass(\"fade\")?i.on(e.support.transition.end,s):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data(\"alert\");i||r.data(\"alert\",i=new n(this)),typeof t==\"string\"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on(\"click.alert.data-api\",t,n.prototype.close)}(window.jQuery),!function(e){\"use strict\";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t=\"disabled\",n=this.$element,r=n.data(),i=n.is(\"input\")?\"val\":\"html\";e+=\"Text\",r.resetText||n.data(\"resetText\",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e==\"loadingText\"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle=\"buttons-radio\"]');e&&e.find(\".active\").removeClass(\"active\"),this.$element.toggleClass(\"active\")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data(\"button\"),s=typeof n==\"object\"&&n;i||r.data(\"button\",i=new t(this,s)),n==\"toggle\"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:\"loading...\"},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on(\"click.button.data-api\",\"[data-toggle^=button]\",function(t){var n=e(t.target);n.hasClass(\"btn\")||(n=n.closest(\".btn\")),n.button(\"toggle\")})}(window.jQuery),!function(e){\"use strict\";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(\".carousel-indicators\"),this.options=n,this.options.pause==\"hover\"&&this.$element.on(\"mouseenter\",e.proxy(this.pause,this)).on(\"mouseleave\",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(\".item.active\"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var n=this.getActiveIndex(),r=this;if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one(\"slid\",function(){r.to(t)}):n==t?this.pause().cycle():this.slide(t>n?\"next\":\"prev\",e(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(\".next, .prev\").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide(\"next\")},prev:function(){if(this.sliding)return;return this.slide(\"prev\")},slide:function(t,n){var r=this.$element.find(\".item.active\"),i=n||r[t](),s=this.interval,o=t==\"next\"?\"left\":\"right\",u=t==\"next\"?\"first\":\"last\",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(\".item\")[u](),f=e.Event(\"slide\",{relatedTarget:i[0],direction:o});if(i.hasClass(\"active\"))return;this.$indicators.length&&(this.$indicators.find(\".active\").removeClass(\"active\"),this.$element.one(\"slid\",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass(\"active\")}));if(e.support.transition&&this.$element.hasClass(\"slide\")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(\" \")).addClass(\"active\"),r.removeClass([\"active\",o].join(\" \")),a.sliding=!1,setTimeout(function(){a.$element.trigger(\"slid\")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass(\"active\"),i.addClass(\"active\"),this.sliding=!1,this.$element.trigger(\"slid\")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data(\"carousel\"),s=e.extend({},e.fn.carousel.defaults,typeof n==\"object\"&&n),o=typeof n==\"string\"?n:s.slide;i||r.data(\"carousel\",i=new t(this,s)),typeof n==\"number\"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.defaults={interval:5e3,pause:\"hover\"},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on(\"click.carousel.data-api\",\"[data-slide], [data-slide-to]\",function(t){var n=e(this),r,i=e(n.attr(\"data-target\")||(r=n.attr(\"href\"))&&r.replace(/.*(?=#[^\\s]+$)/,\"\")),s=e.extend({},i.data(),n.data()),o;i.carousel(s),(o=n.attr(\"data-slide-to\"))&&i.data(\"carousel\").pause().to(o).cycle(),t.preventDefault()})}(window.jQuery),!function(e){\"use strict\";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass(\"width\");return e?\"width\":\"height\"},show:function(){var t,n,r,i;if(this.transitioning||this.$element.hasClass(\"in\"))return;t=this.dimension(),n=e.camelCase([\"scroll\",t].join(\"-\")),r=this.$parent&&this.$parent.find(\"> .accordion-group > .in\");if(r&&r.length){i=r.data(\"collapse\");if(i&&i.transitioning)return;r.collapse(\"hide\"),i||r.data(\"collapse\",null)}this.$element[t](0),this.transition(\"addClass\",e.Event(\"show\"),\"shown\"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning||!this.$element.hasClass(\"in\"))return;t=this.dimension(),this.reset(this.$element[t]()),this.transition(\"removeClass\",e.Event(\"hide\"),\"hidden\"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass(\"collapse\")[t](e||\"auto\")[0].offsetWidth,this.$element[e!==null?\"addClass\":\"removeClass\"](\"collapse\"),this},transition:function(t,n,r){var i=this,s=function(){n.type==\"show\"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t](\"in\"),e.support.transition&&this.$element.hasClass(\"collapse\")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass(\"in\")?\"hide\":\"show\"]()}};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data(\"collapse\"),s=e.extend({},e.fn.collapse.defaults,r.data(),typeof n==\"object\"&&n);i||r.data(\"collapse\",i=new t(this,s)),typeof n==\"string\"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on(\"click.collapse.data-api\",\"[data-toggle=collapse]\",function(t){var n=e(this),r,i=n.attr(\"data-target\")||t.preventDefault()||(r=n.attr(\"href\"))&&r.replace(/.*(?=#[^\\s]+$)/,\"\"),s=e(i).data(\"collapse\")?\"toggle\":n.data();n[e(i).hasClass(\"in\")?\"addClass\":\"removeClass\"](\"collapsed\"),e(i).collapse(s)})}(window.jQuery),!function(e){\"use strict\";function r(){e(t).each(function(){i(e(this)).removeClass(\"open\")})}function i(t){var n=t.attr(\"data-target\"),r;n||(n=t.attr(\"href\"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\\s]*$)/,\"\")),r=n&&e(n);if(!r||!r.length)r=t.parent();return r}var t=\"[data-toggle=dropdown]\",n=function(t){var n=e(t).on(\"click.dropdown.data-api\",this.toggle);e(\"html\").on(\"click.dropdown.data-api\",function(){n.parent().removeClass(\"open\")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(\".disabled, :disabled\"))return;return s=i(n),o=s.hasClass(\"open\"),r(),o||s.toggleClass(\"open\"),n.focus(),!1},keydown:function(n){var r,s,o,u,a,f;if(!/(38|40|27)/.test(n.keyCode))return;r=e(this),n.preventDefault(),n.stopPropagation();if(r.is(\".disabled, :disabled\"))return;u=i(r),a=u.hasClass(\"open\");if(!a||a&&n.keyCode==27)return n.which==27&&u.find(t).focus(),r.click();s=e(\"[role=menu] li:not(.divider):visible a\",u);if(!s.length)return;f=s.index(s.filter(\":focus\")),n.keyCode==38&&f>0&&f--,n.keyCode==40&&f<s.length-1&&f++,~f||(f=0),s.eq(f).focus()}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data(\"dropdown\");i||r.data(\"dropdown\",i=new n(this)),typeof t==\"string\"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on(\"click.dropdown.data-api\",r).on(\"click.dropdown.data-api\",\".dropdown form\",function(e){e.stopPropagation()}).on(\"click.dropdown-menu\",function(e){e.stopPropagation()}).on(\"click.dropdown.data-api\",t,n.prototype.toggle).on(\"keydown.dropdown.data-api\",t+\", [role=menu]\",n.prototype.keydown)}(window.jQuery),!function(e){\"use strict\";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss=\"modal\"]',\"click.dismiss.modal\",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(\".modal-body\").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?\"hide\":\"show\"]()},show:function(){var t=this,n=e.Event(\"show\");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass(\"fade\");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass(\"in\").attr(\"aria-hidden\",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger(\"shown\")}):t.$element.focus().trigger(\"shown\")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event(\"hide\"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off(\"focusin.modal\"),this.$element.removeClass(\"in\").attr(\"aria-hidden\",!0),e.support.transition&&this.$element.hasClass(\"fade\")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on(\"focusin.modal\",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on(\"keyup.dismiss.modal\",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off(\"keyup.dismiss.modal\")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger(\"hidden\")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass(\"fade\")?\"fade\":\"\";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class=\"modal-backdrop '+r+'\" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop==\"static\"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass(\"in\");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass(\"in\"),e.support.transition&&this.$element.hasClass(\"fade\")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data(\"modal\"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n==\"object\"&&n);i||r.data(\"modal\",i=new t(this,s)),typeof n==\"string\"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on(\"click.modal.data-api\",'[data-toggle=\"modal\"]',function(t){var n=e(this),r=n.attr(\"href\"),i=e(n.attr(\"data-target\")||r&&r.replace(/.*(?=#[^\\s]+$)/,\"\")),s=i.data(\"modal\")?\"toggle\":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one(\"hide\",function(){n.focus()})})}(window.jQuery),!function(e){\"use strict\";var t=function(e,t){this.init(\"tooltip\",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s,o,u,a;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,o=this.options.trigger.split(\" \");for(a=o.length;a--;)u=o[a],u==\"click\"?this.$element.on(\"click.\"+this.type,this.options.selector,e.proxy(this.toggle,this)):u!=\"manual\"&&(i=u==\"hover\"?\"mouseenter\":\"focus\",s=u==\"hover\"?\"mouseleave\":\"blur\",this.$element.on(i+\".\"+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+\".\"+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:\"manual\",selector:\"\"}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay==\"number\"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e.fn[this.type].defaults,r={},i;this._options&&e.each(this._options,function(e,t){n[e]!=t&&(r[e]=t)},this),i=e(t.currentTarget)[this.type](r).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout),i.hoverState=\"in\",this.timeout=setTimeout(function(){i.hoverState==\"in\"&&i.show()},i.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState=\"out\",this.timeout=setTimeout(function(){n.hoverState==\"out\"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,i,s,o,u=e.Event(\"show\");if(this.hasContent()&&this.enabled){this.$element.trigger(u);if(u.isDefaultPrevented())return;t=this.tip(),this.setContent(),this.options.animation&&t.addClass(\"fade\"),s=typeof this.options.placement==\"function\"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:\"block\"}),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offsetWidth,i=t[0].offsetHeight;switch(s){case\"bottom\":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case\"top\":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case\"left\":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case\"right\":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}this.applyPlacement(o,s),this.$element.trigger(\"shown\")}},applyPlacement:function(e,t){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,s,o,u,a;n.offset(e).addClass(t).addClass(\"in\"),s=n[0].offsetWidth,o=n[0].offsetHeight,t==\"top\"&&o!=i&&(e.top=e.top+i-o,a=!0),t==\"bottom\"||t==\"top\"?(u=0,e.left<0&&(u=e.left*-2,e.left=0,n.offset(e),s=n[0].offsetWidth,o=n[0].offsetHeight),this.replaceArrow(u-r+s,s,\"left\")):this.replaceArrow(o-i,o,\"top\"),a&&n.offset(e)},replaceArrow:function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+\"%\":\"\")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(\".tooltip-inner\")[this.options.html?\"html\":\"text\"](t),e.removeClass(\"fade in top bottom left right\")},hide:function(){function i(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip(),r=e.Event(\"hide\");this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass(\"in\"),e.support.transition&&this.$tip.hasClass(\"fade\")?i():n.detach(),this.$element.trigger(\"hidden\"),this},fixTitle:function(){var e=this.$element;(e.attr(\"title\")||typeof e.attr(\"data-original-title\")!=\"string\")&&e.attr(\"data-original-title\",e.attr(\"title\")||\"\").attr(\"title\",\"\")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect==\"function\"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr(\"data-original-title\")||(typeof n.title==\"function\"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(\".tooltip-arrow\")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass(\"in\")?n.hide():n.show()},destroy:function(){this.hide().$element.off(\".\"+this.type).removeData(this.type)}};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data(\"tooltip\"),s=typeof n==\"object\"&&n;i||r.data(\"tooltip\",i=new t(this,s)),typeof n==\"string\"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:\"top\",selector:!1,template:'<div class=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',trigger:\"hover focus\",title:\"\",delay:0,html:!1,container:!1},e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(window.jQuery),!function(e){\"use strict\";var t=function(e,t){this.init(\"popover\",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(\".popover-title\")[this.options.html?\"html\":\"text\"](t),e.find(\".popover-content\")[this.options.html?\"html\":\"text\"](n),e.removeClass(\"fade top bottom left right in\")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=(typeof n.content==\"function\"?n.content.call(t[0]):n.content)||t.attr(\"data-content\"),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off(\".\"+this.type).removeData(this.type)}});var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data(\"popover\"),s=typeof n==\"object\"&&n;i||r.data(\"popover\",i=new t(this,s)),typeof n==\"string\"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:\"right\",trigger:\"click\",content:\"\",template:'<div class=\"popover\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>'}),e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(window.jQuery),!function(e){\"use strict\";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is(\"body\")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on(\"scroll.scroll-spy.data-api\",r),this.selector=(this.options.target||(s=e(t).attr(\"href\"))&&s.replace(/.*(?=#[^\\s]+$)/,\"\")||\"\")+\" .nav li > a\",this.$body=e(\"body\"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var n=e(this),r=n.data(\"target\")||n.attr(\"href\"),i=/^#\\w/.test(r)&&e(r);return i&&i.length&&[[i.position().top+(!e.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(\".active\").removeClass(\"active\"),r=this.selector+'[data-target=\"'+t+'\"],'+this.selector+'[href=\"'+t+'\"]',n=e(r).parent(\"li\").addClass(\"active\"),n.parent(\".dropdown-menu\").length&&(n=n.closest(\"li.dropdown\").addClass(\"active\")),n.trigger(\"activate\")}};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data(\"scrollspy\"),s=typeof n==\"object\"&&n;i||r.data(\"scrollspy\",i=new t(this,s)),typeof n==\"string\"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on(\"load\",function(){e('[data-spy=\"scroll\"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){\"use strict\";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest(\"ul:not(.dropdown-menu)\"),r=t.attr(\"data-target\"),i,s,o;r||(r=t.attr(\"href\"),r=r&&r.replace(/.*(?=#[^\\s]*$)/,\"\"));if(t.parent(\"li\").hasClass(\"active\"))return;i=n.find(\".active:last a\")[0],o=e.Event(\"show\",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent(\"li\"),n),this.activate(s,s.parent(),function(){t.trigger({type:\"shown\",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass(\"active\").find(\"> .dropdown-menu > .active\").removeClass(\"active\"),t.addClass(\"active\"),s?(t[0].offsetWidth,t.addClass(\"in\")):t.removeClass(\"fade\"),t.parent(\".dropdown-menu\")&&t.closest(\"li.dropdown\").addClass(\"active\"),r&&r()}var i=n.find(\"> .active\"),s=r&&e.support.transition&&i.hasClass(\"fade\");s?i.one(e.support.transition.end,o):o(),i.removeClass(\"in\")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data(\"tab\");i||r.data(\"tab\",i=new t(this)),typeof n==\"string\"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on(\"click.tab.data-api\",'[data-toggle=\"tab\"], [data-toggle=\"pill\"]',function(t){t.preventDefault(),e(this).tab(\"show\")})}(window.jQuery),!function(e){\"use strict\";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=e(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(\".active\").attr(\"data-value\");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g,\"\\\\$&\");return e.replace(new RegExp(\"(\"+t+\")\",\"ig\"),function(e,t){return\"<strong>\"+t+\"</strong>\"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr(\"data-value\",r),t.find(\"a\").html(n.highlighter(r)),t[0]}),t.first().addClass(\"active\"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(\".active\").removeClass(\"active\"),r=n.next();r.length||(r=e(this.$menu.find(\"li\")[0])),r.addClass(\"active\")},prev:function(e){var t=this.$menu.find(\".active\").removeClass(\"active\"),n=t.prev();n.length||(n=this.$menu.find(\"li\").last()),n.addClass(\"active\")},listen:function(){this.$element.on(\"focus\",e.proxy(this.focus,this)).on(\"blur\",e.proxy(this.blur,this)).on(\"keypress\",e.proxy(this.keypress,this)).on(\"keyup\",e.proxy(this.keyup,this)),this.eventSupported(\"keydown\")&&this.$element.on(\"keydown\",e.proxy(this.keydown,this)),this.$menu.on(\"click\",e.proxy(this.click,this)).on(\"mouseenter\",\"li\",e.proxy(this.mouseenter,this)).on(\"mouseleave\",\"li\",e.proxy(this.mouseleave,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,\"return;\"),t=typeof this.$element[e]==\"function\"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(\".active\").removeClass(\"active\"),e(t.currentTarget).addClass(\"active\")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data(\"typeahead\"),s=typeof n==\"object\"&&n;i||r.data(\"typeahead\",i=new t(this,s)),typeof n==\"string\"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class=\"typeahead dropdown-menu\"></ul>',item:'<li><a href=\"#\"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on(\"focus.typeahead.data-api\",'[data-provide=\"typeahead\"]',function(t){var n=e(this);if(n.data(\"typeahead\"))return;n.typeahead(n.data())})}(window.jQuery),!function(e){\"use strict\";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on(\"scroll.affix.data-api\",e.proxy(this.checkPosition,this)).on(\"click.affix.data-api\",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(\":visible\"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u=\"affix affix-top affix-bottom\",a;typeof i!=\"object\"&&(s=o=i),typeof o==\"function\"&&(o=i.top()),typeof s==\"function\"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?\"bottom\":o!=null&&n<=o?\"top\":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a==\"bottom\"?r.top-n:null,this.$element.removeClass(u).addClass(\"affix\"+(a?\"-\"+a:\"\"))};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data(\"affix\"),s=typeof n==\"object\"&&n;i||r.data(\"affix\",i=new t(this,s)),typeof n==\"string\"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on(\"load\",function(){e('[data-spy=\"affix\"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery);","/* ===========================================================\r\n* bootstrap-datepicker.js v1.3.0\r\n* http://twitter.github.com/bootstrap/javascript.html#datepicker\r\n* ===========================================================\r\n* Copyright 2011 Twitter, Inc.\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n* http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n*\r\n* Contributed by Scott Torborg - github.com/storborg\r\n* Loosely based on jquery.date_input.js by Jon Leighton, heavily updated and\r\n* rewritten to match bootstrap javascript approach and add UI features.\r\n* =========================================================== */\r\n\r\n\r\n/*!!!!\r\n Changed in asyst for correct Chrome invalide behavior with new russia timezone (rtz+x)\r\n !!!!!*/\r\n\r\n!function ($) {\r\n    jQuery.fn.offsetRelative = function(args) {\r\n        //var el = $('#PlanDate >input');\r\n        var el = this;\r\n        var offset = el.offset();\r\n        var parentOffset = el.offsetParent().offset();\r\n        offset.left -= parentOffset.left;\r\n        offset.top -= parentOffset.top;\r\n        return offset;\r\n    };\r\n    \r\n    var selector = '[data-datepicker]',\r\n      all = [];\r\n\r\n    function clearDatePickers(except) {\r\n        var ii;\r\n        for (ii = 0; ii < all.length; ii++) {\r\n            if (all[ii] != except) {\r\n                all[ii].hide();\r\n            }\r\n        }\r\n    }\r\n\r\n    function DatePicker(element, options) {\r\n        this.$el = $(element);\r\n        this.DateTimeFormat = this.$el.data('date-time-format');\r\n        this.proxy('show').proxy('ahead').proxy('hide').proxy('keyHandler').proxy('selectDate');\r\n\r\n        var options = $.extend({}, $.fn.datepicker.defaults, options);\r\n\r\n        if (!this.detectNative()) {\r\n            $.extend(this, options);\r\n            this.$el.data('datepicker', this);\r\n            all.push(this);\r\n            this.init();\r\n        }\r\n        this.$el.data('date-time-format', this.DateTimeFormat);\r\n    }\r\n\r\n    DatePicker.prototype = {\r\n\r\n        detectNative: function (el) {\r\n            // Attempt to activate the native datepicker, if there is a known good\r\n            // one. If successful, return true. Note that input type=\"date\"\r\n            // requires that the string be RFC3339, so if the format/parse methods\r\n            // have been overridden, this won't be used.\r\n            if (navigator.userAgent.match(/(iPad|iPhone); CPU(\\ iPhone)? OS 5_\\d/i)) {\r\n                // jQuery will only change the input type of a detached element.\r\n                var $marker = $('<span>').insertBefore(this.$el);\r\n                this.$el.detach().attr('type', 'date').insertAfter($marker);\r\n                $marker.remove();\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n\r\n    , init: function () {\r\n        var $months = this.nav('months', 1);\r\n        var $years = this.nav('years', 12);\r\n\r\n        var $nav = $('<div>').addClass('nav').append($months, $years);\r\n\r\n        this.$month = $('.name', $months);\r\n        this.$year = $('.name', $years);\r\n\r\n        $calendar = $(\"<div>\").addClass('calendar');\r\n\r\n        // Populate day of week headers, realigned by startOfWeek.\r\n        for (var i = 0; i < Asyst.date.shortDayNames.length; i++) {\r\n            $calendar.append('<div class=\"dow\">' + Asyst.date.shortDayNames[(i + Asyst.date.startOfWeek) % 7] + '</div>');\r\n        };\r\n\r\n        this.$days = $('<div>').addClass('days');\r\n        $calendar.append(this.$days);\r\n\r\n        this.$picker = $('<div>')\r\n          .click(function (e) { e.stopPropagation() })\r\n          .mousedown(function (e) { e.preventDefault() })\r\n          .addClass('datepicker')\r\n          .append($nav, $calendar)\r\n          .insertAfter(this.$el);\r\n\r\n        this.$el\r\n          .focus(this.show)\r\n          .click(this.show)\r\n          .change($.proxy(function () { this.selectDate(); }, this));\r\n\r\n        this.selectDate();\r\n        this.hide();\r\n    }\r\n\r\n    , nav: function (c, months) {\r\n        var $subnav = $('<div>' +\r\n                          '<span class=\"prev button\">&larr;</span>' +\r\n                          '<span class=\"name\"></span>' +\r\n                          '<span class=\"next button\">&rarr;</span>' +\r\n                        '</div>').addClass(c)\r\n        $('.prev', $subnav).click($.proxy(function () { this.ahead(-months, 0) }, this));\r\n        $('.next', $subnav).click($.proxy(function () { this.ahead(months, 0) }, this));\r\n        return $subnav;\r\n\r\n    }\r\n\r\n    , updateName: function ($area, s) {\r\n        // Update either the month or year field\r\n        var $fg = $('<div>').addClass('fg').append(s);\r\n        $area.empty();\r\n        $area.append($fg);\r\n    }\r\n    , isPoorDate: function (date) {\r\n        var date2 = new Date(date);\r\n        date2.setHours(date2.getHours()+2);\r\n        return (date.getMonth() != date2.getMonth()) || (date.getDate() != date2.getDate());\r\n    }\r\n    ,selectMonth: function (date) {\r\n        var newMonth = new Date(date.getFullYear(), date.getMonth(), 1);\r\n        if (this.isPoorDate(newMonth)) {\r\n           newMonth = new Date(date.getFullYear(), date.getMonth(), 1,1);\r\n        }\r\n\r\n        if (!this.curMonth || !(this.curMonth.getFullYear() == newMonth.getFullYear() &&\r\n                                this.curMonth.getMonth() == newMonth.getMonth())) {\r\n\r\n            this.curMonth = newMonth;\r\n\r\n            var rangeStart = this.rangeStart(date), rangeEnd = this.rangeEnd(date);\r\n            var num_days = this.daysBetween(rangeStart, rangeEnd);\r\n            this.$days.empty();\r\n\r\n            for (var ii = 0; ii <= num_days; ii++) {\r\n                var thisDay = new Date(rangeStart.getFullYear(), rangeStart.getMonth(), rangeStart.getDate() + ii);\r\n                if (this.isPoorDate(thisDay)) {\r\n                    thisDay = new Date(rangeStart.getFullYear(), rangeStart.getMonth(), rangeStart.getDate() + ii, 1);\r\n                }\r\n                var $day = $('<div>').attr('date', this.format(thisDay));\r\n                $day.text(thisDay.getDate());\r\n\r\n                if (thisDay.getMonth() != date.getMonth()) {\r\n                    $day.addClass('overlap');\r\n                };\r\n\r\n                this.$days.append($day);\r\n            };\r\n\r\n            this.updateName(this.$month, Asyst.date.monthNames[date.getMonth()]);\r\n            this.updateName(this.$year, this.curMonth.getFullYear());\r\n\r\n            $('div', this.$days).click($.proxy(function (e) {\r\n                var $targ = $(e.target);\r\n\r\n                // The date= attribute is used here to provide relatively fast\r\n                // selectors for setting certain date cells.\r\n                this.update($targ.attr(\"date\"), true);\r\n\r\n                // Don't consider this selection final if we're just going to an\r\n                // adjacent month.\r\n                if (!$targ.hasClass('overlap')) {\r\n                    this.hide();\r\n                }\r\n\r\n            }, this));\r\n\r\n            $(\"[date='\" + this.format(new Date()) + \"']\", this.$days).addClass('today');\r\n\r\n        };\r\n\r\n        $('.selected', this.$days).removeClass('selected');\r\n        $('[date=\"' + this.selectedDateStr + '\"]', this.$days).addClass('selected');\r\n    }\r\n\r\n    , selectDate: function (date) {\r\n        if (typeof (date) == \"undefined\") {\r\n            date = this.parse(this.$el.val());\r\n        };\r\n        if (!date) date = new Date();\r\n\r\n        this.selectedDate = date;\r\n        this.selectedDateStr = this.format(this.selectedDate);\r\n        this.selectMonth(this.selectedDate);\r\n    }\r\n\r\n    , update: function (s, dateOnly) {\r\n        if (dateOnly) {\r\n            var date = this.parse(s);\r\n            var val = this.parse(this.$el.val());\r\n            if (val) {\r\n                if (this.selectedDate) {\r\n                    date.setHours(val.getUTCHours());\r\n                    date.setMinutes(val.getUTCMinutes());\r\n                    date.setSeconds(val.getUTCSeconds());\r\n                    date.setMilliseconds(val.getUTCMilliseconds());\r\n                }\r\n                s = this.format(date);\r\n            }\r\n            this.$el.val(s).change();\r\n        }\r\n        else\r\n            this.$el.val(s).change();\r\n    }\r\n\r\n    , show: function (e) {\r\n        e && e.stopPropagation();\r\n\r\n        // Hide all other datepickers.\r\n        clearDatePickers(this);\r\n\r\n        $('html').on('keydown', this.keyHandler);\r\n\r\n\t\tthis.position();\r\n\t\tthis.bind_reposition(this.$el, this.$picker);\r\n\t}\r\n\r\n\t, position: function() {\r\n\t\tvar element = this.$el;\r\n\t\tvar picker = this.$picker;\r\n        var offset = element.offsetRelative();\r\n        if (offset) {\r\n\t\t\tvar left = offset.left;\r\n\t\t\t//if (picker.closest('.modal').length > 0) { left -= picker.closest('.modal').offset().left; }\r\n            picker.css({\r\n                top: offset.top + element.outerHeight() + 2,\r\n                left: left\r\n            }).show();\r\n        }\r\n        else {\r\n\t\t\tvar left = element.left;\r\n\t\t\t//if (picker.closest('.modal').length > 0) { left -= picker.closest('.modal').offset().left; }\r\n            picker.css({\r\n                top: element.top,\r\n                left: left\r\n            }).show();\r\n        }\r\n\t}\r\n\r\n\t, reposition: function(e) {\r\n\t\tvar element = e.data.element;\r\n\t\tvar picker = e.data.picker;\r\n        var offset = element.offsetRelative();\r\n        if (offset) {\r\n\t\t\tvar left = offset.left;\r\n\t\t\t//if (picker.closest('.modal').length > 0) { left -= picker.closest('.modal').offset().left; }\r\n            picker.css({\r\n                top: offset.top + element.outerHeight() + 2,\r\n                left: left\r\n            });\r\n        }\r\n        else {\r\n\t\t\tvar left = element.left;\r\n\t\t\t//if (picker.closest('.modal').length > 0) { left -= picker.closest('.modal').offset().left; }\r\n            picker.css({\r\n                top: element.top,\r\n                left: left\r\n            });\r\n        }\r\n\t}\r\n\r\n\t, bind_reposition: function(element, picker) {\r\n\t\t$(window).bind('resize', {element: element, picker: picker}, this.reposition);\r\n\t}\t\r\n\r\n    , hide: function () {\r\n        this.$picker.hide();\r\n        $('html').off('keydown', this.keyHandler);\r\n    }\r\n\r\n    , keyHandler: function (e) {\r\n        // Keyboard navigation shortcuts.\r\n        switch (e.keyCode) {\r\n            case 9:\r\n            case 27:\r\n                // Tab or escape hides the datepicker. In this case, just return\r\n                // instead of breaking, so that the e doesn't get stopped.\r\n                this.hide(); return;\r\n            case 13:\r\n                // Enter selects the currently highlighted date.\r\n                this.update(this.selectedDateStr); this.hide(); break;\r\n            case 38:\r\n                // Arrow up goes to prev week.\r\n                this.ahead(0, -7); break;\r\n            case 40:\r\n                // Arrow down goes to next week.\r\n                this.ahead(0, 7); break;\r\n            case 37:\r\n                // Arrow left goes to prev day.\r\n                this.ahead(0, -1); break;\r\n            case 39:\r\n                // Arrow right goes to next day.\r\n                this.ahead(0, 1); break;\r\n            default:\r\n                this.hide();\r\n                return;\r\n        }\r\n        e.preventDefault();\r\n    }\r\n\r\n    , parse: function (s) {\r\n        return Asyst.date.parse(s, this.DateTimeFormat);\r\n    }\r\n\r\n    , format: function (date) {\r\n        return Asyst.date.format(date, this.DateTimeFormat);\r\n    }\r\n\r\n    , ahead: function (months, days) {\r\n        // Move ahead ``months`` months and ``days`` days, both integers, can be\r\n        // negative.\r\n        this.selectDate(new Date(this.selectedDate.getFullYear(),\r\n                                 this.selectedDate.getMonth() + months,\r\n                                 this.selectedDate.getDate() + days\r\n                                 ));\r\n    }\r\n\r\n    , proxy: function (meth) {\r\n        // Bind a method so that it always gets the datepicker instance for\r\n        // ``this``. Return ``this`` so chaining calls works.\r\n        this[meth] = $.proxy(this[meth], this);\r\n        return this;\r\n    }\r\n\r\n    , daysBetween: function (start, end) {\r\n        // Return number of days between ``start`` Date object and ``end``.\r\n        var start = Date.UTC(start.getFullYear(), start.getMonth(), start.getDate());\r\n        var end = Date.UTC(end.getFullYear(), end.getMonth(), end.getDate());\r\n        return (end - start) / 86400000;\r\n    }\r\n\r\n    , findClosest: function (dow, date, direction) {\r\n        // From a starting date, find the first day ahead of behind it that is\r\n        // a given day of the week.\r\n        var difference = direction * (Math.abs(date.getDay() - dow - (direction * 7)) % 7);\r\n        return new Date(date.getFullYear(), date.getMonth(), date.getDate() + difference);\r\n    }\r\n\r\n    , rangeStart: function (date) {\r\n        // Get the first day to show in the current calendar view.\r\n        return this.findClosest(Asyst.date.startOfWeek,\r\n                                new Date(date.getFullYear(), date.getMonth()),\r\n                                -1);\r\n    }\r\n\r\n    , rangeEnd: function (date) {\r\n        // Get the last day to show in the current calendar view.\r\n        return this.findClosest((Asyst.date.startOfWeek - 1) % 7,\r\n                                new Date(date.getFullYear(), date.getMonth() + 1, 0),\r\n                                1);\r\n    }\r\n    };\r\n\r\n    /* DATEPICKER PLUGIN DEFINITION\r\n    * ============================ */\r\n\r\n    $.fn.datepicker = function (options) {\r\n        return this.each(function () { new DatePicker(this, options); });\r\n    };\r\n\r\n    $(function () {\r\n        $(selector).datepicker();\r\n        $('html').click(clearDatePickers);\r\n    });\r\n\r\n    $.fn.datepicker.DatePicker = DatePicker;\r\n\r\n} (window.jQuery || window.ender);\r\n","/* ===========================================================\r\n * bootstrap-modal.js v2.1\r\n * ===========================================================\r\n * Copyright 2012 Jordan Schroter\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n * ========================================================== */\r\n\r\n\r\n!function ($) {\r\n\r\n\t\"use strict\"; // jshint ;_;\r\n\r\n\t/* MODAL CLASS DEFINITION\r\n\t* ====================== */\r\n\r\n\tvar Modal = function (element, options) {\r\n\t\tthis.init(element, options);\r\n\t};\r\n\r\n\tModal.prototype = {\r\n\r\n\t\tconstructor: Modal,\r\n\r\n\t\tinit: function (element, options) {\r\n\t\t\tthis.options = options;\r\n\r\n\t\t\tthis.$element = $(element)\r\n\t\t\t\t.delegate('[data-dismiss=\"modal\"]', 'click.dismiss.modal', $.proxy(this.hide, this));\r\n\r\n\t\t\tthis.options.remote && this.$element.find('.modal-body').load(this.options.remote);\r\n\r\n\t\t\tvar manager = typeof this.options.manager === 'function' ?\r\n\t\t\t\tthis.options.manager.call(this) : this.options.manager;\r\n\r\n\t\t\tmanager = manager.appendModal ?\r\n\t\t\t\tmanager : $(manager).modalmanager().data('modalmanager');\r\n\r\n\t\t\tmanager.appendModal(this);\r\n\t\t},\r\n\r\n\t\ttoggle: function () {\r\n\t\t\treturn this[!this.isShown ? 'show' : 'hide']();\r\n\t\t},\r\n\r\n\t\tshow: function () {\r\n\t\t\tvar e = $.Event('show');\r\n\r\n\t\t\tif (this.isShown) return;\r\n\r\n\t\t\tthis.$element.trigger(e);\r\n\r\n\t\t\tif (e.isDefaultPrevented()) return;\r\n\r\n\t\t\tthis.escape();\r\n\r\n\t\t\tthis.tab();\r\n\r\n\t\t\tthis.options.loading && this.loading();\r\n\t\t},\r\n\r\n\t\thide: function (e) {\r\n\t\t\te && e.preventDefault();\r\n\r\n\t\t\te = $.Event('hide');\r\n\r\n\t\t\tthis.$element.trigger(e);\r\n\r\n\t\t\tif (!this.isShown || e.isDefaultPrevented()) return (this.isShown = false);\r\n\r\n\t\t\tthis.isShown = false;\r\n\r\n\t\t\tthis.escape();\r\n\r\n\t\t\tthis.tab();\r\n\r\n\t\t\tthis.isLoading && this.loading();\r\n\r\n\t\t\t$(document).off('focusin.modal');\r\n\r\n\t\t\tthis.$element\r\n\t\t\t\t.removeClass('in')\r\n\t\t\t\t.removeClass('animated')\r\n\t\t\t\t.removeClass(this.options.attentionAnimation)\r\n\t\t\t\t.removeClass('modal-overflow')\r\n\t\t\t\t.attr('aria-hidden', true);\r\n\r\n\t\t\t$.support.transition && this.$element.hasClass('fade') ?\r\n\t\t\t\tthis.hideWithTransition() :\r\n\t\t\t\tthis.hideModal();\r\n\t\t},\r\n\r\n\t\tlayout: function () {\r\n\t\t\tvar prop = this.options.height ? 'height' : 'max-height',\r\n\t\t\t\tvalue = this.options.height || this.options.maxHeight;\r\n\r\n\t\t\tif (this.options.width){\r\n\t\t\t\tthis.$element.css('width', this.options.width);\r\n\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tthis.$element.css('margin-left', function () {\r\n\t\t\t\t\tif (/%/ig.test(that.options.width)){\r\n\t\t\t\t\t\treturn -(parseInt(that.options.width) / 2) + '%';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn -($(this).width() / 2) + 'px';\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t    //\r\n\t\t\t\t//this.$element.css('width', '');\r\n\t\t\t\t//this.$element.css('margin-left', '');\r\n\t\t\t}\r\n\r\n\t\t\tthis.$element.find('.modal-body')\r\n\t\t\t\t.css('overflow', '')\r\n\t\t\t\t.css(prop, '');\r\n\r\n\t\t\tvar modalOverflow = $(window).height() - 10 < this.$element.height();\r\n\r\n\t\t\tif (value){\r\n\t\t\t\tthis.$element.find('.modal-body')\r\n\t\t\t\t\t.css('overflow', 'auto')\r\n\t\t\t\t\t.css(prop, value);\r\n\t\t\t}\r\n\r\n\t\t\tif (modalOverflow || this.options.modalOverflow) {\r\n\t\t\t\tthis.$element\r\n\t\t\t\t\t.css('margin-top', 0)\r\n\t\t\t\t\t.addClass('modal-overflow');\r\n\t\t\t} else {\r\n\t\t\t\t//this.$element\r\n\t\t\t    // \t.css('margin-top', 0 - this.$element.height() / 2)\r\n\t\t\t\t//\t.removeClass('modal-overflow');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttab: function () {\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tif (this.isShown && this.options.consumeTab) {\r\n\t\t\t\tthis.$element.on('keydown.tabindex.modal', '[data-tabindex]', function (e) {\r\n\t\t\t    \tif (e.keyCode && e.keyCode == 9){\r\n\t\t\t\t\t\tvar $next = $(this),\r\n\t\t\t\t\t\t\t$rollover = $(this);\r\n\r\n\t\t\t\t\t\tthat.$element.find('[data-tabindex]:enabled:not([readonly])').each(function (e) {\r\n\t\t\t\t\t\t\tif (!e.shiftKey){\r\n\t\t\t\t\t\t \t\t$next = $next.data('tabindex') < $(this).data('tabindex') ?\r\n\t\t\t\t\t\t\t\t\t$next = $(this) :\r\n\t\t\t\t\t\t\t\t\t$rollover = $(this);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$next = $next.data('tabindex') > $(this).data('tabindex') ?\r\n\t\t\t\t\t\t\t\t\t$next = $(this) :\r\n\t\t\t\t\t\t\t\t\t$rollover = $(this);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$next[0] !== $(this)[0] ?\r\n\t\t\t\t\t\t\t$next.focus() : $rollover.focus();\r\n\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (!this.isShown) {\r\n\t\t\t\tthis.$element.off('keydown.tabindex.modal');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tescape: function () {\r\n\t\t\tvar that = this;\r\n\t\t\tif (this.isShown && this.options.keyboard) {\r\n\t\t\t\tif (!this.$element.attr('tabindex')) this.$element.attr('tabindex', -1);\r\n\r\n\t\t\t\tthis.$element.on('keyup.dismiss.modal', function (e) {\r\n\t\t\t\t\te.which == 27 && that.hide();\r\n\t\t\t\t});\r\n\t\t\t} else if (!this.isShown) {\r\n\t\t\t\tthis.$element.off('keyup.dismiss.modal')\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\thideWithTransition: function () {\r\n\t\t\tvar that = this\r\n\t\t\t\t, timeout = setTimeout(function () {\r\n\t\t\t\t\tthat.$element.off($.support.transition.end);\r\n\t\t\t\t\tthat.hideModal();\r\n\t\t\t\t}, 500);\r\n\r\n\t\t\tthis.$element.one($.support.transition.end, function () {\r\n\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\tthat.hideModal();\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\thideModal: function () {\r\n\t\t\tthis.$element\r\n\t\t\t\t.hide()\r\n\t\t\t\t.trigger('hidden');\r\n\r\n\t\t\tvar prop = this.options.height ? 'height' : 'max-height';\r\n\t\t\tvar value = this.options.height || this.options.maxHeight;\r\n\r\n\t\t\tif (value){\r\n\t\t\t\tthis.$element.find('.modal-body')\r\n\t\t\t\t\t.css('overflow', '')\r\n\t\t\t\t\t.css(prop, '');\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tremoveLoading: function () {\r\n\t\t\tthis.$loading.remove();\r\n\t\t\tthis.$loading = null;\r\n\t\t\tthis.isLoading = false;\r\n\t\t},\r\n\r\n\t\tloading: function (callback) {\r\n\t\t\tcallback = callback || function () {};\r\n\r\n\t\t\tvar animate = this.$element.hasClass('fade') ? 'fade' : '';\r\n\r\n\t\t\tif (!this.isLoading) {\r\n\t\t\t\tvar doAnimate = $.support.transition && animate;\r\n\r\n\t\t\t\tthis.$loading = $('<div class=\"loading-mask ' + animate + '\">')\r\n\t\t\t\t\t.append(this.options.spinner)\r\n\t\t\t\t\t.appendTo(this.$element);\r\n\r\n\t\t\t\tif (doAnimate) this.$loading[0].offsetWidth; // force reflow\r\n\r\n\t\t\t\tthis.$loading.addClass('in');\r\n\r\n\t\t\t\tthis.isLoading = true;\r\n\r\n\t\t\t\tdoAnimate ?\r\n\t\t\t\t\tthis.$loading.one($.support.transition.end, callback) :\r\n\t\t\t\t\tcallback();\r\n\r\n\t\t\t} else if (this.isLoading && this.$loading) {\r\n\t\t\t\tthis.$loading.removeClass('in');\r\n\r\n\t\t\t\tvar that = this;\r\n\t\t\t\t$.support.transition && this.$element.hasClass('fade')?\r\n\t\t\t\t\tthis.$loading.one($.support.transition.end, function () { that.removeLoading() }) :\r\n\t\t\t\t\tthat.removeLoading();\r\n\r\n\t\t\t} else if (callback) {\r\n\t\t\t\tcallback(this.isLoading);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfocus: function () {\r\n\t\t\tvar $focusElem = this.$element.find(this.options.focusOn);\r\n\r\n\t\t\t$focusElem = $focusElem.length ? $focusElem : this.$element;\r\n\r\n\t\t\t$focusElem.focus();\r\n\t\t},\r\n\r\n\t\tattention: function (){\r\n\t\t\t// NOTE: transitionEnd with keyframes causes odd behaviour\r\n\r\n\t\t\tif (this.options.attentionAnimation){\r\n\t\t\t\tthis.$element\r\n\t\t\t\t\t.removeClass('animated')\r\n\t\t\t\t\t.removeClass(this.options.attentionAnimation);\r\n\r\n\t\t\t\tvar that = this;\r\n\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tthat.$element\r\n\t\t\t\t\t\t.addClass('animated')\r\n\t\t\t\t\t\t.addClass(that.options.attentionAnimation);\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis.focus();\r\n\t\t},\r\n\r\n\r\n\t\tdestroy: function () {\r\n\t\t\tvar e = $.Event('destroy');\r\n\t\t\tthis.$element.trigger(e);\r\n\t\t\tif (e.isDefaultPrevented()) return;\r\n\t\t\tthis.teardown();\r\n\t\t},\r\n\r\n\t\tteardown: function () {\r\n\t\t\tif (!this.$parent.length){\r\n\t\t\t\tthis.$element.remove();\r\n\t\t\t\tthis.$element = null;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.$parent !== this.$element.parent()){\r\n\t\t\t\t//this.$element.appendTo(this.$parent);\r\n\t\t\t}\r\n\r\n\t\t\tthis.$element.off('.modal');\r\n\t\t\tthis.$element.removeData('modal');\r\n\t\t\tthis.$element\r\n\t\t\t\t.removeClass('in')\r\n\t\t\t\t.attr('aria-hidden', true);\r\n\t\t}\r\n\t};\r\n\r\n\r\n\t/* MODAL PLUGIN DEFINITION\r\n\t* ======================= */\r\n\r\n\t$.fn.modal = function (option, args) {\r\n\t\treturn this.each(function () {\r\n\t\t\tvar $this = $(this),\r\n\t\t\t\tdata = $this.data('modal'),\r\n\t\t\t\toptions = $.extend({}, $.fn.modal.defaults, $this.data(), typeof option == 'object' && option);\r\n\r\n\t\t\tif (!data) $this.data('modal', (data = new Modal(this, options)));\r\n\t\t\tif (typeof option == 'string') data[option].apply(data, [].concat(args));\r\n\t\t\telse if (options.show) data.show()\r\n\t\t})\r\n\t};\r\n\r\n\t$.fn.modal.defaults = {\r\n\t\tkeyboard: true,\r\n\t\tbackdrop: true,\r\n\t\tloading: false,\r\n\t\tshow: true,\r\n\t\twidth: null,\r\n\t\theight: null,\r\n\t\tmaxHeight: null,\r\n\t\tmodalOverflow: false,\r\n\t\tconsumeTab: true,\r\n\t\tfocusOn: null,\r\n\t\treplace: false,\r\n\t\tresize: false,\r\n\t\tattentionAnimation: 'shake',\r\n\t\tmanager: 'body',\r\n\t\tspinner: '<div class=\"loading-spinner\" style=\"width: 200px; margin-left: -100px;\"><div class=\"progress progress-striped active\"><div class=\"bar\" style=\"width: 100%;\"></div></div></div>'\r\n\t};\r\n\r\n\t$.fn.modal.Constructor = Modal;\r\n\r\n\r\n\t/* MODAL DATA-API\r\n\t* ============== */\r\n\r\n\t$(function () {\r\n\t\t$(document).off('click.modal').on('click.modal.data-api', '[data-toggle=\"modal\"]', function ( e ) {\r\n\t\t\tvar $this = $(this),\r\n\t\t\t\thref = $this.attr('href'),\r\n\t\t\t\t$target = $($this.attr('data-target') || (href && href.replace(/.*(?=#[^\\s]+$)/, ''))), //strip for ie7\r\n\t\t\t\toption = $target.data('modal') ? 'toggle' : $.extend({ remote: !/#/.test(href) && href }, $target.data(), $this.data());\r\n\r\n\t\t\te.preventDefault();\r\n\t\t\t$target\r\n\t\t\t\t.modal(option)\r\n\t\t\t\t.one('hide', function () {\r\n\t\t\t\t\t$this.focus();\r\n\t\t\t\t})\r\n\t\t});\r\n\t});\r\n\r\n}(window.jQuery);","/* ===========================================================\r * bootstrap-modalmanager.js v2.1\r * ===========================================================\r * Copyright 2012 Jordan Schroter.\r *\r * Licensed under the Apache License, Version 2.0 (the \"License\");\r * you may not use this file except in compliance with the License.\r * You may obtain a copy of the License at\r *\r * http://www.apache.org/licenses/LICENSE-2.0\r *\r * Unless required by applicable law or agreed to in writing, software\r * distributed under the License is distributed on an \"AS IS\" BASIS,\r * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r * See the License for the specific language governing permissions and\r * limitations under the License.\r * ========================================================== */\r;\r!function ($) {\r\r\t\"use strict\"; // jshint ;_;\r\r\t/* MODAL MANAGER CLASS DEFINITION\r\t* ====================== */\r\r\tvar ModalManager = function (element, options) {\r\t\tthis.init(element, options);\r\t};\r\r\tModalManager.prototype = {\r\r\t\tconstructor: ModalManager,\r\r\t\tinit: function (element, options) {\r\t\t\tthis.$element = $(element);\r\t\t\tthis.options = $.extend({}, $.fn.modalmanager.defaults, this.$element.data(), typeof options == 'object' && options);\r\t\t\tthis.stack = [];\r\t\t\tthis.backdropCount = 0;\r\r\t\t\tif (this.options.resize) {\r\t\t\t\tvar resizeTimeout,\r\t\t\t\t\tthat = this;\r\r\t\t\t\t$(window).on('resize.modal', function(){\r\t\t\t\t\tresizeTimeout && clearTimeout(resizeTimeout);\r\t\t\t\t\tresizeTimeout = setTimeout(function(){\r\t\t\t\t\t\tfor (var i = 0; i < that.stack.length; i++){\r\t\t\t\t\t\t\tthat.stack[i].isShown && that.stack[i].layout();\r\t\t\t\t\t\t}\r\t\t\t\t\t}, 10);\r\t\t\t\t});\r\t\t\t}\r\t\t},\r\r\t\tcreateModal: function (element, options) {\r\t\t\t$(element).modal($.extend({ manager: this }, options));\r\t\t},\r\r\t\tappendModal: function (modal) {\r\t\t\tthis.stack.push(modal);\r\r\t\t\tvar that = this;\r\r\t\t\tmodal.$element.on('show.modalmanager', targetIsSelf(function (e) {\r\r\t\t\t\tvar showModal = function(){\r\t\t\t\t\tmodal.isShown = true;\r\r\t\t\t\t\tvar transition = $.support.transition && modal.$element.hasClass('fade');\r\r\t\t\t\t\tthat.$element\r\t\t\t\t\t\t.toggleClass('modal-open', that.hasOpenModal())\r\t\t\t\t\t\t.toggleClass('page-overflow', $(window).height() < that.$element.height());\r\r\t\t\t\t\tmodal.$parent = modal.$element.parent();\r\r\t\t\t\t\tmodal.$container = that.createContainer(modal);\r\r\t\t\t\t\tmodal.$element.appendTo(modal.$container);\r\r\t\t\t\t\tthat.backdrop(modal, function () {\r\r\t\t\t\t\t\tmodal.$element.show();\r\r\t\t\t\t\t\tif (transition) {       \r\t\t\t\t\t\t\t//modal.$element[0].style.display = 'run-in';       \r\t\t\t\t\t\t\tmodal.$element[0].offsetWidth;\r\t\t\t\t\t\t\t//modal.$element.one($.support.transition.end, function () { modal.$element[0].style.display = 'block' });  \r\t\t\t\t\t\t}\r\t\t\t\t\t\t\r\t\t\t\t\t\tmodal.layout();\r\r\t\t\t\t\t\tmodal.$element\r\t\t\t\t\t\t\t.addClass('in')\r\t\t\t\t\t\t\t.attr('aria-hidden', false);\r\r\t\t\t\t\t\tvar complete = function () {\r\t\t\t\t\t\t\tthat.setFocus();\r\t\t\t\t\t\t\tmodal.$element.trigger('shown');\r\t\t\t\t\t\t};\r\r\t\t\t\t\t\ttransition ?\r\t\t\t\t\t\t\tmodal.$element.one($.support.transition.end, complete) :\r\t\t\t\t\t\t\tcomplete();\r\t\t\t\t\t});\r\t\t\t\t};\r\r\t\t\t\tmodal.options.replace ?\r\t\t\t\t\tthat.replace(showModal) :\r\t\t\t\t\tshowModal();\r\t\t\t}));\r\r\t\t\tmodal.$element.on('hidden.modalmanager', targetIsSelf(function (e) {\r\r\t\t\t\tthat.backdrop(modal);\r\r\t\t\t\tif (modal.$backdrop){\r\t\t\t\t\t$.support.transition && modal.$element.hasClass('fade') ?\r\t\t\t\t\t\tmodal.$backdrop.one($.support.transition.end, function () { that.destroyModal(modal); }) :\r\t\t\t\t\t\tthat.destroyModal(modal);\r\t\t\t\t} else {\r\t\t\t\t\tthat.destroyModal(modal);\r\t\t\t\t}\r\r\t\t\t}));\r\r\t\t\tmodal.$element.on('destroy.modalmanager', targetIsSelf(function (e) {\r\t\t\t\tthat.removeModal(modal);\r\t\t\t}));\r\r\t\t},\r\r\t\tdestroyModal: function (modal) {\r\r\t\t\tmodal.destroy();\r\r\t\t\tvar hasOpenModal = this.hasOpenModal();\r\r\t\t\tthis.$element.toggleClass('modal-open', hasOpenModal);\r\r\t\t\tif (!hasOpenModal){\r\t\t\t\tthis.$element.removeClass('page-overflow');\r\t\t\t}\r\r\t\t\tthis.removeContainer(modal);\r\r\t\t\tthis.setFocus();\r\t\t},\r\r\t\thasOpenModal: function () {\r\t\t\tfor (var i = 0; i < this.stack.length; i++){\r\t\t\t\tif (this.stack[i].isShown) return true;\r\t\t\t}\r\r\t\t\treturn false;\r\t\t},\r\r\t\tsetFocus: function () {\r\t\t\tvar topModal;\r\r\t\t\tfor (var i = 0; i < this.stack.length; i++){\r\t\t\t\tif (this.stack[i].isShown) topModal = this.stack[i];\r\t\t\t}\r\r\t\t\tif (!topModal) return;\r\r\t\t\ttopModal.focus();\r\r\t\t},\r\r\t\tremoveModal: function (modal) {\r\t\t\tmodal.$element.off('.modalmanager');\r\t\t\tif (modal.$backdrop) this.removeBackdrop(modal);\r\t\t\tthis.stack.splice(this.getIndexOfModal(modal), 1);\r\t\t},\r\r\t\tgetModalAt: function (index) {\r\t\t\treturn this.stack[index];\r\t\t},\r\r\t\tgetIndexOfModal: function (modal) {\r\t\t\tfor (var i = 0; i < this.stack.length; i++){\r\t\t\t\tif (modal === this.stack[i]) return i;\r\t\t\t}\r\t\t},\r\r\t\treplace: function (callback) {\r\t\t\tvar topModal;\r\r\t\t\tfor (var i = 0; i < this.stack.length; i++){\r\t\t\t\tif (this.stack[i].isShown) topModal = this.stack[i];\r\t\t\t}\r\r\t\t\tif (topModal) {\r\t\t\t\tthis.$backdropHandle = topModal.$backdrop;\r\t\t\t\ttopModal.$backdrop = null;\r\r\t\t\t\tcallback && topModal.$element.one('hidden',\r\t\t\t\t\ttargetIsSelf( $.proxy(callback, this) ));\r\r\t\t\t\ttopModal.hide();\r\t\t\t} else if (callback) {\r\t\t\t\tcallback();\r\t\t\t}\r\t\t},\r\r\t\tremoveBackdrop: function (modal) {\r\t\t\tmodal.$backdrop.remove();\r\t\t\tmodal.$backdrop = null;\r\t\t},\r\r\t\tcreateBackdrop: function (animate) {\r\t\t\tvar $backdrop;\r\r\t\t\tif (!this.$backdropHandle) {\r\t\t\t\t$backdrop = $('<div class=\"modal-backdrop ' + animate + '\" />')\r\t\t\t\t\t.appendTo(this.$element);\r\t\t\t} else {\r\t\t\t\t$backdrop = this.$backdropHandle;\r\t\t\t\t$backdrop.off('.modalmanager');\r\t\t\t\tthis.$backdropHandle = null;\r\t\t\t\tthis.isLoading && this.removeSpinner();\r\t\t\t}\r\r\t\t\treturn $backdrop;\r\t\t},\r\r\t\tremoveContainer: function (modal) {\r\t\t\tmodal.$container.remove();\r\t\t\tmodal.$container = null;\r\t\t},\r\r\t\tcreateContainer: function (modal) {\r\t\t\tvar $container;\r\r\t\t\t$container = $('<div class=\"modal-scrollable\">')\r\t\t\t\t.css('z-index', getzIndex( 'modal',\r\t\t\t\t\tmodal ? this.getIndexOfModal(modal) : this.stack.length ))\r\t\t\t\t.appendTo(this.$element);\r\r\t\t\tif (modal && modal.options.backdrop != 'static') {\r\t\t\t\t$container.on('click.modal', targetIsSelf(function (e) {\r\t\t\t\t\tmodal.hide();\r\t\t\t\t}));\r\t\t\t} else if (modal) {\r\t\t\t\t$container.on('click.modal', targetIsSelf(function (e) {\r\t\t\t\t\tmodal.attention();\r\t\t\t\t}));\r\t\t\t}\r\r\t\t\treturn $container;\r\r\t\t},\r\r\t\tbackdrop: function (modal, callback) {\r\t\t\tvar animate = modal.$element.hasClass('fade') ? 'fade' : '',\r\t\t\t\tshowBackdrop = modal.options.backdrop &&\r\t\t\t\t\tthis.backdropCount < this.options.backdropLimit;\r\r\t\t\tif (modal.isShown && showBackdrop) {\r\t\t\t\tvar doAnimate = $.support.transition && animate && !this.$backdropHandle;\r\r\t\t\t\tmodal.$backdrop = this.createBackdrop(animate);\r\r\t\t\t\tmodal.$backdrop.css('z-index', getzIndex( 'backdrop', this.getIndexOfModal(modal) ));\r\r\t\t\t\tif (doAnimate) modal.$backdrop[0].offsetWidth; // force reflow\r\r\t\t\t\tmodal.$backdrop.addClass('in');\r\r\t\t\t\tthis.backdropCount += 1;\r\r\t\t\t\tdoAnimate ?\r\t\t\t\t\tmodal.$backdrop.one($.support.transition.end, callback) :\r\t\t\t\t\tcallback();\r\r\t\t\t} else if (!modal.isShown && modal.$backdrop) {\r\t\t\t\tmodal.$backdrop.removeClass('in');\r\r\t\t\t\tthis.backdropCount -= 1;\r\r\t\t\t\tvar that = this;\r\r\t\t\t\t$.support.transition && modal.$element.hasClass('fade')?\r\t\t\t\t\tmodal.$backdrop.one($.support.transition.end, function () { that.removeBackdrop(modal); }) :\r\t\t\t\t\tthat.removeBackdrop(modal);\r\r\t\t\t} else if (callback) {\r\t\t\t\tcallback();\r\t\t\t}\r\t\t},\r\r\t\tremoveSpinner: function(){\r\t\t\tthis.$spinner && this.$spinner.remove();\r\t\t\tthis.$spinner = null;\r\t\t\tthis.isLoading = false;\r\t\t},\r\r\t\tremoveLoading: function () {\r\t\t\tthis.$backdropHandle && this.$backdropHandle.remove();\r\t\t\tthis.$backdropHandle = null;\r\t\t\tthis.removeSpinner();\r\t\t},\r\r\t\tloading: function (callback) {\r\t\t\tcallback = callback || function () { };\r\r\t\t\tthis.$element\r\t\t\t\t.toggleClass('modal-open', !this.isLoading || this.hasOpenModal())\r\t\t\t\t.toggleClass('page-overflow', $(window).height() < this.$element.height());\r\r\t\t\tif (!this.isLoading) {\r\r\t\t\t\tthis.$backdropHandle = this.createBackdrop('fade');\r\r\t\t\t\tthis.$backdropHandle[0].offsetWidth; // force reflow\r\r\t\t\t\tthis.$backdropHandle\r\t\t\t\t\t.css('z-index', getzIndex('backdrop', this.stack.length))\r\t\t\t\t\t.addClass('in');\r\r\t\t\t\tvar $spinner = $(this.options.spinner)\r\t\t\t\t\t.css('z-index', getzIndex('modal', this.stack.length))\r\t\t\t\t\t.appendTo(this.$element)\r\t\t\t\t\t.addClass('in');\r\r\t\t\t\tthis.$spinner = $(this.createContainer())\r\t\t\t\t\t.append($spinner)\r\t\t\t\t\t.on('click.modalmanager', $.proxy(this.loading, this));\r\r\t\t\t\tthis.isLoading = true;\r\r\t\t\t\t$.support.transition ?\r\t\t\t\t\tthis.$backdropHandle.one($.support.transition.end, callback) :\r\t\t\t\t\tcallback();\r\r\t\t\t} else if (this.isLoading && this.$backdropHandle) {\r\t\t\t\tthis.$backdropHandle.removeClass('in');\r\r\t\t\t\tvar that = this;\r\t\t\t\t$.support.transition ?\r\t\t\t\t\tthis.$backdropHandle.one($.support.transition.end, function () { that.removeLoading(); }) :\r\t\t\t\t\tthat.removeLoading();\r\r\t\t\t} else if (callback) {\r\t\t\t\tcallback(this.isLoading);\r\t\t\t}\r\t\t}\r\t};\r\r\t/* PRIVATE METHODS\r\t* ======================= */\r\r\t// computes and caches the zindexes\r\tvar getzIndex = (function () {\r\t\tvar zIndexFactor,\r\t\t\tbaseIndex = {};\r\n\r\n\t    return function(type, pos) {\r\n\r\n\t        if (typeof zIndexFactor === 'undefined') {\r\n\t            var $baseModal = $('<div class=\"modal hide\" />').appendTo('body'),\r\n\t                $baseBackdrop = $('<div class=\"modal-backdrop hide\" />').appendTo('body');\r\n\r\n\t            baseIndex['modal'] = +$baseModal.css('z-index');\r\n\t            baseIndex['backdrop'] = +$baseBackdrop.css('z-index');\r\n\t            zIndexFactor = baseIndex['modal'] - baseIndex['backdrop'];\r\n\r\n\t            $baseModal.remove();\r\n\t            $baseBackdrop.remove();\r\n\t            $baseBackdrop = $baseModal = null;\r\n\t        }\r\n\r\n\t        return baseIndex[type] + (zIndexFactor * pos);\r\n\r\n\t    };\r\n\t}());\r\r\t// make sure the event target is the modal itself in order to prevent\r\t// other components such as tabsfrom triggering the modal manager.\r\t// if Boostsrap namespaced events, this would not be needed.\r\tfunction targetIsSelf(callback) {\r\n\t    return function(e) {\r\n\t        if (this === e.target) {\r\n\t            return callback.apply(this, arguments);\r\n\t        }\r\n\t    };\r\n\t}\r\r\r\t/* MODAL MANAGER PLUGIN DEFINITION\r\t* ======================= */\r\r\t$.fn.modalmanager = function (option, args) {\r\n\t    return this.each(function() {\r\n\t        var $this = $(this),\r\n\t            data = $this.data('modalmanager');\r\n\r\n\t        if (!data) $this.data('modalmanager', (data = new ModalManager(this, option)));\r\n\t        if (typeof option === 'string') data[option].apply(data, [].concat(args));\r\n\t    });\r\n\t};\r\r\t$.fn.modalmanager.defaults = {\r\t\tbackdropLimit: 999,\r\t\tresize: true,\r\t\tspinner: '<div class=\"loading-spinner fade\" style=\"width: 200px; margin-left: -100px;\"><div class=\"progress progress-striped active\"><div class=\"bar\" style=\"width: 100%;\"></div></div></div>'\r\t};\r\n\r\n    $.fn.modalmanager.Constructor = ModalManager;\r\n\r\n}(jQuery);","/*!\r\nChosen, a Select Box Enhancer for jQuery and Prototype\r\nby Patrick Filler for Harvest, http://getharvest.com\r\n\r\nVersion 1.1.0\r\nFull source at https://github.com/harvesthq/chosen\r\nCopyright (c) 2011 Harvest http://getharvest.com\r\n\r\nMIT License, https://github.com/harvesthq/chosen/blob/master/LICENSE.md\r\nThis file is generated by `grunt build`, do not edit it by hand.\r\n*/\r\n\r\n(function() {\r\n  var $, AbstractChosen, Chosen, SelectParser, _ref,\r\n    __hasProp = {}.hasOwnProperty,\r\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\r\n\r\n  SelectParser = (function() {\r\n    function SelectParser() {\r\n      this.options_index = 0;\r\n      this.parsed = [];\r\n    }\r\n\r\n    SelectParser.prototype.add_node = function(child) {\r\n      if (child.nodeName.toUpperCase() === \"OPTGROUP\") {\r\n        return this.add_group(child);\r\n      } else {\r\n        return this.add_option(child);\r\n      }\r\n    };\r\n\r\n    SelectParser.prototype.add_group = function(group) {\r\n      var group_position, option, _i, _len, _ref, _results;\r\n      group_position = this.parsed.length;\r\n      this.parsed.push({\r\n        array_index: group_position,\r\n        group: true,\r\n        label: this.escapeExpression(group.label),\r\n        children: 0,\r\n        disabled: group.disabled\r\n      });\r\n      _ref = group.childNodes;\r\n      _results = [];\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        option = _ref[_i];\r\n        _results.push(this.add_option(option, group_position, group.disabled));\r\n      }\r\n      return _results;\r\n    };\r\n\r\n    SelectParser.prototype.get_option_text = function (option) {\r\n        var textNodeContents = [];\r\n        for (var child = option.firstChild; child; child = child.nextSibling) {\r\n            if (child.nodeType == 3) {\r\n                textNodeContents.push(child.nodeValue);\r\n            }\r\n        }\r\n        var text = textNodeContents.join(\"\");\r\n        return text;\r\n    }\r\n    SelectParser.prototype.add_option = function(option, group_position, group_disabled) {\r\n      if (option.nodeName.toUpperCase() === \"OPTION\") {\r\n        if (option.text !== \"\") {\r\n          if (group_position != null) {\r\n            this.parsed[group_position].children += 1;\r\n          }\r\n          this.parsed.push({\r\n            array_index: this.parsed.length,\r\n            options_index: this.options_index,\r\n            value: option.value,\r\n            text: option.text,\r\n            html: this.get_option_text(option),\r\n            //html: option.innerHTML,\r\n            selected: option.selected,\r\n            disabled: group_disabled === true ? group_disabled : option.disabled,\r\n            group_array_index: group_position,\r\n            classes: option.className,\r\n            style: option.style.cssText\r\n          });\r\n        } else {\r\n          this.parsed.push({\r\n            array_index: this.parsed.length,\r\n            options_index: this.options_index,\r\n            empty: true\r\n          });\r\n        }\r\n        return this.options_index += 1;\r\n      }\r\n    };\r\n\r\n    SelectParser.prototype.escapeExpression = function(text) {\r\n      var map, unsafe_chars;\r\n      if ((text == null) || text === false) {\r\n        return \"\";\r\n      }\r\n      if (!/[\\&\\<\\>\\\"\\'\\`]/.test(text)) {\r\n        return text;\r\n      }\r\n      map = {\r\n        \"<\": \"&lt;\",\r\n        \">\": \"&gt;\",\r\n        '\"': \"&quot;\",\r\n        \"'\": \"&#x27;\",\r\n        \"`\": \"&#x60;\"\r\n      };\r\n      unsafe_chars = /&(?!\\w+;)|[\\<\\>\\\"\\'\\`]/g;\r\n      return text.replace(unsafe_chars, function(chr) {\r\n        return map[chr] || \"&amp;\";\r\n      });\r\n    };\r\n\r\n    return SelectParser;\r\n\r\n  })();\r\n\r\n  SelectParser.select_to_array = function(select) {\r\n    var child, parser, _i, _len, _ref;\r\n    parser = new SelectParser();\r\n    _ref = select.childNodes;\r\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n      child = _ref[_i];\r\n      parser.add_node(child);\r\n    }\r\n    return parser.parsed;\r\n  };\r\n\r\n  AbstractChosen = (function() {\r\n    function AbstractChosen(form_field, options) {\r\n      this.form_field = form_field;\r\n      this.options = options != null ? options : {};\r\n      if (!AbstractChosen.browser_is_supported()) {\r\n        return;\r\n      }\r\n      this.is_multiple = this.form_field.multiple;\r\n      this.set_default_text();\r\n      this.set_default_values();\r\n      this.setup();\r\n      this.set_up_html();\r\n      this.register_observers();\r\n    }\r\n\r\n    AbstractChosen.prototype.set_default_values = function() {\r\n      var _this = this;\r\n      this.click_test_action = function(evt) {\r\n        return _this.test_active_click(evt);\r\n      };\r\n      this.activate_action = function(evt) {\r\n        return _this.activate_field(evt);\r\n      };\r\n      this.active_field = false;\r\n      this.mouse_on_container = false;\r\n      this.results_showing = false;\r\n      this.result_highlighted = null;\r\n      this.allow_single_deselect = (this.options.allow_single_deselect != null) && (this.form_field.options[0] != null) && this.form_field.options[0].text === \"\" ? this.options.allow_single_deselect : false;\r\n      this.disable_search_threshold = this.options.disable_search_threshold || 0;\r\n      this.disable_search = this.options.disable_search || false;\r\n      this.enable_split_word_search = this.options.enable_split_word_search != null ? this.options.enable_split_word_search : true;\r\n      this.group_search = this.options.group_search != null ? this.options.group_search : true;\r\n      this.search_contains = this.options.search_contains || false;\r\n      this.single_backstroke_delete = this.options.single_backstroke_delete != null ? this.options.single_backstroke_delete : true;\r\n      this.max_selected_options = this.options.max_selected_options || Infinity;\r\n      this.inherit_select_classes = this.options.inherit_select_classes || false;\r\n      this.display_selected_options = this.options.display_selected_options != null ? this.options.display_selected_options : true;\r\n      return this.display_disabled_options = this.options.display_disabled_options != null ? this.options.display_disabled_options : true;\r\n    };\r\n\r\n    AbstractChosen.prototype.set_default_text = function() {\r\n      if (this.form_field.getAttribute(\"data-placeholder\")) {\r\n        this.default_text = this.form_field.getAttribute(\"data-placeholder\");\r\n      } else if (this.is_multiple) {\r\n        this.default_text = this.options.placeholder_text_multiple || this.options.placeholder_text || AbstractChosen.default_multiple_text;\r\n      } else {\r\n        this.default_text = this.options.placeholder_text_single || this.options.placeholder_text || AbstractChosen.default_single_text;\r\n      }\r\n      return this.results_none_found = this.form_field.getAttribute(\"data-no_results_text\") || this.options.no_results_text || AbstractChosen.default_no_result_text;\r\n    };\r\n\r\n    AbstractChosen.prototype.mouse_enter = function() {\r\n      return this.mouse_on_container = true;\r\n    };\r\n\r\n    AbstractChosen.prototype.mouse_leave = function() {\r\n      return this.mouse_on_container = false;\r\n    };\r\n\r\n    AbstractChosen.prototype.input_focus = function(evt) {\r\n      var _this = this;\r\n      if ( 1 == 1/*this.is_multiple*/) {\r\n        if (!this.active_field) {\r\n          return setTimeout((function() {\r\n            return _this.container_mousedown();\r\n          }), 50);\r\n        }\r\n      } else {\r\n        if (!this.active_field) {\r\n          return this.activate_field();\r\n        }\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.input_blur = function(evt) {\r\n      var _this = this;\r\n      if (!this.mouse_on_container) {\r\n        this.active_field = false;\r\n        return setTimeout((function() {\r\n          return _this.blur_test();\r\n        }), 100);\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.results_option_build = function(options) {\r\n      var content, data, _i, _len, _ref;\r\n      content = '';\r\n      _ref = this.results_data;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        data = _ref[_i];\r\n        if (data.group) {\r\n          content += this.result_add_group(data);\r\n        } else {\r\n          content += this.result_add_option(data);\r\n        }\r\n        if (options != null ? options.first : void 0) {\r\n          if (data.selected && this.is_multiple) {\r\n            this.choice_build(data);\r\n          } else if (data.selected && !this.is_multiple) {\r\n            this.single_set_selected_text(data.text);\r\n          }\r\n        }\r\n      }\r\n      return content;\r\n    };\r\n\r\n    AbstractChosen.prototype.result_add_option = function(option) {\r\n      var classes, option_el;\r\n      if (!option.search_match) {\r\n        return '';\r\n      }\r\n      if (!this.include_option_in_results(option)) {\r\n        return '';\r\n      }\r\n      classes = [];\r\n      if (!option.disabled && !(option.selected && this.is_multiple)) {\r\n        classes.push(\"active-result\");\r\n      }\r\n      if (option.disabled && !(option.selected && this.is_multiple)) {\r\n        classes.push(\"disabled-result\");\r\n      }\r\n      if (option.selected) {\r\n        classes.push(\"result-selected\");\r\n      }\r\n      if (option.group_array_index != null) {\r\n        classes.push(\"group-option\");\r\n      }\r\n      if (option.classes !== \"\") {\r\n        classes.push(option.classes);\r\n      }\r\n      option_el = document.createElement(\"li\");\r\n      option_el.className = classes.join(\" \");\r\n      option_el.style.cssText = option.style;\r\n      option_el.setAttribute(\"data-option-array-index\", option.array_index);\r\n      option_el.innerHTML = option.search_text;\r\n      return this.outerHTML(option_el);\r\n    };\r\n\r\n    AbstractChosen.prototype.result_add_group = function(group) {\r\n      var group_el;\r\n      if (!(group.search_match || group.group_match)) {\r\n        return '';\r\n      }\r\n      if (!(group.active_options > 0)) {\r\n        return '';\r\n      }\r\n      group_el = document.createElement(\"li\");\r\n      group_el.className = \"group-result\";\r\n      group_el.innerHTML = group.search_text;\r\n      return this.outerHTML(group_el);\r\n    };\r\n\r\n    AbstractChosen.prototype.results_update_field = function() {\r\n      this.set_default_text();\r\n      if (!this.is_multiple) {\r\n        this.results_reset_cleanup();\r\n      }\r\n      this.result_clear_highlight();\r\n      this.results_build();\r\n      if (this.results_showing) {\r\n        return this.winnow_results();\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.reset_single_select_options = function() {\r\n      var result, _i, _len, _ref, _results;\r\n      _ref = this.results_data;\r\n      _results = [];\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        result = _ref[_i];\r\n        if (result.selected) {\r\n          _results.push(result.selected = false);\r\n        } else {\r\n          _results.push(void 0);\r\n        }\r\n      }\r\n      return _results;\r\n    };\r\n\r\n    AbstractChosen.prototype.results_toggle = function() {\r\n      if (this.results_showing) {\r\n        return this.results_hide();\r\n      } else {\r\n        return this.results_show();\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.results_search = function(evt) {\r\n      if (this.results_showing) {\r\n        return this.winnow_results();\r\n      } else {\r\n        return this.results_show();\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.winnow_results = function() {\r\n      var escapedSearchText, option, regex, regexAnchor, results, results_group, searchText, startpos, text, zregex, _i, _len, _ref;\r\n      this.no_results_clear();\r\n      results = 0;\r\n      searchText = this.get_search_text();\r\n      escapedSearchText = searchText.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n      regexAnchor = this.search_contains ? \"\" : \"^\";\r\n      regex = new RegExp(regexAnchor + escapedSearchText, 'i');\r\n      zregex = new RegExp(escapedSearchText, 'i');\r\n      _ref = this.results_data;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        option = _ref[_i];\r\n        option.search_match = false;\r\n        results_group = null;\r\n        if (this.include_option_in_results(option)) {\r\n          if (option.group) {\r\n            option.group_match = false;\r\n            option.active_options = 0;\r\n          }\r\n          if ((option.group_array_index != null) && this.results_data[option.group_array_index]) {\r\n            results_group = this.results_data[option.group_array_index];\r\n            if (results_group.active_options === 0 && results_group.search_match) {\r\n              results += 1;\r\n            }\r\n            results_group.active_options += 1;\r\n          }\r\n          if (!(option.group && !this.group_search)) {\r\n              option.search_text = option.group ? option.label : option.html;\r\n              option.search_match = this.search_string_match(option.search_text.replace(/\\s|\\xB7|(&nbsp;)|(&#0183;)/g, \" \").trim(), regex);\r\n            if (option.search_match && !option.group) {\r\n              results += 1;\r\n            }\r\n            if (option.search_match) {\r\n                if (searchText.length) {\r\n                option.search_text = option.search_text.replace(/\\s|\\xB7|(&nbsp;)|(&#0183;)/g, \" \").trim();\r\n                startpos = option.search_text.search(zregex);\r\n                text = option.search_text.substr(0, startpos + searchText.length) + '</em>' + option.search_text.substr(startpos + searchText.length);\r\n                option.search_text = text.substr(0, startpos) + '<em>' + text.substr(startpos);\r\n              }\r\n              if (results_group != null) {\r\n                results_group.group_match = true;\r\n              }\r\n            } else if ((option.group_array_index != null) && this.results_data[option.group_array_index].search_match) {\r\n              option.search_match = true;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.result_clear_highlight();\r\n      if (results < 1 && searchText.length) {\r\n        this.update_results_content(\"\");\r\n        return this.no_results(searchText);\r\n      } else {\r\n        this.update_results_content(this.results_option_build());\r\n        return this.winnow_results_set_highlight();\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.search_string_match = function(search_string, regex) {\r\n      var part, parts, _i, _len;\r\n      if (regex.test(search_string)) {\r\n        return true;\r\n      } else if (this.enable_split_word_search && (search_string.indexOf(\" \") >= 0 || search_string.indexOf(\"[\") === 0)) {\r\n        parts = search_string.replace(/\\[|\\]/g, \"\").split(\" \");\r\n        if (parts.length) {\r\n          for (_i = 0, _len = parts.length; _i < _len; _i++) {\r\n            part = parts[_i];\r\n            if (regex.test(part)) {\r\n              return true;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.choices_count = function() {\r\n      var option, _i, _len, _ref;\r\n      if (this.selected_option_count != null) {\r\n        return this.selected_option_count;\r\n      }\r\n      this.selected_option_count = 0;\r\n      _ref = this.form_field.options;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        option = _ref[_i];\r\n        if (option.selected) {\r\n          this.selected_option_count += 1;\r\n        }\r\n      }\r\n      return this.selected_option_count;\r\n    };\r\n\r\n    AbstractChosen.prototype.choices_click = function(evt) {\r\n      evt.preventDefault();\r\n      if (!(this.results_showing || this.is_disabled)) {\r\n        return this.results_show();\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.keyup_checker = function(evt) {\r\n      var stroke, _ref;\r\n      stroke = (_ref = evt.which) != null ? _ref : evt.keyCode;\r\n      this.search_field_scale();\r\n      switch (stroke) {\r\n        case 8:\r\n          if (this.is_multiple && this.backstroke_length < 1 && this.choices_count() > 0) {\r\n            return this.keydown_backstroke();\r\n          } else if (!this.pending_backstroke) {\r\n            this.result_clear_highlight();\r\n            return this.results_search();\r\n          }\r\n          break;\r\n        case 13:\r\n          evt.preventDefault();\r\n          if (this.results_showing) {\r\n            return this.result_select(evt);\r\n          }\r\n          break;\r\n        case 27:\r\n          if (this.results_showing) {\r\n            this.results_hide();\r\n          }\r\n          return true;\r\n        case 9:\r\n        case 38:\r\n        case 40:\r\n        case 16:\r\n        case 91:\r\n        case 17:\r\n          break;\r\n        default:\r\n          return this.results_search();\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.clipboard_event_checker = function(evt) {\r\n      var _this = this;\r\n      return setTimeout((function() {\r\n        return _this.results_search();\r\n      }), 50);\r\n    };\r\n\r\n    AbstractChosen.prototype.container_width = function() {\r\n      if (this.options.width != null) {\r\n        return this.options.width;\r\n      } else {\r\n        return \"\" + this.form_field.offsetWidth + \"px\";\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.include_option_in_results = function(option) {\r\n      if (this.is_multiple && (!this.display_selected_options && option.selected)) {\r\n        return false;\r\n      }\r\n      if (!this.display_disabled_options && option.disabled) {\r\n        return false;\r\n      }\r\n      if (option.empty) {\r\n        return false;\r\n      }\r\n      return true;\r\n    };\r\n\r\n    AbstractChosen.prototype.search_results_touchstart = function(evt) {\r\n      this.touch_started = true;\r\n      return this.search_results_mouseover(evt);\r\n    };\r\n\r\n    AbstractChosen.prototype.search_results_touchmove = function(evt) {\r\n      this.touch_started = false;\r\n      return this.search_results_mouseout(evt);\r\n    };\r\n\r\n    AbstractChosen.prototype.search_results_touchend = function(evt) {\r\n      if (this.touch_started) {\r\n        return this.search_results_mouseup(evt);\r\n      }\r\n    };\r\n\r\n    AbstractChosen.prototype.outerHTML = function(element) {\r\n      var tmp;\r\n      if (element.outerHTML) {\r\n        return element.outerHTML;\r\n      }\r\n      tmp = document.createElement(\"div\");\r\n      tmp.appendChild(element);\r\n      return tmp.innerHTML;\r\n    };\r\n\r\n    AbstractChosen.browser_is_supported = function() {\r\n      if (window.navigator.appName === \"Microsoft Internet Explorer\") {\r\n        return document.documentMode >= 8;\r\n      }\r\n      if (/iP(od|hone)/i.test(window.navigator.userAgent)) {\r\n        return true;//return false;\r\n      }\r\n      if (/Android/i.test(window.navigator.userAgent)) {\r\n        if (/Mobile/i.test(window.navigator.userAgent)) {\r\n          return true;//return false;\r\n        }\r\n      }\r\n      return true;\r\n    };\r\n\r\n    AbstractChosen.default_multiple_text = \"Select Some Options\";\r\n\r\n    AbstractChosen.default_single_text = \"Select an Option\";\r\n\r\n    AbstractChosen.default_no_result_text = \"No results match\";\r\n\r\n    return AbstractChosen;\r\n\r\n  })();\r\n\r\n  $ = jQuery;\r\n\r\n  $.fn.extend({\r\n    chosen: function(options) {\r\n      if (!AbstractChosen.browser_is_supported()) {\r\n        return this;\r\n      }\r\n      return this.each(function(input_field) {\r\n        var $this, chosen;\r\n        $this = $(this);\r\n        chosen = $this.data('chosen');\r\n        if (options === 'destroy' && chosen) {\r\n          chosen.destroy();\r\n        } else if (!chosen) {\r\n          $this.data('chosen', new Chosen(this, options));\r\n        }\r\n      });\r\n    }\r\n  });\r\n\r\n  Chosen = (function(_super) {\r\n    __extends(Chosen, _super);\r\n\r\n    function Chosen() {\r\n      _ref = Chosen.__super__.constructor.apply(this, arguments);\r\n      return _ref;\r\n    }\r\n\r\n    Chosen.prototype.setup = function() {\r\n      this.form_field_jq = $(this.form_field);\r\n      this.current_selectedIndex = this.form_field.selectedIndex;\r\n      return this.is_rtl = this.form_field_jq.hasClass(\"chosen-rtl\");\r\n    };\r\n\r\n    Chosen.prototype.set_up_html = function() {\r\n      var container_classes, container_props;\r\n      container_classes = [\"chosen-container\"];\r\n      container_classes.push(\"chosen-container-\" + (this.is_multiple ? \"multi\" : \"single\"));\r\n      if (this.inherit_select_classes && this.form_field.className) {\r\n        container_classes.push(this.form_field.className);\r\n      }\r\n      if (this.is_rtl) {\r\n        container_classes.push(\"chosen-rtl\");\r\n      }\r\n      \r\n      container_props = {\r\n        'class': container_classes.join(' '),\r\n        'style': \"width: \" + (this.form_field_jq.outerWidth()+\"px\") + \";\",\r\n        'title': this.form_field.title\r\n      };\r\n      if (this.form_field.id.length) {\r\n        container_props.id = this.form_field.id.replace(/[^\\w]/g, '_') + \"_chosen\";\r\n      }\r\n      this.container = $(\"<div />\", container_props);\r\n      if (this.is_multiple) {\r\n        this.container.html('<ul class=\"chosen-choices\"><li class=\"search-field\"><input type=\"text\" value=\"' + this.default_text + '\" class=\"default\" autocomplete=\"off\" style=\"width:25px;\" /></li></ul><div class=\"chosen-drop\"><ul class=\"chosen-results\"></ul></div>');\r\n      } else {\r\n        this.container.html('<a class=\"chosen-single chosen-default\" tabindex=\"-1\"><span>' + this.default_text + '</span><div><b></b></div></a><div class=\"chosen-drop\"><div class=\"chosen-search\"><input type=\"text\" autocomplete=\"off\" /></div><ul class=\"chosen-results\"></ul></div>');\r\n      }\r\n      this.form_field_jq.hide().after(this.container);\r\n      this.dropdown = this.container.find('div.chosen-drop').first();\r\n      var dd_top = this.container.height();\r\n      this.dropdown.css({\r\n          \"width\": this.form_field_jq.outerWidth() + \"px\",\r\n          \"top\": dd_top + \"px\"\r\n      });\r\n      this.search_field = this.container.find('input').first();\r\n      this.search_results = this.container.find('ul.chosen-results').first();\r\n      this.search_field_scale();\r\n      this.search_no_results = this.container.find('li.no-results').first();\r\n      if (this.is_multiple) {\r\n        this.search_choices = this.container.find('ul.chosen-choices').first();\r\n        this.search_container = this.container.find('li.search-field').first();\r\n      } else {\r\n        this.search_container = this.container.find('div.chosen-search').first();\r\n        this.selected_item = this.container.find('.chosen-single').first();\r\n      }\r\n      this.results_build();\r\n      this.set_tab_index();\r\n      this.set_label_behavior();\r\n      return this.form_field_jq.trigger(\"chosen:ready\", {\r\n        chosen: this\r\n      });\r\n    };\r\n\r\n    Chosen.prototype.register_observers = function() {\r\n      var _this = this;\r\n      this.container.bind('mousedown.chosen', function(evt) {\r\n        _this.container_mousedown(evt);\r\n      });\r\n      this.container.bind('mouseup.chosen', function(evt) {\r\n        _this.container_mouseup(evt);\r\n      });\r\n      this.container.bind('mouseenter.chosen', function(evt) {\r\n        _this.mouse_enter(evt);\r\n      });\r\n      this.container.bind('mouseleave.chosen', function(evt) {\r\n        _this.mouse_leave(evt);\r\n      });\r\n      this.search_results.bind('mouseup.chosen', function(evt) {\r\n        _this.search_results_mouseup(evt);\r\n      });\r\n      this.search_results.bind('mouseover.chosen', function(evt) {\r\n        _this.search_results_mouseover(evt);\r\n      });\r\n      this.search_results.bind('mouseout.chosen', function(evt) {\r\n        _this.search_results_mouseout(evt);\r\n      });\r\n      this.search_results.bind('mousewheel.chosen DOMMouseScroll.chosen', function(evt) {\r\n        _this.search_results_mousewheel(evt);\r\n      });\r\n      this.search_results.bind('touchstart.chosen', function(evt) {\r\n        _this.search_results_touchstart(evt);\r\n      });\r\n      this.search_results.bind('touchmove.chosen', function(evt) {\r\n        _this.search_results_touchmove(evt);\r\n      });\r\n      this.search_results.bind('touchend.chosen', function(evt) {\r\n        _this.search_results_touchend(evt);\r\n      });\r\n      this.form_field_jq.bind(\"chosen:updated.chosen\", function(evt) {\r\n        _this.results_update_field(evt);\r\n      });\r\n      this.form_field_jq.bind(\"chosen:activate.chosen\", function(evt) {\r\n        _this.activate_field(evt);\r\n      });\r\n      this.form_field_jq.bind(\"chosen:open.chosen\", function(evt) {\r\n        _this.container_mousedown(evt);\r\n      });\r\n      this.form_field_jq.bind(\"chosen:close.chosen\", function(evt) {\r\n        _this.input_blur(evt);\r\n      });\r\n      this.search_field.bind('blur.chosen', function(evt) {\r\n        _this.input_blur(evt);\r\n      });\r\n      this.search_field.bind('keyup.chosen', function(evt) {\r\n        _this.keyup_checker(evt);\r\n      });\r\n      this.search_field.bind('keydown.chosen', function(evt) {\r\n        _this.keydown_checker(evt);\r\n      });\r\n      this.search_field.bind('focus.chosen', function(evt) {\r\n        _this.input_focus(evt);\r\n      });\r\n      this.search_field.bind('cut.chosen', function(evt) {\r\n        _this.clipboard_event_checker(evt);\r\n      });\r\n      this.search_field.bind('paste.chosen', function(evt) {\r\n        _this.clipboard_event_checker(evt);\r\n      });\r\n      if (this.is_multiple) {\r\n        return this.search_choices.bind('click.chosen', function(evt) {\r\n          _this.choices_click(evt);\r\n        });\r\n      } else {\r\n        return this.container.bind('click.chosen', function(evt) {\r\n          evt.preventDefault();\r\n        });\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.destroy = function() {\r\n      $(this.container[0].ownerDocument).unbind(\"click.chosen\", this.click_test_action);\r\n      if (this.search_field[0].tabIndex) {\r\n        this.form_field_jq[0].tabIndex = this.search_field[0].tabIndex;\r\n      }\r\n      this.container.remove();\r\n      this.form_field_jq.removeData('chosen');\r\n      return this.form_field_jq.show();\r\n    };\r\n\r\n    Chosen.prototype.search_field_disabled = function() {\r\n      this.is_disabled = this.form_field_jq[0].disabled;\r\n      if (this.is_disabled) {\r\n        this.container.addClass('chosen-disabled');\r\n        this.search_field[0].disabled = true;\r\n        if (!this.is_multiple) {\r\n          this.selected_item.unbind(\"focus.chosen\", this.activate_action);\r\n        }\r\n        return this.close_field();\r\n      } else {\r\n        this.container.removeClass('chosen-disabled');\r\n        this.search_field[0].disabled = false;\r\n        if (!this.is_multiple) {\r\n          return this.selected_item.bind(\"focus.chosen\", this.activate_action);\r\n        }\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.container_mousedown = function(evt) {\r\n      if (!this.is_disabled) {\r\n        if (evt && evt.type === \"mousedown\" && !this.results_showing) {\r\n          evt.preventDefault();\r\n        }\r\n        if (!((evt != null) && ($(evt.target)).hasClass(\"search-choice-close\"))) {\r\n          if (!this.active_field) {\r\n            if (this.is_multiple) {\r\n              this.search_field.val(\"\");\r\n            }\r\n            $(this.container[0].ownerDocument).bind('click.chosen', this.click_test_action);\r\n            this.results_show();\r\n          } else if (!this.is_multiple && evt && (($(evt.target)[0] === this.selected_item[0]) || $(evt.target).parents(\"a.chosen-single\").length)) {\r\n            evt.preventDefault();\r\n            this.results_toggle();\r\n          }\r\n          return this.activate_field();\r\n        }\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.container_mouseup = function(evt) {\r\n      if (evt.target.nodeName === \"ABBR\" && !this.is_disabled) {\r\n        return this.results_reset(evt);\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.search_results_mousewheel = function(evt) {\r\n      var delta;\r\n      if (evt.originalEvent) {\r\n        delta = -evt.originalEvent.wheelDelta || evt.originalEvent.detail;\r\n      }\r\n      if (delta != null) {\r\n        evt.preventDefault();\r\n        if (evt.type === 'DOMMouseScroll') {\r\n          delta = delta * 40;\r\n        }\r\n        return this.search_results.scrollTop(delta + this.search_results.scrollTop());\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.blur_test = function(evt) {\r\n      if (!this.active_field && this.container.hasClass(\"chosen-container-active\")) {\r\n        return this.close_field();\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.close_field = function() {\r\n      $(this.container[0].ownerDocument).unbind(\"click.chosen\", this.click_test_action);\r\n      this.active_field = false;\r\n      this.results_hide();\r\n      this.container.removeClass(\"chosen-container-active\");\r\n      this.clear_backstroke();\r\n      this.show_search_field_default();\r\n      return this.search_field_scale();\r\n    };\r\n\r\n    Chosen.prototype.activate_field = function() {\r\n      this.container.addClass(\"chosen-container-active\");\r\n      this.active_field = true;\r\n      this.search_field.val(this.search_field.val());\r\n      return this.search_field.focus();\r\n    };\r\n\r\n    Chosen.prototype.test_active_click = function(evt) {\r\n      var active_container;\r\n      active_container = $(evt.target).closest('.chosen-container');\r\n      if (active_container.length && this.container[0] === active_container[0]) {\r\n        return this.active_field = true;\r\n      } else {\r\n        return this.close_field();\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.results_build = function() {\r\n      this.parsing = true;\r\n      this.selected_option_count = null;\r\n      this.results_data = SelectParser.select_to_array(this.form_field);\r\n      if (this.is_multiple) {\r\n        this.search_choices.find(\"li.search-choice\").remove();\r\n      } else if (!this.is_multiple) {\r\n        this.single_set_selected_text();\r\n        if (this.disable_search || this.form_field.options.length <= this.disable_search_threshold) {\r\n          this.search_field[0].readOnly = true;\r\n          this.container.addClass(\"chosen-container-single-nosearch\");\r\n        } else {\r\n          this.search_field[0].readOnly = false;\r\n          this.container.removeClass(\"chosen-container-single-nosearch\");\r\n        }\r\n      }\r\n      this.update_results_content(this.results_option_build({\r\n        first: true\r\n      }));\r\n      this.search_field_disabled();\r\n      this.show_search_field_default();\r\n      this.search_field_scale();\r\n      return this.parsing = false;\r\n    };\r\n\r\n    Chosen.prototype.result_do_highlight = function(el) {\r\n      var high_bottom, high_top, maxHeight, visible_bottom, visible_top;\r\n      if (el.length) {\r\n        this.result_clear_highlight();\r\n        this.result_highlight = el;\r\n        this.result_highlight.addClass(\"highlighted\");\r\n        maxHeight = parseInt(this.search_results.css(\"maxHeight\"), 10);\r\n        visible_top = this.search_results.scrollTop();\r\n        visible_bottom = maxHeight + visible_top;\r\n        high_top = this.result_highlight.position().top + this.search_results.scrollTop();\r\n        high_bottom = high_top + this.result_highlight.outerHeight();\r\n        if (high_bottom >= visible_bottom) {\r\n          return this.search_results.scrollTop((high_bottom - maxHeight) > 0 ? high_bottom - maxHeight : 0);\r\n        } else if (high_top < visible_top) {\r\n          return this.search_results.scrollTop(high_top);\r\n        }\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.result_clear_highlight = function() {\r\n      if (this.result_highlight) {\r\n        this.result_highlight.removeClass(\"highlighted\");\r\n      }\r\n      return this.result_highlight = null;\r\n    };\r\n    Chosen.prototype.position = function (element, dropdown) {\r\n        var offset = element.offsetRelative();\r\n        if (offset) {\r\n            var left = offset.left;\r\n            var top = offset.top + element.outerHeight() - 2;\r\n            dropdown.css({\r\n                top: top,\r\n                left: left\r\n            });\r\n        }\r\n        else {\r\n            var left = element.left;\r\n            var top = element.top + element.outerHeight() - 2;\r\n            dropdown.css({\r\n                top: top,\r\n                left: left\r\n            });\r\n        }\r\n    };\r\n\r\n    Chosen.prototype.results_show = function() {\r\n      if (this.is_multiple && this.max_selected_options <= this.choices_count()) {\r\n        this.form_field_jq.trigger(\"chosen:maxselected\", {\r\n          chosen: this\r\n        });\r\n        return false;\r\n      }\r\n      this.container.addClass(\"chosen-with-drop\");\r\n      this.position(this.container, this.dropdown);\r\n      this.results_showing = true;\r\n      this.search_field.focus();\r\n      this.search_field.val(this.search_field.val());\r\n      this.winnow_results();\r\n      return this.form_field_jq.trigger(\"chosen:showing_dropdown\", {\r\n        chosen: this\r\n      });\r\n    };\r\n\r\n    Chosen.prototype.update_results_content = function(content) {\r\n      return this.search_results.html(content);\r\n    };\r\n\r\n    Chosen.prototype.results_hide = function() {\r\n      if (this.results_showing) {\r\n        this.result_clear_highlight();\r\n        this.container.removeClass(\"chosen-with-drop\");\r\n        this.dropdown.css({\r\n            \"left\": \"-9000px\"\r\n        });\r\n        this.form_field_jq.trigger(\"chosen:hiding_dropdown\", {\r\n          chosen: this\r\n        });\r\n      }\r\n      return this.results_showing = false;\r\n    };\r\n\r\n    Chosen.prototype.set_tab_index = function(el) {\r\n      var ti;\r\n      if (this.form_field.tabIndex) {\r\n        ti = this.form_field.tabIndex;\r\n        this.form_field.tabIndex = -1;\r\n        return this.search_field[0].tabIndex = ti;\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.set_label_behavior = function() {\r\n      var _this = this;\r\n      this.form_field_label = this.form_field_jq.parents(\"label\");\r\n      if (!this.form_field_label.length && this.form_field.id.length) {\r\n        this.form_field_label = $(\"label[for='\" + this.form_field.id + \"']\");\r\n      }\r\n      if (this.form_field_label.length > 0) {\r\n        return this.form_field_label.bind('click.chosen', function(evt) {\r\n          if (_this.is_multiple) {\r\n            return _this.container_mousedown(evt);\r\n          } else {\r\n            return _this.activate_field();\r\n          }\r\n        });\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.show_search_field_default = function() {\r\n      if (this.is_multiple && this.choices_count() < 1 && !this.active_field) {\r\n        this.search_field.val(this.default_text);\r\n        return this.search_field.addClass(\"default\");\r\n      } else {\r\n        this.search_field.val(\"\");\r\n        return this.search_field.removeClass(\"default\");\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.search_results_mouseup = function(evt) {\r\n      var target;\r\n      target = $(evt.target).hasClass(\"active-result\") ? $(evt.target) : $(evt.target).parents(\".active-result\").first();\r\n      if (target.length) {\r\n        this.result_highlight = target;\r\n        this.result_select(evt);\r\n        return this.search_field.focus();\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.search_results_mouseover = function(evt) {\r\n      var target;\r\n      target = $(evt.target).hasClass(\"active-result\") ? $(evt.target) : $(evt.target).parents(\".active-result\").first();\r\n      if (target) {\r\n        return this.result_do_highlight(target);\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.search_results_mouseout = function(evt) {\r\n      if ($(evt.target).hasClass(\"active-result\" || $(evt.target).parents('.active-result').first())) {\r\n        return this.result_clear_highlight();\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.choice_build = function(item) {\r\n      var choice, close_link,\r\n        _this = this;\r\n      choice = $('<li />', {\r\n        \"class\": \"search-choice\"\r\n      }).html(\"<span>\" + item.html + \"</span>\");\r\n      if (item.disabled) {\r\n        choice.addClass('search-choice-disabled');\r\n      } else {\r\n        close_link = $('<a />', {\r\n          \"class\": 'search-choice-close',\r\n          'data-option-array-index': item.array_index\r\n        });\r\n        close_link.bind('click.chosen', function(evt) {\r\n          return _this.choice_destroy_link_click(evt);\r\n        });\r\n        choice.append(close_link);\r\n      }\r\n      return this.search_container.before(choice);\r\n    };\r\n\r\n    Chosen.prototype.choice_destroy_link_click = function(evt) {\r\n      evt.preventDefault();\r\n      evt.stopPropagation();\r\n      if (!this.is_disabled) {\r\n        return this.choice_destroy($(evt.target));\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.choice_destroy = function(link) {\r\n      if (this.result_deselect(link[0].getAttribute(\"data-option-array-index\"))) {\r\n        this.show_search_field_default();\r\n        if (this.is_multiple && this.choices_count() > 0 && this.search_field.val().length < 1) {\r\n          this.results_hide();\r\n        }\r\n        link.parents('li').first().remove();\r\n        return this.search_field_scale();\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.results_reset = function() {\r\n      this.reset_single_select_options();\r\n      this.form_field.options[0].selected = true;\r\n      this.single_set_selected_text();\r\n      this.show_search_field_default();\r\n      this.results_reset_cleanup();\r\n      this.form_field_jq.trigger(\"change\");\r\n      if (this.active_field) {\r\n        return this.results_hide();\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.results_reset_cleanup = function() {\r\n      this.current_selectedIndex = this.form_field.selectedIndex;\r\n      return this.selected_item.find(\"abbr\").remove();\r\n    };\r\n\r\n    Chosen.prototype.result_select = function(evt) {\r\n      var high, item;\r\n      if (this.result_highlight) {\r\n        high = this.result_highlight;\r\n        this.result_clear_highlight();\r\n        if (this.is_multiple && this.max_selected_options <= this.choices_count()) {\r\n          this.form_field_jq.trigger(\"chosen:maxselected\", {\r\n            chosen: this\r\n          });\r\n          return false;\r\n        }\r\n        if (this.is_multiple) {\r\n          high.removeClass(\"active-result\");\r\n        } else {\r\n          this.reset_single_select_options();\r\n        }\r\n        item = this.results_data[high[0].getAttribute(\"data-option-array-index\")];\r\n        item.selected = true;\r\n        this.form_field.options[item.options_index].selected = true;\r\n        this.selected_option_count = null;\r\n        if (this.is_multiple) {\r\n          this.choice_build(item);\r\n        } else {\r\n          this.single_set_selected_text(item.text);\r\n        }\r\n        if (!((evt.metaKey || evt.ctrlKey) && this.is_multiple)) {\r\n          this.results_hide();\r\n        }\r\n        this.search_field.val(\"\");\r\n        if (this.is_multiple || this.form_field.selectedIndex !== this.current_selectedIndex) {\r\n          this.form_field_jq.trigger(\"change\", {\r\n            'selected': this.form_field.options[item.options_index].value\r\n          });\r\n        }\r\n        this.current_selectedIndex = this.form_field.selectedIndex;\r\n        return this.search_field_scale();\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.single_set_selected_text = function(text) {\r\n      if (text == null) {\r\n        text = this.default_text;\r\n      }\r\n      if (text === this.default_text) {\r\n        this.selected_item.addClass(\"chosen-default\");\r\n      } else {\r\n        this.single_deselect_control_build();\r\n        this.selected_item.removeClass(\"chosen-default\");\r\n      }\r\n      return this.selected_item.find(\"span\").html(text);\r\n    };\r\n\r\n    Chosen.prototype.result_deselect = function(pos) {\r\n      var result_data;\r\n      result_data = this.results_data[pos];\r\n      if (!this.form_field.options[result_data.options_index].disabled) {\r\n        result_data.selected = false;\r\n        this.form_field.options[result_data.options_index].selected = false;\r\n        this.selected_option_count = null;\r\n        this.result_clear_highlight();\r\n        if (this.results_showing) {\r\n          this.winnow_results();\r\n        }\r\n        this.form_field_jq.trigger(\"change\", {\r\n          deselected: this.form_field.options[result_data.options_index].value\r\n        });\r\n        this.search_field_scale();\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.single_deselect_control_build = function() {\r\n      if (!this.allow_single_deselect) {\r\n        return;\r\n      }\r\n      if (!this.selected_item.find(\"abbr\").length) {\r\n        this.selected_item.find(\"span\").first().after(\"<abbr class=\\\"search-choice-close\\\"></abbr>\");\r\n      }\r\n      return this.selected_item.addClass(\"chosen-single-with-deselect\");\r\n    };\r\n\r\n    Chosen.prototype.get_search_text = function() {\r\n      if (this.search_field.val() === this.default_text) {\r\n        return \"\";\r\n      } else {\r\n        return $.trim(this.search_field.val());\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.winnow_results_set_highlight = function() {\r\n      var do_high, selected_results;\r\n      selected_results = !this.is_multiple ? this.search_results.find(\".result-selected.active-result\") : [];\r\n      do_high = selected_results.length ? selected_results.first() : this.search_results.find(\".active-result\").first();\r\n      if (do_high != null) {\r\n        return this.result_do_highlight(do_high);\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.no_results = function(terms) {\r\n      var no_results_html;\r\n      no_results_html = $('<li class=\"no-results\">' + this.results_none_found + ' \"<span></span>\"</li>');\r\n      no_results_html.find(\"span\").first().html(terms);\r\n      this.search_results.append(no_results_html);\r\n      return this.form_field_jq.trigger(\"chosen:no_results\", {\r\n        chosen: this\r\n      });\r\n    };\r\n\r\n    Chosen.prototype.no_results_clear = function() {\r\n      return this.search_results.find(\".no-results\").remove();\r\n    };\r\n\r\n    Chosen.prototype.keydown_arrow = function() {\r\n      var next_sib;\r\n      if (this.results_showing && this.result_highlight) {\r\n        next_sib = this.result_highlight.nextAll(\"li.active-result\").first();\r\n        if (next_sib) {\r\n          return this.result_do_highlight(next_sib);\r\n        }\r\n      } else {\r\n        return this.results_show();\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.keyup_arrow = function() {\r\n      var prev_sibs;\r\n      if (!this.results_showing && !this.is_multiple) {\r\n        return this.results_show();\r\n      } else if (this.result_highlight) {\r\n        prev_sibs = this.result_highlight.prevAll(\"li.active-result\");\r\n        if (prev_sibs.length) {\r\n          return this.result_do_highlight(prev_sibs.first());\r\n        } else {\r\n          if (this.choices_count() > 0) {\r\n            this.results_hide();\r\n          }\r\n          return this.result_clear_highlight();\r\n        }\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.keydown_backstroke = function() {\r\n      var next_available_destroy;\r\n      if (this.pending_backstroke) {\r\n        this.choice_destroy(this.pending_backstroke.find(\"a\").first());\r\n        return this.clear_backstroke();\r\n      } else {\r\n        next_available_destroy = this.search_container.siblings(\"li.search-choice\").last();\r\n        if (next_available_destroy.length && !next_available_destroy.hasClass(\"search-choice-disabled\")) {\r\n          this.pending_backstroke = next_available_destroy;\r\n          if (this.single_backstroke_delete) {\r\n            return this.keydown_backstroke();\r\n          } else {\r\n            return this.pending_backstroke.addClass(\"search-choice-focus\");\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.clear_backstroke = function() {\r\n      if (this.pending_backstroke) {\r\n        this.pending_backstroke.removeClass(\"search-choice-focus\");\r\n      }\r\n      return this.pending_backstroke = null;\r\n    };\r\n\r\n    Chosen.prototype.keydown_checker = function(evt) {\r\n      var stroke, _ref1;\r\n      stroke = (_ref1 = evt.which) != null ? _ref1 : evt.keyCode;\r\n      this.search_field_scale();\r\n      if (stroke !== 8 && this.pending_backstroke) {\r\n        this.clear_backstroke();\r\n      }\r\n      switch (stroke) {\r\n        case 8:\r\n          this.backstroke_length = this.search_field.val().length;\r\n          break;\r\n        case 9:\r\n          if (this.results_showing && !this.is_multiple) {\r\n            this.result_select(evt);\r\n          }\r\n          this.mouse_on_container = false;\r\n          break;\r\n        case 13:\r\n          evt.preventDefault();\r\n          break;\r\n        case 38:\r\n          evt.preventDefault();\r\n          this.keyup_arrow();\r\n          break;\r\n        case 40:\r\n          evt.preventDefault();\r\n          this.keydown_arrow();\r\n          break;\r\n      }\r\n    };\r\n\r\n    Chosen.prototype.search_field_scale = function() {\r\n      var div, f_width, h, style, style_block, styles, w, _i, _len;\r\n      if (this.is_multiple) {\r\n        h = 0;\r\n        w = 0;\r\n        style_block = \"position:absolute; left: -1000px; top: -1000px; display:none;\";\r\n        styles = ['font-size', 'font-style', 'font-weight', 'font-family', 'line-height', 'text-transform', 'letter-spacing'];\r\n        for (_i = 0, _len = styles.length; _i < _len; _i++) {\r\n          style = styles[_i];\r\n          style_block += style + \":\" + this.search_field.css(style) + \";\";\r\n        }\r\n        div = $('<div />', {\r\n          'style': style_block\r\n        });\r\n        div.text(this.search_field.val());\r\n        $('body').append(div);\r\n        w = div.width() + 25;\r\n        div.remove();\r\n        f_width = this.container.outerWidth();\r\n        if (w > f_width - 10) {\r\n          w = f_width - 10;\r\n        }\r\n        return this.search_field.css({\r\n          'width': w + 'px'\r\n        });\r\n      }\r\n    };\r\n\r\n    return Chosen;\r\n\r\n  })(AbstractChosen);\r\n\r\n}).call(this);\r\n","/***\r\n * Contains core SlickGrid classes.\r\n * @module Core\r\n * @namespace Slick\r\n */\r\n\r\n(function ($) {\r\n  // register namespace\r\n  $.extend(true, window, {\r\n    \"Slick\": {\r\n      \"Event\": Event,\r\n      \"EventData\": EventData,\r\n      \"EventHandler\": EventHandler,\r\n      \"Range\": Range,\r\n      \"NonDataRow\": NonDataItem,\r\n      \"Group\": Group,\r\n      \"GroupTotals\": GroupTotals,\r\n      \"EditorLock\": EditorLock,\r\n\r\n      /***\r\n       * A global singleton editor lock.\r\n       * @class GlobalEditorLock\r\n       * @static\r\n       * @constructor\r\n       */\r\n      \"GlobalEditorLock\": new EditorLock()\r\n    }\r\n  });\r\n\r\n  /***\r\n   * An event object for passing data to event handlers and letting them control propagation.\r\n   * <p>This is pretty much identical to how W3C and jQuery implement events.</p>\r\n   * @class EventData\r\n   * @constructor\r\n   */\r\n  function EventData() {\r\n    var isPropagationStopped = false;\r\n    var isImmediatePropagationStopped = false;\r\n\r\n    /***\r\n     * Stops event from propagating up the DOM tree.\r\n     * @method stopPropagation\r\n     */\r\n    this.stopPropagation = function () {\r\n      isPropagationStopped = true;\r\n    };\r\n\r\n    /***\r\n     * Returns whether stopPropagation was called on this event object.\r\n     * @method isPropagationStopped\r\n     * @return {Boolean}\r\n     */\r\n    this.isPropagationStopped = function () {\r\n      return isPropagationStopped;\r\n    };\r\n\r\n    /***\r\n     * Prevents the rest of the handlers from being executed.\r\n     * @method stopImmediatePropagation\r\n     */\r\n    this.stopImmediatePropagation = function () {\r\n      isImmediatePropagationStopped = true;\r\n    };\r\n\r\n    /***\r\n     * Returns whether stopImmediatePropagation was called on this event object.\\\r\n     * @method isImmediatePropagationStopped\r\n     * @return {Boolean}\r\n     */\r\n    this.isImmediatePropagationStopped = function () {\r\n      return isImmediatePropagationStopped;\r\n    }\r\n  }\r\n\r\n  /***\r\n   * A simple publisher-subscriber implementation.\r\n   * @class Event\r\n   * @constructor\r\n   */\r\n  function Event() {\r\n    var handlers = [];\r\n\r\n    /***\r\n     * Adds an event handler to be called when the event is fired.\r\n     * <p>Event handler will receive two arguments - an <code>EventData</code> and the <code>data</code>\r\n     * object the event was fired with.<p>\r\n     * @method subscribe\r\n     * @param fn {Function} Event handler.\r\n     */\r\n    this.subscribe = function (fn) {\r\n      handlers.push(fn);\r\n    };\r\n\r\n    /***\r\n     * Removes an event handler added with <code>subscribe(fn)</code>.\r\n     * @method unsubscribe\r\n     * @param fn {Function} Event handler to be removed.\r\n     */\r\n    this.unsubscribe = function (fn) {\r\n      for (var i = handlers.length - 1; i >= 0; i--) {\r\n        if (handlers[i] === fn) {\r\n          handlers.splice(i, 1);\r\n        }\r\n      }\r\n    };\r\n\r\n    /***\r\n     * Fires an event notifying all subscribers.\r\n     * @method notify\r\n     * @param args {Object} Additional data object to be passed to all handlers.\r\n     * @param e {EventData}\r\n     *      Optional.\r\n     *      An <code>EventData</code> object to be passed to all handlers.\r\n     *      For DOM events, an existing W3C/jQuery event object can be passed in.\r\n     * @param scope {Object}\r\n     *      Optional.\r\n     *      The scope (\"this\") within which the handler will be executed.\r\n     *      If not specified, the scope will be set to the <code>Event</code> instance.\r\n     */\r\n    this.notify = function (args, e, scope) {\r\n      e = e || new EventData();\r\n      scope = scope || this;\r\n\r\n      var returnValue;\r\n      for (var i = 0; i < handlers.length && !(e.isPropagationStopped() || e.isImmediatePropagationStopped()); i++) {\r\n        returnValue = handlers[i].call(scope, e, args);\r\n      }\r\n\r\n      return returnValue;\r\n    };\r\n  }\r\n\r\n  function EventHandler() {\r\n    var handlers = [];\r\n\r\n    this.subscribe = function (event, handler) {\r\n      handlers.push({\r\n        event: event,\r\n        handler: handler\r\n      });\r\n      event.subscribe(handler);\r\n    };\r\n\r\n    this.unsubscribe = function (event, handler) {\r\n      var i = handlers.length;\r\n      while (i--) {\r\n        if (handlers[i].event === event &&\r\n            handlers[i].handler === handler) {\r\n          handlers.splice(i, 1);\r\n          event.unsubscribe(handler);\r\n          return;\r\n        }\r\n      }\r\n    };\r\n\r\n    this.unsubscribeAll = function () {\r\n      var i = handlers.length;\r\n      while (i--) {\r\n        handlers[i].event.unsubscribe(handlers[i].handler);\r\n      }\r\n      handlers = [];\r\n    }\r\n  }\r\n\r\n  /***\r\n   * A structure containing a range of cells.\r\n   * @class Range\r\n   * @constructor\r\n   * @param fromRow {Integer} Starting row.\r\n   * @param fromCell {Integer} Starting cell.\r\n   * @param toRow {Integer} Optional. Ending row. Defaults to <code>fromRow</code>.\r\n   * @param toCell {Integer} Optional. Ending cell. Defaults to <code>fromCell</code>.\r\n   */\r\n  function Range(fromRow, fromCell, toRow, toCell) {\r\n    if (toRow === undefined && toCell === undefined) {\r\n      toRow = fromRow;\r\n      toCell = fromCell;\r\n    }\r\n\r\n    /***\r\n     * @property fromRow\r\n     * @type {Integer}\r\n     */\r\n    this.fromRow = Math.min(fromRow, toRow);\r\n\r\n    /***\r\n     * @property fromCell\r\n     * @type {Integer}\r\n     */\r\n    this.fromCell = Math.min(fromCell, toCell);\r\n\r\n    /***\r\n     * @property toRow\r\n     * @type {Integer}\r\n     */\r\n    this.toRow = Math.max(fromRow, toRow);\r\n\r\n    /***\r\n     * @property toCell\r\n     * @type {Integer}\r\n     */\r\n    this.toCell = Math.max(fromCell, toCell);\r\n\r\n    /***\r\n     * Returns whether a range represents a single row.\r\n     * @method isSingleRow\r\n     * @return {Boolean}\r\n     */\r\n    this.isSingleRow = function () {\r\n      return this.fromRow == this.toRow;\r\n    };\r\n\r\n    /***\r\n     * Returns whether a range represents a single cell.\r\n     * @method isSingleCell\r\n     * @return {Boolean}\r\n     */\r\n    this.isSingleCell = function () {\r\n      return this.fromRow == this.toRow && this.fromCell == this.toCell;\r\n    };\r\n\r\n    /***\r\n     * Returns whether a range contains a given cell.\r\n     * @method contains\r\n     * @param row {Integer}\r\n     * @param cell {Integer}\r\n     * @return {Boolean}\r\n     */\r\n    this.contains = function (row, cell) {\r\n      return row >= this.fromRow && row <= this.toRow &&\r\n          cell >= this.fromCell && cell <= this.toCell;\r\n    };\r\n\r\n    /***\r\n     * Returns a readable representation of a range.\r\n     * @method toString\r\n     * @return {String}\r\n     */\r\n    this.toString = function () {\r\n      if (this.isSingleCell()) {\r\n        return \"(\" + this.fromRow + \":\" + this.fromCell + \")\";\r\n      }\r\n      else {\r\n        return \"(\" + this.fromRow + \":\" + this.fromCell + \" - \" + this.toRow + \":\" + this.toCell + \")\";\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /***\r\n   * A base class that all special / non-data rows (like Group and GroupTotals) derive from.\r\n   * @class NonDataItem\r\n   * @constructor\r\n   */\r\n  function NonDataItem() {\r\n    this.__nonDataRow = true;\r\n  }\r\n\r\n\r\n  /***\r\n   * Information about a group of rows.\r\n   * @class Group\r\n   * @extends Slick.NonDataItem\r\n   * @constructor\r\n   */\r\n  function Group() {\r\n    this.__group = true;\r\n    this.__updated = false;\r\n    \r\n    /***\r\n     * Number of rows in the group.\r\n     * @property count\r\n     * @type {Integer}\r\n     */\r\n    this.count = 0;\r\n\r\n    /***\r\n     * Grouping value.\r\n     * @property value\r\n     * @type {Object}\r\n     */\r\n    this.value = null;\r\n\r\n    /***\r\n     * Formatted display value of the group.\r\n     * @property title\r\n     * @type {String}\r\n     */\r\n    this.title = null;\r\n\r\n    /***\r\n     * Whether a group is collapsed.\r\n     * @property collapsed\r\n     * @type {Boolean}\r\n     */\r\n    this.collapsed = false;\r\n\r\n    /***\r\n     * GroupTotals, if any.\r\n     * @property totals\r\n     * @type {GroupTotals}\r\n     */\r\n    this.totals = null;\r\n  }\r\n\r\n  Group.prototype = new NonDataItem();\r\n\r\n  /***\r\n   * Compares two Group instances.\r\n   * @method equals\r\n   * @return {Boolean}\r\n   * @param group {Group} Group instance to compare to.\r\n   */\r\n  Group.prototype.equals = function (group) {\r\n    return this.value === group.value &&\r\n        this.count === group.count &&\r\n        this.collapsed === group.collapsed;\r\n  };\r\n\r\n  /***\r\n   * Information about group totals.\r\n   * An instance of GroupTotals will be created for each totals row and passed to the aggregators\r\n   * so that they can store arbitrary data in it.  That data can later be accessed by group totals\r\n   * formatters during the display.\r\n   * @class GroupTotals\r\n   * @extends Slick.NonDataItem\r\n   * @constructor\r\n   */\r\n  function GroupTotals() {\r\n    this.__groupTotals = true;\r\n\r\n    /***\r\n     * Parent Group.\r\n     * @param group\r\n     * @type {Group}\r\n     */\r\n    this.group = null;\r\n  }\r\n\r\n  GroupTotals.prototype = new NonDataItem();\r\n\r\n  /***\r\n   * A locking helper to track the active edit controller and ensure that only a single controller\r\n   * can be active at a time.  This prevents a whole class of state and validation synchronization\r\n   * issues.  An edit controller (such as SlickGrid) can query if an active edit is in progress\r\n   * and attempt a commit or cancel before proceeding.\r\n   * @class EditorLock\r\n   * @constructor\r\n   */\r\n  function EditorLock() {\r\n    var activeEditController = null;\r\n\r\n    /***\r\n     * Returns true if a specified edit controller is active (has the edit lock).\r\n     * If the parameter is not specified, returns true if any edit controller is active.\r\n     * @method isActive\r\n     * @param editController {EditController}\r\n     * @return {Boolean}\r\n     */\r\n    this.isActive = function (editController) {\r\n      return (editController ? activeEditController === editController : activeEditController !== null);\r\n    };\r\n\r\n    /***\r\n     * Sets the specified edit controller as the active edit controller (acquire edit lock).\r\n     * If another edit controller is already active, and exception will be thrown.\r\n     * @method activate\r\n     * @param editController {EditController} edit controller acquiring the lock\r\n     */\r\n    this.activate = function (editController) {\r\n      if (editController === activeEditController) { // already activated?\r\n        return;\r\n      }\r\n      if (activeEditController !== null) {\r\n        throw \"SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController\";\r\n      }\r\n      if (!editController.commitCurrentEdit) {\r\n        throw \"SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()\";\r\n      }\r\n      if (!editController.cancelCurrentEdit) {\r\n        throw \"SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()\";\r\n      }\r\n      activeEditController = editController;\r\n    };\r\n\r\n    /***\r\n     * Unsets the specified edit controller as the active edit controller (release edit lock).\r\n     * If the specified edit controller is not the active one, an exception will be thrown.\r\n     * @method deactivate\r\n     * @param editController {EditController} edit controller releasing the lock\r\n     */\r\n    this.deactivate = function (editController) {\r\n      if (activeEditController !== editController) {\r\n        throw \"SlickGrid.EditorLock.deactivate: specified editController is not the currently active one\";\r\n      }\r\n      activeEditController = null;\r\n    };\r\n\r\n    /***\r\n     * Attempts to commit the current edit by calling \"commitCurrentEdit\" method on the active edit\r\n     * controller and returns whether the commit attempt was successful (commit may fail due to validation\r\n     * errors, etc.).  Edit controller's \"commitCurrentEdit\" must return true if the commit has succeeded\r\n     * and false otherwise.  If no edit controller is active, returns true.\r\n     * @method commitCurrentEdit\r\n     * @return {Boolean}\r\n     */\r\n    this.commitCurrentEdit = function () {\r\n      return (activeEditController ? activeEditController.commitCurrentEdit() : true);\r\n    };\r\n\r\n    /***\r\n     * Attempts to cancel the current edit by calling \"cancelCurrentEdit\" method on the active edit\r\n     * controller and returns whether the edit was successfully cancelled.  If no edit controller is\r\n     * active, returns true.\r\n     * @method cancelCurrentEdit\r\n     * @return {Boolean}\r\n     */\r\n    this.cancelCurrentEdit = function cancelCurrentEdit() {\r\n      return (activeEditController ? activeEditController.cancelCurrentEdit() : true);\r\n    };\r\n  }\r\n})(jQuery);\r\n\r\n\r\n","/***\r\n * Contains basic SlickGrid formatters.\r\n * @module Formatters\r\n * @namespace Slick\r\n */\r\n\r\n(function ($) {\r\n  // register namespace\r\n  $.extend(true, window, {\r\n    \"Slick\": {\r\n      \"Formatters\": {\r\n        \"PercentComplete\": PercentCompleteFormatter,\r\n        \"PercentCompleteBar\": PercentCompleteBarFormatter,\r\n        \"YesNo\": YesNoFormatter,\r\n        \"Checkmark\": CheckmarkFormatter\r\n      }\r\n    }\r\n  });\r\n\r\n  function PercentCompleteFormatter(row, cell, value, columnDef, dataContext) {\r\n    if (value == null || value === \"\") {\r\n      return \"-\";\r\n    } else if (value < 50) {\r\n      return \"<span style='color:red;font-weight:bold;'>\" + value + \"%</span>\";\r\n    } else {\r\n      return \"<span style='color:green'>\" + value + \"%</span>\";\r\n    }\r\n  }\r\n\r\n  function PercentCompleteBarFormatter(row, cell, value, columnDef, dataContext) {\r\n    if (value == null || value === \"\") {\r\n      return \"\";\r\n    }\r\n\r\n    var color;\r\n\r\n    if (value < 30) {\r\n      color = \"red\";\r\n    } else if (value < 70) {\r\n      color = \"silver\";\r\n    } else {\r\n      color = \"green\";\r\n    }\r\n\r\n    return \"<span class='percent-complete-bar' style='background:\" + color + \";width:\" + value + \"%'></span>\";\r\n  }\r\n\r\n  function YesNoFormatter(row, cell, value, columnDef, dataContext) {\r\n    return value ? \"Yes\" : \"No\";\r\n  }\r\n\r\n  function CheckmarkFormatter(row, cell, value, columnDef, dataContext) {\r\n    return value ? \"<img src='../images/tick.png'>\" : \"\";\r\n  }\r\n})(jQuery);","/***\r\n * Contains basic SlickGrid editors.\r\n * @module Editors\r\n * @namespace Slick\r\n */\r\n\r\n(function ($) {\r\n  // register namespace\r\n  $.extend(true, window, {\r\n    \"Slick\": {\r\n      \"Editors\": {\r\n        \"Text\": TextEditor,\r\n        \"Integer\": IntegerEditor,\r\n        \"Date\": DateEditor,\r\n        \"YesNoSelect\": YesNoSelectEditor,\r\n        \"Checkbox\": CheckboxEditor,\r\n        \"PercentComplete\": PercentCompleteEditor,\r\n        \"LongText\": LongTextEditor\r\n      }\r\n    }\r\n  });\r\n\r\n  function TextEditor(args) {\r\n    var $input;\r\n    var defaultValue;\r\n    var scope = this;\r\n\r\n    this.init = function () {\r\n      $input = $(\"<INPUT type=text class='editor-text' />\")\r\n          .appendTo(args.container)\r\n          .bind(\"keydown.nav\", function (e) {\r\n            if (e.keyCode === $.ui.keyCode.LEFT || e.keyCode === $.ui.keyCode.RIGHT) {\r\n              e.stopImmediatePropagation();\r\n            }\r\n          })\r\n          .focus()\r\n          .select();\r\n    };\r\n\r\n    this.destroy = function () {\r\n      $input.remove();\r\n    };\r\n\r\n    this.focus = function () {\r\n      $input.focus();\r\n    };\r\n\r\n    this.getValue = function () {\r\n      return $input.val();\r\n    };\r\n\r\n    this.setValue = function (val) {\r\n      $input.val(val);\r\n    };\r\n\r\n    this.loadValue = function (item) {\r\n      defaultValue = item[args.column.field] || \"\";\r\n      $input.val(defaultValue);\r\n      $input[0].defaultValue = defaultValue;\r\n      $input.select();\r\n    };\r\n\r\n    this.serializeValue = function () {\r\n      return $input.val();\r\n    };\r\n\r\n    this.applyValue = function (item, state) {\r\n      item[args.column.field] = state;\r\n    };\r\n\r\n    this.isValueChanged = function () {\r\n      return (!($input.val() == \"\" && defaultValue == null)) && ($input.val() != defaultValue);\r\n    };\r\n\r\n    this.validate = function () {\r\n      if (args.column.validator) {\r\n        var validationResults = args.column.validator($input.val());\r\n        if (!validationResults.valid) {\r\n          return validationResults;\r\n        }\r\n      }\r\n\r\n      return {\r\n        valid: true,\r\n        msg: null\r\n      };\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  function IntegerEditor(args) {\r\n    var $input;\r\n    var defaultValue;\r\n    var scope = this;\r\n\r\n    this.init = function () {\r\n      $input = $(\"<INPUT type=text class='editor-text' />\");\r\n\r\n      $input.bind(\"keydown.nav\", function (e) {\r\n        if (e.keyCode === $.ui.keyCode.LEFT || e.keyCode === $.ui.keyCode.RIGHT) {\r\n          e.stopImmediatePropagation();\r\n        }\r\n      });\r\n\r\n      $input.appendTo(args.container);\r\n      $input.focus().select();\r\n    };\r\n\r\n    this.destroy = function () {\r\n      $input.remove();\r\n    };\r\n\r\n    this.focus = function () {\r\n      $input.focus();\r\n    };\r\n\r\n    this.loadValue = function (item) {\r\n      defaultValue = item[args.column.field];\r\n      $input.val(defaultValue);\r\n      $input[0].defaultValue = defaultValue;\r\n      $input.select();\r\n    };\r\n\r\n    this.serializeValue = function () {\r\n      return parseInt($input.val(), 10) || 0;\r\n    };\r\n\r\n    this.applyValue = function (item, state) {\r\n      item[args.column.field] = state;\r\n    };\r\n\r\n    this.isValueChanged = function () {\r\n      return (!($input.val() == \"\" && defaultValue == null)) && ($input.val() != defaultValue);\r\n    };\r\n\r\n    this.validate = function () {\r\n      if (isNaN($input.val())) {\r\n        return {\r\n          valid: false,\r\n          msg: \"Please enter a valid integer\"\r\n        };\r\n      }\r\n\r\n      return {\r\n        valid: true,\r\n        msg: null\r\n      };\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  function DateEditor(args) {\r\n    var $input;\r\n    var defaultValue;\r\n    var scope = this;\r\n    var calendarOpen = false;\r\n\r\n    this.init = function () {\r\n      $input = $(\"<INPUT type=text class='editor-text' />\");\r\n      $input.appendTo(args.container);\r\n      $input.focus().select();\r\n      $input.datepicker({\r\n        showOn: \"button\",\r\n        buttonImageOnly: true,\r\n        buttonImage: \"../images/calendar.gif\",\r\n        beforeShow: function () {\r\n          calendarOpen = true\r\n        },\r\n        onClose: function () {\r\n          calendarOpen = false\r\n        }\r\n      });\r\n      $input.width($input.width() - 18);\r\n    };\r\n\r\n    this.destroy = function () {\r\n      $.datepicker.dpDiv.stop(true, true);\r\n      $input.datepicker(\"hide\");\r\n      $input.datepicker(\"destroy\");\r\n      $input.remove();\r\n    };\r\n\r\n    this.show = function () {\r\n      if (calendarOpen) {\r\n        $.datepicker.dpDiv.stop(true, true).show();\r\n      }\r\n    };\r\n\r\n    this.hide = function () {\r\n      if (calendarOpen) {\r\n        $.datepicker.dpDiv.stop(true, true).hide();\r\n      }\r\n    };\r\n\r\n    this.position = function (position) {\r\n      if (!calendarOpen) {\r\n        return;\r\n      }\r\n      $.datepicker.dpDiv\r\n          .css(\"top\", position.top + 30)\r\n          .css(\"left\", position.left);\r\n    };\r\n\r\n    this.focus = function () {\r\n      $input.focus();\r\n    };\r\n\r\n    this.loadValue = function (item) {\r\n      defaultValue = item[args.column.field];\r\n      $input.val(defaultValue);\r\n      $input[0].defaultValue = defaultValue;\r\n      $input.select();\r\n    };\r\n\r\n    this.serializeValue = function () {\r\n      return $input.val();\r\n    };\r\n\r\n    this.applyValue = function (item, state) {\r\n      item[args.column.field] = state;\r\n    };\r\n\r\n    this.isValueChanged = function () {\r\n      return (!($input.val() == \"\" && defaultValue == null)) && ($input.val() != defaultValue);\r\n    };\r\n\r\n    this.validate = function () {\r\n      return {\r\n        valid: true,\r\n        msg: null\r\n      };\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  function YesNoSelectEditor(args) {\r\n    var $select;\r\n    var defaultValue;\r\n    var scope = this;\r\n\r\n    this.init = function () {\r\n      $select = $(\"<SELECT tabIndex='0' class='editor-yesno'><OPTION value='yes'>Yes</OPTION><OPTION value='no'>No</OPTION></SELECT>\");\r\n      $select.appendTo(args.container);\r\n      $select.focus();\r\n    };\r\n\r\n    this.destroy = function () {\r\n      $select.remove();\r\n    };\r\n\r\n    this.focus = function () {\r\n      $select.focus();\r\n    };\r\n\r\n    this.loadValue = function (item) {\r\n      $select.val((defaultValue = item[args.column.field]) ? \"yes\" : \"no\");\r\n      $select.select();\r\n    };\r\n\r\n    this.serializeValue = function () {\r\n      return ($select.val() == \"yes\");\r\n    };\r\n\r\n    this.applyValue = function (item, state) {\r\n      item[args.column.field] = state;\r\n    };\r\n\r\n    this.isValueChanged = function () {\r\n      return ($select.val() != defaultValue);\r\n    };\r\n\r\n    this.validate = function () {\r\n      return {\r\n        valid: true,\r\n        msg: null\r\n      };\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  function CheckboxEditor(args) {\r\n    var $select;\r\n    var defaultValue;\r\n    var scope = this;\r\n\r\n    this.init = function () {\r\n      $select = $(\"<INPUT type=checkbox value='true' class='editor-checkbox' hideFocus>\");\r\n      $select.appendTo(args.container);\r\n      $select.focus();\r\n    };\r\n\r\n    this.destroy = function () {\r\n      $select.remove();\r\n    };\r\n\r\n    this.focus = function () {\r\n      $select.focus();\r\n    };\r\n\r\n    this.loadValue = function (item) {\r\n      defaultValue = item[args.column.field];\r\n      if (defaultValue) {\r\n        $select.attr(\"checked\", \"checked\");\r\n      } else {\r\n        $select.removeAttr(\"checked\");\r\n      }\r\n    };\r\n\r\n    this.serializeValue = function () {\r\n      return $select.attr(\"checked\");\r\n    };\r\n\r\n    this.applyValue = function (item, state) {\r\n      item[args.column.field] = state;\r\n    };\r\n\r\n    this.isValueChanged = function () {\r\n      return ($select.attr(\"checked\") != defaultValue);\r\n    };\r\n\r\n    this.validate = function () {\r\n      return {\r\n        valid: true,\r\n        msg: null\r\n      };\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  function PercentCompleteEditor(args) {\r\n    var $input, $picker;\r\n    var defaultValue;\r\n    var scope = this;\r\n\r\n    this.init = function () {\r\n      $input = $(\"<INPUT type=text class='editor-percentcomplete' />\");\r\n      $input.width($(args.container).innerWidth() - 25);\r\n      $input.appendTo(args.container);\r\n\r\n      $picker = $(\"<div class='editor-percentcomplete-picker' />\").appendTo(args.container);\r\n      $picker.append(\"<div class='editor-percentcomplete-helper'><div class='editor-percentcomplete-wrapper'><div class='editor-percentcomplete-slider' /><div class='editor-percentcomplete-buttons' /></div></div>\");\r\n\r\n      $picker.find(\".editor-percentcomplete-buttons\").append(\"<button val=0>Not started</button><br/><button val=50>In Progress</button><br/><button val=100>Complete</button>\");\r\n\r\n      $input.focus().select();\r\n\r\n      $picker.find(\".editor-percentcomplete-slider\").slider({\r\n        orientation: \"vertical\",\r\n        range: \"min\",\r\n        value: defaultValue,\r\n        slide: function (event, ui) {\r\n          $input.val(ui.value)\r\n        }\r\n      });\r\n\r\n      $picker.find(\".editor-percentcomplete-buttons button\").bind(\"click\", function (e) {\r\n        $input.val($(this).attr(\"val\"));\r\n        $picker.find(\".editor-percentcomplete-slider\").slider(\"value\", $(this).attr(\"val\"));\r\n      })\r\n    };\r\n\r\n    this.destroy = function () {\r\n      $input.remove();\r\n      $picker.remove();\r\n    };\r\n\r\n    this.focus = function () {\r\n      $input.focus();\r\n    };\r\n\r\n    this.loadValue = function (item) {\r\n      $input.val(defaultValue = item[args.column.field]);\r\n      $input.select();\r\n    };\r\n\r\n    this.serializeValue = function () {\r\n      return parseInt($input.val(), 10) || 0;\r\n    };\r\n\r\n    this.applyValue = function (item, state) {\r\n      item[args.column.field] = state;\r\n    };\r\n\r\n    this.isValueChanged = function () {\r\n      return (!($input.val() == \"\" && defaultValue == null)) && ((parseInt($input.val(), 10) || 0) != defaultValue);\r\n    };\r\n\r\n    this.validate = function () {\r\n      if (isNaN(parseInt($input.val(), 10))) {\r\n        return {\r\n          valid: false,\r\n          msg: \"Please enter a valid positive number\"\r\n        };\r\n      }\r\n\r\n      return {\r\n        valid: true,\r\n        msg: null\r\n      };\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  /*\r\n   * An example of a \"detached\" editor.\r\n   * The UI is added onto document BODY and .position(), .show() and .hide() are implemented.\r\n   * KeyDown events are also handled to provide handling for Tab, Shift-Tab, Esc and Ctrl-Enter.\r\n   */\r\n  function LongTextEditor(args) {\r\n    var $input, $wrapper;\r\n    var defaultValue;\r\n    var scope = this;\r\n\r\n    this.init = function () {\r\n      var $container = $(\"body\");\r\n\r\n      $wrapper = $(\"<DIV style='z-index:10000;position:absolute;background:white;padding:5px;border:3px solid gray; -moz-border-radius:10px; border-radius:10px;'/>\")\r\n          .appendTo($container);\r\n\r\n      $input = $(\"<TEXTAREA hidefocus rows=5 style='backround:white;width:250px;height:80px;border:0;outline:0'>\")\r\n          .appendTo($wrapper);\r\n\r\n      $(\"<DIV style='text-align:right'><BUTTON>Save</BUTTON><BUTTON>Cancel</BUTTON></DIV>\")\r\n          .appendTo($wrapper);\r\n\r\n      $wrapper.find(\"button:first\").bind(\"click\", this.save);\r\n      $wrapper.find(\"button:last\").bind(\"click\", this.cancel);\r\n      $input.bind(\"keydown\", this.handleKeyDown);\r\n\r\n      scope.position(args.position);\r\n      $input.focus().select();\r\n    };\r\n\r\n    this.handleKeyDown = function (e) {\r\n      if (e.which == $.ui.keyCode.ENTER && e.ctrlKey) {\r\n        scope.save();\r\n      } else if (e.which == $.ui.keyCode.ESCAPE) {\r\n        e.preventDefault();\r\n        scope.cancel();\r\n      } else if (e.which == $.ui.keyCode.TAB && e.shiftKey) {\r\n        e.preventDefault();\r\n        grid.navigatePrev();\r\n      } else if (e.which == $.ui.keyCode.TAB) {\r\n        e.preventDefault();\r\n        grid.navigateNext();\r\n      }\r\n    };\r\n\r\n    this.save = function () {\r\n      args.commitChanges();\r\n    };\r\n\r\n    this.cancel = function () {\r\n      $input.val(defaultValue);\r\n      args.cancelChanges();\r\n    };\r\n\r\n    this.hide = function () {\r\n      $wrapper.hide();\r\n    };\r\n\r\n    this.show = function () {\r\n      $wrapper.show();\r\n    };\r\n\r\n    this.position = function (position) {\r\n      $wrapper\r\n          .css(\"top\", position.top - 5)\r\n          .css(\"left\", position.left - 5)\r\n    };\r\n\r\n    this.destroy = function () {\r\n      $wrapper.remove();\r\n    };\r\n\r\n    this.focus = function () {\r\n      $input.focus();\r\n    };\r\n\r\n    this.loadValue = function (item) {\r\n      $input.val(defaultValue = item[args.column.field]);\r\n      $input.select();\r\n    };\r\n\r\n    this.serializeValue = function () {\r\n      return $input.val();\r\n    };\r\n\r\n    this.applyValue = function (item, state) {\r\n      item[args.column.field] = state;\r\n    };\r\n\r\n    this.isValueChanged = function () {\r\n      return (!($input.val() == \"\" && defaultValue == null)) && ($input.val() != defaultValue);\r\n    };\r\n\r\n    this.validate = function () {\r\n      return {\r\n        valid: true,\r\n        msg: null\r\n      };\r\n    };\r\n\r\n    this.init();\r\n  }\r\n})(jQuery);\r\n","(function ($) {\r\n  // register namespace\r\n  $.extend(true, window, {\r\n    \"Slick\": {\r\n      \"CellRangeSelector\": CellRangeSelector\r\n    }\r\n  });\r\n\r\n\r\n  function CellRangeSelector(options) {\r\n    var _grid;\r\n    var _canvas;\r\n    var _dragging;\r\n    var _decorator;\r\n    var _self = this;\r\n    var _defaults = {\r\n      selectionCss: {\r\n        \"border\": \"2px dashed blue\"\r\n      }\r\n    };\r\n\r\n\r\n    function init(grid) {\r\n      options = $.extend(true, {}, _defaults, options);\r\n      _decorator = new Slick.CellRangeDecorator(grid, options);\r\n      _grid = grid;\r\n      _canvas = _grid.getCanvasNode();\r\n      _grid.onDragInit.subscribe(handleDragInit);\r\n      _grid.onDragStart.subscribe(handleDragStart);\r\n      _grid.onDrag.subscribe(handleDrag);\r\n      _grid.onDragEnd.subscribe(handleDragEnd);\r\n    }\r\n\r\n    function destroy() {\r\n      _grid.onDragInit.unsubscribe(handleDragInit);\r\n      _grid.onDragStart.unsubscribe(handleDragStart);\r\n      _grid.onDrag.unsubscribe(handleDrag);\r\n      _grid.onDragEnd.unsubscribe(handleDragEnd);\r\n    }\r\n\r\n    function handleDragInit(e, dd) {\r\n      // prevent the grid from cancelling drag'n'drop by default\r\n      e.stopImmediatePropagation();\r\n    }\r\n\r\n    function handleDragStart(e, dd) {\r\n      var cell = _grid.getCellFromEvent(e);\r\n      if (_self.onBeforeCellRangeSelected.notify(cell) !== false) {\r\n        if (_grid.canCellBeSelected(cell.row, cell.cell)) {\r\n          _dragging = true;\r\n          e.stopImmediatePropagation();\r\n        }\r\n      }\r\n      if (!_dragging) {\r\n        return;\r\n      }\r\n\r\n      var start = _grid.getCellFromPoint(\r\n          dd.startX - $(_canvas).offset().left,\r\n          dd.startY - $(_canvas).offset().top);\r\n\r\n      dd.range = {start: start, end: {}};\r\n\r\n      return _decorator.show(new Slick.Range(start.row, start.cell));\r\n    }\r\n\r\n    function handleDrag(e, dd) {\r\n      if (!_dragging) {\r\n        return;\r\n      }\r\n      e.stopImmediatePropagation();\r\n\r\n      var end = _grid.getCellFromPoint(\r\n          e.pageX - $(_canvas).offset().left,\r\n          e.pageY - $(_canvas).offset().top);\r\n\r\n      if (!_grid.canCellBeSelected(end.row, end.cell)) {\r\n        return;\r\n      }\r\n\r\n      dd.range.end = end;\r\n      _decorator.show(new Slick.Range(dd.range.start.row, dd.range.start.cell, end.row, end.cell));\r\n    }\r\n\r\n    function handleDragEnd(e, dd) {\r\n      if (!_dragging) {\r\n        return;\r\n      }\r\n\r\n      _dragging = false;\r\n      e.stopImmediatePropagation();\r\n\r\n      _decorator.hide();\r\n      _self.onCellRangeSelected.notify({\r\n        range: new Slick.Range(\r\n            dd.range.start.row,\r\n            dd.range.start.cell,\r\n            dd.range.end.row,\r\n            dd.range.end.cell\r\n        )\r\n      });\r\n    }\r\n\r\n    $.extend(this, {\r\n      \"init\": init,\r\n      \"destroy\": destroy,\r\n\r\n      \"onBeforeCellRangeSelected\": new Slick.Event(),\r\n      \"onCellRangeSelected\": new Slick.Event()\r\n    });\r\n  }\r\n})(jQuery);","(function ($) {\r\n  // register namespace\r\n  $.extend(true, window, {\r\n    \"Slick\": {\r\n      \"CellSelectionModel\": CellSelectionModel\r\n    }\r\n  });\r\n\r\n\r\n  function CellSelectionModel(options) {\r\n    var _grid;\r\n    var _canvas;\r\n    var _ranges = [];\r\n    var _self = this;\r\n    var _selector = new Slick.CellRangeSelector({\r\n      \"selectionCss\": {\r\n        \"border\": \"2px solid black\"\r\n      }\r\n    });\r\n    var _options;\r\n    var _defaults = {\r\n      selectActiveCell: true\r\n    };\r\n\r\n\r\n    function init(grid) {\r\n      _options = $.extend(true, {}, _defaults, options);\r\n      _grid = grid;\r\n      _canvas = _grid.getCanvasNode();\r\n      _grid.onActiveCellChanged.subscribe(handleActiveCellChange);\r\n      grid.registerPlugin(_selector);\r\n      _selector.onCellRangeSelected.subscribe(handleCellRangeSelected);\r\n      _selector.onBeforeCellRangeSelected.subscribe(handleBeforeCellRangeSelected);\r\n    }\r\n\r\n    function destroy() {\r\n      _grid.onActiveCellChanged.unsubscribe(handleActiveCellChange);\r\n      _selector.onCellRangeSelected.unsubscribe(handleCellRangeSelected);\r\n      _selector.onBeforeCellRangeSelected.unsubscribe(handleBeforeCellRangeSelected);\r\n      _grid.unregisterPlugin(_selector);\r\n    }\r\n\r\n    function removeInvalidRanges(ranges) {\r\n      var result = [];\r\n\r\n      for (var i = 0; i < ranges.length; i++) {\r\n        var r = ranges[i];\r\n        if (_grid.canCellBeSelected(r.fromRow, r.fromCell) && _grid.canCellBeSelected(r.toRow, r.toCell)) {\r\n          result.push(r);\r\n        }\r\n      }\r\n\r\n      return result;\r\n    }\r\n\r\n    function setSelectedRanges(ranges) {\r\n      _ranges = removeInvalidRanges(ranges);\r\n      _self.onSelectedRangesChanged.notify(_ranges);\r\n    }\r\n\r\n    function getSelectedRanges() {\r\n      return _ranges;\r\n    }\r\n\r\n    function handleBeforeCellRangeSelected(e, args) {\r\n      if (_grid.getEditorLock().isActive()) {\r\n        e.stopPropagation();\r\n        return false;\r\n      }\r\n    }\r\n\r\n    function handleCellRangeSelected(e, args) {\r\n      setSelectedRanges([args.range]);\r\n    }\r\n\r\n    function handleActiveCellChange(e, args) {\r\n      if (_options.selectActiveCell) {\r\n        setSelectedRanges([new Slick.Range(args.row, args.cell)]);\r\n      }\r\n    }\r\n\r\n    $.extend(this, {\r\n      \"getSelectedRanges\": getSelectedRanges,\r\n      \"setSelectedRanges\": setSelectedRanges,\r\n\r\n      \"init\": init,\r\n      \"destroy\": destroy,\r\n\r\n      \"onSelectedRangesChanged\": new Slick.Event()\r\n    });\r\n  }\r\n})(jQuery);","(function ($) {\r\n  // register namespace\r\n  $.extend(true, window, {\r\n    \"Slick\": {\r\n      \"RowSelectionModel\": RowSelectionModel\r\n    }\r\n  });\r\n\r\n  function RowSelectionModel(options) {\r\n    var _grid;\r\n    var _ranges = [];\r\n    var _self = this;\r\n    var _handler = new Slick.EventHandler();\r\n    var _inHandler;\r\n    var _options;\r\n    var _defaults = {\r\n      selectActiveRow: true\r\n    };\r\n\r\n    function init(grid) {\r\n      _options = $.extend(true, {}, _defaults, options);\r\n      _grid = grid;\r\n      _handler.subscribe(_grid.onActiveCellChanged,\r\n          wrapHandler(handleActiveCellChange));\r\n      _handler.subscribe(_grid.onKeyDown,\r\n          wrapHandler(handleKeyDown));\r\n      _handler.subscribe(_grid.onClick,\r\n          wrapHandler(handleClick));\r\n    }\r\n\r\n    function destroy() {\r\n      _handler.unsubscribeAll();\r\n    }\r\n\r\n    function wrapHandler(handler) {\r\n      return function () {\r\n        if (!_inHandler) {\r\n          _inHandler = true;\r\n          handler.apply(this, arguments);\r\n          _inHandler = false;\r\n        }\r\n      };\r\n    }\r\n\r\n    function rangesToRows(ranges) {\r\n      var rows = [];\r\n      for (var i = 0; i < ranges.length; i++) {\r\n        for (var j = ranges[i].fromRow; j <= ranges[i].toRow; j++) {\r\n          rows.push(j);\r\n        }\r\n      }\r\n      return rows;\r\n    }\r\n\r\n    function rowsToRanges(rows) {\r\n      var ranges = [];\r\n      var lastCell = _grid.getColumns().length - 1;\r\n      for (var i = 0; i < rows.length; i++) {\r\n        ranges.push(new Slick.Range(rows[i], 0, rows[i], lastCell));\r\n      }\r\n      return ranges;\r\n    }\r\n\r\n    function getRowsRange(from, to) {\r\n      var i, rows = [];\r\n      for (i = from; i <= to; i++) {\r\n        rows.push(i);\r\n      }\r\n      for (i = to; i < from; i++) {\r\n        rows.push(i);\r\n      }\r\n      return rows;\r\n    }\r\n\r\n    function getSelectedRows() {\r\n      return rangesToRows(_ranges);\r\n    }\r\n\r\n    function setSelectedRows(rows) {\r\n      setSelectedRanges(rowsToRanges(rows));\r\n    }\r\n\r\n    function setSelectedRanges(ranges) {\r\n      _ranges = ranges;\r\n      _self.onSelectedRangesChanged.notify(_ranges);\r\n    }\r\n\r\n    function getSelectedRanges() {\r\n      return _ranges;\r\n    }\r\n\r\n    function handleActiveCellChange(e, data) {\r\n      if (_options.selectActiveRow) {\r\n        setSelectedRanges([new Slick.Range(data.row, 0, data.row, _grid.getColumns().length - 1)]);\r\n      }\r\n    }\r\n\r\n    function handleKeyDown(e) {\r\n      var activeRow = _grid.getActiveCell();\r\n      if (activeRow && e.shiftKey && !e.ctrlKey && !e.altKey && !e.metaKey && (e.which == 38 || e.which == 40)) {\r\n        var selectedRows = getSelectedRows();\r\n        selectedRows.sort(function (x, y) {\r\n          return x - y\r\n        });\r\n\r\n        if (!selectedRows.length) {\r\n          selectedRows = [activeRow.row];\r\n        }\r\n\r\n        var top = selectedRows[0];\r\n        var bottom = selectedRows[selectedRows.length - 1];\r\n        var active;\r\n\r\n        if (e.which == 40) {\r\n          active = activeRow.row < bottom || top == bottom ? ++bottom : ++top;\r\n        } else {\r\n          active = activeRow.row < bottom ? --bottom : --top;\r\n        }\r\n\r\n        if (active >= 0 && active < _grid.getDataLength()) {\r\n          _grid.scrollRowIntoView(active);\r\n          _ranges = rowsToRanges(getRowsRange(top, bottom));\r\n          setSelectedRanges(_ranges);\r\n        }\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      }\r\n    }\r\n\r\n    function handleClick(e) {\r\n      var cell = _grid.getCellFromEvent(e);\r\n      if (!cell || !_grid.canCellBeActive(cell.row, cell.cell)) {\r\n        return false;\r\n      }\r\n\r\n      var selection = rangesToRows(_ranges);\r\n      var idx = $.inArray(cell.row, selection);\r\n\r\n      if (!e.ctrlKey && !e.shiftKey && !e.metaKey) {\r\n        return false;\r\n      }\r\n      else if (_grid.getOptions().multiSelect) {\r\n        if (idx === -1 && (e.ctrlKey || e.metaKey)) {\r\n          selection.push(cell.row);\r\n          _grid.setActiveCell(cell.row, cell.cell);\r\n        } else if (idx !== -1 && (e.ctrlKey || e.metaKey)) {\r\n          selection = $.grep(selection, function (o, i) {\r\n            return (o !== cell.row);\r\n          });\r\n          _grid.setActiveCell(cell.row, cell.cell);\r\n        } else if (selection.length && e.shiftKey) {\r\n          var last = selection.pop();\r\n          var from = Math.min(cell.row, last);\r\n          var to = Math.max(cell.row, last);\r\n          selection = [];\r\n          for (var i = from; i <= to; i++) {\r\n            if (i !== last) {\r\n              selection.push(i);\r\n            }\r\n          }\r\n          selection.push(last);\r\n          _grid.setActiveCell(cell.row, cell.cell);\r\n        }\r\n      }\r\n\r\n      _ranges = rowsToRanges(selection);\r\n      setSelectedRanges(_ranges);\r\n      e.stopImmediatePropagation();\r\n\r\n      return true;\r\n    }\r\n\r\n    $.extend(this, {\r\n      \"getSelectedRows\": getSelectedRows,\r\n      \"setSelectedRows\": setSelectedRows,\r\n\r\n      \"getSelectedRanges\": getSelectedRanges,\r\n      \"setSelectedRanges\": setSelectedRanges,\r\n\r\n      \"init\": init,\r\n      \"destroy\": destroy,\r\n\r\n      \"onSelectedRangesChanged\": new Slick.Event()\r\n    });\r\n  }\r\n})(jQuery);","//Analogue for Slick.RowSelectionModel, without handle ctrl+click.\r\n(function ($) {\r\n  // register namespace\r\n  $.extend(true, window, {\r\n    \"Asyst\": {\r\n      \"RowSelectionModel\": RowSelectionModel\r\n    }\r\n  });\r\n\r\n  function RowSelectionModel(options) {\r\n    var _grid;\r\n    var _ranges = [];\r\n    var _self = this;\r\n    var _handler = new Slick.EventHandler();\r\n    var _inHandler;\r\n    var _options;\r\n    var _defaults = {\r\n      selectActiveRow: true\r\n    };\r\n\r\n    function init(grid) {\r\n      _options = $.extend(true, {}, _defaults, options);\r\n      _grid = grid;\r\n      _handler.subscribe(_grid.onActiveCellChanged,\r\n          wrapHandler(handleActiveCellChange));\r\n      _handler.subscribe(_grid.onKeyDown,\r\n          wrapHandler(handleKeyDown));\r\n      _handler.subscribe(_grid.onClick,\r\n          wrapHandler(handleClick));\r\n    }\r\n\r\n    function destroy() {\r\n      _handler.unsubscribeAll();\r\n    }\r\n\r\n    function wrapHandler(handler) {\r\n      return function () {\r\n        if (!_inHandler) {\r\n          _inHandler = true;\r\n          handler.apply(this, arguments);\r\n          _inHandler = false;\r\n        }\r\n      };\r\n    }\r\n\r\n    function rangesToRows(ranges) {\r\n      var rows = [];\r\n      for (var i = 0; i < ranges.length; i++) {\r\n        for (var j = ranges[i].fromRow; j <= ranges[i].toRow; j++) {\r\n          rows.push(j);\r\n        }\r\n      }\r\n      return rows;\r\n    }\r\n\r\n    function rowsToRanges(rows) {\r\n      var ranges = [];\r\n      var lastCell = _grid.getColumns().length - 1;\r\n      for (var i = 0; i < rows.length; i++) {\r\n        ranges.push(new Slick.Range(rows[i], 0, rows[i], lastCell));\r\n      }\r\n      return ranges;\r\n    }\r\n\r\n    function getRowsRange(from, to) {\r\n      var i, rows = [];\r\n      for (i = from; i <= to; i++) {\r\n        rows.push(i);\r\n      }\r\n      for (i = to; i < from; i++) {\r\n        rows.push(i);\r\n      }\r\n      return rows;\r\n    }\r\n\r\n    function getSelectedRows() {\r\n      return rangesToRows(_ranges);\r\n    }\r\n\r\n    function setSelectedRows(rows) {\r\n      setSelectedRanges(rowsToRanges(rows));\r\n    }\r\n\r\n    function setSelectedRanges(ranges) {\r\n      _ranges = ranges;\r\n      _self.onSelectedRangesChanged.notify(_ranges);\r\n    }\r\n\r\n    function getSelectedRanges() {\r\n      return _ranges;\r\n    }\r\n\r\n    function handleActiveCellChange(e, data) {\r\n      if (_options.selectActiveRow) {\r\n        setSelectedRanges([new Slick.Range(data.row, 0, data.row, _grid.getColumns().length - 1)]);\r\n      }\r\n    }\r\n\r\n    function handleKeyDown(e) {\r\n      var activeRow = _grid.getActiveCell();\r\n      if (activeRow && e.shiftKey && !e.ctrlKey && !e.altKey && !e.metaKey && (e.which == 38 || e.which == 40)) {\r\n        var selectedRows = getSelectedRows();\r\n        selectedRows.sort(function (x, y) {\r\n          return x - y\r\n        });\r\n\r\n        if (!selectedRows.length) {\r\n          selectedRows = [activeRow.row];\r\n        }\r\n\r\n        var top = selectedRows[0];\r\n        var bottom = selectedRows[selectedRows.length - 1];\r\n        var active;\r\n\r\n        if (e.which == 40) {\r\n          active = activeRow.row < bottom || top == bottom ? ++bottom : ++top;\r\n        } else {\r\n          active = activeRow.row < bottom ? --bottom : --top;\r\n        }\r\n\r\n        if (active >= 0 && active < _grid.getDataLength()) {\r\n          _grid.scrollRowIntoView(active);\r\n          _ranges = rowsToRanges(getRowsRange(top, bottom));\r\n          setSelectedRanges(_ranges);\r\n        }\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      }\r\n    }\r\n\r\n    function handleClick(e) {\r\n      var cell = _grid.getCellFromEvent(e);\r\n      if (!cell || !_grid.canCellBeActive(cell.row, cell.cell)) {\r\n        return false;\r\n      }\r\n\r\n      var selection = rangesToRows(_ranges);\r\n      var idx = $.inArray(cell.row, selection);\r\n\r\n      if (/*!e.ctrlKey && */!e.shiftKey && !e.metaKey) {\r\n        return false;\r\n      }\r\n      else if (_grid.getOptions().multiSelect) {\r\n        if (idx === -1 && (/*e.ctrlKey || */e.metaKey)) {\r\n          selection.push(cell.row);\r\n          _grid.setActiveCell(cell.row, cell.cell);\r\n        } else if (idx !== -1 && (/*e.ctrlKey || */e.metaKey)) {\r\n          selection = $.grep(selection, function (o, i) {\r\n            return (o !== cell.row);\r\n          });\r\n          _grid.setActiveCell(cell.row, cell.cell);\r\n        } else if (selection.length && e.shiftKey) {\r\n          var last = selection.pop();\r\n          var from = Math.min(cell.row, last);\r\n          var to = Math.max(cell.row, last);\r\n          selection = [];\r\n          for (var i = from; i <= to; i++) {\r\n            if (i !== last) {\r\n              selection.push(i);\r\n            }\r\n          }\r\n          selection.push(last);\r\n          _grid.setActiveCell(cell.row, cell.cell);\r\n        }\r\n      }\r\n\r\n      _ranges = rowsToRanges(selection);\r\n      setSelectedRanges(_ranges);\r\n      e.stopImmediatePropagation();\r\n\r\n      return true;\r\n    }\r\n\r\n    $.extend(this, {\r\n      \"getSelectedRows\": getSelectedRows,\r\n      \"setSelectedRows\": setSelectedRows,\r\n\r\n      \"getSelectedRanges\": getSelectedRanges,\r\n      \"setSelectedRanges\": setSelectedRanges,\r\n\r\n      \"init\": init,\r\n      \"destroy\": destroy,\r\n\r\n      \"onSelectedRangesChanged\": new Slick.Event()\r\n    });\r\n  }\r\n})(jQuery);","(function ($) {\r\n    // register namespace\r\n    $.extend(true, window, {\r\n        \"Slick\": {\r\n            \"CheckboxSelectColumn\": CheckboxSelectColumn\r\n        }\r\n    });\r\n\r\n\r\n    function CheckboxSelectColumn(options) {\r\n        var _grid;\r\n        var _self = this;\r\n        var _selectedRowsLookup = {};\r\n        var _defaults = {\r\n            columnId: \"_checkbox_selector\",\r\n            cssClass: null,\r\n            toolTip: Globa.SelectRows.locale(),\r\n            width: 30\r\n        };\r\n\r\n        var _options = $.extend(true, {}, _defaults, options);\r\n\r\n        function init(grid) {\r\n            _grid = grid;\r\n            _grid.onSelectedRowsChanged.subscribe(handleSelectedRowsChanged);\r\n            _grid.onClick.subscribe(handleClick);\r\n            _grid.onHeaderClick.subscribe(handleHeaderClick);\r\n            _grid.onKeyDown.subscribe(handleKeyDown);\r\n        }\r\n\r\n        function destroy() {\r\n            _grid.onSelectedRowsChanged.unsubscribe(handleSelectedRowsChanged);\r\n            _grid.onClick.unsubscribe(handleClick);\r\n            _grid.onHeaderClick.unsubscribe(handleHeaderClick);\r\n            _grid.onKeyDown.unsubscribe(handleKeyDown);\r\n        }\r\n\r\n        function handleSelectedRowsChanged(e, args) {\r\n            var selectedRows = _grid.getSelectedRows();\r\n            var lookup = {}, row, i;\r\n            for (i = 0; i < selectedRows.length; i++) {\r\n                row = selectedRows[i];\r\n                lookup[row] = true;\r\n                if (lookup[row] !== _selectedRowsLookup[row]) {\r\n                    _grid.invalidateRow(row);\r\n                    delete _selectedRowsLookup[row];\r\n                }\r\n            }\r\n            for (i in _selectedRowsLookup) {\r\n                _grid.invalidateRow(i);\r\n            }\r\n            _selectedRowsLookup = lookup;\r\n            _grid.render();\r\n\r\n            if (selectedRows.length == _grid.getDataLength()) {\r\n                _grid.updateColumnHeader(_options.columnId, \"<input type='checkbox' checked='checked'>\", _options.toolTip);\r\n            } else {\r\n                _grid.updateColumnHeader(_options.columnId, \"<input type='checkbox'>\", _options.toolTip);\r\n            }\r\n        }\r\n\r\n        function handleKeyDown(e, args) {\r\n            if (e.which == 32) {\r\n                if (_grid.getColumns()[args.cell].id === _options.columnId) {\r\n                    // if editing, try to commit\r\n                    if (!_grid.getEditorLock().isActive() || _grid.getEditorLock().commitCurrentEdit()) {\r\n                        toggleRowSelection(args.row);\r\n                    }\r\n                    e.preventDefault();\r\n                    e.stopImmediatePropagation();\r\n                }\r\n            }\r\n        }\r\n\r\n        function handleClick(e, args) {\r\n            // clicking on a row select checkbox\r\n            if (_grid.getColumns()[args.cell].id === _options.columnId && $(e.target).is(\":checkbox\")) {\r\n                // if editing, try to commit\r\n                if (_grid.getEditorLock().isActive() && !_grid.getEditorLock().commitCurrentEdit()) {\r\n                    e.preventDefault();\r\n                    e.stopImmediatePropagation();\r\n                    return;\r\n                }\r\n\r\n                toggleRowSelection(args.row);\r\n                e.stopPropagation();\r\n                e.stopImmediatePropagation();\r\n            }\r\n        }\r\n\r\n        function toggleRowSelection(row) {\r\n            if (_selectedRowsLookup[row]) {\r\n                _grid.setSelectedRows($.grep(_grid.getSelectedRows(), function (n) {\r\n                    return n != row\r\n                }));\r\n            } else {\r\n                _grid.setSelectedRows(_grid.getSelectedRows().concat(row));\r\n            }\r\n        }\r\n\r\n        function handleHeaderClick(e, args) {\r\n            if (args.column.id == _options.columnId && $(e.target).is(\":checkbox\")) {\r\n                // if editing, try to commit\r\n                if (_grid.getEditorLock().isActive() && !_grid.getEditorLock().commitCurrentEdit()) {\r\n                    e.preventDefault();\r\n                    e.stopImmediatePropagation();\r\n                    return;\r\n                }\r\n\r\n                if ($(e.target).is(\":checked\")) {\r\n                    var rows = [];\r\n                    for (var i = 0; i < _grid.getDataLength(); i++) {\r\n                        rows.push(i);\r\n                    }\r\n                    _grid.setSelectedRows(rows);\r\n                } else {\r\n                    _grid.setSelectedRows([]);\r\n                }\r\n                e.stopPropagation();\r\n                e.stopImmediatePropagation();\r\n            }\r\n        }\r\n\r\n        function getColumnDefinition() {\r\n            return {\r\n                id: _options.columnId,\r\n                name: \"<input type='checkbox'>\",\r\n                toolTip: _options.toolTip,\r\n                field: \"sel\",\r\n                width: _options.width,\r\n                resizable: false,\r\n                sortable: false,\r\n                cssClass: _options.cssClass,\r\n                formatter: checkboxSelectionFormatter\r\n            };\r\n        }\r\n\r\n        function checkboxSelectionFormatter(row, cell, value, columnDef, dataContext) {\r\n            if (dataContext) {\r\n                return _selectedRowsLookup[row]\r\n            ? \"<input type='checkbox' checked='checked'>\"\r\n            : \"<input type='checkbox'>\";\r\n            }\r\n            return null;\r\n        }\r\n\r\n        $.extend(this, {\r\n            \"init\": init,\r\n            \"destroy\": destroy,\r\n\r\n            \"getColumnDefinition\": getColumnDefinition\r\n        });\r\n    }\r\n})(jQuery);\r\n","/**\r\n * @license\r\n * (c) 2009-2012 Michael Leibman\r\n * michael{dot}leibman{at}gmail{dot}com\r\n * http://github.com/mleibman/slickgrid\r\n *\r\n * Distributed under MIT license.\r\n * All rights reserved.\r\n *\r\n * SlickGrid v2.0\r\n *\r\n * NOTES:\r\n *     Cell/row DOM manipulations are done directly bypassing jQuery's DOM manipulation methods.\r\n *     This increases the speed dramatically, but can only be done safely because there are no event handlers\r\n *     or data associated with any cell/row DOM nodes.  Cell editors must make sure they implement .destroy()\r\n *     and do proper cleanup.\r\n */\r\n\r\n// make sure required JavaScript modules are loaded\r\nif (typeof jQuery === \"undefined\") {\r\n    throw \"SlickGrid requires jquery module to be loaded\";\r\n}\r\nif (!jQuery.fn.drag) {\r\n    throw \"SlickGrid requires jquery.event.drag module to be loaded\";\r\n}\r\nif (typeof Slick === \"undefined\") {\r\n    throw \"slick.core.js not loaded\";\r\n}\r\n\r\n\r\n(function ($) {\r\n    // Slick.Grid\r\n    $.extend(true, window, {\r\n        Slick: {\r\n            Grid: SlickGrid\r\n        }\r\n    });\r\n\r\n    // shared across all grids on the page\r\n    var scrollbarDimensions;\r\n    var maxSupportedCssHeight;  // browser's breaking point\r\n\r\n    //////////////////////////////////////////////////////////////////////////////////////////////\r\n    // SlickGrid class implementation (available as Slick.Grid)\r\n\r\n    /**\r\n     * Creates a new instance of the grid.\r\n     * @class SlickGrid\r\n     * @constructor\r\n     * @param {Node}              container   Container node to create the grid in.\r\n     * @param {Array,Object}      data        An array of objects for databinding.\r\n     * @param {Array}             columns     An array of column definitions.\r\n     * @param {Object}            options     Grid options.\r\n     **/\r\n    function SlickGrid(container, data, columns, options) {\r\n        // settings\r\n        var defaults = {\r\n            explicitInitialization: false,\r\n            rowHeight: 25,\r\n            defaultColumnWidth: 80,\r\n            enableAddRow: false,\r\n            leaveSpaceForNewRows: false,\r\n            editable: false,\r\n            autoEdit: true,\r\n            enableCellNavigation: true,\r\n            enableColumnReorder: true,\r\n            asyncEditorLoading: false,\r\n            asyncEditorLoadDelay: 100,\r\n            forceFitColumns: false,\r\n            enableAsyncPostRender: true,\r\n            asyncPostRenderDelay: 60,\r\n            autoHeight: false,\r\n            editorLock: Slick.GlobalEditorLock,\r\n            showHeaderRow: false,\r\n            headerRowHeight: 25,\r\n            showTopPanel: false,\r\n            topPanelHeight: 25,\r\n            formatterFactory: null,\r\n            editorFactory: null,\r\n            cellFlashingCssClass: \"flashing\",\r\n            selectedCellCssClass: \"selected\",\r\n            multiSelect: true,\r\n            enableTextSelectionOnCells: false,\r\n            dataItemColumnValueExtractor: null,\r\n            fullWidthRows: false,\r\n            multiColumnSort: false,\r\n            defaultFormatter: defaultFormatter,\r\n            wideString: false\r\n        };\r\n\r\n        var columnDefaults = {\r\n            name: \"\",\r\n            resizable: true,\r\n            sortable: false,\r\n            minWidth: 30,\r\n            rerenderOnResize: false,\r\n            headerCssClass: null\r\n        };\r\n\r\n        // scroller\r\n        var th;   // virtual height\r\n        var h;    // real scrollable height\r\n        var ph;   // page height\r\n        var n;    // number of pages\r\n        var cj;   // \"jumpiness\" coefficient\r\n\r\n        var page = 0;       // current page\r\n        var offset = 0;     // current page offset\r\n        var scrollDir = 1;\r\n\r\n        // private\r\n        var initialized = false;\r\n        var $container;\r\n        var uid = \"slickgrid_\" + Math.round(1000000 * Math.random());\r\n        var self = this;\r\n        var $headerScroller;\r\n        var $headers;\r\n        var $headerRow, $headerRowScroller;\r\n        var $topPanelScroller;\r\n        var $topPanel;\r\n        var $viewport;\r\n        var $canvas;\r\n        var $style;\r\n        var stylesheet, columnCssRulesL, columnCssRulesR;\r\n        var viewportH, viewportW;\r\n        var canvasWidth;\r\n        var viewportHasHScroll, viewportHasVScroll;\r\n        var headerColumnWidthDiff = 0, headerColumnHeightDiff = 0, // border+padding\r\n            cellWidthDiff = 0, cellHeightDiff = 0;\r\n        var absoluteColumnMinWidth;\r\n        var numberOfRows = 0;\r\n\r\n        var activePosX;\r\n        var activeRow, activeCell;\r\n        var activeCellNode = null;\r\n        var currentEditor = null;\r\n        var serializedEditorValue;\r\n        var editController;\r\n\r\n        var rowsCache = {};\r\n        var renderedRows = 0;\r\n        var numVisibleRows;\r\n        var prevScrollTop = 0;\r\n        var scrollTop = 0;\r\n        var lastRenderedScrollTop = 0;\r\n        var prevScrollLeft = 0;\r\n        var avgRowRenderTime = 10;\r\n\r\n        var selectionModel;\r\n        var selectedRows = [];\r\n\r\n        var plugins = [];\r\n        var cellCssClasses = {};\r\n\r\n        var columnsById = {};\r\n        var sortColumns = [];\r\n\r\n\r\n        // async call handles\r\n        var h_editorLoader = null;\r\n        var h_render = null;\r\n        var h_postrender = null;\r\n        var postProcessedRows = {};\r\n        var postProcessToRow = null;\r\n        var postProcessFromRow = null;\r\n\r\n        // perf counters\r\n        var counter_rows_rendered = 0;\r\n        var counter_rows_removed = 0;\r\n\r\n\r\n        //////////////////////////////////////////////////////////////////////////////////////////////\r\n        // Initialization\r\n\r\n        function init() {\r\n            $container = $(container);\r\n            if ($container.length < 1) {\r\n                throw new Error(\"SlickGrid requires a valid container, \" + container + \" does not exist in the DOM.\");\r\n            }\r\n\r\n            // calculate these only once and share between grid instances\r\n            maxSupportedCssHeight = maxSupportedCssHeight || getMaxSupportedCssHeight();\r\n            scrollbarDimensions = scrollbarDimensions || measureScrollbar();\r\n\r\n            options = $.extend({}, defaults, options);\r\n            columnDefaults.width = options.defaultColumnWidth;\r\n\r\n            // validate loaded JavaScript modules against requested options\r\n            if (options.enableColumnReorder && !$.fn.sortable) {\r\n                throw new Error(\"SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded\");\r\n            }\r\n\r\n            editController = {\r\n                \"commitCurrentEdit\": commitCurrentEdit,\r\n                \"cancelCurrentEdit\": cancelCurrentEdit\r\n            };\r\n\r\n            $container\r\n                .empty()\r\n                .attr(\"tabIndex\", 0)\r\n                .attr(\"hideFocus\", true)\r\n                .css(\"overflow\", \"hidden\")\r\n                .css(\"outline\", 0)\r\n                .addClass(uid)\r\n                .addClass(\"ui-widget\");\r\n\r\n            // set up a positioning container if needed\r\n            if (!/relative|absolute|fixed/.test($container.css(\"position\"))) {\r\n                $container.css(\"position\", \"relative\");\r\n            }\r\n\r\n            $headerScroller = $(\"<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />\").appendTo($container);\r\n            //$headers = $(\"<div class='slick-header-columns' style='width:10000px; left:-1000px' />\").appendTo($headerScroller);\r\n            $headers = $(\"<div class='slick-header-columns' />\").appendTo($headerScroller);\r\n\r\n            $headerRowScroller = $(\"<div class='slick-headerrow ui-state-default' style='overflow:hidden;position:relative;' />\").appendTo($container);\r\n            $headerRow = $(\"<div class='slick-headerrow-columns' />\").appendTo($headerRowScroller);\r\n\r\n            $topPanelScroller = $(\"<div class='slick-top-panel-scroller ui-state-default' style='overflow:hidden;position:relative;' />\").appendTo($container);\r\n            //$topPanel = $(\"<div class='slick-top-panel' style='width:10000px' />\").appendTo($topPanelScroller);\r\n            $topPanel = $(\"<div class='slick-top-panel' />\").appendTo($topPanelScroller);\r\n\r\n            if (!options.showTopPanel) {\r\n                $topPanelScroller.hide();\r\n            }\r\n\r\n            if (!options.showHeaderRow) {\r\n                $headerRowScroller.hide();\r\n            }\r\n\r\n            $viewport = $(\"<div class='slick-viewport' tabIndex='0' hideFocus style='width:100%;overflow:auto;outline:0;position:relative;;'>\").appendTo($container);\r\n            $viewport.css(\"overflow-y\", options.autoHeight ? \"hidden\" : \"auto\");\r\n\r\n            $canvas = $(\"<div class='grid-canvas' tabIndex='0' hideFocus />\").appendTo($viewport);\r\n\r\n            measureHeights();\r\n            if (!options.explicitInitialization) {\r\n                finishInitialization();\r\n            }\r\n        }\r\n\r\n        function finishInitialization() {\r\n            if (!initialized) {\r\n                initialized = true;\r\n\r\n                viewportW = parseFloat($.css($container[0], \"width\", true));\r\n\r\n                // header columns and cells may have different padding/border skewing width calculations (box-sizing, hello?)\r\n                // calculate the diff so we can set consistent sizes\r\n                measureCellPaddingAndBorder();\r\n\r\n                // for usability reasons, all text selection in SlickGrid is disabled\r\n                // with the exception of input and textarea elements (selection must\r\n                // be enabled there so that editors work as expected); note that\r\n                // selection in grid cells (grid body) is already unavailable in\r\n                // all browsers except IE\r\n                disableSelection($headers); // disable all text selection in header (including input and textarea)\r\n\r\n                if (!options.enableTextSelectionOnCells) {\r\n                    // disable text selection in grid cells except in input and textarea elements\r\n                    // (this is IE-specific, because selectstart event will only fire in IE)\r\n                    $viewport.bind(\"selectstart.ui\", function (event) {\r\n                        return $(event.target).is(\"input,textarea\");\r\n                    });\r\n                }\r\n\r\n                createColumnHeaders();\r\n                setupColumnSort();\r\n                createCssRules();\r\n                resizeCanvas();\r\n                bindAncestorScrollEvents();\r\n\r\n                $container\r\n                    .bind(\"resize.slickgrid\", resizeCanvas);\r\n                $viewport\r\n                    .bind(\"scroll.slickgrid\", handleScroll);\r\n                $headerScroller\r\n                    .bind(\"contextmenu.slickgrid\", handleHeaderContextMenu)\r\n                    .bind(\"click.slickgrid\", handleHeaderClick);\r\n                $canvas\r\n                    .bind(\"keydown.slickgrid\", handleKeyDown)\r\n                    .bind(\"click.slickgrid\", handleClick)\r\n                    .bind(\"dblclick.slickgrid\", handleDblClick)\r\n                    .bind(\"contextmenu.slickgrid\", handleContextMenu)\r\n                    .bind(\"draginit\", handleDragInit)\r\n                    .bind(\"dragstart\", handleDragStart)\r\n                    .bind(\"drag\", handleDrag)\r\n                    .bind(\"dragend\", handleDragEnd)\r\n                    .delegate(\".slick-cell\", \"mouseenter\", handleMouseEnter)\r\n                    .delegate(\".slick-cell\", \"mouseleave\", handleMouseLeave);\r\n            }\r\n        }\r\n\r\n        function registerPlugin(plugin) {\r\n            plugins.unshift(plugin);\r\n            plugin.init(self);\r\n        }\r\n\r\n        function unregisterPlugin(plugin) {\r\n            for (var i = plugins.length; i >= 0; i--) {\r\n                if (plugins[i] === plugin) {\r\n                    if (plugins[i].destroy) {\r\n                        plugins[i].destroy();\r\n                    }\r\n                    plugins.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        function setSelectionModel(model) {\r\n            if (selectionModel) {\r\n                selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged);\r\n                if (selectionModel.destroy) {\r\n                    selectionModel.destroy();\r\n                }\r\n            }\r\n\r\n            selectionModel = model;\r\n            if (selectionModel) {\r\n                selectionModel.init(self);\r\n                selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged);\r\n            }\r\n        }\r\n\r\n        function getSelectionModel() {\r\n            return selectionModel;\r\n        }\r\n\r\n        function getCanvasNode() {\r\n            return $canvas[0];\r\n        }\r\n\r\n        function measureScrollbar() {\r\n            var $c = $(\"<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>\").appendTo(\"body\");\r\n            var dim = {\r\n                width: $c.width() - $c[0].clientWidth,\r\n                height: $c.height() - $c[0].clientHeight\r\n            };\r\n            $c.remove();\r\n            return dim;\r\n        }\r\n\r\n        function getCanvasWidth() {\r\n            var availableWidth = viewportHasVScroll ? viewportW - scrollbarDimensions.width : viewportW;\r\n            var rowWidth = 0;\r\n            var i = columns.length;\r\n            while (i--) {\r\n                rowWidth += (columns[i].width || columnDefaults.width);\r\n            }\r\n            return options.fullWidthRows ? Math.max(rowWidth, availableWidth) : rowWidth;\r\n        }\r\n\r\n        function updateCanvasWidth(forceColumnWidthsUpdate) {\r\n            var oldCanvasWidth = canvasWidth;\r\n            canvasWidth = getCanvasWidth();\r\n\r\n            if (canvasWidth != oldCanvasWidth) {\r\n                $canvas.width(canvasWidth);\r\n                $headerRow.width(canvasWidth);\r\n                viewportHasHScroll = (canvasWidth > viewportW - scrollbarDimensions.width);\r\n            }\r\n\r\n            if (canvasWidth != oldCanvasWidth || forceColumnWidthsUpdate) {\r\n                $('.slick-header-columns').width(canvasWidth);\r\n                applyColumnWidths();\r\n            }\r\n        }\r\n\r\n        function disableSelection($target) {\r\n            if ($target && $target.jquery) {\r\n                $target\r\n                    .attr(\"unselectable\", \"on\")\r\n                    .css(\"MozUserSelect\", \"none\")\r\n                    .bind(\"selectstart.ui\", function () {\r\n                        return false;\r\n                    }); // from jquery:ui.core.js 1.7.2\r\n            }\r\n        }\r\n\r\n        function getMaxSupportedCssHeight() {\r\n            var increment = 1000000;\r\n            var supportedHeight = increment;\r\n            // FF reports the height back but still renders blank after ~6M px\r\n            var testUpTo = navigator.userAgent.toLowerCase().match(/firefox/) ? 6000000 : 1000000000;\r\n            var div = $(\"<div style='display:none' />\").appendTo(document.body);\r\n\r\n            while (supportedHeight <= testUpTo) {\r\n                div.css(\"height\", supportedHeight + increment);\r\n                if (div.height() !== supportedHeight + increment) {\r\n                    break;\r\n                } else {\r\n                    supportedHeight += increment;\r\n                }\r\n            }\r\n\r\n            div.remove();\r\n            return supportedHeight;\r\n        }\r\n\r\n        // TODO:  this is static.  need to handle page mutation.\r\n        function bindAncestorScrollEvents() {\r\n            var elem = $canvas[0];\r\n            while ((elem = elem.parentNode) != document.body && elem != null) {\r\n                // bind to scroll containers only\r\n                if (elem == $viewport[0] || elem.scrollWidth != elem.clientWidth || elem.scrollHeight != elem.clientHeight) {\r\n                    $(elem).bind(\"scroll.slickgrid\", handleActiveCellPositionChange);\r\n                }\r\n            }\r\n        }\r\n\r\n        function unbindAncestorScrollEvents() {\r\n            $canvas.parents().unbind(\"scroll.slickgrid\");\r\n        }\r\n\r\n        function updateColumnHeader(columnId, title, toolTip) {\r\n            if (!initialized) { return; }\r\n            var idx = getColumnIndex(columnId);\r\n            var $header = $headers.children().eq(idx);\r\n            if ($header) {\r\n                columns[idx].name = title;\r\n                columns[idx].toolTip = toolTip;\r\n                $header\r\n                    .attr(\"title\", toolTip || title || \"\")\r\n                    .children().eq(0).html(title);\r\n            }\r\n        }\r\n\r\n        function getHeaderRow() {\r\n            return $headerRow[0];\r\n        }\r\n\r\n        function getHeaderRowColumn(columnId) {\r\n            var idx = getColumnIndex(columnId);\r\n            var $header = $headerRow.children().eq(idx);\r\n            return $header && $header[0];\r\n        }\r\n\r\n        function createColumnHeaders() {\r\n            function hoverBegin() {\r\n                $(this).addClass(\"ui-state-hover\");\r\n            }\r\n\r\n            function hoverEnd() {\r\n                $(this).removeClass(\"ui-state-hover\");\r\n            }\r\n\r\n            $headers.empty();\r\n            $headerRow.empty();\r\n            columnsById = {};\r\n\r\n            for (var i = 0; i < columns.length; i++) {\r\n                var m = columns[i] = $.extend({}, columnDefaults, columns[i]);\r\n                columnsById[m.id] = i;\r\n\r\n                var header = $(\"<div class='ui-state-default slick-header-column' id='\" + uid + m.id + \"' />\")\r\n                    .html(\"<span class='slick-column-name'>\" + m.name + \"</span>\")\r\n                    .width(m.width - headerColumnWidthDiff)\r\n                    .attr(\"title\", m.toolTip || m.name || \"\")\r\n                    .data(\"fieldId\", m.id)\r\n                    .addClass(m.headerCssClass || \"\")\r\n                    .appendTo($headers);\r\n\r\n                if (options.enableColumnReorder || m.sortable) {\r\n                    header.hover(hoverBegin, hoverEnd);\r\n                }\r\n\r\n                if (m.sortable) {\r\n                    header.append(\"<span class='slick-sort-indicator' />\");\r\n                }\r\n\r\n                if (options.showHeaderRow) {\r\n                    $(\"<div class='ui-state-default slick-headerrow-column l\" + i + \" r\" + i + \"'></div>\")\r\n                        .appendTo($headerRow);\r\n                }\r\n            }\r\n\r\n            if (options.showHeaderRow) {\r\n                // add a spacer to let the container scroll beyond the header row columns width\r\n                //$(\"<div style='display:block;height:1px;width:10000px;position:absolute;top:0;left:0;'></div>\")\r\n                $(\"<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>\")\r\n                    .appendTo($headerRowScroller);\r\n            }\r\n\r\n            setSortColumns(sortColumns);\r\n            setupColumnResize();\r\n            if (options.enableColumnReorder) {\r\n                setupColumnReorder();\r\n            }\r\n        }\r\n\r\n        function setupColumnSort() {\r\n            $headers.click(function (e) {\r\n                // temporary workaround for a bug in jQuery 1.7.1 (http://bugs.jquery.com/ticket/11328)\r\n                e.metaKey = e.metaKey || e.ctrlKey;\r\n\r\n                if ($(e.target).hasClass(\"slick-resizable-handle\")) {\r\n                    return;\r\n                }\r\n\r\n                var $col = $(e.target).closest(\".slick-header-column\");\r\n                if (!$col.length) {\r\n                    return;\r\n                }\r\n\r\n                var column = columns[getColumnIndex($col.data(\"fieldId\"))];\r\n                if (column.sortable) {\r\n                    if (!getEditorLock().commitCurrentEdit()) {\r\n                        return;\r\n                    }\r\n\r\n                    var sortOpts = null;\r\n                    var i = 0;\r\n                    for (; i < sortColumns.length; i++) {\r\n                        if (sortColumns[i].columnId == column.id) {\r\n                            sortOpts = sortColumns[i];\r\n                            sortOpts.sortAsc = !sortOpts.sortAsc;\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    if (e.metaKey && options.multiColumnSort) {\r\n                        if (sortOpts) {\r\n                            sortColumns.splice(i, 1);\r\n                        }\r\n                    }\r\n                    else {\r\n                        if ((!e.shiftKey && !e.metaKey) || !options.multiColumnSort) {\r\n                            sortColumns = [];\r\n                        }\r\n\r\n                        if (!sortOpts) {\r\n                            sortOpts = { columnId: column.id, sortAsc: true };\r\n                            sortColumns.push(sortOpts);\r\n                        } else if (sortColumns.length == 0) {\r\n                            sortColumns.push(sortOpts);\r\n                        }\r\n                    }\r\n\r\n                    setSortColumns(sortColumns);\r\n\r\n                    if (!options.multiColumnSort) {\r\n                        trigger(self.onSort, {\r\n                            multiColumnSort: false,\r\n                            sortCol: column,\r\n                            sortAsc: sortOpts.sortAsc}, e);\r\n                    } else {\r\n                      trigger(self.onSort, {\r\n                        multiColumnSort: true,\r\n                        sortCols: $.map(sortColumns, function(col) {\r\n                          return {sortCol: columns[getColumnIndex(col.columnId)], sortAsc: col.sortAsc };\r\n                        })}, e);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        function setupColumnReorder() {\r\n            $headers.sortable({\r\n                containment: \"parent\",\r\n                axis: \"x\",\r\n                cursor: \"default\",\r\n                tolerance: \"intersection\",\r\n                helper: \"clone\",\r\n                placeholder: \"slick-sortable-placeholder ui-state-default slick-header-column\",\r\n                forcePlaceholderSize: true,\r\n                start: function (e, ui) {\r\n                    $(ui.helper).addClass(\"slick-header-column-active\");\r\n                },\r\n                beforeStop: function (e, ui) {\r\n                    $(ui.helper).removeClass(\"slick-header-column-active\");\r\n                },\r\n                stop: function (e) {\r\n                    if (!getEditorLock().commitCurrentEdit()) {\r\n                        $(this).sortable(\"cancel\");\r\n                        return;\r\n                    }\r\n\r\n                    var reorderedIds = $headers.sortable(\"toArray\");\r\n                    var reorderedColumns = [];\r\n                    for (var i = 0; i < reorderedIds.length; i++) {\r\n                        reorderedColumns.push(columns[getColumnIndex(reorderedIds[i].replace(uid, \"\"))]);\r\n                    }\r\n                    setColumns(reorderedColumns);\r\n\r\n                    trigger(self.onColumnsReordered, {});\r\n                    e.stopPropagation();\r\n                    setupColumnResize();\r\n                }\r\n            });\r\n        }\r\n\r\n        function setupColumnResize() {\r\n            var $col, j, c, pageX, columnElements, minPageX, maxPageX, firstResizable, lastResizable;\r\n            columnElements = $headers.children();\r\n            columnElements.find(\".slick-resizable-handle\").remove();\r\n            columnElements.each(function (i, e) {\r\n                if (columns[i].resizable) {\r\n                    if (firstResizable === undefined) {\r\n                        firstResizable = i;\r\n                    }\r\n                    lastResizable = i;\r\n                }\r\n            });\r\n            if (firstResizable === undefined) {\r\n                return;\r\n            }\r\n            columnElements.each(function (i, e) {\r\n                if (i < firstResizable || (options.forceFitColumns && i >= lastResizable)) {\r\n                    return;\r\n                }\r\n                $col = $(e);\r\n                $(\"<div class='slick-resizable-handle' />\")\r\n                    .appendTo(e)\r\n                    .bind(\"dragstart\", function (e, dd) {\r\n                        if (!getEditorLock().commitCurrentEdit()) {\r\n                            return false;\r\n                        }\r\n                        pageX = e.pageX;\r\n                        $(this).parent().addClass(\"slick-header-column-active\");\r\n                        var shrinkLeewayOnRight = null, stretchLeewayOnRight = null;\r\n                        // lock each column's width option to current width\r\n                        columnElements.each(function (i, e) {\r\n                            columns[i].previousWidth = $(e).outerWidth();\r\n                        });\r\n                        if (options.forceFitColumns) {\r\n                            shrinkLeewayOnRight = 0;\r\n                            stretchLeewayOnRight = 0;\r\n                            // colums on right affect maxPageX/minPageX\r\n                            for (j = i + 1; j < columnElements.length; j++) {\r\n                                c = columns[j];\r\n                                if (c.resizable) {\r\n                                    if (stretchLeewayOnRight !== null) {\r\n                                        if (c.maxWidth) {\r\n                                            stretchLeewayOnRight += c.maxWidth - c.previousWidth;\r\n                                        } else {\r\n                                            stretchLeewayOnRight = null;\r\n                                        }\r\n                                    }\r\n                                    shrinkLeewayOnRight += c.previousWidth - Math.max(c.minWidth || 0, absoluteColumnMinWidth);\r\n                                }\r\n                            }\r\n                        }\r\n                        var shrinkLeewayOnLeft = 0, stretchLeewayOnLeft = 0;\r\n                        for (j = 0; j <= i; j++) {\r\n                            // columns on left only affect minPageX\r\n                            c = columns[j];\r\n                            if (c.resizable) {\r\n                                if (stretchLeewayOnLeft !== null) {\r\n                                    if (c.maxWidth) {\r\n                                        stretchLeewayOnLeft += c.maxWidth - c.previousWidth;\r\n                                    } else {\r\n                                        stretchLeewayOnLeft = null;\r\n                                    }\r\n                                }\r\n                                shrinkLeewayOnLeft += c.previousWidth - Math.max(c.minWidth || 0, absoluteColumnMinWidth);\r\n                            }\r\n                        }\r\n                        if (shrinkLeewayOnRight === null) {\r\n                            shrinkLeewayOnRight = 100000;\r\n                        }\r\n                        if (shrinkLeewayOnLeft === null) {\r\n                            shrinkLeewayOnLeft = 100000;\r\n                        }\r\n                        if (stretchLeewayOnRight === null) {\r\n                            stretchLeewayOnRight = 100000;\r\n                        }\r\n                        if (stretchLeewayOnLeft === null) {\r\n                            stretchLeewayOnLeft = 100000;\r\n                        }\r\n                        maxPageX = pageX + Math.min(shrinkLeewayOnRight, stretchLeewayOnLeft);\r\n                        minPageX = pageX - Math.min(shrinkLeewayOnLeft, stretchLeewayOnRight);\r\n                    })\r\n                    .bind(\"drag\", function (e, dd) {\r\n                        var actualMinWidth, d = Math.min(maxPageX, Math.max(minPageX, e.pageX)) - pageX, x;\r\n                        if (d < 0) { // shrink column\r\n                            x = d;\r\n                            for (j = i; j >= 0; j--) {\r\n                                c = columns[j];\r\n                                if (c.resizable) {\r\n                                    actualMinWidth = Math.max(c.minWidth || 0, absoluteColumnMinWidth);\r\n                                    if (x && c.previousWidth + x < actualMinWidth) {\r\n                                        x += c.previousWidth - actualMinWidth;\r\n                                        c.width = actualMinWidth;\r\n                                    } else {\r\n                                        c.width = c.previousWidth + x;\r\n                                        x = 0;\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            if (options.forceFitColumns) {\r\n                                x = -d;\r\n                                for (j = i + 1; j < columnElements.length; j++) {\r\n                                    c = columns[j];\r\n                                    if (c.resizable) {\r\n                                        if (x && c.maxWidth && (c.maxWidth - c.previousWidth < x)) {\r\n                                            x -= c.maxWidth - c.previousWidth;\r\n                                            c.width = c.maxWidth;\r\n                                        } else {\r\n                                            c.width = c.previousWidth + x;\r\n                                            x = 0;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        } else { // stretch column\r\n                            x = d;\r\n                            for (j = i; j >= 0; j--) {\r\n                                c = columns[j];\r\n                                if (c.resizable) {\r\n                                    if (x && c.maxWidth && (c.maxWidth - c.previousWidth < x)) {\r\n                                        x -= c.maxWidth - c.previousWidth;\r\n                                        c.width = c.maxWidth;\r\n                                    } else {\r\n                                        c.width = c.previousWidth + x;\r\n                                        x = 0;\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            if (options.forceFitColumns) {\r\n                                x = -d;\r\n                                for (j = i + 1; j < columnElements.length; j++) {\r\n                                    c = columns[j];\r\n                                    if (c.resizable) {\r\n                                        actualMinWidth = Math.max(c.minWidth || 0, absoluteColumnMinWidth);\r\n                                        if (x && c.previousWidth + x < actualMinWidth) {\r\n                                            x += c.previousWidth - actualMinWidth;\r\n                                            c.width = actualMinWidth;\r\n                                        } else {\r\n                                            c.width = c.previousWidth + x;\r\n                                            x = 0;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        applyColumnHeaderWidths();\r\n                        if (options.syncColumnCellResize) {\r\n                            applyColumnWidths();\r\n                        }\r\n\t\t\t\t\t\tupdateCanvasWidth(true);\r\n                    })\r\n                    .bind(\"dragend\", function (e, dd) {\r\n                        var newWidth;\r\n                        $(this).parent().removeClass(\"slick-header-column-active\");\r\n                        for (j = 0; j < columnElements.length; j++) {\r\n                            c = columns[j];\r\n                            newWidth = $(columnElements[j]).outerWidth();\r\n\r\n                            if (c.previousWidth !== newWidth && c.rerenderOnResize) {\r\n                                invalidateAllRows();\r\n                            }\r\n                        }\r\n                        hGen++;\r\n                        updateCanvasWidth(true);\r\n                        measureHeights();\r\n                        updateRowPositions();\r\n                        invalidateAllRows();\r\n                        render();\r\n                        trigger(self.onColumnsResized, {});\r\n                    });\r\n            });\r\n        }\r\n\r\n        function getVBoxDelta($el) {\r\n            var p = [\"borderTopWidth\", \"borderBottomWidth\", \"paddingTop\", \"paddingBottom\"];\r\n            var delta = 0;\r\n            $.each(p, function (n, val) {\r\n                delta += parseFloat($el.css(val)) || 0;\r\n            });\r\n            return delta;\r\n        }\r\n\r\n        function measureCellPaddingAndBorder() {\r\n            var el;\r\n            var h = [\"borderLeftWidth\", \"borderRightWidth\", \"paddingLeft\", \"paddingRight\"];\r\n            var v = [\"borderTopWidth\", \"borderBottomWidth\", \"paddingTop\", \"paddingBottom\"];\r\n\r\n            el = $(\"<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>\").appendTo($headers);\r\n            headerColumnWidthDiff = headerColumnHeightDiff = 0;\r\n            $.each(h, function (n, val) {\r\n                headerColumnWidthDiff += parseFloat(el.css(val)) || 0;\r\n            });\r\n            $.each(v, function (n, val) {\r\n                headerColumnHeightDiff += parseFloat(el.css(val)) || 0;\r\n            });\r\n            el.remove();\r\n\r\n            var r = $(\"<div class='slick-row' />\").appendTo($canvas);\r\n            el = $(\"<div class='slick-cell' id='' style='visibility:hidden'>-</div>\").appendTo(r);\r\n            cellWidthDiff = cellHeightDiff = 0;\r\n            $.each(h, function (n, val) {\r\n                cellWidthDiff += parseFloat(el.css(val)) || 0;\r\n            });\r\n            $.each(v, function (n, val) {\r\n                cellHeightDiff += parseFloat(el.css(val)) || 0;\r\n            });\r\n            r.remove();\r\n\r\n            absoluteColumnMinWidth = Math.max(headerColumnWidthDiff, cellWidthDiff);\r\n        }\r\n\r\n        function createCssRules() {\r\n            $style = $(\"<style type='text/css' rel='stylesheet' />\").appendTo($(\"head\"));\r\n            var rowHeight = (options.rowHeight - cellHeightDiff);\r\n            var rules = [\r\n              //\".\" + uid + \" .slick-header-column { left: 1000px; }\",\r\n              \".\" + uid + \" .slick-header-column {  }\",\r\n              \".\" + uid + \" .slick-top-panel { height:\" + options.topPanelHeight + \"px; }\",\r\n              \".\" + uid + \" .slick-headerrow-columns { height:\" + options.headerRowHeight + \"px; }\",\r\n              \".\" + uid + \" .slick-cell { height:\" + (rowHeight - 1) + \"px; }\",\r\n              \".\" + uid + \" .slick-row { height:\" + options.rowHeight + \"px; }\"\r\n            ];\r\n\r\n            for (var i = 0; i < columns.length; i++) {\r\n                rules.push(\".\" + uid + \" .l\" + i + \" { }\");\r\n                rules.push(\".\" + uid + \" .r\" + i + \" { }\");\r\n            }\r\n\r\n            if ($style[0].styleSheet) { // IE\r\n                $style[0].styleSheet.cssText = rules.join(\" \");\r\n            } else {\r\n                $style[0].appendChild(document.createTextNode(rules.join(\" \")));\r\n            }\r\n        }\r\n\r\n        function getColumnCssRules(idx) {\r\n            if (!stylesheet) {\r\n                var sheets = document.styleSheets;\r\n                for (var i = 0; i < sheets.length; i++) {\r\n                    if ((sheets[i].ownerNode || sheets[i].owningElement) == $style[0]) {\r\n                        stylesheet = sheets[i];\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (!stylesheet) {\r\n                    throw new Error(\"Cannot find stylesheet.\");\r\n                }\r\n\r\n                // find and cache column CSS rules\r\n                columnCssRulesL = [];\r\n                columnCssRulesR = [];\r\n                var cssRules = (stylesheet.cssRules || stylesheet.rules);\r\n                var matches, columnIdx;\r\n                for (var i = 0; i < cssRules.length; i++) {\r\n                    var selector = cssRules[i].selectorText;\r\n                    if (matches = /\\.l\\d+/.exec(selector)) {\r\n                        columnIdx = parseInt(matches[0].substr(2, matches[0].length - 2), 10);\r\n                        columnCssRulesL[columnIdx] = cssRules[i];\r\n                    } else if (matches = /\\.r\\d+/.exec(selector)) {\r\n                        columnIdx = parseInt(matches[0].substr(2, matches[0].length - 2), 10);\r\n                        columnCssRulesR[columnIdx] = cssRules[i];\r\n                    }\r\n                }\r\n            }\r\n\r\n            return {\r\n                \"left\": columnCssRulesL[idx],\r\n                \"right\": columnCssRulesR[idx]\r\n            };\r\n        }\r\n\r\n        function removeCssRules() {\r\n            $style.remove();\r\n            stylesheet = null;\r\n        }\r\n\r\n        function destroy() {\r\n            getEditorLock().cancelCurrentEdit();\r\n\r\n            trigger(self.onBeforeDestroy, {});\r\n\r\n            for (var i = 0; i < plugins.length; i++) {\r\n                unregisterPlugin(plugins[i]);\r\n            }\r\n\r\n            if (options.enableColumnReorder && $headers.sortable) {\r\n                $headers.sortable(\"destroy\");\r\n            }\r\n\r\n            unbindAncestorScrollEvents();\r\n            $container.unbind(\".slickgrid\");\r\n            removeCssRules();\r\n\r\n            $canvas.unbind(\"draginit dragstart dragend drag\");\r\n            $container.empty().removeClass(uid);\r\n        }\r\n\r\n\r\n        //////////////////////////////////////////////////////////////////////////////////////////////\r\n        // General\r\n\r\n        function trigger(evt, args, e) {\r\n            e = e || new Slick.EventData();\r\n            args = args || {};\r\n            args.grid = self;\r\n            return evt.notify(args, e, self);\r\n        }\r\n\r\n        function getEditorLock() {\r\n            return options.editorLock;\r\n        }\r\n\r\n        function getEditController() {\r\n            return editController;\r\n        }\r\n\r\n        function getColumnIndex(id) {\r\n            return columnsById[id];\r\n        }\r\n\r\n        function autosizeColumns() {\r\n            var i, c,\r\n                widths = [],\r\n                shrinkLeeway = 0,\r\n                total = 0,\r\n                prevTotal,\r\n                availWidth = viewportHasVScroll ? viewportW - scrollbarDimensions.width : viewportW;\r\n\r\n            for (i = 0; i < columns.length; i++) {\r\n                c = columns[i];\r\n                widths.push(c.width);\r\n                total += c.width;\r\n                if (c.resizable) {\r\n                    shrinkLeeway += c.width - Math.max(c.minWidth, absoluteColumnMinWidth);\r\n                }\r\n            }\r\n\r\n            // shrink\r\n            prevTotal = total;\r\n            while (total > availWidth && shrinkLeeway) {\r\n                var shrinkProportion = (total - availWidth) / shrinkLeeway;\r\n                for (i = 0; i < columns.length && total > availWidth; i++) {\r\n                    c = columns[i];\r\n                    var width = widths[i];\r\n                    if (!c.resizable || width <= c.minWidth || width <= absoluteColumnMinWidth) {\r\n                        continue;\r\n                    }\r\n                    var absMinWidth = Math.max(c.minWidth, absoluteColumnMinWidth);\r\n                    var shrinkSize = Math.floor(shrinkProportion * (width - absMinWidth)) || 1;\r\n                    shrinkSize = Math.min(shrinkSize, width - absMinWidth);\r\n                    total -= shrinkSize;\r\n                    shrinkLeeway -= shrinkSize;\r\n                    widths[i] -= shrinkSize;\r\n                }\r\n                if (prevTotal == total) {  // avoid infinite loop\r\n                    break;\r\n                }\r\n                prevTotal = total;\r\n            }\r\n\r\n            // grow\r\n            prevTotal = total;\r\n            while (total < availWidth) {\r\n                var growProportion = availWidth / total;\r\n                for (i = 0; i < columns.length && total < availWidth; i++) {\r\n                    c = columns[i];\r\n                    if (!c.resizable || c.maxWidth <= c.width) {\r\n                        continue;\r\n                    }\r\n                    var growSize = Math.min(Math.floor(growProportion * c.width) - c.width, (c.maxWidth - c.width) || 1000000) || 1;\r\n                    total += growSize;\r\n                    widths[i] += growSize;\r\n                }\r\n                if (prevTotal == total) {  // avoid infinite loop\r\n                    break;\r\n                }\r\n                prevTotal = total;\r\n            }\r\n\r\n            var reRender = false;\r\n            for (i = 0; i < columns.length; i++) {\r\n                if (columns[i].rerenderOnResize && columns[i].width != widths[i]) {\r\n                    reRender = true;\r\n                }\r\n                columns[i].width = widths[i];\r\n            }\r\n\r\n            applyColumnHeaderWidths();\r\n            updateCanvasWidth(true);\r\n            if (reRender) {\r\n                invalidateAllRows();\r\n                render();\r\n            }\r\n        }\r\n\r\n        function applyColumnHeaderWidths() {\r\n            if (!initialized) { return; }\r\n            var h;\r\n            for (var i = 0, headers = $headers.children(), ii = headers.length; i < ii; i++) {\r\n                h = $(headers[i]);\r\n                if (h.width() !== columns[i].width - headerColumnWidthDiff) {\r\n                    h.width(columns[i].width - headerColumnWidthDiff);\r\n                }\r\n            }\r\n        }\r\n\r\n        function applyColumnWidths() {\r\n            var x = 0, w, rule;\r\n            for (var i = 0; i < columns.length; i++) {\r\n                w = columns[i].width;\r\n\r\n                rule = getColumnCssRules(i);\r\n                rule.left.style.left = x + \"px\";\r\n                rule.right.style.right = (canvasWidth - x - w) + \"px\";\r\n\r\n                x += columns[i].width;\r\n            }\r\n        }\r\n\r\n        function setSortColumn(columnId, ascending) {\r\n            setSortColumns([{ columnId: columnId, sortAsc: ascending}]);\r\n        }\r\n\r\n        function setSortColumns(cols) {\r\n            sortColumns = cols;\r\n\r\n            var headerColumnEls = $headers.children();\r\n            headerColumnEls\r\n                .removeClass(\"slick-header-column-sorted\")\r\n                .find(\".slick-sort-indicator\")\r\n                    .removeClass(\"slick-sort-indicator-asc slick-sort-indicator-desc\");\r\n\r\n            $.each(sortColumns, function(i, col) {\r\n                if (col.sortAsc == null) {\r\n                    col.sortAsc = true;\r\n                }\r\n                var columnIndex = getColumnIndex(col.columnId);\r\n                if (columnIndex != null) {\r\n                    headerColumnEls.eq(columnIndex)\r\n                        .addClass(\"slick-header-column-sorted\")\r\n                        .find(\".slick-sort-indicator\")\r\n                            .addClass(col.sortAsc ? \"slick-sort-indicator-asc\" : \"slick-sort-indicator-desc\");\r\n                }\r\n            });\r\n        }\r\n\r\n        function getSortColumns() {\r\n            return sortColumns;\r\n        }\r\n\r\n        function handleSelectedRangesChanged(e, ranges) {\r\n            selectedRows = [];\r\n            var hash = {};\r\n            for (var i = 0; i < ranges.length; i++) {\r\n                for (var j = ranges[i].fromRow; j <= ranges[i].toRow; j++) {\r\n                    if (!hash[j]) {  // prevent duplicates\r\n                        selectedRows.push(j);\r\n                    }\r\n                    hash[j] = {};\r\n                    for (var k = ranges[i].fromCell; k <= ranges[i].toCell; k++) {\r\n                        if (canCellBeSelected(j, k)) {\r\n                            hash[j][columns[k].id] = options.selectedCellCssClass;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            setCellCssStyles(options.selectedCellCssClass, hash);\r\n\r\n            trigger(self.onSelectedRowsChanged, {rows: getSelectedRows()}, e);\r\n        }\r\n\r\n        function getColumns() {\r\n            return columns;\r\n        }\r\n\r\n        function setColumns(columnDefinitions) {\r\n            columns = columnDefinitions;\r\n            if (initialized) {\r\n                hGen++;\r\n                invalidateAllRows();\r\n                createColumnHeaders();\r\n                removeCssRules();\r\n                createCssRules();\r\n                resizeCanvas();\r\n                applyColumnWidths();\r\n                handleScroll();\r\n            }\r\n        }\r\n\r\n        function getOptions() {\r\n            return options;\r\n        }\r\n\r\n        function setOptions(args) {\r\n            if (!getEditorLock().commitCurrentEdit()) {\r\n                return;\r\n            }\r\n\r\n            makeActiveCellNormal();\r\n\r\n            if (options.enableAddRow !== args.enableAddRow) {\r\n                invalidateRow(getDataLength());\r\n            }\r\n\r\n            options = $.extend(options, args);\r\n\r\n            $viewport.css(\"overflow-y\", options.autoHeight ? \"hidden\" : \"auto\");\r\n            render();\r\n        }\r\n\r\n        function setData(newData, scrollToTop) {\r\n            invalidateAllRows();\r\n            data = newData;\r\n            if (scrollToTop) {\r\n                scrollTo(0);\r\n            }\r\n        }\r\n\r\n        function getData() {\r\n            return data;\r\n        }\r\n\r\n        function getDataLength() {\r\n            if (data.getLength) {\r\n                return data.getLength();\r\n            } else {\r\n                return data.length;\r\n            }\r\n        }\r\n\r\n        function getDataItem(i) {\r\n            if (data.getItem) {\r\n                return data.getItem(i);\r\n            } else {\r\n                return data[i];\r\n            }\r\n        }\r\n\r\n        function setDataItem(i, value) {\r\n            if (data.setItem) {\r\n                data.setItem(i, value);\r\n            } else {\r\n                data[i] = value;\r\n            }\r\n        }\r\n\r\n        function getTopPanel() {\r\n            return $topPanel[0];\r\n        }\r\n\r\n        function showTopPanel() {\r\n            options.showTopPanel = true;\r\n            $topPanelScroller.slideDown(\"fast\", resizeCanvas);\r\n        }\r\n\r\n        function hideTopPanel() {\r\n            options.showTopPanel = false;\r\n            $topPanelScroller.slideUp(\"fast\", resizeCanvas);\r\n        }\r\n\r\n        function showHeaderRowColumns() {\r\n            options.showHeaderRow = true;\r\n            $headerRowScroller.slideDown(\"fast\", resizeCanvas);\r\n        }\r\n\r\n        function hideHeaderRowColumns() {\r\n            options.showHeaderRow = false;\r\n            $headerRowScroller.slideUp(\"fast\", resizeCanvas);\r\n        }\r\n\r\n        //////////////////////////////////////////////////////////////////////////////////////////////\r\n        // Rendering / Scrolling\r\n\r\n        function scrollTo(y) {\r\n            var oldOffset = offset;\r\n\r\n            page = Math.min(n - 1, Math.floor(y / ph));\r\n            offset = Math.round(page * cj);\r\n            var newScrollTop = y - offset;\r\n\r\n            if (offset != oldOffset) {\r\n                var range = getVisibleRange(newScrollTop);\r\n                cleanupRows(range.top, range.bottom);\r\n                updateRowPositions();\r\n            }\r\n\r\n            if (prevScrollTop != newScrollTop) {\r\n                scrollDir = (prevScrollTop + oldOffset < newScrollTop + offset) ? 1 : -1;\r\n                $viewport[0].scrollTop = (lastRenderedScrollTop = scrollTop = prevScrollTop = newScrollTop);\r\n\r\n                trigger(self.onViewportChanged, {});\r\n            }\r\n        }\r\n        function scrollToRow(row) {\r\n            var y = getHeightsOfRows(0, row + 1);\r\n            var oldOffset = offset;\r\n\r\n            page = Math.min(n - 1, Math.floor(y / ph));\r\n            offset = Math.round(page * cj);\r\n            var newScrollTop = y - offset;\r\n\r\n            if (offset != oldOffset) {\r\n                var range = getVisibleRange(newScrollTop);\r\n                cleanupRows(range.top, range.bottom);\r\n                updateRowPositions();\r\n            }\r\n\r\n            if (prevScrollTop != newScrollTop) {\r\n                scrollDir = (prevScrollTop + oldOffset < newScrollTop + offset) ? 1 : -1;\r\n                $viewport[0].scrollTop = (lastRenderedScrollTop = scrollTop = prevScrollTop = newScrollTop);\r\n\r\n                trigger(self.onViewportChanged, {});\r\n            }\r\n        }\r\n\r\n        function defaultFormatter(row, cell, value, columnDef, dataContext) {\r\n            if (value == null) {\r\n                return \"\";\r\n            } else {\r\n                return value.toString().replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\");\r\n            }\r\n        }\r\n\r\n        function getFormatter(row, column) {\r\n            var rowMetadata = data.getItemMetadata && data.getItemMetadata(row);\r\n\r\n            // look up by id, then index\r\n            var columnOverrides = rowMetadata &&\r\n                rowMetadata.columns &&\r\n                (rowMetadata.columns[column.id] || rowMetadata.columns[getColumnIndex(column.id)]);\r\n\r\n            return (columnOverrides && columnOverrides.formatter) ||\r\n                (rowMetadata && rowMetadata.formatter) ||\r\n                column.formatter ||\r\n                (options.formatterFactory && options.formatterFactory.getFormatter(column)) ||\r\n                options.defaultFormatter;\r\n        }\r\n\r\n        function getEditor(row, cell) {\r\n            var column = columns[cell];\r\n            var rowMetadata = data.getItemMetadata && data.getItemMetadata(row);\r\n            var columnMetadata = rowMetadata && rowMetadata.columns;\r\n\r\n            if (columnMetadata && columnMetadata[column.id] && columnMetadata[column.id].editor !== undefined) {\r\n                return columnMetadata[column.id].editor;\r\n            }\r\n            if (columnMetadata && columnMetadata[cell] && columnMetadata[cell].editor !== undefined) {\r\n                return columnMetadata[cell].editor;\r\n            }\r\n\r\n            return column.editor || (options.editorFactory && options.editorFactory.getEditor(column));\r\n        }\r\n\r\n        function getDataItemValueForColumn(item, columnDef) {\r\n            if (options.dataItemColumnValueExtractor) {\r\n                return options.dataItemColumnValueExtractor(item, columnDef);\r\n            }\r\n            return item[columnDef.field];\r\n        }\r\n\r\n        function appendRowHtml(stringArray, row) {\r\n            var d = getDataItem(row);\r\n            var dataLoading = row < getDataLength() && !d;\r\n            var cellCss;\r\n            var rowCss = \"slick-row \" +\r\n                (dataLoading ? \" loading\" : \"\") +\r\n                (row % 2 == 1 ? \" odd\" : \" even\");\r\n\r\n            var metadata = data.getItemMetadata && data.getItemMetadata(row);\r\n\r\n            if (metadata && metadata.cssClasses) {\r\n                rowCss += \" \" + metadata.cssClasses;\r\n            }\r\n\r\n\r\n            //stringArray.push(\"<div class='ui-widget-content \" + rowCss + \"' row='\" + row + \"' style='top:\" + (options.rowHeight * row - offset) + \"px'>\");\r\n            if (options.wideString) {\r\n                var locTop = getHeightsOfRows(0, row);\r\n                stringArray.push(\"<div class='ui-widget-content \" + rowCss + \"' row='\" + row + \"' style='top:\" + (locTop - offset) + \"px; height:\" + rowHeights[row] + \"px'>\");\r\n            }\r\n            else\r\n                stringArray.push(\"<div class='ui-widget-content \" + rowCss + \"' row='\" + row + \"' style='top:\" + (options.rowHeight * row - offset) + \"px'>\");\r\n\r\n            var colspan, m;\r\n            for (var i = 0, cols = columns.length; i < cols; i++) {\r\n                m = columns[i];\r\n                colspan = getColspan(row, i);  // TODO:  don't calc unless we have to\r\n                cellCss = \"slick-cell l\" + i + \" r\" + Math.min(columns.length - 1, i + colspan - 1) + (m.cssClass ? \" \" + m.cssClass : \"\");\r\n                if (row === activeRow && i === activeCell) {\r\n                    cellCss += (\" active\");\r\n                }\r\n\r\n                // TODO:  merge them together in the setter\r\n                for (var key in cellCssClasses) {\r\n                    if (cellCssClasses[key][row] && cellCssClasses[key][row][m.id]) {\r\n                        cellCss += (\" \" + cellCssClasses[key][row][m.id]);\r\n                    }\r\n                }\r\n\r\n                var title = '';\r\n\r\n                // if there is a corresponding row (if not, this is the Add New row or this data hasn't been loaded yet)\r\n                if (d) {\r\n                    title = getFormatter(row, m)(row, i, getDataItemValueForColumn(d, m), m, d);\r\n                    title = title.toString();\r\n                }\r\n                var locHeightStyle = heightsMeasured && options.wideString ? \" style='height:\" + rowHeights[row] + \"px'\" : \"\";\r\n                //var locTitle = (title != \"\" && title.indexOf('>') == -1 && title.indexOf('<') == -1 ? \"' title='\" + title + \"'\" : \"\");\r\n                var locTitle = \"\";\r\n                stringArray.push(\"<div class='\" + cellCss + \"'\" + locTitle + locHeightStyle + \">\");\r\n                stringArray.push(title);\r\n                stringArray.push(\"</div>\");\r\n\r\n                if (colspan) {\r\n                    i += (colspan - 1);\r\n                }\r\n            }\r\n\r\n            stringArray.push(\"</div>\");\r\n        }\r\n        \r\n        var rowHeights = {};\r\n        var heightsMeasured = false;\r\n        var hGen = 0; //��������� �����������\r\n        function measureHeights() {\r\n            rowHeights = {};\r\n            var localRowsCache = {};\r\n\r\n            var l = getDataLength();\r\n            if (options.wideString) {\r\n                if (document.getElementById('wide-string-style') == null) {\r\n                    var d = $container;\r\n                    var newElement = document.createElement(\"style\");\r\n                    newElement.innerHTML = '.slick-cell{white-space: pre-wrap; word-break: break-word; padding-bottom: 0px; line-height: 1.8}';\r\n                    newElement.id = 'wide-string-style';\r\n                    var c = d[0].parentNode.insertBefore(newElement, d[0]);\r\n                }\r\n                var sa = [];\r\n                var x = document.createElement(\"div\");\r\n                for (var i = 0; i < l; i++) {\r\n                    var item = getDataItem(i);\r\n                    //�������� ����������� ��������\r\n                    if (item.hasOwnProperty('__hGen') && item.__hGen == hGen) {\r\n                        rowHeights[i] = item.__cachedHeight;\r\n                        continue;\r\n                    }\r\n                    \r\n                    sa = [];\r\n                    appendRowHtml(sa, i);\r\n                    \r\n                    x.innerHTML = sa.join(\"\");\r\n                    var lHeight = 0;\r\n                    \r\n                    localRowsCache[i] = $canvas[0].appendChild(x.firstChild);\r\n                    rowHeights[i] = 0;\r\n\r\n                    for (var j = 0, lc = localRowsCache[i].children.length; j < lc; j++) {\r\n                        var child = localRowsCache[i].children[j];\r\n                        lHeight = child.scrollHeight;\r\n                        if (lHeight > rowHeights[i]) rowHeights[i] = lHeight;\r\n                    }\r\n                    \r\n                    item.__cachedHeight = rowHeights[i];\r\n                    item.__hGen = hGen;\r\n                    //������ ��������\r\n                    localRowsCache[i].parentNode.removeChild(localRowsCache[i]);\r\n                    delete localRowsCache[i];\r\n\r\n                }\r\n                heightsMeasured = true;\r\n            } else {\r\n                for (var i = 0; i < l; i++) {\r\n                    rowHeights[i] = options.rowHeight;\r\n                }\r\n                heightsMeasured = true;\r\n            }\r\n            return rowHeights;\r\n        }\r\n\r\n        //������ options.rowHeight*row - ��������� ������ count ����� ������� �� ������ from (zero-based index);\r\n        //options.rowHeight*row ->getHeightsOfRows(0,row)\r\n        function getHeightsOfRows(from, count) {\r\n            if (typeof count == 'undefined') throw 'argument error';\r\n            if (!heightsMeasured) return count*options.rowHeight;\r\n\r\n            var result = 0;\r\n            for (var i = 0, l = from + count; i < l; i++) {\r\n                result += rowHeights[i];\r\n            }\r\n            return result;\r\n        }\r\n\r\n        //������ viewportH/options.rowHeight - ��������� ���������� ����� ���������� � ������� ������ height ������� �� ������ from;\r\n        function getRowsCountByHeight(height, from) {\r\n            if (typeof from == 'undefined') throw 'argument error';\r\n            if (!heightsMeasured) throw 'heights not measured';\r\n\r\n            for (var i = 0; height > 0; i++) {\r\n                height -= rowHeights[i + from];\r\n            }\r\n            return i-1;\r\n        }\r\n        //������ viewportH/options.rowHeight - ��������� ���������� ����� ���������� � ������� ������ height ������� � �������� � offsetTop;\r\n        function getRowsCountByHeight2(height, offsetTop) {\r\n            if (typeof offsetTop == 'undefined') throw 'argument error';\r\n            if (!heightsMeasured) throw 'heights not measured';\r\n\r\n            for (var from = 0; offsetTop > 0; from++) {\r\n                offsetTop -= rowHeights[from];\r\n            }\r\n            for (var i = 0; height > 0; i++) {\r\n                height -= rowHeights[i + from];\r\n            }\r\n            return i;\r\n        }\r\n\r\n\r\n        function cleanupRows(rangeToKeep) {\r\n            for (var i in rowsCache) {\r\n                if (((i = parseInt(i, 10)) !== activeRow) && (i < rangeToKeep.top || i > rangeToKeep.bottom)) {\r\n                    removeRowFromCache(i);\r\n                }\r\n            }\r\n        }\r\n\r\n        function invalidate() {\r\n            updateRowCount();\r\n            invalidateAllRows();\r\n            render();\r\n        }\r\n\r\n        function invalidateAllRows() {\r\n            if (currentEditor) {\r\n                makeActiveCellNormal();\r\n            }\r\n            for (var row in rowsCache) {\r\n                removeRowFromCache(row);\r\n            }\r\n        }\r\n\r\n        function removeRowFromCache(row) {\r\n            var node = rowsCache[row];\r\n            if (!node) {\r\n                return;\r\n            }\r\n            $canvas[0].removeChild(node);\r\n            delete rowsCache[row];\r\n            delete postProcessedRows[row];\r\n            renderedRows--;\r\n            counter_rows_removed++;\r\n        }\r\n\r\n        function invalidateRows(rows) {\r\n            var i, rl;\r\n            if (!rows || !rows.length) {\r\n                return;\r\n            }\r\n            scrollDir = 0;\r\n            for (i = 0, rl = rows.length; i < rl; i++) {\r\n                if (currentEditor && activeRow === rows[i]) {\r\n                    makeActiveCellNormal();\r\n                }\r\n                if (rowsCache[rows[i]]) {\r\n                    removeRowFromCache(rows[i]);\r\n                }\r\n            }\r\n        }\r\n\r\n        function invalidateRow(row) {\r\n            invalidateRows([row]);\r\n        }\r\n\r\n        function updateCell(row, cell) {\r\n            var cellNode = getCellNode(row, cell);\r\n            if (!cellNode) {\r\n                return;\r\n            }\r\n\r\n            var m = columns[cell], d = getDataItem(row);\r\n            if (currentEditor && activeRow === row && activeCell === cell) {\r\n                currentEditor.loadValue(d);\r\n            } else {\r\n                cellNode.innerHTML = d ? getFormatter(row, m)(row, cell, getDataItemValueForColumn(d, m), m, d) : \"\";\r\n                invalidatePostProcessingResults(row);\r\n            }\r\n        }\r\n\r\n        function updateRow(row) {\r\n            if (!rowsCache[row]) {\r\n                return;\r\n            }\r\n\r\n            var columnIndex = 0\r\n            $(rowsCache[row]).children().each(function (i) {\r\n                var m = columns[columnIndex], d = getDataItem(row);\r\n                if (row === activeRow && i === activeCell && currentEditor) {\r\n                    currentEditor.loadValue(getDataItem(activeRow));\r\n                } else if (d) {\r\n                    this.innerHTML = getFormatter(row, m)(row, columnIndex, getDataItemValueForColumn(d, m), m, getDataItem(row));\r\n                } else {\r\n                    this.innerHTML = \"\";\r\n                }\r\n\r\n                columnIndex += getColspan(row, i);\r\n            });\r\n\r\n            invalidatePostProcessingResults(row);\r\n        }\r\n\r\n        function getViewportHeight() {\r\n            return parseFloat($.css($container[0], \"height\", true)) -\r\n                parseFloat($.css($headerScroller[0], \"height\")) - getVBoxDelta($headerScroller) -\r\n                (options.showTopPanel ? options.topPanelHeight + getVBoxDelta($topPanelScroller) : 0) -\r\n                (options.showHeaderRow ? options.headerRowHeight + getVBoxDelta($headerRowScroller) : 0);\r\n        }\r\n\r\n        function resizeCanvas() {\r\n            \r\n            if (!initialized) { return; }\r\n            if (options.autoHeight) {\r\n                //��� ���� ����� ���-�� ��������, �� �.�. � ��� ������ �� ������������ autoHeight, ���� �� �������.\r\n                viewportH = options.rowHeight * (getDataLength() + (options.enableAddRow ? 1 : 0) + (options.leaveSpaceForNewRows ? numVisibleRows - 1 : 0));\r\n            } else {\r\n                viewportH = getViewportHeight();\r\n            }\r\n\r\n            //numVisibleRows = Math.ceil(viewportH / options.rowHeight);\r\n            numVisibleRows = getRowsCountByHeight(viewportH, 0);\r\n\r\n            viewportW = parseFloat($.css($container[0], \"width\", true));\r\n            $viewport.height(viewportH);\r\n\r\n            if (options.forceFitColumns) {\r\n                autosizeColumns();\r\n            }\r\n            \r\n            if (options.wideString) {\r\n                updateCanvasWidth(false);\r\n            }\r\n            measureHeights();\r\n            updateRowCount();\r\n            render();\r\n            \r\n        }\r\n\r\n        function updateRowCount() {\r\n            if (!initialized) { return; }\r\n            numberOfRows = getDataLength() +\r\n                (options.enableAddRow ? 1 : 0) +\r\n                (options.leaveSpaceForNewRows ? numVisibleRows - 1 : 0);\r\n\r\n            var oldViewportHasVScroll = viewportHasVScroll;\r\n            // with autoHeight, we do not need to accommodate the vertical scroll bar\r\n            //viewportHasVScroll = !options.autoHeight && (numberOfRows * options.rowHeight > viewportH);\r\n            viewportHasVScroll = !options.autoHeight && ( getHeightsOfRows(0, numberOfRows) > viewportH);\r\n\r\n            // remove the rows that are now outside of the data range\r\n            // this helps avoid redundant calls to .removeRow() when the size of the data decreased by thousands of rows\r\n            var l = options.enableAddRow ? getDataLength() : getDataLength() - 1;\r\n            for (var i in rowsCache) {\r\n                if (i >= l) {\r\n                    removeRowFromCache(i);\r\n                }\r\n            }\r\n\r\n            var oldH = h;\r\n            //th = Math.max(options.rowHeight * numberOfRows, viewportH - scrollbarDimensions.height);\r\n            th = Math.max( getHeightsOfRows(0, numberOfRows), viewportH - scrollbarDimensions.height);\r\n            if (th < maxSupportedCssHeight) {\r\n                // just one page\r\n                h = ph = th;\r\n                n = 1;\r\n                cj = 0;\r\n            } else {\r\n                // break into pages\r\n                h = maxSupportedCssHeight;\r\n                ph = h / 100;\r\n                n = Math.floor(th / ph);\r\n                cj = (th - h) / (n - 1);\r\n            }\r\n\r\n            if (h !== oldH) {\r\n                $canvas.css(\"height\", h);\r\n                scrollTop = $viewport[0].scrollTop;\r\n            }\r\n\r\n            var oldScrollTopInRange = (scrollTop + offset <= th - viewportH);\r\n\r\n            if (th == 0 || scrollTop == 0) {\r\n                page = offset = 0;\r\n            } else if (oldScrollTopInRange) {\r\n                // maintain virtual position\r\n                scrollTo(scrollTop + offset);\r\n            } else {\r\n                // scroll to bottom\r\n                scrollTo(th - viewportH);\r\n            }\r\n\r\n            if (h != oldH && options.autoHeight) {\r\n                resizeCanvas();\r\n            }\r\n\r\n            if (options.forceFitColumns && oldViewportHasVScroll != viewportHasVScroll) {\r\n                autosizeColumns();\r\n            }\r\n            updateCanvasWidth(false);\r\n        }\r\n\r\n        function getVisibleRange(viewportTop) {\r\n            if (viewportTop == null) {\r\n                viewportTop = scrollTop;\r\n            }\r\n\r\n            var top1 = getRowsCountByHeight((viewportTop + offset), 0);\r\n            return {\r\n                top: top1,\r\n                //top: Math.floor((viewportTop + offset) / options.rowHeight),\r\n                bottom: getRowsCountByHeight((viewportTop + offset)+viewportH, 0)\r\n                //bottom: Math.ceil((viewportTop + offset + viewportH) / options.rowHeight)\r\n            };\r\n        }\r\n\r\n        function getRenderedRange(viewportTop) {\r\n            var range = getVisibleRange(viewportTop);\r\n            //var buffer = Math.round(viewportH / options.rowHeight);\r\n            var top2 = (typeof (viewportTop) == 'undefined') ? 0 : viewportTop;\r\n            var buffer = getRowsCountByHeight(viewportTop + viewportH, 0) - getRowsCountByHeight(viewportTop, 0);\r\n            var minBuffer = 3;\r\n\r\n            if (scrollDir == -1) {\r\n                range.top -= buffer;\r\n                range.bottom += minBuffer;\r\n            } else if (scrollDir == 1) {\r\n                range.top -= minBuffer;\r\n                range.bottom += buffer;\r\n            } else {\r\n                range.top -= minBuffer;\r\n                range.bottom += minBuffer;\r\n            }\r\n\r\n            range.top = Math.max(0, range.top);\r\n            range.bottom = Math.min(options.enableAddRow ? getDataLength() : getDataLength() - 1, range.bottom);\r\n\r\n            return range;\r\n        }\r\n\r\n        function renderRows(range) {\r\n            var i, l,\r\n                parentNode = $canvas[0],\r\n                rowsBefore = renderedRows,\r\n                stringArray = [],\r\n                rows = [],\r\n                startTimestamp = new Date(),\r\n                needToReselectCell = false;\r\n\r\n            for (i = range.top; i <= range.bottom; i++) {\r\n                if (rowsCache[i]) {\r\n                    continue;\r\n                }\r\n                renderedRows++;\r\n                rows.push(i);\r\n                appendRowHtml(stringArray, i);\r\n                if (activeCellNode && activeRow === i) {\r\n                    needToReselectCell = true;\r\n                }\r\n                counter_rows_rendered++;\r\n            }\r\n\r\n            if (!rows.length) { return; }\r\n\r\n            var x = document.createElement(\"div\");\r\n            x.innerHTML = stringArray.join(\"\");\r\n\r\n            for (i = 0, l = x.childNodes.length; i < l; i++) {\r\n                rowsCache[rows[i]] = parentNode.appendChild(x.firstChild);\r\n            }\r\n\r\n            if (needToReselectCell) {\r\n                activeCellNode = getCellNode(activeRow, activeCell);\r\n            }\r\n\r\n            if (renderedRows - rowsBefore > 5) {\r\n                avgRowRenderTime = (new Date() - startTimestamp) / (renderedRows - rowsBefore);\r\n            }\r\n        }\r\n\r\n        function startPostProcessing() {\r\n            if (!options.enableAsyncPostRender) {\r\n                return;\r\n            }\r\n            clearTimeout(h_postrender);\r\n            h_postrender = setTimeout(asyncPostProcessRows, options.asyncPostRenderDelay);\r\n        }\r\n\r\n        function invalidatePostProcessingResults(row) {\r\n            delete postProcessedRows[row];\r\n            postProcessFromRow = Math.min(postProcessFromRow, row);\r\n            postProcessToRow = Math.max(postProcessToRow, row);\r\n            startPostProcessing();\r\n        }\r\n\r\n        function updateRowPositions() {\r\n            for (var row in rowsCache) {\r\n                //rowsCache[row].style.top = (row * options.rowHeight - offset) + \"px\";\r\n                rowsCache[row].style.top = ( getHeightsOfRows(0, row) - offset) + \"px\";\r\n            }\r\n        }\r\n\r\n        function render() {\r\n            if (!initialized) { return; }\r\n            var visible = getVisibleRange();\r\n            var rendered = getRenderedRange();\r\n\r\n            // remove rows no longer in the viewport\r\n            cleanupRows(rendered);\r\n\r\n            // add new rows\r\n            renderRows(rendered);\r\n\r\n            postProcessFromRow = visible.top;\r\n            postProcessToRow = Math.min(options.enableAddRow ? getDataLength() : getDataLength() - 1, visible.bottom);\r\n            startPostProcessing();\r\n\r\n            lastRenderedScrollTop = scrollTop;\r\n            h_render = null;\r\n        }\r\n\r\n        function handleScroll() {\r\n            scrollTop = $viewport[0].scrollTop;\r\n            var scrollLeft = $viewport[0].scrollLeft;\r\n            var scrollDist = Math.abs(scrollTop - prevScrollTop);\r\n\r\n            if (scrollLeft !== prevScrollLeft) {\r\n                prevScrollLeft = scrollLeft;\r\n                $headerScroller[0].scrollLeft = scrollLeft;\r\n                $topPanelScroller[0].scrollLeft = scrollLeft;\r\n                $headerRowScroller[0].scrollLeft = scrollLeft;\r\n            }\r\n\r\n            if (scrollDist) {\r\n                scrollDir = prevScrollTop < scrollTop ? 1 : -1;\r\n                prevScrollTop = scrollTop;\r\n\r\n                // switch virtual pages if needed\r\n                if (scrollDist < viewportH) {\r\n                    scrollTo(scrollTop + offset);\r\n                } else {\r\n                    var oldOffset = offset;\r\n                    page = Math.min(n - 1, Math.floor(scrollTop * ((th - viewportH) / (h - viewportH)) * (1 / ph)));\r\n                    offset = Math.round(page * cj);\r\n                    if (oldOffset != offset) {\r\n                        invalidateAllRows();\r\n                    }\r\n                }\r\n\r\n                if (h_render) {\r\n                    clearTimeout(h_render);\r\n                }\r\n\r\n                if (Math.abs(lastRenderedScrollTop - scrollTop) < viewportH) {\r\n                    render();\r\n                } else {\r\n                    h_render = setTimeout(render, 50);\r\n                }\r\n\r\n                trigger(self.onViewportChanged, {});\r\n            }\r\n\r\n            trigger(self.onScroll, {scrollLeft: scrollLeft, scrollTop: scrollTop});\r\n        }\r\n\r\n        function asyncPostProcessRows() {\r\n            while (postProcessFromRow <= postProcessToRow) {\r\n                var row = (scrollDir >= 0) ? postProcessFromRow++ : postProcessToRow--;\r\n                var rowNode = rowsCache[row];\r\n                if (!rowNode || postProcessedRows[row] || row >= getDataLength()) {\r\n                    continue;\r\n                }\r\n\r\n                var d = getDataItem(row), cellNodes = rowNode.childNodes;\r\n                for (var i = 0, j = 0, l = columns.length; i < l; ++i) {\r\n                    var m = columns[i];\r\n                    if (m.asyncPostRender) {\r\n                        m.asyncPostRender(cellNodes[j], postProcessFromRow, d, m);\r\n                    }\r\n                    ++j;\r\n                }\r\n\r\n                postProcessedRows[row] = true;\r\n                h_postrender = setTimeout(asyncPostProcessRows, options.asyncPostRenderDelay);\r\n                return;\r\n            }\r\n        }\r\n\r\n        function updateCellCssStylesOnRenderedRows(addedHash, removedHash) {\r\n            var node, columnId, addedRowHash, removedRowHash;\r\n            for (var row in rowsCache) {\r\n                removedRowHash = removedHash && removedHash[row];\r\n                addedRowHash = addedHash && addedHash[row];\r\n\r\n                if (removedRowHash) {\r\n                    for (columnId in removedRowHash) {\r\n                        if (!addedRowHash || removedRowHash[columnId] != addedRowHash[columnId]) {\r\n                            node = getCellNode(row, getColumnIndex(columnId));\r\n                            if (node) {\r\n                                $(node).removeClass(removedRowHash[columnId]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (addedRowHash) {\r\n                    for (columnId in addedRowHash) {\r\n                        if (!removedRowHash || removedRowHash[columnId] != addedRowHash[columnId]) {\r\n                            node = getCellNode(row, getColumnIndex(columnId));\r\n                            if (node) {\r\n                                $(node).addClass(addedRowHash[columnId]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        function addCellCssStyles(key, hash) {\r\n            if (cellCssClasses[key]) {\r\n                throw \"addCellCssStyles: cell CSS hash with key '\" + key + \"' already exists.\";\r\n            }\r\n\r\n            cellCssClasses[key] = hash;\r\n            updateCellCssStylesOnRenderedRows(hash, null);\r\n\r\n            trigger(self.onCellCssStylesChanged, { \"key\": key, \"hash\": hash });\r\n        }\r\n\r\n        function removeCellCssStyles(key) {\r\n            if (!cellCssClasses[key]) {\r\n                return;\r\n            }\r\n\r\n            updateCellCssStylesOnRenderedRows(null, cellCssClasses[key]);\r\n            delete cellCssClasses[key];\r\n\r\n            trigger(self.onCellCssStylesChanged, { \"key\": key, \"hash\": null });\r\n        }\r\n\r\n        function setCellCssStyles(key, hash) {\r\n            var prevHash = cellCssClasses[key];\r\n\r\n            cellCssClasses[key] = hash;\r\n            updateCellCssStylesOnRenderedRows(hash, prevHash);\r\n\r\n            trigger(self.onCellCssStylesChanged, { \"key\": key, \"hash\": hash });\r\n        }\r\n\r\n        function getCellCssStyles(key) {\r\n            return cellCssClasses[key];\r\n        }\r\n\r\n        function flashCell(row, cell, speed) {\r\n            speed = speed || 100;\r\n            if (rowsCache[row]) {\r\n                var $cell = $(getCellNode(row, cell));\r\n\r\n                function toggleCellClass(times) {\r\n                    if (!times) {\r\n                        return;\r\n                    }\r\n                    setTimeout(function () {\r\n                        $cell.queue(function () {\r\n                            $cell.toggleClass(options.cellFlashingCssClass).dequeue();\r\n                            toggleCellClass(times - 1);\r\n                        });\r\n                    },\r\n                        speed);\r\n                }\r\n\r\n                toggleCellClass(4);\r\n            }\r\n        }\r\n\r\n        //////////////////////////////////////////////////////////////////////////////////////////////\r\n        // Interactivity\r\n\r\n        function handleDragInit(e, dd) {\r\n            var cell = getCellFromEvent(e);\r\n            if (!cell || !cellExists(cell.row, cell.cell)) {\r\n                return false;\r\n            }\r\n\r\n            retval = trigger(self.onDragInit, dd, e);\r\n            if (e.isImmediatePropagationStopped()) {\r\n                return retval;\r\n            }\r\n\r\n            // if nobody claims to be handling drag'n'drop by stopping immediate propagation,\r\n            // cancel out of it\r\n            return false;\r\n        }\r\n\r\n        function handleDragStart(e, dd) {\r\n            var cell = getCellFromEvent(e);\r\n            if (!cell || !cellExists(cell.row, cell.cell)) {\r\n                return false;\r\n            }\r\n\r\n            var retval = trigger(self.onDragStart, dd, e);\r\n            if (e.isImmediatePropagationStopped()) {\r\n                return retval;\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        function handleDrag(e, dd) {\r\n            return trigger(self.onDrag, dd, e);\r\n        }\r\n\r\n        function handleDragEnd(e, dd) {\r\n            trigger(self.onDragEnd, dd, e);\r\n        }\r\n\r\n        function handleKeyDown(e) {\r\n            trigger(self.onKeyDown, {row: activeRow, cell: activeCell}, e);\r\n            var handled = e.isImmediatePropagationStopped();\r\n\r\n            if (!handled) {\r\n                if (!e.shiftKey && !e.altKey && !e.ctrlKey) {\r\n                    if (e.which == 27) {\r\n                        if (!getEditorLock().isActive()) {\r\n                            return; // no editing mode to cancel, allow bubbling and default processing (exit without cancelling the event)\r\n                        }\r\n                        cancelEditAndSetFocus();\r\n                    } else if (e.which == 37) {\r\n                        navigateLeft();\r\n                    } else if (e.which == 39) {\r\n                        navigateRight();\r\n                    } else if (e.which == 38) {\r\n                        navigateUp();\r\n                    } else if (e.which == 40) {\r\n                        navigateDown();\r\n                    } else if (e.which == 9) {\r\n                        navigateNext();\r\n                    } else if (e.which == 13) {\r\n                        if (options.editable) {\r\n                            if (currentEditor) {\r\n                                // adding new row\r\n                                if (activeRow === getDataLength()) {\r\n                                    navigateDown();\r\n                                }\r\n                                else {\r\n                                    commitEditAndSetFocus();\r\n                                }\r\n                            } else {\r\n                                if (getEditorLock().commitCurrentEdit()) {\r\n                                    makeActiveCellEditable();\r\n                                }\r\n                            }\r\n                        }\r\n                    } else {\r\n                        return;\r\n                    }\r\n                } else if (e.which == 9 && e.shiftKey && !e.ctrlKey && !e.altKey) {\r\n                    navigatePrev();\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // the event has been handled so don't let parent element (bubbling/propagation) or browser (default) handle it\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            try {\r\n                e.originalEvent.keyCode = 0; // prevent default behaviour for special keys in IE browsers (F3, F5, etc.)\r\n            }\r\n            // ignore exceptions - setting the original event's keycode throws access denied exception for \"Ctrl\"\r\n            // (hitting control key only, nothing else), \"Shift\" (maybe others)\r\n            catch (error) {\r\n            }\r\n        }\r\n\r\n        function handleClick(e) {\r\n            var cell = getCellFromEvent(e);\r\n            if (!cell || (currentEditor !== null && activeRow == cell.row && activeCell == cell.cell)) {\r\n                return;\r\n            }\r\n\r\n            trigger(self.onClick, {row: cell.row, cell: cell.cell}, e);\r\n            if (e.isImmediatePropagationStopped()) {\r\n                return;\r\n            }\r\n\r\n            if (canCellBeActive(cell.row, cell.cell)) {\r\n                if (!getEditorLock().isActive() || getEditorLock().commitCurrentEdit()) {\r\n                    scrollRowIntoView(cell.row, false);\r\n                    setActiveCellInternal(getCellNode(cell.row, cell.cell), (cell.row === getDataLength()) || options.autoEdit);\r\n                }\r\n            }\r\n        }\r\n\r\n        function handleContextMenu(e) {\r\n            var $cell = $(e.target).closest(\".slick-cell\", $canvas);\r\n            if ($cell.length === 0) {\r\n                return;\r\n            }\r\n\r\n            // are we editing this cell?\r\n            if (activeCellNode === $cell[0] && currentEditor !== null) {\r\n                return;\r\n            }\r\n\r\n            trigger(self.onContextMenu, {}, e);\r\n        }\r\n\r\n        function handleDblClick(e) {\r\n            var cell = getCellFromEvent(e);\r\n            if (!cell || (currentEditor !== null && activeRow == cell.row && activeCell == cell.cell)) {\r\n                return;\r\n            }\r\n\r\n            trigger(self.onDblClick, {row: cell.row, cell: cell.cell}, e);\r\n            if (e.isImmediatePropagationStopped()) {\r\n                return;\r\n            }\r\n\r\n            if (options.editable) {\r\n                gotoCell(cell.row, cell.cell, true);\r\n            }\r\n        }\r\n\r\n        function handleHeaderContextMenu(e) {\r\n            var $header = $(e.target).closest(\".slick-header-column\", \".slick-header-columns\");\r\n            var column = $header && columns[self.getColumnIndex($header.data(\"fieldId\"))];\r\n            trigger(self.onHeaderContextMenu, {column: column}, e);\r\n        }\r\n\r\n        function handleHeaderClick(e) {\r\n            var $header = $(e.target).closest(\".slick-header-column\", \".slick-header-columns\");\r\n            var column = $header && columns[self.getColumnIndex($header.data(\"fieldId\"))];\r\n            trigger(self.onHeaderClick, {column: column}, e);\r\n        }\r\n\r\n        function handleMouseEnter(e) {\r\n            trigger(self.onMouseEnter, {}, e);\r\n        }\r\n\r\n        function handleMouseLeave(e) {\r\n            trigger(self.onMouseLeave, {}, e);\r\n        }\r\n\r\n        function cellExists(row, cell) {\r\n            return !(row < 0 || row >= getDataLength() || cell < 0 || cell >= columns.length);\r\n        }\r\n\r\n        function getCellFromPoint(x, y) {\r\n            var row = Math.floor((y + offset) / options.rowHeight);\r\n            var cell = 0;\r\n\r\n            var w = 0;\r\n            for (var i = 0; i < columns.length && w < x; i++) {\r\n                w += columns[i].width;\r\n                cell++;\r\n            }\r\n\r\n            if (cell < 0) {\r\n                cell = 0;\r\n            }\r\n\r\n            return {row: row, cell: cell - 1};\r\n        }\r\n\r\n        function getCellFromNode(node) {\r\n            // read column number from .l<columnNumber> CSS class\r\n            var cls = /l\\d+/.exec(node.className);\r\n            if (!cls) {\r\n                throw \"getCellFromNode: cannot get cell - \" + node.className;\r\n            }\r\n            return parseInt(cls[0].substr(1, cls[0].length - 1), 10);\r\n        }\r\n\r\n        function getCellFromEvent(e) {\r\n            var $cell = $(e.target).closest(\".slick-cell\", $canvas);\r\n            if (!$cell.length) {\r\n                return null;\r\n            }\r\n\r\n            return {\r\n                row: $cell.parent().attr(\"row\") | 0,\r\n                cell: getCellFromNode($cell[0])\r\n            };\r\n        }\r\n\r\n        function getCellNodeBox(row, cell) {\r\n            if (!cellExists(row, cell)) {\r\n                return null;\r\n            }\r\n\r\n            //var y1 = row * options.rowHeight - offset;\r\n            //var y2 = y1 + options.rowHeight - 1;\r\n            var y1 = getHeightsOfRows(0, row) - offset;\r\n            var y2 = getHeightsOfRows(0, row + 1)  - offset - 1;\r\n\r\n            var x1 = 0;\r\n            for (var i = 0; i < cell; i++) {\r\n                x1 += columns[i].width;\r\n            }\r\n            var x2 = x1 + columns[cell].width;\r\n\r\n            return {\r\n                top: y1,\r\n                left: x1,\r\n                bottom: y2,\r\n                right: x2\r\n            };\r\n        }\r\n\r\n        //////////////////////////////////////////////////////////////////////////////////////////////\r\n        // Cell switching\r\n\r\n        function resetActiveCell() {\r\n            setActiveCellInternal(null, false);\r\n        }\r\n\r\n        function setFocus() {\r\n            // IE tries to scroll the viewport so that the item being focused is aligned to the left border\r\n            // IE-specific .setActive() sets the focus, but doesn't scroll\r\n            if ($.browser.msie) {\r\n                $canvas[0].setActive();\r\n            } else {\r\n                $canvas[0].focus();\r\n            }\r\n        }\r\n\r\n        function scrollActiveCellIntoView() {\r\n            if (activeCellNode) {\r\n                var left = $(activeCellNode).position().left,\r\n                    right = left + $(activeCellNode).outerWidth(),\r\n                    scrollLeft = $viewport.scrollLeft(),\r\n                    scrollRight = scrollLeft + $viewport.width();\r\n\r\n                if (left < scrollLeft) {\r\n                    $viewport.scrollLeft(left);\r\n                } else if (right > scrollRight) {\r\n                    $viewport.scrollLeft(Math.min(left, right - $viewport[0].clientWidth));\r\n                }\r\n            }\r\n        }\r\n\r\n        function setActiveCellInternal(newCell, editMode) {\r\n            if (activeCellNode !== null) {\r\n                makeActiveCellNormal();\r\n                $(activeCellNode).removeClass(\"active\");\r\n            }\r\n\r\n            var activeCellChanged = (activeCellNode !== newCell);\r\n            activeCellNode = newCell;\r\n\r\n            if (activeCellNode != null) {\r\n                activeRow = parseInt($(activeCellNode).parent().attr(\"row\"));\r\n                activeCell = activePosX = getCellFromNode(activeCellNode);\r\n\r\n                $(activeCellNode).addClass(\"active\");\r\n\r\n                if (options.editable && editMode && isCellPotentiallyEditable(activeRow, activeCell)) {\r\n                    clearTimeout(h_editorLoader);\r\n\r\n                    if (options.asyncEditorLoading) {\r\n                        h_editorLoader = setTimeout(function () {\r\n                            makeActiveCellEditable();\r\n                        }, options.asyncEditorLoadDelay);\r\n                    } else {\r\n                        makeActiveCellEditable();\r\n                    }\r\n                } else {\r\n                    setFocus();\r\n                }\r\n            } else {\r\n                activeRow = activeCell = null;\r\n            }\r\n\r\n            if (activeCellChanged) {\r\n                scrollActiveCellIntoView();\r\n                trigger(self.onActiveCellChanged, getActiveCell());\r\n            }\r\n        }\r\n\r\n        function clearTextSelection() {\r\n            if (document.selection && document.selection.empty) {\r\n                document.selection.empty();\r\n            } else if (window.getSelection) {\r\n                var sel = window.getSelection();\r\n                if (sel && sel.removeAllRanges) {\r\n                    sel.removeAllRanges();\r\n                }\r\n            }\r\n        }\r\n\r\n        function isCellPotentiallyEditable(row, cell) {\r\n            // is the data for this row loaded?\r\n            if (row < getDataLength() && !getDataItem(row)) {\r\n                return false;\r\n            }\r\n\r\n            // are we in the Add New row?  can we create new from this cell?\r\n            if (columns[cell].cannotTriggerInsert && row >= getDataLength()) {\r\n                return false;\r\n            }\r\n\r\n            // does this cell have an editor?\r\n            if (!getEditor(row, cell)) {\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        function makeActiveCellNormal() {\r\n            if (!currentEditor) {\r\n                return;\r\n            }\r\n            trigger(self.onBeforeCellEditorDestroy, {editor: currentEditor});\r\n            currentEditor.destroy();\r\n            currentEditor = null;\r\n\r\n            if (activeCellNode) {\r\n                var d = getDataItem(activeRow);\r\n                $(activeCellNode).removeClass(\"editable invalid\");\r\n                if (d) {\r\n                    var column = columns[activeCell];\r\n                    var formatter = getFormatter(activeRow, column);\r\n                    activeCellNode.innerHTML = formatter(activeRow, activeCell, getDataItemValueForColumn(d, column), column, getDataItem(activeRow));\r\n                    invalidatePostProcessingResults(activeRow);\r\n                }\r\n            }\r\n\r\n            // if there previously was text selected on a page (such as selected text in the edit cell just removed),\r\n            // IE can't set focus to anything else correctly\r\n            if ($.browser.msie) {\r\n                clearTextSelection();\r\n            }\r\n\r\n            getEditorLock().deactivate(editController);\r\n        }\r\n\r\n        function makeActiveCellEditable(editor) {\r\n            if (!activeCellNode) {\r\n                return;\r\n            }\r\n            if (!options.editable) {\r\n                throw \"Grid : makeActiveCellEditable : should never get called when options.editable is false\";\r\n            }\r\n\r\n            // cancel pending async call if there is one\r\n            clearTimeout(h_editorLoader);\r\n\r\n            if (!isCellPotentiallyEditable(activeRow, activeCell)) {\r\n                return;\r\n            }\r\n\r\n            var columnDef = columns[activeCell];\r\n            var item = getDataItem(activeRow);\r\n\r\n            if (trigger(self.onBeforeEditCell, {row: activeRow, cell: activeCell, item: item, column: columnDef}) === false) {\r\n                setFocus();\r\n                return;\r\n            }\r\n\r\n            getEditorLock().activate(editController);\r\n            $(activeCellNode).addClass(\"editable\");\r\n\r\n            // don't clear the cell if a custom editor is passed through\r\n            if (!editor) {\r\n                activeCellNode.innerHTML = \"\";\r\n            }\r\n\r\n            currentEditor = new (editor || getEditor(activeRow, activeCell))({\r\n                grid: self,\r\n                gridPosition: absBox($container[0]),\r\n                position: absBox(activeCellNode),\r\n                container: activeCellNode,\r\n                column: columnDef,\r\n                item: item || {},\r\n                commitChanges: commitEditAndSetFocus,\r\n                cancelChanges: cancelEditAndSetFocus\r\n            });\r\n\r\n            if (item) {\r\n                currentEditor.loadValue(item);\r\n            }\r\n\r\n            serializedEditorValue = currentEditor.serializeValue();\r\n\r\n            if (currentEditor.position) {\r\n                handleActiveCellPositionChange();\r\n            }\r\n        }\r\n\r\n        function commitEditAndSetFocus() {\r\n            // if the commit fails, it would do so due to a validation error\r\n            // if so, do not steal the focus from the editor\r\n            if (getEditorLock().commitCurrentEdit()) {\r\n                setFocus();\r\n                if (options.autoEdit) {\r\n                    navigateDown();\r\n                }\r\n            }\r\n        }\r\n\r\n        function cancelEditAndSetFocus() {\r\n            if (getEditorLock().cancelCurrentEdit()) {\r\n                setFocus();\r\n            }\r\n        }\r\n\r\n        function absBox(elem) {\r\n            var box = {\r\n                top: elem.offsetTop,\r\n                left: elem.offsetLeft,\r\n                bottom: 0,\r\n                right: 0,\r\n                width: $(elem).outerWidth(),\r\n                height: $(elem).outerHeight(),\r\n                visible: true};\r\n            box.bottom = box.top + box.height;\r\n            box.right = box.left + box.width;\r\n\r\n            // walk up the tree\r\n            var offsetParent = elem.offsetParent;\r\n            while ((elem = elem.parentNode) != document.body) {\r\n                if (box.visible && elem.scrollHeight != elem.offsetHeight && $(elem).css(\"overflowY\") != \"visible\") {\r\n                    box.visible = box.bottom > elem.scrollTop && box.top < elem.scrollTop + elem.clientHeight;\r\n                }\r\n\r\n                if (box.visible && elem.scrollWidth != elem.offsetWidth && $(elem).css(\"overflowX\") != \"visible\") {\r\n                    box.visible = box.right > elem.scrollLeft && box.left < elem.scrollLeft + elem.clientWidth;\r\n                }\r\n\r\n                box.left -= elem.scrollLeft;\r\n                box.top -= elem.scrollTop;\r\n\r\n                if (elem === offsetParent) {\r\n                    box.left += elem.offsetLeft;\r\n                    box.top += elem.offsetTop;\r\n                    offsetParent = elem.offsetParent;\r\n                }\r\n\r\n                box.bottom = box.top + box.height;\r\n                box.right = box.left + box.width;\r\n            }\r\n\r\n            return box;\r\n        }\r\n\r\n        function getActiveCellPosition() {\r\n            return absBox(activeCellNode);\r\n        }\r\n\r\n        function getGridPosition() {\r\n            return absBox($container[0])\r\n        }\r\n\r\n        function handleActiveCellPositionChange() {\r\n            if (!activeCellNode) {\r\n                return;\r\n            }\r\n\r\n            trigger(self.onActiveCellPositionChanged, {});\r\n\r\n            if (currentEditor) {\r\n                var cellBox = getActiveCellPosition();\r\n                if (currentEditor.show && currentEditor.hide) {\r\n                    if (!cellBox.visible) {\r\n                        currentEditor.hide();\r\n                    } else {\r\n                        currentEditor.show();\r\n                    }\r\n                }\r\n\r\n                if (currentEditor.position) {\r\n                    currentEditor.position(cellBox);\r\n                }\r\n            }\r\n        }\r\n\r\n        function getCellEditor() {\r\n            return currentEditor;\r\n        }\r\n\r\n        function getActiveCell() {\r\n            if (!activeCellNode) {\r\n                return null;\r\n            } else {\r\n                return { row: activeRow, cell: activeCell };\r\n            }\r\n        }\r\n\r\n        function getActiveCellNode() {\r\n            return activeCellNode;\r\n        }\r\n\r\n        function scrollRowIntoView(row, doPaging) {\r\n            //var rowAtTop = row * options.rowHeight;\r\n            //var rowAtBottom = (row + 1) * options.rowHeight - viewportH + (viewportHasHScroll ? scrollbarDimensions.height : 0);\r\n\r\n            var rowAtTop = getHeightsOfRows(0, row);\r\n            var rowAtBottom = getHeightsOfRows(0, row + 1) - viewportH + (viewportHasHScroll ? scrollbarDimensions.height : 0);\r\n\r\n            // need to page down?\r\n            //if ((row + 1) * options.rowHeight > scrollTop + viewportH + offset) {\r\n            if (getHeightsOfRows(0, row + 1) > scrollTop + viewportH + offset) {\r\n                scrollTo(doPaging ? rowAtTop : rowAtBottom);\r\n                render();\r\n            }\r\n                // or page up?\r\n                //else if (row * options.rowHeight < scrollTop + offset) {\r\n            else if (getHeightsOfRows(0, row) < scrollTop + offset) {\r\n                scrollTo(doPaging ? rowAtBottom : rowAtTop);\r\n                render();\r\n            }\r\n        }\r\n\r\n        function getColspan(row, cell) {\r\n            var metadata = data.getItemMetadata && data.getItemMetadata(row);\r\n            if (!metadata || !metadata.columns) {\r\n                return 1;\r\n            }\r\n\r\n            var columnData = metadata.columns[columns[cell].id] || metadata.columns[cell];\r\n            var colspan = (columnData && columnData.colspan);\r\n            if (colspan === \"*\") {\r\n                colspan = columns.length - cell;\r\n            }\r\n            return (colspan || 1);\r\n        }\r\n\r\n        function findFirstFocusableCell(row) {\r\n            var cell = 0;\r\n            while (cell < columns.length) {\r\n                if (canCellBeActive(row, cell)) {\r\n                    return cell;\r\n                }\r\n                cell += getColspan(row, cell);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        function findLastFocusableCell(row) {\r\n            var cell = 0;\r\n            var lastFocusableCell = null;\r\n            while (cell < columns.length) {\r\n                if (canCellBeActive(row, cell)) {\r\n                    lastFocusableCell = cell;\r\n                }\r\n                cell += getColspan(row, cell);\r\n            }\r\n            return lastFocusableCell;\r\n        }\r\n\r\n        function gotoRight(row, cell, posX) {\r\n            if (cell >= columns.length) {\r\n                return null;\r\n            }\r\n\r\n            do {\r\n                cell += getColspan(row, cell);\r\n            }\r\n            while (cell < columns.length && !canCellBeActive(row, cell));\r\n\r\n            if (cell < columns.length) {\r\n                return {\r\n                    \"row\": row,\r\n                    \"cell\": cell,\r\n                    \"posX\": cell\r\n                };\r\n            }\r\n            return null;\r\n        }\r\n\r\n        function gotoLeft(row, cell, posX) {\r\n            if (cell <= 0) {\r\n                return null;\r\n            }\r\n\r\n            var firstFocusableCell = findFirstFocusableCell(row);\r\n            if (firstFocusableCell === null || firstFocusableCell >= cell) {\r\n                return null;\r\n            }\r\n\r\n            var prev = {\r\n                \"row\": row,\r\n                \"cell\": firstFocusableCell,\r\n                \"posX\": firstFocusableCell\r\n            };\r\n            var pos;\r\n            while (true) {\r\n                pos = gotoRight(prev.row, prev.cell, prev.posX);\r\n                if (!pos) {\r\n                    return null;\r\n                }\r\n                if (pos.cell >= cell) {\r\n                    return prev;\r\n                }\r\n                prev = pos;\r\n            }\r\n        }\r\n\r\n        function gotoDown(row, cell, posX) {\r\n            var prevCell;\r\n            while (true) {\r\n                if (++row >= getDataLength() + (options.enableAddRow ? 1 : 0)) {\r\n                    return null;\r\n                }\r\n\r\n                prevCell = cell = 0;\r\n                while (cell <= posX) {\r\n                    prevCell = cell;\r\n                    cell += getColspan(row, cell);\r\n                }\r\n\r\n                if (canCellBeActive(row, prevCell)) {\r\n                    return {\r\n                        \"row\": row,\r\n                        \"cell\": prevCell,\r\n                        \"posX\": posX\r\n                    };\r\n                }\r\n            }\r\n        }\r\n\r\n        function gotoUp(row, cell, posX) {\r\n            var prevCell;\r\n            while (true) {\r\n                if (--row < 0) {\r\n                    return null;\r\n                }\r\n\r\n                prevCell = cell = 0;\r\n                while (cell <= posX) {\r\n                    prevCell = cell;\r\n                    cell += getColspan(row, cell);\r\n                }\r\n\r\n                if (canCellBeActive(row, prevCell)) {\r\n                    return {\r\n                        \"row\": row,\r\n                        \"cell\": prevCell,\r\n                        \"posX\": posX\r\n                    };\r\n                }\r\n            }\r\n        }\r\n\r\n        function gotoNext(row, cell, posX) {\r\n            var pos = gotoRight(row, cell, posX);\r\n            if (pos) {\r\n                return pos;\r\n            }\r\n\r\n            var firstFocusableCell = null;\r\n            while (++row < getDataLength() + (options.enableAddRow ? 1 : 0)) {\r\n                firstFocusableCell = findFirstFocusableCell(row);\r\n                if (firstFocusableCell !== null) {\r\n                    return {\r\n                        \"row\": row,\r\n                        \"cell\": firstFocusableCell,\r\n                        \"posX\": firstFocusableCell\r\n                    };\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        function gotoPrev(row, cell, posX) {\r\n            var pos;\r\n            var lastSelectableCell;\r\n            while (!pos) {\r\n                pos = gotoLeft(row, cell, posX);\r\n                if (pos) {\r\n                    break;\r\n                }\r\n                if (--row < 0) {\r\n                    return null;\r\n                }\r\n\r\n                cell = 0;\r\n                lastSelectableCell = findLastFocusableCell(row);\r\n                if (lastSelectableCell !== null) {\r\n                    pos = {\r\n                        \"row\": row,\r\n                        \"cell\": lastSelectableCell,\r\n                        \"posX\": lastSelectableCell\r\n                    };\r\n                }\r\n            }\r\n            return pos;\r\n        }\r\n\r\n        function navigateRight() {\r\n            navigate(\"right\");\r\n        }\r\n\r\n        function navigateLeft() {\r\n            navigate(\"left\");\r\n        }\r\n\r\n        function navigateDown() {\r\n            navigate(\"down\");\r\n        }\r\n\r\n        function navigateUp() {\r\n            navigate(\"up\");\r\n        }\r\n\r\n        function navigateNext() {\r\n            navigate(\"next\");\r\n        }\r\n\r\n        function navigatePrev() {\r\n            navigate(\"prev\");\r\n        }\r\n\r\n        function navigate(dir) {\r\n            if (!activeCellNode || !options.enableCellNavigation) {\r\n                return;\r\n            }\r\n            if (!getEditorLock().commitCurrentEdit()) {\r\n                return;\r\n            }\r\n\r\n            var stepFunctions = {\r\n                \"up\": gotoUp,\r\n                \"down\": gotoDown,\r\n                \"left\": gotoLeft,\r\n                \"right\": gotoRight,\r\n                \"prev\": gotoPrev,\r\n                \"next\": gotoNext\r\n            };\r\n            var stepFn = stepFunctions[dir];\r\n            var pos = stepFn(activeRow, activeCell, activePosX);\r\n            if (pos) {\r\n                var isAddNewRow = (pos.row == getDataLength());\r\n                scrollRowIntoView(pos.row, !isAddNewRow);\r\n                setActiveCellInternal(getCellNode(pos.row, pos.cell), isAddNewRow || options.autoEdit);\r\n                activePosX = pos.posX;\r\n            } else {\r\n                setActiveCellInternal(getCellNode(activeRow, activeCell), (activeRow == getDataLength()) || options.autoEdit);\r\n            }\r\n        }\r\n\r\n        function getCellNode(row, cell) {\r\n            if (rowsCache[row]) {\r\n                var cells = $(rowsCache[row]).children();\r\n                var nodeCell;\r\n                for (var i = 0; i < cells.length; i++) {\r\n                    nodeCell = getCellFromNode(cells[i]);\r\n                    if (nodeCell === cell) {\r\n                        return cells[i];\r\n                    } else if (nodeCell > cell) {\r\n                        return null;\r\n                    }\r\n\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        function setActiveCell(row, cell) {\r\n            if (!initialized) { return; }\r\n            if (row > getDataLength() || row < 0 || cell >= columns.length || cell < 0) {\r\n                return;\r\n            }\r\n\r\n            if (!options.enableCellNavigation) {\r\n                return;\r\n            }\r\n\r\n            scrollRowIntoView(row, false);\r\n            setActiveCellInternal(getCellNode(row, cell), false);\r\n        }\r\n\r\n        function canCellBeActive(row, cell) {\r\n            if (!options.enableCellNavigation || row >= getDataLength() + (options.enableAddRow ? 1 : 0) ||\r\n                row < 0 || cell >= columns.length || cell < 0) {\r\n                return false;\r\n            }\r\n\r\n            var rowMetadata = data.getItemMetadata && data.getItemMetadata(row);\r\n            if (rowMetadata && typeof rowMetadata.focusable === \"boolean\") {\r\n                return rowMetadata.focusable;\r\n            }\r\n\r\n            var columnMetadata = rowMetadata && rowMetadata.columns;\r\n            if (columnMetadata && columnMetadata[columns[cell].id] && typeof columnMetadata[columns[cell].id].focusable === \"boolean\") {\r\n                return columnMetadata[columns[cell].id].focusable;\r\n            }\r\n            if (columnMetadata && columnMetadata[cell] && typeof columnMetadata[cell].focusable === \"boolean\") {\r\n                return columnMetadata[cell].focusable;\r\n            }\r\n\r\n            if (typeof columns[cell].focusable === \"boolean\") {\r\n                return columns[cell].focusable;\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        function canCellBeSelected(row, cell) {\r\n            if (row >= getDataLength() || row < 0 || cell >= columns.length || cell < 0) {\r\n                return false;\r\n            }\r\n\r\n            var rowMetadata = data.getItemMetadata && data.getItemMetadata(row);\r\n            if (rowMetadata && typeof rowMetadata.selectable === \"boolean\") {\r\n                return rowMetadata.selectable;\r\n            }\r\n\r\n            var columnMetadata = rowMetadata && rowMetadata.columns && (rowMetadata.columns[columns[cell].id] || rowMetadata.columns[cell]);\r\n            if (columnMetadata && typeof columnMetadata.selectable === \"boolean\") {\r\n                return columnMetadata.selectable;\r\n            }\r\n\r\n            if (typeof columns[cell].selectable === \"boolean\") {\r\n                return columns[cell].selectable;\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        function gotoCell(row, cell, forceEdit) {\r\n            if (!initialized) { return; }\r\n            if (!canCellBeActive(row, cell)) {\r\n                return;\r\n            }\r\n\r\n            if (!getEditorLock().commitCurrentEdit()) {\r\n                return;\r\n            }\r\n\r\n            scrollRowIntoView(row, false);\r\n\r\n            var newCell = getCellNode(row, cell);\r\n\r\n            // if selecting the 'add new' row, start editing right away\r\n            setActiveCellInternal(newCell, forceEdit || (row === getDataLength()) || options.autoEdit);\r\n\r\n            // if no editor was created, set the focus back on the grid\r\n            if (!currentEditor) {\r\n                setFocus();\r\n            }\r\n        }\r\n\r\n\r\n        //////////////////////////////////////////////////////////////////////////////////////////////\r\n        // IEditor implementation for the editor lock\r\n\r\n        function commitCurrentEdit() {\r\n            var item = getDataItem(activeRow);\r\n            var column = columns[activeCell];\r\n\r\n            if (currentEditor) {\r\n                if (currentEditor.isValueChanged()) {\r\n                    var validationResults = currentEditor.validate();\r\n\r\n                    if (validationResults.valid) {\r\n                        if (activeRow < getDataLength()) {\r\n                            var editCommand = {\r\n                                row: activeRow,\r\n                                cell: activeCell,\r\n                                editor: currentEditor,\r\n                                serializedValue: currentEditor.serializeValue(),\r\n                                prevSerializedValue: serializedEditorValue,\r\n                                execute: function () {\r\n                                    this.editor.applyValue(item, this.serializedValue);\r\n                                    updateRow(this.row);\r\n                                },\r\n                                undo: function () {\r\n                                    this.editor.applyValue(item, this.prevSerializedValue);\r\n                                    updateRow(this.row);\r\n                                }\r\n                            };\r\n\r\n                            if (options.editCommandHandler) {\r\n                                makeActiveCellNormal();\r\n                                options.editCommandHandler(item, column, editCommand);\r\n                            } else {\r\n                                editCommand.execute();\r\n                                makeActiveCellNormal();\r\n                            }\r\n\r\n                            trigger(self.onCellChange, {\r\n                                row: activeRow,\r\n                                cell: activeCell,\r\n                                item: item\r\n                            });\r\n                        } else {\r\n                            var newItem = {};\r\n                            currentEditor.applyValue(newItem, currentEditor.serializeValue());\r\n                            makeActiveCellNormal();\r\n                            trigger(self.onAddNewRow, {item: newItem, column: column});\r\n                        }\r\n\r\n                        // check whether the lock has been re-acquired by event handlers\r\n                        return !getEditorLock().isActive();\r\n                    } else {\r\n                        // TODO: remove and put in onValidationError handlers in examples\r\n                        $(activeCellNode).addClass(\"invalid\");\r\n                        $(activeCellNode).stop(true, true).effect(\"highlight\", {color: \"red\"}, 300);\r\n\r\n                        trigger(self.onValidationError, {\r\n                            editor: currentEditor,\r\n                            cellNode: activeCellNode,\r\n                            validationResults: validationResults,\r\n                            row: activeRow,\r\n                            cell: activeCell,\r\n                            column: column\r\n                        });\r\n\r\n                        currentEditor.focus();\r\n                        return false;\r\n                    }\r\n                }\r\n\r\n                makeActiveCellNormal();\r\n            }\r\n            return true;\r\n        }\r\n\r\n        function cancelCurrentEdit() {\r\n            makeActiveCellNormal();\r\n            return true;\r\n        }\r\n\r\n        function rowsToRanges(rows) {\r\n            var ranges = [];\r\n            var lastCell = columns.length - 1;\r\n            for (var i = 0; i < rows.length; i++) {\r\n                ranges.push(new Slick.Range(rows[i], 0, rows[i], lastCell));\r\n            }\r\n            return ranges;\r\n        }\r\n\r\n        function getSelectedRows() {\r\n            if (!selectionModel) {\r\n                throw \"Selection model is not set\";\r\n            }\r\n            return selectedRows;\r\n        }\r\n\r\n        function setSelectedRows(rows) {\r\n            if (!selectionModel) {\r\n                throw \"Selection model is not set\";\r\n            }\r\n            selectionModel.setSelectedRanges(rowsToRanges(rows));\r\n        }\r\n\r\n\r\n        //////////////////////////////////////////////////////////////////////////////////////////////\r\n        // Debug\r\n\r\n        this.debug = function () {\r\n            var s = \"\";\r\n\r\n            s += (\"\\n\" + \"counter_rows_rendered:  \" + counter_rows_rendered);\r\n            s += (\"\\n\" + \"counter_rows_removed:  \" + counter_rows_removed);\r\n            s += (\"\\n\" + \"renderedRows:  \" + renderedRows);\r\n            s += (\"\\n\" + \"numVisibleRows:  \" + numVisibleRows);\r\n            s += (\"\\n\" + \"maxSupportedCssHeight:  \" + maxSupportedCssHeight);\r\n            s += (\"\\n\" + \"n(umber of pages):  \" + n);\r\n            s += (\"\\n\" + \"(current) page:  \" + page);\r\n            s += (\"\\n\" + \"page height (ph):  \" + ph);\r\n            s += (\"\\n\" + \"scrollDir:  \" + scrollDir);\r\n\r\n            alert(s);\r\n        };\r\n\r\n        // a debug helper to be able to access private members\r\n        this.eval = function (expr) {\r\n            return eval(expr);\r\n        };\r\n\r\n        //////////////////////////////////////////////////////////////////////////////////////////////\r\n        // Public API\r\n\r\n        $.extend(this, {\r\n            \"slickGridVersion\": \"2.0\",\r\n\r\n            // Events\r\n            \"onScroll\": new Slick.Event(),\r\n            \"onSort\": new Slick.Event(),\r\n            \"onHeaderContextMenu\": new Slick.Event(),\r\n            \"onHeaderClick\": new Slick.Event(),\r\n            \"onMouseEnter\": new Slick.Event(),\r\n            \"onMouseLeave\": new Slick.Event(),\r\n            \"onClick\": new Slick.Event(),\r\n            \"onDblClick\": new Slick.Event(),\r\n            \"onContextMenu\": new Slick.Event(),\r\n            \"onKeyDown\": new Slick.Event(),\r\n            \"onAddNewRow\": new Slick.Event(),\r\n            \"onValidationError\": new Slick.Event(),\r\n            \"onViewportChanged\": new Slick.Event(),\r\n            \"onColumnsReordered\": new Slick.Event(),\r\n            \"onColumnsResized\": new Slick.Event(),\r\n            \"onCellChange\": new Slick.Event(),\r\n            \"onBeforeEditCell\": new Slick.Event(),\r\n            \"onBeforeCellEditorDestroy\": new Slick.Event(),\r\n            \"onBeforeDestroy\": new Slick.Event(),\r\n            \"onActiveCellChanged\": new Slick.Event(),\r\n            \"onActiveCellPositionChanged\": new Slick.Event(),\r\n            \"onDragInit\": new Slick.Event(),\r\n            \"onDragStart\": new Slick.Event(),\r\n            \"onDrag\": new Slick.Event(),\r\n            \"onDragEnd\": new Slick.Event(),\r\n            \"onSelectedRowsChanged\": new Slick.Event(),\r\n            \"onCellCssStylesChanged\": new Slick.Event(),\r\n\r\n            // Methods\r\n            \"registerPlugin\": registerPlugin,\r\n            \"unregisterPlugin\": unregisterPlugin,\r\n            \"getColumns\": getColumns,\r\n            \"setColumns\": setColumns,\r\n            \"getColumnIndex\": getColumnIndex,\r\n            \"updateColumnHeader\": updateColumnHeader,\r\n            \"setSortColumn\": setSortColumn,\r\n            \"setSortColumns\": setSortColumns,\r\n            \"getSortColumns\": getSortColumns,\r\n            \"autosizeColumns\": autosizeColumns,\r\n            \"getOptions\": getOptions,\r\n            \"setOptions\": setOptions,\r\n            \"getData\": getData,\r\n            \"getDataLength\": getDataLength,\r\n            \"getDataItem\": getDataItem,\r\n            \"setDataItem\": setDataItem,\r\n            \"setData\": setData,\r\n            \"getSelectionModel\": getSelectionModel,\r\n            \"setSelectionModel\": setSelectionModel,\r\n            \"getSelectedRows\": getSelectedRows,\r\n            \"setSelectedRows\": setSelectedRows,\r\n\r\n            \"render\": render,\r\n            \"invalidate\": invalidate,\r\n            \"invalidateRow\": invalidateRow,\r\n            \"invalidateRows\": invalidateRows,\r\n            \"invalidateAllRows\": invalidateAllRows,\r\n            \"updateCell\": updateCell,\r\n            \"updateRow\": updateRow,\r\n            \"getViewport\": getVisibleRange,\r\n            \"getRenderedRange\": getRenderedRange,\r\n            \"scrollToRow\": scrollToRow,\r\n            \"resizeCanvas\": resizeCanvas,\r\n            \"updateRowCount\": updateRowCount,\r\n            \"scrollRowIntoView\": scrollRowIntoView,\r\n            \"getCanvasNode\": getCanvasNode,\r\n            \"measureHeights\":  measureHeights,\r\n\r\n            \"getCellFromPoint\": getCellFromPoint,\r\n            \"getCellFromEvent\": getCellFromEvent,\r\n            \"getActiveCell\": getActiveCell,\r\n            \"setActiveCell\": setActiveCell,\r\n            \"getActiveCellNode\": getActiveCellNode,\r\n            \"getActiveCellPosition\": getActiveCellPosition,\r\n            \"resetActiveCell\": resetActiveCell,\r\n            \"editActiveCell\": makeActiveCellEditable,\r\n            \"getCellEditor\": getCellEditor,\r\n            \"getCellNode\": getCellNode,\r\n            \"getCellNodeBox\": getCellNodeBox,\r\n            \"canCellBeSelected\": canCellBeSelected,\r\n            \"canCellBeActive\": canCellBeActive,\r\n            \"navigatePrev\": navigatePrev,\r\n            \"navigateNext\": navigateNext,\r\n            \"navigateUp\": navigateUp,\r\n            \"navigateDown\": navigateDown,\r\n            \"navigateLeft\": navigateLeft,\r\n            \"navigateRight\": navigateRight,\r\n            \"gotoCell\": gotoCell,\r\n            \"getTopPanel\": getTopPanel,\r\n            \"showTopPanel\": showTopPanel,\r\n            \"hideTopPanel\": hideTopPanel,\r\n            \"showHeaderRowColumns\": showHeaderRowColumns,\r\n            \"hideHeaderRowColumns\": hideHeaderRowColumns,\r\n            \"getHeaderRow\": getHeaderRow,\r\n            \"getHeaderRowColumn\": getHeaderRowColumn,\r\n            \"getGridPosition\": getGridPosition,\r\n            \"flashCell\": flashCell,\r\n            \"addCellCssStyles\": addCellCssStyles,\r\n            \"setCellCssStyles\": setCellCssStyles,\r\n            \"removeCellCssStyles\": removeCellCssStyles,\r\n            \"getCellCssStyles\": getCellCssStyles,\r\n\r\n            \"init\": finishInitialization,\r\n            \"destroy\": destroy,\r\n\r\n            // IEditor implementation\r\n            \"getEditorLock\": getEditorLock,\r\n            \"getEditController\": getEditController\r\n        });\r\n\r\n        init();\r\n    }\r\n}(jQuery));","(function ($) {\r\n  $.extend(true, window, {\r\n    Slick: {\r\n      Data: {\r\n        GroupItemMetadataProvider: GroupItemMetadataProvider\r\n      }\r\n    }\r\n  });\r\n\r\n\r\n  /***\r\n   * Provides item metadata for group (Slick.Group) and totals (Slick.Totals) rows produced by the DataView.\r\n   * This metadata overrides the default behavior and formatting of those rows so that they appear and function\r\n   * correctly when processed by the grid.\r\n   *\r\n   * This class also acts as a grid plugin providing event handlers to expand & collapse groups.\r\n   * If \"grid.registerPlugin(...)\" is not called, expand & collapse will not work.\r\n   *\r\n   * @class GroupItemMetadataProvider\r\n   * @module Data\r\n   * @namespace Slick.Data\r\n   * @constructor\r\n   * @param options\r\n   */\r\n  function GroupItemMetadataProvider(options) {\r\n    var _grid;\r\n    var _defaults = {\r\n      groupCssClass: \"slick-group\",\r\n      totalsCssClass: \"slick-group-totals\",\r\n      groupFocusable: true,\r\n      totalsFocusable: false,\r\n      toggleCssClass: \"slick-group-toggle\",\r\n      toggleExpandedCssClass: \"expanded\",\r\n      toggleCollapsedCssClass: \"collapsed\",\r\n      enableExpandCollapse: true,\r\n      indent: 18\r\n    };\r\n\r\n    options = $.extend(true, {}, _defaults, options);\r\n\r\n\r\n    function defaultGroupCellFormatter(row, cell, value, columnDef, item) {\r\n      if (!options.enableExpandCollapse) {\r\n        return item.title;\r\n      }\r\n\r\n        var level = 0;\r\n        if (item.level)\r\n            level = item.level;\r\n\r\n        return \"<span class='\" + options.toggleCssClass + \" \" +\r\n            (item.collapsed ? options.toggleCollapsedCssClass : options.toggleExpandedCssClass) +\r\n            \"' style='margin-left:\" + level * options.indent + \"px'></span><span class='\" + options.toggleCssClass+ \"'>\" + item.title + \"</span>\";\r\n    }\r\n\r\n    function defaultTotalsCellFormatter(row, cell, value, columnDef, item) {\r\n      return (columnDef.groupTotalsFormatter && columnDef.groupTotalsFormatter(item, columnDef)) || \"\";\r\n    }\r\n\r\n\r\n    function init(grid) {\r\n      _grid = grid;\r\n      _grid.onClick.subscribe(handleGridClick);\r\n      _grid.onKeyDown.subscribe(handleGridKeyDown);\r\n\r\n    }\r\n\r\n    function destroy() {\r\n      if (_grid) {\r\n        _grid.onClick.unsubscribe(handleGridClick);\r\n        _grid.onKeyDown.unsubscribe(handleGridKeyDown);\r\n      }\r\n    }\r\n\r\n    function handleGridClick(e, args) {\r\n      var item = this.getDataItem(args.row);\r\n      if (item && item instanceof Slick.Group && $(e.target).hasClass(options.toggleCssClass)) {\r\n        if (item.collapsed) {\r\n          this.getData().expandGroup(item);\r\n        }\r\n        else {\r\n          this.getData().collapseGroup(item);\r\n        }\r\n\r\n        e.stopImmediatePropagation();\r\n        e.preventDefault();\r\n      }\r\n    }\r\n\r\n    // TODO:  add -/+ handling\r\n    function handleGridKeyDown(e, args) {\r\n      if (options.enableExpandCollapse && (e.which == $.ui.keyCode.SPACE)) {\r\n        var activeCell = this.getActiveCell();\r\n        if (activeCell) {\r\n          var item = this.getDataItem(activeCell.row);\r\n          if (item && item instanceof Slick.Group) {\r\n            if (item.collapsed) {\r\n              this.getData().expandGroup(item);\r\n            }\r\n            else {\r\n              this.getData().collapseGroup(item);\r\n            }\r\n\r\n            e.stopImmediatePropagation();\r\n            e.preventDefault();\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    function getGroupRowMetadata(item) {\r\n      return {\r\n        selectable: false,\r\n        focusable: options.groupFocusable,\r\n        cssClasses: options.groupCssClass,\r\n        columns: {\r\n          0: {\r\n            colspan: \"*\",\r\n            formatter: defaultGroupCellFormatter,\r\n            editor: null\r\n          }\r\n        }\r\n      };\r\n    }\r\n\r\n    function getTotalsRowMetadata(item) {\r\n      return {\r\n        selectable: false,\r\n        focusable: options.totalsFocusable,\r\n        cssClasses: options.totalsCssClass,\r\n        formatter: defaultTotalsCellFormatter,\r\n        editor: null\r\n      };\r\n    }\r\n\r\n\r\n    return {\r\n      \"init\": init,\r\n      \"destroy\": destroy,\r\n      \"getGroupRowMetadata\": getGroupRowMetadata,\r\n      \"getTotalsRowMetadata\": getTotalsRowMetadata\r\n    };\r\n  }\r\n})(jQuery);","(function ($) {\r\n    $.extend(true, window, {\r\n        Slick: {\r\n            Data: {\r\n                DataView: DataView,\r\n                Aggregators: {\r\n                    Avg: AvgAggregator,\r\n                    Min: MinAggregator,\r\n                    Max: MaxAggregator,\r\n                    Sum: SumAggregator\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    /***\r\n    * A sample Model implementation.\r\n    * Provides a filtered view of the underlying data.\r\n    *\r\n    * Relies on the data item having an \"id\" property uniquely identifying it.\r\n    */\r\n    function DataView(options) {\r\n        var self = this;\r\n\r\n        var defaults = {\r\n            groupItemMetadataProvider: null,\r\n            inlineFilters: false\r\n        };\r\n\r\n\r\n        // private\r\n        var idProperty = \"id\";  // property holding a unique row id\r\n        var items = [];         // data by index\r\n        var rows = [];          // data by row\r\n        var idxById = {};       // indexes by id\r\n        var rowsById = null;    // rows by id; lazy-calculated\r\n        var filter = null;      // filter function\r\n        var updated = null;     // updated item ids\r\n        var suspend = false;    // suspends the recalculation\r\n        var sortAsc = true;\r\n        var fastSortField;\r\n        var sortComparer;\r\n        var refreshHints = {};\r\n        var prevRefreshHints = {};\r\n        var filterArgs;\r\n        var filteredItems = [];\r\n        var compiledFilter;\r\n        var compiledFilterWithCaching;\r\n        var filterCache = [];\r\n\r\n        // grouping\r\n        //var groupingGetter;\r\n        //var groupingGetterIsAFn;\r\n        //var groupingFormatter;\r\n        //var groupingComparer;\r\n        var groupings = [];\r\n        var groups = [];\r\n        var collapsedGroups = {};\r\n        var aggregators;\r\n        var aggregateCollapsed = true;\r\n        var compiledAccumulators;\r\n\r\n        var pagesize = 0;\r\n        var pagenum = 0;\r\n        var totalRows = 0;\r\n\r\n        // events\r\n        var onRowCountChanged = new Slick.Event();\r\n        var onRowsChanged = new Slick.Event();\r\n        var onPagingInfoChanged = new Slick.Event();\r\n\r\n        options = $.extend(true, {}, defaults, options);\r\n\r\n\r\n        function beginUpdate() {\r\n            suspend = true;\r\n        }\r\n\r\n        function endUpdate() {\r\n            suspend = false;\r\n            refresh();\r\n        }\r\n\r\n        function setRefreshHints(hints) {\r\n            refreshHints = hints;\r\n        }\r\n\r\n        function setFilterArgs(args) {\r\n            filterArgs = args;\r\n        }\r\n        function getFilterArgs() {\r\n            return filterArgs;\r\n        }\r\n\r\n        function updateIdxById(startingIndex) {\r\n            startingIndex = startingIndex || 0;\r\n            var id;\r\n            for (var i = startingIndex, l = items.length; i < l; i++) {\r\n                id = items[i][idProperty];\r\n                if (id === undefined) {\r\n                    throw \"Each data element must implement a unique 'id' property\";\r\n                }\r\n                idxById[id] = i;\r\n            }\r\n        }\r\n\r\n        function ensureIdUniqueness() {\r\n            var id;\r\n            for (var i = 0, l = items.length; i < l; i++) {\r\n                id = items[i][idProperty];\r\n                if (id === undefined || idxById[id] !== i) {\r\n                    throw \"Each data element must implement a unique 'id' property\";\r\n                }\r\n            }\r\n        }\r\n\r\n        function getItems() {\r\n            return items;\r\n        }\r\n\r\n        function setItems(data, objectIdProperty) {\r\n            if (objectIdProperty !== undefined) {\r\n                idProperty = objectIdProperty;\r\n            }\r\n            items = filteredItems = data;\r\n            idxById = {};\r\n            updateIdxById();\r\n            ensureIdUniqueness();\r\n            refresh();\r\n        }\r\n\r\n        function setPagingOptions(args) {\r\n            if (args.pageSize != undefined) {\r\n                pagesize = args.pageSize;\r\n                pagenum = Math.min(pagenum, Math.ceil(totalRows / pagesize));\r\n            }\r\n\r\n            if (args.pageNum != undefined) {\r\n                pagenum = Math.min(args.pageNum, Math.ceil(totalRows / pagesize));\r\n            }\r\n\r\n            onPagingInfoChanged.notify(getPagingInfo(), null, self);\r\n\r\n            refresh();\r\n        }\r\n\r\n        function getPagingInfo() {\r\n            return { pageSize: pagesize, pageNum: pagenum, totalRows: totalRows };\r\n        }\r\n\r\n        function sort(comparer, ascending) {\r\n            sortAsc = ascending;\r\n            sortComparer = comparer;\r\n            fastSortField = null;\r\n            if (ascending === false) {\r\n                items.reverse();\r\n            }\r\n            items.sort(comparer);\r\n            if (ascending === false) {\r\n                items.reverse();\r\n            }\r\n            idxById = {};\r\n            updateIdxById();\r\n            refresh();\r\n        }\r\n\r\n        /***\r\n        * Provides a workaround for the extremely slow sorting in IE.\r\n        * Does a [lexicographic] sort on a give column by temporarily overriding Object.prototype.toString\r\n        * to return the value of that field and then doing a native Array.sort().\r\n        */\r\n        function fastSort(field, ascending) {\r\n            sortAsc = ascending;\r\n            fastSortField = field;\r\n            sortComparer = null;\r\n            var oldToString = Object.prototype.toString;\r\n            Object.prototype.toString = (typeof field == \"function\") ? field : function () {\r\n                return this[field]\r\n            };\r\n            // an extra reversal for descending sort keeps the sort stable\r\n            // (assuming a stable native sort implementation, which isn't true in some cases)\r\n            if (ascending === false) {\r\n                items.reverse();\r\n            }\r\n            items.sort();\r\n            Object.prototype.toString = oldToString;\r\n            if (ascending === false) {\r\n                items.reverse();\r\n            }\r\n            idxById = {};\r\n            updateIdxById();\r\n            refresh();\r\n        }\r\n\r\n        function reSort() {\r\n            if (sortComparer) {\r\n                sort(sortComparer, sortAsc);\r\n            } else if (fastSortField) {\r\n                fastSort(fastSortField, sortAsc);\r\n            }\r\n        }\r\n\r\n        function setFilter(filterFn) {\r\n            filter = filterFn;\r\n            if (options.inlineFilters) {\r\n                compiledFilter = compileFilter();\r\n                compiledFilterWithCaching = compileFilterWithCaching();\r\n            }\r\n            refresh();\r\n        }\r\n\r\n        function groupBy(groupingsArray) {\r\n            if (!options.groupItemMetadataProvider) {\r\n                options.groupItemMetadataProvider = new Slick.Data.GroupItemMetadataProvider();\r\n            }\r\n\r\n            groupings = [];\r\n\r\n            if (jQuery.isArray(groupingsArray)) {\r\n                var i, g;\r\n                var grouping;\r\n                for (i = 0; i < groupingsArray.length; i++) {\r\n                    g = groupingsArray[i];\r\n                    grouping = {};\r\n                    grouping.Getter = g.Getter;\r\n                    grouping.GetterIsAFn = typeof grouping.Getter === \"function\";\r\n                    grouping.Formatter = g.Formatter;\r\n                    grouping.Comparer = g.Comparer;\r\n                    groupings.push(grouping);\r\n                }\r\n            }\r\n            collapsedGroups = {};\r\n            groups = [];\r\n            refresh();\r\n        }\r\n\r\n        function getGroupPath(group) {\r\n            var path = group.value;\r\n\r\n            var g = group.parent;\r\n            while (g) {\r\n                path = g.value + '\\\\' + path;\r\n                g = g.parent;\r\n            }\r\n\r\n            return path;\r\n        }\r\n\r\n        function setAggregators(groupAggregators, includeCollapsed) {\r\n            aggregators = groupAggregators;\r\n            aggregateCollapsed = (includeCollapsed !== undefined)\r\n          ? includeCollapsed : aggregateCollapsed;\r\n\r\n            // pre-compile accumulator loops\r\n            compiledAccumulators = [];\r\n            var idx = aggregators.length;\r\n            while (idx--) {\r\n                compiledAccumulators[idx] = compileAccumulatorLoop(aggregators[idx]);\r\n            }\r\n\r\n            refresh();\r\n        }\r\n\r\n        function getItemByIdx(i) {\r\n            return items[i];\r\n        }\r\n\r\n        function getIdxById(id) {\r\n            return idxById[id];\r\n        }\r\n\r\n        function ensureRowsByIdCache() {\r\n            if (!rowsById) {\r\n                rowsById = {};\r\n                for (var i = 0, l = rows.length; i < l; i++) {\r\n                    rowsById[rows[i][idProperty]] = i;\r\n                }\r\n            }\r\n        }\r\n\r\n        function getRowById(id) {\r\n            ensureRowsByIdCache();\r\n            return rowsById[id];\r\n        }\r\n\r\n        function getItemById(id) {\r\n            return items[idxById[id]];\r\n        }\r\n\r\n        function mapIdsToRows(idArray) {\r\n            var rows = [];\r\n            ensureRowsByIdCache();\r\n            for (var i = 0, l = idArray.length; i < l; i++) {\r\n                var row = rowsById[idArray[i]];\r\n                if (row != null) {\r\n                    rows[rows.length] = row;\r\n                }\r\n            }\r\n            return rows;\r\n        }\r\n\r\n        function mapRowsToIds(rowArray) {\r\n            var ids = [];\r\n            for (var i = 0, l = rowArray.length; i < l; i++) {\r\n                if (rowArray[i] < rows.length) {\r\n                    ids[ids.length] = rows[rowArray[i]][idProperty];\r\n                }\r\n            }\r\n            return ids;\r\n        }\r\n\r\n        function updateItem(id, item) {\r\n            if (idxById[id] === undefined || id !== item[idProperty]) {\r\n                throw \"Invalid or non-matching id\";\r\n            }\r\n            items[idxById[id]] = item;\r\n            if (!updated) {\r\n                updated = {};\r\n            }\r\n            updated[id] = true;\r\n            refresh();\r\n        }\r\n\r\n        function insertItem(insertBefore, item) {\r\n            items.splice(insertBefore, 0, item);\r\n            updateIdxById(insertBefore);\r\n            refresh();\r\n        }\r\n\r\n        function addItem(item) {\r\n            items.push(item);\r\n            updateIdxById(items.length - 1);\r\n            refresh();\r\n        }\r\n\r\n        function deleteItem(id) {\r\n            var idx = idxById[id];\r\n            if (idx === undefined) {\r\n                throw \"Invalid id\";\r\n            }\r\n            delete idxById[id];\r\n            items.splice(idx, 1);\r\n            updateIdxById(idx);\r\n            refresh();\r\n        }\r\n\r\n        function getLength() {\r\n            return rows.length;\r\n        }\r\n\r\n        function getItem(i) {\r\n            return rows[i];\r\n        }\r\n\r\n        function setItem(i, value) {\r\n            rows[i] = value;\r\n        }\r\n\r\n        function getItemMetadata(i) {\r\n            var item = rows[i];\r\n            if (item === undefined) {\r\n                return null;\r\n            }\r\n\r\n            // overrides for group rows\r\n            if (item.__group) {\r\n                return options.groupItemMetadataProvider.getGroupRowMetadata(item);\r\n            }\r\n\r\n            // overrides for totals rows\r\n            if (item.__groupTotals) {\r\n                return options.groupItemMetadataProvider.getTotalsRowMetadata(item);\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        function setCollapsedGroups(newCollapsedGroups) {\r\n            collapsedGroups = newCollapsedGroups;\r\n            refresh();\r\n        }\r\n\r\n        function collapseGroup(group, recursive) {\r\n            collapsedGroups[getGroupPath(group)] = true;\r\n\r\n            if (recursive === true)\r\n                for (var i = 0, l = group.groups.length; i < l; i++)\r\n                    collapseGroup(group.groups[i], recursive);\r\n\r\n            refresh();\r\n        }\r\n\r\n        function expandGroup(group, recursive) {\r\n            delete collapsedGroups[getGroupPath(group)];\r\n            \r\n            if (recursive === true)\r\n                for (var i = 0, l = group.groups.length; i < l; i++)\r\n                    expandGroup(group.groups[i], recursive);\r\n\r\n            refresh();\r\n        }\r\n\r\n        function getGroups() {\r\n            return groups;\r\n        }\r\n\r\n        function extractGroups(rows) {\r\n            var group, g;\r\n            var val;\r\n            var groups = [];\r\n            var groupsByVal = {};\r\n            var r;\r\n\r\n            for (var i = 0, l = rows.length; i < l; i++) {\r\n                r = rows[i];\r\n\r\n                var parent = null;\r\n                for (var j = 0; j < groupings.length; j++) {\r\n                    var grouping = groupings[j];\r\n                    val = (grouping.GetterIsAFn) ? grouping.Getter(r) : r[grouping.Getter];\r\n                    val = val || 0;\r\n                    if (parent)\r\n                        group = parent.groupsByVal[val];\r\n                    else\r\n                        group = groupsByVal[val];\r\n\r\n                    if (!group) {\r\n                        group = new Slick.Group();\r\n                        group.parent = parent;\r\n                        group.level = j;\r\n                        group.count = 0;\r\n                        group.totalCount = 0;\r\n                        group.value = val;\r\n                        group.rows = [];\r\n                        group.groups = [];\r\n                        group.groupsByVal = {};\r\n                        if (!parent) {\r\n                            groups[groups.length] = group;\r\n                            groupsByVal[val] = group;\r\n                        } else {\r\n                            parent.groups[parent.groups.length] = group;\r\n                            parent.groupsByVal[val] = group;\r\n                        }\r\n                    }\r\n                    parent = group;\r\n                }\r\n                group.rows[group.count++] = r;\r\n                group.totalCount++;\r\n                g = group.parent;\r\n                while (g != null) {\r\n                    g.totalCount++;\r\n                    g = g.parent;\r\n                }\r\n            }\r\n\r\n            return groups;\r\n        }\r\n\r\n        // TODO:  lazy totals calculation\r\n        function calculateGroupTotals(group) {\r\n            if (group.collapsed && !aggregateCollapsed) {\r\n                return;\r\n            }\r\n\r\n            // TODO:  try moving iterating over groups into compiled accumulator\r\n            var totals = new Slick.GroupTotals();\r\n            var agg, idx = aggregators.length;\r\n            while (idx--) {\r\n                agg = aggregators[idx];\r\n                agg.init();\r\n                compiledAccumulators[idx].call(agg, group.rows);\r\n                agg.storeResult(totals);\r\n                if (group.groups && group.groups.length > 0) {\r\n                    calculateTotals(group.groups);\r\n                    compiledAccumulators[idx].call(agg, group.groups);\r\n                    agg.storeResult(totals);\r\n                }\r\n            }\r\n            totals.group = group;\r\n            group.totals = totals;\r\n        }\r\n\r\n        function calculateTotals(groups) {\r\n            var idx = groups.length;\r\n            while (idx--) {\r\n                calculateGroupTotals(groups[idx]);\r\n            }\r\n        }\r\n\r\n        function finalizeGroups(groups, l) {\r\n            if (!l) l = 0;\r\n            var grouping = groupings[l];\r\n            var idx = groups.length, g;\r\n            while (idx--) {\r\n                g = groups[idx];\r\n                g.collapsed = (getGroupPath(g) in collapsedGroups);\r\n                g.title = grouping.Formatter ? grouping.Formatter(g) : g.value;\r\n\r\n                finalizeGroups(g.groups, l + 1);\r\n            }\r\n        }\r\n\r\n        function flattenGroups(groups, groupedRows) {\r\n            var g;\r\n            for (var i = 0, l = groups.length; i < l; i++) {\r\n                g = groups[i];\r\n                groupedRows[groupedRows.length] = g;\r\n\r\n                if (!g.collapsed) {\r\n\r\n                    if (g.groups)\r\n                        flattenGroups(g.groups, groupedRows);\r\n\r\n                    for (var j = 0, jj = g.rows.length; j < jj; j++) {\r\n                        groupedRows[groupedRows.length] = g.rows[j];\r\n                    }\r\n                }\r\n\r\n                if (g.totals && (!g.collapsed || aggregateCollapsed)) {\r\n                    groupedRows[groupedRows.length] = g.totals;\r\n                }\r\n            }\r\n            return groupedRows;\r\n        }\r\n\r\n        function flattenGroupedRows(groups) {\r\n            var groupedRows = [];\r\n            flattenGroups(groups, groupedRows);\r\n            return groupedRows;\r\n        }\r\n\r\n        function getFunctionInfo(fn) {\r\n            var fnRegex = /^function[^(]*\\(([^)]*)\\)\\s*{([\\s\\S]*)}$/;\r\n            var matches = fn.toString().match(fnRegex);\r\n            return {\r\n                params: matches[1].split(\",\"),\r\n                body: matches[2]\r\n            };\r\n        }\r\n\r\n        function compileAccumulatorLoop(aggregator) {\r\n            var accumulatorInfo = getFunctionInfo(aggregator.accumulate);\r\n            var fn = new Function(\r\n          \"_items\",\r\n          \"for (var \" + accumulatorInfo.params[0] + \", _i=0, _il=_items.length; _i<_il; _i++) {\" +\r\n              accumulatorInfo.params[0] + \" = _items[_i]; \" +\r\n              accumulatorInfo.body +\r\n              \"}\"\r\n      );\r\n            fn.displayName = fn.name = \"compiledAccumulatorLoop\";\r\n            return fn;\r\n        }\r\n\r\n        function compileFilter() {\r\n            var filterInfo = getFunctionInfo(filter);\r\n\r\n            var filterBody = filterInfo.body\r\n          .replace(/return false[;}]/gi, \"{ continue _coreloop; }\")\r\n          .replace(/return true[;}]/gi, \"{ _retval[_idx++] = $item$; continue _coreloop; }\")\r\n          .replace(/return ([^;}]+?);/gi,\r\n          \"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }\");\r\n\r\n            // This preserves the function template code after JS compression,\r\n            // so that replace() commands still work as expected.\r\n            var tpl = [\r\n            //\"function(_items, _args) { \",\r\n        \"var _retval = [], _idx = 0; \",\r\n        \"var $item$, $args$ = _args; \",\r\n        \"_coreloop: \",\r\n        \"for (var _i = 0, _il = _items.length; _i < _il; _i++) { \",\r\n        \"$item$ = _items[_i]; \",\r\n        \"$filter$; \",\r\n        \"} \",\r\n        \"return _retval; \"\r\n            //\"}\"\r\n      ].join(\"\");\r\n            tpl = tpl.replace(/\\$filter\\$/gi, filterBody);\r\n            tpl = tpl.replace(/\\$item\\$/gi, filterInfo.params[0]);\r\n            tpl = tpl.replace(/\\$args\\$/gi, filterInfo.params[1]);\r\n\r\n            var fn = new Function(\"_items,_args\", tpl);\r\n            fn.displayName = fn.name = \"compiledFilter\";\r\n            return fn;\r\n        }\r\n\r\n        function compileFilterWithCaching() {\r\n            var filterInfo = getFunctionInfo(filter);\r\n\r\n            var filterBody = filterInfo.body\r\n          .replace(/return false[;}]/gi, \"{ continue _coreloop; }\")\r\n          .replace(/return true[;}]/gi, \"{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }\")\r\n          .replace(/return ([^;}]+?);/gi,\r\n          \"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }\");\r\n\r\n            // This preserves the function template code after JS compression,\r\n            // so that replace() commands still work as expected.\r\n            var tpl = [\r\n            //\"function(_items, _args, _cache) { \",\r\n        \"var _retval = [], _idx = 0; \",\r\n        \"var $item$, $args$ = _args; \",\r\n        \"_coreloop: \",\r\n        \"for (var _i = 0, _il = _items.length; _i < _il; _i++) { \",\r\n        \"$item$ = _items[_i]; \",\r\n        \"if (_cache[_i]) { \",\r\n        \"_retval[_idx++] = $item$; \",\r\n        \"continue _coreloop; \",\r\n        \"} \",\r\n        \"$filter$; \",\r\n        \"} \",\r\n        \"return _retval; \"\r\n            //\"}\"\r\n      ].join(\"\");\r\n            tpl = tpl.replace(/\\$filter\\$/gi, filterBody);\r\n            tpl = tpl.replace(/\\$item\\$/gi, filterInfo.params[0]);\r\n            tpl = tpl.replace(/\\$args\\$/gi, filterInfo.params[1]);\r\n\r\n            var fn = new Function(\"_items,_args,_cache\", tpl);\r\n            fn.displayName = fn.name = \"compiledFilterWithCaching\";\r\n            return fn;\r\n        }\r\n\r\n        function uncompiledFilter(items, args) {\r\n            var retval = [], idx = 0;\r\n\r\n            for (var i = 0, ii = items.length; i < ii; i++) {\r\n                if (filter(items[i], args)) {\r\n                    retval[idx++] = items[i];\r\n                }\r\n            }\r\n\r\n            return retval;\r\n        }\r\n\r\n        function uncompiledFilterWithCaching(items, args, cache) {\r\n            var retval = [], idx = 0, item;\r\n\r\n            for (var i = 0, ii = items.length; i < ii; i++) {\r\n                item = items[i];\r\n                if (cache[i]) {\r\n                    retval[idx++] = item;\r\n                } else if (filter(item, args)) {\r\n                    retval[idx++] = item;\r\n                    cache[i] = true;\r\n                }\r\n            }\r\n\r\n            return retval;\r\n        }\r\n\r\n        function getFilteredAndPagedItems(items) {\r\n            if (filter) {\r\n                var batchFilter = options.inlineFilters ? compiledFilter : uncompiledFilter;\r\n                var batchFilterWithCaching = options.inlineFilters ? compiledFilterWithCaching : uncompiledFilterWithCaching;\r\n\r\n                if (refreshHints.isFilterNarrowing) {\r\n                    filteredItems = batchFilter(filteredItems, filterArgs);\r\n                } else if (refreshHints.isFilterExpanding) {\r\n                    filteredItems = batchFilterWithCaching(items, filterArgs, filterCache);\r\n                } else if (!refreshHints.isFilterUnchanged) {\r\n                    filteredItems = batchFilter(items, filterArgs);\r\n                }\r\n            } else {\r\n                // special case:  if not filtering and not paging, the resulting\r\n                // rows collection needs to be a copy so that changes due to sort\r\n                // can be caught\r\n                filteredItems = pagesize ? items : items.concat();\r\n            }\r\n\r\n            // get the current page\r\n            var paged;\r\n            if (pagesize) {\r\n                if (filteredItems.length < pagenum * pagesize) {\r\n                    pagenum = Math.floor(filteredItems.length / pagesize);\r\n                }\r\n                paged = filteredItems.slice(pagesize * pagenum, pagesize * pagenum + pagesize);\r\n            } else {\r\n                paged = filteredItems;\r\n            }\r\n\r\n            return { totalRows: filteredItems.length, rows: paged };\r\n        }\r\n\r\n        function getRowDiffs(rows, newRows) {\r\n            var item, r, eitherIsNonData, diff = [];\r\n            var from = 0, to = newRows.length;\r\n\r\n            if (refreshHints && refreshHints.ignoreDiffsBefore) {\r\n                from = Math.max(0,\r\n            Math.min(newRows.length, refreshHints.ignoreDiffsBefore));\r\n            }\r\n\r\n            if (refreshHints && refreshHints.ignoreDiffsAfter) {\r\n                to = Math.min(newRows.length,\r\n            Math.max(0, refreshHints.ignoreDiffsAfter));\r\n            }\r\n\r\n            for (var i = from, rl = rows.length; i < to; i++) {\r\n                if (i >= rl) {\r\n                    diff[diff.length] = i;\r\n                } else {\r\n                    item = newRows[i];\r\n                    r = rows[i];\r\n\r\n                    if ((groupings.length > 0 && (eitherIsNonData = (item.__nonDataRow) || (r.__nonDataRow)) &&\r\n              item.__group !== r.__group ||\r\n              item.__updated ||\r\n              item.__group && !item.equals(r))\r\n              || (aggregators && eitherIsNonData &&\r\n                    // no good way to compare totals since they are arbitrary DTOs\r\n                    // deep object comparison is pretty expensive\r\n                    // always considering them 'dirty' seems easier for the time being\r\n              (item.__groupTotals || r.__groupTotals))\r\n              || item[idProperty] != r[idProperty]\r\n              || (updated && updated[item[idProperty]])\r\n              ) {\r\n                        diff[diff.length] = i;\r\n                    }\r\n                }\r\n            }\r\n            return diff;\r\n        }\r\n\r\n        function recalc(_items) {\r\n            rowsById = null;\r\n\r\n            if (refreshHints.isFilterNarrowing != prevRefreshHints.isFilterNarrowing ||\r\n          refreshHints.isFilterExpanding != prevRefreshHints.isFilterExpanding) {\r\n                filterCache = [];\r\n            }\r\n\r\n            var filteredItems = getFilteredAndPagedItems(_items);\r\n            totalRows = filteredItems.totalRows;\r\n            var newRows = filteredItems.rows;\r\n\r\n            groups = [];\r\n            if (groupings.length > 0) {\r\n                groups = extractGroups(newRows);\r\n                if (groups.length) {\r\n                    finalizeGroups(groups);\r\n                    if (aggregators) {\r\n                        calculateTotals(groups);\r\n                    }\r\n                    if (groups.sort) {\r\n                        try {\r\n                            groups.sort(groupingComparer);\r\n                        }\r\n                        catch (error) {\r\n                        }\r\n                    }\r\n                    newRows = flattenGroupedRows(groups);\r\n                }\r\n            }\r\n\r\n            var diff = getRowDiffs(rows, newRows);\r\n\r\n            rows = newRows;\r\n\r\n            return diff;\r\n        }\r\n\r\n        function refresh() {\r\n            if (suspend) {\r\n                return;\r\n            }\r\n\r\n            var countBefore = rows.length;\r\n            var totalRowsBefore = totalRows;\r\n\r\n            var diff = recalc(items, filter); // pass as direct refs to avoid closure perf hit\r\n\r\n            // if the current page is no longer valid, go to last page and recalc\r\n            // we suffer a performance penalty here, but the main loop (recalc) remains highly optimized\r\n            if (pagesize && totalRows < pagenum * pagesize) {\r\n                pagenum = Math.floor(totalRows / pagesize);\r\n                diff = recalc(items, filter);\r\n            }\r\n\r\n            updated = null;\r\n            prevRefreshHints = refreshHints;\r\n            refreshHints = {};\r\n\r\n            if (totalRowsBefore != totalRows) {\r\n                onPagingInfoChanged.notify(getPagingInfo(), null, self);\r\n            }\r\n            if (countBefore != rows.length) {\r\n                onRowCountChanged.notify({ previous: countBefore, current: rows.length }, null, self);\r\n            }\r\n            if (diff.length > 0) {\r\n                onRowsChanged.notify({ rows: diff }, null, self);\r\n            }\r\n        }\r\n\r\n        /***\r\n            * Wires the grid and the DataView together to keep row selection tied to item ids.\r\n            * This is useful since, without it, the grid only knows about rows, so if the items\r\n            * move around, the same rows stay selected instead of the selection moving along\r\n            * with the items.\r\n            *\r\n            * NOTE:  This doesn't work with cell selection model.\r\n            *\r\n            * @param grid {Slick.Grid} The grid to sync selection with.\r\n            * @param preserveHidden {Boolean} Whether to keep selected items that go out of the\r\n            *     view due to them getting filtered out.\r\n            * @param preserveHiddenOnSelectionChange {Boolean} Whether to keep selected items\r\n            *     that are currently out of the view (see preserveHidden) as selected when selection\r\n            *     changes.\r\n            * @return {Slick.Event} An event that notifies when an internal list of selected row ids\r\n            *     changes.  This is useful since, in combination with the above two options, it allows\r\n            *     access to the full list selected row ids, and not just the ones visible to the grid.\r\n            * @method syncGridSelection\r\n            */\r\n        function syncGridSelection(grid, preserveHidden, preserveHiddenOnSelectionChange) {\r\n            var self = this;\r\n            var inHandler;\r\n            var selectedRowIds = self.mapRowsToIds(grid.getSelectedRows());\r\n            var onSelectedRowIdsChanged = new Slick.Event();\r\n\r\n            function setSelectedRowIds(rowIds) {\r\n                if (selectedRowIds.join(\",\") == rowIds.join(\",\")) {\r\n                    return;\r\n                }\r\n\r\n                selectedRowIds = rowIds;\r\n\r\n                onSelectedRowIdsChanged.notify({\r\n                    \"grid\": grid,\r\n                    \"ids\": selectedRowIds\r\n                }, new Slick.EventData(), self);\r\n            }\r\n\r\n            function update() {\r\n                if (selectedRowIds.length > 0) {\r\n                    inHandler = true;\r\n                    var selectedRows = self.mapIdsToRows(selectedRowIds);\r\n                    if (!preserveHidden) {\r\n                        setSelectedRowIds(self.mapRowsToIds(selectedRows));       \r\n                    }\r\n                    grid.setSelectedRows(selectedRows);\r\n                    inHandler = false;\r\n                }\r\n            }\r\n\r\n            grid.onSelectedRowsChanged.subscribe(function(e, args) {\r\n                if (inHandler) { return; }\r\n                var newSelectedRowIds = self.mapRowsToIds(grid.getSelectedRows());\r\n                if (!preserveHiddenOnSelectionChange || !grid.getOptions().multiSelect) {\r\n                    setSelectedRowIds(newSelectedRowIds);\r\n                } else {\r\n                    // keep the ones that are hidden\r\n                    var existing = $.grep(selectedRowIds, function(id) { return self.getRowById(id) === undefined; });\r\n                    // add the newly selected ones\r\n                    setSelectedRowIds(existing.concat(newSelectedRowIds));\r\n                }\r\n            });\r\n\r\n            this.onRowsChanged.subscribe(update);\r\n\r\n            this.onRowCountChanged.subscribe(update);\r\n\r\n            return onSelectedRowIdsChanged;\r\n        }\t     \r\n \t\t \r\n\r\n        function syncGridCellCssStyles(grid, key) {\r\n            var hashById;\r\n            var inHandler;\r\n\r\n            // since this method can be called after the cell styles have been set,\r\n            // get the existing ones right away\r\n            storeCellCssStyles(grid.getCellCssStyles(key));\r\n\r\n            function storeCellCssStyles(hash) {\r\n                hashById = {};\r\n                for (var row in hash) {\r\n                    var id = rows[row][idProperty];\r\n                    hashById[id] = hash[row];\r\n                }\r\n            }\r\n\r\n            grid.onCellCssStylesChanged.subscribe(function (e, args) {\r\n                if (inHandler) { return; }\r\n                if (key != args.key) { return; }\r\n                if (args.hash) {\r\n                    storeCellCssStyles(args.hash);\r\n                }\r\n            });\r\n\r\n            this.onRowsChanged.subscribe(function (e, args) {\r\n                if (hashById) {\r\n                    inHandler = true;\r\n                    ensureRowsByIdCache();\r\n                    var newHash = {};\r\n                    for (var id in hashById) {\r\n                        var row = rowsById[id];\r\n                        if (row != undefined) {\r\n                            newHash[row] = hashById[id];\r\n                        }\r\n                    }\r\n                    grid.setCellCssStyles(key, newHash);\r\n                    inHandler = false;\r\n                }\r\n            });\r\n        }\r\n\r\n        return {\r\n            // methods\r\n            \"beginUpdate\": beginUpdate,\r\n            \"endUpdate\": endUpdate,\r\n            \"setPagingOptions\": setPagingOptions,\r\n            \"getPagingInfo\": getPagingInfo,\r\n            \"getItems\": getItems,\r\n            \"setItems\": setItems,\r\n            \"setFilter\": setFilter,\r\n            \"sort\": sort,\r\n            \"fastSort\": fastSort,\r\n            \"reSort\": reSort,\r\n            \"groupBy\": groupBy,\r\n            \"setAggregators\": setAggregators,\r\n            \"collapseGroup\": collapseGroup,\r\n            \"expandGroup\": expandGroup,\r\n            \"setCollapsedGroups\": setCollapsedGroups,\r\n            \"getGroups\": getGroups,\r\n            \"getGroupPath\": getGroupPath,\r\n            \"getIdxById\": getIdxById,\r\n            \"getRowById\": getRowById,\r\n            \"getItemById\": getItemById,\r\n            \"getItemByIdx\": getItemByIdx,\r\n            \"mapRowsToIds\": mapRowsToIds,\r\n            \"mapIdsToRows\": mapIdsToRows,\r\n            \"setRefreshHints\": setRefreshHints,\r\n            \"setFilterArgs\": setFilterArgs,\r\n            \"getFilterArgs\": getFilterArgs,\r\n            \"refresh\": refresh,\r\n            \"updateItem\": updateItem,\r\n            \"insertItem\": insertItem,\r\n            \"addItem\": addItem,\r\n            \"deleteItem\": deleteItem,\r\n            \"syncGridSelection\": syncGridSelection,\r\n            \"syncGridCellCssStyles\": syncGridCellCssStyles,\r\n\r\n            \"getFilteredAndPagedItems\": getFilteredAndPagedItems,\r\n\r\n            // data provider methods\r\n            \"getLength\": getLength,\r\n            \"getItem\": getItem,\r\n            \"setItem\": setItem,\r\n            \"getItemMetadata\": getItemMetadata,\r\n\r\n            // events\r\n            \"onRowCountChanged\": onRowCountChanged,\r\n            \"onRowsChanged\": onRowsChanged,\r\n            \"onPagingInfoChanged\": onPagingInfoChanged\r\n        };\r\n    }\r\n\r\n    function AvgAggregator(field) {\r\n        this.field_ = field;\r\n\r\n        this.init = function () {\r\n            this.count_ = 0;\r\n            this.nonNullCount_ = 0;\r\n            this.sum_ = 0;\r\n        };\r\n\r\n        this.accumulate = function (item) {\r\n            var val = item[this.field_];\r\n            this.count_++;\r\n            if (val != null && val != \"\" && val != NaN) {\r\n                this.nonNullCount_++;\r\n                this.sum_ += parseFloat(val);\r\n            }\r\n        };\r\n\r\n        this.storeResult = function (groupTotals) {\r\n            if (!groupTotals.avg) {\r\n                groupTotals.avg = {};\r\n            }\r\n            if (this.nonNullCount_ != 0) {\r\n                groupTotals.avg[this.field_] = this.sum_ / this.nonNullCount_;\r\n            }\r\n        };\r\n    }\r\n\r\n    function MinAggregator(field) {\r\n        this.field_ = field;\r\n\r\n        this.init = function () {\r\n            this.min_ = null;\r\n        };\r\n\r\n        this.accumulate = function (item) {\r\n            var val = item[this.field_];\r\n            if (val != null && val != \"\" && val != NaN) {\r\n                if (this.min_ == null || val < this.min_) {\r\n                    this.min_ = val;\r\n                }\r\n            }\r\n        };\r\n\r\n        this.storeResult = function (groupTotals) {\r\n            if (!groupTotals.min) {\r\n                groupTotals.min = {};\r\n            }\r\n            groupTotals.min[this.field_] = this.min_;\r\n        }\r\n    }\r\n\r\n    function MaxAggregator(field) {\r\n        this.field_ = field;\r\n\r\n        this.init = function () {\r\n            this.max_ = null;\r\n        };\r\n\r\n        this.accumulate = function (item) {\r\n            var val = item[this.field_];\r\n            if (val != null && val != \"\" && val != NaN) {\r\n                if (this.max_ == null || val > this.max_) {\r\n                    this.max_ = val;\r\n                }\r\n            }\r\n        };\r\n\r\n        this.storeResult = function (groupTotals) {\r\n            if (!groupTotals.max) {\r\n                groupTotals.max = {};\r\n            }\r\n            groupTotals.max[this.field_] = this.max_;\r\n        }\r\n    }\r\n\r\n    function SumAggregator(field) {\r\n        this.field_ = field;\r\n\r\n        this.init = function () {\r\n            this.sum_ = null;\r\n        };\r\n\r\n        this.accumulate = function (item) {\r\n            var val = item[this.field_];\r\n            if (val != null && val != \"\" && val != NaN) {\r\n                this.sum_ += parseFloat(val);\r\n            }\r\n        };\r\n\r\n        this.storeResult = function (groupTotals) {\r\n            if (!groupTotals.sum) {\r\n                groupTotals.sum = {};\r\n            }\r\n            groupTotals.sum[this.field_] = this.sum_;\r\n        }\r\n    }\r\n\r\n    // TODO:  add more built-in aggregators\r\n    // TODO:  merge common aggregators in one to prevent needles iterating\r\n\r\n})(jQuery);","(function ($) {\r\n  function SlickGridPager(dataView, grid, $container) {\r\n    var $status;\r\n\r\n    function init() {\r\n      dataView.onPagingInfoChanged.subscribe(function (e, pagingInfo) {\r\n        updatePager(pagingInfo);\r\n      });\r\n\r\n      constructPagerUI();\r\n      updatePager(dataView.getPagingInfo());\r\n    }\r\n\r\n    function getNavState() {\r\n      var cannotLeaveEditMode = !Slick.GlobalEditorLock.commitCurrentEdit();\r\n      var pagingInfo = dataView.getPagingInfo();\r\n      var lastPage = Math.ceil(pagingInfo.totalRows / pagingInfo.pageSize) - 1;\r\n      if (lastPage < 0) {\r\n        lastPage = 0;\r\n      }\r\n\r\n      return {\r\n        canGotoFirst: !cannotLeaveEditMode && pagingInfo.pageSize != 0 && pagingInfo.pageNum > 0,\r\n        canGotoLast: !cannotLeaveEditMode && pagingInfo.pageSize != 0 && pagingInfo.pageNum != lastPage,\r\n        canGotoPrev: !cannotLeaveEditMode && pagingInfo.pageSize != 0 && pagingInfo.pageNum > 0,\r\n        canGotoNext: !cannotLeaveEditMode && pagingInfo.pageSize != 0 && pagingInfo.pageNum < lastPage,\r\n        pagingInfo: pagingInfo,\r\n        lastPage: lastPage\r\n      }\r\n    }\r\n\r\n    function setPageSize(n) {\r\n      dataView.setRefreshHints({\r\n        isFilterUnchanged: true\r\n      });\r\n      dataView.setPagingOptions({pageSize: n});\r\n    }\r\n\r\n    function gotoFirst() {\r\n      if (getNavState().canGotoFirst) {\r\n        dataView.setPagingOptions({pageNum: 0});\r\n      }\r\n    }\r\n\r\n    function gotoLast() {\r\n      var state = getNavState();\r\n      if (state.canGotoLast) {\r\n        dataView.setPagingOptions({pageNum: state.lastPage});\r\n      }\r\n    }\r\n\r\n    function gotoPrev() {\r\n      var state = getNavState();\r\n      if (state.canGotoPrev) {\r\n        dataView.setPagingOptions({pageNum: state.pagingInfo.pageNum - 1});\r\n      }\r\n    }\r\n\r\n    function gotoNext() {\r\n      var state = getNavState();\r\n      if (state.canGotoNext) {\r\n        dataView.setPagingOptions({pageNum: state.pagingInfo.pageNum + 1});\r\n      }\r\n    }\r\n\r\n    function constructPagerUI() {\r\n      $container.empty();\r\n\r\n      var $nav = $(\"<span class='slick-pager-nav' />\").appendTo($container);\r\n      var $settings = $(\"<span class='slick-pager-settings' />\").appendTo($container);\r\n      $status = $(\"<span class='slick-pager-status' />\").appendTo($container);\r\n\r\n      $settings\r\n          .append(\"<span class='slick-pager-settings-expanded' style='display:none'>Show: <a data=0>All</a><a data='-1'>Auto</a><a data=25>25</a><a data=50>50</a><a data=100>100</a></span>\");\r\n\r\n      $settings.find(\"a[data]\").click(function (e) {\r\n        var pagesize = $(e.target).attr(\"data\");\r\n        if (pagesize != undefined) {\r\n          if (pagesize == -1) {\r\n            var vp = grid.getViewport();\r\n            setPageSize(vp.bottom - vp.top);\r\n          } else {\r\n            setPageSize(parseInt(pagesize));\r\n          }\r\n        }\r\n      });\r\n\r\n      var icon_prefix = \"<span class='ui-state-default ui-corner-all ui-icon-container'><span class='ui-icon \";\r\n      var icon_suffix = \"' /></span>\";\r\n\r\n      $(icon_prefix + \"ui-icon-lightbulb\" + icon_suffix)\r\n          .click(function () {\r\n            $(\".slick-pager-settings-expanded\").toggle()\r\n          })\r\n          .appendTo($settings);\r\n\r\n      $(icon_prefix + \"ui-icon-seek-first\" + icon_suffix)\r\n          .click(gotoFirst)\r\n          .appendTo($nav);\r\n\r\n      $(icon_prefix + \"ui-icon-seek-prev\" + icon_suffix)\r\n          .click(gotoPrev)\r\n          .appendTo($nav);\r\n\r\n      $(icon_prefix + \"ui-icon-seek-next\" + icon_suffix)\r\n          .click(gotoNext)\r\n          .appendTo($nav);\r\n\r\n      $(icon_prefix + \"ui-icon-seek-end\" + icon_suffix)\r\n          .click(gotoLast)\r\n          .appendTo($nav);\r\n\r\n      $container.find(\".ui-icon-container\")\r\n          .hover(function () {\r\n            $(this).toggleClass(\"ui-state-hover\");\r\n          });\r\n\r\n      $container.children().wrapAll(\"<div class='slick-pager' />\");\r\n    }\r\n\r\n\r\n    function updatePager(pagingInfo) {\r\n      var state = getNavState();\r\n\r\n      $container.find(\".slick-pager-nav span\").removeClass(\"ui-state-disabled\");\r\n      if (!state.canGotoFirst) {\r\n        $container.find(\".ui-icon-seek-first\").addClass(\"ui-state-disabled\");\r\n      }\r\n      if (!state.canGotoLast) {\r\n        $container.find(\".ui-icon-seek-end\").addClass(\"ui-state-disabled\");\r\n      }\r\n      if (!state.canGotoNext) {\r\n        $container.find(\".ui-icon-seek-next\").addClass(\"ui-state-disabled\");\r\n      }\r\n      if (!state.canGotoPrev) {\r\n        $container.find(\".ui-icon-seek-prev\").addClass(\"ui-state-disabled\");\r\n      }\r\n\r\n      if (pagingInfo.pageSize == 0) {\r\n        $status.text(\"Showing all \" + pagingInfo.totalRows + \" rows\");\r\n      } else {\r\n        $status.text(\"Showing page \" + (pagingInfo.pageNum + 1) + \" of \" + (state.lastPage + 1));\r\n      }\r\n    }\r\n\r\n    init();\r\n  }\r\n\r\n  // Slick.Controls.Pager\r\n  $.extend(true, window, { Slick:{ Controls:{ Pager:SlickGridPager }}});\r\n})(jQuery);\r\n","(function ($) {\r\n    function SlickColumnPicker(columns, grid, options) {\r\n        var $menu;\r\n        var columnCheckboxes;\r\n\r\n        var defaults = {\r\n            fadeSpeed: 500\r\n        };\r\n\r\n        function init() {\r\n            grid.onHeaderContextMenu.subscribe(handleHeaderContextMenu);\r\n            options = $.extend({}, defaults, options);\r\n\r\n            $menu = $(\"<span class='slick-columnpicker form-horizontal' style='display:none;position:absolute;z-index:1073;' />\").appendTo(document.body);\r\n\r\n            $menu.bind(\"mouseleave\", function (e) {\r\n                $(this).fadeOut(options.fadeSpeed)\r\n            });\r\n            $menu.bind(\"click\", updateColumn);\r\n\r\n        }\r\n\r\n        function handleHeaderContextMenu(e, args) {\r\n            e.preventDefault();\r\n            $menu.empty();\r\n            columnCheckboxes = [];\r\n\r\n            var $li, $input;\r\n            var label;\r\n            for (var i = 0; i < columns.length; i++) {\r\n                label = $('<div/>').html(columns[i].name).text();\r\n                if (!label)\r\n                    label = columns[i].toolTip;\r\n                $li = $(\"<li />\").appendTo($menu);\r\n                $input = $(\"<input type='checkbox' />\").data(\"column-id\", columns[i].id);\r\n                columnCheckboxes.push($input);\r\n\r\n                if (grid.getColumnIndex(columns[i].id) != null) {\r\n                    $input.attr(\"checked\", \"checked\");\r\n                }\r\n\r\n                $(\"<label />\")\r\n                        .text(label)\r\n                        .prepend($input)\r\n                        .appendTo($li);\r\n            }\r\n\r\n            $(\"<hr/>\").appendTo($menu);\r\n            $li = $(\"<li />\").appendTo($menu);\r\n            $input = $(\"<input type='checkbox' />\").data(\"option\", \"autoresize\");\r\n            $(\"<label />\")\r\n          .text(Globa.AllignColumnsInWindow.locale())\r\n          .prepend($input)\r\n          .appendTo($li);\r\n            if (grid.getOptions().forceFitColumns) {\r\n                $input.attr(\"checked\", \"checked\");\r\n            }\r\n\r\n            /*\r\n            $li = $(\"<li />\").appendTo($menu);\r\n            $input = $(\"<input type='checkbox' />\").data(\"option\", \"syncresize\");\r\n            $(\"<label />\")\r\n            .text(\"Synchronous resize\")\r\n            .prepend($input)\r\n            .appendTo($li);\r\n            if (grid.getOptions().syncColumnCellResize) {\r\n            $input.attr(\"checked\", \"checked\");\r\n            }\r\n            */\r\n            $menu\r\n          .css(\"top\", e.pageY - 10)\r\n          .css(\"left\", e.pageX - 10)\r\n          .fadeIn(options.fadeSpeed);\r\n        }\r\n\r\n        function updateColumn(e) {\r\n            if ($(e.target).data(\"option\") == \"autoresize\") {\r\n                if (e.target.checked) {\r\n                    grid.resizeCanvas();\r\n                    grid.setOptions({ forceFitColumns: true });\r\n                    grid.autosizeColumns();\r\n                } else {\r\n                    grid.setOptions({ forceFitColumns: false });\r\n                }\r\n                return;\r\n            }\r\n\r\n            if ($(e.target).data(\"option\") == \"syncresize\") {\r\n                if (e.target.checked) {\r\n                    grid.setOptions({ syncColumnCellResize: true });\r\n                } else {\r\n                    grid.setOptions({ syncColumnCellResize: false });\r\n                }\r\n                return;\r\n            }\r\n\r\n            if ($(e.target).is(\":checkbox\")) {\r\n                var visibleColumns = [];\r\n                $.each(columnCheckboxes, function (i, e) {\r\n                    if ($(this).is(\":checked\")) {\r\n                        visibleColumns.push(columns[i]);\r\n                    }\r\n                });\r\n\r\n                if (!visibleColumns.length) {\r\n                    $(e.target).attr(\"checked\", \"checked\");\r\n                    return;\r\n                }\r\n\r\n                grid.setColumns(visibleColumns);\r\n            }\r\n        }\r\n\r\n        init();\r\n    }\r\n\r\n    // Slick.Controls.ColumnPicker\r\n    $.extend(true, window, { Slick: { Controls: { ColumnPicker: SlickColumnPicker}} });\r\n})(jQuery);\r\n","/**\r\n * http://github.com/valums/file-uploader\r\n * \r\n * Multiple file upload component with progress-bar, drag-and-drop. \r\n * © 2010 Andrew Valums ( andrew(at)valums.com ) \r\n * \r\n * Licensed under GNU GPL 2 or later and GNU LGPL 2 or later, see license.txt.\r\n */    \r\n\r\n//\r\n// Helper functions\r\n//\r\n\r\nvar qq = qq || {};\r\n\r\n/**\r\n * Adds all missing properties from second obj to first obj\r\n */ \r\nqq.extend = function(first, second){\r\n    for (var prop in second){\r\n        first[prop] = second[prop];\r\n    }\r\n};  \r\n\r\n/**\r\n * Searches for a given element in the array, returns -1 if it is not present.\r\n * @param {Number} [from] The index at which to begin the search\r\n */\r\nqq.indexOf = function(arr, elt, from){\r\n    if (arr.indexOf) return arr.indexOf(elt, from);\r\n    \r\n    from = from || 0;\r\n    var len = arr.length;    \r\n    \r\n    if (from < 0) from += len;  \r\n\r\n    for (; from < len; from++){  \r\n        if (from in arr && arr[from] === elt){  \r\n            return from;\r\n        }\r\n    }  \r\n    return -1;  \r\n}; \r\n    \r\nqq.getUniqueId = (function(){\r\n    var id = 0;\r\n    return function(){ return id++; };\r\n})();\r\n\r\n//\r\n// Events\r\n\r\nqq.attach = function(element, type, fn){\r\n    if (element.addEventListener){\r\n        element.addEventListener(type, fn, false);\r\n    } else if (element.attachEvent){\r\n        element.attachEvent('on' + type, fn);\r\n    }\r\n};\r\nqq.detach = function(element, type, fn){\r\n    if (element.removeEventListener){\r\n        element.removeEventListener(type, fn, false);\r\n    } else if (element.attachEvent){\r\n        element.detachEvent('on' + type, fn);\r\n    }\r\n};\r\n\r\nqq.preventDefault = function(e){\r\n    if (e.preventDefault){\r\n        e.preventDefault();\r\n    } else{\r\n        e.returnValue = false;\r\n    }\r\n};\r\n\r\n//\r\n// Node manipulations\r\n\r\n/**\r\n * Insert node a before node b.\r\n */\r\nqq.insertBefore = function(a, b){\r\n    b.parentNode.insertBefore(a, b);\r\n};\r\nqq.remove = function(element){\r\n    element.parentNode.removeChild(element);\r\n};\r\n\r\nqq.contains = function(parent, descendant){       \r\n    // compareposition returns false in this case\r\n    if (parent == descendant) return true;\r\n    \r\n    if (parent.contains){\r\n        return parent.contains(descendant);\r\n    } else {\r\n        return !!(descendant.compareDocumentPosition(parent) & 8);\r\n    }\r\n};\r\n\r\n/**\r\n * Creates and returns element from html string\r\n * Uses innerHTML to create an element\r\n */\r\nqq.toElement = (function(){\r\n    var div = document.createElement('div');\r\n    return function(html){\r\n        div.innerHTML = html;\r\n        var element = div.firstChild;\r\n        div.removeChild(element);\r\n        return element;\r\n    };\r\n})();\r\n\r\n//\r\n// Node properties and attributes\r\n\r\n/**\r\n * Sets styles for an element.\r\n * Fixes opacity in IE6-8.\r\n */\r\nqq.css = function(element, styles){\r\n    if (styles.opacity != null){\r\n        if (typeof element.style.opacity != 'string' && typeof(element.filters) != 'undefined'){\r\n            styles.filter = 'alpha(opacity=' + Math.round(100 * styles.opacity) + ')';\r\n        }\r\n    }\r\n    qq.extend(element.style, styles);\r\n};\r\nqq.hasClass = function(element, name){\r\n    var re = new RegExp('(^| )' + name + '( |$)');\r\n    return re.test(element.className);\r\n};\r\nqq.addClass = function(element, name){\r\n    if (!qq.hasClass(element, name)){\r\n        element.className += ' ' + name;\r\n    }\r\n};\r\nqq.removeClass = function(element, name){\r\n    var re = new RegExp('(^| )' + name + '( |$)');\r\n    element.className = element.className.replace(re, ' ').replace(/^\\s+|\\s+$/g, \"\");\r\n};\r\nqq.setText = function(element, text){\r\n    element.innerText = text;\r\n    element.textContent = text;\r\n};\r\n\r\n//\r\n// Selecting elements\r\n\r\nqq.children = function(element){\r\n    var children = [],\r\n    child = element.firstChild;\r\n\r\n    while (child){\r\n        if (child.nodeType == 1){\r\n            children.push(child);\r\n        }\r\n        child = child.nextSibling;\r\n    }\r\n\r\n    return children;\r\n};\r\n\r\nqq.getByClass = function(element, className){\r\n    if (element.querySelectorAll){\r\n        return element.querySelectorAll('.' + className);\r\n    }\r\n\r\n    var result = [];\r\n    var candidates = element.getElementsByTagName(\"*\");\r\n    var len = candidates.length;\r\n\r\n    for (var i = 0; i < len; i++){\r\n        if (qq.hasClass(candidates[i], className)){\r\n            result.push(candidates[i]);\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * obj2url() takes a json-object as argument and generates\r\n * a querystring. pretty much like jQuery.param()\r\n * \r\n * how to use:\r\n *\r\n *    `qq.obj2url({a:'b',c:'d'},'http://any.url/upload?otherParam=value');`\r\n *\r\n * will result in:\r\n *\r\n *    `http://any.url/upload?otherParam=value&a=b&c=d`\r\n *\r\n * @param  Object JSON-Object\r\n * @param  String current querystring-part\r\n * @return String encoded querystring\r\n */\r\nqq.obj2url = function(obj, temp, prefixDone){\r\n    var uristrings = [],\r\n        prefix = '&',\r\n        add = function(nextObj, i){\r\n            var nextTemp = temp \r\n                ? (/\\[\\]$/.test(temp)) // prevent double-encoding\r\n                   ? temp\r\n                   : temp+'['+i+']'\r\n                : i;\r\n            if ((nextTemp != 'undefined') && (i != 'undefined')) {  \r\n                uristrings.push(\r\n                    (typeof nextObj === 'object') \r\n                        ? qq.obj2url(nextObj, nextTemp, true)\r\n                        : (Object.prototype.toString.call(nextObj) === '[object Function]')\r\n                            ? encodeURIComponent(nextTemp) + '=' + encodeURIComponent(nextObj())\r\n                            : encodeURIComponent(nextTemp) + '=' + encodeURIComponent(nextObj)                                                          \r\n                );\r\n            }\r\n        }; \r\n\r\n    if (!prefixDone && temp) {\r\n      prefix = (/\\?/.test(temp)) ? (/\\?$/.test(temp)) ? '' : '&' : '?';\r\n      uristrings.push(temp);\r\n      uristrings.push(qq.obj2url(obj));\r\n    } else if ((Object.prototype.toString.call(obj) === '[object Array]') && (typeof obj != 'undefined') ) {\r\n        // we wont use a for-in-loop on an array (performance)\r\n        for (var i = 0, len = obj.length; i < len; ++i){\r\n            add(obj[i], i);\r\n        }\r\n    } else if ((typeof obj != 'undefined') && (obj !== null) && (typeof obj === \"object\")){\r\n        // for anything else but a scalar, we will use for-in-loop\r\n        for (var i in obj){\r\n            add(obj[i], i);\r\n        }\r\n    } else {\r\n        uristrings.push(encodeURIComponent(temp) + '=' + encodeURIComponent(obj));\r\n    }\r\n\r\n    return uristrings.join(prefix)\r\n                     .replace(/^&/, '')\r\n                     .replace(/%20/g, '+'); \r\n};\r\n\r\n//\r\n//\r\n// Uploader Classes\r\n//\r\n//\r\n\r\nvar qq = qq || {};\r\n    \r\n/**\r\n * Creates upload button, validates upload, but doesn't create file list or dd. \r\n */\r\nqq.FileUploaderBasic = function(o){\r\n    this._options = {\r\n        // set to true to see the server response\r\n        debug: false,\r\n        action: '/server/upload',\r\n        params: {},\r\n        button: null,\r\n        multiple: true,\r\n        maxConnections: 3,\r\n        // validation        \r\n        allowedExtensions: [],               \r\n        sizeLimit: 0,   \r\n        minSizeLimit: 0,                             \r\n        // events\r\n        // return false to cancel submit\r\n        onSubmit: function(id, fileName){},\r\n        onProgress: function(id, fileName, loaded, total){},\r\n        onComplete: function(id, fileName, responseJSON){},\r\n        onCancel: function(id, fileName){},\r\n        // messages                \r\n        messages: {\r\n            typeError: \"{file} has invalid extension. Only {extensions} are allowed.\",\r\n            sizeError: \"{file} is too large, maximum file size is {sizeLimit}.\",\r\n            minSizeError: \"{file} is too small, minimum file size is {minSizeLimit}.\",\r\n            emptyError: \"{file} is empty, please select files again without it.\",\r\n            onLeave: \"The files are being uploaded, if you leave now the upload will be cancelled.\"            \r\n        },\r\n        showMessage: function(message){\r\n            alert(message);\r\n        }               \r\n    };\r\n    qq.extend(this._options, o);\r\n        \r\n    // number of files being uploaded\r\n    this._filesInProgress = 0;\r\n    this._handler = this._createUploadHandler(); \r\n    \r\n    if (this._options.button){ \r\n        this._button = this._createUploadButton(this._options.button);\r\n    }\r\n                        \r\n    this._preventLeaveInProgress();         \r\n};\r\n   \r\nqq.FileUploaderBasic.prototype = {\r\n    setParams: function(params){\r\n        this._options.params = params;\r\n    },\r\n    getInProgress: function(){\r\n        return this._filesInProgress;         \r\n    },\r\n    _createUploadButton: function(element){\r\n        var self = this;\r\n        \r\n        return new qq.UploadButton({\r\n            element: element,\r\n            multiple: this._options.multiple && qq.UploadHandlerXhr.isSupported(),\r\n            onChange: function(input){\r\n                self._onInputChange(input);\r\n            }        \r\n        });           \r\n    },    \r\n    _createUploadHandler: function(){\r\n        var self = this,\r\n            handlerClass;        \r\n        \r\n        if(qq.UploadHandlerXhr.isSupported()){           \r\n            handlerClass = 'UploadHandlerXhr';                        \r\n        } else {\r\n            handlerClass = 'UploadHandlerForm';\r\n        }\r\n\r\n        var handler = new qq[handlerClass]({\r\n            debug: this._options.debug,\r\n            action: this._options.action,         \r\n            maxConnections: this._options.maxConnections,   \r\n            onProgress: function(id, fileName, loaded, total){                \r\n                self._onProgress(id, fileName, loaded, total);\r\n                self._options.onProgress(id, fileName, loaded, total);                    \r\n            },            \r\n            onComplete: function(id, fileName, result){\r\n                self._onComplete(id, fileName, result);\r\n                self._options.onComplete(id, fileName, result);\r\n            },\r\n            onCancel: function(id, fileName){\r\n                self._onCancel(id, fileName);\r\n                self._options.onCancel(id, fileName);\r\n            }\r\n        });\r\n\r\n        return handler;\r\n    },    \r\n    _preventLeaveInProgress: function(){\r\n        var self = this;\r\n        \r\n        qq.attach(window, 'beforeunload', function(e){\r\n            if (!self._filesInProgress){return;}\r\n            \r\n            var e = e || window.event;\r\n            // for ie, ff\r\n            e.returnValue = self._options.messages.onLeave;\r\n            // for webkit\r\n            return self._options.messages.onLeave;             \r\n        });        \r\n    },    \r\n    _onSubmit: function(id, fileName){\r\n        this._filesInProgress++;  \r\n    },\r\n    _onProgress: function(id, fileName, loaded, total){        \r\n    },\r\n    _onComplete: function(id, fileName, result){\r\n        this._filesInProgress--;                 \r\n        if (result.error){\r\n            this._options.showMessage(result.error);\r\n        }             \r\n    },\r\n    _onCancel: function(id, fileName){\r\n        this._filesInProgress--;        \r\n    },\r\n    _onInputChange: function(input){\r\n        if (this._handler instanceof qq.UploadHandlerXhr){                \r\n            this._uploadFileList(input.files);                   \r\n        } else {             \r\n            if (this._validateFile(input)){                \r\n                this._uploadFile(input);                                    \r\n            }                      \r\n        }               \r\n        this._button.reset();   \r\n    },  \r\n    _uploadFileList: function(files){\r\n        for (var i=0; i<files.length; i++){\r\n            if ( !this._validateFile(files[i])){\r\n                return;\r\n            }            \r\n        }\r\n        \r\n        for (var i=0; i<files.length; i++){\r\n            this._uploadFile(files[i]);        \r\n        }        \r\n    },       \r\n    _uploadFile: function(fileContainer){      \r\n        var id = this._handler.add(fileContainer);\r\n        var fileName = this._handler.getName(id);\r\n        \r\n        if (this._options.onSubmit(id, fileName) !== false){\r\n            this._onSubmit(id, fileName);\r\n            this._handler.upload(id, this._options.params);\r\n        }\r\n    },      \r\n    _validateFile: function(file){\r\n        var name, size;\r\n        \r\n        if (file.value){\r\n            // it is a file input            \r\n            // get input value and remove path to normalize\r\n            name = file.value.replace(/.*(\\/|\\\\)/, \"\");\r\n        } else {\r\n            // fix missing properties in Safari\r\n            name = file.fileName != null ? file.fileName : file.name;\r\n            size = file.fileSize != null ? file.fileSize : file.size;\r\n        }\r\n                    \r\n        if (! this._isAllowedExtension(name)){            \r\n            this._error('typeError', name);\r\n            return false;\r\n            \r\n        } else if (size === 0){            \r\n            this._error('emptyError', name);\r\n            return false;\r\n                                                     \r\n        } else if (size && this._options.sizeLimit && size > this._options.sizeLimit){            \r\n            this._error('sizeError', name);\r\n            return false;\r\n                        \r\n        } else if (size && size < this._options.minSizeLimit){\r\n            this._error('minSizeError', name);\r\n            return false;            \r\n        }\r\n        \r\n        return true;                \r\n    },\r\n    _error: function(code, fileName){\r\n        var message = this._options.messages[code];        \r\n        function r(name, replacement){ message = message.replace(name, replacement); }\r\n        \r\n        r('{file}', this._formatFileName(fileName));        \r\n        r('{extensions}', this._options.allowedExtensions.join(', '));\r\n        r('{sizeLimit}', this._formatSize(this._options.sizeLimit));\r\n        r('{minSizeLimit}', this._formatSize(this._options.minSizeLimit));\r\n        \r\n        this._options.showMessage(message);                \r\n    },\r\n    _formatFileName: function(name){\r\n        if (name.length > 33){\r\n            name = name.slice(0, 19) + '...' + name.slice(-13);    \r\n        }\r\n        return name;\r\n    },\r\n    _isAllowedExtension: function(fileName){\r\n        var ext = (-1 !== fileName.indexOf('.')) ? fileName.replace(/.*[.]/, '').toLowerCase() : '';\r\n        var allowed = this._options.allowedExtensions;\r\n        \r\n        if (!allowed.length){return true;}        \r\n        \r\n        for (var i=0; i<allowed.length; i++){\r\n            if (allowed[i].toLowerCase() == ext){ return true;}    \r\n        }\r\n        \r\n        return false;\r\n    },    \r\n    _formatSize: function(bytes){\r\n        var i = -1;                                    \r\n        do {\r\n            bytes = bytes / 1024;\r\n            i++;  \r\n        } while (bytes > 99);\r\n        \r\n        return Math.max(bytes, 0.1).toFixed(1) + ['kB', 'MB', 'GB', 'TB', 'PB', 'EB'][i];          \r\n    }\r\n};\r\n    \r\n       \r\n/**\r\n * Class that creates upload widget with drag-and-drop and file list\r\n * @inherits qq.FileUploaderBasic\r\n */\r\nqq.FileUploader = function(o){\r\n    // call parent constructor\r\n    qq.FileUploaderBasic.apply(this, arguments);\r\n    \r\n    // additional options    \r\n    qq.extend(this._options, {\r\n        element: null,\r\n        // if set, will be used instead of qq-upload-list in template\r\n        listElement: null,\r\n                \r\n        template: '<div class=\"qq-uploader\">' + \r\n                '<div class=\"qq-upload-drop-area\"><span>' + Globa.DragFile.locale() + '</span></div>' +\r\n                '<div class=\"qq-upload-button\">' + Globa.LoadFile.locale() + '</div>' +\r\n                '<ul class=\"qq-upload-list\"></ul>' + \r\n             '</div>',\r\n\r\n        // template for one item in file list\r\n        fileTemplate: '<li>' +\r\n                '<span class=\"qq-upload-file\"></span>' +\r\n                '<span class=\"qq-upload-spinner\"></span>' +\r\n                '<span class=\"qq-upload-size\"></span>' +\r\n                '<a class=\"qq-upload-cancel\" href=\"#\">' + Globa.Cancel.locale() + '</a>' +\r\n                '<span class=\"qq-upload-failed-text\">' + Globa.Fail.locale() + '</span>' +\r\n            '</li>',        \r\n        \r\n        classes: {\r\n            // used to get elements from templates\r\n            button: 'qq-upload-button',\r\n            drop: 'qq-upload-drop-area',\r\n            dropActive: 'qq-upload-drop-area-active',\r\n            list: 'qq-upload-list',\r\n                        \r\n            file: 'qq-upload-file',\r\n            spinner: 'qq-upload-spinner',\r\n            size: 'qq-upload-size',\r\n            cancel: 'qq-upload-cancel',\r\n\r\n            // added to list item when upload completes\r\n            // used in css to hide progress spinner\r\n            success: 'qq-upload-success',\r\n            fail: 'qq-upload-fail'\r\n        }\r\n    });\r\n    // overwrite options with user supplied    \r\n    qq.extend(this._options, o);       \r\n\r\n    this._element = this._options.element;\r\n    this._element.innerHTML = this._options.template;        \r\n    this._listElement = this._options.listElement || this._find(this._element, 'list');\r\n    \r\n    this._classes = this._options.classes;\r\n        \r\n    this._button = this._createUploadButton(this._find(this._element, 'button'));        \r\n    \r\n    this._bindCancelEvent();\r\n    this._setupDragDrop();\r\n};\r\n\r\n// inherit from Basic Uploader\r\nqq.extend(qq.FileUploader.prototype, qq.FileUploaderBasic.prototype);\r\n\r\nqq.extend(qq.FileUploader.prototype, {\r\n    /**\r\n     * Gets one of the elements listed in this._options.classes\r\n     **/\r\n    _find: function(parent, type){                                \r\n        var element = qq.getByClass(parent, this._options.classes[type])[0];        \r\n        if (!element){\r\n            throw new Error('element not found ' + type);\r\n        }\r\n        \r\n        return element;\r\n    },\r\n    _setupDragDrop: function(){\r\n        var self = this,\r\n            dropArea = this._find(this._element, 'drop');                        \r\n\r\n        var dz = new qq.UploadDropZone({\r\n            element: dropArea,\r\n            onEnter: function(e){\r\n                qq.addClass(dropArea, self._classes.dropActive);\r\n                e.stopPropagation();\r\n            },\r\n            onLeave: function(e){\r\n                e.stopPropagation();\r\n            },\r\n            onLeaveNotDescendants: function(e){\r\n                qq.removeClass(dropArea, self._classes.dropActive);  \r\n            },\r\n            onDrop: function(e){\r\n                dropArea.style.display = 'none';\r\n                qq.removeClass(dropArea, self._classes.dropActive);\r\n                self._uploadFileList(e.dataTransfer.files);    \r\n            }\r\n        });\r\n                \r\n        dropArea.style.display = 'none';\r\n\r\n        qq.attach(document, 'dragenter', function(e){     \r\n            if (!dz._isValidFileDrag(e)) return; \r\n            \r\n            dropArea.style.display = 'block';            \r\n        });                 \r\n        qq.attach(document, 'dragleave', function(e){\r\n            if (!dz._isValidFileDrag(e)) return;            \r\n            \r\n            var relatedTarget = document.elementFromPoint(e.clientX, e.clientY);\r\n            // only fire when leaving document out\r\n            if ( ! relatedTarget || relatedTarget.nodeName == \"HTML\"){               \r\n                dropArea.style.display = 'none';                                            \r\n            }\r\n        });                \r\n    },\r\n    _onSubmit: function(id, fileName){\r\n        qq.FileUploaderBasic.prototype._onSubmit.apply(this, arguments);\r\n        this._addToList(id, fileName);  \r\n    },\r\n    _onProgress: function(id, fileName, loaded, total){\r\n        qq.FileUploaderBasic.prototype._onProgress.apply(this, arguments);\r\n\r\n        var item = this._getItemByFileId(id);\r\n        var size = this._find(item, 'size');\r\n        size.style.display = 'inline';\r\n        \r\n        var text; \r\n        if (loaded != total){\r\n            text = Math.round(loaded / total * 100) + '% from ' + this._formatSize(total);\r\n        } else {                                   \r\n            text = this._formatSize(total);\r\n        }          \r\n        \r\n        qq.setText(size, text);         \r\n    },\r\n    _onComplete: function(id, fileName, result){\r\n        qq.FileUploaderBasic.prototype._onComplete.apply(this, arguments);\r\n\r\n        // mark completed\r\n        var item = this._getItemByFileId(id);                \r\n        qq.remove(this._find(item, 'cancel'));\r\n        qq.remove(this._find(item, 'spinner'));\r\n        \r\n        if (result.success){\r\n            qq.addClass(item, this._classes.success);    \r\n        } else {\r\n            qq.addClass(item, this._classes.fail);\r\n        }         \r\n    },\r\n    _addToList: function(id, fileName){\r\n        var item = qq.toElement(this._options.fileTemplate);                \r\n        item.qqFileId = id;\r\n\r\n        var fileElement = this._find(item, 'file');        \r\n        qq.setText(fileElement, this._formatFileName(fileName));\r\n        this._find(item, 'size').style.display = 'none';        \r\n\r\n       return  this._listElement.appendChild(item);\r\n    },\r\n    _getItemByFileId: function(id){\r\n        var item = this._listElement.firstChild;        \r\n        \r\n        // there can't be txt nodes in dynamically created list\r\n        // and we can  use nextSibling\r\n        while (item){            \r\n            if (item.qqFileId == id) return item;            \r\n            item = item.nextSibling;\r\n        }          \r\n    },\r\n    /**\r\n     * delegate click event for cancel link \r\n     **/\r\n    _bindCancelEvent: function(){\r\n        var self = this,\r\n            list = this._listElement;            \r\n        \r\n        qq.attach(list, 'click', function(e){            \r\n            e = e || window.event;\r\n            var target = e.target || e.srcElement;\r\n            \r\n            if (qq.hasClass(target, self._classes.cancel)){                \r\n                qq.preventDefault(e);\r\n               \r\n                var item = target.parentNode;\r\n                self._handler.cancel(item.qqFileId);\r\n                qq.remove(item);\r\n            }\r\n        });\r\n    }    \r\n});\r\n    \r\nqq.UploadDropZone = function(o){\r\n    this._options = {\r\n        element: null,  \r\n        onEnter: function(e){},\r\n        onLeave: function(e){},  \r\n        // is not fired when leaving element by hovering descendants   \r\n        onLeaveNotDescendants: function(e){},   \r\n        onDrop: function(e){}                       \r\n    };\r\n    qq.extend(this._options, o); \r\n    \r\n    this._element = this._options.element;\r\n    \r\n    this._disableDropOutside();\r\n    this._attachEvents();   \r\n};\r\n\r\nqq.UploadDropZone.prototype = {\r\n    _disableDropOutside: function(e){\r\n        // run only once for all instances\r\n        if (!qq.UploadDropZone.dropOutsideDisabled ){\r\n\r\n            qq.attach(document, 'dragover', function(e){\r\n                if (e.dataTransfer){\r\n                    e.dataTransfer.dropEffect = 'none';\r\n                    e.preventDefault(); \r\n                }           \r\n            });\r\n            \r\n            qq.UploadDropZone.dropOutsideDisabled = true; \r\n        }        \r\n    },\r\n    _attachEvents: function(){\r\n        var self = this;              \r\n                  \r\n        qq.attach(self._element, 'dragover', function(e){\r\n            if (!self._isValidFileDrag(e)) return;\r\n            \r\n            var effect = e.dataTransfer.effectAllowed;\r\n            if (effect == 'move' || effect == 'linkMove'){\r\n                e.dataTransfer.dropEffect = 'move'; // for FF (only move allowed)    \r\n            } else {                    \r\n                e.dataTransfer.dropEffect = 'copy'; // for Chrome\r\n            }\r\n                                                     \r\n            e.stopPropagation();\r\n            e.preventDefault();                                                                    \r\n        });\r\n        \r\n        qq.attach(self._element, 'dragenter', function(e){\r\n            if (!self._isValidFileDrag(e)) return;\r\n                        \r\n            self._options.onEnter(e);\r\n        });\r\n        \r\n        qq.attach(self._element, 'dragleave', function(e){\r\n            if (!self._isValidFileDrag(e)) return;\r\n            \r\n            self._options.onLeave(e);\r\n            \r\n            var relatedTarget = document.elementFromPoint(e.clientX, e.clientY);                      \r\n            // do not fire when moving a mouse over a descendant\r\n            if (qq.contains(this, relatedTarget)) return;\r\n                        \r\n            self._options.onLeaveNotDescendants(e); \r\n        });\r\n                \r\n        qq.attach(self._element, 'drop', function(e){\r\n            if (!self._isValidFileDrag(e)) return;\r\n            \r\n            e.preventDefault();\r\n            self._options.onDrop(e);\r\n        });          \r\n    },\r\n    _isValidFileDrag: function(e){\r\n        var dt = e.dataTransfer,\r\n            // do not check dt.types.contains in webkit, because it crashes safari 4            \r\n            isWebkit = navigator.userAgent.indexOf(\"AppleWebKit\") > -1;                        \r\n\r\n        // dt.effectAllowed is none in Safari 5\r\n        // dt.types.contains check is for firefox            \r\n        return dt && dt.effectAllowed != 'none' && \r\n            (dt.files || (!isWebkit && dt.types.contains && dt.types.contains('Files')));\r\n        \r\n    }        \r\n}; \r\n\r\nqq.UploadButton = function(o){\r\n    this._options = {\r\n        element: null,  \r\n        // if set to true adds multiple attribute to file input      \r\n        multiple: false,\r\n        // name attribute of file input\r\n        name: 'file',\r\n        onChange: function(input){},\r\n        hoverClass: 'qq-upload-button-hover',\r\n        focusClass: 'qq-upload-button-focus'                       \r\n    };\r\n    \r\n    qq.extend(this._options, o);\r\n        \r\n    this._element = this._options.element;\r\n    \r\n    // make button suitable container for input\r\n    qq.css(this._element, {\r\n        position: 'relative',\r\n        overflow: 'hidden',\r\n        // Make sure browse button is in the right side\r\n        // in Internet Explorer\r\n        direction: 'ltr'\r\n    });   \r\n    \r\n    this._input = this._createInput();\r\n};\r\n\r\nqq.UploadButton.prototype = {\r\n    /* returns file input element */    \r\n    getInput: function(){\r\n        return this._input;\r\n    },\r\n    /* cleans/recreates the file input */\r\n    reset: function(){\r\n        if (this._input.parentNode){\r\n            qq.remove(this._input);    \r\n        }                \r\n        \r\n        qq.removeClass(this._element, this._options.focusClass);\r\n        this._input = this._createInput();\r\n    },    \r\n    _createInput: function(){                \r\n        var input = document.createElement(\"input\");\r\n        \r\n        if (this._options.multiple){\r\n            input.setAttribute(\"multiple\", \"multiple\");\r\n        }\r\n                \r\n        input.setAttribute(\"type\", \"file\");\r\n        input.setAttribute(\"name\", this._options.name);\r\n        \r\n        qq.css(input, {\r\n            position: 'absolute',\r\n            // in Opera only 'browse' button\r\n            // is clickable and it is located at\r\n            // the right side of the input\r\n            right: 0,\r\n            top: 0,\r\n            fontFamily: 'Arial',\r\n            // 4 persons reported this, the max values that worked for them were 243, 236, 236, 118\r\n            fontSize: '118px',\r\n            margin: 0,\r\n            padding: 0,\r\n            cursor: 'pointer',\r\n            opacity: 0\r\n        });\r\n        \r\n        this._element.appendChild(input);\r\n\r\n        var self = this;\r\n        qq.attach(input, 'change', function(){\r\n            self._options.onChange(input);\r\n        });\r\n                \r\n        qq.attach(input, 'mouseover', function(){\r\n            qq.addClass(self._element, self._options.hoverClass);\r\n        });\r\n        qq.attach(input, 'mouseout', function(){\r\n            qq.removeClass(self._element, self._options.hoverClass);\r\n        });\r\n        qq.attach(input, 'focus', function(){\r\n            qq.addClass(self._element, self._options.focusClass);\r\n        });\r\n        qq.attach(input, 'blur', function(){\r\n            qq.removeClass(self._element, self._options.focusClass);\r\n        });\r\n\r\n        // IE and Opera, unfortunately have 2 tab stops on file input\r\n        // which is unacceptable in our case, disable keyboard access\r\n        if (window.attachEvent){\r\n            // it is IE or Opera\r\n            input.setAttribute('tabIndex', \"-1\");\r\n        }\r\n\r\n        return input;            \r\n    }        \r\n};\r\n\r\n/**\r\n * Class for uploading files, uploading itself is handled by child classes\r\n */\r\nqq.UploadHandlerAbstract = function(o){\r\n    this._options = {\r\n        debug: false,\r\n        action: '/upload.php',\r\n        // maximum number of concurrent uploads        \r\n        maxConnections: 999,\r\n        onProgress: function(id, fileName, loaded, total){},\r\n        onComplete: function(id, fileName, response){},\r\n        onCancel: function(id, fileName){}\r\n    };\r\n    qq.extend(this._options, o);    \r\n    \r\n    this._queue = [];\r\n    // params for files in queue\r\n    this._params = [];\r\n};\r\nqq.UploadHandlerAbstract.prototype = {\r\n    log: function(str){\r\n        if (this._options.debug && window.console) console.log('[uploader] ' + str);        \r\n    },\r\n    /**\r\n     * Adds file or file input to the queue\r\n     * @returns id\r\n     **/    \r\n    add: function(file){},\r\n    /**\r\n     * Sends the file identified by id and additional query params to the server\r\n     */\r\n    upload: function(id, params){\r\n        var len = this._queue.push(id);\r\n\r\n        var copy = {};        \r\n        qq.extend(copy, params);\r\n        this._params[id] = copy;        \r\n                \r\n        // if too many active uploads, wait...\r\n        if (len <= this._options.maxConnections){               \r\n            this._upload(id, this._params[id]);\r\n        }\r\n    },\r\n    /**\r\n     * Cancels file upload by id\r\n     */\r\n    cancel: function(id){\r\n        this._cancel(id);\r\n        this._dequeue(id);\r\n    },\r\n    /**\r\n     * Cancells all uploads\r\n     */\r\n    cancelAll: function(){\r\n        for (var i=0; i<this._queue.length; i++){\r\n            this._cancel(this._queue[i]);\r\n        }\r\n        this._queue = [];\r\n    },\r\n    /**\r\n     * Returns name of the file identified by id\r\n     */\r\n    getName: function(id){},\r\n    /**\r\n     * Returns size of the file identified by id\r\n     */          \r\n    getSize: function(id){},\r\n    /**\r\n     * Returns id of files being uploaded or\r\n     * waiting for their turn\r\n     */\r\n    getQueue: function(){\r\n        return this._queue;\r\n    },\r\n    /**\r\n     * Actual upload method\r\n     */\r\n    _upload: function(id){},\r\n    /**\r\n     * Actual cancel method\r\n     */\r\n    _cancel: function(id){},     \r\n    /**\r\n     * Removes element from queue, starts upload of next\r\n     */\r\n    _dequeue: function(id){\r\n        var i = qq.indexOf(this._queue, id);\r\n        this._queue.splice(i, 1);\r\n                \r\n        var max = this._options.maxConnections;\r\n        \r\n        if (this._queue.length >= max && i < max){\r\n            var nextId = this._queue[max-1];\r\n            this._upload(nextId, this._params[nextId]);\r\n        }\r\n    }        \r\n};\r\n\r\n/**\r\n * Class for uploading files using form and iframe\r\n * @inherits qq.UploadHandlerAbstract\r\n */\r\nqq.UploadHandlerForm = function(o){\r\n    qq.UploadHandlerAbstract.apply(this, arguments);\r\n       \r\n    this._inputs = {};\r\n};\r\n// @inherits qq.UploadHandlerAbstract\r\nqq.extend(qq.UploadHandlerForm.prototype, qq.UploadHandlerAbstract.prototype);\r\n\r\nqq.extend(qq.UploadHandlerForm.prototype, {\r\n    add: function(fileInput){\r\n        fileInput.setAttribute('name', 'qqfile');\r\n        var id = 'qq-upload-handler-iframe' + qq.getUniqueId();       \r\n        \r\n        this._inputs[id] = fileInput;\r\n        \r\n        // remove file input from DOM\r\n        if (fileInput.parentNode){\r\n            qq.remove(fileInput);\r\n        }\r\n                \r\n        return id;\r\n    },\r\n    getName: function(id){\r\n        // get input value and remove path to normalize\r\n        return this._inputs[id].value.replace(/.*(\\/|\\\\)/, \"\");\r\n    },    \r\n    _cancel: function(id){\r\n        this._options.onCancel(id, this.getName(id));\r\n        \r\n        delete this._inputs[id];        \r\n\r\n        var iframe = document.getElementById(id);\r\n        if (iframe){\r\n            // to cancel request set src to something else\r\n            // we use src=\"javascript:false;\" because it doesn't\r\n            // trigger ie6 prompt on https\r\n            iframe.setAttribute('src', 'javascript:false;');\r\n\r\n            qq.remove(iframe);\r\n        }\r\n    },     \r\n    _upload: function(id, params){                        \r\n        var input = this._inputs[id];\r\n        \r\n        if (!input){\r\n            throw new Error('file with passed id was not added, or already uploaded or cancelled');\r\n        }                \r\n\r\n        var fileName = this.getName(id);\r\n                \r\n        var iframe = this._createIframe(id);\r\n        var form = this._createForm(iframe, params);\r\n        form.appendChild(input);\r\n\r\n        var self = this;\r\n        this._attachLoadEvent(iframe, function(){                                 \r\n            self.log('iframe loaded');\r\n            \r\n            var response = self._getIframeContentJSON(iframe);\r\n\r\n            self._options.onComplete(id, fileName, response);\r\n            self._dequeue(id);\r\n            \r\n            delete self._inputs[id];\r\n            // timeout added to fix busy state in FF3.6\r\n            setTimeout(function(){\r\n                qq.remove(iframe);\r\n            }, 1);\r\n        });\r\n\r\n        form.submit();        \r\n        qq.remove(form);        \r\n        \r\n        return id;\r\n    }, \r\n    _attachLoadEvent: function(iframe, callback){\r\n        qq.attach(iframe, 'load', function(){\r\n            // when we remove iframe from dom\r\n            // the request stops, but in IE load\r\n            // event fires\r\n            if (!iframe.parentNode){\r\n                return;\r\n            }\r\n\r\n            // fixing Opera 10.53\r\n            if (iframe.contentDocument &&\r\n                iframe.contentDocument.body &&\r\n                iframe.contentDocument.body.innerHTML == \"false\"){\r\n                // In Opera event is fired second time\r\n                // when body.innerHTML changed from false\r\n                // to server response approx. after 1 sec\r\n                // when we upload file with iframe\r\n                return;\r\n            }\r\n\r\n            callback();\r\n        });\r\n    },\r\n    /**\r\n     * Returns json object received by iframe from server.\r\n     */\r\n    _getIframeContentJSON: function(iframe){\r\n        // iframe.contentWindow.document - for IE<7\r\n        var doc = iframe.contentDocument ? iframe.contentDocument: iframe.contentWindow.document,\r\n            response;\r\n        \r\n        this.log(\"converting iframe's innerHTML to JSON\");\r\n        this.log(\"innerHTML = \" + doc.body.innerHTML);\r\n                        \r\n        try {\r\n            response = eval(\"(\" + doc.body.innerHTML + \")\");\r\n        } catch(err){\r\n            response = {};\r\n        }        \r\n\r\n        return response;\r\n    },\r\n    /**\r\n     * Creates iframe with unique name\r\n     */\r\n    _createIframe: function(id){\r\n        // We can't use following code as the name attribute\r\n        // won't be properly registered in IE6, and new window\r\n        // on form submit will open\r\n        // var iframe = document.createElement('iframe');\r\n        // iframe.setAttribute('name', id);\r\n\r\n        var iframe = qq.toElement('<iframe src=\"javascript:false;\" name=\"' + id + '\" />');\r\n        // src=\"javascript:false;\" removes ie6 prompt on https\r\n\r\n        iframe.setAttribute('id', id);\r\n\r\n        iframe.style.display = 'none';\r\n        document.body.appendChild(iframe);\r\n\r\n        return iframe;\r\n    },\r\n    /**\r\n     * Creates form, that will be submitted to iframe\r\n     */\r\n    _createForm: function(iframe, params){\r\n        // We can't use the following code in IE6\r\n        // var form = document.createElement('form');\r\n        // form.setAttribute('method', 'post');\r\n        // form.setAttribute('enctype', 'multipart/form-data');\r\n        // Because in this case file won't be attached to request\r\n        var form = qq.toElement('<form method=\"post\" enctype=\"multipart/form-data\"></form>');\r\n\r\n        var queryString = qq.obj2url(params, this._options.action);\r\n\r\n        form.setAttribute('action', queryString);\r\n        form.setAttribute('target', iframe.name);\r\n        form.style.display = 'none';\r\n        document.body.appendChild(form);\r\n\r\n        return form;\r\n    }\r\n});\r\n\r\n/**\r\n * Class for uploading files using xhr\r\n * @inherits qq.UploadHandlerAbstract\r\n */\r\nqq.UploadHandlerXhr = function(o){\r\n    qq.UploadHandlerAbstract.apply(this, arguments);\r\n\r\n    this._files = [];\r\n    this._xhrs = [];\r\n    \r\n    // current loaded size in bytes for each file \r\n    this._loaded = [];\r\n};\r\n\r\n// static method\r\nqq.UploadHandlerXhr.isSupported = function(){\r\n    var input = document.createElement('input');\r\n    input.type = 'file';        \r\n    \r\n    return (\r\n        'multiple' in input &&\r\n        typeof File != \"undefined\" &&\r\n        typeof (new XMLHttpRequest()).upload != \"undefined\" );       \r\n};\r\n\r\n// @inherits qq.UploadHandlerAbstract\r\nqq.extend(qq.UploadHandlerXhr.prototype, qq.UploadHandlerAbstract.prototype)\r\n\r\nqq.extend(qq.UploadHandlerXhr.prototype, {\r\n    /**\r\n     * Adds file to the queue\r\n     * Returns id to use with upload, cancel\r\n     **/    \r\n    add: function(file){\r\n        if (!(file instanceof File)){\r\n            throw new Error('Passed obj in not a File (in qq.UploadHandlerXhr)');\r\n        }\r\n                \r\n        return this._files.push(file) - 1;        \r\n    },\r\n    getName: function(id){        \r\n        var file = this._files[id];\r\n        // fix missing name in Safari 4\r\n        return file.fileName != null ? file.fileName : file.name;       \r\n    },\r\n    getSize: function(id){\r\n        var file = this._files[id];\r\n        return file.fileSize != null ? file.fileSize : file.size;\r\n    },    \r\n    /**\r\n     * Returns uploaded bytes for file identified by id \r\n     */    \r\n    getLoaded: function(id){\r\n        return this._loaded[id] || 0; \r\n    },\r\n    /**\r\n     * Sends the file identified by id and additional query params to the server\r\n     * @param {Object} params name-value string pairs\r\n     */    \r\n    _upload: function(id, params){\r\n        var file = this._files[id],\r\n            name = this.getName(id),\r\n            size = this.getSize(id);\r\n                \r\n        this._loaded[id] = 0;\r\n                                \r\n        var xhr = this._xhrs[id] = new XMLHttpRequest();\r\n        var self = this;\r\n                                        \r\n        xhr.upload.onprogress = function(e){\r\n            if (e.lengthComputable){\r\n                self._loaded[id] = e.loaded;\r\n                self._options.onProgress(id, name, e.loaded, e.total);\r\n            }\r\n        };\r\n\r\n        xhr.onreadystatechange = function(){            \r\n            if (xhr.readyState == 4){\r\n                self._onComplete(id, xhr);                    \r\n            }\r\n        };\r\n\r\n        // build query string\r\n        params = params || {};\r\n        params['qqfile'] = name;\r\n        var queryString = qq.obj2url(params, this._options.action);\r\n\r\n        xhr.open(\"POST\", queryString, true);\r\n        xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n        xhr.setRequestHeader(\"X-File-Name\", encodeURIComponent(name));\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\r\n        xhr.send(file);\r\n    },\r\n    _onComplete: function(id, xhr){\r\n        // the request was aborted/cancelled\r\n        if (!this._files[id]) return;\r\n        \r\n        var name = this.getName(id);\r\n        var size = this.getSize(id);\r\n        \r\n        this._options.onProgress(id, name, size, size);\r\n                \r\n        if (xhr.status == 200){\r\n            this.log(\"xhr - server response received\");\r\n            this.log(\"responseText = \" + xhr.responseText);\r\n                        \r\n            var response;\r\n                    \r\n            try {\r\n                response = eval(\"(\" + xhr.responseText + \")\");\r\n            } catch(err){\r\n                response = {};\r\n            }\r\n            \r\n            this._options.onComplete(id, name, response);\r\n                        \r\n        } else {                   \r\n            this._options.onComplete(id, name, {});\r\n        }\r\n                \r\n        this._files[id] = null;\r\n        this._xhrs[id] = null;    \r\n        this._dequeue(id);                    \r\n    },\r\n    _cancel: function(id){\r\n        this._options.onCancel(id, this.getName(id));\r\n        \r\n        this._files[id] = null;\r\n        \r\n        if (this._xhrs[id]){\r\n            this._xhrs[id].abort();\r\n            this._xhrs[id] = null;                                   \r\n        }\r\n    }\r\n});","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n\r\n (c) 2009-2016 Torstein Honsi\r\n\r\n License: www.highcharts.com/license\r\n*/\r\n(function(T,K){\"object\"===typeof module&&module.exports?module.exports=T.document?K(T):K:T.Highcharts=K(T)})(\"undefined\"!==typeof window?window:this,function(T){var K=function(){var a=\"undefined\"===typeof T?window:T,C=a.document,F=a.navigator&&a.navigator.userAgent||\"\",D=C&&C.createElementNS&&!!C.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\").createSVGRect,r=/(edge|msie|trident)/i.test(F)&&!a.opera,g=-1!==F.indexOf(\"Firefox\"),e=-1!==F.indexOf(\"Chrome\"),t=g&&4>parseInt(F.split(\"Firefox/\")[1],\r\n10);return a.Highcharts?a.Highcharts.error(16,!0):{product:\"Highcharts\",version:\"6.1.0\",deg2rad:2*Math.PI/360,doc:C,hasBidiBug:t,hasTouch:C&&void 0!==C.documentElement.ontouchstart,isMS:r,isWebKit:-1!==F.indexOf(\"AppleWebKit\"),isFirefox:g,isChrome:e,isSafari:!e&&-1!==F.indexOf(\"Safari\"),isTouchDevice:/(Mobile|Android|Windows Phone)/.test(F),SVG_NS:\"http://www.w3.org/2000/svg\",chartCount:0,seriesTypes:{},symbolSizes:{},svg:D,win:a,marginNames:[\"plotTop\",\"marginRight\",\"marginBottom\",\"plotLeft\"],noop:function(){},\r\ncharts:[]}}();(function(a){a.timers=[];var C=a.charts,F=a.doc,D=a.win;a.error=function(r,g){r=a.isNumber(r)?\"Highcharts error #\"+r+\": www.highcharts.com/errors/\"+r:r;if(g)throw Error(r);D.console&&console.log(r)};a.Fx=function(a,g,e){this.options=g;this.elem=a;this.prop=e};a.Fx.prototype={dSetter:function(){var a=this.paths[0],g=this.paths[1],e=[],t=this.now,w=a.length,l;if(1===t)e=this.toD;else if(w===g.length&&1>t)for(;w--;)l=parseFloat(a[w]),e[w]=isNaN(l)?g[w]:t*parseFloat(g[w]-l)+l;else e=g;this.elem.attr(\"d\",\r\ne,null,!0)},update:function(){var a=this.elem,g=this.prop,e=this.now,t=this.options.step;if(this[g+\"Setter\"])this[g+\"Setter\"]();else a.attr?a.element&&a.attr(g,e,null,!0):a.style[g]=e+this.unit;t&&t.call(a,e,this)},run:function(r,g,e){var t=this,w=t.options,l=function(a){return l.stopped?!1:t.step(a)},u=D.requestAnimationFrame||function(a){setTimeout(a,13)},c=function(){for(var d=0;d<a.timers.length;d++)a.timers[d]()||a.timers.splice(d--,1);a.timers.length&&u(c)};r!==g||this.elem[\"forceAnimate:\"+\r\nthis.prop]?(this.startTime=+new Date,this.start=r,this.end=g,this.unit=e,this.now=this.start,this.pos=0,l.elem=this.elem,l.prop=this.prop,l()&&1===a.timers.push(l)&&u(c)):(delete w.curAnim[this.prop],w.complete&&0===a.keys(w.curAnim).length&&w.complete.call(this.elem))},step:function(r){var g=+new Date,e,t=this.options,w=this.elem,l=t.complete,u=t.duration,c=t.curAnim;w.attr&&!w.element?r=!1:r||g>=u+this.startTime?(this.now=this.end,this.pos=1,this.update(),e=c[this.prop]=!0,a.objectEach(c,function(a){!0!==\r\na&&(e=!1)}),e&&l&&l.call(w),r=!1):(this.pos=t.easing((g-this.startTime)/u),this.now=this.start+(this.end-this.start)*this.pos,this.update(),r=!0);return r},initPath:function(r,g,e){function t(a){var f,c;for(b=a.length;b--;)f=\"M\"===a[b]||\"L\"===a[b],c=/[a-zA-Z]/.test(a[b+3]),f&&c&&a.splice(b+1,0,a[b+1],a[b+2],a[b+1],a[b+2])}function w(a,f){for(;a.length<p;){a[0]=f[p-a.length];var c=a.slice(0,x);[].splice.apply(a,[0,0].concat(c));n&&(c=a.slice(a.length-x),[].splice.apply(a,[a.length,0].concat(c)),b--)}a[0]=\r\n\"M\"}function l(a,b){for(var c=(p-a.length)/x;0<c&&c--;)f=a.slice().splice(a.length/z-x,x*z),f[0]=b[p-x-c*x],k&&(f[x-6]=f[x-2],f[x-5]=f[x-1]),[].splice.apply(a,[a.length/z,0].concat(f)),n&&c--}g=g||\"\";var u,c=r.startX,d=r.endX,k=-1<g.indexOf(\"C\"),x=k?7:3,p,f,b;g=g.split(\" \");e=e.slice();var n=r.isArea,z=n?2:1,J;k&&(t(g),t(e));if(c&&d){for(b=0;b<c.length;b++)if(c[b]===d[0]){u=b;break}else if(c[0]===d[d.length-c.length+b]){u=b;J=!0;break}void 0===u&&(g=[])}g.length&&a.isNumber(u)&&(p=e.length+u*z*x,\r\nJ?(w(g,e),l(e,g)):(w(e,g),l(g,e)));return[g,e]}};a.Fx.prototype.fillSetter=a.Fx.prototype.strokeSetter=function(){this.elem.attr(this.prop,a.color(this.start).tweenTo(a.color(this.end),this.pos),null,!0)};a.merge=function(){var r,g=arguments,e,t={},w=function(e,u){\"object\"!==typeof e&&(e={});a.objectEach(u,function(c,d){!a.isObject(c,!0)||a.isClass(c)||a.isDOMElement(c)?e[d]=u[d]:e[d]=w(e[d]||{},c)});return e};!0===g[0]&&(t=g[1],g=Array.prototype.slice.call(g,2));e=g.length;for(r=0;r<e;r++)t=w(t,\r\ng[r]);return t};a.pInt=function(a,g){return parseInt(a,g||10)};a.isString=function(a){return\"string\"===typeof a};a.isArray=function(a){a=Object.prototype.toString.call(a);return\"[object Array]\"===a||\"[object Array Iterator]\"===a};a.isObject=function(r,g){return!!r&&\"object\"===typeof r&&(!g||!a.isArray(r))};a.isDOMElement=function(r){return a.isObject(r)&&\"number\"===typeof r.nodeType};a.isClass=function(r){var g=r&&r.constructor;return!(!a.isObject(r,!0)||a.isDOMElement(r)||!g||!g.name||\"Object\"===\r\ng.name)};a.isNumber=function(a){return\"number\"===typeof a&&!isNaN(a)&&Infinity>a&&-Infinity<a};a.erase=function(a,g){for(var e=a.length;e--;)if(a[e]===g){a.splice(e,1);break}};a.defined=function(a){return void 0!==a&&null!==a};a.attr=function(r,g,e){var t;a.isString(g)?a.defined(e)?r.setAttribute(g,e):r&&r.getAttribute&&((t=r.getAttribute(g))||\"class\"!==g||(t=r.getAttribute(g+\"Name\"))):a.defined(g)&&a.isObject(g)&&a.objectEach(g,function(a,e){r.setAttribute(e,a)});return t};a.splat=function(r){return a.isArray(r)?\r\nr:[r]};a.syncTimeout=function(a,g,e){if(g)return setTimeout(a,g,e);a.call(0,e)};a.clearTimeout=function(r){a.defined(r)&&clearTimeout(r)};a.extend=function(a,g){var e;a||(a={});for(e in g)a[e]=g[e];return a};a.pick=function(){var a=arguments,g,e,t=a.length;for(g=0;g<t;g++)if(e=a[g],void 0!==e&&null!==e)return e};a.css=function(r,g){a.isMS&&!a.svg&&g&&void 0!==g.opacity&&(g.filter=\"alpha(opacity\\x3d\"+100*g.opacity+\")\");a.extend(r.style,g)};a.createElement=function(r,g,e,t,w){r=F.createElement(r);var l=\r\na.css;g&&a.extend(r,g);w&&l(r,{padding:0,border:\"none\",margin:0});e&&l(r,e);t&&t.appendChild(r);return r};a.extendClass=function(r,g){var e=function(){};e.prototype=new r;a.extend(e.prototype,g);return e};a.pad=function(a,g,e){return Array((g||2)+1-String(a).replace(\"-\",\"\").length).join(e||0)+a};a.relativeLength=function(a,g,e){return/%$/.test(a)?g*parseFloat(a)/100+(e||0):parseFloat(a)};a.wrap=function(a,g,e){var t=a[g];a[g]=function(){var a=Array.prototype.slice.call(arguments),l=arguments,u=this;\r\nu.proceed=function(){t.apply(u,arguments.length?arguments:l)};a.unshift(t);a=e.apply(this,a);u.proceed=null;return a}};a.formatSingle=function(r,g,e){var t=/\\.([0-9])/,w=a.defaultOptions.lang;/f$/.test(r)?(e=(e=r.match(t))?e[1]:-1,null!==g&&(g=a.numberFormat(g,e,w.decimalPoint,-1<r.indexOf(\",\")?w.thousandsSep:\"\"))):g=(e||a.time).dateFormat(r,g);return g};a.format=function(r,g,e){for(var t=\"{\",w=!1,l,u,c,d,k=[],x;r;){t=r.indexOf(t);if(-1===t)break;l=r.slice(0,t);if(w){l=l.split(\":\");u=l.shift().split(\".\");\r\nd=u.length;x=g;for(c=0;c<d;c++)x&&(x=x[u[c]]);l.length&&(x=a.formatSingle(l.join(\":\"),x,e));k.push(x)}else k.push(l);r=r.slice(t+1);t=(w=!w)?\"}\":\"{\"}k.push(r);return k.join(\"\")};a.getMagnitude=function(a){return Math.pow(10,Math.floor(Math.log(a)/Math.LN10))};a.normalizeTickInterval=function(r,g,e,t,w){var l,u=r;e=a.pick(e,1);l=r/e;g||(g=w?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===t&&(1===e?g=a.grep(g,function(a){return 0===a%1}):.1>=e&&(g=[1/e])));for(t=0;t<g.length&&!(u=g[t],w&&u*e>=r||\r\n!w&&l<=(g[t]+(g[t+1]||g[t]))/2);t++);return u=a.correctFloat(u*e,-Math.round(Math.log(.001)/Math.LN10))};a.stableSort=function(a,g){var e=a.length,t,w;for(w=0;w<e;w++)a[w].safeI=w;a.sort(function(a,e){t=g(a,e);return 0===t?a.safeI-e.safeI:t});for(w=0;w<e;w++)delete a[w].safeI};a.arrayMin=function(a){for(var g=a.length,e=a[0];g--;)a[g]<e&&(e=a[g]);return e};a.arrayMax=function(a){for(var g=a.length,e=a[0];g--;)a[g]>e&&(e=a[g]);return e};a.destroyObjectProperties=function(r,g){a.objectEach(r,function(a,\r\nt){a&&a!==g&&a.destroy&&a.destroy();delete r[t]})};a.discardElement=function(r){var g=a.garbageBin;g||(g=a.createElement(\"div\"));r&&g.appendChild(r);g.innerHTML=\"\"};a.correctFloat=function(a,g){return parseFloat(a.toPrecision(g||14))};a.setAnimation=function(r,g){g.renderer.globalAnimation=a.pick(r,g.options.chart.animation,!0)};a.animObject=function(r){return a.isObject(r)?a.merge(r):{duration:r?500:0}};a.timeUnits={millisecond:1,second:1E3,minute:6E4,hour:36E5,day:864E5,week:6048E5,month:24192E5,\r\nyear:314496E5};a.numberFormat=function(r,g,e,t){r=+r||0;g=+g;var w=a.defaultOptions.lang,l=(r.toString().split(\".\")[1]||\"\").split(\"e\")[0].length,u,c,d=r.toString().split(\"e\");-1===g?g=Math.min(l,20):a.isNumber(g)?g&&d[1]&&0>d[1]&&(u=g+ +d[1],0<=u?(d[0]=(+d[0]).toExponential(u).split(\"e\")[0],g=u):(d[0]=d[0].split(\".\")[0]||0,r=20>g?(d[0]*Math.pow(10,d[1])).toFixed(g):0,d[1]=0)):g=2;c=(Math.abs(d[1]?d[0]:r)+Math.pow(10,-Math.max(g,l)-1)).toFixed(g);l=String(a.pInt(c));u=3<l.length?l.length%3:0;e=a.pick(e,\r\nw.decimalPoint);t=a.pick(t,w.thousandsSep);r=(0>r?\"-\":\"\")+(u?l.substr(0,u)+t:\"\");r+=l.substr(u).replace(/(\\d{3})(?=\\d)/g,\"$1\"+t);g&&(r+=e+c.slice(-g));d[1]&&0!==+r&&(r+=\"e\"+d[1]);return r};Math.easeInOutSine=function(a){return-.5*(Math.cos(Math.PI*a)-1)};a.getStyle=function(r,g,e){if(\"width\"===g)return Math.min(r.offsetWidth,r.scrollWidth)-a.getStyle(r,\"padding-left\")-a.getStyle(r,\"padding-right\");if(\"height\"===g)return Math.min(r.offsetHeight,r.scrollHeight)-a.getStyle(r,\"padding-top\")-a.getStyle(r,\r\n\"padding-bottom\");D.getComputedStyle||a.error(27,!0);if(r=D.getComputedStyle(r,void 0))r=r.getPropertyValue(g),a.pick(e,\"opacity\"!==g)&&(r=a.pInt(r));return r};a.inArray=function(r,g,e){return(a.indexOfPolyfill||Array.prototype.indexOf).call(g,r,e)};a.grep=function(r,g){return(a.filterPolyfill||Array.prototype.filter).call(r,g)};a.find=Array.prototype.find?function(a,g){return a.find(g)}:function(a,g){var e,t=a.length;for(e=0;e<t;e++)if(g(a[e],e))return a[e]};a.some=function(r,g,e){return(a.somePolyfill||\r\nArray.prototype.some).call(r,g,e)};a.map=function(a,g){for(var e=[],t=0,w=a.length;t<w;t++)e[t]=g.call(a[t],a[t],t,a);return e};a.keys=function(r){return(a.keysPolyfill||Object.keys).call(void 0,r)};a.reduce=function(r,g,e){return(a.reducePolyfill||Array.prototype.reduce).call(r,g,e)};a.offset=function(a){var g=F.documentElement;a=a.parentElement?a.getBoundingClientRect():{top:0,left:0};return{top:a.top+(D.pageYOffset||g.scrollTop)-(g.clientTop||0),left:a.left+(D.pageXOffset||g.scrollLeft)-(g.clientLeft||\r\n0)}};a.stop=function(r,g){for(var e=a.timers.length;e--;)a.timers[e].elem!==r||g&&g!==a.timers[e].prop||(a.timers[e].stopped=!0)};a.each=function(r,g,e){return(a.forEachPolyfill||Array.prototype.forEach).call(r,g,e)};a.objectEach=function(a,g,e){for(var t in a)a.hasOwnProperty(t)&&g.call(e||a[t],a[t],t,a)};a.addEvent=function(r,g,e){var t,w=r.addEventListener||a.addEventListenerPolyfill;t=\"function\"===typeof r&&r.prototype?r.prototype.protoEvents=r.prototype.protoEvents||{}:r.hcEvents=r.hcEvents||\r\n{};w&&w.call(r,g,e,!1);t[g]||(t[g]=[]);t[g].push(e);return function(){a.removeEvent(r,g,e)}};a.removeEvent=function(r,g,e){function t(c,d){var k=r.removeEventListener||a.removeEventListenerPolyfill;k&&k.call(r,c,d,!1)}function w(c){var d,k;r.nodeName&&(g?(d={},d[g]=!0):d=c,a.objectEach(d,function(a,d){if(c[d])for(k=c[d].length;k--;)t(d,c[d][k])}))}var l,u;a.each([\"protoEvents\",\"hcEvents\"],function(c){var d=r[c];d&&(g?(l=d[g]||[],e?(u=a.inArray(e,l),-1<u&&(l.splice(u,1),d[g]=l),t(g,e)):(w(d),d[g]=\r\n[])):(w(d),r[c]={}))})};a.fireEvent=function(r,g,e,t){var w,l,u,c,d;e=e||{};F.createEvent&&(r.dispatchEvent||r.fireEvent)?(w=F.createEvent(\"Events\"),w.initEvent(g,!0,!0),a.extend(w,e),r.dispatchEvent?r.dispatchEvent(w):r.fireEvent(g,w)):a.each([\"protoEvents\",\"hcEvents\"],function(k){if(r[k])for(l=r[k][g]||[],u=l.length,e.target||a.extend(e,{preventDefault:function(){e.defaultPrevented=!0},target:r,type:g}),c=0;c<u;c++)(d=l[c])&&!1===d.call(r,e)&&e.preventDefault()});t&&!e.defaultPrevented&&t.call(r,\r\ne)};a.animate=function(r,g,e){var t,w=\"\",l,u,c;a.isObject(e)||(c=arguments,e={duration:c[2],easing:c[3],complete:c[4]});a.isNumber(e.duration)||(e.duration=400);e.easing=\"function\"===typeof e.easing?e.easing:Math[e.easing]||Math.easeInOutSine;e.curAnim=a.merge(g);a.objectEach(g,function(c,k){a.stop(r,k);u=new a.Fx(r,e,k);l=null;\"d\"===k?(u.paths=u.initPath(r,r.d,g.d),u.toD=g.d,t=0,l=1):r.attr?t=r.attr(k):(t=parseFloat(a.getStyle(r,k))||0,\"opacity\"!==k&&(w=\"px\"));l||(l=c);l&&l.match&&l.match(\"px\")&&\r\n(l=l.replace(/px/g,\"\"));u.run(t,l,w)})};a.seriesType=function(r,g,e,t,w){var l=a.getOptions(),u=a.seriesTypes;l.plotOptions[r]=a.merge(l.plotOptions[g],e);u[r]=a.extendClass(u[g]||function(){},t);u[r].prototype.type=r;w&&(u[r].prototype.pointClass=a.extendClass(a.Point,w));return u[r]};a.uniqueKey=function(){var a=Math.random().toString(36).substring(2,9),g=0;return function(){return\"highcharts-\"+a+\"-\"+g++}}();D.jQuery&&(D.jQuery.fn.highcharts=function(){var r=[].slice.call(arguments);if(this[0])return r[0]?\r\n(new (a[a.isString(r[0])?r.shift():\"Chart\"])(this[0],r[0],r[1]),this):C[a.attr(this[0],\"data-highcharts-chart\")]})})(K);(function(a){var C=a.each,F=a.isNumber,D=a.map,r=a.merge,g=a.pInt;a.Color=function(e){if(!(this instanceof a.Color))return new a.Color(e);this.init(e)};a.Color.prototype={parsers:[{regex:/rgba\\(\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*,\\s*([0-9]?(?:\\.[0-9]+)?)\\s*\\)/,parse:function(a){return[g(a[1]),g(a[2]),g(a[3]),parseFloat(a[4],10)]}},{regex:/rgb\\(\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*\\)/,\r\nparse:function(a){return[g(a[1]),g(a[2]),g(a[3]),1]}}],names:{none:\"rgba(255,255,255,0)\",white:\"#ffffff\",black:\"#000000\"},init:function(e){var g,w,l,u;if((this.input=e=this.names[e&&e.toLowerCase?e.toLowerCase():\"\"]||e)&&e.stops)this.stops=D(e.stops,function(c){return new a.Color(c[1])});else if(e&&e.charAt&&\"#\"===e.charAt()&&(g=e.length,e=parseInt(e.substr(1),16),7===g?w=[(e&16711680)>>16,(e&65280)>>8,e&255,1]:4===g&&(w=[(e&3840)>>4|(e&3840)>>8,(e&240)>>4|e&240,(e&15)<<4|e&15,1])),!w)for(l=this.parsers.length;l--&&\r\n!w;)u=this.parsers[l],(g=u.regex.exec(e))&&(w=u.parse(g));this.rgba=w||[]},get:function(a){var e=this.input,g=this.rgba,l;this.stops?(l=r(e),l.stops=[].concat(l.stops),C(this.stops,function(e,c){l.stops[c]=[l.stops[c][0],e.get(a)]})):l=g&&F(g[0])?\"rgb\"===a||!a&&1===g[3]?\"rgb(\"+g[0]+\",\"+g[1]+\",\"+g[2]+\")\":\"a\"===a?g[3]:\"rgba(\"+g.join(\",\")+\")\":e;return l},brighten:function(a){var e,w=this.rgba;if(this.stops)C(this.stops,function(e){e.brighten(a)});else if(F(a)&&0!==a)for(e=0;3>e;e++)w[e]+=g(255*a),0>\r\nw[e]&&(w[e]=0),255<w[e]&&(w[e]=255);return this},setOpacity:function(a){this.rgba[3]=a;return this},tweenTo:function(a,g){var e=this.rgba,l=a.rgba;l.length&&e&&e.length?(a=1!==l[3]||1!==e[3],g=(a?\"rgba(\":\"rgb(\")+Math.round(l[0]+(e[0]-l[0])*(1-g))+\",\"+Math.round(l[1]+(e[1]-l[1])*(1-g))+\",\"+Math.round(l[2]+(e[2]-l[2])*(1-g))+(a?\",\"+(l[3]+(e[3]-l[3])*(1-g)):\"\")+\")\"):g=a.input||\"none\";return g}};a.color=function(e){return new a.Color(e)}})(K);(function(a){var C,F,D=a.addEvent,r=a.animate,g=a.attr,e=a.charts,\r\nt=a.color,w=a.css,l=a.createElement,u=a.defined,c=a.deg2rad,d=a.destroyObjectProperties,k=a.doc,x=a.each,p=a.extend,f=a.erase,b=a.grep,n=a.hasTouch,z=a.inArray,J=a.isArray,q=a.isFirefox,L=a.isMS,B=a.isObject,H=a.isString,m=a.isWebKit,E=a.merge,A=a.noop,M=a.objectEach,G=a.pick,h=a.pInt,v=a.removeEvent,Q=a.stop,P=a.svg,I=a.SVG_NS,O=a.symbolSizes,N=a.win;C=a.SVGElement=function(){return this};p(C.prototype,{opacity:1,SVG_NS:I,textProps:\"direction fontSize fontWeight fontFamily fontStyle color lineHeight width textAlign textDecoration textOverflow textOutline\".split(\" \"),\r\ninit:function(a,h){this.element=\"span\"===h?l(h):k.createElementNS(this.SVG_NS,h);this.renderer=a},animate:function(y,h,b){h=a.animObject(G(h,this.renderer.globalAnimation,!0));0!==h.duration?(b&&(h.complete=b),r(this,y,h)):(this.attr(y,null,b),h.step&&h.step.call(this));return this},complexColor:function(y,h,b){var f=this.renderer,v,c,d,m,I,p,A,n,k,R,q,z=[],P;a.fireEvent(this.renderer,\"complexColor\",{args:arguments},function(){y.radialGradient?c=\"radialGradient\":y.linearGradient&&(c=\"linearGradient\");\r\nc&&(d=y[c],I=f.gradients,A=y.stops,R=b.radialReference,J(d)&&(y[c]=d={x1:d[0],y1:d[1],x2:d[2],y2:d[3],gradientUnits:\"userSpaceOnUse\"}),\"radialGradient\"===c&&R&&!u(d.gradientUnits)&&(m=d,d=E(d,f.getRadialAttr(R,m),{gradientUnits:\"userSpaceOnUse\"})),M(d,function(a,y){\"id\"!==y&&z.push(y,a)}),M(A,function(a){z.push(a)}),z=z.join(\",\"),I[z]?q=I[z].attr(\"id\"):(d.id=q=a.uniqueKey(),I[z]=p=f.createElement(c).attr(d).add(f.defs),p.radAttr=m,p.stops=[],x(A,function(y){0===y[1].indexOf(\"rgba\")?(v=a.color(y[1]),\r\nn=v.get(\"rgb\"),k=v.get(\"a\")):(n=y[1],k=1);y=f.createElement(\"stop\").attr({offset:y[0],\"stop-color\":n,\"stop-opacity\":k}).add(p);p.stops.push(y)})),P=\"url(\"+f.url+\"#\"+q+\")\",b.setAttribute(h,P),b.gradient=z,y.toString=function(){return P})})},applyTextOutline:function(y){var h=this.element,b,v,c,d,m;-1!==y.indexOf(\"contrast\")&&(y=y.replace(/contrast/g,this.renderer.getContrast(h.style.fill)));y=y.split(\" \");v=y[y.length-1];if((c=y[0])&&\"none\"!==c&&a.svg){this.fakeTS=!0;y=[].slice.call(h.getElementsByTagName(\"tspan\"));\r\nthis.ySetter=this.xSetter;c=c.replace(/(^[\\d\\.]+)(.*?)$/g,function(a,y,h){return 2*y+h});for(m=y.length;m--;)b=y[m],\"highcharts-text-outline\"===b.getAttribute(\"class\")&&f(y,h.removeChild(b));d=h.firstChild;x(y,function(a,y){0===y&&(a.setAttribute(\"x\",h.getAttribute(\"x\")),y=h.getAttribute(\"y\"),a.setAttribute(\"y\",y||0),null===y&&h.setAttribute(\"y\",0));a=a.cloneNode(1);g(a,{\"class\":\"highcharts-text-outline\",fill:v,stroke:v,\"stroke-width\":c,\"stroke-linejoin\":\"round\"});h.insertBefore(a,d)})}},attr:function(a,\r\nh,b,c){var y,f=this.element,v,d=this,m,I;\"string\"===typeof a&&void 0!==h&&(y=a,a={},a[y]=h);\"string\"===typeof a?d=(this[a+\"Getter\"]||this._defaultGetter).call(this,a,f):(M(a,function(y,h){m=!1;c||Q(this,h);this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)$/.test(h)&&(v||(this.symbolAttr(a),v=!0),m=!0);!this.rotation||\"x\"!==h&&\"y\"!==h||(this.doTransform=!0);m||(I=this[h+\"Setter\"]||this._defaultSetter,I.call(this,y,h,f),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(h)&&\r\nthis.updateShadows(h,y,I))},this),this.afterSetters());b&&b.call(this);return d},afterSetters:function(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)},updateShadows:function(a,h,b){for(var y=this.shadows,c=y.length;c--;)b.call(y[c],\"height\"===a?Math.max(h-(y[c].cutHeight||0),0):\"d\"===a?this.d:h,a,y[c])},addClass:function(a,h){var y=this.attr(\"class\")||\"\";-1===y.indexOf(a)&&(h||(a=(y+(y?\" \":\"\")+a).replace(\"  \",\" \")),this.attr(\"class\",a));return this},hasClass:function(a){return-1!==\r\nz(a,(this.attr(\"class\")||\"\").split(\" \"))},removeClass:function(a){return this.attr(\"class\",(this.attr(\"class\")||\"\").replace(a,\"\"))},symbolAttr:function(a){var y=this;x(\"x y r start end width height innerR anchorX anchorY\".split(\" \"),function(h){y[h]=G(a[h],y[h])});y.attr({d:y.renderer.symbols[y.symbolName](y.x,y.y,y.width,y.height,y)})},clip:function(a){return this.attr(\"clip-path\",a?\"url(\"+this.renderer.url+\"#\"+a.id+\")\":\"none\")},crisp:function(a,h){var y;h=h||a.strokeWidth||0;y=Math.round(h)%2/2;\r\na.x=Math.floor(a.x||this.x||0)+y;a.y=Math.floor(a.y||this.y||0)+y;a.width=Math.floor((a.width||this.width||0)-2*y);a.height=Math.floor((a.height||this.height||0)-2*y);u(a.strokeWidth)&&(a.strokeWidth=h);return a},css:function(a){var y=this.styles,b={},c=this.element,f,v=\"\",d,m=!y,I=[\"textOutline\",\"textOverflow\",\"width\"];a&&a.color&&(a.fill=a.color);y&&M(a,function(a,h){a!==y[h]&&(b[h]=a,m=!0)});m&&(y&&(a=p(y,b)),f=this.textWidth=a&&a.width&&\"auto\"!==a.width&&\"text\"===c.nodeName.toLowerCase()&&h(a.width),\r\nthis.styles=a,f&&!P&&this.renderer.forExport&&delete a.width,c.namespaceURI===this.SVG_NS?(d=function(a,y){return\"-\"+y.toLowerCase()},M(a,function(a,y){-1===z(y,I)&&(v+=y.replace(/([A-Z])/g,d)+\":\"+a+\";\")}),v&&g(c,\"style\",v)):w(c,a),this.added&&(\"text\"===this.element.nodeName&&this.renderer.buildText(this),a&&a.textOutline&&this.applyTextOutline(a.textOutline)));return this},strokeWidth:function(){return this[\"stroke-width\"]||0},on:function(a,h){var y=this,b=y.element;n&&\"click\"===a?(b.ontouchstart=\r\nfunction(a){y.touchEventFired=Date.now();a.preventDefault();h.call(b,a)},b.onclick=function(a){(-1===N.navigator.userAgent.indexOf(\"Android\")||1100<Date.now()-(y.touchEventFired||0))&&h.call(b,a)}):b[\"on\"+a]=h;return this},setRadialReference:function(a){var y=this.renderer.gradients[this.element.gradient];this.element.radialReference=a;y&&y.radAttr&&y.animate(this.renderer.getRadialAttr(a,y.radAttr));return this},translate:function(a,h){return this.attr({translateX:a,translateY:h})},invert:function(a){this.inverted=\r\na;this.updateTransform();return this},updateTransform:function(){var a=this.translateX||0,h=this.translateY||0,b=this.scaleX,c=this.scaleY,v=this.inverted,f=this.rotation,d=this.matrix,m=this.element;v&&(a+=this.width,h+=this.height);a=[\"translate(\"+a+\",\"+h+\")\"];u(d)&&a.push(\"matrix(\"+d.join(\",\")+\")\");v?a.push(\"rotate(90) scale(-1,1)\"):f&&a.push(\"rotate(\"+f+\" \"+G(this.rotationOriginX,m.getAttribute(\"x\"),0)+\" \"+G(this.rotationOriginY,m.getAttribute(\"y\")||0)+\")\");(u(b)||u(c))&&a.push(\"scale(\"+G(b,1)+\r\n\" \"+G(c,1)+\")\");a.length&&m.setAttribute(\"transform\",a.join(\" \"))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,h,b){var y,c,v,d,m={};c=this.renderer;v=c.alignedObjects;var I,p;if(a){if(this.alignOptions=a,this.alignByTranslate=h,!b||H(b))this.alignTo=y=b||\"renderer\",f(v,this),v.push(this),b=null}else a=this.alignOptions,h=this.alignByTranslate,y=this.alignTo;b=G(b,c[y],c);y=a.align;c=a.verticalAlign;v=(b.x||0)+(a.x||0);d=(b.y||0)+(a.y||0);\"right\"===\r\ny?I=1:\"center\"===y&&(I=2);I&&(v+=(b.width-(a.width||0))/I);m[h?\"translateX\":\"x\"]=Math.round(v);\"bottom\"===c?p=1:\"middle\"===c&&(p=2);p&&(d+=(b.height-(a.height||0))/p);m[h?\"translateY\":\"y\"]=Math.round(d);this[this.placed?\"animate\":\"attr\"](m);this.placed=!0;this.alignAttr=m;return this},getBBox:function(a,h){var y,b=this.renderer,v,f=this.element,d=this.styles,m,I=this.textStr,A,n=b.cache,k=b.cacheKeys,q;h=G(h,this.rotation);v=h*c;m=d&&d.fontSize;u(I)&&(q=I.toString(),-1===q.indexOf(\"\\x3c\")&&(q=q.replace(/[0-9]/g,\r\n\"0\")),q+=[\"\",h||0,m,this.textWidth,d&&d.textOverflow].join());q&&!a&&(y=n[q]);if(!y){if(f.namespaceURI===this.SVG_NS||b.forExport){try{(A=this.fakeTS&&function(a){x(f.querySelectorAll(\".highcharts-text-outline\"),function(y){y.style.display=a})})&&A(\"none\"),y=f.getBBox?p({},f.getBBox()):{width:f.offsetWidth,height:f.offsetHeight},A&&A(\"\")}catch(W){}if(!y||0>y.width)y={width:0,height:0}}else y=this.htmlGetBBox();b.isSVG&&(a=y.width,b=y.height,d&&\"11px\"===d.fontSize&&17===Math.round(b)&&(y.height=b=\r\n14),h&&(y.width=Math.abs(b*Math.sin(v))+Math.abs(a*Math.cos(v)),y.height=Math.abs(b*Math.cos(v))+Math.abs(a*Math.sin(v))));if(q&&0<y.height){for(;250<k.length;)delete n[k.shift()];n[q]||k.push(q);n[q]=y}}return y},show:function(a){return this.attr({visibility:a?\"inherit\":\"visible\"})},hide:function(){return this.attr({visibility:\"hidden\"})},fadeOut:function(a){var y=this;y.animate({opacity:0},{duration:a||150,complete:function(){y.attr({y:-9999})}})},add:function(a){var y=this.renderer,h=this.element,\r\nb;a&&(this.parentGroup=a);this.parentInverted=a&&a.inverted;void 0!==this.textStr&&y.buildText(this);this.added=!0;if(!a||a.handleZ||this.zIndex)b=this.zIndexSetter();b||(a?a.element:y.box).appendChild(h);if(this.onAdd)this.onAdd();return this},safeRemoveChild:function(a){var y=a.parentNode;y&&y.removeChild(a)},destroy:function(){var a=this,h=a.element||{},b=a.renderer.isSVG&&\"SPAN\"===h.nodeName&&a.parentGroup,c=h.ownerSVGElement,v=a.clipPath;h.onclick=h.onmouseout=h.onmouseover=h.onmousemove=h.point=\r\nnull;Q(a);v&&c&&(x(c.querySelectorAll(\"[clip-path],[CLIP-PATH]\"),function(a){var h=a.getAttribute(\"clip-path\"),y=v.element.id;(-1<h.indexOf(\"(#\"+y+\")\")||-1<h.indexOf('(\"#'+y+'\")'))&&a.removeAttribute(\"clip-path\")}),a.clipPath=v.destroy());if(a.stops){for(c=0;c<a.stops.length;c++)a.stops[c]=a.stops[c].destroy();a.stops=null}a.safeRemoveChild(h);for(a.destroyShadows();b&&b.div&&0===b.div.childNodes.length;)h=b.parentGroup,a.safeRemoveChild(b.div),delete b.div,b=h;a.alignTo&&f(a.renderer.alignedObjects,\r\na);M(a,function(h,y){delete a[y]});return null},shadow:function(a,h,b){var y=[],c,v,f=this.element,d,m,I,p;if(!a)this.destroyShadows();else if(!this.shadows){m=G(a.width,3);I=(a.opacity||.15)/m;p=this.parentInverted?\"(-1,-1)\":\"(\"+G(a.offsetX,1)+\", \"+G(a.offsetY,1)+\")\";for(c=1;c<=m;c++)v=f.cloneNode(0),d=2*m+1-2*c,g(v,{isShadow:\"true\",stroke:a.color||\"#000000\",\"stroke-opacity\":I*c,\"stroke-width\":d,transform:\"translate\"+p,fill:\"none\"}),b&&(g(v,\"height\",Math.max(g(v,\"height\")-d,0)),v.cutHeight=d),h?\r\nh.element.appendChild(v):f.parentNode&&f.parentNode.insertBefore(v,f),y.push(v);this.shadows=y}return this},destroyShadows:function(){x(this.shadows||[],function(a){this.safeRemoveChild(a)},this);this.shadows=void 0},xGetter:function(a){\"circle\"===this.element.nodeName&&(\"x\"===a?a=\"cx\":\"y\"===a&&(a=\"cy\"));return this._defaultGetter(a)},_defaultGetter:function(a){a=G(this[a+\"Value\"],this[a],this.element?this.element.getAttribute(a):null,0);/^[\\-0-9\\.]+$/.test(a)&&(a=parseFloat(a));return a},dSetter:function(a,\r\nh,b){a&&a.join&&(a=a.join(\" \"));/(NaN| {2}|^$)/.test(a)&&(a=\"M 0 0\");this[h]!==a&&(b.setAttribute(h,a),this[h]=a)},dashstyleSetter:function(a){var b,y=this[\"stroke-width\"];\"inherit\"===y&&(y=1);if(a=a&&a.toLowerCase()){a=a.replace(\"shortdashdotdot\",\"3,1,1,1,1,1,\").replace(\"shortdashdot\",\"3,1,1,1\").replace(\"shortdot\",\"1,1,\").replace(\"shortdash\",\"3,1,\").replace(\"longdash\",\"8,3,\").replace(/dot/g,\"1,3,\").replace(\"dash\",\"4,3,\").replace(/,$/,\"\").split(\",\");for(b=a.length;b--;)a[b]=h(a[b])*y;a=a.join(\",\").replace(/NaN/g,\r\n\"none\");this.element.setAttribute(\"stroke-dasharray\",a)}},alignSetter:function(a){this.alignValue=a;this.element.setAttribute(\"text-anchor\",{left:\"start\",center:\"middle\",right:\"end\"}[a])},opacitySetter:function(a,h,b){this[h]=a;b.setAttribute(h,a)},titleSetter:function(a){var h=this.element.getElementsByTagName(\"title\")[0];h||(h=k.createElementNS(this.SVG_NS,\"title\"),this.element.appendChild(h));h.firstChild&&h.removeChild(h.firstChild);h.appendChild(k.createTextNode(String(G(a),\"\").replace(/<[^>]*>/g,\r\n\"\").replace(/&lt;/g,\"\\x3c\").replace(/&gt;/g,\"\\x3e\")))},textSetter:function(a){a!==this.textStr&&(delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this))},fillSetter:function(a,h,b){\"string\"===typeof a?b.setAttribute(h,a):a&&this.complexColor(a,h,b)},visibilitySetter:function(a,h,b){\"inherit\"===a?b.removeAttribute(h):this[h]!==a&&b.setAttribute(h,a);this[h]=a},zIndexSetter:function(a,b){var c=this.renderer,v=this.parentGroup,y=(v||c).element||c.box,f,d=this.element,m,I,c=y===c.box;\r\nf=this.added;var p;u(a)&&(d.zIndex=a,a=+a,this[b]===a&&(f=!1),this[b]=a);if(f){(a=this.zIndex)&&v&&(v.handleZ=!0);b=y.childNodes;for(p=b.length-1;0<=p&&!m;p--)if(v=b[p],f=v.zIndex,I=!u(f),v!==d)if(0>a&&I&&!c&&!p)y.insertBefore(d,b[p]),m=!0;else if(h(f)<=a||I&&(!u(a)||0<=a))y.insertBefore(d,b[p+1]||null),m=!0;m||(y.insertBefore(d,b[c?3:0]||null),m=!0)}return m},_defaultSetter:function(a,h,b){b.setAttribute(h,a)}});C.prototype.yGetter=C.prototype.xGetter;C.prototype.translateXSetter=C.prototype.translateYSetter=\r\nC.prototype.rotationSetter=C.prototype.verticalAlignSetter=C.prototype.rotationOriginXSetter=C.prototype.rotationOriginYSetter=C.prototype.scaleXSetter=C.prototype.scaleYSetter=C.prototype.matrixSetter=function(a,h){this[h]=a;this.doTransform=!0};C.prototype[\"stroke-widthSetter\"]=C.prototype.strokeSetter=function(a,h,b){this[h]=a;this.stroke&&this[\"stroke-width\"]?(C.prototype.fillSetter.call(this,this.stroke,\"stroke\",b),b.setAttribute(\"stroke-width\",this[\"stroke-width\"]),this.hasStroke=!0):\"stroke-width\"===\r\nh&&0===a&&this.hasStroke&&(b.removeAttribute(\"stroke\"),this.hasStroke=!1)};F=a.SVGRenderer=function(){this.init.apply(this,arguments)};p(F.prototype,{Element:C,SVG_NS:I,init:function(a,h,b,c,v,f){var y;c=this.createElement(\"svg\").attr({version:\"1.1\",\"class\":\"highcharts-root\"}).css(this.getStyle(c));y=c.element;a.appendChild(y);g(a,\"dir\",\"ltr\");-1===a.innerHTML.indexOf(\"xmlns\")&&g(y,\"xmlns\",this.SVG_NS);this.isSVG=!0;this.box=y;this.boxWrapper=c;this.alignedObjects=[];this.url=(q||m)&&k.getElementsByTagName(\"base\").length?\r\nN.location.href.replace(/#.*?$/,\"\").replace(/<[^>]*>/g,\"\").replace(/([\\('\\)])/g,\"\\\\$1\").replace(/ /g,\"%20\"):\"\";this.createElement(\"desc\").add().element.appendChild(k.createTextNode(\"Created with Highcharts 6.1.0\"));this.defs=this.createElement(\"defs\").add();this.allowHTML=f;this.forExport=v;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(h,b,!1);var d;q&&a.getBoundingClientRect&&(h=function(){w(a,{left:0,top:0});d=a.getBoundingClientRect();w(a,{left:Math.ceil(d.left)-\r\nd.left+\"px\",top:Math.ceil(d.top)-d.top+\"px\"})},h(),this.unSubPixelFix=D(N,\"resize\",h))},getStyle:function(a){return this.style=p({fontFamily:'\"Lucida Grande\", \"Lucida Sans Unicode\", Arial, Helvetica, sans-serif',fontSize:\"12px\"},a)},setStyle:function(a){this.boxWrapper.css(this.getStyle(a))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;this.box=null;this.boxWrapper=this.boxWrapper.destroy();d(this.gradients||{});this.gradients=null;a&&(this.defs=a.destroy());\r\nthis.unSubPixelFix&&this.unSubPixelFix();return this.alignedObjects=null},createElement:function(a){var h=new this.Element;h.init(this,a);return h},draw:A,getRadialAttr:function(a,h){return{cx:a[0]-a[2]/2+h.cx*a[2],cy:a[1]-a[2]/2+h.cy*a[2],r:h.r*a[2]}},getSpanWidth:function(a){return a.getBBox(!0).width},applyEllipsis:function(a,h,b,c){var v=a.rotation,f=b,d,y=0,m=b.length,I=function(a){h.removeChild(h.firstChild);a&&h.appendChild(k.createTextNode(a))},p;a.rotation=0;f=this.getSpanWidth(a,h);if(p=\r\nf>c){for(;y<=m;)d=Math.ceil((y+m)/2),f=b.substring(0,d)+\"\\u2026\",I(f),f=this.getSpanWidth(a,h),y===m?y=m+1:f>c?m=d-1:y=d;0===m&&I(\"\")}a.rotation=v;return p},escapes:{\"\\x26\":\"\\x26amp;\",\"\\x3c\":\"\\x26lt;\",\"\\x3e\":\"\\x26gt;\",\"'\":\"\\x26#39;\",'\"':\"\\x26quot;\"},buildText:function(a){var c=a.element,v=this,f=v.forExport,d=G(a.textStr,\"\").toString(),y=-1!==d.indexOf(\"\\x3c\"),m=c.childNodes,p,A=g(c,\"x\"),n=a.styles,q=a.textWidth,E=n&&n.lineHeight,e=n&&n.textOutline,B=n&&\"ellipsis\"===n.textOverflow,Q=n&&\"nowrap\"===\r\nn.whiteSpace,u=n&&n.fontSize,l,O,H=m.length,n=q&&!a.added&&this.box,J=function(a){var b;b=/(px|em)$/.test(a&&a.style.fontSize)?a.style.fontSize:u||v.style.fontSize||12;return E?h(E):v.fontMetrics(b,a.getAttribute(\"style\")?a:c).h},N=function(a,h){M(v.escapes,function(b,c){h&&-1!==z(b,h)||(a=a.toString().replace(new RegExp(b,\"g\"),c))});return a},t=function(a,h){var b;b=a.indexOf(\"\\x3c\");a=a.substring(b,a.indexOf(\"\\x3e\")-b);b=a.indexOf(h+\"\\x3d\");if(-1!==b&&(b=b+h.length+1,h=a.charAt(b),'\"'===h||\"'\"===\r\nh))return a=a.substring(b+1),a.substring(0,a.indexOf(h))};l=[d,B,Q,E,e,u,q].join();if(l!==a.textCache){for(a.textCache=l;H--;)c.removeChild(m[H]);y||e||B||q||-1!==d.indexOf(\" \")?(n&&n.appendChild(c),d=y?d.replace(/<(b|strong)>/g,'\\x3cspan style\\x3d\"font-weight:bold\"\\x3e').replace(/<(i|em)>/g,'\\x3cspan style\\x3d\"font-style:italic\"\\x3e').replace(/<a/g,\"\\x3cspan\").replace(/<\\/(b|strong|i|em|a)>/g,\"\\x3c/span\\x3e\").split(/<br.*?>/g):[d],d=b(d,function(a){return\"\"!==a}),x(d,function(h,b){var d,y=0;h=h.replace(/^\\s+|\\s+$/g,\r\n\"\").replace(/<span/g,\"|||\\x3cspan\").replace(/<\\/span>/g,\"\\x3c/span\\x3e|||\");d=h.split(\"|||\");x(d,function(h){if(\"\"!==h||1===d.length){var m={},n=k.createElementNS(v.SVG_NS,\"tspan\"),E,z;(E=t(h,\"class\"))&&g(n,\"class\",E);if(E=t(h,\"style\"))E=E.replace(/(;| |^)color([ :])/,\"$1fill$2\"),g(n,\"style\",E);(z=t(h,\"href\"))&&!f&&(g(n,\"onclick\",'location.href\\x3d\"'+z+'\"'),g(n,\"class\",\"highcharts-anchor\"),w(n,{cursor:\"pointer\"}));h=N(h.replace(/<[a-zA-Z\\/](.|\\n)*?>/g,\"\")||\" \");if(\" \"!==h){n.appendChild(k.createTextNode(h));\r\ny?m.dx=0:b&&null!==A&&(m.x=A);g(n,m);c.appendChild(n);!y&&O&&(!P&&f&&w(n,{display:\"block\"}),g(n,\"dy\",J(n)));if(q){m=h.replace(/([^\\^])-/g,\"$1- \").split(\" \");z=1<d.length||b||1<m.length&&!Q;var e=[],x,G=J(n),u=a.rotation;for(B&&(p=v.applyEllipsis(a,n,h,q));!B&&z&&(m.length||e.length);)a.rotation=0,x=v.getSpanWidth(a,n),h=x>q,void 0===p&&(p=h),h&&1!==m.length?(n.removeChild(n.firstChild),e.unshift(m.pop())):(m=e,e=[],m.length&&!Q&&(n=k.createElementNS(I,\"tspan\"),g(n,{dy:G,x:A}),E&&g(n,\"style\",E),c.appendChild(n)),\r\nx>q&&(q=x)),m.length&&n.appendChild(k.createTextNode(m.join(\" \").replace(/- /g,\"-\")));a.rotation=u}y++}}});O=O||c.childNodes.length}),p&&a.attr(\"title\",N(a.textStr,[\"\\x26lt;\",\"\\x26gt;\"])),n&&n.removeChild(c),e&&a.applyTextOutline&&a.applyTextOutline(e)):c.appendChild(k.createTextNode(N(d)))}},getContrast:function(a){a=t(a).rgba;return 510<a[0]+a[1]+a[2]?\"#000000\":\"#FFFFFF\"},button:function(a,h,b,c,v,f,d,m,I){var y=this.label(a,h,b,I,null,null,null,null,\"button\"),n=0;y.attr(E({padding:8,r:2},v));var A,\r\nk,q,z;v=E({fill:\"#f7f7f7\",stroke:\"#cccccc\",\"stroke-width\":1,style:{color:\"#333333\",cursor:\"pointer\",fontWeight:\"normal\"}},v);A=v.style;delete v.style;f=E(v,{fill:\"#e6e6e6\"},f);k=f.style;delete f.style;d=E(v,{fill:\"#e6ebf5\",style:{color:\"#000000\",fontWeight:\"bold\"}},d);q=d.style;delete d.style;m=E(v,{style:{color:\"#cccccc\"}},m);z=m.style;delete m.style;D(y.element,L?\"mouseover\":\"mouseenter\",function(){3!==n&&y.setState(1)});D(y.element,L?\"mouseout\":\"mouseleave\",function(){3!==n&&y.setState(n)});y.setState=\r\nfunction(a){1!==a&&(y.state=n=a);y.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass(\"highcharts-button-\"+[\"normal\",\"hover\",\"pressed\",\"disabled\"][a||0]);y.attr([v,f,d,m][a||0]).css([A,k,q,z][a||0])};y.attr(v).css(p({cursor:\"default\"},A));return y.on(\"click\",function(a){3!==n&&c.call(y,a)})},crispLine:function(a,h){a[1]===a[4]&&(a[1]=a[4]=Math.round(a[1])-h%2/2);a[2]===a[5]&&(a[2]=a[5]=Math.round(a[2])+h%2/2);return a},path:function(a){var h={fill:\"none\"};J(a)?h.d=a:B(a)&&p(h,\r\na);return this.createElement(\"path\").attr(h)},circle:function(a,h,b){a=B(a)?a:{x:a,y:h,r:b};h=this.createElement(\"circle\");h.xSetter=h.ySetter=function(a,h,b){b.setAttribute(\"c\"+h,a)};return h.attr(a)},arc:function(a,h,b,c,v,f){B(a)?(c=a,h=c.y,b=c.r,a=c.x):c={innerR:c,start:v,end:f};a=this.symbol(\"arc\",a,h,b,b,c);a.r=b;return a},rect:function(a,h,b,c,v,f){v=B(a)?a.r:v;var d=this.createElement(\"rect\");a=B(a)?a:void 0===a?{}:{x:a,y:h,width:Math.max(b,0),height:Math.max(c,0)};void 0!==f&&(a.strokeWidth=\r\nf,a=d.crisp(a));a.fill=\"none\";v&&(a.r=v);d.rSetter=function(a,h,b){g(b,{rx:a,ry:a})};return d.attr(a)},setSize:function(a,h,b){var c=this.alignedObjects,v=c.length;this.width=a;this.height=h;for(this.boxWrapper.animate({width:a,height:h},{step:function(){this.attr({viewBox:\"0 0 \"+this.attr(\"width\")+\" \"+this.attr(\"height\")})},duration:G(b,!0)?void 0:0});v--;)c[v].align()},g:function(a){var h=this.createElement(\"g\");return a?h.attr({\"class\":\"highcharts-\"+a}):h},image:function(a,h,b,c,v,f){var d={preserveAspectRatio:\"none\"},\r\nm,I=function(a,h){a.setAttributeNS?a.setAttributeNS(\"http://www.w3.org/1999/xlink\",\"href\",h):a.setAttribute(\"hc-svg-href\",h)};1<arguments.length&&p(d,{x:h,y:b,width:c,height:v});m=this.createElement(\"image\").attr(d);f?(I(m.element,\"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw\\x3d\\x3d\"),d=new N.Image,D(d,\"load\",function(h){I(m.element,a);f.call(m,h)}),d.src=a):I(m.element,a);return m},symbol:function(a,h,b,c,v,f){var d=this,m,I=/^url\\((.*?)\\)$/,n=I.test(a),y=!n&&(this.symbols[a]?\r\na:\"circle\"),A=y&&this.symbols[y],q=u(h)&&A&&A.call(this.symbols,Math.round(h),Math.round(b),c,v,f),E,z;A?(m=this.path(q),m.attr(\"fill\",\"none\"),p(m,{symbolName:y,x:h,y:b,width:c,height:v}),f&&p(m,f)):n&&(E=a.match(I)[1],m=this.image(E),m.imgwidth=G(O[E]&&O[E].width,f&&f.width),m.imgheight=G(O[E]&&O[E].height,f&&f.height),z=function(){m.attr({width:m.width,height:m.height})},x([\"width\",\"height\"],function(a){m[a+\"Setter\"]=function(a,h){var b={},c=this[\"img\"+h],v=\"width\"===h?\"translateX\":\"translateY\";\r\nthis[h]=a;u(c)&&(this.element&&this.element.setAttribute(h,c),this.alignByTranslate||(b[v]=((this[h]||0)-c)/2,this.attr(b)))}}),u(h)&&m.attr({x:h,y:b}),m.isImg=!0,u(m.imgwidth)&&u(m.imgheight)?z():(m.attr({width:0,height:0}),l(\"img\",{onload:function(){var a=e[d.chartIndex];0===this.width&&(w(this,{position:\"absolute\",top:\"-999em\"}),k.body.appendChild(this));O[E]={width:this.width,height:this.height};m.imgwidth=this.width;m.imgheight=this.height;m.element&&z();this.parentNode&&this.parentNode.removeChild(this);\r\nd.imgCount--;if(!d.imgCount&&a&&a.onload)a.onload()},src:E}),this.imgCount++));return m},symbols:{circle:function(a,h,b,c){return this.arc(a+b/2,h+c/2,b/2,c/2,{start:0,end:2*Math.PI,open:!1})},square:function(a,h,b,c){return[\"M\",a,h,\"L\",a+b,h,a+b,h+c,a,h+c,\"Z\"]},triangle:function(a,h,b,c){return[\"M\",a+b/2,h,\"L\",a+b,h+c,a,h+c,\"Z\"]},\"triangle-down\":function(a,h,b,c){return[\"M\",a,h,\"L\",a+b,h,a+b/2,h+c,\"Z\"]},diamond:function(a,h,b,c){return[\"M\",a+b/2,h,\"L\",a+b,h+c/2,a+b/2,h+c,a,h+c/2,\"Z\"]},arc:function(a,\r\nh,b,c,v){var f=v.start,d=v.r||b,m=v.r||c||b,I=v.end-.001;b=v.innerR;c=G(v.open,.001>Math.abs(v.end-v.start-2*Math.PI));var n=Math.cos(f),p=Math.sin(f),y=Math.cos(I),I=Math.sin(I);v=.001>v.end-f-Math.PI?0:1;d=[\"M\",a+d*n,h+m*p,\"A\",d,m,0,v,1,a+d*y,h+m*I];u(b)&&d.push(c?\"M\":\"L\",a+b*y,h+b*I,\"A\",b,b,0,v,0,a+b*n,h+b*p);d.push(c?\"\":\"Z\");return d},callout:function(a,h,b,c,v){var f=Math.min(v&&v.r||0,b,c),d=f+6,m=v&&v.anchorX;v=v&&v.anchorY;var I;I=[\"M\",a+f,h,\"L\",a+b-f,h,\"C\",a+b,h,a+b,h,a+b,h+f,\"L\",a+b,h+c-\r\nf,\"C\",a+b,h+c,a+b,h+c,a+b-f,h+c,\"L\",a+f,h+c,\"C\",a,h+c,a,h+c,a,h+c-f,\"L\",a,h+f,\"C\",a,h,a,h,a+f,h];m&&m>b?v>h+d&&v<h+c-d?I.splice(13,3,\"L\",a+b,v-6,a+b+6,v,a+b,v+6,a+b,h+c-f):I.splice(13,3,\"L\",a+b,c/2,m,v,a+b,c/2,a+b,h+c-f):m&&0>m?v>h+d&&v<h+c-d?I.splice(33,3,\"L\",a,v+6,a-6,v,a,v-6,a,h+f):I.splice(33,3,\"L\",a,c/2,m,v,a,c/2,a,h+f):v&&v>c&&m>a+d&&m<a+b-d?I.splice(23,3,\"L\",m+6,h+c,m,h+c+6,m-6,h+c,a+f,h+c):v&&0>v&&m>a+d&&m<a+b-d&&I.splice(3,3,\"L\",m-6,h,m,h-6,m+6,h,b-f,h);return I}},clipRect:function(h,b,c,\r\nv){var f=a.uniqueKey(),d=this.createElement(\"clipPath\").attr({id:f}).add(this.defs);h=this.rect(h,b,c,v,0).add(d);h.id=f;h.clipPath=d;h.count=0;return h},text:function(a,h,b,c){var v={};if(c&&(this.allowHTML||!this.forExport))return this.html(a,h,b);v.x=Math.round(h||0);b&&(v.y=Math.round(b));if(a||0===a)v.text=a;a=this.createElement(\"text\").attr(v);c||(a.xSetter=function(a,h,b){var c=b.getElementsByTagName(\"tspan\"),v,f=b.getAttribute(h),d;for(d=0;d<c.length;d++)v=c[d],v.getAttribute(h)===f&&v.setAttribute(h,\r\na);b.setAttribute(h,a)});return a},fontMetrics:function(a,b){a=a||b&&b.style&&b.style.fontSize||this.style&&this.style.fontSize;a=/px/.test(a)?h(a):/em/.test(a)?parseFloat(a)*(b?this.fontMetrics(null,b.parentNode).f:16):12;b=24>a?a+3:Math.round(1.2*a);return{h:b,b:Math.round(.8*b),f:a}},rotCorr:function(a,h,b){var v=a;h&&b&&(v=Math.max(v*Math.cos(h*c),4));return{x:-a/3*Math.sin(h*c),y:v}},label:function(h,b,c,f,d,m,I,n,A){var k=this,q=k.g(\"button\"!==A&&\"label\"),z=q.text=k.text(\"\",0,0,I).attr({zIndex:1}),\r\ny,e,P=0,B=3,Q=0,g,G,l,O,H,J={},M,N,w=/^url\\((.*?)\\)$/.test(f),t=w,L,r,R,U;A&&q.addClass(\"highcharts-\"+A);t=w;L=function(){return(M||0)%2/2};r=function(){var a=z.element.style,h={};e=(void 0===g||void 0===G||H)&&u(z.textStr)&&z.getBBox();q.width=(g||e.width||0)+2*B+Q;q.height=(G||e.height||0)+2*B;N=B+k.fontMetrics(a&&a.fontSize,z).b;t&&(y||(q.box=y=k.symbols[f]||w?k.symbol(f):k.rect(),y.addClass((\"button\"===A?\"\":\"highcharts-label-box\")+(A?\" highcharts-\"+A+\"-box\":\"\")),y.add(q),a=L(),h.x=a,h.y=(n?-N:\r\n0)+a),h.width=Math.round(q.width),h.height=Math.round(q.height),y.attr(p(h,J)),J={})};R=function(){var a=Q+B,h;h=n?0:N;u(g)&&e&&(\"center\"===H||\"right\"===H)&&(a+={center:.5,right:1}[H]*(g-e.width));if(a!==z.x||h!==z.y)z.attr(\"x\",a),void 0!==h&&z.attr(\"y\",h);z.x=a;z.y=h};U=function(a,h){y?y.attr(a,h):J[a]=h};q.onAdd=function(){z.add(q);q.attr({text:h||0===h?h:\"\",x:b,y:c});y&&u(d)&&q.attr({anchorX:d,anchorY:m})};q.widthSetter=function(h){g=a.isNumber(h)?h:null};q.heightSetter=function(a){G=a};q[\"text-alignSetter\"]=\r\nfunction(a){H=a};q.paddingSetter=function(a){u(a)&&a!==B&&(B=q.padding=a,R())};q.paddingLeftSetter=function(a){u(a)&&a!==Q&&(Q=a,R())};q.alignSetter=function(a){a={left:0,center:.5,right:1}[a];a!==P&&(P=a,e&&q.attr({x:l}))};q.textSetter=function(a){void 0!==a&&z.textSetter(a);r();R()};q[\"stroke-widthSetter\"]=function(a,h){a&&(t=!0);M=this[\"stroke-width\"]=a;U(h,a)};q.strokeSetter=q.fillSetter=q.rSetter=function(a,h){\"r\"!==h&&(\"fill\"===h&&a&&(t=!0),q[h]=a);U(h,a)};q.anchorXSetter=function(a,h){d=q.anchorX=\r\na;U(h,Math.round(a)-L()-l)};q.anchorYSetter=function(a,h){m=q.anchorY=a;U(h,a-O)};q.xSetter=function(a){q.x=a;P&&(a-=P*((g||e.width)+2*B),q[\"forceAnimate:x\"]=!0);l=Math.round(a);q.attr(\"translateX\",l)};q.ySetter=function(a){O=q.y=Math.round(a);q.attr(\"translateY\",O)};var S=q.css;return p(q,{css:function(a){if(a){var h={};a=E(a);x(q.textProps,function(b){void 0!==a[b]&&(h[b]=a[b],delete a[b])});z.css(h);\"width\"in h&&r()}return S.call(q,a)},getBBox:function(){return{width:e.width+2*B,height:e.height+\r\n2*B,x:e.x-B,y:e.y-B}},shadow:function(a){a&&(r(),y&&y.shadow(a));return q},destroy:function(){v(q.element,\"mouseenter\");v(q.element,\"mouseleave\");z&&(z=z.destroy());y&&(y=y.destroy());C.prototype.destroy.call(q);q=k=r=R=U=null}})}});a.Renderer=F})(K);(function(a){var C=a.attr,F=a.createElement,D=a.css,r=a.defined,g=a.each,e=a.extend,t=a.isFirefox,w=a.isMS,l=a.isWebKit,u=a.pick,c=a.pInt,d=a.SVGRenderer,k=a.win,x=a.wrap;e(a.SVGElement.prototype,{htmlCss:function(a){var c=this.element;if(c=a&&\"SPAN\"===\r\nc.tagName&&a.width)delete a.width,this.textWidth=c,this.htmlUpdateTransform();a&&\"ellipsis\"===a.textOverflow&&(a.whiteSpace=\"nowrap\",a.overflow=\"hidden\");this.styles=e(this.styles,a);D(this.element,a);return this},htmlGetBBox:function(){var a=this.element;return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,f=this.element,b=this.translateX||0,d=this.translateY||0,k=this.x||0,e=this.y||0,q=this.textAlign||\r\n\"left\",x={left:0,center:.5,right:1}[q],B=this.styles,l=B&&B.whiteSpace;D(f,{marginLeft:b,marginTop:d});this.shadows&&g(this.shadows,function(a){D(a,{marginLeft:b+1,marginTop:d+1})});this.inverted&&g(f.childNodes,function(b){a.invertChild(b,f)});if(\"SPAN\"===f.tagName){var B=this.rotation,m=this.textWidth&&c(this.textWidth),E=[B,q,f.innerHTML,this.textWidth,this.textAlign].join(),A;(A=m!==this.oldTextWidth)&&!(A=m>this.oldTextWidth)&&((A=this.textPxLength)||(D(f,{width:\"\",whiteSpace:l||\"nowrap\"}),A=\r\nf.offsetWidth),A=A>m);A&&/[ \\-]/.test(f.textContent||f.innerText)&&(D(f,{width:m+\"px\",display:\"block\",whiteSpace:l||\"normal\"}),this.oldTextWidth=m);E!==this.cTT&&(l=a.fontMetrics(f.style.fontSize).b,r(B)&&B!==(this.oldRotation||0)&&this.setSpanRotation(B,x,l),this.getSpanCorrection(!r(B)&&this.textPxLength||f.offsetWidth,l,x,B,q));D(f,{left:k+(this.xCorr||0)+\"px\",top:e+(this.yCorr||0)+\"px\"});this.cTT=E;this.oldRotation=B}}else this.alignOnAdd=!0},setSpanRotation:function(a,c,b){var f={},d=this.renderer.getTransformKey();\r\nf[d]=f.transform=\"rotate(\"+a+\"deg)\";f[d+(t?\"Origin\":\"-origin\")]=f.transformOrigin=100*c+\"% \"+b+\"px\";D(this.element,f)},getSpanCorrection:function(a,c,b){this.xCorr=-a*b;this.yCorr=-c}});e(d.prototype,{getTransformKey:function(){return w&&!/Edge/.test(k.navigator.userAgent)?\"-ms-transform\":l?\"-webkit-transform\":t?\"MozTransform\":k.opera?\"-o-transform\":\"\"},html:function(a,c,b){var f=this.createElement(\"span\"),d=f.element,p=f.renderer,q=p.isSVG,k=function(a,b){g([\"opacity\",\"visibility\"],function(c){x(a,\r\nc+\"Setter\",function(a,c,f,d){a.call(this,c,f,d);b[f]=c})});a.addedSetters=!0};f.textSetter=function(a){a!==d.innerHTML&&delete this.bBox;this.textStr=a;d.innerHTML=u(a,\"\");f.doTransform=!0};q&&k(f,f.element.style);f.xSetter=f.ySetter=f.alignSetter=f.rotationSetter=function(a,b){\"align\"===b&&(b=\"textAlign\");f[b]=a;f.doTransform=!0};f.afterSetters=function(){this.doTransform&&(this.htmlUpdateTransform(),this.doTransform=!1)};f.attr({text:a,x:Math.round(c),y:Math.round(b)}).css({fontFamily:this.style.fontFamily,\r\nfontSize:this.style.fontSize,position:\"absolute\"});d.style.whiteSpace=\"nowrap\";f.css=f.htmlCss;q&&(f.add=function(a){var b,c=p.box.parentNode,q=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;)q.push(a),a=a.parentGroup;g(q.reverse(),function(a){function d(h,b){a[b]=h;\"translateX\"===b?m.left=h+\"px\":m.top=h+\"px\";a.doTransform=!0}var m,h=C(a.element,\"class\");h&&(h={className:h});b=a.div=a.div||F(\"div\",h,{position:\"absolute\",left:(a.translateX||0)+\"px\",top:(a.translateY||0)+\"px\",display:a.display,opacity:a.opacity,\r\npointerEvents:a.styles&&a.styles.pointerEvents},b||c);m=b.style;e(a,{classSetter:function(a){return function(h){this.element.setAttribute(\"class\",h);a.className=h}}(b),on:function(){q[0].div&&f.on.apply({element:q[0].div},arguments);return a},translateXSetter:d,translateYSetter:d});a.addedSetters||k(a,m)})}}else b=c;b.appendChild(d);f.added=!0;f.alignOnAdd&&f.htmlUpdateTransform();return f});return f}})})(K);(function(a){var C=a.defined,F=a.each,D=a.extend,r=a.merge,g=a.pick,e=a.timeUnits,t=a.win;\r\na.Time=function(a){this.update(a,!1)};a.Time.prototype={defaultOptions:{},update:function(e){var l=g(e&&e.useUTC,!0),u=this;this.options=e=r(!0,this.options||{},e);this.Date=e.Date||t.Date;this.timezoneOffset=(this.useUTC=l)&&e.timezoneOffset;this.getTimezoneOffset=this.timezoneOffsetFunction();(this.variableTimezone=!(l&&!e.getTimezoneOffset&&!e.timezone))||this.timezoneOffset?(this.get=function(a,d){var c=d.getTime(),e=c-u.getTimezoneOffset(d);d.setTime(e);a=d[\"getUTC\"+a]();d.setTime(c);return a},\r\nthis.set=function(c,d,k){var e;if(-1!==a.inArray(c,[\"Milliseconds\",\"Seconds\",\"Minutes\"]))d[\"set\"+c](k);else e=u.getTimezoneOffset(d),e=d.getTime()-e,d.setTime(e),d[\"setUTC\"+c](k),c=u.getTimezoneOffset(d),e=d.getTime()+c,d.setTime(e)}):l?(this.get=function(a,d){return d[\"getUTC\"+a]()},this.set=function(a,d,k){return d[\"setUTC\"+a](k)}):(this.get=function(a,d){return d[\"get\"+a]()},this.set=function(a,d,k){return d[\"set\"+a](k)})},makeTime:function(e,l,u,c,d,k){var x,p,f;this.useUTC?(x=this.Date.UTC.apply(0,\r\narguments),p=this.getTimezoneOffset(x),x+=p,f=this.getTimezoneOffset(x),p!==f?x+=f-p:p-36E5!==this.getTimezoneOffset(x-36E5)||a.isSafari||(x-=36E5)):x=(new this.Date(e,l,g(u,1),g(c,0),g(d,0),g(k,0))).getTime();return x},timezoneOffsetFunction:function(){var e=this,g=this.options,u=t.moment;if(!this.useUTC)return function(a){return 6E4*(new Date(a)).getTimezoneOffset()};if(g.timezone){if(u)return function(a){return 6E4*-u.tz(a,g.timezone).utcOffset()};a.error(25)}return this.useUTC&&g.getTimezoneOffset?\r\nfunction(a){return 6E4*g.getTimezoneOffset(a)}:function(){return 6E4*(e.timezoneOffset||0)}},dateFormat:function(e,g,u){if(!a.defined(g)||isNaN(g))return a.defaultOptions.lang.invalidDate||\"\";e=a.pick(e,\"%Y-%m-%d %H:%M:%S\");var c=this,d=new this.Date(g),k=this.get(\"Hours\",d),x=this.get(\"Day\",d),p=this.get(\"Date\",d),f=this.get(\"Month\",d),b=this.get(\"FullYear\",d),n=a.defaultOptions.lang,z=n.weekdays,l=n.shortWeekdays,q=a.pad,d=a.extend({a:l?l[x]:z[x].substr(0,3),A:z[x],d:q(p),e:q(p,2,\" \"),w:x,b:n.shortMonths[f],\r\nB:n.months[f],m:q(f+1),y:b.toString().substr(2,2),Y:b,H:q(k),k:k,I:q(k%12||12),l:k%12||12,M:q(c.get(\"Minutes\",d)),p:12>k?\"AM\":\"PM\",P:12>k?\"am\":\"pm\",S:q(d.getSeconds()),L:q(Math.round(g%1E3),3)},a.dateFormats);a.objectEach(d,function(a,b){for(;-1!==e.indexOf(\"%\"+b);)e=e.replace(\"%\"+b,\"function\"===typeof a?a.call(c,g):a)});return u?e.substr(0,1).toUpperCase()+e.substr(1):e},getTimeTicks:function(a,l,u,c){var d=this,k=[],x={},p,f=new d.Date(l),b=a.unitRange,n=a.count||1,z;if(C(l)){d.set(\"Milliseconds\",\r\nf,b>=e.second?0:n*Math.floor(d.get(\"Milliseconds\",f)/n));b>=e.second&&d.set(\"Seconds\",f,b>=e.minute?0:n*Math.floor(d.get(\"Seconds\",f)/n));b>=e.minute&&d.set(\"Minutes\",f,b>=e.hour?0:n*Math.floor(d.get(\"Minutes\",f)/n));b>=e.hour&&d.set(\"Hours\",f,b>=e.day?0:n*Math.floor(d.get(\"Hours\",f)/n));b>=e.day&&d.set(\"Date\",f,b>=e.month?1:n*Math.floor(d.get(\"Date\",f)/n));b>=e.month&&(d.set(\"Month\",f,b>=e.year?0:n*Math.floor(d.get(\"Month\",f)/n)),p=d.get(\"FullYear\",f));b>=e.year&&d.set(\"FullYear\",f,p-p%n);b===e.week&&\r\nd.set(\"Date\",f,d.get(\"Date\",f)-d.get(\"Day\",f)+g(c,1));p=d.get(\"FullYear\",f);c=d.get(\"Month\",f);var J=d.get(\"Date\",f),q=d.get(\"Hours\",f);l=f.getTime();d.variableTimezone&&(z=u-l>4*e.month||d.getTimezoneOffset(l)!==d.getTimezoneOffset(u));f=f.getTime();for(l=1;f<u;)k.push(f),f=b===e.year?d.makeTime(p+l*n,0):b===e.month?d.makeTime(p,c+l*n):!z||b!==e.day&&b!==e.week?z&&b===e.hour&&1<n?d.makeTime(p,c,J,q+l*n):f+b*n:d.makeTime(p,c,J+l*n*(b===e.day?1:7)),l++;k.push(f);b<=e.hour&&1E4>k.length&&F(k,function(a){0===\r\na%18E5&&\"000000000\"===d.dateFormat(\"%H%M%S%L\",a)&&(x[a]=\"day\")})}k.info=D(a,{higherRanks:x,totalRange:b*n});return k}}})(K);(function(a){var C=a.color,F=a.merge;a.defaultOptions={colors:\"#7cb5ec #434348 #90ed7d #f7a35c #8085e9 #f15c80 #e4d354 #2b908f #f45b5b #91e8e1\".split(\" \"),symbols:[\"circle\",\"diamond\",\"square\",\"triangle\",\"triangle-down\"],lang:{loading:\"Loading...\",months:\"January February March April May June July August September October November December\".split(\" \"),shortMonths:\"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec\".split(\" \"),\r\nweekdays:\"Sunday Monday Tuesday Wednesday Thursday Friday Saturday\".split(\" \"),decimalPoint:\".\",numericSymbols:\"kMGTPE\".split(\"\"),resetZoom:\"Reset zoom\",resetZoomTitle:\"Reset zoom level 1:1\",thousandsSep:\" \"},global:{},time:a.Time.prototype.defaultOptions,chart:{borderRadius:0,defaultSeriesType:\"line\",ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{zIndex:6},position:{align:\"right\",x:-10,y:10}},width:null,height:null,borderColor:\"#335cad\",backgroundColor:\"#ffffff\",plotBorderColor:\"#cccccc\"},\r\ntitle:{text:\"Chart title\",align:\"center\",margin:15,widthAdjust:-44},subtitle:{text:\"\",align:\"center\",widthAdjust:-44},plotOptions:{},labels:{style:{position:\"absolute\",color:\"#333333\"}},legend:{enabled:!0,align:\"center\",alignColumns:!0,layout:\"horizontal\",labelFormatter:function(){return this.name},borderColor:\"#999999\",borderRadius:0,navigation:{activeColor:\"#003399\",inactiveColor:\"#cccccc\"},itemStyle:{color:\"#333333\",fontSize:\"12px\",fontWeight:\"bold\",textOverflow:\"ellipsis\"},itemHoverStyle:{color:\"#000000\"},\r\nitemHiddenStyle:{color:\"#cccccc\"},shadow:!1,itemCheckboxStyle:{position:\"absolute\",width:\"13px\",height:\"13px\"},squareSymbol:!0,symbolPadding:5,verticalAlign:\"bottom\",x:0,y:0,title:{style:{fontWeight:\"bold\"}}},loading:{labelStyle:{fontWeight:\"bold\",position:\"relative\",top:\"45%\"},style:{position:\"absolute\",backgroundColor:\"#ffffff\",opacity:.5,textAlign:\"center\"}},tooltip:{enabled:!0,animation:a.svg,borderRadius:3,dateTimeLabelFormats:{millisecond:\"%A, %b %e, %H:%M:%S.%L\",second:\"%A, %b %e, %H:%M:%S\",\r\nminute:\"%A, %b %e, %H:%M\",hour:\"%A, %b %e, %H:%M\",day:\"%A, %b %e, %Y\",week:\"Week from %A, %b %e, %Y\",month:\"%B %Y\",year:\"%Y\"},footerFormat:\"\",padding:8,snap:a.isTouchDevice?25:10,backgroundColor:C(\"#f7f7f7\").setOpacity(.85).get(),borderWidth:1,headerFormat:'\\x3cspan style\\x3d\"font-size: 10px\"\\x3e{point.key}\\x3c/span\\x3e\\x3cbr/\\x3e',pointFormat:'\\x3cspan style\\x3d\"color:{point.color}\"\\x3e\\u25cf\\x3c/span\\x3e {series.name}: \\x3cb\\x3e{point.y}\\x3c/b\\x3e\\x3cbr/\\x3e',shadow:!0,style:{color:\"#333333\",cursor:\"default\",\r\nfontSize:\"12px\",pointerEvents:\"none\",whiteSpace:\"nowrap\"}},credits:{enabled:!0,href:\"http://www.highcharts.com\",position:{align:\"right\",x:-10,verticalAlign:\"bottom\",y:-5},style:{cursor:\"pointer\",color:\"#999999\",fontSize:\"9px\"},text:\"Highcharts.com\"}};a.setOptions=function(C){a.defaultOptions=F(!0,a.defaultOptions,C);a.time.update(F(a.defaultOptions.global,a.defaultOptions.time),!1);return a.defaultOptions};a.getOptions=function(){return a.defaultOptions};a.defaultPlotOptions=a.defaultOptions.plotOptions;\r\na.time=new a.Time(F(a.defaultOptions.global,a.defaultOptions.time));a.dateFormat=function(C,r,g){return a.time.dateFormat(C,r,g)}})(K);(function(a){var C=a.correctFloat,F=a.defined,D=a.destroyObjectProperties,r=a.fireEvent,g=a.isNumber,e=a.merge,t=a.pick,w=a.deg2rad;a.Tick=function(a,e,c,d){this.axis=a;this.pos=e;this.type=c||\"\";this.isNewLabel=this.isNew=!0;c||d||this.addLabel()};a.Tick.prototype={addLabel:function(){var a=this.axis,g=a.options,c=a.chart,d=a.categories,k=a.names,x=this.pos,p=g.labels,\r\nf=a.tickPositions,b=x===f[0],n=x===f[f.length-1],k=d?t(d[x],k[x],x):x,d=this.label,f=f.info,z;a.isDatetimeAxis&&f&&(z=g.dateTimeLabelFormats[f.higherRanks[x]||f.unitName]);this.isFirst=b;this.isLast=n;g=a.labelFormatter.call({axis:a,chart:c,isFirst:b,isLast:n,dateTimeLabelFormat:z,value:a.isLog?C(a.lin2log(k)):k,pos:x});if(F(d))d&&d.attr({text:g});else{if(this.label=d=F(g)&&p.enabled?c.renderer.text(g,0,0,p.useHTML).css(e(p.style)).add(a.labelGroup):null)d.textPxLength=d.getBBox().width;this.rotation=\r\n0}},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?\"height\":\"width\"]:0},handleOverflow:function(a){var e=this.axis,c=e.options.labels,d=a.x,k=e.chart.chartWidth,g=e.chart.spacing,p=t(e.labelLeft,Math.min(e.pos,g[3])),g=t(e.labelRight,Math.max(e.isRadial?0:e.pos+e.len,k-g[1])),f=this.label,b=this.rotation,n={left:0,center:.5,right:1}[e.labelAlign||f.attr(\"align\")],z=f.getBBox().width,l=e.getSlotWidth(),q=l,L=1,B,H={};if(b||!1===c.overflow)0>b&&d-n*z<p?B=Math.round(d/\r\nMath.cos(b*w)-p):0<b&&d+n*z>g&&(B=Math.round((k-d)/Math.cos(b*w)));else if(k=d+(1-n)*z,d-n*z<p?q=a.x+q*(1-n)-p:k>g&&(q=g-a.x+q*n,L=-1),q=Math.min(l,q),q<l&&\"center\"===e.labelAlign&&(a.x+=L*(l-q-n*(l-Math.min(z,q)))),z>q||e.autoRotation&&(f.styles||{}).width)B=q;B&&(H.width=B,(c.style||{}).textOverflow||(H.textOverflow=\"ellipsis\"),f.css(H))},getPosition:function(e,g,c,d){var k=this.axis,x=k.chart,p=d&&x.oldChartHeight||x.chartHeight;e={x:e?a.correctFloat(k.translate(g+c,null,null,d)+k.transB):k.left+\r\nk.offset+(k.opposite?(d&&x.oldChartWidth||x.chartWidth)-k.right-k.left:0),y:e?p-k.bottom+k.offset-(k.opposite?k.height:0):a.correctFloat(p-k.translate(g+c,null,null,d)-k.transB)};r(this,\"afterGetPosition\",{pos:e});return e},getLabelPosition:function(a,e,c,d,k,g,p,f){var b=this.axis,n=b.transA,z=b.reversed,x=b.staggerLines,q=b.tickRotCorr||{x:0,y:0},l=k.y,B=d||b.reserveSpaceDefault?0:-b.labelOffset*(\"center\"===b.labelAlign?.5:1),u={};F(l)||(l=0===b.side?c.rotation?-8:-c.getBBox().height:2===b.side?\r\nq.y+8:Math.cos(c.rotation*w)*(q.y-c.getBBox(!1,0).height/2));a=a+k.x+B+q.x-(g&&d?g*n*(z?-1:1):0);e=e+l-(g&&!d?g*n*(z?1:-1):0);x&&(c=p/(f||1)%x,b.opposite&&(c=x-c-1),e+=b.labelOffset/x*c);u.x=a;u.y=Math.round(e);r(this,\"afterGetLabelPosition\",{pos:u});return u},getMarkPath:function(a,e,c,d,k,g){return g.crispLine([\"M\",a,e,\"L\",a+(k?0:-c),e+(k?c:0)],d)},renderGridLine:function(a,e,c){var d=this.axis,k=d.options,g=this.gridLine,p={},f=this.pos,b=this.type,n=d.tickmarkOffset,z=d.chart.renderer,l=b?b+\"Grid\":\r\n\"grid\",q=k[l+\"LineWidth\"],u=k[l+\"LineColor\"],k=k[l+\"LineDashStyle\"];g||(p.stroke=u,p[\"stroke-width\"]=q,k&&(p.dashstyle=k),b||(p.zIndex=1),a&&(p.opacity=0),this.gridLine=g=z.path().attr(p).addClass(\"highcharts-\"+(b?b+\"-\":\"\")+\"grid-line\").add(d.gridGroup));if(!a&&g&&(a=d.getPlotLinePath(f+n,g.strokeWidth()*c,a,!0)))g[this.isNew?\"attr\":\"animate\"]({d:a,opacity:e})},renderMark:function(a,e,c){var d=this.axis,k=d.options,g=d.chart.renderer,p=this.type,f=p?p+\"Tick\":\"tick\",b=d.tickSize(f),n=this.mark,z=!n,\r\nl=a.x;a=a.y;var q=t(k[f+\"Width\"],!p&&d.isXAxis?1:0),k=k[f+\"Color\"];b&&(d.opposite&&(b[0]=-b[0]),z&&(this.mark=n=g.path().addClass(\"highcharts-\"+(p?p+\"-\":\"\")+\"tick\").add(d.axisGroup),n.attr({stroke:k,\"stroke-width\":q})),n[z?\"attr\":\"animate\"]({d:this.getMarkPath(l,a,b[0],n.strokeWidth()*c,d.horiz,g),opacity:e}))},renderLabel:function(a,e,c,d){var k=this.axis,x=k.horiz,p=k.options,f=this.label,b=p.labels,n=b.step,k=k.tickmarkOffset,z=!0,u=a.x;a=a.y;f&&g(u)&&(f.xy=a=this.getLabelPosition(u,a,f,x,b,k,\r\nd,n),this.isFirst&&!this.isLast&&!t(p.showFirstLabel,1)||this.isLast&&!this.isFirst&&!t(p.showLastLabel,1)?z=!1:!x||b.step||b.rotation||e||0===c||this.handleOverflow(a),n&&d%n&&(z=!1),z&&g(a.y)?(a.opacity=c,f[this.isNewLabel?\"attr\":\"animate\"](a),this.isNewLabel=!1):(f.attr(\"y\",-9999),this.isNewLabel=!0))},render:function(e,g,c){var d=this.axis,k=d.horiz,x=this.getPosition(k,this.pos,d.tickmarkOffset,g),p=x.x,f=x.y,d=k&&p===d.pos+d.len||!k&&f===d.pos?-1:1;c=t(c,1);this.isActive=!0;this.renderGridLine(g,\r\nc,d);this.renderMark(x,c,d);this.renderLabel(x,g,c,e);this.isNew=!1;a.fireEvent(this,\"afterRender\")},destroy:function(){D(this,this.axis)}}})(K);var V=function(a){var C=a.addEvent,F=a.animObject,D=a.arrayMax,r=a.arrayMin,g=a.color,e=a.correctFloat,t=a.defaultOptions,w=a.defined,l=a.deg2rad,u=a.destroyObjectProperties,c=a.each,d=a.extend,k=a.fireEvent,x=a.format,p=a.getMagnitude,f=a.grep,b=a.inArray,n=a.isArray,z=a.isNumber,J=a.isString,q=a.merge,L=a.normalizeTickInterval,B=a.objectEach,H=a.pick,m=\r\na.removeEvent,E=a.splat,A=a.syncTimeout,M=a.Tick,G=function(){this.init.apply(this,arguments)};a.extend(G.prototype,{defaultOptions:{dateTimeLabelFormats:{millisecond:\"%H:%M:%S.%L\",second:\"%H:%M:%S\",minute:\"%H:%M\",hour:\"%H:%M\",day:\"%e. %b\",week:\"%e. %b\",month:\"%b '%y\",year:\"%Y\"},endOnTick:!1,labels:{enabled:!0,style:{color:\"#666666\",cursor:\"default\",fontSize:\"11px\"},x:0},maxPadding:.01,minorTickLength:2,minorTickPosition:\"outside\",minPadding:.01,startOfWeek:1,startOnTick:!1,tickLength:10,tickmarkPlacement:\"between\",\r\ntickPixelInterval:100,tickPosition:\"outside\",title:{align:\"middle\",style:{color:\"#666666\"}},type:\"linear\",minorGridLineColor:\"#f2f2f2\",minorGridLineWidth:1,minorTickColor:\"#999999\",lineColor:\"#ccd6eb\",lineWidth:1,gridLineColor:\"#e6e6e6\",tickColor:\"#ccd6eb\"},defaultYAxisOptions:{endOnTick:!0,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},maxPadding:.05,minPadding:.05,startOnTick:!0,title:{rotation:270,text:\"Values\"},stackLabels:{allowOverlap:!1,enabled:!1,formatter:function(){return a.numberFormat(this.total,\r\n-1)},style:{fontSize:\"11px\",fontWeight:\"bold\",color:\"#000000\",textOutline:\"1px contrast\"}},gridLineWidth:1,lineWidth:0},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(a,c){var h=c.isX,v=this;v.chart=a;v.horiz=a.inverted&&!v.isZAxis?!h:h;v.isXAxis=h;v.coll=v.coll||\r\n(h?\"xAxis\":\"yAxis\");k(this,\"init\",{userOptions:c});v.opposite=c.opposite;v.side=c.side||(v.horiz?v.opposite?0:2:v.opposite?1:3);v.setOptions(c);var f=this.options,d=f.type;v.labelFormatter=f.labels.formatter||v.defaultLabelFormatter;v.userOptions=c;v.minPixelPadding=0;v.reversed=f.reversed;v.visible=!1!==f.visible;v.zoomEnabled=!1!==f.zoomEnabled;v.hasNames=\"category\"===d||!0===f.categories;v.categories=f.categories||v.hasNames;v.names||(v.names=[],v.names.keys={});v.plotLinesAndBandsGroups={};v.isLog=\r\n\"logarithmic\"===d;v.isDatetimeAxis=\"datetime\"===d;v.positiveValuesOnly=v.isLog&&!v.allowNegativeLog;v.isLinked=w(f.linkedTo);v.ticks={};v.labelEdge=[];v.minorTicks={};v.plotLinesAndBands=[];v.alternateBands={};v.len=0;v.minRange=v.userMinRange=f.minRange||f.maxZoom;v.range=f.range;v.offset=f.offset||0;v.stacks={};v.oldStacks={};v.stacksTouched=0;v.max=null;v.min=null;v.crosshair=H(f.crosshair,E(a.options.tooltip.crosshairs)[h?0:1],!1);c=v.options.events;-1===b(v,a.axes)&&(h?a.axes.splice(a.xAxis.length,\r\n0,v):a.axes.push(v),a[v.coll].push(v));v.series=v.series||[];a.inverted&&!v.isZAxis&&h&&void 0===v.reversed&&(v.reversed=!0);B(c,function(a,h){C(v,h,a)});v.lin2log=f.linearToLogConverter||v.lin2log;v.isLog&&(v.val2lin=v.log2lin,v.lin2val=v.lin2log);k(this,\"afterInit\")},setOptions:function(a){this.options=q(this.defaultOptions,\"yAxis\"===this.coll&&this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],\r\nq(t[this.coll],a));k(this,\"afterSetOptions\",{userOptions:a})},defaultLabelFormatter:function(){var h=this.axis,b=this.value,c=h.chart.time,f=h.categories,d=this.dateTimeLabelFormat,m=t.lang,q=m.numericSymbols,m=m.numericSymbolMagnitude||1E3,p=q&&q.length,n,e=h.options.labels.format,h=h.isLog?Math.abs(b):h.tickInterval;if(e)n=x(e,this,c);else if(f)n=b;else if(d)n=c.dateFormat(d,b);else if(p&&1E3<=h)for(;p--&&void 0===n;)c=Math.pow(m,p+1),h>=c&&0===10*b%c&&null!==q[p]&&0!==b&&(n=a.numberFormat(b/c,\r\n-1)+q[p]);void 0===n&&(n=1E4<=Math.abs(b)?a.numberFormat(b,-1):a.numberFormat(b,-1,void 0,\"\"));return n},getSeriesExtremes:function(){var a=this,b=a.chart;k(this,\"getSeriesExtremes\",null,function(){a.hasVisibleSeries=!1;a.dataMin=a.dataMax=a.threshold=null;a.softThreshold=!a.isXAxis;a.buildStacks&&a.buildStacks();c(a.series,function(h){if(h.visible||!b.options.chart.ignoreHiddenSeries){var v=h.options,c=v.threshold,d;a.hasVisibleSeries=!0;a.positiveValuesOnly&&0>=c&&(c=null);if(a.isXAxis)v=h.xData,\r\nv.length&&(h=r(v),d=D(v),z(h)||h instanceof Date||(v=f(v,z),h=r(v),d=D(v)),v.length&&(a.dataMin=Math.min(H(a.dataMin,v[0],h),h),a.dataMax=Math.max(H(a.dataMax,v[0],d),d)));else if(h.getExtremes(),d=h.dataMax,h=h.dataMin,w(h)&&w(d)&&(a.dataMin=Math.min(H(a.dataMin,h),h),a.dataMax=Math.max(H(a.dataMax,d),d)),w(c)&&(a.threshold=c),!v.softThreshold||a.positiveValuesOnly)a.softThreshold=!1}})});k(this,\"afterGetSeriesExtremes\")},translate:function(a,b,c,f,d,m){var h=this.linkedParent||this,v=1,I=0,q=f?\r\nh.oldTransA:h.transA;f=f?h.oldMin:h.min;var p=h.minPixelPadding;d=(h.isOrdinal||h.isBroken||h.isLog&&d)&&h.lin2val;q||(q=h.transA);c&&(v*=-1,I=h.len);h.reversed&&(v*=-1,I-=v*(h.sector||h.len));b?(a=(a*v+I-p)/q+f,d&&(a=h.lin2val(a))):(d&&(a=h.val2lin(a)),a=z(f)?v*(a-f)*q+I+v*p+(z(m)?q*m:0):void 0);return a},toPixels:function(a,b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,\r\nb,c,f,d){var h=this.chart,v=this.left,m=this.top,I,q,p=c&&h.oldChartHeight||h.chartHeight,n=c&&h.oldChartWidth||h.chartWidth,e;I=this.transB;var A=function(a,h,b){if(a<h||a>b)f?a=Math.min(Math.max(h,a),b):e=!0;return a};d=H(d,this.translate(a,null,null,c));d=Math.min(Math.max(-1E5,d),1E5);a=c=Math.round(d+I);I=q=Math.round(p-d-I);z(d)?this.horiz?(I=m,q=p-this.bottom,a=c=A(a,v,v+this.width)):(a=v,c=n-this.right,I=q=A(I,m,m+this.height)):(e=!0,f=!1);return e&&!f?null:h.renderer.crispLine([\"M\",a,I,\"L\",\r\nc,q],b||1)},getLinearTickPositions:function(a,b,c){var h,v=e(Math.floor(b/a)*a);c=e(Math.ceil(c/a)*a);var f=[],d;e(v+a)===v&&(d=20);if(this.single)return[b];for(b=v;b<=c;){f.push(b);b=e(b+a,d);if(b===h)break;h=b}return f},getMinorTickInterval:function(){var a=this.options;return!0===a.minorTicks?H(a.minorTickInterval,\"auto\"):!1===a.minorTicks?null:a.minorTickInterval},getMinorTickPositions:function(){var a=this,b=a.options,f=a.tickPositions,d=a.minorTickInterval,m=[],q=a.pointRangePadding||0,p=a.min-\r\nq,q=a.max+q,n=q-p;if(n&&n/d<a.len/3)if(a.isLog)c(this.paddedTicks,function(h,b,c){b&&m.push.apply(m,a.getLogTickPositions(d,c[b-1],c[b],!0))});else if(a.isDatetimeAxis&&\"auto\"===this.getMinorTickInterval())m=m.concat(a.getTimeTicks(a.normalizeTimeTickInterval(d),p,q,b.startOfWeek));else for(b=p+(f[0]-p)%d;b<=q&&b!==m[0];b+=d)m.push(b);0!==m.length&&a.trimTicks(m);return m},adjustForMinRange:function(){var a=this.options,b=this.min,f=this.max,d,m,q,p,n,e,A,k;this.isXAxis&&void 0===this.minRange&&!this.isLog&&\r\n(w(a.min)||w(a.max)?this.minRange=null:(c(this.series,function(a){e=a.xData;for(p=A=a.xIncrement?1:e.length-1;0<p;p--)if(n=e[p]-e[p-1],void 0===q||n<q)q=n}),this.minRange=Math.min(5*q,this.dataMax-this.dataMin)));f-b<this.minRange&&(m=this.dataMax-this.dataMin>=this.minRange,k=this.minRange,d=(k-f+b)/2,d=[b-d,H(a.min,b-d)],m&&(d[2]=this.isLog?this.log2lin(this.dataMin):this.dataMin),b=D(d),f=[b+k,H(a.max,b+k)],m&&(f[2]=this.isLog?this.log2lin(this.dataMax):this.dataMax),f=r(f),f-b<k&&(d[0]=f-k,d[1]=\r\nH(a.min,f-k),b=D(d)));this.min=b;this.max=f},getClosest:function(){var a;this.categories?a=1:c(this.series,function(h){var b=h.closestPointRange,c=h.visible||!h.chart.options.chart.ignoreHiddenSeries;!h.noSharedTooltip&&w(b)&&c&&(a=w(a)?Math.min(a,b):b)});return a},nameToX:function(a){var h=n(this.categories),c=h?this.categories:this.names,f=a.options.x,d;a.series.requireSorting=!1;w(f)||(f=!1===this.options.uniqueNames?a.series.autoIncrement():h?b(a.name,c):H(c.keys[a.name],-1));-1===f?h||(d=c.length):\r\nd=f;void 0!==d&&(this.names[d]=a.name,this.names.keys[a.name]=d);return d},updateNames:function(){var h=this,b=this.names;0<b.length&&(c(a.keys(b.keys),function(a){delete b.keys[a]}),b.length=0,this.minRange=this.userMinRange,c(this.series||[],function(a){a.xIncrement=null;if(!a.points||a.isDirtyData)a.processData(),a.generatePoints();c(a.points,function(b,c){var f;b.options&&(f=h.nameToX(b),void 0!==f&&f!==b.x&&(b.x=f,a.xData[c]=f))})}))},setAxisTranslation:function(a){var h=this,b=h.max-h.min,f=\r\nh.axisPointRange||0,d,m=0,q=0,p=h.linkedParent,n=!!h.categories,e=h.transA,A=h.isXAxis;if(A||n||f)d=h.getClosest(),p?(m=p.minPointOffset,q=p.pointRangePadding):c(h.series,function(a){var b=n?1:A?H(a.options.pointRange,d,0):h.axisPointRange||0;a=a.options.pointPlacement;f=Math.max(f,b);h.single||(m=Math.max(m,J(a)?0:b/2),q=Math.max(q,\"on\"===a?0:b))}),p=h.ordinalSlope&&d?h.ordinalSlope/d:1,h.minPointOffset=m*=p,h.pointRangePadding=q*=p,h.pointRange=Math.min(f,b),A&&(h.closestPointRange=d);a&&(h.oldTransA=\r\ne);h.translationSlope=h.transA=e=h.options.staticScale||h.len/(b+q||1);h.transB=h.horiz?h.left:h.bottom;h.minPixelPadding=e*m;k(this,\"afterSetAxisTranslation\")},minFromRange:function(){return this.max-this.range},setTickInterval:function(h){var b=this,f=b.chart,d=b.options,m=b.isLog,q=b.isDatetimeAxis,n=b.isXAxis,A=b.isLinked,E=d.maxPadding,g=d.minPadding,B=d.tickInterval,x=d.tickPixelInterval,G=b.categories,u=z(b.threshold)?b.threshold:null,l=b.softThreshold,t,J,M,r;q||G||A||this.getTickAmount();\r\nM=H(b.userMin,d.min);r=H(b.userMax,d.max);A?(b.linkedParent=f[b.coll][d.linkedTo],f=b.linkedParent.getExtremes(),b.min=H(f.min,f.dataMin),b.max=H(f.max,f.dataMax),d.type!==b.linkedParent.options.type&&a.error(11,1)):(!l&&w(u)&&(b.dataMin>=u?(t=u,g=0):b.dataMax<=u&&(J=u,E=0)),b.min=H(M,t,b.dataMin),b.max=H(r,J,b.dataMax));m&&(b.positiveValuesOnly&&!h&&0>=Math.min(b.min,H(b.dataMin,b.min))&&a.error(10,1),b.min=e(b.log2lin(b.min),15),b.max=e(b.log2lin(b.max),15));b.range&&w(b.max)&&(b.userMin=b.min=\r\nM=Math.max(b.dataMin,b.minFromRange()),b.userMax=r=b.max,b.range=null);k(b,\"foundExtremes\");b.beforePadding&&b.beforePadding();b.adjustForMinRange();!(G||b.axisPointRange||b.usePercentage||A)&&w(b.min)&&w(b.max)&&(f=b.max-b.min)&&(!w(M)&&g&&(b.min-=f*g),!w(r)&&E&&(b.max+=f*E));z(d.softMin)&&!z(b.userMin)&&(b.min=Math.min(b.min,d.softMin));z(d.softMax)&&!z(b.userMax)&&(b.max=Math.max(b.max,d.softMax));z(d.floor)&&(b.min=Math.max(b.min,d.floor));z(d.ceiling)&&(b.max=Math.min(b.max,d.ceiling));l&&w(b.dataMin)&&\r\n(u=u||0,!w(M)&&b.min<u&&b.dataMin>=u?b.min=u:!w(r)&&b.max>u&&b.dataMax<=u&&(b.max=u));b.tickInterval=b.min===b.max||void 0===b.min||void 0===b.max?1:A&&!B&&x===b.linkedParent.options.tickPixelInterval?B=b.linkedParent.tickInterval:H(B,this.tickAmount?(b.max-b.min)/Math.max(this.tickAmount-1,1):void 0,G?1:(b.max-b.min)*x/Math.max(b.len,x));n&&!h&&c(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)});b.setAxisTranslation(!0);b.beforeSetTickPositions&&b.beforeSetTickPositions();\r\nb.postProcessTickInterval&&(b.tickInterval=b.postProcessTickInterval(b.tickInterval));b.pointRange&&!B&&(b.tickInterval=Math.max(b.pointRange,b.tickInterval));h=H(d.minTickInterval,b.isDatetimeAxis&&b.closestPointRange);!B&&b.tickInterval<h&&(b.tickInterval=h);q||m||B||(b.tickInterval=L(b.tickInterval,null,p(b.tickInterval),H(d.allowDecimals,!(.5<b.tickInterval&&5>b.tickInterval&&1E3<b.max&&9999>b.max)),!!this.tickAmount));this.tickAmount||(b.tickInterval=b.unsquish());this.setTickPositions()},setTickPositions:function(){var a=\r\nthis.options,b,c=a.tickPositions;b=this.getMinorTickInterval();var f=a.tickPositioner,d=a.startOnTick,m=a.endOnTick;this.tickmarkOffset=this.categories&&\"between\"===a.tickmarkPlacement&&1===this.tickInterval?.5:0;this.minorTickInterval=\"auto\"===b&&this.tickInterval?this.tickInterval/5:b;this.single=this.min===this.max&&w(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||!1!==a.allowDecimals);this.tickPositions=b=c&&c.slice();!b&&(b=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,\r\na.units),this.min,this.max,a.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),b.length>this.len&&(b=[b[0],b.pop()],b[0]===b[1]&&(b.length=1)),this.tickPositions=b,f&&(f=f.apply(this,[this.min,this.max])))&&(this.tickPositions=b=f);this.paddedTicks=b.slice(0);this.trimTicks(b,d,m);this.isLinked||(this.single&&2>b.length&&(this.min-=.5,this.max+=.5),c||\r\nf||this.adjustTickAmount());k(this,\"afterSetTickPositions\")},trimTicks:function(a,b,c){var h=a[0],f=a[a.length-1],d=this.minPointOffset||0;if(!this.isLinked){if(b&&-Infinity!==h)this.min=h;else for(;this.min-d>a[0];)a.shift();if(c)this.max=f;else for(;this.max+d<a[a.length-1];)a.pop();0===a.length&&w(h)&&!this.options.tickPositions&&a.push((f+h)/2)}},alignToOthers:function(){var a={},b,f=this.options;!1===this.chart.options.chart.alignTicks||!1===f.alignTicks||!1===f.startOnTick||!1===f.endOnTick||\r\nthis.isLog||c(this.chart[this.coll],function(h){var c=h.options,c=[h.horiz?c.left:c.top,c.width,c.height,c.pane].join();h.series.length&&(a[c]?b=!0:a[c]=1)});return b},getTickAmount:function(){var a=this.options,b=a.tickAmount,c=a.tickPixelInterval;!w(a.tickInterval)&&this.len<c&&!this.isRadial&&!this.isLog&&a.startOnTick&&a.endOnTick&&(b=2);!b&&this.alignToOthers()&&(b=Math.ceil(this.len/c)+1);4>b&&(this.finalTickAmt=b,b=5);this.tickAmount=b},adjustTickAmount:function(){var a=this.tickInterval,b=\r\nthis.tickPositions,c=this.tickAmount,f=this.finalTickAmt,d=b&&b.length,m=H(this.threshold,this.softThreshold?0:null);if(this.hasData()){if(d<c){for(;b.length<c;)b.length%2||this.min===m?b.push(e(b[b.length-1]+a)):b.unshift(e(b[0]-a));this.transA*=(d-1)/(c-1);this.min=b[0];this.max=b[b.length-1]}else d>c&&(this.tickInterval*=2,this.setTickPositions());if(w(f)){for(a=c=b.length;a--;)(3===f&&1===a%2||2>=f&&0<a&&a<c-1)&&b.splice(a,1);this.finalTickAmt=void 0}}},setScale:function(){var a,b;this.oldMin=\r\nthis.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();b=this.len!==this.oldAxisLength;c(this.series,function(b){if(b.isDirtyData||b.isDirty||b.xAxis.isDirty)a=!0});b||a||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()?(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,this.isDirty||(this.isDirty=\r\nb||this.min!==this.oldMin||this.max!==this.oldMax)):this.cleanStacks&&this.cleanStacks();k(this,\"afterSetScale\")},setExtremes:function(a,b,f,m,q){var h=this,p=h.chart;f=H(f,!0);c(h.series,function(a){delete a.kdTree});q=d(q,{min:a,max:b});k(h,\"setExtremes\",q,function(){h.userMin=a;h.userMax=b;h.eventArgs=q;f&&p.redraw(m)})},zoom:function(a,b){var h=this.dataMin,c=this.dataMax,f=this.options,d=Math.min(h,H(f.min,h)),f=Math.max(c,H(f.max,c));if(a!==this.min||b!==this.max)this.allowZoomOutside||(w(h)&&\r\n(a<d&&(a=d),a>f&&(a=f)),w(c)&&(b<d&&(b=d),b>f&&(b=f))),this.displayBtn=void 0!==a||void 0!==b,this.setExtremes(a,b,!1,void 0,{trigger:\"zoom\"});return!0},setAxisSize:function(){var b=this.chart,c=this.options,f=c.offsets||[0,0,0,0],d=this.horiz,m=this.width=Math.round(a.relativeLength(H(c.width,b.plotWidth-f[3]+f[1]),b.plotWidth)),q=this.height=Math.round(a.relativeLength(H(c.height,b.plotHeight-f[0]+f[2]),b.plotHeight)),p=this.top=Math.round(a.relativeLength(H(c.top,b.plotTop+f[0]),b.plotHeight,b.plotTop)),\r\nc=this.left=Math.round(a.relativeLength(H(c.left,b.plotLeft+f[3]),b.plotWidth,b.plotLeft));this.bottom=b.chartHeight-q-p;this.right=b.chartWidth-m-c;this.len=Math.max(d?m:q,0);this.pos=d?c:p},getExtremes:function(){var a=this.isLog;return{min:a?e(this.lin2log(this.min)):this.min,max:a?e(this.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var b=this.isLog,h=b?this.lin2log(this.min):this.min,b=b?this.lin2log(this.max):\r\nthis.max;null===a||-Infinity===a?a=h:Infinity===a?a=b:h>a?a=h:b<a&&(a=b);return this.translate(a,0,1,0,1)},autoLabelAlign:function(a){a=(H(a,0)-90*this.side+720)%360;return 15<a&&165>a?\"right\":195<a&&345>a?\"left\":\"center\"},tickSize:function(a){var b=this.options,h=b[a+\"Length\"],c=H(b[a+\"Width\"],\"tick\"===a&&this.isXAxis?1:0);if(c&&h)return\"inside\"===b[a+\"Position\"]&&(h=-h),[h,c]},labelMetrics:function(){var a=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style&&\r\nthis.options.labels.style.fontSize,this.ticks[a]&&this.ticks[a].label)},unsquish:function(){var a=this.options.labels,b=this.horiz,f=this.tickInterval,d=f,m=this.len/(((this.categories?1:0)+this.max-this.min)/f),q,p=a.rotation,n=this.labelMetrics(),A,k=Number.MAX_VALUE,E,z=function(a){a/=m||1;a=1<a?Math.ceil(a):1;return e(a*f)};b?(E=!a.staggerLines&&!a.step&&(w(p)?[p]:m<H(a.autoRotationLimit,80)&&a.autoRotation))&&c(E,function(a){var b;if(a===p||a&&-90<=a&&90>=a)A=z(Math.abs(n.h/Math.sin(l*a))),b=\r\nA+Math.abs(a/360),b<k&&(k=b,q=a,d=A)}):a.step||(d=z(n.h));this.autoRotation=E;this.labelRotation=H(q,p);return d},getSlotWidth:function(){var a=this.chart,b=this.horiz,c=this.options.labels,f=Math.max(this.tickPositions.length-(this.categories?0:1),1),d=a.margin[3];return b&&2>(c.step||0)&&!c.rotation&&(this.staggerLines||1)*this.len/f||!b&&(c.style&&parseInt(c.style.width,10)||d&&d-a.spacing[3]||.33*a.chartWidth)},renderUnsquish:function(){var a=this.chart,b=a.renderer,f=this.tickPositions,d=this.ticks,\r\nm=this.options.labels,q=this.horiz,p=this.getSlotWidth(),n=Math.max(1,Math.round(p-2*(m.padding||5))),e={},A=this.labelMetrics(),k=m.style&&m.style.textOverflow,E,z,g=0,B;J(m.rotation)||(e.rotation=m.rotation||0);c(f,function(a){(a=d[a])&&a.label&&a.label.textPxLength>g&&(g=a.label.textPxLength)});this.maxLabelLength=g;if(this.autoRotation)g>n&&g>A.h?e.rotation=this.labelRotation:this.labelRotation=0;else if(p&&(E=n,!k))for(z=\"clip\",n=f.length;!q&&n--;)if(B=f[n],B=d[B].label)B.styles&&\"ellipsis\"===\r\nB.styles.textOverflow?B.css({textOverflow:\"clip\"}):B.textPxLength>p&&B.css({width:p+\"px\"}),B.getBBox().height>this.len/f.length-(A.h-A.f)&&(B.specificTextOverflow=\"ellipsis\");e.rotation&&(E=g>.5*a.chartHeight?.33*a.chartHeight:a.chartHeight,k||(z=\"ellipsis\"));if(this.labelAlign=m.align||this.autoLabelAlign(this.labelRotation))e.align=this.labelAlign;c(f,function(a){var b=(a=d[a])&&a.label,h={};b&&(b.attr(e),!E||m.style&&m.style.width||!(E<b.textPxLength||\"SPAN\"===b.element.tagName)||(h.width=E,k||\r\n(h.textOverflow=b.specificTextOverflow||z),b.css(h)),delete b.specificTextOverflow,a.rotation=e.rotation)});this.tickRotCorr=b.rotCorr(A.b,this.labelRotation||0,0!==this.side)},hasData:function(){return this.hasVisibleSeries||w(this.min)&&w(this.max)&&this.tickPositions&&0<this.tickPositions.length},addTitle:function(a){var b=this.chart.renderer,h=this.horiz,c=this.opposite,f=this.options.title,d;this.axisTitle||((d=f.textAlign)||(d=(h?{low:\"left\",middle:\"center\",high:\"right\"}:{low:c?\"right\":\"left\",\r\nmiddle:\"center\",high:c?\"left\":\"right\"})[f.align]),this.axisTitle=b.text(f.text,0,0,f.useHTML).attr({zIndex:7,rotation:f.rotation||0,align:d}).addClass(\"highcharts-axis-title\").css(q(f.style)).add(this.axisGroup),this.axisTitle.isNew=!0);f.style.width||this.isRadial||this.axisTitle.css({width:this.len});this.axisTitle[a?\"show\":\"hide\"](!0)},generateTick:function(a){var b=this.ticks;b[a]?b[a].addLabel():b[a]=new M(this,a)},getOffset:function(){var a=this,b=a.chart,f=b.renderer,d=a.options,m=a.tickPositions,\r\nq=a.ticks,p=a.horiz,n=a.side,e=b.inverted&&!a.isZAxis?[1,0,3,2][n]:n,A,k,E=0,z,g=0,x=d.title,G=d.labels,u=0,l=b.axisOffset,b=b.clipOffset,t=[-1,1,1,-1][n],J=d.className,M=a.axisParent,r=this.tickSize(\"tick\");A=a.hasData();a.showAxis=k=A||H(d.showEmpty,!0);a.staggerLines=a.horiz&&G.staggerLines;a.axisGroup||(a.gridGroup=f.g(\"grid\").attr({zIndex:d.gridZIndex||1}).addClass(\"highcharts-\"+this.coll.toLowerCase()+\"-grid \"+(J||\"\")).add(M),a.axisGroup=f.g(\"axis\").attr({zIndex:d.zIndex||2}).addClass(\"highcharts-\"+\r\nthis.coll.toLowerCase()+\" \"+(J||\"\")).add(M),a.labelGroup=f.g(\"axis-labels\").attr({zIndex:G.zIndex||7}).addClass(\"highcharts-\"+a.coll.toLowerCase()+\"-labels \"+(J||\"\")).add(M));A||a.isLinked?(c(m,function(b,f){a.generateTick(b,f)}),a.renderUnsquish(),a.reserveSpaceDefault=0===n||2===n||{1:\"left\",3:\"right\"}[n]===a.labelAlign,H(G.reserveSpace,\"center\"===a.labelAlign?!0:null,a.reserveSpaceDefault)&&c(m,function(a){u=Math.max(q[a].getLabelSize(),u)}),a.staggerLines&&(u*=a.staggerLines),a.labelOffset=u*\r\n(a.opposite?-1:1)):B(q,function(a,b){a.destroy();delete q[b]});x&&x.text&&!1!==x.enabled&&(a.addTitle(k),k&&!1!==x.reserveSpace&&(a.titleOffset=E=a.axisTitle.getBBox()[p?\"height\":\"width\"],z=x.offset,g=w(z)?0:H(x.margin,p?5:10)));a.renderLine();a.offset=t*H(d.offset,l[n]);a.tickRotCorr=a.tickRotCorr||{x:0,y:0};f=0===n?-a.labelMetrics().h:2===n?a.tickRotCorr.y:0;g=Math.abs(u)+g;u&&(g=g-f+t*(p?H(G.y,a.tickRotCorr.y+8*t):G.x));a.axisTitleMargin=H(z,g);l[n]=Math.max(l[n],a.axisTitleMargin+E+t*a.offset,\r\ng,A&&m.length&&r?r[0]+t*a.offset:0);d=d.offset?0:2*Math.floor(a.axisLine.strokeWidth()/2);b[e]=Math.max(b[e],d)},getLinePath:function(a){var b=this.chart,f=this.opposite,c=this.offset,h=this.horiz,d=this.left+(f?this.width:0)+c,c=b.chartHeight-this.bottom-(f?this.height:0)+c;f&&(a*=-1);return b.renderer.crispLine([\"M\",h?this.left:d,h?c:this.top,\"L\",h?b.chartWidth-this.right:d,h?c:b.chartHeight-this.bottom],a)},renderLine:function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass(\"highcharts-axis-line\").add(this.axisGroup),\r\nthis.axisLine.attr({stroke:this.options.lineColor,\"stroke-width\":this.options.lineWidth,zIndex:7}))},getTitlePosition:function(){var a=this.horiz,b=this.left,f=this.top,c=this.len,d=this.options.title,m=a?b:f,q=this.opposite,p=this.offset,n=d.x||0,e=d.y||0,A=this.axisTitle,k=this.chart.renderer.fontMetrics(d.style&&d.style.fontSize,A),A=Math.max(A.getBBox(null,0).height-k.h-1,0),c={low:m+(a?0:c),middle:m+c/2,high:m+(a?c:0)}[d.align],b=(a?f+this.height:b)+(a?1:-1)*(q?-1:1)*this.axisTitleMargin+[-A,\r\nA,k.f,-A][this.side];return{x:a?c+n:b+(q?this.width:0)+p+n,y:a?b+e-(q?this.height:0)+p:c+e}},renderMinorTick:function(a){var b=this.chart.hasRendered&&z(this.oldMin),f=this.minorTicks;f[a]||(f[a]=new M(this,a,\"minor\"));b&&f[a].isNew&&f[a].render(null,!0);f[a].render(null,!1,1)},renderTick:function(a,b){var f=this.isLinked,c=this.ticks,d=this.chart.hasRendered&&z(this.oldMin);if(!f||a>=this.min&&a<=this.max)c[a]||(c[a]=new M(this,a)),d&&c[a].isNew&&c[a].render(b,!0,.1),c[a].render(b)},render:function(){var b=\r\nthis,f=b.chart,d=b.options,m=b.isLog,q=b.isLinked,p=b.tickPositions,n=b.axisTitle,e=b.ticks,E=b.minorTicks,g=b.alternateBands,x=d.stackLabels,G=d.alternateGridColor,u=b.tickmarkOffset,l=b.axisLine,H=b.showAxis,t=F(f.renderer.globalAnimation),J,r;b.labelEdge.length=0;b.overlap=!1;c([e,E,g],function(a){B(a,function(a){a.isActive=!1})});if(b.hasData()||q)b.minorTickInterval&&!b.categories&&c(b.getMinorTickPositions(),function(a){b.renderMinorTick(a)}),p.length&&(c(p,function(a,f){b.renderTick(a,f)}),\r\nu&&(0===b.min||b.single)&&(e[-1]||(e[-1]=new M(b,-1,null,!0)),e[-1].render(-1))),G&&c(p,function(c,d){r=void 0!==p[d+1]?p[d+1]+u:b.max-u;0===d%2&&c<b.max&&r<=b.max+(f.polar?-u:u)&&(g[c]||(g[c]=new a.PlotLineOrBand(b)),J=c+u,g[c].options={from:m?b.lin2log(J):J,to:m?b.lin2log(r):r,color:G},g[c].render(),g[c].isActive=!0)}),b._addedPlotLB||(c((d.plotLines||[]).concat(d.plotBands||[]),function(a){b.addPlotBandOrLine(a)}),b._addedPlotLB=!0);c([e,E,g],function(a){var b,c=[],d=t.duration;B(a,function(a,\r\nb){a.isActive||(a.render(b,!1,0),a.isActive=!1,c.push(b))});A(function(){for(b=c.length;b--;)a[c[b]]&&!a[c[b]].isActive&&(a[c[b]].destroy(),delete a[c[b]])},a!==g&&f.hasRendered&&d?d:0)});l&&(l[l.isPlaced?\"animate\":\"attr\"]({d:this.getLinePath(l.strokeWidth())}),l.isPlaced=!0,l[H?\"show\":\"hide\"](!0));n&&H&&(d=b.getTitlePosition(),z(d.y)?(n[n.isNew?\"attr\":\"animate\"](d),n.isNew=!1):(n.attr(\"y\",-9999),n.isNew=!0));x&&x.enabled&&b.renderStackTotals();b.isDirty=!1;k(this,\"afterRender\")},redraw:function(){this.visible&&\r\n(this.render(),c(this.plotLinesAndBands,function(a){a.render()}));c(this.series,function(a){a.isDirty=!0})},keepProps:\"extKey hcEvents names series userMax userMin\".split(\" \"),destroy:function(a){var f=this,d=f.stacks,h=f.plotLinesAndBands,q;k(this,\"destroy\",{keepEvents:a});a||m(f);B(d,function(a,b){u(a);d[b]=null});c([f.ticks,f.minorTicks,f.alternateBands],function(a){u(a)});if(h)for(a=h.length;a--;)h[a].destroy();c(\"stackTotalGroup axisLine axisTitle axisGroup gridGroup labelGroup cross\".split(\" \"),\r\nfunction(a){f[a]&&(f[a]=f[a].destroy())});for(q in f.plotLinesAndBandsGroups)f.plotLinesAndBandsGroups[q]=f.plotLinesAndBandsGroups[q].destroy();B(f,function(a,c){-1===b(c,f.keepProps)&&delete f[c]})},drawCrosshair:function(a,b){var f,c=this.crosshair,d=H(c.snap,!0),h,m=this.cross;k(this,\"drawCrosshair\",{e:a,point:b});a||(a=this.cross&&this.cross.e);if(this.crosshair&&!1!==(w(b)||!d)){d?w(b)&&(h=H(b.crosshairPos,this.isXAxis?b.plotX:this.len-b.plotY)):h=a&&(this.horiz?a.chartX-this.pos:this.len-a.chartY+\r\nthis.pos);w(h)&&(f=this.getPlotLinePath(b&&(this.isXAxis?b.x:H(b.stackY,b.y)),null,null,null,h)||null);if(!w(f)){this.hideCrosshair();return}d=this.categories&&!this.isRadial;m||(this.cross=m=this.chart.renderer.path().addClass(\"highcharts-crosshair highcharts-crosshair-\"+(d?\"category \":\"thin \")+c.className).attr({zIndex:H(c.zIndex,2)}).add(),m.attr({stroke:c.color||(d?g(\"#ccd6eb\").setOpacity(.25).get():\"#cccccc\"),\"stroke-width\":H(c.width,1)}).css({\"pointer-events\":\"none\"}),c.dashStyle&&m.attr({dashstyle:c.dashStyle}));\r\nm.show().attr({d:f});d&&!c.width&&m.attr({\"stroke-width\":this.transA});this.cross.e=a}else this.hideCrosshair();k(this,\"afterDrawCrosshair\",{e:a,point:b})},hideCrosshair:function(){this.cross&&this.cross.hide()}});return a.Axis=G}(K);(function(a){var C=a.Axis,F=a.getMagnitude,D=a.normalizeTickInterval,r=a.timeUnits;C.prototype.getTimeTicks=function(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)};C.prototype.normalizeTimeTickInterval=function(a,e){var g=e||[[\"millisecond\",[1,\r\n2,5,10,20,25,50,100,200,500]],[\"second\",[1,2,5,10,15,30]],[\"minute\",[1,2,5,10,15,30]],[\"hour\",[1,2,3,4,6,8,12]],[\"day\",[1,2]],[\"week\",[1,2]],[\"month\",[1,2,3,4,6]],[\"year\",null]];e=g[g.length-1];var w=r[e[0]],l=e[1],u;for(u=0;u<g.length&&!(e=g[u],w=r[e[0]],l=e[1],g[u+1]&&a<=(w*l[l.length-1]+r[g[u+1][0]])/2);u++);w===r.year&&a<5*w&&(l=[1,2,5]);a=D(a/w,l,\"year\"===e[0]?Math.max(F(a/w),1):1);return{unitRange:w,count:a,unitName:e[0]}}})(K);(function(a){var C=a.Axis,F=a.getMagnitude,D=a.map,r=a.normalizeTickInterval,\r\ng=a.pick;C.prototype.getLogTickPositions=function(a,t,w,l){var e=this.options,c=this.len,d=[];l||(this._minorAutoInterval=null);if(.5<=a)a=Math.round(a),d=this.getLinearTickPositions(a,t,w);else if(.08<=a)for(var c=Math.floor(t),k,x,p,f,b,e=.3<a?[1,2,4]:.15<a?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];c<w+1&&!b;c++)for(x=e.length,k=0;k<x&&!b;k++)p=this.log2lin(this.lin2log(c)*e[k]),p>t&&(!l||f<=w)&&void 0!==f&&d.push(f),f>w&&(b=!0),f=p;else t=this.lin2log(t),w=this.lin2log(w),a=l?this.getMinorTickInterval():\r\ne.tickInterval,a=g(\"auto\"===a?null:a,this._minorAutoInterval,e.tickPixelInterval/(l?5:1)*(w-t)/((l?c/this.tickPositions.length:c)||1)),a=r(a,null,F(a)),d=D(this.getLinearTickPositions(a,t,w),this.log2lin),l||(this._minorAutoInterval=a/5);l||(this.tickInterval=a);return d};C.prototype.log2lin=function(a){return Math.log(a)/Math.LN10};C.prototype.lin2log=function(a){return Math.pow(10,a)}})(K);(function(a,C){var F=a.arrayMax,D=a.arrayMin,r=a.defined,g=a.destroyObjectProperties,e=a.each,t=a.erase,w=\r\na.merge,l=a.pick;a.PlotLineOrBand=function(a,c){this.axis=a;c&&(this.options=c,this.id=c.id)};a.PlotLineOrBand.prototype={render:function(){var e=this,c=e.axis,d=c.horiz,k=e.options,g=k.label,p=e.label,f=k.to,b=k.from,n=k.value,z=r(b)&&r(f),J=r(n),q=e.svgElem,t=!q,B=[],H=k.color,m=l(k.zIndex,0),E=k.events,B={\"class\":\"highcharts-plot-\"+(z?\"band \":\"line \")+(k.className||\"\")},A={},M=c.chart.renderer,G=z?\"bands\":\"lines\";c.isLog&&(b=c.log2lin(b),f=c.log2lin(f),n=c.log2lin(n));J?(B={stroke:H,\"stroke-width\":k.width},\r\nk.dashStyle&&(B.dashstyle=k.dashStyle)):z&&(H&&(B.fill=H),k.borderWidth&&(B.stroke=k.borderColor,B[\"stroke-width\"]=k.borderWidth));A.zIndex=m;G+=\"-\"+m;(H=c.plotLinesAndBandsGroups[G])||(c.plotLinesAndBandsGroups[G]=H=M.g(\"plot-\"+G).attr(A).add());t&&(e.svgElem=q=M.path().attr(B).add(H));if(J)B=c.getPlotLinePath(n,q.strokeWidth());else if(z)B=c.getPlotBandPath(b,f,k);else return;t&&B&&B.length?(q.attr({d:B}),E&&a.objectEach(E,function(a,b){q.on(b,function(a){E[b].apply(e,[a])})})):q&&(B?(q.show(),\r\nq.animate({d:B})):(q.hide(),p&&(e.label=p=p.destroy())));g&&r(g.text)&&B&&B.length&&0<c.width&&0<c.height&&!B.flat?(g=w({align:d&&z&&\"center\",x:d?!z&&4:10,verticalAlign:!d&&z&&\"middle\",y:d?z?16:10:z?6:-4,rotation:d&&!z&&90},g),this.renderLabel(g,B,z,m)):p&&p.hide();return e},renderLabel:function(a,c,d,e){var k=this.label,p=this.axis.chart.renderer;k||(k={align:a.textAlign||a.align,rotation:a.rotation,\"class\":\"highcharts-plot-\"+(d?\"band\":\"line\")+\"-label \"+(a.className||\"\")},k.zIndex=e,this.label=k=\r\np.text(a.text,0,0,a.useHTML).attr(k).add(),k.css(a.style));e=c.xBounds||[c[1],c[4],d?c[6]:c[1]];c=c.yBounds||[c[2],c[5],d?c[7]:c[2]];d=D(e);p=D(c);k.align(a,!1,{x:d,y:p,width:F(e)-d,height:F(c)-p});k.show()},destroy:function(){t(this.axis.plotLinesAndBands,this);delete this.axis;g(this)}};a.extend(C.prototype,{getPlotBandPath:function(a,c){var d=this.getPlotLinePath(c,null,null,!0),e=this.getPlotLinePath(a,null,null,!0),g=[],p=this.horiz,f=1,b;a=a<this.min&&c<this.min||a>this.max&&c>this.max;if(e&&\r\nd)for(a&&(b=e.toString()===d.toString(),f=0),a=0;a<e.length;a+=6)p&&d[a+1]===e[a+1]?(d[a+1]+=f,d[a+4]+=f):p||d[a+2]!==e[a+2]||(d[a+2]+=f,d[a+5]+=f),g.push(\"M\",e[a+1],e[a+2],\"L\",e[a+4],e[a+5],d[a+4],d[a+5],d[a+1],d[a+2],\"z\"),g.flat=b;return g},addPlotBand:function(a){return this.addPlotBandOrLine(a,\"plotBands\")},addPlotLine:function(a){return this.addPlotBandOrLine(a,\"plotLines\")},addPlotBandOrLine:function(e,c){var d=(new a.PlotLineOrBand(this,e)).render(),k=this.userOptions;d&&(c&&(k[c]=k[c]||[],\r\nk[c].push(e)),this.plotLinesAndBands.push(d));return d},removePlotBandOrLine:function(a){for(var c=this.plotLinesAndBands,d=this.options,k=this.userOptions,g=c.length;g--;)c[g].id===a&&c[g].destroy();e([d.plotLines||[],k.plotLines||[],d.plotBands||[],k.plotBands||[]],function(c){for(g=c.length;g--;)c[g].id===a&&t(c,c[g])})},removePlotBand:function(a){this.removePlotBandOrLine(a)},removePlotLine:function(a){this.removePlotBandOrLine(a)}})})(K,V);(function(a){var C=a.each,F=a.extend,D=a.format,r=a.isNumber,\r\ng=a.map,e=a.merge,t=a.pick,w=a.splat,l=a.syncTimeout,u=a.timeUnits;a.Tooltip=function(){this.init.apply(this,arguments)};a.Tooltip.prototype={init:function(a,d){this.chart=a;this.options=d;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=!0;this.split=d.split&&!a.inverted;this.shared=d.shared||this.split},cleanSplit:function(a){C(this.chart.series,function(c){var d=c&&c.tt;d&&(!d.isActive||a?c.tt=d.destroy():d.isActive=!1)})},getLabel:function(){var a=this.chart.renderer,d=this.options;this.label||\r\n(this.split?this.label=a.g(\"tooltip\"):(this.label=a.label(\"\",0,0,d.shape||\"callout\",null,null,d.useHTML,null,\"tooltip\").attr({padding:d.padding,r:d.borderRadius}),this.label.attr({fill:d.backgroundColor,\"stroke-width\":d.borderWidth}).css(d.style).shadow(d.shadow)),this.label.attr({zIndex:8}).add());return this.label},update:function(a){this.destroy();e(!0,this.chart.options.tooltip.userOptions,a);this.init(this.chart,e(!0,this.options,a))},destroy:function(){this.label&&(this.label=this.label.destroy());\r\nthis.split&&this.tt&&(this.cleanSplit(this.chart,!0),this.tt=this.tt.destroy());a.clearTimeout(this.hideTimer);a.clearTimeout(this.tooltipTimeout)},move:function(c,d,e,g){var p=this,f=p.now,b=!1!==p.options.animation&&!p.isHidden&&(1<Math.abs(c-f.x)||1<Math.abs(d-f.y)),n=p.followPointer||1<p.len;F(f,{x:b?(2*f.x+c)/3:c,y:b?(f.y+d)/2:d,anchorX:n?void 0:b?(2*f.anchorX+e)/3:e,anchorY:n?void 0:b?(f.anchorY+g)/2:g});p.getLabel().attr(f);b&&(a.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){p&&\r\np.move(c,d,e,g)},32))},hide:function(c){var d=this;a.clearTimeout(this.hideTimer);c=t(c,this.options.hideDelay,500);this.isHidden||(this.hideTimer=l(function(){d.getLabel()[c?\"fadeOut\":\"hide\"]();d.isHidden=!0},c))},getAnchor:function(a,d){var c,e=this.chart,p=e.inverted,f=e.plotTop,b=e.plotLeft,n=0,z=0,l,q;a=w(a);c=a[0].tooltipPos;this.followPointer&&d&&(void 0===d.chartX&&(d=e.pointer.normalize(d)),c=[d.chartX-e.plotLeft,d.chartY-f]);c||(C(a,function(a){l=a.series.yAxis;q=a.series.xAxis;n+=a.plotX+\r\n(!p&&q?q.left-b:0);z+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!p&&l?l.top-f:0)}),n/=a.length,z/=a.length,c=[p?e.plotWidth-z:n,this.shared&&!p&&1<a.length&&d?d.chartY-f:p?e.plotHeight-n:z]);return g(c,Math.round)},getPosition:function(a,d,e){var c=this.chart,p=this.distance,f={},b=c.inverted&&e.h||0,n,g=[\"y\",c.chartHeight,d,e.plotY+c.plotTop,c.plotTop,c.plotTop+c.plotHeight],k=[\"x\",c.chartWidth,a,e.plotX+c.plotLeft,c.plotLeft,c.plotLeft+c.plotWidth],q=!this.followPointer&&t(e.ttBelow,!c.inverted===\r\n!!e.negative),l=function(a,c,d,m,h,e){var n=d<m-p,A=m+p+d<c,g=m-p-d;m+=p;if(q&&A)f[a]=m;else if(!q&&n)f[a]=g;else if(n)f[a]=Math.min(e-d,0>g-b?g:g-b);else if(A)f[a]=Math.max(h,m+b+d>c?m:m+b);else return!1},B=function(a,b,c,d){var h;d<p||d>b-p?h=!1:f[a]=d<c/2?1:d>b-c/2?b-c-2:d-c/2;return h},H=function(a){var b=g;g=k;k=b;n=a},m=function(){!1!==l.apply(0,g)?!1!==B.apply(0,k)||n||(H(!0),m()):n?f.x=f.y=0:(H(!0),m())};(c.inverted||1<this.len)&&H();m();return f},defaultFormatter:function(a){var c=this.points||\r\nw(this),e;e=[a.tooltipFooterHeaderFormatter(c[0])];e=e.concat(a.bodyFormatter(c));e.push(a.tooltipFooterHeaderFormatter(c[0],!0));return e},refresh:function(c,d){var e,g=this.options,p,f=c,b,n={},z=[];e=g.formatter||this.defaultFormatter;var n=this.shared,l;g.enabled&&(a.clearTimeout(this.hideTimer),this.followPointer=w(f)[0].series.tooltipOptions.followPointer,b=this.getAnchor(f,d),d=b[0],p=b[1],!n||f.series&&f.series.noSharedTooltip?n=f.getLabelConfig():(C(f,function(a){a.setState(\"hover\");z.push(a.getLabelConfig())}),\r\nn={x:f[0].category,y:f[0].y},n.points=z,f=f[0]),this.len=z.length,n=e.call(n,this),l=f.series,this.distance=t(l.tooltipOptions.distance,16),!1===n?this.hide():(e=this.getLabel(),this.isHidden&&e.attr({opacity:1}).show(),this.split?this.renderSplit(n,w(c)):(g.style.width||e.css({width:this.chart.spacingBox.width}),e.attr({text:n&&n.join?n.join(\"\"):n}),e.removeClass(/highcharts-color-[\\d]+/g).addClass(\"highcharts-color-\"+t(f.colorIndex,l.colorIndex)),e.attr({stroke:g.borderColor||f.color||l.color||\r\n\"#666666\"}),this.updatePosition({plotX:d,plotY:p,negative:f.negative,ttBelow:f.ttBelow,h:b[2]||0})),this.isHidden=!1))},renderSplit:function(c,d){var e=this,g=[],p=this.chart,f=p.renderer,b=!0,n=this.options,z=0,l=this.getLabel();a.isString(c)&&(c=[!1,c]);C(c.slice(0,d.length+1),function(a,c){if(!1!==a){c=d[c-1]||{isHeader:!0,plotX:d[0].plotX};var q=c.series||e,k=q.tt,m=c.series||{},E=\"highcharts-color-\"+t(c.colorIndex,m.colorIndex,\"none\");k||(q.tt=k=f.label(null,null,null,\"callout\",null,null,n.useHTML).addClass(\"highcharts-tooltip-box \"+\r\nE).attr({padding:n.padding,r:n.borderRadius,fill:n.backgroundColor,stroke:n.borderColor||c.color||m.color||\"#333333\",\"stroke-width\":n.borderWidth}).add(l));k.isActive=!0;k.attr({text:a});k.css(n.style).shadow(n.shadow);a=k.getBBox();m=a.width+k.strokeWidth();c.isHeader?(z=a.height,m=Math.max(0,Math.min(c.plotX+p.plotLeft-m/2,p.chartWidth-m))):m=c.plotX+p.plotLeft-t(n.distance,16)-m;0>m&&(b=!1);a=(c.series&&c.series.yAxis&&c.series.yAxis.pos)+(c.plotY||0);a-=p.plotTop;g.push({target:c.isHeader?p.plotHeight+\r\nz:a,rank:c.isHeader?1:0,size:q.tt.getBBox().height+1,point:c,x:m,tt:k})}});this.cleanSplit();a.distribute(g,p.plotHeight+z);C(g,function(a){var c=a.point,f=c.series;a.tt.attr({visibility:void 0===a.pos?\"hidden\":\"inherit\",x:b||c.isHeader?a.x:c.plotX+p.plotLeft+t(n.distance,16),y:a.pos+p.plotTop,anchorX:c.isHeader?c.plotX+p.plotLeft:c.plotX+f.xAxis.pos,anchorY:c.isHeader?a.pos+p.plotTop-15:c.plotY+f.yAxis.pos})})},updatePosition:function(a){var c=this.chart,e=this.getLabel(),e=(this.options.positioner||\r\nthis.getPosition).call(this,e.width,e.height,a);this.move(Math.round(e.x),Math.round(e.y||0),a.plotX+c.plotLeft,a.plotY+c.plotTop)},getDateFormat:function(a,d,e,g){var c=this.chart.time,f=c.dateFormat(\"%m-%d %H:%M:%S.%L\",d),b,n,k={millisecond:15,second:12,minute:9,hour:6,day:3},l=\"millisecond\";for(n in u){if(a===u.week&&+c.dateFormat(\"%w\",d)===e&&\"00:00:00.000\"===f.substr(6)){n=\"week\";break}if(u[n]>a){n=l;break}if(k[n]&&f.substr(k[n])!==\"01-01 00:00:00.000\".substr(k[n]))break;\"week\"!==n&&(l=n)}n&&\r\n(b=g[n]);return b},getXDateFormat:function(a,d,e){d=d.dateTimeLabelFormats;var c=e&&e.closestPointRange;return(c?this.getDateFormat(c,a.x,e.options.startOfWeek,d):d.day)||d.year},tooltipFooterHeaderFormatter:function(a,d){d=d?\"footer\":\"header\";var c=a.series,e=c.tooltipOptions,p=e.xDateFormat,f=c.xAxis,b=f&&\"datetime\"===f.options.type&&r(a.key),n=e[d+\"Format\"];b&&!p&&(p=this.getXDateFormat(a,e,f));b&&p&&C(a.point&&a.point.tooltipDateKeys||[\"key\"],function(a){n=n.replace(\"{point.\"+a+\"}\",\"{point.\"+\r\na+\":\"+p+\"}\")});return D(n,{point:a,series:c},this.chart.time)},bodyFormatter:function(a){return g(a,function(a){var c=a.series.tooltipOptions;return(c[(a.point.formatPrefix||\"point\")+\"Formatter\"]||a.point.tooltipFormatter).call(a.point,c[(a.point.formatPrefix||\"point\")+\"Format\"])})}}})(K);(function(a){var C=a.addEvent,F=a.attr,D=a.charts,r=a.color,g=a.css,e=a.defined,t=a.each,w=a.extend,l=a.find,u=a.fireEvent,c=a.isNumber,d=a.isObject,k=a.offset,x=a.pick,p=a.splat,f=a.Tooltip;a.Pointer=function(a,\r\nc){this.init(a,c)};a.Pointer.prototype={init:function(a,c){this.options=c;this.chart=a;this.runChartClick=c.chart.events&&!!c.chart.events.click;this.pinchDown=[];this.lastValidTouch={};f&&(a.tooltip=new f(a,c.tooltip),this.followTouchMove=x(c.tooltip.followTouchMove,!0));this.setDOMEvents()},zoomOption:function(a){var b=this.chart,c=b.options.chart,f=c.zoomType||\"\",b=b.inverted;/touch/.test(a.type)&&(f=x(c.pinchType,f));this.zoomX=a=/x/.test(f);this.zoomY=f=/y/.test(f);this.zoomHor=a&&!b||f&&b;this.zoomVert=\r\nf&&!b||a&&b;this.hasZoom=a||f},normalize:function(a,c){var b;b=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a;c||(this.chartPosition=c=k(this.chart.container));return w(a,{chartX:Math.round(b.pageX-c.left),chartY:Math.round(b.pageY-c.top)})},getCoordinates:function(a){var b={xAxis:[],yAxis:[]};t(this.chart.axes,function(c){b[c.isXAxis?\"xAxis\":\"yAxis\"].push({axis:c,value:c.toValue(a[c.horiz?\"chartX\":\"chartY\"])})});return b},findNearestKDPoint:function(a,c,f){var b;t(a,function(a){var e=\r\n!(a.noSharedTooltip&&c)&&0>a.options.findNearestPointBy.indexOf(\"y\");a=a.searchPoint(f,e);if((e=d(a,!0))&&!(e=!d(b,!0)))var e=b.distX-a.distX,p=b.dist-a.dist,q=(a.series.group&&a.series.group.zIndex)-(b.series.group&&b.series.group.zIndex),e=0<(0!==e&&c?e:0!==p?p:0!==q?q:b.series.index>a.series.index?-1:1);e&&(b=a)});return b},getPointFromEvent:function(a){a=a.target;for(var b;a&&!b;)b=a.point,a=a.parentNode;return b},getChartCoordinatesFromPoint:function(a,c){var b=a.series,f=b.xAxis,b=b.yAxis,d=\r\nx(a.clientX,a.plotX),e=a.shapeArgs;if(f&&b)return c?{chartX:f.len+f.pos-d,chartY:b.len+b.pos-a.plotY}:{chartX:d+f.pos,chartY:a.plotY+b.pos};if(e&&e.x&&e.y)return{chartX:e.x,chartY:e.y}},getHoverData:function(b,c,f,e,p,g,k){var q,m=[],n=k&&k.isBoosting;e=!(!e||!b);k=c&&!c.stickyTracking?[c]:a.grep(f,function(a){return a.visible&&!(!p&&a.directTouch)&&x(a.options.enableMouseTracking,!0)&&a.stickyTracking});c=(q=e?b:this.findNearestKDPoint(k,p,g))&&q.series;q&&(p&&!c.noSharedTooltip?(k=a.grep(f,function(a){return a.visible&&\r\n!(!p&&a.directTouch)&&x(a.options.enableMouseTracking,!0)&&!a.noSharedTooltip}),t(k,function(a){var b=l(a.points,function(a){return a.x===q.x&&!a.isNull});d(b)&&(n&&(b=a.getPoint(b)),m.push(b))})):m.push(q));return{hoverPoint:q,hoverSeries:c,hoverPoints:m}},runPointActions:function(b,c){var f=this.chart,d=f.tooltip&&f.tooltip.options.enabled?f.tooltip:void 0,e=d?d.shared:!1,p=c||f.hoverPoint,n=p&&p.series||f.hoverSeries,n=this.getHoverData(p,n,f.series,!!c||n&&n.directTouch&&this.isDirectTouch,e,\r\nb,{isBoosting:f.isBoosting}),g,p=n.hoverPoint;g=n.hoverPoints;c=(n=n.hoverSeries)&&n.tooltipOptions.followPointer;e=e&&n&&!n.noSharedTooltip;if(p&&(p!==f.hoverPoint||d&&d.isHidden)){t(f.hoverPoints||[],function(b){-1===a.inArray(b,g)&&b.setState()});t(g||[],function(a){a.setState(\"hover\")});if(f.hoverSeries!==n)n.onMouseOver();f.hoverPoint&&f.hoverPoint.firePointEvent(\"mouseOut\");if(!p.series)return;p.firePointEvent(\"mouseOver\");f.hoverPoints=g;f.hoverPoint=p;d&&d.refresh(e?g:p,b)}else c&&d&&!d.isHidden&&\r\n(p=d.getAnchor([{}],b),d.updatePosition({plotX:p[0],plotY:p[1]}));this.unDocMouseMove||(this.unDocMouseMove=C(f.container.ownerDocument,\"mousemove\",function(b){var c=D[a.hoverChartIndex];if(c)c.pointer.onDocumentMouseMove(b)}));t(f.axes,function(c){var f=x(c.crosshair.snap,!0),d=f?a.find(g,function(a){return a.series[c.coll]===c}):void 0;d||!f?c.drawCrosshair(b,d):c.hideCrosshair()})},reset:function(a,c){var b=this.chart,f=b.hoverSeries,d=b.hoverPoint,e=b.hoverPoints,n=b.tooltip,g=n&&n.shared?e:d;\r\na&&g&&t(p(g),function(b){b.series.isCartesian&&void 0===b.plotX&&(a=!1)});if(a)n&&g&&(n.refresh(g),d&&(d.setState(d.state,!0),t(b.axes,function(a){a.crosshair&&a.drawCrosshair(null,d)})));else{if(d)d.onMouseOut();e&&t(e,function(a){a.setState()});if(f)f.onMouseOut();n&&n.hide(c);this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove());t(b.axes,function(a){a.hideCrosshair()});this.hoverX=b.hoverPoints=b.hoverPoint=null}},scaleGroups:function(a,c){var b=this.chart,f;t(b.series,function(d){f=\r\na||d.getPlotBox();d.xAxis&&d.xAxis.zoomEnabled&&d.group&&(d.group.attr(f),d.markerGroup&&(d.markerGroup.attr(f),d.markerGroup.clip(c?b.clipRect:null)),d.dataLabelsGroup&&d.dataLabelsGroup.attr(f))});b.clipRect.attr(c||b.clipBox)},dragStart:function(a){var b=this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var b=this.chart,c=b.options.chart,f=a.chartX,d=a.chartY,e=this.zoomHor,p=this.zoomVert,g=b.plotLeft,\r\nm=b.plotTop,k=b.plotWidth,A=b.plotHeight,l,G=this.selectionMarker,h=this.mouseDownX,v=this.mouseDownY,t=c.panKey&&a[c.panKey+\"Key\"];G&&G.touch||(f<g?f=g:f>g+k&&(f=g+k),d<m?d=m:d>m+A&&(d=m+A),this.hasDragged=Math.sqrt(Math.pow(h-f,2)+Math.pow(v-d,2)),10<this.hasDragged&&(l=b.isInsidePlot(h-g,v-m),b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&l&&!t&&!G&&(this.selectionMarker=G=b.renderer.rect(g,m,e?1:k,p?1:A,0).attr({fill:c.selectionMarkerFill||r(\"#335cad\").setOpacity(.25).get(),\"class\":\"highcharts-selection-marker\",\r\nzIndex:7}).add()),G&&e&&(f-=h,G.attr({width:Math.abs(f),x:(0<f?0:f)+h})),G&&p&&(f=d-v,G.attr({height:Math.abs(f),y:(0<f?0:f)+v})),l&&!G&&c.panning&&b.pan(a,c.panning)))},drop:function(a){var b=this,f=this.chart,d=this.hasPinched;if(this.selectionMarker){var p={originalEvent:a,xAxis:[],yAxis:[]},k=this.selectionMarker,B=k.attr?k.attr(\"x\"):k.x,l=k.attr?k.attr(\"y\"):k.y,m=k.attr?k.attr(\"width\"):k.width,E=k.attr?k.attr(\"height\"):k.height,A;if(this.hasDragged||d)t(f.axes,function(c){if(c.zoomEnabled&&e(c.min)&&\r\n(d||b[{xAxis:\"zoomX\",yAxis:\"zoomY\"}[c.coll]])){var f=c.horiz,h=\"touchend\"===a.type?c.minPixelPadding:0,g=c.toValue((f?B:l)+h),f=c.toValue((f?B+m:l+E)-h);p[c.coll].push({axis:c,min:Math.min(g,f),max:Math.max(g,f)});A=!0}}),A&&u(f,\"selection\",p,function(a){f.zoom(w(a,d?{animation:!1}:null))});c(f.index)&&(this.selectionMarker=this.selectionMarker.destroy());d&&this.scaleGroups()}f&&c(f.index)&&(g(f.container,{cursor:f._cursor}),f.cancelClick=10<this.hasDragged,f.mouseIsDown=this.hasDragged=this.hasPinched=\r\n!1,this.pinchDown=[])},onContainerMouseDown:function(a){a=this.normalize(a);2!==a.button&&(this.zoomOption(a),a.preventDefault&&a.preventDefault(),this.dragStart(a))},onDocumentMouseUp:function(b){D[a.hoverChartIndex]&&D[a.hoverChartIndex].pointer.drop(b)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition;a=this.normalize(a,c);!c||this.inClass(a.target,\"highcharts-tracker\")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)||this.reset()},onContainerMouseLeave:function(b){var c=\r\nD[a.hoverChartIndex];c&&(b.relatedTarget||b.toElement)&&(c.pointer.reset(),c.pointer.chartPosition=null)},onContainerMouseMove:function(b){var c=this.chart;e(a.hoverChartIndex)&&D[a.hoverChartIndex]&&D[a.hoverChartIndex].mouseIsDown||(a.hoverChartIndex=c.index);b=this.normalize(b);b.returnValue=!1;\"mousedown\"===c.mouseIsDown&&this.drag(b);!this.inClass(b.target,\"highcharts-tracker\")&&!c.isInsidePlot(b.chartX-c.plotLeft,b.chartY-c.plotTop)||c.openMenu||this.runPointActions(b)},inClass:function(a,c){for(var b;a;){if(b=\r\nF(a,\"class\")){if(-1!==b.indexOf(c))return!0;if(-1!==b.indexOf(\"highcharts-container\"))return!1}a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries;a=a.relatedTarget||a.toElement;this.isDirectTouch=!1;if(!(!b||!a||b.stickyTracking||this.inClass(a,\"highcharts-tooltip\")||this.inClass(a,\"highcharts-series-\"+b.index)&&this.inClass(a,\"highcharts-tracker\")))b.onMouseOut()},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,f=b.plotLeft,d=b.plotTop;a=this.normalize(a);b.cancelClick||\r\n(c&&this.inClass(a.target,\"highcharts-tracker\")?(u(c.series,\"click\",w(a,{point:c})),b.hoverPoint&&c.firePointEvent(\"click\",a)):(w(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-f,a.chartY-d)&&u(b,\"click\",a)))},setDOMEvents:function(){var b=this,c=b.chart.container,f=c.ownerDocument;c.onmousedown=function(a){b.onContainerMouseDown(a)};c.onmousemove=function(a){b.onContainerMouseMove(a)};c.onclick=function(a){b.onContainerClick(a)};this.unbindContainerMouseLeave=C(c,\"mouseleave\",b.onContainerMouseLeave);\r\na.unbindDocumentMouseUp||(a.unbindDocumentMouseUp=C(f,\"mouseup\",b.onDocumentMouseUp));a.hasTouch&&(c.ontouchstart=function(a){b.onContainerTouchStart(a)},c.ontouchmove=function(a){b.onContainerTouchMove(a)},a.unbindDocumentTouchEnd||(a.unbindDocumentTouchEnd=C(f,\"touchend\",b.onDocumentTouchEnd)))},destroy:function(){var b=this;b.unDocMouseMove&&b.unDocMouseMove();this.unbindContainerMouseLeave();a.chartCount||(a.unbindDocumentMouseUp&&(a.unbindDocumentMouseUp=a.unbindDocumentMouseUp()),a.unbindDocumentTouchEnd&&\r\n(a.unbindDocumentTouchEnd=a.unbindDocumentTouchEnd()));clearInterval(b.tooltipTimeout);a.objectEach(b,function(a,c){b[c]=null})}}})(K);(function(a){var C=a.charts,F=a.each,D=a.extend,r=a.map,g=a.noop,e=a.pick;D(a.Pointer.prototype,{pinchTranslate:function(a,e,g,r,c,d){this.zoomHor&&this.pinchTranslateDirection(!0,a,e,g,r,c,d);this.zoomVert&&this.pinchTranslateDirection(!1,a,e,g,r,c,d)},pinchTranslateDirection:function(a,e,g,r,c,d,k,x){var p=this.chart,f=a?\"x\":\"y\",b=a?\"X\":\"Y\",n=\"chart\"+b,l=a?\"width\":\r\n\"height\",t=p[\"plot\"+(a?\"Left\":\"Top\")],q,u,B=x||1,H=p.inverted,m=p.bounds[a?\"h\":\"v\"],E=1===e.length,A=e[0][n],M=g[0][n],G=!E&&e[1][n],h=!E&&g[1][n],v;g=function(){!E&&20<Math.abs(A-G)&&(B=x||Math.abs(M-h)/Math.abs(A-G));u=(t-M)/B+A;q=p[\"plot\"+(a?\"Width\":\"Height\")]/B};g();e=u;e<m.min?(e=m.min,v=!0):e+q>m.max&&(e=m.max-q,v=!0);v?(M-=.8*(M-k[f][0]),E||(h-=.8*(h-k[f][1])),g()):k[f]=[M,h];H||(d[f]=u-t,d[l]=q);d=H?1/B:B;c[l]=q;c[f]=e;r[H?a?\"scaleY\":\"scaleX\":\"scale\"+b]=B;r[\"translate\"+b]=d*t+(M-d*A)},pinch:function(a){var t=\r\nthis,l=t.chart,u=t.pinchDown,c=a.touches,d=c.length,k=t.lastValidTouch,x=t.hasZoom,p=t.selectionMarker,f={},b=1===d&&(t.inClass(a.target,\"highcharts-tracker\")&&l.runTrackerClick||t.runChartClick),n={};1<d&&(t.initiated=!0);x&&t.initiated&&!b&&a.preventDefault();r(c,function(a){return t.normalize(a)});\"touchstart\"===a.type?(F(c,function(a,b){u[b]={chartX:a.chartX,chartY:a.chartY}}),k.x=[u[0].chartX,u[1]&&u[1].chartX],k.y=[u[0].chartY,u[1]&&u[1].chartY],F(l.axes,function(a){if(a.zoomEnabled){var b=\r\nl.bounds[a.horiz?\"h\":\"v\"],c=a.minPixelPadding,f=a.toPixels(e(a.options.min,a.dataMin)),d=a.toPixels(e(a.options.max,a.dataMax)),p=Math.max(f,d);b.min=Math.min(a.pos,Math.min(f,d)-c);b.max=Math.max(a.pos+a.len,p+c)}}),t.res=!0):t.followTouchMove&&1===d?this.runPointActions(t.normalize(a)):u.length&&(p||(t.selectionMarker=p=D({destroy:g,touch:!0},l.plotBox)),t.pinchTranslate(u,c,f,p,n,k),t.hasPinched=x,t.scaleGroups(f,n),t.res&&(t.res=!1,this.reset(!1,0)))},touch:function(g,r){var l=this.chart,t,c;\r\nif(l.index!==a.hoverChartIndex)this.onContainerMouseLeave({relatedTarget:!0});a.hoverChartIndex=l.index;1===g.touches.length?(g=this.normalize(g),(c=l.isInsidePlot(g.chartX-l.plotLeft,g.chartY-l.plotTop))&&!l.openMenu?(r&&this.runPointActions(g),\"touchmove\"===g.type&&(r=this.pinchDown,t=r[0]?4<=Math.sqrt(Math.pow(r[0].chartX-g.chartX,2)+Math.pow(r[0].chartY-g.chartY,2)):!1),e(t,!0)&&this.pinch(g)):r&&this.reset()):2===g.touches.length&&this.pinch(g)},onContainerTouchStart:function(a){this.zoomOption(a);\r\nthis.touch(a,!0)},onContainerTouchMove:function(a){this.touch(a)},onDocumentTouchEnd:function(e){C[a.hoverChartIndex]&&C[a.hoverChartIndex].pointer.drop(e)}})})(K);(function(a){var C=a.addEvent,F=a.charts,D=a.css,r=a.doc,g=a.extend,e=a.noop,t=a.Pointer,w=a.removeEvent,l=a.win,u=a.wrap;if(!a.hasTouch&&(l.PointerEvent||l.MSPointerEvent)){var c={},d=!!l.PointerEvent,k=function(){var d=[];d.item=function(a){return this[a]};a.objectEach(c,function(a){d.push({pageX:a.pageX,pageY:a.pageY,target:a.target})});\r\nreturn d},x=function(c,f,b,d){\"touch\"!==c.pointerType&&c.pointerType!==c.MSPOINTER_TYPE_TOUCH||!F[a.hoverChartIndex]||(d(c),d=F[a.hoverChartIndex].pointer,d[f]({type:b,target:c.currentTarget,preventDefault:e,touches:k()}))};g(t.prototype,{onContainerPointerDown:function(a){x(a,\"onContainerTouchStart\",\"touchstart\",function(a){c[a.pointerId]={pageX:a.pageX,pageY:a.pageY,target:a.currentTarget}})},onContainerPointerMove:function(a){x(a,\"onContainerTouchMove\",\"touchmove\",function(a){c[a.pointerId]={pageX:a.pageX,\r\npageY:a.pageY};c[a.pointerId].target||(c[a.pointerId].target=a.currentTarget)})},onDocumentPointerUp:function(a){x(a,\"onDocumentTouchEnd\",\"touchend\",function(a){delete c[a.pointerId]})},batchMSEvents:function(a){a(this.chart.container,d?\"pointerdown\":\"MSPointerDown\",this.onContainerPointerDown);a(this.chart.container,d?\"pointermove\":\"MSPointerMove\",this.onContainerPointerMove);a(r,d?\"pointerup\":\"MSPointerUp\",this.onDocumentPointerUp)}});u(t.prototype,\"init\",function(a,c,b){a.call(this,c,b);this.hasZoom&&\r\nD(c.container,{\"-ms-touch-action\":\"none\",\"touch-action\":\"none\"})});u(t.prototype,\"setDOMEvents\",function(a){a.apply(this);(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(C)});u(t.prototype,\"destroy\",function(a){this.batchMSEvents(w);a.call(this)})}})(K);(function(a){var C=a.addEvent,F=a.css,D=a.discardElement,r=a.defined,g=a.each,e=a.fireEvent,t=a.isFirefox,w=a.marginNames,l=a.merge,u=a.pick,c=a.setAnimation,d=a.stableSort,k=a.win,x=a.wrap;a.Legend=function(a,c){this.init(a,c)};a.Legend.prototype=\r\n{init:function(a,c){this.chart=a;this.setOptions(c);c.enabled&&(this.render(),C(this.chart,\"endResize\",function(){this.legend.positionCheckboxes()}))},setOptions:function(a){var c=u(a.padding,8);this.options=a;this.itemStyle=a.itemStyle;this.itemHiddenStyle=l(this.itemStyle,a.itemHiddenStyle);this.itemMarginTop=a.itemMarginTop||0;this.padding=c;this.initialItemY=c-5;this.symbolWidth=u(a.symbolWidth,16);this.pages=[]},update:function(a,c){var b=this.chart;this.setOptions(l(!0,this.options,a));this.destroy();\r\nb.isDirtyLegend=b.isDirtyBox=!0;u(c,!0)&&b.redraw();e(this,\"afterUpdate\")},colorizeItem:function(a,c){a.legendGroup[c?\"removeClass\":\"addClass\"](\"highcharts-legend-item-hidden\");var b=this.options,f=a.legendItem,d=a.legendLine,g=a.legendSymbol,p=this.itemHiddenStyle.color,b=c?b.itemStyle.color:p,k=c?a.color||p:p,B=a.options&&a.options.marker,l={fill:k};f&&f.css({fill:b,color:b});d&&d.attr({stroke:k});g&&(B&&g.isMarker&&(l=a.pointAttribs(),c||(l.stroke=l.fill=p)),g.attr(l));e(this,\"afterColorizeItem\",\r\n{item:a,visible:c})},positionItem:function(a){var c=this.options,b=c.symbolPadding,c=!c.rtl,d=a._legendItemPos,e=d[0],d=d[1],g=a.checkbox;(a=a.legendGroup)&&a.element&&a.translate(c?e:this.legendWidth-e-2*b-4,d);g&&(g.x=e,g.y=d)},destroyItem:function(a){var c=a.checkbox;g([\"legendItem\",\"legendLine\",\"legendSymbol\",\"legendGroup\"],function(b){a[b]&&(a[b]=a[b].destroy())});c&&D(a.checkbox)},destroy:function(){function a(a){this[a]&&(this[a]=this[a].destroy())}g(this.getAllItems(),function(c){g([\"legendItem\",\r\n\"legendGroup\"],a,c)});g(\"clipRect up down pager nav box title group\".split(\" \"),a,this);this.display=null},positionCheckboxes:function(){var a=this.group&&this.group.alignAttr,c,b=this.clipHeight||this.legendHeight,d=this.titleHeight;a&&(c=a.translateY,g(this.allItems,function(f){var e=f.checkbox,g;e&&(g=c+d+e.y+(this.scrollOffset||0)+3,F(e,{left:a.translateX+f.checkboxOffset+e.x-20+\"px\",top:g+\"px\",display:g>c-6&&g<c+b-6?\"\":\"none\"}))},this))},renderTitle:function(){var a=this.options,c=this.padding,\r\nb=a.title,d=0;b.text&&(this.title||(this.title=this.chart.renderer.label(b.text,c-3,c-4,null,null,null,a.useHTML,null,\"legend-title\").attr({zIndex:1}).css(b.style).add(this.group)),a=this.title.getBBox(),d=a.height,this.offsetWidth=a.width,this.contentGroup.attr({translateY:d}));this.titleHeight=d},setText:function(c){var d=this.options;c.legendItem.attr({text:d.labelFormat?a.format(d.labelFormat,c,this.chart.time):d.labelFormatter.call(c)})},renderItem:function(a){var c=this.chart,b=c.renderer,d=\r\nthis.options,e=this.symbolWidth,g=d.symbolPadding,q=this.itemStyle,k=this.itemHiddenStyle,p=\"horizontal\"===d.layout?u(d.itemDistance,20):0,t=!d.rtl,m=a.legendItem,E=!a.series,A=!E&&a.series.drawLegendSymbol?a.series:a,x=A.options,x=this.createCheckboxForItem&&x&&x.showCheckbox,p=e+g+p+(x?20:0),G=d.useHTML,h=a.options.className;m||(a.legendGroup=b.g(\"legend-item\").addClass(\"highcharts-\"+A.type+\"-series highcharts-color-\"+a.colorIndex+(h?\" \"+h:\"\")+(E?\" highcharts-series-\"+a.index:\"\")).attr({zIndex:1}).add(this.scrollGroup),\r\na.legendItem=m=b.text(\"\",t?e+g:-g,this.baseline||0,G).css(l(a.visible?q:k)).attr({align:t?\"left\":\"right\",zIndex:2}).add(a.legendGroup),this.baseline||(e=q.fontSize,this.fontMetrics=b.fontMetrics(e,m),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,m.attr(\"y\",this.baseline)),this.symbolHeight=d.symbolHeight||this.fontMetrics.f,A.drawLegendSymbol(this,a),this.setItemEvents&&this.setItemEvents(a,m,G),x&&this.createCheckboxForItem(a));this.colorizeItem(a,a.visible);q.width||m.css({width:(d.itemWidth||\r\nd.width||c.spacingBox.width)-p});this.setText(a);c=m.getBBox();a.itemWidth=a.checkboxOffset=d.itemWidth||a.legendItemWidth||c.width+p;this.maxItemWidth=Math.max(this.maxItemWidth,a.itemWidth);this.totalItemWidth+=a.itemWidth;this.itemHeight=a.itemHeight=Math.round(a.legendItemHeight||c.height||this.symbolHeight)},layoutItem:function(a){var c=this.options,b=this.padding,d=\"horizontal\"===c.layout,e=a.itemHeight,g=c.itemMarginBottom||0,q=this.itemMarginTop,k=d?u(c.itemDistance,20):0,p=c.width,l=p||this.chart.spacingBox.width-\r\n2*b-c.x,c=c.alignColumns&&this.totalItemWidth>l?this.maxItemWidth:a.itemWidth;d&&this.itemX-b+c>l&&(this.itemX=b,this.itemY+=q+this.lastLineHeight+g,this.lastLineHeight=0);this.lastItemY=q+this.itemY+g;this.lastLineHeight=Math.max(e,this.lastLineHeight);a._legendItemPos=[this.itemX,this.itemY];d?this.itemX+=c:(this.itemY+=q+e+g,this.lastLineHeight=e);this.offsetWidth=p||Math.max((d?this.itemX-b-(a.checkbox?0:k):c)+b,this.offsetWidth)},getAllItems:function(){var a=[];g(this.chart.series,function(c){var b=\r\nc&&c.options;c&&u(b.showInLegend,r(b.linkedTo)?!1:void 0,!0)&&(a=a.concat(c.legendItems||(\"point\"===b.legendType?c.data:c)))});e(this,\"afterGetAllItems\",{allItems:a});return a},getAlignment:function(){var a=this.options;return a.floating?\"\":a.align.charAt(0)+a.verticalAlign.charAt(0)+a.layout.charAt(0)},adjustMargins:function(a,c){var b=this.chart,d=this.options,f=this.getAlignment();f&&g([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(e,g){e.test(f)&&!r(a[g])&&(b[w[g]]=Math.max(b[w[g]],\r\nb.legend[(g+1)%2?\"legendHeight\":\"legendWidth\"]+[1,-1,-1,1][g]*d[g%2?\"x\":\"y\"]+u(d.margin,12)+c[g]+(0===g&&void 0!==b.options.title.margin?b.titleOffset+b.options.title.margin:0)))})},render:function(){var a=this.chart,c=a.renderer,b=this.group,e,k,x,q,t=this.box,B=this.options,r=this.padding;this.itemX=r;this.itemY=this.initialItemY;this.lastItemY=this.offsetWidth=0;b||(this.group=b=c.g(\"legend\").attr({zIndex:7}).add(),this.contentGroup=c.g().attr({zIndex:1}).add(b),this.scrollGroup=c.g().add(this.contentGroup));\r\nthis.renderTitle();e=this.getAllItems();d(e,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)});B.reversed&&e.reverse();this.allItems=e;this.display=k=!!e.length;this.itemHeight=this.totalItemWidth=this.maxItemWidth=this.lastLineHeight=0;g(e,this.renderItem,this);g(e,this.layoutItem,this);x=(B.width||this.offsetWidth)+r;q=this.lastItemY+this.lastLineHeight+this.titleHeight;q=this.handleOverflow(q);q+=r;t||(this.box=t=c.rect().addClass(\"highcharts-legend-box\").attr({r:B.borderRadius}).add(b),\r\nt.isNew=!0);t.attr({stroke:B.borderColor,\"stroke-width\":B.borderWidth||0,fill:B.backgroundColor||\"none\"}).shadow(B.shadow);0<x&&0<q&&(t[t.isNew?\"attr\":\"animate\"](t.crisp.call({},{x:0,y:0,width:x,height:q},t.strokeWidth())),t.isNew=!1);t[k?\"show\":\"hide\"]();this.legendWidth=x;this.legendHeight=q;g(e,this.positionItem,this);k&&(c=a.spacingBox,/(lth|ct|rth)/.test(this.getAlignment())&&(c=l(c,{y:c.y+a.titleOffset+a.options.title.margin})),b.align(l(B,{width:x,height:q}),!0,c));a.isResizing||this.positionCheckboxes()},\r\nhandleOverflow:function(a){var c=this,b=this.chart,d=b.renderer,e=this.options,k=e.y,q=this.padding,b=b.spacingBox.height+(\"top\"===e.verticalAlign?-k:k)-q,k=e.maxHeight,p,l=this.clipRect,t=e.navigation,m=u(t.animation,!0),E=t.arrowSize||12,A=this.nav,x=this.pages,G,h=this.allItems,v=function(a){\"number\"===typeof a?l.attr({height:a}):l&&(c.clipRect=l.destroy(),c.contentGroup.clip());c.contentGroup.div&&(c.contentGroup.div.style.clip=a?\"rect(\"+q+\"px,9999px,\"+(q+a)+\"px,0)\":\"auto\")};\"horizontal\"!==e.layout||\r\n\"middle\"===e.verticalAlign||e.floating||(b/=2);k&&(b=Math.min(b,k));x.length=0;a>b&&!1!==t.enabled?(this.clipHeight=p=Math.max(b-20-this.titleHeight-q,0),this.currentPage=u(this.currentPage,1),this.fullHeight=a,g(h,function(a,b){var c=a._legendItemPos[1],d=Math.round(a.legendItem.getBBox().height),f=x.length;if(!f||c-x[f-1]>p&&(G||c)!==x[f-1])x.push(G||c),f++;a.pageIx=f-1;G&&(h[b-1].pageIx=f-1);b===h.length-1&&c+d-x[f-1]>p&&(x.push(c),a.pageIx=f);c!==G&&(G=c)}),l||(l=c.clipRect=d.clipRect(0,q,9999,\r\n0),c.contentGroup.clip(l)),v(p),A||(this.nav=A=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol(\"triangle\",0,0,E,E).on(\"click\",function(){c.scroll(-1,m)}).add(A),this.pager=d.text(\"\",15,10).addClass(\"highcharts-legend-navigation\").css(t.style).add(A),this.down=d.symbol(\"triangle-down\",0,0,E,E).on(\"click\",function(){c.scroll(1,m)}).add(A)),c.scroll(0),a=b):A&&(v(),this.nav=A.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0);return a},scroll:function(a,d){var b=this.pages,f=\r\nb.length;a=this.currentPage+a;var e=this.clipHeight,g=this.options.navigation,k=this.pager,p=this.padding;a>f&&(a=f);0<a&&(void 0!==d&&c(d,this.chart),this.nav.attr({translateX:p,translateY:e+this.padding+7+this.titleHeight,visibility:\"visible\"}),this.up.attr({\"class\":1===a?\"highcharts-legend-nav-inactive\":\"highcharts-legend-nav-active\"}),k.attr({text:a+\"/\"+f}),this.down.attr({x:18+this.pager.getBBox().width,\"class\":a===f?\"highcharts-legend-nav-inactive\":\"highcharts-legend-nav-active\"}),this.up.attr({fill:1===\r\na?g.inactiveColor:g.activeColor}).css({cursor:1===a?\"default\":\"pointer\"}),this.down.attr({fill:a===f?g.inactiveColor:g.activeColor}).css({cursor:a===f?\"default\":\"pointer\"}),this.scrollOffset=-b[a-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=a,this.positionCheckboxes())}};a.LegendSymbolMixin={drawRectangle:function(a,c){var b=a.symbolHeight,d=a.options.squareSymbol;c.legendSymbol=this.chart.renderer.rect(d?(a.symbolWidth-b)/2:0,a.baseline-b+1,d?b:a.symbolWidth,\r\nb,u(a.options.symbolRadius,b/2)).addClass(\"highcharts-point\").attr({zIndex:3}).add(c.legendGroup)},drawLineMarker:function(a){var c=this.options,b=c.marker,d=a.symbolWidth,e=a.symbolHeight,g=e/2,k=this.chart.renderer,p=this.legendGroup;a=a.baseline-Math.round(.3*a.fontMetrics.b);var B;B={\"stroke-width\":c.lineWidth||0};c.dashStyle&&(B.dashstyle=c.dashStyle);this.legendLine=k.path([\"M\",0,a,\"L\",d,a]).addClass(\"highcharts-graph\").attr(B).add(p);b&&!1!==b.enabled&&(c=Math.min(u(b.radius,g),g),0===this.symbol.indexOf(\"url\")&&\r\n(b=l(b,{width:e,height:e}),c=0),this.legendSymbol=b=k.symbol(this.symbol,d/2-c,a-c,2*c,2*c,b).addClass(\"highcharts-point\").add(p),b.isMarker=!0)}};(/Trident\\/7\\.0/.test(k.navigator.userAgent)||t)&&x(a.Legend.prototype,\"positionItem\",function(a,c){var b=this,d=function(){c._legendItemPos&&a.call(b,c)};d();setTimeout(d)})})(K);(function(a){var C=a.addEvent,F=a.animate,D=a.animObject,r=a.attr,g=a.doc,e=a.Axis,t=a.createElement,w=a.defaultOptions,l=a.discardElement,u=a.charts,c=a.css,d=a.defined,k=a.each,\r\nx=a.extend,p=a.find,f=a.fireEvent,b=a.grep,n=a.isNumber,z=a.isObject,J=a.isString,q=a.Legend,L=a.marginNames,B=a.merge,H=a.objectEach,m=a.Pointer,E=a.pick,A=a.pInt,M=a.removeEvent,G=a.seriesTypes,h=a.splat,v=a.syncTimeout,Q=a.win,P=a.Chart=function(){this.getArgs.apply(this,arguments)};a.chart=function(a,b,c){return new P(a,b,c)};x(P.prototype,{callbacks:[],getArgs:function(){var a=[].slice.call(arguments);if(J(a[0])||a[0].nodeName)this.renderTo=a.shift();this.init(a[0],a[1])},init:function(b,c){var d,\r\nh,m=b.series,e=b.plotOptions||{};f(this,\"init\",{args:arguments},function(){b.series=null;d=B(w,b);for(h in d.plotOptions)d.plotOptions[h].tooltip=e[h]&&B(e[h].tooltip)||void 0;d.tooltip.userOptions=b.chart&&b.chart.forExport&&b.tooltip.userOptions||b.tooltip;d.series=b.series=m;this.userOptions=b;var g=d.chart,k=g.events;this.margin=[];this.spacing=[];this.bounds={h:{},v:{}};this.labelCollectors=[];this.callback=c;this.isResizing=0;this.options=d;this.axes=[];this.series=[];this.time=b.time&&a.keys(b.time).length?\r\nnew a.Time(b.time):a.time;this.hasCartesianSeries=g.showAxes;var A=this;A.index=u.length;u.push(A);a.chartCount++;k&&H(k,function(a,b){C(A,b,a)});A.xAxis=[];A.yAxis=[];A.pointCount=A.colorCounter=A.symbolCounter=0;f(A,\"afterInit\");A.firstRender()})},initSeries:function(b){var c=this.options.chart;(c=G[b.type||c.type||c.defaultSeriesType])||a.error(17,!0);c=new c;c.init(this,b);return c},orderSeries:function(a){var b=this.series;for(a=a||0;a<b.length;a++)b[a]&&(b[a].index=a,b[a].name=b[a].getName())},\r\nisInsidePlot:function(a,b,c){var d=c?b:a;a=c?a:b;return 0<=d&&d<=this.plotWidth&&0<=a&&a<=this.plotHeight},redraw:function(b){f(this,\"beforeRedraw\");var c=this.axes,d=this.series,h=this.pointer,m=this.legend,e=this.isDirtyLegend,g,A,q=this.hasCartesianSeries,p=this.isDirtyBox,E,v=this.renderer,n=v.isHidden(),l=[];this.setResponsive&&this.setResponsive(!1);a.setAnimation(b,this);n&&this.temporaryDisplay();this.layOutTitles();for(b=d.length;b--;)if(E=d[b],E.options.stacking&&(g=!0,E.isDirty)){A=!0;\r\nbreak}if(A)for(b=d.length;b--;)E=d[b],E.options.stacking&&(E.isDirty=!0);k(d,function(a){a.isDirty&&\"point\"===a.options.legendType&&(a.updateTotals&&a.updateTotals(),e=!0);a.isDirtyData&&f(a,\"updatedData\")});e&&m.options.enabled&&(m.render(),this.isDirtyLegend=!1);g&&this.getStacks();q&&k(c,function(a){a.updateNames();a.setScale()});this.getMargins();q&&(k(c,function(a){a.isDirty&&(p=!0)}),k(c,function(a){var b=a.min+\",\"+a.max;a.extKey!==b&&(a.extKey=b,l.push(function(){f(a,\"afterSetExtremes\",x(a.eventArgs,\r\na.getExtremes()));delete a.eventArgs}));(p||g)&&a.redraw()}));p&&this.drawChartBox();f(this,\"predraw\");k(d,function(a){(p||a.isDirty)&&a.visible&&a.redraw();a.isDirtyData=!1});h&&h.reset(!0);v.draw();f(this,\"redraw\");f(this,\"render\");n&&this.temporaryDisplay(!0);k(l,function(a){a.call()})},get:function(a){function b(b){return b.id===a||b.options&&b.options.id===a}var c,d=this.series,f;c=p(this.axes,b)||p(this.series,b);for(f=0;!c&&f<d.length;f++)c=p(d[f].points||[],b);return c},getAxes:function(){var a=\r\nthis,b=this.options,c=b.xAxis=h(b.xAxis||{}),b=b.yAxis=h(b.yAxis||{});f(this,\"getAxes\");k(c,function(a,b){a.index=b;a.isX=!0});k(b,function(a,b){a.index=b});c=c.concat(b);k(c,function(b){new e(a,b)});f(this,\"afterGetAxes\")},getSelectedPoints:function(){var a=[];k(this.series,function(c){a=a.concat(b(c.data||[],function(a){return a.selected}))});return a},getSelectedSeries:function(){return b(this.series,function(a){return a.selected})},setTitle:function(a,b,c){var d=this,f=d.options,h;h=f.title=B({style:{color:\"#333333\",\r\nfontSize:f.isStock?\"16px\":\"18px\"}},f.title,a);f=f.subtitle=B({style:{color:\"#666666\"}},f.subtitle,b);k([[\"title\",a,h],[\"subtitle\",b,f]],function(a,b){var c=a[0],f=d[c],h=a[1];a=a[2];f&&h&&(d[c]=f=f.destroy());a&&!f&&(d[c]=d.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,\"class\":\"highcharts-\"+c,zIndex:a.zIndex||4}).add(),d[c].update=function(a){d.setTitle(!b&&a,b&&a)},d[c].css(a.style))});d.layOutTitles(c)},layOutTitles:function(a){var b=0,c,d=this.renderer,f=this.spacingBox;k([\"title\",\"subtitle\"],\r\nfunction(a){var c=this[a],h=this.options[a];a=\"title\"===a?-3:h.verticalAlign?0:b+2;var m;c&&(m=h.style.fontSize,m=d.fontMetrics(m,c).b,c.css({width:(h.width||f.width+h.widthAdjust)+\"px\"}).align(x({y:a+m},h),!1,\"spacingBox\"),h.floating||h.verticalAlign||(b=Math.ceil(b+c.getBBox(h.useHTML).height)))},this);c=this.titleOffset!==b;this.titleOffset=b;!this.isDirtyBox&&c&&(this.isDirtyBox=this.isDirtyLegend=c,this.hasRendered&&E(a,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var b=this.options.chart,\r\nc=b.width,b=b.height,f=this.renderTo;d(c)||(this.containerWidth=a.getStyle(f,\"width\"));d(b)||(this.containerHeight=a.getStyle(f,\"height\"));this.chartWidth=Math.max(0,c||this.containerWidth||600);this.chartHeight=Math.max(0,a.relativeLength(b,this.chartWidth)||(1<this.containerHeight?this.containerHeight:400))},temporaryDisplay:function(b){var c=this.renderTo;if(b)for(;c&&c.style;)c.hcOrigStyle&&(a.css(c,c.hcOrigStyle),delete c.hcOrigStyle),c.hcOrigDetached&&(g.body.removeChild(c),c.hcOrigDetached=\r\n!1),c=c.parentNode;else for(;c&&c.style;){g.body.contains(c)||c.parentNode||(c.hcOrigDetached=!0,g.body.appendChild(c));if(\"none\"===a.getStyle(c,\"display\",!1)||c.hcOricDetached)c.hcOrigStyle={display:c.style.display,height:c.style.height,overflow:c.style.overflow},b={display:\"block\",overflow:\"hidden\"},c!==this.renderTo&&(b.height=0),a.css(c,b),c.offsetWidth||c.style.setProperty(\"display\",\"block\",\"important\");c=c.parentNode;if(c===g.body)break}},setClassName:function(a){this.container.className=\"highcharts-container \"+\r\n(a||\"\")},getContainer:function(){var b,c=this.options,d=c.chart,h,m;b=this.renderTo;var e=a.uniqueKey(),k;b||(this.renderTo=b=d.renderTo);J(b)&&(this.renderTo=b=g.getElementById(b));b||a.error(13,!0);h=A(r(b,\"data-highcharts-chart\"));n(h)&&u[h]&&u[h].hasRendered&&u[h].destroy();r(b,\"data-highcharts-chart\",this.index);b.innerHTML=\"\";d.skipClone||b.offsetWidth||this.temporaryDisplay();this.getChartSize();h=this.chartWidth;m=this.chartHeight;k=x({position:\"relative\",overflow:\"hidden\",width:h+\"px\",height:m+\r\n\"px\",textAlign:\"left\",lineHeight:\"normal\",zIndex:0,\"-webkit-tap-highlight-color\":\"rgba(0,0,0,0)\"},d.style);this.container=b=t(\"div\",{id:e},k,b);this._cursor=b.style.cursor;this.renderer=new (a[d.renderer]||a.Renderer)(b,h,m,null,d.forExport,c.exporting&&c.exporting.allowHTML);this.setClassName(d.className);this.renderer.setStyle(d.style);this.renderer.chartIndex=this.index;f(this,\"afterGetContainer\")},getMargins:function(a){var b=this.spacing,c=this.margin,f=this.titleOffset;this.resetMargins();f&&\r\n!d(c[0])&&(this.plotTop=Math.max(this.plotTop,f+this.options.title.margin+b[0]));this.legend&&this.legend.display&&this.legend.adjustMargins(c,b);this.extraMargin&&(this[this.extraMargin.type]=(this[this.extraMargin.type]||0)+this.extraMargin.value);this.adjustPlotArea&&this.adjustPlotArea();a||this.getAxisMargins()},getAxisMargins:function(){var a=this,b=a.axisOffset=[0,0,0,0],c=a.margin;a.hasCartesianSeries&&k(a.axes,function(a){a.visible&&a.getOffset()});k(L,function(f,h){d(c[h])||(a[f]+=b[h])});\r\na.setChartSize()},reflow:function(b){var c=this,f=c.options.chart,h=c.renderTo,m=d(f.width)&&d(f.height),e=f.width||a.getStyle(h,\"width\"),f=f.height||a.getStyle(h,\"height\"),h=b?b.target:Q;if(!m&&!c.isPrinting&&e&&f&&(h===Q||h===g)){if(e!==c.containerWidth||f!==c.containerHeight)a.clearTimeout(c.reflowTimeout),c.reflowTimeout=v(function(){c.container&&c.setSize(void 0,void 0,!1)},b?100:0);c.containerWidth=e;c.containerHeight=f}},setReflow:function(a){var b=this;!1===a||this.unbindReflow?!1===a&&this.unbindReflow&&\r\n(this.unbindReflow=this.unbindReflow()):(this.unbindReflow=C(Q,\"resize\",function(a){b.reflow(a)}),C(this,\"destroy\",this.unbindReflow))},setSize:function(b,d,h){var m=this,e=m.renderer;m.isResizing+=1;a.setAnimation(h,m);m.oldChartHeight=m.chartHeight;m.oldChartWidth=m.chartWidth;void 0!==b&&(m.options.chart.width=b);void 0!==d&&(m.options.chart.height=d);m.getChartSize();b=e.globalAnimation;(b?F:c)(m.container,{width:m.chartWidth+\"px\",height:m.chartHeight+\"px\"},b);m.setChartSize(!0);e.setSize(m.chartWidth,\r\nm.chartHeight,h);k(m.axes,function(a){a.isDirty=!0;a.setScale()});m.isDirtyLegend=!0;m.isDirtyBox=!0;m.layOutTitles();m.getMargins();m.redraw(h);m.oldChartHeight=null;f(m,\"resize\");v(function(){m&&f(m,\"endResize\",null,function(){--m.isResizing})},D(b).duration)},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,h=this.chartHeight,m=this.options.chart,e=this.spacing,g=this.clipOffset,A,q,p,E;this.plotLeft=A=Math.round(this.plotLeft);this.plotTop=q=Math.round(this.plotTop);\r\nthis.plotWidth=p=Math.max(0,Math.round(d-A-this.marginRight));this.plotHeight=E=Math.max(0,Math.round(h-q-this.marginBottom));this.plotSizeX=b?E:p;this.plotSizeY=b?p:E;this.plotBorderWidth=m.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:e[3],y:e[0],width:d-e[3]-e[1],height:h-e[0]-e[2]};this.plotBox=c.plotBox={x:A,y:q,width:p,height:E};d=2*Math.floor(this.plotBorderWidth/2);b=Math.ceil(Math.max(d,g[3])/2);c=Math.ceil(Math.max(d,g[0])/2);this.clipBox={x:b,y:c,width:Math.floor(this.plotSizeX-Math.max(d,\r\ng[1])/2-b),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(d,g[2])/2-c))};a||k(this.axes,function(a){a.setAxisSize();a.setAxisTranslation()});f(this,\"afterSetChartSize\",{skipAxes:a})},resetMargins:function(){var a=this,b=a.options.chart;k([\"margin\",\"spacing\"],function(c){var d=b[c],f=z(d)?d:[d,d,d,d];k([\"Top\",\"Right\",\"Bottom\",\"Left\"],function(d,h){a[c][h]=E(b[c+d],f[h])})});k(L,function(b,c){a[b]=E(a.margin[c],a.spacing[c])});a.axisOffset=[0,0,0,0];a.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=\r\nthis.options.chart,b=this.renderer,c=this.chartWidth,d=this.chartHeight,h=this.chartBackground,m=this.plotBackground,e=this.plotBorder,g,A=this.plotBGImage,k=a.backgroundColor,q=a.plotBackgroundColor,p=a.plotBackgroundImage,E,v=this.plotLeft,n=this.plotTop,l=this.plotWidth,G=this.plotHeight,B=this.plotBox,x=this.clipRect,t=this.clipBox,r=\"animate\";h||(this.chartBackground=h=b.rect().addClass(\"highcharts-background\").add(),r=\"attr\");g=a.borderWidth||0;E=g+(a.shadow?8:0);k={fill:k||\"none\"};if(g||h[\"stroke-width\"])k.stroke=\r\na.borderColor,k[\"stroke-width\"]=g;h.attr(k).shadow(a.shadow);h[r]({x:E/2,y:E/2,width:c-E-g%2,height:d-E-g%2,r:a.borderRadius});r=\"animate\";m||(r=\"attr\",this.plotBackground=m=b.rect().addClass(\"highcharts-plot-background\").add());m[r](B);m.attr({fill:q||\"none\"}).shadow(a.plotShadow);p&&(A?A.animate(B):this.plotBGImage=b.image(p,v,n,l,G).add());x?x.animate({width:t.width,height:t.height}):this.clipRect=b.clipRect(t);r=\"animate\";e||(r=\"attr\",this.plotBorder=e=b.rect().addClass(\"highcharts-plot-border\").attr({zIndex:1}).add());\r\ne.attr({stroke:a.plotBorderColor,\"stroke-width\":a.plotBorderWidth||0,fill:\"none\"});e[r](e.crisp({x:v,y:n,width:l,height:G},-e.strokeWidth()));this.isDirtyBox=!1;f(this,\"afterDrawChartBox\")},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,f,h;k([\"inverted\",\"angular\",\"polar\"],function(m){c=G[b.type||b.defaultSeriesType];h=b[m]||c&&c.prototype[m];for(f=d&&d.length;!h&&f--;)(c=G[d[f].type])&&c.prototype[m]&&(h=!0);a[m]=h})},linkSeries:function(){var a=this,b=a.series;k(b,function(a){a.linkedSeries.length=\r\n0});k(b,function(b){var c=b.options.linkedTo;J(c)&&(c=\":previous\"===c?a.series[b.index-1]:a.get(c))&&c.linkedParent!==b&&(c.linkedSeries.push(b),b.linkedParent=c,b.visible=E(b.options.visible,c.options.visible,b.visible))});f(this,\"afterLinkSeries\")},renderSeries:function(){k(this.series,function(a){a.translate();a.render()})},renderLabels:function(){var a=this,b=a.options.labels;b.items&&k(b.items,function(c){var d=x(b.style,c.style),f=A(d.left)+a.plotLeft,h=A(d.top)+a.plotTop+12;delete d.left;delete d.top;\r\na.renderer.text(c.html,f,h).attr({zIndex:2}).css(d).add()})},render:function(){var a=this.axes,b=this.renderer,c=this.options,d,f,h;this.setTitle();this.legend=new q(this,c.legend);this.getStacks&&this.getStacks();this.getMargins(!0);this.setChartSize();c=this.plotWidth;d=this.plotHeight=Math.max(this.plotHeight-21,0);k(a,function(a){a.setScale()});this.getAxisMargins();f=1.1<c/this.plotWidth;h=1.05<d/this.plotHeight;if(f||h)k(a,function(a){(a.horiz&&f||!a.horiz&&h)&&a.setTickInterval(!0)}),this.getMargins();\r\nthis.drawChartBox();this.hasCartesianSeries&&k(a,function(a){a.visible&&a.render()});this.seriesGroup||(this.seriesGroup=b.g(\"series-group\").attr({zIndex:3}).add());this.renderSeries();this.renderLabels();this.addCredits();this.setResponsive&&this.setResponsive();this.hasRendered=!0},addCredits:function(a){var b=this;a=B(!0,this.options.credits,a);a.enabled&&!this.credits&&(this.credits=this.renderer.text(a.text+(this.mapCredits||\"\"),0,0).addClass(\"highcharts-credits\").on(\"click\",function(){a.href&&\r\n(Q.location.href=a.href)}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position),this.credits.update=function(a){b.credits=b.credits.destroy();b.addCredits(a)})},destroy:function(){var b=this,c=b.axes,d=b.series,h=b.container,m,e=h&&h.parentNode;f(b,\"destroy\");b.renderer.forExport?a.erase(u,b):u[b.index]=void 0;a.chartCount--;b.renderTo.removeAttribute(\"data-highcharts-chart\");M(b);for(m=c.length;m--;)c[m]=c[m].destroy();this.scroller&&this.scroller.destroy&&this.scroller.destroy();\r\nfor(m=d.length;m--;)d[m]=d[m].destroy();k(\"title subtitle chartBackground plotBackground plotBGImage plotBorder seriesGroup clipRect credits pointer rangeSelector legend resetZoomButton tooltip renderer\".split(\" \"),function(a){var c=b[a];c&&c.destroy&&(b[a]=c.destroy())});h&&(h.innerHTML=\"\",M(h),e&&l(h));H(b,function(a,c){delete b[c]})},firstRender:function(){var a=this,b=a.options;if(!a.isReadyToRender||a.isReadyToRender()){a.getContainer();a.resetMargins();a.setChartSize();a.propFromSeries();a.getAxes();\r\nk(b.series||[],function(b){a.initSeries(b)});a.linkSeries();f(a,\"beforeRender\");m&&(a.pointer=new m(a,b));a.render();if(!a.renderer.imgCount&&a.onload)a.onload();a.temporaryDisplay(!0)}},onload:function(){k([this.callback].concat(this.callbacks),function(a){a&&void 0!==this.index&&a.apply(this,[this])},this);f(this,\"load\");f(this,\"render\");d(this.index)&&this.setReflow(this.options.chart.reflow);this.onload=null}})})(K);(function(a){var C=a.addEvent,F=a.Chart,D=a.each;C(F,\"afterSetChartSize\",function(r){var g=\r\nthis.options.chart.scrollablePlotArea;if(g=g&&g.minWidth)if(this.scrollablePixels=g=Math.max(0,g-this.chartWidth))this.plotWidth+=g,this.clipBox.width+=g,r.skipAxes||D(this.axes,function(e){1===e.side?e.getPlotLinePath=function(){var g=this.right,r;this.right=g-e.chart.scrollablePixels;r=a.Axis.prototype.getPlotLinePath.apply(this,arguments);this.right=g;return r}:(e.setAxisSize(),e.setAxisTranslation())})});C(F,\"render\",function(){this.scrollablePixels?(this.setUpScrolling&&this.setUpScrolling(),\r\nthis.applyFixed()):this.fixedDiv&&this.applyFixed()});F.prototype.setUpScrolling=function(){this.scrollingContainer=a.createElement(\"div\",{className:\"highcharts-scrolling\"},{overflowX:\"auto\",WebkitOverflowScrolling:\"touch\"},this.renderTo);this.innerContainer=a.createElement(\"div\",{className:\"highcharts-inner-container\"},null,this.scrollingContainer);this.innerContainer.appendChild(this.container);this.setUpScrolling=null};F.prototype.applyFixed=function(){var r=this.container,g,e;this.fixedDiv||(this.fixedDiv=\r\na.createElement(\"div\",{className:\"highcharts-fixed\"},{position:\"absolute\",overflow:\"hidden\",pointerEvents:\"none\",zIndex:2},null,!0),this.renderTo.insertBefore(this.fixedDiv,this.renderTo.firstChild),this.fixedRenderer=g=new a.Renderer(this.fixedDiv,0,0),this.scrollableMask=g.path().attr({fill:a.color(this.options.chart.backgroundColor||\"#fff\").setOpacity(.85).get(),zIndex:-1}).addClass(\"highcharts-scrollable-mask\").add(),a.each([this.inverted?\".highcharts-xaxis\":\".highcharts-yaxis\",this.inverted?\r\n\".highcharts-xaxis-labels\":\".highcharts-yaxis-labels\",\".highcharts-contextbutton\",\".highcharts-credits\",\".highcharts-legend\",\".highcharts-subtitle\",\".highcharts-title\"],function(e){a.each(r.querySelectorAll(e),function(a){g.box.appendChild(a);a.style.pointerEvents=\"auto\"})}));this.fixedRenderer.setSize(this.chartWidth,this.chartHeight);e=this.chartWidth+this.scrollablePixels;this.container.style.width=e+\"px\";this.renderer.boxWrapper.attr({width:e,height:this.chartHeight,viewBox:[0,0,e,this.chartHeight].join(\" \")});\r\ne=this.options.chart.scrollablePlotArea;e.scrollPositionX&&(this.scrollingContainer.scrollLeft=this.scrollablePixels*e.scrollPositionX);var t=this.axisOffset;e=this.plotTop-t[0]-1;var t=this.plotTop+this.plotHeight+t[2],w=this.plotLeft+this.plotWidth-this.scrollablePixels;this.scrollableMask.attr({d:this.scrollablePixels?[\"M\",0,e,\"L\",this.plotLeft-1,e,\"L\",this.plotLeft-1,t,\"L\",0,t,\"Z\",\"M\",w,e,\"L\",this.chartWidth,e,\"L\",this.chartWidth,t,\"L\",w,t,\"Z\"]:[\"M\",0,0]})}})(K);(function(a){var C,F=a.each,D=\r\na.extend,r=a.erase,g=a.fireEvent,e=a.format,t=a.isArray,w=a.isNumber,l=a.pick,u=a.removeEvent;a.Point=C=function(){};a.Point.prototype={init:function(a,d,e){this.series=a;this.color=a.color;this.applyOptions(d,e);a.options.colorByPoint?(d=a.options.colors||a.chart.options.colors,this.color=this.color||d[a.colorCounter],d=d.length,e=a.colorCounter,a.colorCounter++,a.colorCounter===d&&(a.colorCounter=0)):e=a.colorIndex;this.colorIndex=l(this.colorIndex,e);a.chart.pointCount++;g(this,\"afterInit\");return this},\r\napplyOptions:function(a,d){var c=this.series,e=c.options.pointValKey||c.pointValKey;a=C.prototype.optionsToObject.call(this,a);D(this,a);this.options=this.options?D(this.options,a):a;a.group&&delete this.group;e&&(this.y=this[e]);this.isNull=l(this.isValid&&!this.isValid(),null===this.x||!w(this.y,!0));this.selected&&(this.state=\"select\");\"name\"in this&&void 0===d&&c.xAxis&&c.xAxis.hasNames&&(this.x=c.xAxis.nameToX(this));void 0===this.x&&c&&(this.x=void 0===d?c.autoIncrement(this):d);return this},\r\nsetNestedProperty:function(c,d,e){e=e.split(\".\");a.reduce(e,function(c,e,f,b){c[e]=b.length-1===f?d:a.isObject(c[e],!0)?c[e]:{};return c[e]},c);return c},optionsToObject:function(c){var d={},e=this.series,g=e.options.keys,p=g||e.pointArrayMap||[\"y\"],f=p.length,b=0,n=0;if(w(c)||null===c)d[p[0]]=c;else if(t(c))for(!g&&c.length>f&&(e=typeof c[0],\"string\"===e?d.name=c[0]:\"number\"===e&&(d.x=c[0]),b++);n<f;)g&&void 0===c[b]||(0<p[n].indexOf(\".\")?a.Point.prototype.setNestedProperty(d,c[b],p[n]):d[p[n]]=\r\nc[b]),b++,n++;else\"object\"===typeof c&&(d=c,c.dataLabels&&(e._hasPointLabels=!0),c.marker&&(e._hasPointMarkers=!0));return d},getClassName:function(){return\"highcharts-point\"+(this.selected?\" highcharts-point-select\":\"\")+(this.negative?\" highcharts-negative\":\"\")+(this.isNull?\" highcharts-null-point\":\"\")+(void 0!==this.colorIndex?\" highcharts-color-\"+this.colorIndex:\"\")+(this.options.className?\" \"+this.options.className:\"\")+(this.zone&&this.zone.className?\" \"+this.zone.className.replace(\"highcharts-negative\",\r\n\"\"):\"\")},getZone:function(){var a=this.series,d=a.zones,a=a.zoneAxis||\"y\",e=0,g;for(g=d[e];this[a]>=g.value;)g=d[++e];this.nonZonedColor||(this.nonZonedColor=this.color);this.color=g&&g.color&&!this.options.color?g.color:this.nonZonedColor;return g},destroy:function(){var a=this.series.chart,d=a.hoverPoints,e;a.pointCount--;d&&(this.setState(),r(d,this),d.length||(a.hoverPoints=null));if(this===a.hoverPoint)this.onMouseOut();if(this.graphic||this.dataLabel)u(this),this.destroyElements();this.legendItem&&\r\na.legend.destroyItem(this);for(e in this)this[e]=null},destroyElements:function(){for(var a=[\"graphic\",\"dataLabel\",\"dataLabelUpper\",\"connector\",\"shadowGroup\"],d,e=6;e--;)d=a[e],this[d]&&(this[d]=this[d].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(a){var c=this.series,g=c.tooltipOptions,\r\nt=l(g.valueDecimals,\"\"),p=g.valuePrefix||\"\",f=g.valueSuffix||\"\";F(c.pointArrayMap||[\"y\"],function(b){b=\"{point.\"+b;if(p||f)a=a.replace(RegExp(b+\"}\",\"g\"),p+b+\"}\"+f);a=a.replace(RegExp(b+\"}\",\"g\"),b+\":,.\"+t+\"f}\")});return e(a,{point:this,series:this.series},c.chart.time)},firePointEvent:function(a,d,e){var c=this,k=this.series.options;(k.point.events[a]||c.options&&c.options.events&&c.options.events[a])&&this.importEvents();\"click\"===a&&k.allowPointSelect&&(e=function(a){c.select&&c.select(null,a.ctrlKey||\r\na.metaKey||a.shiftKey)});g(this,a,d,e)},visible:!0}})(K);(function(a){var C=a.addEvent,F=a.animObject,D=a.arrayMax,r=a.arrayMin,g=a.correctFloat,e=a.defaultOptions,t=a.defaultPlotOptions,w=a.defined,l=a.each,u=a.erase,c=a.extend,d=a.fireEvent,k=a.grep,x=a.isArray,p=a.isNumber,f=a.isString,b=a.merge,n=a.objectEach,z=a.pick,J=a.removeEvent,q=a.splat,L=a.SVGElement,B=a.syncTimeout,H=a.win;a.Series=a.seriesType(\"line\",null,{lineWidth:2,allowPointSelect:!1,showCheckbox:!1,animation:{duration:1E3},events:{},\r\nmarker:{lineWidth:0,lineColor:\"#ffffff\",enabledThreshold:2,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:50},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:\"#cccccc\",lineColor:\"#000000\",lineWidth:2}}},point:{events:{}},dataLabels:{align:\"center\",formatter:function(){return null===this.y?\"\":a.numberFormat(this.y,-1)},style:{fontSize:\"11px\",fontWeight:\"bold\",color:\"contrast\",textOutline:\"1px contrast\"},verticalAlign:\"bottom\",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,\r\nsoftThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:50},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1E3,findNearestPointBy:\"x\"},{isCartesian:!0,pointClass:a.Point,sorted:!0,requireSorting:!0,directTouch:!1,axisTypes:[\"xAxis\",\"yAxis\"],colorCounter:0,parallelArrays:[\"x\",\"y\"],coll:\"series\",init:function(a,b){var f=this,e,m=a.series,h;f.chart=a;f.options=b=f.setOptions(b);f.linkedSeries=[];f.bindAxes();c(f,{name:b.name,\r\nstate:\"\",visible:!1!==b.visible,selected:!0===b.selected});e=b.events;n(e,function(a,b){C(f,b,a)});if(e&&e.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect)a.runTrackerClick=!0;f.getColor();f.getSymbol();l(f.parallelArrays,function(a){f[a+\"Data\"]=[]});f.setData(b.data,!1);f.isCartesian&&(a.hasCartesianSeries=!0);m.length&&(h=m[m.length-1]);f._i=z(h&&h._i,-1)+1;a.orderSeries(this.insert(m));d(this,\"afterInit\")},insert:function(a){var b=this.options.index,c;if(p(b)){for(c=a.length;c--;)if(b>=\r\nz(a[c].options.index,a[c]._i)){a.splice(c+1,0,this);break}-1===c&&a.unshift(this);c+=1}else a.push(this);return z(c,a.length-1)},bindAxes:function(){var b=this,c=b.options,d=b.chart,f;l(b.axisTypes||[],function(e){l(d[e],function(a){f=a.options;if(c[e]===f.index||void 0!==c[e]&&c[e]===f.id||void 0===c[e]&&0===f.index)b.insert(a.series),b[e]=a,a.isDirty=!0});b[e]||b.optionalAxis===e||a.error(18,!0)})},updateParallelArrays:function(a,b){var c=a.series,d=arguments,f=p(b)?function(d){var f=\"y\"===d&&c.toYData?\r\nc.toYData(a):a[d];c[d+\"Data\"][b]=f}:function(a){Array.prototype[b].apply(c[a+\"Data\"],Array.prototype.slice.call(d,2))};l(c.parallelArrays,f)},autoIncrement:function(){var a=this.options,b=this.xIncrement,c,d=a.pointIntervalUnit,f=this.chart.time,b=z(b,a.pointStart,0);this.pointInterval=c=z(this.pointInterval,a.pointInterval,1);d&&(a=new f.Date(b),\"day\"===d?f.set(\"Date\",a,f.get(\"Date\",a)+c):\"month\"===d?f.set(\"Month\",a,f.get(\"Month\",a)+c):\"year\"===d&&f.set(\"FullYear\",a,f.get(\"FullYear\",a)+c),c=a.getTime()-\r\nb);this.xIncrement=b+c;return b},setOptions:function(a){var c=this.chart,f=c.options,m=f.plotOptions,g=(c.userOptions||{}).plotOptions||{},h=m[this.type];this.userOptions=a;c=b(h,m.series,a);this.tooltipOptions=b(e.tooltip,e.plotOptions.series&&e.plotOptions.series.tooltip,e.plotOptions[this.type].tooltip,f.tooltip.userOptions,m.series&&m.series.tooltip,m[this.type].tooltip,a.tooltip);this.stickyTracking=z(a.stickyTracking,g[this.type]&&g[this.type].stickyTracking,g.series&&g.series.stickyTracking,\r\nthis.tooltipOptions.shared&&!this.noSharedTooltip?!0:c.stickyTracking);null===h.marker&&delete c.marker;this.zoneAxis=c.zoneAxis;a=this.zones=(c.zones||[]).slice();!c.negativeColor&&!c.negativeFillColor||c.zones||a.push({value:c[this.zoneAxis+\"Threshold\"]||c.threshold||0,className:\"highcharts-negative\",color:c.negativeColor,fillColor:c.negativeFillColor});a.length&&w(a[a.length-1].value)&&a.push({color:this.color,fillColor:this.fillColor});d(this,\"afterSetOptions\",{options:c});return c},getName:function(){return this.name||\r\n\"Series \"+(this.index+1)},getCyclic:function(a,b,c){var d,f=this.chart,h=this.userOptions,e=a+\"Index\",m=a+\"Counter\",g=c?c.length:z(f.options.chart[a+\"Count\"],f[a+\"Count\"]);b||(d=z(h[e],h[\"_\"+e]),w(d)||(f.series.length||(f[m]=0),h[\"_\"+e]=d=f[m]%g,f[m]+=1),c&&(b=c[d]));void 0!==d&&(this[e]=d);this[a]=b},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic(\"color\",this.options.color||t[this.type].color,this.chart.options.colors)},getSymbol:function(){this.getCyclic(\"symbol\",\r\nthis.options.marker.symbol,this.chart.options.symbols)},drawLegendSymbol:a.LegendSymbolMixin.drawLineMarker,updateData:function(b){var c=this.options,d=this.points,f=[],e,h,m,g=this.requireSorting;l(b,function(b){var h;h=a.defined(b)&&this.pointClass.prototype.optionsToObject.call({series:this},b).x;p(h)&&(h=a.inArray(h,this.xData,m),-1===h?f.push(b):b!==c.data[h]?(d[h].update(b,!1,null,!1),d[h].touched=!0,g&&(m=h)):d[h]&&(d[h].touched=!0),e=!0)},this);if(e)for(b=d.length;b--;)h=d[b],h.touched||h.remove(!1),\r\nh.touched=!1;else if(b.length===d.length)l(b,function(a,b){d[b].update&&a!==c.data[b]&&d[b].update(a,!1,null,!1)});else return!1;l(f,function(a){this.addPoint(a,!1)},this);return!0},setData:function(b,c,d,e){var m=this,h=m.points,g=h&&h.length||0,q,k=m.options,A=m.chart,n=null,E=m.xAxis,B=k.turboThreshold,t=this.xData,r=this.yData,u=(q=m.pointArrayMap)&&q.length,H;b=b||[];q=b.length;c=z(c,!0);!1!==e&&q&&g&&!m.cropped&&!m.hasGroupedData&&m.visible&&(H=this.updateData(b));if(!H){m.xIncrement=null;m.colorCounter=\r\n0;l(this.parallelArrays,function(a){m[a+\"Data\"].length=0});if(B&&q>B){for(d=0;null===n&&d<q;)n=b[d],d++;if(p(n))for(d=0;d<q;d++)t[d]=this.autoIncrement(),r[d]=b[d];else if(x(n))if(u)for(d=0;d<q;d++)n=b[d],t[d]=n[0],r[d]=n.slice(1,u+1);else for(d=0;d<q;d++)n=b[d],t[d]=n[0],r[d]=n[1];else a.error(12)}else for(d=0;d<q;d++)void 0!==b[d]&&(n={series:m},m.pointClass.prototype.applyOptions.apply(n,[b[d]]),m.updateParallelArrays(n,d));r&&f(r[0])&&a.error(14,!0);m.data=[];m.options.data=m.userOptions.data=\r\nb;for(d=g;d--;)h[d]&&h[d].destroy&&h[d].destroy();E&&(E.minRange=E.userMinRange);m.isDirty=A.isDirtyBox=!0;m.isDirtyData=!!h;d=!1}\"point\"===k.legendType&&(this.processData(),this.generatePoints());c&&A.redraw(d)},processData:function(b){var c=this.xData,d=this.yData,f=c.length,e;e=0;var h,m,g=this.xAxis,q,k=this.options;q=k.cropThreshold;var p=this.getExtremesFromAll||k.getExtremesFromAll,n=this.isCartesian,k=g&&g.val2lin,l=g&&g.isLog,B=this.requireSorting,t,r;if(n&&!this.isDirty&&!g.isDirty&&!this.yAxis.isDirty&&\r\n!b)return!1;g&&(b=g.getExtremes(),t=b.min,r=b.max);if(n&&this.sorted&&!p&&(!q||f>q||this.forceCrop))if(c[f-1]<t||c[0]>r)c=[],d=[];else if(c[0]<t||c[f-1]>r)e=this.cropData(this.xData,this.yData,t,r),c=e.xData,d=e.yData,e=e.start,h=!0;for(q=c.length||1;--q;)f=l?k(c[q])-k(c[q-1]):c[q]-c[q-1],0<f&&(void 0===m||f<m)?m=f:0>f&&B&&(a.error(15),B=!1);this.cropped=h;this.cropStart=e;this.processedXData=c;this.processedYData=d;this.closestPointRange=m},cropData:function(a,b,c,d,f){var h=a.length,e=0,m=h,g;f=\r\nz(f,this.cropShoulder,1);for(g=0;g<h;g++)if(a[g]>=c){e=Math.max(0,g-f);break}for(c=g;c<h;c++)if(a[c]>d){m=c+f;break}return{xData:a.slice(e,m),yData:b.slice(e,m),start:e,end:m}},generatePoints:function(){var a=this.options,b=a.data,c=this.data,d,f=this.processedXData,h=this.processedYData,e=this.pointClass,g=f.length,k=this.cropStart||0,p,n=this.hasGroupedData,a=a.keys,l,B=[],t;c||n||(c=[],c.length=b.length,c=this.data=c);a&&n&&(this.options.keys=!1);for(t=0;t<g;t++)p=k+t,n?(l=(new e).init(this,[f[t]].concat(q(h[t]))),\r\nl.dataGroup=this.groupMap[t]):(l=c[p])||void 0===b[p]||(c[p]=l=(new e).init(this,b[p],f[t])),l&&(l.index=p,B[t]=l);this.options.keys=a;if(c&&(g!==(d=c.length)||n))for(t=0;t<d;t++)t!==k||n||(t+=g),c[t]&&(c[t].destroyElements(),c[t].plotX=void 0);this.data=c;this.points=B},getExtremes:function(a){var b=this.yAxis,c=this.processedXData,d,f=[],h=0;d=this.xAxis.getExtremes();var e=d.min,m=d.max,g,q,k=this.requireSorting?1:0,n,l;a=a||this.stackedYData||this.processedYData||[];d=a.length;for(l=0;l<d;l++)if(q=\r\nc[l],n=a[l],g=(p(n,!0)||x(n))&&(!b.positiveValuesOnly||n.length||0<n),q=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(c[l+k]||q)>=e&&(c[l-k]||q)<=m,g&&q)if(g=n.length)for(;g--;)\"number\"===typeof n[g]&&(f[h++]=n[g]);else f[h++]=n;this.dataMin=r(f);this.dataMax=D(f)},translate:function(){this.processedXData||this.processData();this.generatePoints();var a=this.options,b=a.stacking,c=this.xAxis,f=c.categories,e=this.yAxis,h=this.points,q=h.length,k=!!this.modifyValue,n=a.pointPlacement,\r\nl=\"between\"===n||p(n),t=a.threshold,B=a.startFromThreshold?t:0,r,x,u,H,J=Number.MAX_VALUE;\"between\"===n&&(n=.5);p(n)&&(n*=z(a.pointRange||c.pointRange));for(a=0;a<q;a++){var L=h[a],C=L.x,D=L.y;x=L.low;var F=b&&e.stacks[(this.negStacks&&D<(B?0:t)?\"-\":\"\")+this.stackKey],K;e.positiveValuesOnly&&null!==D&&0>=D&&(L.isNull=!0);L.plotX=r=g(Math.min(Math.max(-1E5,c.translate(C,0,0,0,1,n,\"flags\"===this.type)),1E5));b&&this.visible&&!L.isNull&&F&&F[C]&&(H=this.getStackIndicator(H,C,this.index),K=F[C],D=K.points[H.key],\r\nx=D[0],D=D[1],x===B&&H.key===F[C].base&&(x=z(p(t)&&t,e.min)),e.positiveValuesOnly&&0>=x&&(x=null),L.total=L.stackTotal=K.total,L.percentage=K.total&&L.y/K.total*100,L.stackY=D,K.setOffset(this.pointXOffset||0,this.barW||0));L.yBottom=w(x)?Math.min(Math.max(-1E5,e.translate(x,0,1,0,1)),1E5):null;k&&(D=this.modifyValue(D,L));L.plotY=x=\"number\"===typeof D&&Infinity!==D?Math.min(Math.max(-1E5,e.translate(D,0,1,0,1)),1E5):void 0;L.isInside=void 0!==x&&0<=x&&x<=e.len&&0<=r&&r<=c.len;L.clientX=l?g(c.translate(C,\r\n0,0,0,1,n)):r;L.negative=L.y<(t||0);L.category=f&&void 0!==f[L.x]?f[L.x]:L.x;L.isNull||(void 0!==u&&(J=Math.min(J,Math.abs(r-u))),u=r);L.zone=this.zones.length&&L.getZone()}this.closestPointRangePx=J;d(this,\"afterTranslate\")},getValidPoints:function(a,b){var c=this.chart;return k(a||this.points||[],function(a){return b&&!c.isInsidePlot(a.plotX,a.plotY,c.inverted)?!1:!a.isNull})},setClip:function(a){var b=this.chart,c=this.options,d=b.renderer,f=b.inverted,h=this.clipBox,e=h||b.clipBox,m=this.sharedClipKey||\r\n[\"_sharedClip\",a&&a.duration,a&&a.easing,e.height,c.xAxis,c.yAxis].join(),g=b[m],q=b[m+\"m\"];g||(a&&(e.width=0,f&&(e.x=b.plotSizeX),b[m+\"m\"]=q=d.clipRect(f?b.plotSizeX+99:-99,f?-b.plotLeft:-b.plotTop,99,f?b.chartWidth:b.chartHeight)),b[m]=g=d.clipRect(e),g.count={length:0});a&&!g.count[this.index]&&(g.count[this.index]=!0,g.count.length+=1);!1!==c.clip&&(this.group.clip(a||h?g:b.clipRect),this.markerGroup.clip(q),this.sharedClipKey=m);a||(g.count[this.index]&&(delete g.count[this.index],--g.count.length),\r\n0===g.count.length&&m&&b[m]&&(h||(b[m]=b[m].destroy()),b[m+\"m\"]&&(b[m+\"m\"]=b[m+\"m\"].destroy())))},animate:function(a){var b=this.chart,c=F(this.options.animation),d;a?this.setClip(c):(d=this.sharedClipKey,(a=b[d])&&a.animate({width:b.plotSizeX,x:0},c),b[d+\"m\"]&&b[d+\"m\"].animate({width:b.plotSizeX+99,x:0},c),this.animate=null)},afterAnimate:function(){this.setClip();d(this,\"afterAnimate\");this.finishedAnimating=!0},drawPoints:function(){var a=this.points,b=this.chart,c,d,f,h,e=this.options.marker,\r\ng,q,k,p=this[this.specialGroup]||this.markerGroup,n,l=z(e.enabled,this.xAxis.isRadial?!0:null,this.closestPointRangePx>=e.enabledThreshold*e.radius);if(!1!==e.enabled||this._hasPointMarkers)for(c=0;c<a.length;c++)d=a[c],h=d.graphic,g=d.marker||{},q=!!d.marker,f=l&&void 0===g.enabled||g.enabled,k=d.isInside,f&&!d.isNull?(f=z(g.symbol,this.symbol),n=this.markerAttribs(d,d.selected&&\"select\"),h?h[k?\"show\":\"hide\"](!0).animate(n):k&&(0<n.width||d.hasImage)&&(d.graphic=h=b.renderer.symbol(f,n.x,n.y,n.width,\r\nn.height,q?g:e).add(p)),h&&h.attr(this.pointAttribs(d,d.selected&&\"select\")),h&&h.addClass(d.getClassName(),!0)):h&&(d.graphic=h.destroy())},markerAttribs:function(a,b){var c=this.options.marker,d=a.marker||{},f=d.symbol||c.symbol,h=z(d.radius,c.radius);b&&(c=c.states[b],b=d.states&&d.states[b],h=z(b&&b.radius,c&&c.radius,h+(c&&c.radiusPlus||0)));a.hasImage=f&&0===f.indexOf(\"url\");a.hasImage&&(h=0);a={x:Math.floor(a.plotX)-h,y:a.plotY-h};h&&(a.width=a.height=2*h);return a},pointAttribs:function(a,\r\nb){var c=this.options.marker,d=a&&a.options,f=d&&d.marker||{},h=this.color,e=d&&d.color,g=a&&a.color,d=z(f.lineWidth,c.lineWidth);a=a&&a.zone&&a.zone.color;h=e||a||g||h;a=f.fillColor||c.fillColor||h;h=f.lineColor||c.lineColor||h;b&&(c=c.states[b],b=f.states&&f.states[b]||{},d=z(b.lineWidth,c.lineWidth,d+z(b.lineWidthPlus,c.lineWidthPlus,0)),a=b.fillColor||c.fillColor||a,h=b.lineColor||c.lineColor||h);return{stroke:h,\"stroke-width\":d,fill:a}},destroy:function(){var b=this,c=b.chart,f=/AppleWebKit\\/533/.test(H.navigator.userAgent),\r\ne,g,h=b.data||[],q,k;d(b,\"destroy\");J(b);l(b.axisTypes||[],function(a){(k=b[a])&&k.series&&(u(k.series,b),k.isDirty=k.forceRedraw=!0)});b.legendItem&&b.chart.legend.destroyItem(b);for(g=h.length;g--;)(q=h[g])&&q.destroy&&q.destroy();b.points=null;a.clearTimeout(b.animationTimeout);n(b,function(a,b){a instanceof L&&!a.survive&&(e=f&&\"group\"===b?\"hide\":\"destroy\",a[e]())});c.hoverSeries===b&&(c.hoverSeries=null);u(c.series,b);c.orderSeries();n(b,function(a,c){delete b[c]})},getGraphPath:function(a,b,\r\nc){var d=this,f=d.options,h=f.step,e,g=[],m=[],q;a=a||d.points;(e=a.reversed)&&a.reverse();(h={right:1,center:2}[h]||h&&3)&&e&&(h=4-h);!f.connectNulls||b||c||(a=this.getValidPoints(a));l(a,function(e,k){var n=e.plotX,p=e.plotY,l=a[k-1];(e.leftCliff||l&&l.rightCliff)&&!c&&(q=!0);e.isNull&&!w(b)&&0<k?q=!f.connectNulls:e.isNull&&!b?q=!0:(0===k||q?k=[\"M\",e.plotX,e.plotY]:d.getPointSpline?k=d.getPointSpline(a,e,k):h?(k=1===h?[\"L\",l.plotX,p]:2===h?[\"L\",(l.plotX+n)/2,l.plotY,\"L\",(l.plotX+n)/2,p]:[\"L\",n,\r\nl.plotY],k.push(\"L\",n,p)):k=[\"L\",n,p],m.push(e.x),h&&(m.push(e.x),2===h&&m.push(e.x)),g.push.apply(g,k),q=!1)});g.xMap=m;return d.graphPath=g},drawGraph:function(){var a=this,b=this.options,c=(this.gappedPath||this.getGraphPath).call(this),d=[[\"graph\",\"highcharts-graph\",b.lineColor||this.color,b.dashStyle]],d=a.getZonesGraphs(d);l(d,function(d,f){var e=d[0],h=a[e];h?(h.endX=a.preventGraphAnimation?null:c.xMap,h.animate({d:c})):c.length&&(a[e]=a.chart.renderer.path(c).addClass(d[1]).attr({zIndex:1}).add(a.group),\r\nh={stroke:d[2],\"stroke-width\":b.lineWidth,fill:a.fillGraph&&a.color||\"none\"},d[3]?h.dashstyle=d[3]:\"square\"!==b.linecap&&(h[\"stroke-linecap\"]=h[\"stroke-linejoin\"]=\"round\"),h=a[e].attr(h).shadow(2>f&&b.shadow));h&&(h.startX=c.xMap,h.isArea=c.isArea)})},getZonesGraphs:function(a){l(this.zones,function(b,c){a.push([\"zone-graph-\"+c,\"highcharts-graph highcharts-zone-graph-\"+c+\" \"+(b.className||\"\"),b.color||this.color,b.dashStyle||this.options.dashStyle])},this);return a},applyZones:function(){var a=this,\r\nb=this.chart,c=b.renderer,d=this.zones,f,e,g=this.clips||[],q,k=this.graph,n=this.area,p=Math.max(b.chartWidth,b.chartHeight),t=this[(this.zoneAxis||\"y\")+\"Axis\"],B,r,x=b.inverted,u,H,w,L,J=!1;d.length&&(k||n)&&t&&void 0!==t.min&&(r=t.reversed,u=t.horiz,k&&!this.showLine&&k.hide(),n&&n.hide(),B=t.getExtremes(),l(d,function(d,h){f=r?u?b.plotWidth:0:u?0:t.toPixels(B.min);f=Math.min(Math.max(z(e,f),0),p);e=Math.min(Math.max(Math.round(t.toPixels(z(d.value,B.max),!0)),0),p);J&&(f=e=t.toPixels(B.max));\r\nH=Math.abs(f-e);w=Math.min(f,e);L=Math.max(f,e);t.isXAxis?(q={x:x?L:w,y:0,width:H,height:p},u||(q.x=b.plotHeight-q.x)):(q={x:0,y:x?L:w,width:p,height:H},u&&(q.y=b.plotWidth-q.y));x&&c.isVML&&(q=t.isXAxis?{x:0,y:r?w:L,height:q.width,width:b.chartWidth}:{x:q.y-b.plotLeft-b.spacingBox.x,y:0,width:q.height,height:b.chartHeight});g[h]?g[h].animate(q):(g[h]=c.clipRect(q),k&&a[\"zone-graph-\"+h].clip(g[h]),n&&a[\"zone-area-\"+h].clip(g[h]));J=d.value>B.max;a.resetZones&&0===e&&(e=void 0)}),this.clips=g)},invertGroups:function(a){function b(){l([\"group\",\r\n\"markerGroup\"],function(b){c[b]&&(d.renderer.isVML&&c[b].attr({width:c.yAxis.len,height:c.xAxis.len}),c[b].width=c.yAxis.len,c[b].height=c.xAxis.len,c[b].invert(a))})}var c=this,d=c.chart,f;c.xAxis&&(f=C(d,\"resize\",b),C(c,\"destroy\",f),b(a),c.invertGroups=b)},plotGroup:function(a,b,c,d,f){var e=this[a],g=!e;g&&(this[a]=e=this.chart.renderer.g().attr({zIndex:d||.1}).add(f));e.addClass(\"highcharts-\"+b+\" highcharts-series-\"+this.index+\" highcharts-\"+this.type+\"-series \"+(w(this.colorIndex)?\"highcharts-color-\"+\r\nthis.colorIndex+\" \":\"\")+(this.options.className||\"\")+(e.hasClass(\"highcharts-tracker\")?\" highcharts-tracker\":\"\"),!0);e.attr({visibility:c})[g?\"attr\":\"animate\"](this.getPlotBox());return e},getPlotBox:function(){var a=this.chart,b=this.xAxis,c=this.yAxis;a.inverted&&(b=c,c=this.xAxis);return{translateX:b?b.left:a.plotLeft,translateY:c?c.top:a.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this,b=a.chart,c,f=a.options,e=!!a.animate&&b.renderer.isSVG&&F(f.animation).duration,h=a.visible?\"inherit\":\r\n\"hidden\",g=f.zIndex,q=a.hasRendered,k=b.seriesGroup,n=b.inverted;c=a.plotGroup(\"group\",\"series\",h,g,k);a.markerGroup=a.plotGroup(\"markerGroup\",\"markers\",h,g,k);e&&a.animate(!0);c.inverted=a.isCartesian?n:!1;a.drawGraph&&(a.drawGraph(),a.applyZones());a.drawDataLabels&&a.drawDataLabels();a.visible&&a.drawPoints();a.drawTracker&&!1!==a.options.enableMouseTracking&&a.drawTracker();a.invertGroups(n);!1===f.clip||a.sharedClipKey||q||c.clip(b.clipRect);e&&a.animate();q||(a.animationTimeout=B(function(){a.afterAnimate()},\r\ne));a.isDirty=!1;a.hasRendered=!0;d(a,\"afterRender\")},redraw:function(){var a=this.chart,b=this.isDirty||this.isDirtyData,c=this.group,d=this.xAxis,f=this.yAxis;c&&(a.inverted&&c.attr({width:a.plotWidth,height:a.plotHeight}),c.animate({translateX:z(d&&d.left,a.plotLeft),translateY:z(f&&f.top,a.plotTop)}));this.translate();this.render();b&&delete this.kdTree},kdAxisArray:[\"clientX\",\"plotY\"],searchPoint:function(a,b){var c=this.xAxis,d=this.yAxis,f=this.chart.inverted;return this.searchKDTree({clientX:f?\r\nc.len-a.chartY+c.pos:a.chartX-c.pos,plotY:f?d.len-a.chartX+d.pos:a.chartY-d.pos},b)},buildKDTree:function(){function a(c,d,f){var e,h;if(h=c&&c.length)return e=b.kdAxisArray[d%f],c.sort(function(a,b){return a[e]-b[e]}),h=Math.floor(h/2),{point:c[h],left:a(c.slice(0,h),d+1,f),right:a(c.slice(h+1),d+1,f)}}this.buildingKdTree=!0;var b=this,c=-1<b.options.findNearestPointBy.indexOf(\"y\")?2:1;delete b.kdTree;B(function(){b.kdTree=a(b.getValidPoints(null,!b.directTouch),c,c);b.buildingKdTree=!1},b.options.kdNow?\r\n0:1)},searchKDTree:function(a,b){function c(a,b,h,m){var q=b.point,k=d.kdAxisArray[h%m],n,p,l=q;p=w(a[f])&&w(q[f])?Math.pow(a[f]-q[f],2):null;n=w(a[e])&&w(q[e])?Math.pow(a[e]-q[e],2):null;n=(p||0)+(n||0);q.dist=w(n)?Math.sqrt(n):Number.MAX_VALUE;q.distX=w(p)?Math.sqrt(p):Number.MAX_VALUE;k=a[k]-q[k];n=0>k?\"left\":\"right\";p=0>k?\"right\":\"left\";b[n]&&(n=c(a,b[n],h+1,m),l=n[g]<l[g]?n:q);b[p]&&Math.sqrt(k*k)<l[g]&&(a=c(a,b[p],h+1,m),l=a[g]<l[g]?a:l);return l}var d=this,f=this.kdAxisArray[0],e=this.kdAxisArray[1],\r\ng=b?\"distX\":\"dist\";b=-1<d.options.findNearestPointBy.indexOf(\"y\")?2:1;this.kdTree||this.buildingKdTree||this.buildKDTree();if(this.kdTree)return c(a,this.kdTree,b,b)}})})(K);(function(a){var C=a.Axis,F=a.Chart,D=a.correctFloat,r=a.defined,g=a.destroyObjectProperties,e=a.each,t=a.format,w=a.objectEach,l=a.pick,u=a.Series;a.StackItem=function(a,d,e,g,p){var c=a.chart.inverted;this.axis=a;this.isNegative=e;this.options=d;this.x=g;this.total=null;this.points={};this.stack=p;this.rightCliff=this.leftCliff=\r\n0;this.alignOptions={align:d.align||(c?e?\"left\":\"right\":\"center\"),verticalAlign:d.verticalAlign||(c?\"middle\":e?\"bottom\":\"top\"),y:l(d.y,c?4:e?14:-6),x:l(d.x,c?e?-6:6:0)};this.textAlign=d.textAlign||(c?e?\"right\":\"left\":\"center\")};a.StackItem.prototype={destroy:function(){g(this,this.axis)},render:function(a){var c=this.axis.chart,e=this.options,g=e.format,g=g?t(g,this,c.time):e.formatter.call(this);this.label?this.label.attr({text:g,visibility:\"hidden\"}):this.label=c.renderer.text(g,null,null,e.useHTML).css(e.style).attr({align:this.textAlign,\r\nrotation:e.rotation,visibility:\"hidden\"}).add(a)},setOffset:function(a,d){var c=this.axis,e=c.chart,g=c.translate(c.usePercentage?100:this.total,0,0,0,1),f=c.translate(0),f=Math.abs(g-f);a=e.xAxis[0].translate(this.x)+a;c=this.getStackBox(e,this,a,g,d,f,c);if(d=this.label)d.align(this.alignOptions,null,c),c=d.alignAttr,d[!1===this.options.crop||e.isInsidePlot(c.x,c.y)?\"show\":\"hide\"](!0)},getStackBox:function(a,d,e,g,p,f,b){var c=d.axis.reversed,k=a.inverted;a=b.height+b.pos-a.plotTop;d=d.isNegative&&\r\n!c||!d.isNegative&&c;return{x:k?d?g:g-f:e,y:k?a-e-p:d?a-g-f:a-g,width:k?f:p,height:k?p:f}}};F.prototype.getStacks=function(){var a=this;e(a.yAxis,function(a){a.stacks&&a.hasVisibleSeries&&(a.oldStacks=a.stacks)});e(a.series,function(c){!c.options.stacking||!0!==c.visible&&!1!==a.options.chart.ignoreHiddenSeries||(c.stackKey=c.type+l(c.options.stack,\"\"))})};C.prototype.buildStacks=function(){var a=this.series,d=l(this.options.reversedStacks,!0),e=a.length,g;if(!this.isXAxis){this.usePercentage=!1;\r\nfor(g=e;g--;)a[d?g:e-g-1].setStackedPoints();for(g=0;g<e;g++)a[g].modifyStacks()}};C.prototype.renderStackTotals=function(){var a=this.chart,d=a.renderer,e=this.stacks,g=this.stackTotalGroup;g||(this.stackTotalGroup=g=d.g(\"stack-labels\").attr({visibility:\"visible\",zIndex:6}).add());g.translate(a.plotLeft,a.plotTop);w(e,function(a){w(a,function(a){a.render(g)})})};C.prototype.resetStacks=function(){var a=this,d=a.stacks;a.isXAxis||w(d,function(c){w(c,function(d,e){d.touched<a.stacksTouched?(d.destroy(),\r\ndelete c[e]):(d.total=null,d.cumulative=null)})})};C.prototype.cleanStacks=function(){var a;this.isXAxis||(this.oldStacks&&(a=this.stacks=this.oldStacks),w(a,function(a){w(a,function(a){a.cumulative=a.total})}))};u.prototype.setStackedPoints=function(){if(this.options.stacking&&(!0===this.visible||!1===this.chart.options.chart.ignoreHiddenSeries)){var c=this.processedXData,d=this.processedYData,e=[],g=d.length,p=this.options,f=p.threshold,b=l(p.startFromThreshold&&f,0),n=p.stack,p=p.stacking,t=this.stackKey,\r\nu=\"-\"+t,q=this.negStacks,w=this.yAxis,B=w.stacks,H=w.oldStacks,m,E,A,M,G,h,v;w.stacksTouched+=1;for(G=0;G<g;G++)h=c[G],v=d[G],m=this.getStackIndicator(m,h,this.index),M=m.key,A=(E=q&&v<(b?0:f))?u:t,B[A]||(B[A]={}),B[A][h]||(H[A]&&H[A][h]?(B[A][h]=H[A][h],B[A][h].total=null):B[A][h]=new a.StackItem(w,w.options.stackLabels,E,h,n)),A=B[A][h],null!==v?(A.points[M]=A.points[this.index]=[l(A.cumulative,b)],r(A.cumulative)||(A.base=M),A.touched=w.stacksTouched,0<m.index&&!1===this.singleStacks&&(A.points[M][0]=\r\nA.points[this.index+\",\"+h+\",0\"][0])):A.points[M]=A.points[this.index]=null,\"percent\"===p?(E=E?t:u,q&&B[E]&&B[E][h]?(E=B[E][h],A.total=E.total=Math.max(E.total,A.total)+Math.abs(v)||0):A.total=D(A.total+(Math.abs(v)||0))):A.total=D(A.total+(v||0)),A.cumulative=l(A.cumulative,b)+(v||0),null!==v&&(A.points[M].push(A.cumulative),e[G]=A.cumulative);\"percent\"===p&&(w.usePercentage=!0);this.stackedYData=e;w.oldStacks={}}};u.prototype.modifyStacks=function(){var a=this,d=a.stackKey,g=a.yAxis.stacks,l=a.processedXData,\r\np,f=a.options.stacking;a[f+\"Stacker\"]&&e([d,\"-\"+d],function(b){for(var c=l.length,d,e;c--;)if(d=l[c],p=a.getStackIndicator(p,d,a.index,b),e=(d=g[b]&&g[b][d])&&d.points[p.key])a[f+\"Stacker\"](e,d,c)})};u.prototype.percentStacker=function(a,d,e){d=d.total?100/d.total:0;a[0]=D(a[0]*d);a[1]=D(a[1]*d);this.stackedYData[e]=a[1]};u.prototype.getStackIndicator=function(a,d,e,g){!r(a)||a.x!==d||g&&a.key!==g?a={x:d,index:0,key:g}:a.index++;a.key=[e,d,a.index].join();return a}})(K);(function(a){var C=a.addEvent,\r\nF=a.animate,D=a.Axis,r=a.createElement,g=a.css,e=a.defined,t=a.each,w=a.erase,l=a.extend,u=a.fireEvent,c=a.inArray,d=a.isNumber,k=a.isObject,x=a.isArray,p=a.merge,f=a.objectEach,b=a.pick,n=a.Point,z=a.Series,J=a.seriesTypes,q=a.setAnimation,L=a.splat;l(a.Chart.prototype,{addSeries:function(a,c,d){var f,e=this;a&&(c=b(c,!0),u(e,\"addSeries\",{options:a},function(){f=e.initSeries(a);e.isDirtyLegend=!0;e.linkSeries();u(e,\"afterAddSeries\");c&&e.redraw(d)}));return f},addAxis:function(a,c,d,f){var e=c?\"xAxis\":\r\n\"yAxis\",g=this.options;a=p(a,{index:this[e].length,isX:c});c=new D(this,a);g[e]=L(g[e]||{});g[e].push(a);b(d,!0)&&this.redraw(f);return c},showLoading:function(a){var b=this,c=b.options,d=b.loadingDiv,f=c.loading,e=function(){d&&g(d,{left:b.plotLeft+\"px\",top:b.plotTop+\"px\",width:b.plotWidth+\"px\",height:b.plotHeight+\"px\"})};d||(b.loadingDiv=d=r(\"div\",{className:\"highcharts-loading highcharts-loading-hidden\"},null,b.container),b.loadingSpan=r(\"span\",{className:\"highcharts-loading-inner\"},null,d),C(b,\r\n\"redraw\",e));d.className=\"highcharts-loading\";b.loadingSpan.innerHTML=a||c.lang.loading;g(d,l(f.style,{zIndex:10}));g(b.loadingSpan,f.labelStyle);b.loadingShown||(g(d,{opacity:0,display:\"\"}),F(d,{opacity:f.style.opacity||.5},{duration:f.showDuration||0}));b.loadingShown=!0;e()},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&(b.className=\"highcharts-loading highcharts-loading-hidden\",F(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){g(b,{display:\"none\"})}}));\r\nthis.loadingShown=!1},propsRequireDirtyBox:\"backgroundColor borderColor borderWidth margin marginTop marginRight marginBottom marginLeft spacing spacingTop spacingRight spacingBottom spacingLeft borderRadius plotBackgroundColor plotBackgroundImage plotBorderColor plotBorderWidth plotShadow shadow\".split(\" \"),propsRequireUpdateSeries:\"chart.inverted chart.polar chart.ignoreHiddenSeries chart.type colors plotOptions time tooltip\".split(\" \"),update:function(a,g,m,q){var k=this,n={credits:\"addCredits\",\r\ntitle:\"setTitle\",subtitle:\"setSubtitle\"},l=a.chart,h,v,r=[];u(k,\"update\",{options:a});if(l){p(!0,k.options.chart,l);\"className\"in l&&k.setClassName(l.className);\"reflow\"in l&&k.setReflow(l.reflow);if(\"inverted\"in l||\"polar\"in l)k.propFromSeries(),h=!0;\"alignTicks\"in l&&(h=!0);f(l,function(a,b){-1!==c(\"chart.\"+b,k.propsRequireUpdateSeries)&&(v=!0);-1!==c(b,k.propsRequireDirtyBox)&&(k.isDirtyBox=!0)});\"style\"in l&&k.renderer.setStyle(l.style)}a.colors&&(this.options.colors=a.colors);a.plotOptions&&\r\np(!0,this.options.plotOptions,a.plotOptions);f(a,function(a,b){if(k[b]&&\"function\"===typeof k[b].update)k[b].update(a,!1);else if(\"function\"===typeof k[n[b]])k[n[b]](a);\"chart\"!==b&&-1!==c(b,k.propsRequireUpdateSeries)&&(v=!0)});t(\"xAxis yAxis zAxis series colorAxis pane\".split(\" \"),function(b){a[b]&&(t(L(a[b]),function(a,c){(c=e(a.id)&&k.get(a.id)||k[b][c])&&c.coll===b&&(c.update(a,!1),m&&(c.touched=!0));if(!c&&m)if(\"series\"===b)k.addSeries(a,!1).touched=!0;else if(\"xAxis\"===b||\"yAxis\"===b)k.addAxis(a,\r\n\"xAxis\"===b,!1).touched=!0}),m&&t(k[b],function(a){a.touched?delete a.touched:r.push(a)}))});t(r,function(a){a.remove(!1)});h&&t(k.axes,function(a){a.update({},!1)});v&&t(k.series,function(a){a.update({},!1)});a.loading&&p(!0,k.options.loading,a.loading);h=l&&l.width;l=l&&l.height;d(h)&&h!==k.chartWidth||d(l)&&l!==k.chartHeight?k.setSize(h,l,q):b(g,!0)&&k.redraw(q)},setSubtitle:function(a){this.setTitle(void 0,a)}});l(n.prototype,{update:function(a,c,d,f){function e(){g.applyOptions(a);null===g.y&&\r\nh&&(g.graphic=h.destroy());k(a,!0)&&(h&&h.element&&a&&a.marker&&void 0!==a.marker.symbol&&(g.graphic=h.destroy()),a&&a.dataLabels&&g.dataLabel&&(g.dataLabel=g.dataLabel.destroy()),g.connector&&(g.connector=g.connector.destroy()));m=g.index;q.updateParallelArrays(g,m);p.data[m]=k(p.data[m],!0)||k(a,!0)?g.options:b(a,p.data[m]);q.isDirty=q.isDirtyData=!0;!q.fixedBox&&q.hasCartesianSeries&&(n.isDirtyBox=!0);\"point\"===p.legendType&&(n.isDirtyLegend=!0);c&&n.redraw(d)}var g=this,q=g.series,h=g.graphic,\r\nm,n=q.chart,p=q.options;c=b(c,!0);!1===f?e():g.firePointEvent(\"update\",{options:a},e)},remove:function(a,b){this.series.removePoint(c(this,this.series.data),a,b)}});l(z.prototype,{addPoint:function(a,c,d,f){var e=this.options,g=this.data,q=this.chart,h=this.xAxis,h=h&&h.hasNames&&h.names,m=e.data,k,n,p=this.xData,l,t;c=b(c,!0);k={series:this};this.pointClass.prototype.applyOptions.apply(k,[a]);t=k.x;l=p.length;if(this.requireSorting&&t<p[l-1])for(n=!0;l&&p[l-1]>t;)l--;this.updateParallelArrays(k,\r\n\"splice\",l,0,0);this.updateParallelArrays(k,l);h&&k.name&&(h[t]=k.name);m.splice(l,0,a);n&&(this.data.splice(l,0,null),this.processData());\"point\"===e.legendType&&this.generatePoints();d&&(g[0]&&g[0].remove?g[0].remove(!1):(g.shift(),this.updateParallelArrays(k,\"shift\"),m.shift()));this.isDirtyData=this.isDirty=!0;c&&q.redraw(f)},removePoint:function(a,c,d){var f=this,e=f.data,g=e[a],m=f.points,h=f.chart,k=function(){m&&m.length===e.length&&m.splice(a,1);e.splice(a,1);f.options.data.splice(a,1);f.updateParallelArrays(g||\r\n{series:f},\"splice\",a,1);g&&g.destroy();f.isDirty=!0;f.isDirtyData=!0;c&&h.redraw()};q(d,h);c=b(c,!0);g?g.firePointEvent(\"remove\",null,k):k()},remove:function(a,c,d){function f(){e.destroy();g.isDirtyLegend=g.isDirtyBox=!0;g.linkSeries();b(a,!0)&&g.redraw(c)}var e=this,g=e.chart;!1!==d?u(e,\"remove\",null,f):f()},update:function(d,f){var e=this,g=e.chart,q=e.userOptions,k=e.oldType||e.type,n=d.type||q.type||g.options.chart.type,h=J[k].prototype,r,B=[\"group\",\"markerGroup\",\"dataLabelsGroup\"],x=[\"navigatorSeries\",\r\n\"baseSeries\"],z=e.finishedAnimating&&{animation:!1},w=[\"data\",\"name\",\"turboThreshold\"],H=a.keys(d),y=0<H.length;t(H,function(a){-1===c(a,w)&&(y=!1)});if(y)d.data&&this.setData(d.data,!1),d.name&&this.setName(d.name,!1);else{x=B.concat(x);t(x,function(a){x[a]=e[a];delete e[a]});d=p(q,z,{index:e.index,pointStart:b(q.pointStart,e.xData[0])},{data:e.options.data},d);e.remove(!1,null,!1);for(r in h)e[r]=void 0;J[n||k]?l(e,J[n||k].prototype):a.error(17,!0);t(x,function(a){e[a]=x[a]});e.init(g,d);d.zIndex!==\r\nq.zIndex&&t(B,function(a){e[a]&&e[a].attr({zIndex:d.zIndex})});e.oldType=k;g.linkSeries()}u(this,\"afterUpdate\");b(f,!0)&&g.redraw(!1)},setName:function(a){this.name=this.options.name=this.userOptions.name=a;this.chart.isDirtyLegend=!0}});l(D.prototype,{update:function(a,c){var d=this.chart;a=p(this.userOptions,a);d.options[this.coll].indexOf&&(d.options[this.coll][d.options[this.coll].indexOf(this.userOptions)]=a);this.destroy(!0);this.init(d,l(a,{events:void 0}));d.isDirtyBox=!0;b(c,!0)&&d.redraw()},\r\nremove:function(a){for(var c=this.chart,d=this.coll,f=this.series,e=f.length;e--;)f[e]&&f[e].remove(!1);w(c.axes,this);w(c[d],this);x(c.options[d])?c.options[d].splice(this.options.index,1):delete c.options[d];t(c[d],function(a,b){a.options.index=a.userOptions.index=b});this.destroy();c.isDirtyBox=!0;b(a,!0)&&c.redraw()},setTitle:function(a,b){this.update({title:a},b)},setCategories:function(a,b){this.update({categories:a},b)}})})(K);(function(a){var C=a.color,F=a.each,D=a.map,r=a.pick,g=a.Series,\r\ne=a.seriesType;e(\"area\",\"line\",{softThreshold:!1,threshold:0},{singleStacks:!1,getStackPoints:function(e){var g=[],l=[],t=this.xAxis,c=this.yAxis,d=c.stacks[this.stackKey],k={},x=this.index,p=c.series,f=p.length,b,n=r(c.options.reversedStacks,!0)?1:-1,z;e=e||this.points;if(this.options.stacking){for(z=0;z<e.length;z++)e[z].leftNull=e[z].rightNull=null,k[e[z].x]=e[z];a.objectEach(d,function(a,b){null!==a.total&&l.push(b)});l.sort(function(a,b){return a-b});b=D(p,function(){return this.visible});F(l,\r\nfunction(a,e){var q=0,p,r;if(k[a]&&!k[a].isNull)g.push(k[a]),F([-1,1],function(c){var g=1===c?\"rightNull\":\"leftNull\",q=0,m=d[l[e+c]];if(m)for(z=x;0<=z&&z<f;)p=m.points[z],p||(z===x?k[a][g]=!0:b[z]&&(r=d[a].points[z])&&(q-=r[1]-r[0])),z+=n;k[a][1===c?\"rightCliff\":\"leftCliff\"]=q});else{for(z=x;0<=z&&z<f;){if(p=d[a].points[z]){q=p[1];break}z+=n}q=c.translate(q,0,1,0,1);g.push({isNull:!0,plotX:t.translate(a,0,0,0,1),x:a,plotY:q,yBottom:q})}})}return g},getGraphPath:function(a){var e=g.prototype.getGraphPath,\r\nl=this.options,t=l.stacking,c=this.yAxis,d,k,x=[],p=[],f=this.index,b,n=c.stacks[this.stackKey],z=l.threshold,J=c.getThreshold(l.threshold),q,l=l.connectNulls||\"percent\"===t,L=function(d,e,g){var q=a[d];d=t&&n[q.x].points[f];var k=q[g+\"Null\"]||0;g=q[g+\"Cliff\"]||0;var m,l,q=!0;g||k?(m=(k?d[0]:d[1])+g,l=d[0]+g,q=!!k):!t&&a[e]&&a[e].isNull&&(m=l=z);void 0!==m&&(p.push({plotX:b,plotY:null===m?J:c.getThreshold(m),isNull:q,isCliff:!0}),x.push({plotX:b,plotY:null===l?J:c.getThreshold(l),doCurve:!1}))};a=\r\na||this.points;t&&(a=this.getStackPoints(a));for(d=0;d<a.length;d++)if(k=a[d].isNull,b=r(a[d].rectPlotX,a[d].plotX),q=r(a[d].yBottom,J),!k||l)l||L(d,d-1,\"left\"),k&&!t&&l||(p.push(a[d]),x.push({x:d,plotX:b,plotY:q})),l||L(d,d+1,\"right\");d=e.call(this,p,!0,!0);x.reversed=!0;k=e.call(this,x,!0,!0);k.length&&(k[0]=\"L\");k=d.concat(k);e=e.call(this,p,!1,l);k.xMap=d.xMap;this.areaPath=k;return e},drawGraph:function(){this.areaPath=[];g.prototype.drawGraph.apply(this);var a=this,e=this.areaPath,l=this.options,\r\nu=[[\"area\",\"highcharts-area\",this.color,l.fillColor]];F(this.zones,function(c,d){u.push([\"zone-area-\"+d,\"highcharts-area highcharts-zone-area-\"+d+\" \"+c.className,c.color||a.color,c.fillColor||l.fillColor])});F(u,function(c){var d=c[0],g=a[d];g?(g.endX=a.preventGraphAnimation?null:e.xMap,g.animate({d:e})):(g=a[d]=a.chart.renderer.path(e).addClass(c[1]).attr({fill:r(c[3],C(c[2]).setOpacity(r(l.fillOpacity,.75)).get()),zIndex:0}).add(a.group),g.isArea=!0);g.startX=e.xMap;g.shiftUnit=l.step?2:1})},drawLegendSymbol:a.LegendSymbolMixin.drawRectangle})})(K);\r\n(function(a){var C=a.pick;a=a.seriesType;a(\"spline\",\"line\",{},{getPointSpline:function(a,D,r){var g=D.plotX,e=D.plotY,t=a[r-1];r=a[r+1];var w,l,u,c;if(t&&!t.isNull&&!1!==t.doCurve&&!D.isCliff&&r&&!r.isNull&&!1!==r.doCurve&&!D.isCliff){a=t.plotY;u=r.plotX;r=r.plotY;var d=0;w=(1.5*g+t.plotX)/2.5;l=(1.5*e+a)/2.5;u=(1.5*g+u)/2.5;c=(1.5*e+r)/2.5;u!==w&&(d=(c-l)*(u-g)/(u-w)+e-c);l+=d;c+=d;l>a&&l>e?(l=Math.max(a,e),c=2*e-l):l<a&&l<e&&(l=Math.min(a,e),c=2*e-l);c>r&&c>e?(c=Math.max(r,e),l=2*e-c):c<r&&c<e&&\r\n(c=Math.min(r,e),l=2*e-c);D.rightContX=u;D.rightContY=c}D=[\"C\",C(t.rightContX,t.plotX),C(t.rightContY,t.plotY),C(w,g),C(l,e),g,e];t.rightContX=t.rightContY=null;return D}})})(K);(function(a){var C=a.seriesTypes.area.prototype,F=a.seriesType;F(\"areaspline\",\"spline\",a.defaultPlotOptions.area,{getStackPoints:C.getStackPoints,getGraphPath:C.getGraphPath,drawGraph:C.drawGraph,drawLegendSymbol:a.LegendSymbolMixin.drawRectangle})})(K);(function(a){var C=a.animObject,F=a.color,D=a.each,r=a.extend,g=a.isNumber,\r\ne=a.merge,t=a.pick,w=a.Series,l=a.seriesType,u=a.svg;l(\"column\",\"line\",{borderRadius:0,crisp:!0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:\"#cccccc\",borderColor:\"#000000\"}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:\"#ffffff\"},{cropShoulder:0,directTouch:!0,trackerGroups:[\"group\",\"dataLabelsGroup\"],\r\nnegStacks:!0,init:function(){w.prototype.init.apply(this,arguments);var a=this,d=a.chart;d.hasRendered&&D(d.series,function(c){c.type===a.type&&(c.isDirty=!0)})},getColumnMetrics:function(){var a=this,d=a.options,e=a.xAxis,g=a.yAxis,p=e.reversed,f,b={},n=0;!1===d.grouping?n=1:D(a.chart.series,function(c){var d=c.options,e=c.yAxis,q;c.type!==a.type||!c.visible&&a.chart.options.chart.ignoreHiddenSeries||g.len!==e.len||g.pos!==e.pos||(d.stacking?(f=c.stackKey,void 0===b[f]&&(b[f]=n++),q=b[f]):!1!==d.grouping&&\r\n(q=n++),c.columnIndex=q)});var l=Math.min(Math.abs(e.transA)*(e.ordinalSlope||d.pointRange||e.closestPointRange||e.tickInterval||1),e.len),r=l*d.groupPadding,q=(l-2*r)/(n||1),d=Math.min(d.maxPointWidth||e.len,t(d.pointWidth,q*(1-2*d.pointPadding)));a.columnMetrics={width:d,offset:(q-d)/2+(r+((a.columnIndex||0)+(p?1:0))*q-l/2)*(p?-1:1)};return a.columnMetrics},crispCol:function(a,d,e,g){var c=this.chart,f=this.borderWidth,b=-(f%2?.5:0),f=f%2?.5:1;c.inverted&&c.renderer.isVML&&(f+=1);this.options.crisp&&\r\n(e=Math.round(a+e)+b,a=Math.round(a)+b,e-=a);g=Math.round(d+g)+f;b=.5>=Math.abs(d)&&.5<g;d=Math.round(d)+f;g-=d;b&&g&&(--d,g+=1);return{x:a,y:d,width:e,height:g}},translate:function(){var a=this,d=a.chart,e=a.options,g=a.dense=2>a.closestPointRange*a.xAxis.transA,g=a.borderWidth=t(e.borderWidth,g?0:1),p=a.yAxis,f=e.threshold,b=a.translatedThreshold=p.getThreshold(f),n=t(e.minPointLength,5),l=a.getColumnMetrics(),r=l.width,q=a.barW=Math.max(r,1+2*g),u=a.pointXOffset=l.offset;d.inverted&&(b-=.5);e.pointPadding&&\r\n(q=Math.ceil(q));w.prototype.translate.apply(a);D(a.points,function(c){var e=t(c.yBottom,b),g=999+Math.abs(e),g=Math.min(Math.max(-g,c.plotY),p.len+g),k=c.plotX+u,l=q,x=Math.min(g,e),B,h=Math.max(g,e)-x;n&&Math.abs(h)<n&&(h=n,B=!p.reversed&&!c.negative||p.reversed&&c.negative,c.y===f&&a.dataMax<=f&&p.min<f&&(B=!B),x=Math.abs(x-b)>n?e-n:b-(B?n:0));c.barX=k;c.pointWidth=r;c.tooltipPos=d.inverted?[p.len+p.pos-d.plotLeft-g,a.xAxis.len-k-l/2,h]:[k+l/2,g+p.pos-d.plotTop,h];c.shapeType=\"rect\";c.shapeArgs=\r\na.crispCol.apply(a,c.isNull?[k,b,l,0]:[k,x,l,h])})},getSymbol:a.noop,drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,drawGraph:function(){this.group[this.dense?\"addClass\":\"removeClass\"](\"highcharts-dense-data\")},pointAttribs:function(a,d){var c=this.options,g,p=this.pointAttrToOptions||{};g=p.stroke||\"borderColor\";var f=p[\"stroke-width\"]||\"borderWidth\",b=a&&a.color||this.color,n=a&&a[g]||c[g]||this.color||b,l=a&&a[f]||c[f]||this[f]||0,p=c.dashStyle;a&&this.zones.length&&(b=a.getZone(),b=a.options.color||\r\nb&&b.color||this.color);d&&(a=e(c.states[d],a.options.states&&a.options.states[d]||{}),d=a.brightness,b=a.color||void 0!==d&&F(b).brighten(a.brightness).get()||b,n=a[g]||n,l=a[f]||l,p=a.dashStyle||p);g={fill:b,stroke:n,\"stroke-width\":l};p&&(g.dashstyle=p);return g},drawPoints:function(){var a=this,d=this.chart,k=a.options,l=d.renderer,p=k.animationLimit||250,f;D(a.points,function(b){var c=b.graphic,t=c&&d.pointCount<p?\"animate\":\"attr\";if(g(b.plotY)&&null!==b.y){f=b.shapeArgs;if(c)c[t](e(f));else b.graphic=\r\nc=l[b.shapeType](f).add(b.group||a.group);k.borderRadius&&c.attr({r:k.borderRadius});c[t](a.pointAttribs(b,b.selected&&\"select\")).shadow(k.shadow,null,k.stacking&&!k.borderRadius);c.addClass(b.getClassName(),!0)}else c&&(b.graphic=c.destroy())})},animate:function(a){var c=this,e=this.yAxis,g=c.options,p=this.chart.inverted,f={},b=p?\"translateX\":\"translateY\",n;u&&(a?(f.scaleY=.001,a=Math.min(e.pos+e.len,Math.max(e.pos,e.toPixels(g.threshold))),p?f.translateX=a-e.len:f.translateY=a,c.group.attr(f)):\r\n(n=c.group.attr(b),c.group.animate({scaleY:1},r(C(c.options.animation),{step:function(a,d){f[b]=n+d.pos*(e.pos-n);c.group.attr(f)}})),c.animate=null))},remove:function(){var a=this,d=a.chart;d.hasRendered&&D(d.series,function(c){c.type===a.type&&(c.isDirty=!0)});w.prototype.remove.apply(a,arguments)}})})(K);(function(a){a=a.seriesType;a(\"bar\",\"column\",null,{inverted:!0})})(K);(function(a){var C=a.Series;a=a.seriesType;a(\"scatter\",\"line\",{lineWidth:0,findNearestPointBy:\"xy\",marker:{enabled:!0},tooltip:{headerFormat:'\\x3cspan style\\x3d\"color:{point.color}\"\\x3e\\u25cf\\x3c/span\\x3e \\x3cspan style\\x3d\"font-size: 0.85em\"\\x3e {series.name}\\x3c/span\\x3e\\x3cbr/\\x3e',\r\npointFormat:\"x: \\x3cb\\x3e{point.x}\\x3c/b\\x3e\\x3cbr/\\x3ey: \\x3cb\\x3e{point.y}\\x3c/b\\x3e\\x3cbr/\\x3e\"}},{sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:[\"group\",\"markerGroup\",\"dataLabelsGroup\"],takeOrdinalPosition:!1,drawGraph:function(){this.options.lineWidth&&C.prototype.drawGraph.call(this)}})})(K);(function(a){var C=a.deg2rad,F=a.isNumber,D=a.pick,r=a.relativeLength;a.CenteredSeriesMixin={getCenter:function(){var a=this.options,e=this.chart,t=2*(a.slicedOffset||0),w=e.plotWidth-2*t,\r\ne=e.plotHeight-2*t,l=a.center,l=[D(l[0],\"50%\"),D(l[1],\"50%\"),a.size||\"100%\",a.innerSize||0],u=Math.min(w,e),c,d;for(c=0;4>c;++c)d=l[c],a=2>c||2===c&&/%$/.test(d),l[c]=r(d,[w,e,u,l[2]][c])+(a?t:0);l[3]>l[2]&&(l[3]=l[2]);return l},getStartAndEndRadians:function(a,e){a=F(a)?a:0;e=F(e)&&e>a&&360>e-a?e:a+360;return{start:C*(a+-90),end:C*(e+-90)}}}})(K);(function(a){var C=a.addEvent,F=a.CenteredSeriesMixin,D=a.defined,r=a.each,g=a.extend,e=F.getStartAndEndRadians,t=a.inArray,w=a.noop,l=a.pick,u=a.Point,\r\nc=a.Series,d=a.seriesType,k=a.setAnimation;d(\"pie\",\"line\",{center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:\"point\",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:\"#ffffff\",borderWidth:1,states:{hover:{brightness:.1}}},{isCartesian:!1,requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:[\"group\",\r\n\"dataLabelsGroup\"],axisTypes:[],pointAttribs:a.seriesTypes.column.prototype.pointAttribs,animate:function(a){var c=this,d=c.points,b=c.startAngleRad;a||(r(d,function(a){var d=a.graphic,f=a.shapeArgs;d&&(d.attr({r:a.startR||c.center[3]/2,start:b,end:b}),d.animate({r:f.r,start:f.start,end:f.end},c.options.animation))}),c.animate=null)},updateTotals:function(){var a,c=0,d=this.points,b=d.length,e,g=this.options.ignoreHiddenPoint;for(a=0;a<b;a++)e=d[a],c+=g&&!e.visible?0:e.isNull?0:e.y;this.total=c;for(a=\r\n0;a<b;a++)e=d[a],e.percentage=0<c&&(e.visible||!g)?e.y/c*100:0,e.total=c},generatePoints:function(){c.prototype.generatePoints.call(this);this.updateTotals()},translate:function(a){this.generatePoints();var c=0,d=this.options,b=d.slicedOffset,g=b+(d.borderWidth||0),k,t,q,r=e(d.startAngle,d.endAngle),u=this.startAngleRad=r.start,r=(this.endAngleRad=r.end)-u,w=this.points,m,x=d.dataLabels.distance,d=d.ignoreHiddenPoint,A,C=w.length,G;a||(this.center=a=this.getCenter());this.getX=function(b,c,d){q=Math.asin(Math.min((b-\r\na[1])/(a[2]/2+d.labelDistance),1));return a[0]+(c?-1:1)*Math.cos(q)*(a[2]/2+d.labelDistance)};for(A=0;A<C;A++){G=w[A];G.labelDistance=l(G.options.dataLabels&&G.options.dataLabels.distance,x);this.maxLabelDistance=Math.max(this.maxLabelDistance||0,G.labelDistance);k=u+c*r;if(!d||G.visible)c+=G.percentage/100;t=u+c*r;G.shapeType=\"arc\";G.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:Math.round(1E3*k)/1E3,end:Math.round(1E3*t)/1E3};q=(t+k)/2;q>1.5*Math.PI?q-=2*Math.PI:q<-Math.PI/2&&(q+=2*Math.PI);\r\nG.slicedTranslation={translateX:Math.round(Math.cos(q)*b),translateY:Math.round(Math.sin(q)*b)};t=Math.cos(q)*a[2]/2;m=Math.sin(q)*a[2]/2;G.tooltipPos=[a[0]+.7*t,a[1]+.7*m];G.half=q<-Math.PI/2||q>Math.PI/2?1:0;G.angle=q;k=Math.min(g,G.labelDistance/5);G.labelPos=[a[0]+t+Math.cos(q)*G.labelDistance,a[1]+m+Math.sin(q)*G.labelDistance,a[0]+t+Math.cos(q)*k,a[1]+m+Math.sin(q)*k,a[0]+t,a[1]+m,0>G.labelDistance?\"center\":G.half?\"right\":\"left\",q]}},drawGraph:null,drawPoints:function(){var a=this,c=a.chart.renderer,\r\nd,b,e,k,l=a.options.shadow;l&&!a.shadowGroup&&(a.shadowGroup=c.g(\"shadow\").add(a.group));r(a.points,function(f){b=f.graphic;if(f.isNull)b&&(f.graphic=b.destroy());else{k=f.shapeArgs;d=f.getTranslate();var q=f.shadowGroup;l&&!q&&(q=f.shadowGroup=c.g(\"shadow\").add(a.shadowGroup));q&&q.attr(d);e=a.pointAttribs(f,f.selected&&\"select\");b?b.setRadialReference(a.center).attr(e).animate(g(k,d)):(f.graphic=b=c[f.shapeType](k).setRadialReference(a.center).attr(d).add(a.group),f.visible||b.attr({visibility:\"hidden\"}),\r\nb.attr(e).attr({\"stroke-linejoin\":\"round\"}).shadow(l,q));b.addClass(f.getClassName())}})},searchPoint:w,sortByAngle:function(a,c){a.sort(function(a,b){return void 0!==a.angle&&(b.angle-a.angle)*c})},drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,getCenter:F.getCenter,getSymbol:w},{init:function(){u.prototype.init.apply(this,arguments);var a=this,c;a.name=l(a.name,\"Slice\");c=function(c){a.slice(\"select\"===c.type)};C(a,\"select\",c);C(a,\"unselect\",c);return a},isValid:function(){return a.isNumber(this.y,\r\n!0)&&0<=this.y},setVisible:function(a,c){var d=this,b=d.series,e=b.chart,g=b.options.ignoreHiddenPoint;c=l(c,g);a!==d.visible&&(d.visible=d.options.visible=a=void 0===a?!d.visible:a,b.options.data[t(d,b.data)]=d.options,r([\"graphic\",\"dataLabel\",\"connector\",\"shadowGroup\"],function(b){if(d[b])d[b][a?\"show\":\"hide\"](!0)}),d.legendItem&&e.legend.colorizeItem(d,a),a||\"hover\"!==d.state||d.setState(\"\"),g&&(b.isDirty=!0),c&&e.redraw())},slice:function(a,c,d){var b=this.series;k(d,b.chart);l(c,!0);this.sliced=\r\nthis.options.sliced=D(a)?a:!this.sliced;b.options.data[t(this,b.data)]=this.options;this.graphic.animate(this.getTranslate());this.shadowGroup&&this.shadowGroup.animate(this.getTranslate())},getTranslate:function(){return this.sliced?this.slicedTranslation:{translateX:0,translateY:0}},haloPath:function(a){var c=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.x,c.y,c.r+a,c.r+a,{innerR:this.shapeArgs.r-1,start:c.start,end:c.end})}})})(K);(function(a){var C=\r\na.addEvent,F=a.arrayMax,D=a.defined,r=a.each,g=a.extend,e=a.format,t=a.map,w=a.merge,l=a.noop,u=a.pick,c=a.relativeLength,d=a.Series,k=a.seriesTypes,x=a.some,p=a.stableSort;a.distribute=function(c,b,d){function e(a,b){return a.target-b.target}var f,g=!0,k=c,l=[],n;n=0;var m=k.reducedLen||b;for(f=c.length;f--;)n+=c[f].size;if(n>m){p(c,function(a,b){return(b.rank||0)-(a.rank||0)});for(n=f=0;n<=m;)n+=c[f].size,f++;l=c.splice(f-1,c.length)}p(c,e);for(c=t(c,function(a){return{size:a.size,targets:[a.target],\r\nalign:u(a.align,.5)}});g;){for(f=c.length;f--;)g=c[f],n=(Math.min.apply(0,g.targets)+Math.max.apply(0,g.targets))/2,g.pos=Math.min(Math.max(0,n-g.size*g.align),b-g.size);f=c.length;for(g=!1;f--;)0<f&&c[f-1].pos+c[f-1].size>c[f].pos&&(c[f-1].size+=c[f].size,c[f-1].targets=c[f-1].targets.concat(c[f].targets),c[f-1].align=.5,c[f-1].pos+c[f-1].size>b&&(c[f-1].pos=b-c[f-1].size),c.splice(f,1),g=!0)}k.push.apply(k,l);f=0;x(c,function(c){var e=0;if(x(c.targets,function(){k[f].pos=c.pos+e;if(Math.abs(k[f].pos-\r\nk[f].target)>d)return r(k.slice(0,f+1),function(a){delete a.pos}),k.reducedLen=(k.reducedLen||b)-.1*b,k.reducedLen>.1*b&&a.distribute(k,b,d),!0;e+=k[f].size;f++}))return!0});p(k,e)};d.prototype.drawDataLabels=function(){function c(a,b){var c=b.filter;return c?(b=c.operator,a=a[c.property],c=c.value,\"\\x3e\"===b&&a>c||\"\\x3c\"===b&&a<c||\"\\x3e\\x3d\"===b&&a>=c||\"\\x3c\\x3d\"===b&&a<=c||\"\\x3d\\x3d\"===b&&a==c||\"\\x3d\\x3d\\x3d\"===b&&a===c?!0:!1):!0}var b=this,d=b.chart,g=b.options,k=g.dataLabels,q=b.points,l,p,t=\r\nb.hasRendered||0,m,x,A=u(k.defer,!!g.animation),F=d.renderer;if(k.enabled||b._hasPointLabels)b.dlProcessOptions&&b.dlProcessOptions(k),x=b.plotGroup(\"dataLabelsGroup\",\"data-labels\",A&&!t?\"hidden\":\"visible\",k.zIndex||6),A&&(x.attr({opacity:+t}),t||C(b,\"afterAnimate\",function(){b.visible&&x.show(!0);x[g.animation?\"animate\":\"attr\"]({opacity:1},{duration:200})})),p=k,r(q,function(f){var h,q=f.dataLabel,n,t,r=f.connector,B=!q,z;l=f.dlOptions||f.options&&f.options.dataLabels;(h=u(l&&l.enabled,p.enabled)&&\r\n!f.isNull)&&(h=!0===c(f,l||k));h&&(k=w(p,l),n=f.getLabelConfig(),z=k[f.formatPrefix+\"Format\"]||k.format,m=D(z)?e(z,n,d.time):(k[f.formatPrefix+\"Formatter\"]||k.formatter).call(n,k),z=k.style,n=k.rotation,z.color=u(k.color,z.color,b.color,\"#000000\"),\"contrast\"===z.color&&(f.contrastColor=F.getContrast(f.color||b.color),z.color=k.inside||0>u(f.labelDistance,k.distance)||g.stacking?f.contrastColor:\"#000000\"),g.cursor&&(z.cursor=g.cursor),t={fill:k.backgroundColor,stroke:k.borderColor,\"stroke-width\":k.borderWidth,\r\nr:k.borderRadius||0,rotation:n,padding:k.padding,zIndex:1},a.objectEach(t,function(a,b){void 0===a&&delete t[b]}));!q||h&&D(m)?h&&D(m)&&(q?t.text=m:(q=f.dataLabel=n?F.text(m,0,-9999).addClass(\"highcharts-data-label\"):F.label(m,0,-9999,k.shape,null,null,k.useHTML,null,\"data-label\"),q.addClass(\" highcharts-data-label-color-\"+f.colorIndex+\" \"+(k.className||\"\")+(k.useHTML?\"highcharts-tracker\":\"\"))),q.attr(t),q.css(z).shadow(k.shadow),q.added||q.add(x),b.alignDataLabel(f,q,k,null,B)):(f.dataLabel=q=q.destroy(),\r\nr&&(f.connector=r.destroy()))});a.fireEvent(this,\"afterDrawDataLabels\")};d.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart,k=f.inverted,l=u(a.dlBox&&a.dlBox.centerX,a.plotX,-9999),n=u(a.plotY,-9999),m=b.getBBox(),p,t=c.rotation,r=c.align,w=this.visible&&(a.series.forceDL||f.isInsidePlot(l,Math.round(n),k)||d&&f.isInsidePlot(l,k?d.x+1:d.y+d.height-1,k)),h=\"justify\"===u(c.overflow,\"justify\");if(w&&(p=c.style.fontSize,p=f.renderer.fontMetrics(p,b).b,d=g({x:k?this.yAxis.len-n:l,y:Math.round(k?\r\nthis.xAxis.len-l:n),width:0,height:0},d),g(c,{width:m.width,height:m.height}),t?(h=!1,l=f.renderer.rotCorr(p,t),l={x:d.x+c.x+d.width/2+l.x,y:d.y+c.y+{top:0,middle:.5,bottom:1}[c.verticalAlign]*d.height},b[e?\"attr\":\"animate\"](l).attr({align:r}),n=(t+720)%360,n=180<n&&360>n,\"left\"===r?l.y-=n?m.height:0:\"center\"===r?(l.x-=m.width/2,l.y-=m.height/2):\"right\"===r&&(l.x-=m.width,l.y-=n?0:m.height),b.placed=!0,b.alignAttr=l):(b.align(c,null,d),l=b.alignAttr),h?a.isLabelJustified=this.justifyDataLabel(b,c,\r\nl,m,d,e):u(c.crop,!0)&&(w=f.isInsidePlot(l.x,l.y)&&f.isInsidePlot(l.x+m.width,l.y+m.height)),c.shape&&!t))b[e?\"attr\":\"animate\"]({anchorX:k?f.plotWidth-a.plotY:a.plotX,anchorY:k?f.plotHeight-a.plotX:a.plotY});w||(b.attr({y:-9999}),b.placed=!1)};d.prototype.justifyDataLabel=function(a,b,c,d,e,g){var f=this.chart,q=b.align,k=b.verticalAlign,m,l,n=a.box?0:a.padding||0;m=c.x+n;0>m&&(\"right\"===q?b.align=\"left\":b.x=-m,l=!0);m=c.x+d.width-n;m>f.plotWidth&&(\"left\"===q?b.align=\"right\":b.x=f.plotWidth-m,l=!0);\r\nm=c.y+n;0>m&&(\"bottom\"===k?b.verticalAlign=\"top\":b.y=-m,l=!0);m=c.y+d.height-n;m>f.plotHeight&&(\"top\"===k?b.verticalAlign=\"bottom\":b.y=f.plotHeight-m,l=!0);l&&(a.placed=!g,a.align(b,null,e));return l};k.pie&&(k.pie.prototype.drawDataLabels=function(){var c=this,b=c.data,e,g=c.chart,k=c.options.dataLabels,q=u(k.connectorPadding,10),l=u(k.connectorWidth,1),p=g.plotWidth,t=g.plotHeight,m=Math.round(g.chartWidth/3),w,x=c.center,C=x[2]/2,G=x[1],h,v,K,P,I=[[],[]],O,N,y,R,S=[0,0,0,0];c.visible&&(k.enabled||\r\nc._hasPointLabels)&&(r(b,function(a){a.dataLabel&&a.visible&&a.dataLabel.shortened&&(a.dataLabel.attr({width:\"auto\"}).css({width:\"auto\",textOverflow:\"clip\"}),a.dataLabel.shortened=!1)}),d.prototype.drawDataLabels.apply(c),r(b,function(a){a.dataLabel&&a.visible&&(I[a.half].push(a),a.dataLabel._pos=null,!D(k.style.width)&&!D(a.options.dataLabels&&a.options.dataLabels.style&&a.options.dataLabels.style.width)&&a.dataLabel.getBBox().width>m&&(a.dataLabel.css({width:.7*m}),a.dataLabel.shortened=!0))}),\r\nr(I,function(b,d){var f,m,l=b.length,n=[],w;if(l)for(c.sortByAngle(b,d-.5),0<c.maxLabelDistance&&(f=Math.max(0,G-C-c.maxLabelDistance),m=Math.min(G+C+c.maxLabelDistance,g.plotHeight),r(b,function(a){0<a.labelDistance&&a.dataLabel&&(a.top=Math.max(0,G-C-a.labelDistance),a.bottom=Math.min(G+C+a.labelDistance,g.plotHeight),w=a.dataLabel.getBBox().height||21,a.positionsIndex=n.push({target:a.labelPos[1]-a.top+w/2,size:w,rank:a.y})-1)}),f=m+w-f,a.distribute(n,f,f/5)),R=0;R<l;R++)e=b[R],m=e.positionsIndex,\r\nK=e.labelPos,h=e.dataLabel,y=!1===e.visible?\"hidden\":\"inherit\",N=f=K[1],n&&D(n[m])&&(void 0===n[m].pos?y=\"hidden\":(P=n[m].size,N=e.top+n[m].pos)),delete e.positionIndex,O=k.justify?x[0]+(d?-1:1)*(C+e.labelDistance):c.getX(N<e.top+2||N>e.bottom-2?f:N,d,e),h._attr={visibility:y,align:K[6]},h._pos={x:O+k.x+({left:q,right:-q}[K[6]]||0),y:N+k.y-10},K.x=O,K.y=N,u(k.crop,!0)&&(v=h.getBBox().width,f=null,O-v<q&&1===d?(f=Math.round(v-O+q),S[3]=Math.max(f,S[3])):O+v>p-q&&0===d&&(f=Math.round(O+v-p+q),S[1]=\r\nMath.max(f,S[1])),0>N-P/2?S[0]=Math.max(Math.round(-N+P/2),S[0]):N+P/2>t&&(S[2]=Math.max(Math.round(N+P/2-t),S[2])),h.sideOverflow=f)}),0===F(S)||this.verifyDataLabelOverflow(S))&&(this.placeDataLabels(),l&&r(this.points,function(a){var b;w=a.connector;if((h=a.dataLabel)&&h._pos&&a.visible&&0<a.labelDistance){y=h._attr.visibility;if(b=!w)a.connector=w=g.renderer.path().addClass(\"highcharts-data-label-connector  highcharts-color-\"+a.colorIndex+(a.className?\" \"+a.className:\"\")).add(c.dataLabelsGroup),\r\nw.attr({\"stroke-width\":l,stroke:k.connectorColor||a.color||\"#666666\"});w[b?\"attr\":\"animate\"]({d:c.connectorPath(a.labelPos)});w.attr(\"visibility\",y)}else w&&(a.connector=w.destroy())}))},k.pie.prototype.connectorPath=function(a){var b=a.x,c=a.y;return u(this.options.dataLabels.softConnector,!0)?[\"M\",b+(\"left\"===a[6]?5:-5),c,\"C\",b,c,2*a[2]-a[4],2*a[3]-a[5],a[2],a[3],\"L\",a[4],a[5]]:[\"M\",b+(\"left\"===a[6]?5:-5),c,\"L\",a[2],a[3],\"L\",a[4],a[5]]},k.pie.prototype.placeDataLabels=function(){r(this.points,function(a){var b=\r\na.dataLabel;b&&a.visible&&((a=b._pos)?(b.sideOverflow&&(b._attr.width=b.getBBox().width-b.sideOverflow,b.css({width:b._attr.width+\"px\",textOverflow:this.options.dataLabels.style.textOverflow||\"ellipsis\"}),b.shortened=!0),b.attr(b._attr),b[b.moved?\"animate\":\"attr\"](a),b.moved=!0):b&&b.attr({y:-9999}))},this)},k.pie.prototype.alignDataLabel=l,k.pie.prototype.verifyDataLabelOverflow=function(a){var b=this.center,d=this.options,e=d.center,f=d.minSize||80,g,k=null!==d.size;k||(null!==e[0]?g=Math.max(b[2]-\r\nMath.max(a[1],a[3]),f):(g=Math.max(b[2]-a[1]-a[3],f),b[0]+=(a[3]-a[1])/2),null!==e[1]?g=Math.max(Math.min(g,b[2]-Math.max(a[0],a[2])),f):(g=Math.max(Math.min(g,b[2]-a[0]-a[2]),f),b[1]+=(a[0]-a[2])/2),g<b[2]?(b[2]=g,b[3]=Math.min(c(d.innerSize||0,g),g),this.translate(b),this.drawDataLabels&&this.drawDataLabels()):k=!0);return k});k.column&&(k.column.prototype.alignDataLabel=function(a,b,c,e,g){var f=this.chart.inverted,k=a.series,l=a.dlBox||a.shapeArgs,p=u(a.below,a.plotY>u(this.translatedThreshold,\r\nk.yAxis.len)),m=u(c.inside,!!this.options.stacking);l&&(e=w(l),0>e.y&&(e.height+=e.y,e.y=0),l=e.y+e.height-k.yAxis.len,0<l&&(e.height-=l),f&&(e={x:k.yAxis.len-e.y-e.height,y:k.xAxis.len-e.x-e.width,width:e.height,height:e.width}),m||(f?(e.x+=p?0:e.width,e.width=0):(e.y+=p?e.height:0,e.height=0)));c.align=u(c.align,!f||m?\"center\":p?\"right\":\"left\");c.verticalAlign=u(c.verticalAlign,f||m?\"middle\":p?\"top\":\"bottom\");d.prototype.alignDataLabel.call(this,a,b,c,e,g);a.isLabelJustified&&a.contrastColor&&a.dataLabel.css({color:a.contrastColor})})})(K);\r\n(function(a){var C=a.Chart,F=a.each,D=a.objectEach,r=a.pick;a=a.addEvent;a(C,\"render\",function(){var a=[];F(this.labelCollectors||[],function(e){a=a.concat(e())});F(this.yAxis||[],function(e){e.options.stackLabels&&!e.options.stackLabels.allowOverlap&&D(e.stacks,function(e){D(e,function(e){a.push(e.label)})})});F(this.series||[],function(e){var g=e.options.dataLabels,w=e.dataLabelCollections||[\"dataLabel\"];(g.enabled||e._hasPointLabels)&&!g.allowOverlap&&e.visible&&F(w,function(g){F(e.points,function(e){e[g]&&\r\n(e[g].labelrank=r(e.labelrank,e.shapeArgs&&e.shapeArgs.height),a.push(e[g]))})})});this.hideOverlappingLabels(a)});C.prototype.hideOverlappingLabels=function(a){var e=a.length,g,r,l,u,c,d,k,x,p,f=function(a,c,d,e,f,g,k,l){return!(f>a+d||f+k<a||g>c+e||g+l<c)};for(r=0;r<e;r++)if(g=a[r])g.oldOpacity=g.opacity,g.newOpacity=1,g.width||(l=g.getBBox(),g.width=l.width,g.height=l.height);a.sort(function(a,c){return(c.labelrank||0)-(a.labelrank||0)});for(r=0;r<e;r++)for(l=a[r],g=r+1;g<e;++g)if(u=a[g],l&&u&&\r\nl!==u&&l.placed&&u.placed&&0!==l.newOpacity&&0!==u.newOpacity&&(c=l.alignAttr,d=u.alignAttr,k=l.parentGroup,x=u.parentGroup,p=2*(l.box?0:l.padding||0),c=f(c.x+k.translateX,c.y+k.translateY,l.width-p,l.height-p,d.x+x.translateX,d.y+x.translateY,u.width-p,u.height-p)))(l.labelrank<u.labelrank?l:u).newOpacity=0;F(a,function(a){var b,c;a&&(c=a.newOpacity,a.oldOpacity!==c&&a.placed&&(c?a.show(!0):b=function(){a.hide()},a.alignAttr.opacity=c,a[a.isOld?\"animate\":\"attr\"](a.alignAttr,null,b)),a.isOld=!0)})}})(K);\r\n(function(a){var C=a.addEvent,F=a.Chart,D=a.createElement,r=a.css,g=a.defaultOptions,e=a.defaultPlotOptions,t=a.each,w=a.extend,l=a.fireEvent,u=a.hasTouch,c=a.inArray,d=a.isObject,k=a.Legend,x=a.merge,p=a.pick,f=a.Point,b=a.Series,n=a.seriesTypes,z=a.svg,J;J=a.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart.pointer,c=function(a){var c=b.getPointFromEvent(a);void 0!==c&&(b.isDirectTouch=!0,c.onMouseOver(a))};t(a.points,function(a){a.graphic&&(a.graphic.element.point=a);a.dataLabel&&\r\n(a.dataLabel.div?a.dataLabel.div.point=a:a.dataLabel.element.point=a)});a._hasTracking||(t(a.trackerGroups,function(d){if(a[d]){a[d].addClass(\"highcharts-tracker\").on(\"mouseover\",c).on(\"mouseout\",function(a){b.onTrackerMouseOut(a)});if(u)a[d].on(\"touchstart\",c);a.options.cursor&&a[d].css(r).css({cursor:a.options.cursor})}}),a._hasTracking=!0);l(this,\"afterDrawTracker\")},drawTrackerGraph:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=\r\nf.pointer,k=f.renderer,p=f.options.tooltip.snap,h=a.tracker,n,r=function(){if(f.hoverSeries!==a)a.onMouseOver()},w=\"rgba(192,192,192,\"+(z?.0001:.002)+\")\";if(e&&!c)for(n=e+1;n--;)\"M\"===d[n]&&d.splice(n+1,0,d[n+1]-p,d[n+2],\"L\"),(n&&\"M\"===d[n]||n===e)&&d.splice(n,0,\"L\",d[n-2]+p,d[n-1]);h?h.attr({d:d}):a.graph&&(a.tracker=k.path(d).attr({\"stroke-linejoin\":\"round\",visibility:a.visible?\"visible\":\"hidden\",stroke:w,fill:c?w:\"none\",\"stroke-width\":a.graph.strokeWidth()+(c?0:2*p),zIndex:2}).add(a.group),t([a.tracker,\r\na.markerGroup],function(a){a.addClass(\"highcharts-tracker\").on(\"mouseover\",r).on(\"mouseout\",function(a){g.onTrackerMouseOut(a)});b.cursor&&a.css({cursor:b.cursor});if(u)a.on(\"touchstart\",r)}));l(this,\"afterDrawTracker\")}};n.column&&(n.column.prototype.drawTracker=J.drawTrackerPoint);n.pie&&(n.pie.prototype.drawTracker=J.drawTrackerPoint);n.scatter&&(n.scatter.prototype.drawTracker=J.drawTrackerPoint);w(k.prototype,{setItemEvents:function(a,b,c){var d=this,e=d.chart.renderer.boxWrapper,g=\"highcharts-legend-\"+\r\n(a instanceof f?\"point\":\"series\")+\"-active\";(c?b:a.legendGroup).on(\"mouseover\",function(){a.setState(\"hover\");e.addClass(g);b.css(d.options.itemHoverStyle)}).on(\"mouseout\",function(){b.css(x(a.visible?d.itemStyle:d.itemHiddenStyle));e.removeClass(g);a.setState()}).on(\"click\",function(b){var c=function(){a.setVisible&&a.setVisible()};e.removeClass(g);b={browserEvent:b};a.firePointEvent?a.firePointEvent(\"legendItemClick\",b,c):l(a,\"legendItemClick\",b,c)})},createCheckboxForItem:function(a){a.checkbox=\r\nD(\"input\",{type:\"checkbox\",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container);C(a.checkbox,\"click\",function(b){l(a.series||a,\"checkboxClick\",{checked:b.target.checked,item:a},function(){a.select()})})}});g.legend.itemStyle.cursor=\"pointer\";w(F.prototype,{showResetZoom:function(){function a(){b.zoomOut()}var b=this,c=g.lang,d=b.options.chart.resetZoomButton,e=d.theme,f=e.states,k=\"chart\"===d.relativeTo?null:\"plotBox\";l(this,\"beforeShowResetZoom\",null,\r\nfunction(){b.resetZoomButton=b.renderer.button(c.resetZoom,null,null,a,e,f&&f.hover).attr({align:d.position.align,title:c.resetZoomTitle}).addClass(\"highcharts-reset-zoom\").add().align(d.position,!1,k)})},zoomOut:function(){l(this,\"selection\",{resetSelection:!0},this.zoom)},zoom:function(a){var b,c=this.pointer,e=!1,f;!a||a.resetSelection?(t(this.axes,function(a){b=a.zoom()}),c.initiated=!1):t(a.xAxis.concat(a.yAxis),function(a){var d=a.axis;c[d.isXAxis?\"zoomX\":\"zoomY\"]&&(b=d.zoom(a.min,a.max),d.displayBtn&&\r\n(e=!0))});f=this.resetZoomButton;e&&!f?this.showResetZoom():!e&&d(f)&&(this.resetZoomButton=f.destroy());b&&this.redraw(p(this.options.chart.animation,a&&a.animation,100>this.pointCount))},pan:function(a,b){var c=this,d=c.hoverPoints,e;d&&t(d,function(a){a.setState()});t(\"xy\"===b?[1,0]:[1],function(b){b=c[b?\"xAxis\":\"yAxis\"][0];var d=b.horiz,f=a[d?\"chartX\":\"chartY\"],d=d?\"mouseDownX\":\"mouseDownY\",g=c[d],h=(b.pointRange||0)/2,k=b.reversed&&!c.inverted||!b.reversed&&c.inverted?-1:1,l=b.getExtremes(),\r\nm=b.toValue(g-f,!0)+h*k,k=b.toValue(g+b.len-f,!0)-h*k,q=k<m,g=q?k:m,m=q?m:k,k=Math.min(l.dataMin,h?l.min:b.toValue(b.toPixels(l.min)-b.minPixelPadding)),h=Math.max(l.dataMax,h?l.max:b.toValue(b.toPixels(l.max)+b.minPixelPadding)),q=k-g;0<q&&(m+=q,g=k);q=m-h;0<q&&(m=h,g-=q);b.series.length&&g!==l.min&&m!==l.max&&(b.setExtremes(g,m,!1,!1,{trigger:\"pan\"}),e=!0);c[d]=f});e&&c.redraw(!1);r(c.container,{cursor:\"move\"})}});w(f.prototype,{select:function(a,b){var d=this,e=d.series,f=e.chart;a=p(a,!d.selected);\r\nd.firePointEvent(a?\"select\":\"unselect\",{accumulate:b},function(){d.selected=d.options.selected=a;e.options.data[c(d,e.data)]=d.options;d.setState(a&&\"select\");b||t(f.getSelectedPoints(),function(a){a.selected&&a!==d&&(a.selected=a.options.selected=!1,e.options.data[c(a,e.data)]=a.options,a.setState(\"\"),a.firePointEvent(\"unselect\"))})})},onMouseOver:function(a){var b=this.series.chart,c=b.pointer;a=a?c.normalize(a):c.getChartCoordinatesFromPoint(this,b.inverted);c.runPointActions(a,this)},onMouseOut:function(){var a=\r\nthis.series.chart;this.firePointEvent(\"mouseOut\");t(a.hoverPoints||[],function(a){a.setState()});a.hoverPoints=a.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var b=this,c=x(b.series.options.point,b.options).events;b.events=c;a.objectEach(c,function(a,c){C(b,c,a)});this.hasImportedEvents=!0}},setState:function(a,b){var c=Math.floor(this.plotX),d=this.plotY,f=this.series,g=f.options.states[a||\"normal\"]||{},k=e[f.type].marker&&f.options.marker,q=k&&!1===k.enabled,n=k&&k.states&&\r\nk.states[a||\"normal\"]||{},h=!1===n.enabled,r=f.stateMarkerGraphic,t=this.marker||{},u=f.chart,x=f.halo,z,C=k&&f.markerAttribs;a=a||\"\";if(!(a===this.state&&!b||this.selected&&\"select\"!==a||!1===g.enabled||a&&(h||q&&!1===n.enabled)||a&&t.states&&t.states[a]&&!1===t.states[a].enabled)){C&&(z=f.markerAttribs(this,a));if(this.graphic)this.state&&this.graphic.removeClass(\"highcharts-point-\"+this.state),a&&this.graphic.addClass(\"highcharts-point-\"+a),this.graphic.animate(f.pointAttribs(this,a),p(u.options.chart.animation,\r\ng.animation)),z&&this.graphic.animate(z,p(u.options.chart.animation,n.animation,k.animation)),r&&r.hide();else{if(a&&n){k=t.symbol||f.symbol;r&&r.currentSymbol!==k&&(r=r.destroy());if(r)r[b?\"animate\":\"attr\"]({x:z.x,y:z.y});else k&&(f.stateMarkerGraphic=r=u.renderer.symbol(k,z.x,z.y,z.width,z.height).add(f.markerGroup),r.currentSymbol=k);r&&r.attr(f.pointAttribs(this,a))}r&&(r[a&&u.isInsidePlot(c,d,u.inverted)?\"show\":\"hide\"](),r.element.point=this)}(c=g.halo)&&c.size?(x||(f.halo=x=u.renderer.path().add((this.graphic||\r\nr).parentGroup)),x.show()[b?\"animate\":\"attr\"]({d:this.haloPath(c.size)}),x.attr({\"class\":\"highcharts-halo highcharts-color-\"+p(this.colorIndex,f.colorIndex)+(this.className?\" \"+this.className:\"\")}),x.point=this,x.attr(w({fill:this.color||f.color,\"fill-opacity\":c.opacity,zIndex:-1},c.attributes))):x&&x.point&&x.point.haloPath&&x.animate({d:x.point.haloPath(0)},null,x.hide);this.state=a;l(this,\"afterSetState\")}},haloPath:function(a){return this.series.chart.renderer.symbols.circle(Math.floor(this.plotX)-\r\na,this.plotY-a,2*a,2*a)}});w(b.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this)b.onMouseOut();this.options.events.mouseOver&&l(this,\"mouseOver\");this.setState(\"hover\");a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;b.hoverSeries=null;if(d)d.onMouseOut();this&&a.events.mouseOut&&l(this,\"mouseOut\");!c||this.stickyTracking||c.shared&&!this.noSharedTooltip||c.hide();this.setState()},setState:function(a){var b=this,\r\nc=b.options,d=b.graph,e=c.states,f=c.lineWidth,c=0;a=a||\"\";if(b.state!==a&&(t([b.group,b.markerGroup,b.dataLabelsGroup],function(c){c&&(b.state&&c.removeClass(\"highcharts-series-\"+b.state),a&&c.addClass(\"highcharts-series-\"+a))}),b.state=a,!e[a]||!1!==e[a].enabled)&&(a&&(f=e[a].lineWidth||f+(e[a].lineWidthPlus||0)),d&&!d.dashstyle))for(f={\"stroke-width\":f},d.animate(f,p(e[a||\"normal\"]&&e[a||\"normal\"].animation,b.chart.options.chart.animation));b[\"zone-graph-\"+c];)b[\"zone-graph-\"+c].attr(f),c+=1},\r\nsetVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,k=c.visible;f=(c.visible=a=c.options.visible=c.userOptions.visible=void 0===a?!k:a)?\"show\":\"hide\";t([\"group\",\"dataLabelsGroup\",\"markerGroup\",\"tracker\",\"tt\"],function(a){if(c[a])c[a][f]()});if(d.hoverSeries===c||(d.hoverPoint&&d.hoverPoint.series)===c)c.onMouseOut();e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&t(d.series,function(a){a.options.stacking&&a.visible&&(a.isDirty=!0)});t(c.linkedSeries,\r\nfunction(b){b.setVisible(a,!1)});g&&(d.isDirtyBox=!0);!1!==b&&d.redraw();l(c,f)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=a=void 0===a?!this.selected:a;this.checkbox&&(this.checkbox.checked=a);l(this,a?\"select\":\"unselect\")},drawTracker:J.drawTrackerGraph})})(K);(function(a){var C=a.Chart,F=a.each,D=a.inArray,r=a.isArray,g=a.isObject,e=a.pick,t=a.splat;C.prototype.setResponsive=function(e){var g=this.options.responsive,r=[],c=this.currentResponsive;\r\ng&&g.rules&&F(g.rules,function(c){void 0===c._id&&(c._id=a.uniqueKey());this.matchResponsiveRule(c,r,e)},this);var d=a.merge.apply(0,a.map(r,function(c){return a.find(g.rules,function(a){return a._id===c}).chartOptions})),r=r.toString()||void 0;r!==(c&&c.ruleIds)&&(c&&this.update(c.undoOptions,e),r?(this.currentResponsive={ruleIds:r,mergedOptions:d,undoOptions:this.currentOptions(d)},this.update(d,e)):this.currentResponsive=void 0)};C.prototype.matchResponsiveRule=function(a,g){var l=a.condition;\r\n(l.callback||function(){return this.chartWidth<=e(l.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=e(l.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=e(l.minWidth,0)&&this.chartHeight>=e(l.minHeight,0)}).call(this)&&g.push(a._id)};C.prototype.currentOptions=function(e){function l(c,d,e,u){var k;a.objectEach(c,function(a,b){if(!u&&-1<D(b,[\"series\",\"xAxis\",\"yAxis\"]))for(a=t(a),e[b]=[],k=0;k<a.length;k++)d[b][k]&&(e[b][k]={},l(a[k],d[b][k],e[b][k],u+1));else g(a)?(e[b]=r(a)?[]:{},l(a,d[b]||{},e[b],u+1)):\r\ne[b]=d[b]||null})}var u={};l(e,this.options,u,0);return u}})(K);return K});\r\n","/*\n Highmaps JS v6.1.0 (2018-04-13)\n Highmaps as a plugin for Highcharts or Highstock.\n\n (c) 2011-2017 Torstein Honsi\n\n License: www.highcharts.com/license\n*/\n(function(x){\"object\"===typeof module&&module.exports?module.exports=x:x(Highcharts)})(function(x){(function(a){var l=a.addEvent,h=a.Axis,k=a.each,f=a.pick;l(h,\"getSeriesExtremes\",function(){var a=[];this.isXAxis&&(k(this.series,function(q,f){q.useMapGeometry&&(a[f]=q.xData,q.xData=[])}),this.seriesXData=a)});l(h,\"afterGetSeriesExtremes\",function(){var a=this.seriesXData,g,h,t;this.isXAxis&&(g=f(this.dataMin,Number.MAX_VALUE),h=f(this.dataMax,-Number.MAX_VALUE),k(this.series,function(e,b){e.useMapGeometry&&\n(g=Math.min(g,f(e.minX,g)),h=Math.max(h,f(e.maxX,h)),e.xData=a[b],t=!0)}),t&&(this.dataMin=g,this.dataMax=h),delete this.seriesXData)});l(h,\"afterSetAxisTranslation\",function(){var a=this.chart,g;g=a.plotWidth/a.plotHeight;var a=a.xAxis[0],f;\"yAxis\"===this.coll&&void 0!==a.transA&&k(this.series,function(a){a.preserveAspectRatio&&(f=!0)});if(f&&(this.transA=a.transA=Math.min(this.transA,a.transA),g/=(a.max-a.min)/(this.max-this.min),g=1>g?this:a,a=(g.max-g.min)*g.transA,g.pixelPadding=g.len-a,g.minPixelPadding=\ng.pixelPadding/2,a=g.fixTo)){a=a[1]-g.toValue(a[0],!0);a*=g.transA;if(Math.abs(a)>g.minPixelPadding||g.min===g.dataMin&&g.max===g.dataMax)a=0;g.minPixelPadding-=a}});l(h,\"render\",function(){this.fixTo=null})})(x);(function(a){var l=a.addEvent,h=a.Axis,k=a.Chart,f=a.color,q,g=a.each,u=a.extend,t=a.isNumber,e=a.Legend,b=a.LegendSymbolMixin,d=a.noop,n=a.merge,r=a.pick;a.ColorAxis||(q=a.ColorAxis=function(){this.init.apply(this,arguments)},u(q.prototype,h.prototype),u(q.prototype,{defaultColorAxisOptions:{lineWidth:0,\nminPadding:0,maxPadding:0,gridLineWidth:1,tickPixelInterval:72,startOnTick:!0,endOnTick:!0,offset:0,marker:{animation:{duration:50},width:.01,color:\"#999999\"},labels:{overflow:\"justify\",rotation:0},minColor:\"#e6ebf5\",maxColor:\"#003399\",tickLength:5,showInLegend:!0},keepProps:[\"legendGroup\",\"legendItemHeight\",\"legendItemWidth\",\"legendItem\",\"legendSymbol\"].concat(h.prototype.keepProps),init:function(a,b){var c=\"vertical\"!==a.options.legend.layout,m;this.coll=\"colorAxis\";m=n(this.defaultColorAxisOptions,\n{side:c?2:1,reversed:!c},b,{opposite:!c,showEmpty:!1,title:null,visible:a.options.legend.enabled});h.prototype.init.call(this,a,m);b.dataClasses&&this.initDataClasses(b);this.initStops();this.horiz=c;this.zoomEnabled=!1;this.defaultLegendLength=200},initDataClasses:function(a){var b=this.chart,c,m=0,d=b.options.chart.colorCount,e=this.options,y=a.dataClasses.length;this.dataClasses=c=[];this.legendItems=[];g(a.dataClasses,function(a,p){a=n(a);c.push(a);a.color||(\"category\"===e.dataClassColor?(p=b.options.colors,\nd=p.length,a.color=p[m],a.colorIndex=m,m++,m===d&&(m=0)):a.color=f(e.minColor).tweenTo(f(e.maxColor),2>y?.5:p/(y-1)))})},setTickPositions:function(){if(!this.dataClasses)return h.prototype.setTickPositions.call(this)},initStops:function(){this.stops=this.options.stops||[[0,this.options.minColor],[1,this.options.maxColor]];g(this.stops,function(a){a.color=f(a[1])})},setOptions:function(a){h.prototype.setOptions.call(this,a);this.options.crosshair=this.options.marker},setAxisSize:function(){var a=this.legendSymbol,\nb=this.chart,c=b.options.legend||{},p,d;a?(this.left=c=a.attr(\"x\"),this.top=p=a.attr(\"y\"),this.width=d=a.attr(\"width\"),this.height=a=a.attr(\"height\"),this.right=b.chartWidth-c-d,this.bottom=b.chartHeight-p-a,this.len=this.horiz?d:a,this.pos=this.horiz?c:p):this.len=(this.horiz?c.symbolWidth:c.symbolHeight)||this.defaultLegendLength},normalizedValue:function(a){this.isLog&&(a=this.val2lin(a));return 1-(this.max-a)/(this.max-this.min||1)},toColor:function(a,b){var c=this.stops,p,m,v=this.dataClasses,\nd,e;if(v)for(e=v.length;e--;){if(d=v[e],p=d.from,c=d.to,(void 0===p||a>=p)&&(void 0===c||a<=c)){m=d.color;b&&(b.dataClass=e,b.colorIndex=d.colorIndex);break}}else{a=this.normalizedValue(a);for(e=c.length;e--&&!(a>c[e][0]););p=c[e]||c[e+1];c=c[e+1]||p;a=1-(c[0]-a)/(c[0]-p[0]||1);m=p.color.tweenTo(c.color,a)}return m},getOffset:function(){var a=this.legendGroup,b=this.chart.axisOffset[this.side];a&&(this.axisParent=a,h.prototype.getOffset.call(this),this.added||(this.added=!0,this.labelLeft=0,this.labelRight=\nthis.width),this.chart.axisOffset[this.side]=b)},setLegendColor:function(){var a,b=this.reversed;a=b?1:0;b=b?0:1;a=this.horiz?[a,0,b,0]:[0,b,0,a];this.legendColor={linearGradient:{x1:a[0],y1:a[1],x2:a[2],y2:a[3]},stops:this.stops}},drawLegendSymbol:function(a,b){var c=a.padding,p=a.options,d=this.horiz,m=r(p.symbolWidth,d?this.defaultLegendLength:12),v=r(p.symbolHeight,d?12:this.defaultLegendLength),e=r(p.labelPadding,d?16:30),p=r(p.itemDistance,10);this.setLegendColor();b.legendSymbol=this.chart.renderer.rect(0,\na.baseline-11,m,v).attr({zIndex:1}).add(b.legendGroup);this.legendItemWidth=m+c+(d?p:e);this.legendItemHeight=v+c+(d?e:0)},setState:function(a){g(this.series,function(b){b.setState(a)})},visible:!0,setVisible:d,getSeriesExtremes:function(){var a=this.series,b=a.length;this.dataMin=Infinity;for(this.dataMax=-Infinity;b--;)void 0!==a[b].valueMin&&(this.dataMin=Math.min(this.dataMin,a[b].valueMin),this.dataMax=Math.max(this.dataMax,a[b].valueMax))},drawCrosshair:function(a,b){var c=b&&b.plotX,p=b&&b.plotY,\nd,e=this.pos,m=this.len;b&&(d=this.toPixels(b[b.series.colorKey]),d<e?d=e-2:d>e+m&&(d=e+m+2),b.plotX=d,b.plotY=this.len-d,h.prototype.drawCrosshair.call(this,a,b),b.plotX=c,b.plotY=p,this.cross&&!this.cross.addedToColorAxis&&this.legendGroup&&(this.cross.addClass(\"highcharts-coloraxis-marker\").add(this.legendGroup),this.cross.addedToColorAxis=!0,this.cross.attr({fill:this.crosshair.color})))},getPlotLinePath:function(a,b,c,d,e){return t(e)?this.horiz?[\"M\",e-4,this.top-6,\"L\",e+4,this.top-6,e,this.top,\n\"Z\"]:[\"M\",this.left,e,\"L\",this.left-6,e+6,this.left-6,e-6,\"Z\"]:h.prototype.getPlotLinePath.call(this,a,b,c,d)},update:function(a,b){var c=this.chart,d=c.legend;g(this.series,function(a){a.isDirtyData=!0});a.dataClasses&&d.allItems&&(g(d.allItems,function(a){a.isDataClass&&a.legendGroup&&a.legendGroup.destroy()}),c.isDirtyLegend=!0);c.options[this.coll]=n(this.userOptions,a);h.prototype.update.call(this,a,b);this.legendItem&&(this.setLegendColor(),d.colorizeItem(this,!0))},remove:function(){this.legendItem&&\nthis.chart.legend.destroyItem(this);h.prototype.remove.call(this)},getDataClassLegendSymbols:function(){var e=this,v=this.chart,c=this.legendItems,p=v.options.legend,n=p.valueDecimals,r=p.valueSuffix||\"\",y;c.length||g(this.dataClasses,function(p,m){var w=!0,f=p.from,q=p.to;y=\"\";void 0===f?y=\"\\x3c \":void 0===q&&(y=\"\\x3e \");void 0!==f&&(y+=a.numberFormat(f,n)+r);void 0!==f&&void 0!==q&&(y+=\" - \");void 0!==q&&(y+=a.numberFormat(q,n)+r);c.push(u({chart:v,name:y,options:{},drawLegendSymbol:b.drawRectangle,\nvisible:!0,setState:d,isDataClass:!0,setVisible:function(){w=this.visible=!w;g(e.series,function(a){g(a.points,function(a){a.dataClass===m&&a.setVisible(w)})});v.legend.colorizeItem(this,w)}},p))});return c},name:\"\"}),g([\"fill\",\"stroke\"],function(b){a.Fx.prototype[b+\"Setter\"]=function(){this.elem.attr(b,f(this.start).tweenTo(f(this.end),this.pos),null,!0)}}),l(k,\"afterGetAxes\",function(){var a=this.options.colorAxis;this.colorAxis=[];a&&new q(this,a)}),l(e,\"afterGetAllItems\",function(b){var d=[],\nc=this.chart.colorAxis[0];c&&c.options&&(c.options.showInLegend&&(c.options.dataClasses?d=c.getDataClassLegendSymbols():d.push(c)),g(c.series,function(c){a.erase(b.allItems,c)}));for(;d.length;)b.allItems.unshift(d.pop())}),l(e,\"afterColorizeItem\",function(a){a.visible&&a.item.legendColor&&a.item.legendSymbol.attr({fill:a.item.legendColor})}),l(e,\"afterUpdate\",function(a,b,c){this.chart.colorAxis[0]&&this.chart.colorAxis[0].update({},c)}))})(x);(function(a){var l=a.defined,h=a.each,k=a.noop,f=a.seriesTypes;\na.colorPointMixin={isValid:function(){return null!==this.value&&Infinity!==this.value&&-Infinity!==this.value},setVisible:function(a){var f=this,q=a?\"show\":\"hide\";h([\"graphic\",\"dataLabel\"],function(a){if(f[a])f[a][q]()})},setState:function(f){a.Point.prototype.setState.call(this,f);this.graphic&&this.graphic.attr({zIndex:\"hover\"===f?1:0})}};a.colorSeriesMixin={pointArrayMap:[\"value\"],axisTypes:[\"xAxis\",\"yAxis\",\"colorAxis\"],optionalAxis:\"colorAxis\",trackerGroups:[\"group\",\"markerGroup\",\"dataLabelsGroup\"],\ngetSymbol:k,parallelArrays:[\"x\",\"y\",\"value\"],colorKey:\"value\",pointAttribs:f.column.prototype.pointAttribs,translateColors:function(){var a=this,f=this.options.nullColor,k=this.colorAxis,l=this.colorKey;h(this.data,function(e){var b=e[l];if(b=e.options.color||(e.isNull?f:k&&void 0!==b?k.toColor(b,e):e.color||a.color))e.color=b})},colorAttribs:function(a){var f={};l(a.color)&&(f[this.colorProp||\"fill\"]=a.color);return f}}})(x);(function(a){function l(a){a&&(a.preventDefault&&a.preventDefault(),a.stopPropagation&&\na.stopPropagation(),a.cancelBubble=!0)}function h(a){this.init(a)}var k=a.addEvent,f=a.Chart,q=a.doc,g=a.each,u=a.extend,t=a.merge,e=a.pick;h.prototype.init=function(a){this.chart=a;a.mapNavButtons=[]};h.prototype.update=function(b){var d=this.chart,n=d.options.mapNavigation,f,m,v,c,p,w=function(a){this.handler.call(d,a);l(a)},q=d.mapNavButtons;b&&(n=d.options.mapNavigation=t(d.options.mapNavigation,b));for(;q.length;)q.pop().destroy();e(n.enableButtons,n.enabled)&&!d.renderer.forExport&&a.objectEach(n.buttons,\nfunction(a,b){f=t(n.buttonOptions,a);m=f.theme;m.style=t(f.theme.style,f.style);c=(v=m.states)&&v.hover;p=v&&v.select;a=d.renderer.button(f.text,0,0,w,m,c,p,0,\"zoomIn\"===b?\"topbutton\":\"bottombutton\").addClass(\"highcharts-map-navigation\").attr({width:f.width,height:f.height,title:d.options.lang[b],padding:f.padding,zIndex:5}).add();a.handler=f.onclick;a.align(u(f,{width:a.width,height:2*a.height}),null,f.alignTo);k(a.element,\"dblclick\",l);q.push(a)});this.updateEvents(n)};h.prototype.updateEvents=\nfunction(a){var b=this.chart;e(a.enableDoubleClickZoom,a.enabled)||a.enableDoubleClickZoomTo?this.unbindDblClick=this.unbindDblClick||k(b.container,\"dblclick\",function(a){b.pointer.onContainerDblClick(a)}):this.unbindDblClick&&(this.unbindDblClick=this.unbindDblClick());e(a.enableMouseWheelZoom,a.enabled)?this.unbindMouseWheel=this.unbindMouseWheel||k(b.container,void 0===q.onmousewheel?\"DOMMouseScroll\":\"mousewheel\",function(a){b.pointer.onContainerMouseWheel(a);l(a);return!1}):this.unbindMouseWheel&&\n(this.unbindMouseWheel=this.unbindMouseWheel())};u(f.prototype,{fitToBox:function(a,d){g([[\"x\",\"width\"],[\"y\",\"height\"]],function(b){var e=b[0];b=b[1];a[e]+a[b]>d[e]+d[b]&&(a[b]>d[b]?(a[b]=d[b],a[e]=d[e]):a[e]=d[e]+d[b]-a[b]);a[b]>d[b]&&(a[b]=d[b]);a[e]<d[e]&&(a[e]=d[e])});return a},mapZoom:function(a,d,f,q,m){var b=this.xAxis[0],c=b.max-b.min,p=e(d,b.min+c/2),w=c*a,c=this.yAxis[0],n=c.max-c.min,g=e(f,c.min+n/2),n=n*a,p=this.fitToBox({x:p-w*(q?(q-b.pos)/b.len:.5),y:g-n*(m?(m-c.pos)/c.len:.5),width:w,\nheight:n},{x:b.dataMin,y:c.dataMin,width:b.dataMax-b.dataMin,height:c.dataMax-c.dataMin}),w=p.x<=b.dataMin&&p.width>=b.dataMax-b.dataMin&&p.y<=c.dataMin&&p.height>=c.dataMax-c.dataMin;q&&(b.fixTo=[q-b.pos,d]);m&&(c.fixTo=[m-c.pos,f]);void 0===a||w?(b.setExtremes(void 0,void 0,!1),c.setExtremes(void 0,void 0,!1)):(b.setExtremes(p.x,p.x+p.width,!1),c.setExtremes(p.y,p.y+p.height,!1));this.redraw()}});k(f,\"beforeRender\",function(){this.mapNavigation=new h(this);this.mapNavigation.update()})})(x);(function(a){var l=\na.extend,h=a.pick,k=a.Pointer;a=a.wrap;l(k.prototype,{onContainerDblClick:function(a){var f=this.chart;a=this.normalize(a);f.options.mapNavigation.enableDoubleClickZoomTo?f.pointer.inClass(a.target,\"highcharts-tracker\")&&f.hoverPoint&&f.hoverPoint.zoomTo():f.isInsidePlot(a.chartX-f.plotLeft,a.chartY-f.plotTop)&&f.mapZoom(.5,f.xAxis[0].toValue(a.chartX),f.yAxis[0].toValue(a.chartY),a.chartX,a.chartY)},onContainerMouseWheel:function(a){var f=this.chart,g;a=this.normalize(a);g=a.detail||-(a.wheelDelta/\n120);f.isInsidePlot(a.chartX-f.plotLeft,a.chartY-f.plotTop)&&f.mapZoom(Math.pow(f.options.mapNavigation.mouseWheelSensitivity,g),f.xAxis[0].toValue(a.chartX),f.yAxis[0].toValue(a.chartY),a.chartX,a.chartY)}});a(k.prototype,\"zoomOption\",function(a){var f=this.chart.options.mapNavigation;h(f.enableTouchZoom,f.enabled)&&(this.chart.options.chart.pinchType=\"xy\");a.apply(this,[].slice.call(arguments,1))});a(k.prototype,\"pinchTranslate\",function(a,h,g,k,l,e,b){a.call(this,h,g,k,l,e,b);\"map\"===this.chart.options.chart.type&&\nthis.hasZoom&&(a=k.scaleX>k.scaleY,this.pinchTranslateDirection(!a,h,g,k,l,e,b,a?k.scaleX:k.scaleY))})})(x);(function(a){var l=a.colorPointMixin,h=a.each,k=a.extend,f=a.isNumber,q=a.map,g=a.merge,u=a.noop,t=a.pick,e=a.isArray,b=a.Point,d=a.Series,n=a.seriesType,r=a.seriesTypes,m=a.splat,v=void 0!==a.doc.documentElement.style.vectorEffect;n(\"map\",\"scatter\",{allAreas:!0,animation:!1,nullColor:\"#f7f7f7\",borderColor:\"#cccccc\",borderWidth:1,marker:null,stickyTracking:!1,joinBy:\"hc-key\",dataLabels:{formatter:function(){return this.point.value},\ninside:!0,verticalAlign:\"middle\",crop:!1,overflow:!1,padding:0},turboThreshold:0,tooltip:{followPointer:!0,pointFormat:\"{point.name}: {point.value}\\x3cbr/\\x3e\"},states:{normal:{animation:!0},hover:{halo:null,brightness:.2},select:{color:\"#cccccc\"}}},g(a.colorSeriesMixin,{type:\"map\",getExtremesFromAll:!0,useMapGeometry:!0,forceDL:!0,searchPoint:u,directTouch:!0,preserveAspectRatio:!0,pointArrayMap:[\"value\"],getBox:function(c){var b=Number.MAX_VALUE,d=-b,e=b,m=-b,v=b,n=b,g=this.xAxis,k=this.yAxis,q;\nh(c||[],function(c){if(c.path){\"string\"===typeof c.path&&(c.path=a.splitPath(c.path));var p=c.path||[],w=p.length,g=!1,h=-b,k=b,y=-b,r=b,A=c.properties;if(!c._foundBox){for(;w--;)f(p[w])&&(g?(h=Math.max(h,p[w]),k=Math.min(k,p[w])):(y=Math.max(y,p[w]),r=Math.min(r,p[w])),g=!g);c._midX=k+(h-k)*t(c.middleX,A&&A[\"hc-middle-x\"],.5);c._midY=r+(y-r)*t(c.middleY,A&&A[\"hc-middle-y\"],.5);c._maxX=h;c._minX=k;c._maxY=y;c._minY=r;c.labelrank=t(c.labelrank,(h-k)*(y-r));c._foundBox=!0}d=Math.max(d,c._maxX);e=Math.min(e,\nc._minX);m=Math.max(m,c._maxY);v=Math.min(v,c._minY);n=Math.min(c._maxX-c._minX,c._maxY-c._minY,n);q=!0}});q&&(this.minY=Math.min(v,t(this.minY,b)),this.maxY=Math.max(m,t(this.maxY,-b)),this.minX=Math.min(e,t(this.minX,b)),this.maxX=Math.max(d,t(this.maxX,-b)),g&&void 0===g.options.minRange&&(g.minRange=Math.min(5*n,(this.maxX-this.minX)/5,g.minRange||b)),k&&void 0===k.options.minRange&&(k.minRange=Math.min(5*n,(this.maxY-this.minY)/5,k.minRange||b)))},getExtremes:function(){d.prototype.getExtremes.call(this,\nthis.valueData);this.chart.hasRendered&&this.isDirtyData&&this.getBox(this.options.data);this.valueMin=this.dataMin;this.valueMax=this.dataMax;this.dataMin=this.minY;this.dataMax=this.maxY},translatePath:function(a){var c=!1,b=this.xAxis,d=this.yAxis,e=b.min,m=b.transA,b=b.minPixelPadding,v=d.min,n=d.transA,d=d.minPixelPadding,g,h=[];if(a)for(g=a.length;g--;)f(a[g])?(h[g]=c?(a[g]-e)*m+b:(a[g]-v)*n+d,c=!c):h[g]=a[g];return h},setData:function(c,b,v,n){var p=this.options,w=this.chart.options.chart,\nk=w&&w.map,r=p.mapData,l=p.joinBy,t=null===l,B=p.keys||this.pointArrayMap,u=[],x={},z=this.chart.mapTransforms;!r&&k&&(r=\"string\"===typeof k?a.maps[k]:k);t&&(l=\"_i\");l=this.joinBy=m(l);l[1]||(l[1]=l[0]);c&&h(c,function(b,d){var m=0;if(f(b))c[d]={value:b};else if(e(b)){c[d]={};!p.keys&&b.length>B.length&&\"string\"===typeof b[0]&&(c[d][\"hc-key\"]=b[0],++m);for(var v=0;v<B.length;++v,++m)B[v]&&void 0!==b[m]&&(0<B[v].indexOf(\".\")?a.Point.prototype.setNestedProperty(c[d],b[m],B[v]):c[d][B[v]]=b[m])}t&&(c[d]._i=\nd)});this.getBox(c);(this.chart.mapTransforms=z=w&&w.mapTransforms||r&&r[\"hc-transform\"]||z)&&a.objectEach(z,function(a){a.rotation&&(a.cosAngle=Math.cos(a.rotation),a.sinAngle=Math.sin(a.rotation))});if(r){\"FeatureCollection\"===r.type&&(this.mapTitle=r.title,r=a.geojson(r,this.type,this));this.mapData=r;this.mapMap={};for(z=0;z<r.length;z++)w=r[z],k=w.properties,w._i=z,l[0]&&k&&k[l[0]]&&(w[l[0]]=k[l[0]]),x[w[l[0]]]=w;this.mapMap=x;c&&l[1]&&h(c,function(a){x[a[l[1]]]&&u.push(x[a[l[1]]])});p.allAreas?\n(this.getBox(r),c=c||[],l[1]&&h(c,function(a){u.push(a[l[1]])}),u=\"|\"+q(u,function(a){return a&&a[l[0]]}).join(\"|\")+\"|\",h(r,function(a){l[0]&&-1!==u.indexOf(\"|\"+a[l[0]]+\"|\")||(c.push(g(a,{value:null})),n=!1)})):this.getBox(u)}d.prototype.setData.call(this,c,b,v,n)},drawGraph:u,drawDataLabels:u,doFullTranslate:function(){return this.isDirtyData||this.chart.isResizing||this.chart.renderer.isVML||!this.baseTrans},translate:function(){var a=this,b=a.xAxis,d=a.yAxis,e=a.doFullTranslate();a.generatePoints();\nh(a.data,function(c){c.plotX=b.toPixels(c._midX,!0);c.plotY=d.toPixels(c._midY,!0);e&&(c.shapeType=\"path\",c.shapeArgs={d:a.translatePath(c.path)})});a.translateColors()},pointAttribs:function(a,b){a=r.column.prototype.pointAttribs.call(this,a,b);v?a[\"vector-effect\"]=\"non-scaling-stroke\":a[\"stroke-width\"]=\"inherit\";return a},drawPoints:function(){var a=this,b=a.xAxis,d=a.yAxis,e=a.group,m=a.chart,f=m.renderer,g,n,k,l,q=this.baseTrans,t,u,z,x,G;a.transformGroup||(a.transformGroup=f.g().attr({scaleX:1,\nscaleY:1}).add(e),a.transformGroup.survive=!0);a.doFullTranslate()?(m.hasRendered&&h(a.points,function(b){b.shapeArgs&&(b.shapeArgs.fill=a.pointAttribs(b,b.state).fill)}),a.group=a.transformGroup,r.column.prototype.drawPoints.apply(a),a.group=e,h(a.points,function(a){a.graphic&&(a.name&&a.graphic.addClass(\"highcharts-name-\"+a.name.replace(/ /g,\"-\").toLowerCase()),a.properties&&a.properties[\"hc-key\"]&&a.graphic.addClass(\"highcharts-key-\"+a.properties[\"hc-key\"].toLowerCase()))}),this.baseTrans={originX:b.min-\nb.minPixelPadding/b.transA,originY:d.min-d.minPixelPadding/d.transA+(d.reversed?0:d.len/d.transA),transAX:b.transA,transAY:d.transA},this.transformGroup.animate({translateX:0,translateY:0,scaleX:1,scaleY:1})):(g=b.transA/q.transAX,n=d.transA/q.transAY,k=b.toPixels(q.originX,!0),l=d.toPixels(q.originY,!0),.99<g&&1.01>g&&.99<n&&1.01>n&&(n=g=1,k=Math.round(k),l=Math.round(l)),t=this.transformGroup,m.renderer.globalAnimation?(u=t.attr(\"translateX\"),z=t.attr(\"translateY\"),x=t.attr(\"scaleX\"),G=t.attr(\"scaleY\"),\nt.attr({animator:0}).animate({animator:1},{step:function(a,b){t.attr({translateX:u+(k-u)*b.pos,translateY:z+(l-z)*b.pos,scaleX:x+(g-x)*b.pos,scaleY:G+(n-G)*b.pos})}})):t.attr({translateX:k,translateY:l,scaleX:g,scaleY:n}));v||a.group.element.setAttribute(\"stroke-width\",a.options[a.pointAttrToOptions&&a.pointAttrToOptions[\"stroke-width\"]||\"borderWidth\"]/(g||1));this.drawMapDataLabels()},drawMapDataLabels:function(){d.prototype.drawDataLabels.call(this);this.dataLabelsGroup&&this.dataLabelsGroup.clip(this.chart.clipRect)},\nrender:function(){var a=this,b=d.prototype.render;a.chart.renderer.isVML&&3E3<a.data.length?setTimeout(function(){b.call(a)}):b.call(a)},animate:function(a){var b=this.options.animation,c=this.group,d=this.xAxis,e=this.yAxis,m=d.pos,f=e.pos;this.chart.renderer.isSVG&&(!0===b&&(b={duration:1E3}),a?c.attr({translateX:m+d.len/2,translateY:f+e.len/2,scaleX:.001,scaleY:.001}):(c.animate({translateX:m,translateY:f,scaleX:1,scaleY:1},b),this.animate=null))},animateDrilldown:function(a){var b=this.chart.plotBox,\nc=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],d=c.bBox,e=this.chart.options.drilldown.animation;a||(a=Math.min(d.width/b.width,d.height/b.height),c.shapeArgs={scaleX:a,scaleY:a,translateX:d.x,translateY:d.y},h(this.points,function(a){a.graphic&&a.graphic.attr(c.shapeArgs).animate({scaleX:1,scaleY:1,translateX:0,translateY:0},e)}),this.animate=null)},drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,animateDrillupFrom:function(a){r.column.prototype.animateDrillupFrom.call(this,\na)},animateDrillupTo:function(a){r.column.prototype.animateDrillupTo.call(this,a)}}),k({applyOptions:function(a,d){a=b.prototype.applyOptions.call(this,a,d);d=this.series;var c=d.joinBy;d.mapData&&((c=void 0!==a[c[1]]&&d.mapMap[a[c[1]]])?(d.xyFromShape&&(a.x=c._midX,a.y=c._midY),k(a,c)):a.value=a.value||null);return a},onMouseOver:function(c){a.clearTimeout(this.colorInterval);if(null!==this.value||this.series.options.nullInteraction)b.prototype.onMouseOver.call(this,c);else this.series.onMouseOut(c)},\nzoomTo:function(){var a=this.series;a.xAxis.setExtremes(this._minX,this._maxX,!1);a.yAxis.setExtremes(this._minY,this._maxY,!1);a.chart.redraw()}},l))})(x);(function(a){var l=a.seriesType,h=a.seriesTypes;l(\"mapline\",\"map\",{lineWidth:1,fillColor:\"none\"},{type:\"mapline\",colorProp:\"stroke\",pointAttrToOptions:{stroke:\"color\",\"stroke-width\":\"lineWidth\"},pointAttribs:function(a,f){a=h.map.prototype.pointAttribs.call(this,a,f);a.fill=this.options.fillColor;return a},drawLegendSymbol:h.line.prototype.drawLegendSymbol})})(x);\n(function(a){var l=a.merge,h=a.Point;a=a.seriesType;a(\"mappoint\",\"scatter\",{dataLabels:{enabled:!0,formatter:function(){return this.point.name},crop:!1,defer:!1,overflow:!1,style:{color:\"#000000\"}}},{type:\"mappoint\",forceDL:!0},{applyOptions:function(a,f){a=void 0!==a.lat&&void 0!==a.lon?l(a,this.series.chart.fromLatLonToPoint(a)):a;return h.prototype.applyOptions.call(this,a,f)}})})(x);(function(a){var l=a.arrayMax,h=a.arrayMin,k=a.Axis,f=a.color,q=a.each,g=a.isNumber,u=a.noop,t=a.pick,e=a.pInt,\nb=a.Point,d=a.Series,n=a.seriesType,r=a.seriesTypes;n(\"bubble\",\"scatter\",{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:\"middle\"},animationLimit:250,marker:{lineColor:null,lineWidth:1,fillOpacity:.5,radius:null,states:{hover:{radiusPlus:0}},symbol:\"circle\"},minSize:8,maxSize:\"20%\",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:\"({point.x}, {point.y}), Size: {point.z}\"},turboThreshold:0,zThreshold:0,zoneAxis:\"z\"},{pointArrayMap:[\"y\",\"z\"],parallelArrays:[\"x\",\n\"y\",\"z\"],trackerGroups:[\"group\",\"dataLabelsGroup\"],specialGroup:\"group\",bubblePadding:!0,zoneAxis:\"z\",directTouch:!0,pointAttribs:function(a,b){var c=this.options.marker.fillOpacity;a=d.prototype.pointAttribs.call(this,a,b);1!==c&&(a.fill=f(a.fill).setOpacity(c).get(\"rgba\"));return a},getRadii:function(a,b,c,d){var e,m,f,p=this.zData,g=[],n=this.options,v=\"width\"!==n.sizeBy,h=n.zThreshold,k=b-a;m=0;for(e=p.length;m<e;m++)f=p[m],n.sizeByAbsoluteValue&&null!==f&&(f=Math.abs(f-h),b=k=Math.max(b-h,Math.abs(a-\nh)),a=0),null===f?f=null:f<a?f=c/2-1:(f=0<k?(f-a)/k:.5,v&&0<=f&&(f=Math.sqrt(f)),f=Math.ceil(c+f*(d-c))/2),g.push(f);this.radii=g},animate:function(a){!a&&this.points.length<this.options.animationLimit&&(q(this.points,function(a){var b=a.graphic,d;b&&b.width&&(d={x:b.x,y:b.y,width:b.width,height:b.height},b.attr({x:a.plotX,y:a.plotY,width:1,height:1}),b.animate(d,this.options.animation))},this),this.animate=null)},translate:function(){var b,d=this.data,c,e,f=this.radii;r.scatter.prototype.translate.call(this);\nfor(b=d.length;b--;)c=d[b],e=f?f[b]:0,g(e)&&e>=this.minPxSize/2?(c.marker=a.extend(c.marker,{radius:e,width:2*e,height:2*e}),c.dlBox={x:c.plotX-e,y:c.plotY-e,width:2*e,height:2*e}):c.shapeArgs=c.plotY=c.dlBox=void 0},alignDataLabel:r.column.prototype.alignDataLabel,buildKDTree:u,applyZones:u},{haloPath:function(a){return b.prototype.haloPath.call(this,0===a?0:(this.marker?this.marker.radius||0:0)+a)},ttBelow:!1});k.prototype.beforePadding=function(){var a=this,b=this.len,c=this.chart,d=0,f=b,n=this.isXAxis,\nk=n?\"xData\":\"yData\",r=this.min,u={},x=Math.min(c.plotWidth,c.plotHeight),A=Number.MAX_VALUE,D=-Number.MAX_VALUE,E=this.max-r,C=b/E,F=[];q(this.series,function(b){var d=b.options;!b.bubblePadding||!b.visible&&c.options.chart.ignoreHiddenSeries||(a.allowZoomOutside=!0,F.push(b),n&&(q([\"minSize\",\"maxSize\"],function(a){var b=d[a],c=/%$/.test(b),b=e(b);u[a]=c?x*b/100:b}),b.minPxSize=u.minSize,b.maxPxSize=Math.max(u.maxSize,u.minSize),b=b.zData,b.length&&(A=t(d.zMin,Math.min(A,Math.max(h(b),!1===d.displayNegative?\nd.zThreshold:-Number.MAX_VALUE))),D=t(d.zMax,Math.max(D,l(b))))))});q(F,function(b){var c=b[k],e=c.length,m;n&&b.getRadii(A,D,b.minPxSize,b.maxPxSize);if(0<E)for(;e--;)g(c[e])&&a.dataMin<=c[e]&&c[e]<=a.dataMax&&(m=b.radii[e],d=Math.min((c[e]-r)*C-m,d),f=Math.max((c[e]-r)*C+m,f))});F.length&&0<E&&!this.isLog&&(f-=b,C*=(b+d-f)/b,q([[\"min\",\"userMin\",d],[\"max\",\"userMax\",f]],function(b){void 0===t(a.options[b[0]],a[b[1]])&&(a[b[0]]+=b[2]/C)}))}})(x);(function(a){var l=a.merge,h=a.Point,k=a.seriesType,\nf=a.seriesTypes;f.bubble&&k(\"mapbubble\",\"bubble\",{animationLimit:500,tooltip:{pointFormat:\"{point.name}: {point.z}\"}},{xyFromShape:!0,type:\"mapbubble\",pointArrayMap:[\"z\"],getMapData:f.map.prototype.getMapData,getBox:f.map.prototype.getBox,setData:f.map.prototype.setData},{applyOptions:function(a,g){return a&&void 0!==a.lat&&void 0!==a.lon?h.prototype.applyOptions.call(this,l(a,this.series.chart.fromLatLonToPoint(a)),g):f.map.prototype.pointClass.prototype.applyOptions.call(this,a,g)},isValid:function(){return\"number\"===\ntypeof this.z},ttBelow:!1})})(x);(function(a){var l=a.colorPointMixin,h=a.each,k=a.merge,f=a.noop,q=a.pick,g=a.Series,u=a.seriesType,t=a.seriesTypes;u(\"heatmap\",\"scatter\",{animation:!1,borderWidth:0,nullColor:\"#f7f7f7\",dataLabels:{formatter:function(){return this.point.value},inside:!0,verticalAlign:\"middle\",crop:!1,overflow:!1,padding:0},marker:null,pointRange:null,tooltip:{pointFormat:\"{point.x}, {point.y}: {point.value}\\x3cbr/\\x3e\"},states:{hover:{halo:!1,brightness:.2}}},k(a.colorSeriesMixin,\n{pointArrayMap:[\"y\",\"value\"],hasPointSpecificOptions:!0,getExtremesFromAll:!0,directTouch:!0,init:function(){var a;t.scatter.prototype.init.apply(this,arguments);a=this.options;a.pointRange=q(a.pointRange,a.colsize||1);this.yAxis.axisPointRange=a.rowsize||1},translate:function(){var a=this.options,b=this.xAxis,d=this.yAxis,f=a.pointPadding||0,g=function(a,b,c){return Math.min(Math.max(b,a),c)};this.generatePoints();h(this.points,function(e){var n=(a.colsize||1)/2,c=(a.rowsize||1)/2,m=g(Math.round(b.len-\nb.translate(e.x-n,0,1,0,1)),-b.len,2*b.len),n=g(Math.round(b.len-b.translate(e.x+n,0,1,0,1)),-b.len,2*b.len),h=g(Math.round(d.translate(e.y-c,0,1,0,1)),-d.len,2*d.len),c=g(Math.round(d.translate(e.y+c,0,1,0,1)),-d.len,2*d.len),k=q(e.pointPadding,f);e.plotX=e.clientX=(m+n)/2;e.plotY=(h+c)/2;e.shapeType=\"rect\";e.shapeArgs={x:Math.min(m,n)+k,y:Math.min(h,c)+k,width:Math.abs(n-m)-2*k,height:Math.abs(c-h)-2*k}});this.translateColors()},drawPoints:function(){t.column.prototype.drawPoints.call(this);h(this.points,\nfunction(a){a.graphic.attr(this.colorAttribs(a))},this)},animate:f,getBox:f,drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,alignDataLabel:t.column.prototype.alignDataLabel,getExtremes:function(){g.prototype.getExtremes.call(this,this.valueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;g.prototype.getExtremes.call(this)}}),a.extend({haloPath:function(a){if(!a)return[];var b=this.shapeArgs;return[\"M\",b.x-a,b.y-a,\"L\",b.x-a,b.y+b.height+a,b.x+b.width+a,b.y+b.height+a,b.x+b.width+a,b.y-\na,\"Z\"]}},l))})(x);(function(a){function l(a,b){var d,e,f,g=!1,h=a.x,c=a.y;a=0;for(d=b.length-1;a<b.length;d=a++)e=b[a][1]>c,f=b[d][1]>c,e!==f&&h<(b[d][0]-b[a][0])*(c-b[a][1])/(b[d][1]-b[a][1])+b[a][0]&&(g=!g);return g}var h=a.Chart,k=a.each,f=a.extend,q=a.format,g=a.merge,u=a.win,t=a.wrap;h.prototype.transformFromLatLon=function(e,b){if(void 0===u.proj4)return a.error(21),{x:0,y:null};e=u.proj4(b.crs,[e.lon,e.lat]);var d=b.cosAngle||b.rotation&&Math.cos(b.rotation),f=b.sinAngle||b.rotation&&Math.sin(b.rotation);\ne=b.rotation?[e[0]*d+e[1]*f,-e[0]*f+e[1]*d]:e;return{x:((e[0]-(b.xoffset||0))*(b.scale||1)+(b.xpan||0))*(b.jsonres||1)+(b.jsonmarginX||0),y:(((b.yoffset||0)-e[1])*(b.scale||1)+(b.ypan||0))*(b.jsonres||1)-(b.jsonmarginY||0)}};h.prototype.transformToLatLon=function(e,b){if(void 0===u.proj4)a.error(21);else{e={x:((e.x-(b.jsonmarginX||0))/(b.jsonres||1)-(b.xpan||0))/(b.scale||1)+(b.xoffset||0),y:((-e.y-(b.jsonmarginY||0))/(b.jsonres||1)+(b.ypan||0))/(b.scale||1)+(b.yoffset||0)};var d=b.cosAngle||b.rotation&&\nMath.cos(b.rotation),f=b.sinAngle||b.rotation&&Math.sin(b.rotation);b=u.proj4(b.crs,\"WGS84\",b.rotation?{x:e.x*d+e.y*-f,y:e.x*f+e.y*d}:e);return{lat:b.y,lon:b.x}}};h.prototype.fromPointToLatLon=function(e){var b=this.mapTransforms,d;if(b){for(d in b)if(b.hasOwnProperty(d)&&b[d].hitZone&&l({x:e.x,y:-e.y},b[d].hitZone.coordinates[0]))return this.transformToLatLon(e,b[d]);return this.transformToLatLon(e,b[\"default\"])}a.error(22)};h.prototype.fromLatLonToPoint=function(e){var b=this.mapTransforms,d,f;\nif(!b)return a.error(22),{x:0,y:null};for(d in b)if(b.hasOwnProperty(d)&&b[d].hitZone&&(f=this.transformFromLatLon(e,b[d]),l({x:f.x,y:-f.y},b[d].hitZone.coordinates[0])))return f;return this.transformFromLatLon(e,b[\"default\"])};a.geojson=function(a,b,d){var e=[],g=[],h=function(a){var b,d=a.length;g.push(\"M\");for(b=0;b<d;b++)1===b&&g.push(\"L\"),g.push(a[b][0],-a[b][1])};b=b||\"map\";k(a.features,function(a){var d=a.geometry,n=d.type,d=d.coordinates;a=a.properties;var m;g=[];\"map\"===b||\"mapbubble\"===\nb?(\"Polygon\"===n?(k(d,h),g.push(\"Z\")):\"MultiPolygon\"===n&&(k(d,function(a){k(a,h)}),g.push(\"Z\")),g.length&&(m={path:g})):\"mapline\"===b?(\"LineString\"===n?h(d):\"MultiLineString\"===n&&k(d,h),g.length&&(m={path:g})):\"mappoint\"===b&&\"Point\"===n&&(m={x:d[0],y:-d[1]});m&&e.push(f(m,{name:a.name||a.NAME,properties:a}))});d&&a.copyrightShort&&(d.chart.mapCredits=q(d.chart.options.credits.mapText,{geojson:a}),d.chart.mapCreditsFull=q(d.chart.options.credits.mapTextFull,{geojson:a}));return e};t(h.prototype,\n\"addCredits\",function(a,b){b=g(!0,this.options.credits,b);this.mapCredits&&(b.href=null);a.call(this,b);this.credits&&this.mapCreditsFull&&this.credits.attr({title:this.mapCreditsFull})})})(x);(function(a){function l(a,b,e,f,g,c,h,k){return[\"M\",a+g,b,\"L\",a+e-c,b,\"C\",a+e-c/2,b,a+e,b+c/2,a+e,b+c,\"L\",a+e,b+f-h,\"C\",a+e,b+f-h/2,a+e-h/2,b+f,a+e-h,b+f,\"L\",a+k,b+f,\"C\",a+k/2,b+f,a,b+f-k/2,a,b+f-k,\"L\",a,b+g,\"C\",a,b+g/2,a+g/2,b,a+g,b,\"Z\"]}var h=a.Chart,k=a.defaultOptions,f=a.each,q=a.extend,g=a.merge,u=a.pick,\nt=a.Renderer,e=a.SVGRenderer,b=a.VMLRenderer;q(k.lang,{zoomIn:\"Zoom in\",zoomOut:\"Zoom out\"});k.mapNavigation={buttonOptions:{alignTo:\"plotBox\",align:\"left\",verticalAlign:\"top\",x:0,width:18,height:18,padding:5,style:{fontSize:\"15px\",fontWeight:\"bold\"},theme:{\"stroke-width\":1,\"text-align\":\"center\"}},buttons:{zoomIn:{onclick:function(){this.mapZoom(.5)},text:\"+\",y:0},zoomOut:{onclick:function(){this.mapZoom(2)},text:\"-\",y:28}},mouseWheelSensitivity:1.1};a.splitPath=function(a){var b;a=a.replace(/([A-Za-z])/g,\n\" $1 \");a=a.replace(/^\\s*/,\"\").replace(/\\s*$/,\"\");a=a.split(/[ ,]+/);for(b=0;b<a.length;b++)/[a-zA-Z]/.test(a[b])||(a[b]=parseFloat(a[b]));return a};a.maps={};e.prototype.symbols.topbutton=function(a,b,e,f,g){return l(a-1,b-1,e,f,g.r,g.r,0,0)};e.prototype.symbols.bottombutton=function(a,b,e,f,g){return l(a-1,b-1,e,f,0,0,g.r,g.r)};t===b&&f([\"topbutton\",\"bottombutton\"],function(a){b.prototype.symbols[a]=e.prototype.symbols[a]});a.Map=a.mapChart=function(b,e,f){var d=\"string\"===typeof b||b.nodeName,\nk=arguments[d?1:0],c={endOnTick:!1,visible:!1,minPadding:0,maxPadding:0,startOnTick:!1},l,n=a.getOptions().credits;l=k.series;k.series=null;k=g({chart:{panning:\"xy\",type:\"map\"},credits:{mapText:u(n.mapText,' \\u00a9 \\x3ca href\\x3d\"{geojson.copyrightUrl}\"\\x3e{geojson.copyrightShort}\\x3c/a\\x3e'),mapTextFull:u(n.mapTextFull,\"{geojson.copyright}\")},tooltip:{followTouchMove:!1},xAxis:c,yAxis:g(c,{reversed:!0})},k,{chart:{inverted:!1,alignTicks:!1}});k.series=l;return d?new h(b,k,f):new h(k,e)}})(x)});\n","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n\r\n (c) 2009-2016 Torstein Honsi\r\n\r\n License: www.highcharts.com/license\r\n*/\r\n(function(w){\"object\"===typeof module&&module.exports?module.exports=w:w(Highcharts)})(function(w){(function(b){function r(b,a){this.init(b,a)}var v=b.CenteredSeriesMixin,u=b.each,n=b.extend,q=b.merge,g=b.splat;n(r.prototype,{coll:\"pane\",init:function(b,a){this.chart=a;this.background=[];a.pane.push(this);this.setOptions(b)},setOptions:function(b){this.options=q(this.defaultOptions,this.chart.angular?{background:{}}:void 0,b)},render:function(){var b=this.options,a=this.options.background,c=this.chart.renderer;\r\nthis.group||(this.group=c.g(\"pane-group\").attr({zIndex:b.zIndex||0}).add());this.updateCenter();if(a)for(a=g(a),b=Math.max(a.length,this.background.length||0),c=0;c<b;c++)a[c]&&this.axis?this.renderBackground(q(this.defaultBackgroundOptions,a[c]),c):this.background[c]&&(this.background[c]=this.background[c].destroy(),this.background.splice(c,1))},renderBackground:function(b,a){var c=\"animate\";this.background[a]||(this.background[a]=this.chart.renderer.path().add(this.group),c=\"attr\");this.background[a][c]({d:this.axis.getPlotBandPath(b.from,\r\nb.to,b)}).attr({fill:b.backgroundColor,stroke:b.borderColor,\"stroke-width\":b.borderWidth,\"class\":\"highcharts-pane \"+(b.className||\"\")})},defaultOptions:{center:[\"50%\",\"50%\"],size:\"85%\",startAngle:0},defaultBackgroundOptions:{shape:\"circle\",borderWidth:1,borderColor:\"#cccccc\",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,\"#ffffff\"],[1,\"#e6e6e6\"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:\"105%\"},updateCenter:function(b){this.center=(b||this.axis||{}).center=\r\nv.getCenter.call(this)},update:function(b,a){q(!0,this.options,b);this.setOptions(this.options);this.render();u(this.chart.axes,function(c){c.pane===this&&(c.pane=null,c.update({},a))},this)}});b.Pane=r})(w);(function(b){var r=b.addEvent,v=b.Axis,u=b.each,n=b.extend,q=b.map,g=b.merge,l=b.noop,a=b.pick,c=b.pInt,d=b.Tick,k=b.wrap,f=b.correctFloat,e,p,t=v.prototype,h=d.prototype;b.radialAxisExtended||(b.radialAxisExtended=!0,e={getOffset:l,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=\r\n!1},setScale:l,setCategories:l,setTitle:l},p={defaultRadialGaugeOptions:{labels:{align:\"center\",x:0,y:null},minorGridLineWidth:0,minorTickInterval:\"auto\",minorTickLength:10,minorTickPosition:\"inside\",minorTickWidth:1,tickLength:10,tickPosition:\"inside\",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null,style:{textOverflow:\"none\"}},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:\"circle\",\r\nlabels:{align:\"right\",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(a){a=this.options=g(this.defaultOptions,this.defaultRadialOptions,a);a.plotBands||(a.plotBands=[])},getOffset:function(){t.getOffset.call(this);this.chart.axisOffset[this.side]=0},getLinePath:function(c,d){c=this.center;var m=this.chart,e=a(d,c[2]/2-this.offset);this.isCircular||void 0!==d?(d=this.chart.renderer.symbols.arc(this.left+c[0],this.top+c[1],e,e,{start:this.startAngleRad,end:this.endAngleRad,\r\nopen:!0,innerR:0}),d.xBounds=[this.left+c[0]],d.yBounds=[this.top+c[1]-e]):(d=this.postTranslate(this.angleRad,e),d=[\"M\",c[0]+m.plotLeft,c[1]+m.plotTop,\"L\",d.x,d.y]);return d},setAxisTranslation:function(){t.setAxisTranslation.call(this);this.center&&(this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0)},beforeSetTickPositions:function(){if(this.autoConnect=\r\nthis.isCircular&&void 0===a(this.userMax,this.options.max)&&f(this.endAngleRad-this.startAngleRad)===f(2*Math.PI))this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0},setAxisSize:function(){t.setAxisSize.call(this);this.isRadial&&(this.pane.updateCenter(this),this.isCircular&&(this.sector=this.endAngleRad-this.startAngleRad),this.len=this.width=this.height=this.center[2]*a(this.sector,1)/2)},getPosition:function(c,d){return this.postTranslate(this.isCircular?this.translate(c):\r\nthis.angleRad,a(this.isCircular?d:this.translate(c),this.center[2]/2)-this.offset)},postTranslate:function(a,c){var d=this.chart,e=this.center;a=this.startAngleRad+a;return{x:d.plotLeft+e[0]+Math.cos(a)*c,y:d.plotTop+e[1]+Math.sin(a)*c}},getPlotBandPath:function(d,e,b){var f=this.center,m=this.startAngleRad,k=f[2]/2,h=[a(b.outerRadius,\"100%\"),b.innerRadius,a(b.thickness,10)],p=Math.min(this.offset,0),x=/%$/,t,B=this.isCircular;\"polygon\"===this.options.gridLineInterpolation?f=this.getPlotLinePath(d).concat(this.getPlotLinePath(e,\r\n!0)):(d=Math.max(d,this.min),e=Math.min(e,this.max),B||(h[0]=this.translate(d),h[1]=this.translate(e)),h=q(h,function(a){x.test(a)&&(a=c(a,10)*k/100);return a}),\"circle\"!==b.shape&&B?(d=m+this.translate(d),e=m+this.translate(e)):(d=-Math.PI/2,e=1.5*Math.PI,t=!0),h[0]-=p,h[2]-=p,f=this.chart.renderer.symbols.arc(this.left+f[0],this.top+f[1],h[0],h[0],{start:Math.min(d,e),end:Math.max(d,e),innerR:a(h[1],h[0]-h[2]),open:t}));return f},getPlotLinePath:function(a,c){var d=this,e=d.center,f=d.chart,b=d.getPosition(a),\r\nh,m,k;d.isCircular?k=[\"M\",e[0]+f.plotLeft,e[1]+f.plotTop,\"L\",b.x,b.y]:\"circle\"===d.options.gridLineInterpolation?(a=d.translate(a))&&(k=d.getLinePath(0,a)):(u(f.xAxis,function(a){a.pane===d.pane&&(h=a)}),k=[],a=d.translate(a),e=h.tickPositions,h.autoConnect&&(e=e.concat([e[0]])),c&&(e=[].concat(e).reverse()),u(e,function(c,d){m=h.getPosition(c,a);k.push(d?\"L\":\"M\",m.x,m.y)}));return k},getTitlePosition:function(){var a=this.center,c=this.chart,d=this.options.title;return{x:c.plotLeft+a[0]+(d.x||0),\r\ny:c.plotTop+a[1]-{high:.5,middle:.25,low:0}[d.align]*a[2]+(d.y||0)}}},r(v,\"init\",function(a){var c=this.chart,d=c.angular,f=c.polar,b=this.isXAxis,h=d&&b,k,m=c.options;a=a.userOptions.pane||0;a=this.pane=c.pane&&c.pane[a];if(d){if(n(this,h?e:p),k=!b)this.defaultRadialOptions=this.defaultRadialGaugeOptions}else f&&(n(this,p),this.defaultRadialOptions=(k=b)?this.defaultRadialXOptions:g(this.defaultYAxisOptions,this.defaultRadialYOptions));d||f?(this.isRadial=!0,c.inverted=!1,m.chart.zoomType=null):\r\nthis.isRadial=!1;a&&k&&(a.axis=this);this.isCircular=k}),r(v,\"afterInit\",function(){var c=this.chart,d=this.options,e=this.pane,f=e&&e.options;c.angular&&this.isXAxis||!e||!c.angular&&!c.polar||(this.angleRad=(d.angle||0)*Math.PI/180,this.startAngleRad=(f.startAngle-90)*Math.PI/180,this.endAngleRad=(a(f.endAngle,f.startAngle+360)-90)*Math.PI/180,this.offset=d.offset||0)}),k(t,\"autoLabelAlign\",function(a){if(!this.isRadial)return a.apply(this,[].slice.call(arguments,1))}),r(d,\"afterGetPosition\",function(a){this.axis.getPosition&&\r\nn(a.pos,this.axis.getPosition(this.pos))}),r(d,\"afterGetLabelPosition\",function(c){var d=this.axis,e=this.label,f=d.options.labels,b=f.y,h,k=20,p=f.align,m=(d.translate(this.pos)+d.startAngleRad+Math.PI/2)/Math.PI*180%360;d.isRadial&&(h=d.getPosition(this.pos,d.center[2]/2+a(f.distance,-25)),\"auto\"===f.rotation?e.attr({rotation:m}):null===b&&(b=d.chart.renderer.fontMetrics(e.styles&&e.styles.fontSize).b-e.getBBox().height/2),null===p&&(d.isCircular?(this.label.getBBox().width>d.len*d.tickInterval/\r\n(d.max-d.min)&&(k=0),p=m>k&&m<180-k?\"left\":m>180+k&&m<360-k?\"right\":\"center\"):p=\"center\",e.attr({align:p})),c.pos.x=h.x+f.x,c.pos.y=h.y+b)}),k(h,\"getMarkPath\",function(a,c,d,e,f,b,h){var k=this.axis;k.isRadial?(a=k.getPosition(this.pos,k.center[2]/2+e),c=[\"M\",c,d,\"L\",a.x,a.y]):c=a.call(this,c,d,e,f,b,h);return c}))})(w);(function(b){var r=b.each,v=b.pick,u=b.defined,n=b.seriesType,q=b.seriesTypes,g=b.Series.prototype,l=b.Point.prototype;n(\"arearange\",\"area\",{lineWidth:1,threshold:null,tooltip:{pointFormat:'\\x3cspan style\\x3d\"color:{series.color}\"\\x3e\\u25cf\\x3c/span\\x3e {series.name}: \\x3cb\\x3e{point.low}\\x3c/b\\x3e - \\x3cb\\x3e{point.high}\\x3c/b\\x3e\\x3cbr/\\x3e'},\r\ntrackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0}},{pointArrayMap:[\"low\",\"high\"],dataLabelCollections:[\"dataLabel\",\"dataLabelUpper\"],toYData:function(a){return[a.low,a.high]},pointValKey:\"low\",deferTranslatePolar:!0,highToXY:function(a){var c=this.chart,d=this.xAxis.postTranslate(a.rectPlotX,this.yAxis.len-a.plotHigh);a.plotHighX=d.x-c.plotLeft;a.plotHigh=d.y-c.plotTop;a.plotLowX=a.plotX},translate:function(){var a=this,c=a.yAxis,d=!!a.modifyValue;q.area.prototype.translate.apply(a);\r\nr(a.points,function(b){var f=b.low,e=b.high,k=b.plotY;null===e||null===f?(b.isNull=!0,b.plotY=null):(b.plotLow=k,b.plotHigh=c.translate(d?a.modifyValue(e,b):e,0,1,0,1),d&&(b.yBottom=b.plotHigh))});this.chart.polar&&r(this.points,function(c){a.highToXY(c);c.tooltipPos=[(c.plotHighX+c.plotLowX)/2,(c.plotHigh+c.plotLow)/2]})},getGraphPath:function(a){var c=[],d=[],b,f=q.area.prototype.getGraphPath,e,p,t;t=this.options;var h=this.chart.polar&&!1!==t.connectEnds,m=t.connectNulls,x=t.step;a=a||this.points;\r\nfor(b=a.length;b--;)e=a[b],e.isNull||h||m||a[b+1]&&!a[b+1].isNull||d.push({plotX:e.plotX,plotY:e.plotY,doCurve:!1}),p={polarPlotY:e.polarPlotY,rectPlotX:e.rectPlotX,yBottom:e.yBottom,plotX:v(e.plotHighX,e.plotX),plotY:e.plotHigh,isNull:e.isNull},d.push(p),c.push(p),e.isNull||h||m||a[b-1]&&!a[b-1].isNull||d.push({plotX:e.plotX,plotY:e.plotY,doCurve:!1});a=f.call(this,a);x&&(!0===x&&(x=\"left\"),t.step={left:\"right\",center:\"center\",right:\"left\"}[x]);c=f.call(this,c);d=f.call(this,d);t.step=x;t=[].concat(a,\r\nc);this.chart.polar||\"M\"!==d[0]||(d[0]=\"L\");this.graphPath=t;this.areaPath=a.concat(d);t.isArea=!0;t.xMap=a.xMap;this.areaPath.xMap=a.xMap;return t},drawDataLabels:function(){var a=this.data,c=a.length,d,b=[],f=this.options.dataLabels,e=f.align,p=f.verticalAlign,t=f.inside,h,m,x=this.chart.inverted;if(f.enabled||this._hasPointLabels){for(d=c;d--;)if(h=a[d])m=t?h.plotHigh<h.plotLow:h.plotHigh>h.plotLow,h.y=h.high,h._plotY=h.plotY,h.plotY=h.plotHigh,b[d]=h.dataLabel,h.dataLabel=h.dataLabelUpper,h.below=\r\nm,x?e||(f.align=m?\"right\":\"left\"):p||(f.verticalAlign=m?\"top\":\"bottom\"),f.x=f.xHigh,f.y=f.yHigh;g.drawDataLabels&&g.drawDataLabels.apply(this,arguments);for(d=c;d--;)if(h=a[d])m=t?h.plotHigh<h.plotLow:h.plotHigh>h.plotLow,h.dataLabelUpper=h.dataLabel,h.dataLabel=b[d],h.y=h.low,h.plotY=h._plotY,h.below=!m,x?e||(f.align=m?\"left\":\"right\"):p||(f.verticalAlign=m?\"bottom\":\"top\"),f.x=f.xLow,f.y=f.yLow;g.drawDataLabels&&g.drawDataLabels.apply(this,arguments)}f.align=e;f.verticalAlign=p},alignDataLabel:function(){q.column.prototype.alignDataLabel.apply(this,\r\narguments)},drawPoints:function(){var a=this.points.length,c,d;g.drawPoints.apply(this,arguments);for(d=0;d<a;)c=this.points[d],c.origProps={plotY:c.plotY,plotX:c.plotX,isInside:c.isInside,negative:c.negative,zone:c.zone,y:c.y},c.lowerGraphic=c.graphic,c.graphic=c.upperGraphic,c.plotY=c.plotHigh,u(c.plotHighX)&&(c.plotX=c.plotHighX),c.y=c.high,c.negative=c.high<(this.options.threshold||0),c.zone=this.zones.length&&c.getZone(),this.chart.polar||(c.isInside=c.isTopInside=void 0!==c.plotY&&0<=c.plotY&&\r\nc.plotY<=this.yAxis.len&&0<=c.plotX&&c.plotX<=this.xAxis.len),d++;g.drawPoints.apply(this,arguments);for(d=0;d<a;)c=this.points[d],c.upperGraphic=c.graphic,c.graphic=c.lowerGraphic,b.extend(c,c.origProps),delete c.origProps,d++},setStackedPoints:b.noop},{setState:function(){var a=this.state,c=this.series,d=c.chart.polar;u(this.plotHigh)||(this.plotHigh=c.yAxis.toPixels(this.high,!0));u(this.plotLow)||(this.plotLow=this.plotY=c.yAxis.toPixels(this.low,!0));c.stateMarkerGraphic&&(c.lowerStateMarkerGraphic=\r\nc.stateMarkerGraphic,c.stateMarkerGraphic=c.upperStateMarkerGraphic);this.graphic=this.upperGraphic;this.plotY=this.plotHigh;d&&(this.plotX=this.plotHighX);l.setState.apply(this,arguments);this.state=a;this.plotY=this.plotLow;this.graphic=this.lowerGraphic;d&&(this.plotX=this.plotLowX);c.stateMarkerGraphic&&(c.upperStateMarkerGraphic=c.stateMarkerGraphic,c.stateMarkerGraphic=c.lowerStateMarkerGraphic,c.lowerStateMarkerGraphic=void 0);l.setState.apply(this,arguments)},haloPath:function(){var a=this.series.chart.polar,\r\nc=[];this.plotY=this.plotLow;a&&(this.plotX=this.plotLowX);this.isInside&&(c=l.haloPath.apply(this,arguments));this.plotY=this.plotHigh;a&&(this.plotX=this.plotHighX);this.isTopInside&&(c=c.concat(l.haloPath.apply(this,arguments)));return c},destroyElements:function(){r([\"lowerGraphic\",\"upperGraphic\"],function(a){this[a]&&(this[a]=this[a].destroy())},this);this.graphic=null;return l.destroyElements.apply(this,arguments)}})})(w);(function(b){var r=b.seriesType;r(\"areasplinerange\",\"arearange\",null,\r\n{getPointSpline:b.seriesTypes.spline.prototype.getPointSpline})})(w);(function(b){var r=b.defaultPlotOptions,v=b.each,u=b.merge,n=b.noop,q=b.pick,g=b.seriesType,l=b.seriesTypes.column.prototype;g(\"columnrange\",\"arearange\",u(r.column,r.arearange,{pointRange:null,marker:null,states:{hover:{halo:!1}}}),{translate:function(){var a=this,c=a.yAxis,d=a.xAxis,b=d.startAngleRad,f,e=a.chart,p=a.xAxis.isRadial,t=Math.max(e.chartWidth,e.chartHeight)+999,h;l.translate.apply(a);v(a.points,function(k){var m=k.shapeArgs,\r\nl=a.options.minPointLength,y,g;k.plotHigh=h=Math.min(Math.max(-t,c.translate(k.high,0,1,0,1)),t);k.plotLow=Math.min(Math.max(-t,k.plotY),t);g=h;y=q(k.rectPlotY,k.plotY)-h;Math.abs(y)<l?(l-=y,y+=l,g-=l/2):0>y&&(y*=-1,g-=y);p?(f=k.barX+b,k.shapeType=\"path\",k.shapeArgs={d:a.polarArc(g+y,g,f,f+k.pointWidth)}):(m.height=y,m.y=g,k.tooltipPos=e.inverted?[c.len+c.pos-e.plotLeft-g-y/2,d.len+d.pos-e.plotTop-m.x-m.width/2,y]:[d.left-e.plotLeft+m.x+m.width/2,c.pos-e.plotTop+g+y/2,y])})},directTouch:!0,trackerGroups:[\"group\",\r\n\"dataLabelsGroup\"],drawGraph:n,getSymbol:n,crispCol:l.crispCol,drawPoints:l.drawPoints,drawTracker:l.drawTracker,getColumnMetrics:l.getColumnMetrics,pointAttribs:l.pointAttribs,animate:function(){return l.animate.apply(this,arguments)},polarArc:function(){return l.polarArc.apply(this,arguments)},translate3dPoints:function(){return l.translate3dPoints.apply(this,arguments)},translate3dShapes:function(){return l.translate3dShapes.apply(this,arguments)}},{setState:l.pointClass.prototype.setState})})(w);\r\n(function(b){var r=b.each,v=b.isNumber,u=b.merge,n=b.pick,q=b.pInt,g=b.Series,l=b.seriesType,a=b.TrackerMixin;l(\"gauge\",\"line\",{dataLabels:{enabled:!0,defer:!1,y:15,borderRadius:3,crop:!1,verticalAlign:\"top\",zIndex:2,borderWidth:1,borderColor:\"#cccccc\"},dial:{},pivot:{},tooltip:{headerFormat:\"\"},showInLegend:!1},{angular:!0,directTouch:!0,drawGraph:b.noop,fixedBox:!0,forceDL:!0,noSharedTooltip:!0,trackerGroups:[\"group\",\"dataLabelsGroup\"],translate:function(){var a=this.yAxis,d=this.options,b=a.center;\r\nthis.generatePoints();r(this.points,function(c){var e=u(d.dial,c.dial),f=q(n(e.radius,80))*b[2]/200,k=q(n(e.baseLength,70))*f/100,h=q(n(e.rearLength,10))*f/100,m=e.baseWidth||3,x=e.topWidth||1,g=d.overshoot,l=a.startAngleRad+a.translate(c.y,null,null,null,!0);v(g)?(g=g/180*Math.PI,l=Math.max(a.startAngleRad-g,Math.min(a.endAngleRad+g,l))):!1===d.wrap&&(l=Math.max(a.startAngleRad,Math.min(a.endAngleRad,l)));l=180*l/Math.PI;c.shapeType=\"path\";c.shapeArgs={d:e.path||[\"M\",-h,-m/2,\"L\",k,-m/2,f,-x/2,f,\r\nx/2,k,m/2,-h,m/2,\"z\"],translateX:b[0],translateY:b[1],rotation:l};c.plotX=b[0];c.plotY=b[1]})},drawPoints:function(){var a=this,d=a.yAxis.center,b=a.pivot,f=a.options,e=f.pivot,p=a.chart.renderer;r(a.points,function(c){var d=c.graphic,b=c.shapeArgs,e=b.d,k=u(f.dial,c.dial);d?(d.animate(b),b.d=e):(c.graphic=p[c.shapeType](b).attr({rotation:b.rotation,zIndex:1}).addClass(\"highcharts-dial\").add(a.group),c.graphic.attr({stroke:k.borderColor||\"none\",\"stroke-width\":k.borderWidth||0,fill:k.backgroundColor||\r\n\"#000000\"}))});b?b.animate({translateX:d[0],translateY:d[1]}):(a.pivot=p.circle(0,0,n(e.radius,5)).attr({zIndex:2}).addClass(\"highcharts-pivot\").translate(d[0],d[1]).add(a.group),a.pivot.attr({\"stroke-width\":e.borderWidth||0,stroke:e.borderColor||\"#cccccc\",fill:e.backgroundColor||\"#000000\"}))},animate:function(a){var c=this;a||(r(c.points,function(a){var d=a.graphic;d&&(d.attr({rotation:180*c.yAxis.startAngleRad/Math.PI}),d.animate({rotation:a.shapeArgs.rotation},c.options.animation))}),c.animate=\r\nnull)},render:function(){this.group=this.plotGroup(\"group\",\"series\",this.visible?\"visible\":\"hidden\",this.options.zIndex,this.chart.seriesGroup);g.prototype.render.call(this);this.group.clip(this.chart.clipRect)},setData:function(a,d){g.prototype.setData.call(this,a,!1);this.processData();this.generatePoints();n(d,!0)&&this.chart.redraw()},drawTracker:a&&a.drawTrackerPoint},{setState:function(a){this.state=a}})})(w);(function(b){var r=b.each,v=b.noop,u=b.pick,n=b.seriesType,q=b.seriesTypes;n(\"boxplot\",\r\n\"column\",{threshold:null,tooltip:{pointFormat:'\\x3cspan style\\x3d\"color:{point.color}\"\\x3e\\u25cf\\x3c/span\\x3e \\x3cb\\x3e {series.name}\\x3c/b\\x3e\\x3cbr/\\x3eMaximum: {point.high}\\x3cbr/\\x3eUpper quartile: {point.q3}\\x3cbr/\\x3eMedian: {point.median}\\x3cbr/\\x3eLower quartile: {point.q1}\\x3cbr/\\x3eMinimum: {point.low}\\x3cbr/\\x3e'},whiskerLength:\"50%\",fillColor:\"#ffffff\",lineWidth:1,medianWidth:2,whiskerWidth:2},{pointArrayMap:[\"low\",\"q1\",\"median\",\"q3\",\"high\"],toYData:function(b){return[b.low,b.q1,b.median,\r\nb.q3,b.high]},pointValKey:\"high\",pointAttribs:function(){return{}},drawDataLabels:v,translate:function(){var b=this.yAxis,l=this.pointArrayMap;q.column.prototype.translate.apply(this);r(this.points,function(a){r(l,function(c){null!==a[c]&&(a[c+\"Plot\"]=b.translate(a[c],0,1,0,1))})})},drawPoints:function(){var b=this,l=b.options,a=b.chart.renderer,c,d,k,f,e,p,t=0,h,m,x,q,n=!1!==b.doQuartiles,v,A=b.options.whiskerLength;r(b.points,function(g){var r=g.graphic,y=r?\"animate\":\"attr\",B=g.shapeArgs,w={},D=\r\n{},J={},K={},C=g.color||b.color;void 0!==g.plotY&&(h=B.width,m=Math.floor(B.x),x=m+h,q=Math.round(h/2),c=Math.floor(n?g.q1Plot:g.lowPlot),d=Math.floor(n?g.q3Plot:g.lowPlot),k=Math.floor(g.highPlot),f=Math.floor(g.lowPlot),r||(g.graphic=r=a.g(\"point\").add(b.group),g.stem=a.path().addClass(\"highcharts-boxplot-stem\").add(r),A&&(g.whiskers=a.path().addClass(\"highcharts-boxplot-whisker\").add(r)),n&&(g.box=a.path(void 0).addClass(\"highcharts-boxplot-box\").add(r)),g.medianShape=a.path(void 0).addClass(\"highcharts-boxplot-median\").add(r)),\r\nD.stroke=g.stemColor||l.stemColor||C,D[\"stroke-width\"]=u(g.stemWidth,l.stemWidth,l.lineWidth),D.dashstyle=g.stemDashStyle||l.stemDashStyle,g.stem.attr(D),A&&(J.stroke=g.whiskerColor||l.whiskerColor||C,J[\"stroke-width\"]=u(g.whiskerWidth,l.whiskerWidth,l.lineWidth),g.whiskers.attr(J)),n&&(w.fill=g.fillColor||l.fillColor||C,w.stroke=l.lineColor||C,w[\"stroke-width\"]=l.lineWidth||0,g.box.attr(w)),K.stroke=g.medianColor||l.medianColor||C,K[\"stroke-width\"]=u(g.medianWidth,l.medianWidth,l.lineWidth),g.medianShape.attr(K),\r\np=g.stem.strokeWidth()%2/2,t=m+q+p,g.stem[y]({d:[\"M\",t,d,\"L\",t,k,\"M\",t,c,\"L\",t,f]}),n&&(p=g.box.strokeWidth()%2/2,c=Math.floor(c)+p,d=Math.floor(d)+p,m+=p,x+=p,g.box[y]({d:[\"M\",m,d,\"L\",m,c,\"L\",x,c,\"L\",x,d,\"L\",m,d,\"z\"]})),A&&(p=g.whiskers.strokeWidth()%2/2,k+=p,f+=p,v=/%$/.test(A)?q*parseFloat(A)/100:A/2,g.whiskers[y]({d:[\"M\",t-v,k,\"L\",t+v,k,\"M\",t-v,f,\"L\",t+v,f]})),e=Math.round(g.medianPlot),p=g.medianShape.strokeWidth()%2/2,e+=p,g.medianShape[y]({d:[\"M\",m,e,\"L\",x,e]}))})},setStackedPoints:v})})(w);\r\n(function(b){var r=b.each,v=b.noop,u=b.seriesType,n=b.seriesTypes;u(\"errorbar\",\"boxplot\",{color:\"#000000\",grouping:!1,linkedTo:\":previous\",tooltip:{pointFormat:'\\x3cspan style\\x3d\"color:{point.color}\"\\x3e\\u25cf\\x3c/span\\x3e {series.name}: \\x3cb\\x3e{point.low}\\x3c/b\\x3e - \\x3cb\\x3e{point.high}\\x3c/b\\x3e\\x3cbr/\\x3e'},whiskerWidth:null},{type:\"errorbar\",pointArrayMap:[\"low\",\"high\"],toYData:function(b){return[b.low,b.high]},pointValKey:\"high\",doQuartiles:!1,drawDataLabels:n.arearange?function(){var b=\r\nthis.pointValKey;n.arearange.prototype.drawDataLabels.call(this);r(this.data,function(g){g.y=g[b]})}:v,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||n.column.prototype.getColumnMetrics.call(this)}})})(w);(function(b){var r=b.correctFloat,v=b.isNumber,u=b.pick,n=b.Point,q=b.Series,g=b.seriesType,l=b.seriesTypes;g(\"waterfall\",\"column\",{dataLabels:{inside:!0},lineWidth:1,lineColor:\"#333333\",dashStyle:\"dot\",borderColor:\"#333333\",states:{hover:{lineWidthPlus:0}}},\r\n{pointValKey:\"y\",showLine:!0,translate:function(){var a=this.options,c=this.yAxis,b,k,f,e,p,t,h,m,g,n,q=u(a.minPointLength,5),v=q/2,w=a.threshold,F=a.stacking,z;l.column.prototype.translate.apply(this);m=g=w;k=this.points;b=0;for(a=k.length;b<a;b++)f=k[b],h=this.processedYData[b],e=f.shapeArgs,p=F&&c.stacks[(this.negStacks&&h<w?\"-\":\"\")+this.stackKey],z=this.getStackIndicator(z,f.x,this.index),n=u(p&&p[f.x].points[z.key],[0,h]),f.isSum?f.y=r(h):f.isIntermediateSum&&(f.y=r(h-g)),t=Math.max(m,m+f.y)+\r\nn[0],e.y=c.translate(t,0,1,0,1),f.isSum?(e.y=c.translate(n[1],0,1,0,1),e.height=Math.min(c.translate(n[0],0,1,0,1),c.len)-e.y):f.isIntermediateSum?(e.y=c.translate(n[1],0,1,0,1),e.height=Math.min(c.translate(g,0,1,0,1),c.len)-e.y,g=n[1]):(e.height=0<h?c.translate(m,0,1,0,1)-e.y:c.translate(m,0,1,0,1)-c.translate(m-h,0,1,0,1),m+=p&&p[f.x]?p[f.x].total:h),0>e.height&&(e.y+=e.height,e.height*=-1),f.plotY=e.y=Math.round(e.y)-this.borderWidth%2/2,e.height=Math.max(Math.round(e.height),.001),f.yBottom=\r\ne.y+e.height,e.height<=q&&!f.isNull?(e.height=q,e.y-=v,f.plotY=e.y,f.minPointLengthOffset=0>f.y?-v:v):f.minPointLengthOffset=0,e=f.plotY+(f.negative?e.height:0),this.chart.inverted?f.tooltipPos[0]=c.len-e:f.tooltipPos[1]=e},processData:function(a){var c=this.yData,b=this.options.data,k,f=c.length,e,p,t,h,m,g;p=e=t=h=this.options.threshold||0;for(g=0;g<f;g++)m=c[g],k=b&&b[g]?b[g]:{},\"sum\"===m||k.isSum?c[g]=r(p):\"intermediateSum\"===m||k.isIntermediateSum?c[g]=r(e):(p+=m,e+=m),t=Math.min(p,t),h=Math.max(p,\r\nh);q.prototype.processData.call(this,a);this.options.stacking||(this.dataMin=t,this.dataMax=h)},toYData:function(a){return a.isSum?0===a.x?null:\"sum\":a.isIntermediateSum?0===a.x?null:\"intermediateSum\":a.y},pointAttribs:function(a,c){var b=this.options.upColor;b&&!a.options.color&&(a.color=0<a.y?b:null);a=l.column.prototype.pointAttribs.call(this,a,c);delete a.dashstyle;return a},getGraphPath:function(){return[\"M\",0,0]},getCrispPath:function(){var a=this.data,c=a.length,b=this.graph.strokeWidth()+\r\nthis.borderWidth,b=Math.round(b)%2/2,k=this.xAxis.reversed,f=this.yAxis.reversed,e=[],p,g,h;for(h=1;h<c;h++){g=a[h].shapeArgs;p=a[h-1].shapeArgs;g=[\"M\",p.x+(k?0:p.width),p.y+a[h-1].minPointLengthOffset+b,\"L\",g.x+(k?p.width:0),p.y+a[h-1].minPointLengthOffset+b];if(0>a[h-1].y&&!f||0<a[h-1].y&&f)g[2]+=p.height,g[5]+=p.height;e=e.concat(g)}return e},drawGraph:function(){q.prototype.drawGraph.call(this);this.graph.attr({d:this.getCrispPath()})},setStackedPoints:function(){var a=this.options,c,b;q.prototype.setStackedPoints.apply(this,\r\narguments);c=this.stackedYData?this.stackedYData.length:0;for(b=1;b<c;b++)a.data[b].isSum||a.data[b].isIntermediateSum||(this.stackedYData[b]+=this.stackedYData[b-1])},getExtremes:function(){if(this.options.stacking)return q.prototype.getExtremes.apply(this,arguments)}},{getClassName:function(){var a=n.prototype.getClassName.call(this);this.isSum?a+=\" highcharts-sum\":this.isIntermediateSum&&(a+=\" highcharts-intermediate-sum\");return a},isValid:function(){return v(this.y,!0)||this.isSum||this.isIntermediateSum}})})(w);\r\n(function(b){var r=b.Series,v=b.seriesType,u=b.seriesTypes;v(\"polygon\",\"scatter\",{marker:{enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:\"\"},trackByArea:!0},{type:\"polygon\",getGraphPath:function(){for(var b=r.prototype.getGraphPath.call(this),q=b.length+1;q--;)(q===b.length||\"M\"===b[q])&&0<q&&b.splice(q,0,\"z\");return this.areaPath=b},drawGraph:function(){this.options.fillColor=this.color;u.area.prototype.drawGraph.call(this)},drawLegendSymbol:b.LegendSymbolMixin.drawRectangle,\r\ndrawTracker:r.prototype.drawTracker,setStackedPoints:b.noop})})(w);(function(b){var r=b.arrayMax,v=b.arrayMin,u=b.Axis,n=b.color,q=b.each,g=b.isNumber,l=b.noop,a=b.pick,c=b.pInt,d=b.Point,k=b.Series,f=b.seriesType,e=b.seriesTypes;f(\"bubble\",\"scatter\",{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:\"middle\"},animationLimit:250,marker:{lineColor:null,lineWidth:1,fillOpacity:.5,radius:null,states:{hover:{radiusPlus:0}},symbol:\"circle\"},minSize:8,maxSize:\"20%\",softThreshold:!1,\r\nstates:{hover:{halo:{size:5}}},tooltip:{pointFormat:\"({point.x}, {point.y}), Size: {point.z}\"},turboThreshold:0,zThreshold:0,zoneAxis:\"z\"},{pointArrayMap:[\"y\",\"z\"],parallelArrays:[\"x\",\"y\",\"z\"],trackerGroups:[\"group\",\"dataLabelsGroup\"],specialGroup:\"group\",bubblePadding:!0,zoneAxis:\"z\",directTouch:!0,pointAttribs:function(a,c){var b=this.options.marker.fillOpacity;a=k.prototype.pointAttribs.call(this,a,c);1!==b&&(a.fill=n(a.fill).setOpacity(b).get(\"rgba\"));return a},getRadii:function(a,c,b,d){var e,\r\nf,h,k=this.zData,g=[],p=this.options,m=\"width\"!==p.sizeBy,t=p.zThreshold,l=c-a;f=0;for(e=k.length;f<e;f++)h=k[f],p.sizeByAbsoluteValue&&null!==h&&(h=Math.abs(h-t),c=l=Math.max(c-t,Math.abs(a-t)),a=0),null===h?h=null:h<a?h=b/2-1:(h=0<l?(h-a)/l:.5,m&&0<=h&&(h=Math.sqrt(h)),h=Math.ceil(b+h*(d-b))/2),g.push(h);this.radii=g},animate:function(a){!a&&this.points.length<this.options.animationLimit&&(q(this.points,function(a){var c=a.graphic,b;c&&c.width&&(b={x:c.x,y:c.y,width:c.width,height:c.height},c.attr({x:a.plotX,\r\ny:a.plotY,width:1,height:1}),c.animate(b,this.options.animation))},this),this.animate=null)},translate:function(){var a,c=this.data,d,f,k=this.radii;e.scatter.prototype.translate.call(this);for(a=c.length;a--;)d=c[a],f=k?k[a]:0,g(f)&&f>=this.minPxSize/2?(d.marker=b.extend(d.marker,{radius:f,width:2*f,height:2*f}),d.dlBox={x:d.plotX-f,y:d.plotY-f,width:2*f,height:2*f}):d.shapeArgs=d.plotY=d.dlBox=void 0},alignDataLabel:e.column.prototype.alignDataLabel,buildKDTree:l,applyZones:l},{haloPath:function(a){return d.prototype.haloPath.call(this,\r\n0===a?0:(this.marker?this.marker.radius||0:0)+a)},ttBelow:!1});u.prototype.beforePadding=function(){var b=this,d=this.len,e=this.chart,f=0,k=d,l=this.isXAxis,n=l?\"xData\":\"yData\",u=this.min,w={},F=Math.min(e.plotWidth,e.plotHeight),z=Number.MAX_VALUE,G=-Number.MAX_VALUE,H=this.max-u,E=d/H,I=[];q(this.series,function(d){var f=d.options;!d.bubblePadding||!d.visible&&e.options.chart.ignoreHiddenSeries||(b.allowZoomOutside=!0,I.push(d),l&&(q([\"minSize\",\"maxSize\"],function(a){var b=f[a],d=/%$/.test(b),\r\nb=c(b);w[a]=d?F*b/100:b}),d.minPxSize=w.minSize,d.maxPxSize=Math.max(w.maxSize,w.minSize),d=d.zData,d.length&&(z=a(f.zMin,Math.min(z,Math.max(v(d),!1===f.displayNegative?f.zThreshold:-Number.MAX_VALUE))),G=a(f.zMax,Math.max(G,r(d))))))});q(I,function(a){var c=a[n],d=c.length,e;l&&a.getRadii(z,G,a.minPxSize,a.maxPxSize);if(0<H)for(;d--;)g(c[d])&&b.dataMin<=c[d]&&c[d]<=b.dataMax&&(e=a.radii[d],f=Math.min((c[d]-u)*E-e,f),k=Math.max((c[d]-u)*E+e,k))});I.length&&0<H&&!this.isLog&&(k-=d,E*=(d+f-k)/d,q([[\"min\",\r\n\"userMin\",f],[\"max\",\"userMax\",k]],function(c){void 0===a(b.options[c[0]],b[c[1]])&&(b[c[0]]+=c[2]/E)}))}})(w);(function(b){var r=b.each,v=b.pick,u=b.Series,n=b.seriesTypes,q=b.wrap,g=u.prototype,l=b.Pointer.prototype;b.polarExtended||(b.polarExtended=!0,g.searchPointByAngle=function(a){var c=this.chart,b=this.xAxis.pane.center;return this.searchKDTree({clientX:180+-180/Math.PI*Math.atan2(a.chartX-b[0]-c.plotLeft,a.chartY-b[1]-c.plotTop)})},g.getConnectors=function(a,c,b,k){var d,e,g,l,h,m,n,q;e=k?\r\n1:0;d=0<=c&&c<=a.length-1?c:0>c?a.length-1+c:0;c=0>d-1?a.length-(1+e):d-1;e=d+1>a.length-1?e:d+1;g=a[c];e=a[e];l=g.plotX;g=g.plotY;h=e.plotX;m=e.plotY;e=a[d].plotX;d=a[d].plotY;l=(1.5*e+l)/2.5;g=(1.5*d+g)/2.5;h=(1.5*e+h)/2.5;n=(1.5*d+m)/2.5;m=Math.sqrt(Math.pow(l-e,2)+Math.pow(g-d,2));q=Math.sqrt(Math.pow(h-e,2)+Math.pow(n-d,2));l=Math.atan2(g-d,l-e);n=Math.PI/2+(l+Math.atan2(n-d,h-e))/2;Math.abs(l-n)>Math.PI/2&&(n-=Math.PI);l=e+Math.cos(n)*m;g=d+Math.sin(n)*m;h=e+Math.cos(Math.PI+n)*q;n=d+Math.sin(Math.PI+\r\nn)*q;e={rightContX:h,rightContY:n,leftContX:l,leftContY:g,plotX:e,plotY:d};b&&(e.prevPointCont=this.getConnectors(a,c,!1,k));return e},q(g,\"buildKDTree\",function(a){this.chart.polar&&(this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.options.findNearestPointBy=\"xy\");a.apply(this)}),g.toXY=function(a){var c,b=this.chart,k=a.plotX;c=a.plotY;a.rectPlotX=k;a.rectPlotY=c;c=this.xAxis.postTranslate(a.plotX,this.yAxis.len-c);a.plotX=a.polarPlotX=c.x-b.plotLeft;a.plotY=a.polarPlotY=c.y-b.plotTop;\r\nthis.kdByAngle?(b=(k/Math.PI*180+this.xAxis.pane.options.startAngle)%360,0>b&&(b+=360),a.clientX=b):a.clientX=a.plotX},n.spline&&(q(n.spline.prototype,\"getPointSpline\",function(a,c,b,k){this.chart.polar?k?(a=this.getConnectors(c,k,!0,this.connectEnds),a=[\"C\",a.prevPointCont.rightContX,a.prevPointCont.rightContY,a.leftContX,a.leftContY,a.plotX,a.plotY]):a=[\"M\",b.plotX,b.plotY]:a=a.call(this,c,b,k);return a}),n.areasplinerange&&(n.areasplinerange.prototype.getPointSpline=n.spline.prototype.getPointSpline)),\r\nb.addEvent(u,\"afterTranslate\",function(){var a=this.chart,c,d;if(a.polar){this.kdByAngle=a.tooltip&&a.tooltip.shared;if(!this.preventPostTranslate)for(c=this.points,d=c.length;d--;)this.toXY(c[d]);this.hasClipCircleSetter||(this.hasClipCircleSetter=!!b.addEvent(this,\"afterRender\",function(){var c;a.polar&&(c=this.yAxis.center,this.group.clip(a.renderer.clipCircle(c[0],c[1],c[2]/2)),this.setClip=b.noop)}))}}),q(g,\"getGraphPath\",function(a,c){var b=this,g,f,e;if(this.chart.polar){c=c||this.points;for(g=\r\n0;g<c.length;g++)if(!c[g].isNull){f=g;break}!1!==this.options.connectEnds&&void 0!==f&&(this.connectEnds=!0,c.splice(c.length,0,c[f]),e=!0);r(c,function(a){void 0===a.polarPlotY&&b.toXY(a)})}g=a.apply(this,[].slice.call(arguments,1));e&&c.pop();return g}),u=function(a,c){var b=this.chart,g=this.options.animation,f=this.group,e=this.markerGroup,l=this.xAxis.center,n=b.plotLeft,h=b.plotTop;b.polar?b.renderer.isSVG&&(!0===g&&(g={}),c?(a={translateX:l[0]+n,translateY:l[1]+h,scaleX:.001,scaleY:.001},f.attr(a),\r\ne&&e.attr(a)):(a={translateX:n,translateY:h,scaleX:1,scaleY:1},f.animate(a,g),e&&e.animate(a,g),this.animate=null)):a.call(this,c)},q(g,\"animate\",u),n.column&&(n=n.column.prototype,n.polarArc=function(a,c,b,g){var d=this.xAxis.center,e=this.yAxis.len;return this.chart.renderer.symbols.arc(d[0],d[1],e-c,null,{start:b,end:g,innerR:e-v(a,e)})},q(n,\"animate\",u),q(n,\"translate\",function(a){var c=this.xAxis,b=c.startAngleRad,g,f,e;this.preventPostTranslate=!0;a.call(this);if(c.isRadial)for(g=this.points,\r\ne=g.length;e--;)f=g[e],a=f.barX+b,f.shapeType=\"path\",f.shapeArgs={d:this.polarArc(f.yBottom,f.plotY,a,a+f.pointWidth)},this.toXY(f),f.tooltipPos=[f.plotX,f.plotY],f.ttBelow=f.plotY>c.center[1]}),q(n,\"alignDataLabel\",function(a,b,d,k,f,e){this.chart.polar?(a=b.rectPlotX/Math.PI*180,null===k.align&&(k.align=20<a&&160>a?\"left\":200<a&&340>a?\"right\":\"center\"),null===k.verticalAlign&&(k.verticalAlign=45>a||315<a?\"bottom\":135<a&&225>a?\"top\":\"middle\"),g.alignDataLabel.call(this,b,d,k,f,e)):a.call(this,b,\r\nd,k,f,e)})),q(l,\"getCoordinates\",function(a,b){var c=this.chart,g={xAxis:[],yAxis:[]};c.polar?r(c.axes,function(a){var d=a.isXAxis,f=a.center,k=b.chartX-f[0]-c.plotLeft,f=b.chartY-f[1]-c.plotTop;g[d?\"xAxis\":\"yAxis\"].push({axis:a,value:a.translate(d?Math.PI-Math.atan2(k,f):Math.sqrt(Math.pow(k,2)+Math.pow(f,2)),!0)})}):g=a.call(this,b);return g}),b.SVGRenderer.prototype.clipCircle=function(a,c,d){var g=b.uniqueKey(),f=this.createElement(\"clipPath\").attr({id:g}).add(this.defs);a=this.circle(a,c,d).add(f);\r\na.id=g;a.clipPath=f;return a},b.addEvent(b.Chart,\"getAxes\",function(){this.pane||(this.pane=[]);r(b.splat(this.options.pane),function(a){new b.Pane(a,this)},this)}),b.addEvent(b.Chart,\"afterDrawChartBox\",function(){r(this.pane,function(a){a.render()})}),q(b.Chart.prototype,\"get\",function(a,c){return b.find(this.pane,function(a){return a.options.id===c})||a.call(this,c)}))})(w)});\r\n","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n Exporting module\r\n\r\n (c) 2010-2017 Torstein Honsi\r\n\r\n License: www.highcharts.com/license\r\n*/\r\n(function(n){\"object\"===typeof module&&module.exports?module.exports=n:n(Highcharts)})(function(n){(function(f){var n=f.defaultOptions,v=f.doc,B=f.Chart,w=f.addEvent,K=f.removeEvent,I=f.fireEvent,q=f.createElement,E=f.discardElement,F=f.css,x=f.merge,C=f.pick,u=f.each,G=f.objectEach,A=f.extend,y=f.win,J=y.navigator.userAgent,H=f.SVGRenderer,L=f.Renderer.prototype.symbols,M=/Edge\\/|Trident\\/|MSIE /.test(J),N=/firefox/i.test(J);A(n.lang,{printChart:\"Print chart\",downloadPNG:\"Download PNG image\",downloadJPEG:\"Download JPEG image\",\r\ndownloadPDF:\"Download PDF document\",downloadSVG:\"Download SVG vector image\",contextButtonTitle:\"Chart context menu\"});n.navigation={buttonOptions:{theme:{},symbolSize:14,symbolX:12.5,symbolY:10.5,align:\"right\",buttonSpacing:3,height:22,verticalAlign:\"top\",width:24}};n.exporting={type:\"image/png\",url:\"https://export.highcharts.com/\",printMaxWidth:780,scale:2,buttons:{contextButton:{className:\"highcharts-contextbutton\",menuClassName:\"highcharts-contextmenu\",symbol:\"menu\",_titleKey:\"contextButtonTitle\",\r\nmenuItems:\"printChart separator downloadPNG downloadJPEG downloadPDF downloadSVG\".split(\" \")}},menuItemDefinitions:{printChart:{textKey:\"printChart\",onclick:function(){this.print()}},separator:{separator:!0},downloadPNG:{textKey:\"downloadPNG\",onclick:function(){this.exportChart()}},downloadJPEG:{textKey:\"downloadJPEG\",onclick:function(){this.exportChart({type:\"image/jpeg\"})}},downloadPDF:{textKey:\"downloadPDF\",onclick:function(){this.exportChart({type:\"application/pdf\"})}},downloadSVG:{textKey:\"downloadSVG\",\r\nonclick:function(){this.exportChart({type:\"image/svg+xml\"})}}}};f.post=function(a,b,c){var d=q(\"form\",x({method:\"post\",action:a,enctype:\"multipart/form-data\"},c),{display:\"none\"},v.body);G(b,function(a,b){q(\"input\",{type:\"hidden\",name:b,value:a},null,d)});d.submit();E(d)};A(B.prototype,{sanitizeSVG:function(a,b){if(b&&b.exporting&&b.exporting.allowHTML){var c=a.match(/<\\/svg>(.*?$)/);c&&c[1]&&(c='\\x3cforeignObject x\\x3d\"0\" y\\x3d\"0\" width\\x3d\"'+b.chart.width+'\" height\\x3d\"'+b.chart.height+'\"\\x3e\\x3cbody xmlns\\x3d\"http://www.w3.org/1999/xhtml\"\\x3e'+\r\nc[1]+\"\\x3c/body\\x3e\\x3c/foreignObject\\x3e\",a=a.replace(\"\\x3c/svg\\x3e\",c+\"\\x3c/svg\\x3e\"))}return a=a.replace(/zIndex=\"[^\"]+\"/g,\"\").replace(/isShadow=\"[^\"]+\"/g,\"\").replace(/symbolName=\"[^\"]+\"/g,\"\").replace(/jQuery[0-9]+=\"[^\"]+\"/g,\"\").replace(/url\\((\"|&quot;)(\\S+)(\"|&quot;)\\)/g,\"url($2)\").replace(/url\\([^#]+#/g,\"url(#\").replace(/<svg /,'\\x3csvg xmlns:xlink\\x3d\"http://www.w3.org/1999/xlink\" ').replace(/ (|NS[0-9]+\\:)href=/g,\" xlink:href\\x3d\").replace(/\\n/,\" \").replace(/<\\/svg>.*?$/,\"\\x3c/svg\\x3e\").replace(/(fill|stroke)=\"rgba\\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\\.]+)\\)\"/g,\r\n'$1\\x3d\"rgb($2)\" $1-opacity\\x3d\"$3\"').replace(/&nbsp;/g,\"\\u00a0\").replace(/&shy;/g,\"\\u00ad\")},getChartHTML:function(){this.inlineStyles();return this.container.innerHTML},getSVG:function(a){var b,c,d,r,h,g=x(this.options,a);c=q(\"div\",null,{position:\"absolute\",top:\"-9999em\",width:this.chartWidth+\"px\",height:this.chartHeight+\"px\"},v.body);d=this.renderTo.style.width;h=this.renderTo.style.height;d=g.exporting.sourceWidth||g.chart.width||/px$/.test(d)&&parseInt(d,10)||600;h=g.exporting.sourceHeight||\r\ng.chart.height||/px$/.test(h)&&parseInt(h,10)||400;A(g.chart,{animation:!1,renderTo:c,forExport:!0,renderer:\"SVGRenderer\",width:d,height:h});g.exporting.enabled=!1;delete g.data;g.series=[];u(this.series,function(a){r=x(a.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:a.visible});r.isInternal||g.series.push(r)});u(this.axes,function(a){a.userOptions.internalKey||(a.userOptions.internalKey=f.uniqueKey())});b=new f.Chart(g,this.callback);a&&u([\"xAxis\",\"yAxis\",\"series\"],function(d){var c=\r\n{};a[d]&&(c[d]=a[d],b.update(c))});u(this.axes,function(a){var d=f.find(b.axes,function(b){return b.options.internalKey===a.userOptions.internalKey}),c=a.getExtremes(),e=c.userMin,c=c.userMax;!d||void 0===e&&void 0===c||d.setExtremes(e,c,!0,!1)});d=b.getChartHTML();d=this.sanitizeSVG(d,g);g=null;b.destroy();E(c);return d},getSVGForExport:function(a,b){var c=this.options.exporting;return this.getSVG(x({chart:{borderRadius:0}},c.chartOptions,b,{exporting:{sourceWidth:a&&a.sourceWidth||c.sourceWidth,\r\nsourceHeight:a&&a.sourceHeight||c.sourceHeight}}))},exportChart:function(a,b){b=this.getSVGForExport(a,b);a=x(this.options.exporting,a);f.post(a.url,{filename:a.filename||\"chart\",type:a.type,width:a.width||0,scale:a.scale,svg:b},a.formAttributes)},print:function(){var a=this,b=a.container,c=[],d=b.parentNode,f=v.body,h=f.childNodes,g=a.options.exporting.printMaxWidth,e,k;if(!a.isPrinting){a.isPrinting=!0;a.pointer.reset(null,0);I(a,\"beforePrint\");if(k=g&&a.chartWidth>g)e=[a.options.chart.width,void 0,\r\n!1],a.setSize(g,void 0,!1);u(h,function(a,b){1===a.nodeType&&(c[b]=a.style.display,a.style.display=\"none\")});f.appendChild(b);y.focus();y.print();setTimeout(function(){d.appendChild(b);u(h,function(a,b){1===a.nodeType&&(a.style.display=c[b])});a.isPrinting=!1;k&&a.setSize.apply(a,e);I(a,\"afterPrint\")},1E3)}},contextMenu:function(a,b,c,d,r,h,g){var e=this,k=e.chartWidth,p=e.chartHeight,t=\"cache-\"+a,l=e[t],m=Math.max(r,h),D,n;l||(e[t]=l=q(\"div\",{className:a},{position:\"absolute\",zIndex:1E3,padding:m+\r\n\"px\"},e.container),D=q(\"div\",{className:\"highcharts-menu\"},null,l),n=function(){F(l,{display:\"none\"});g&&g.setState(0);e.openMenu=!1},e.exportEvents.push(w(l,\"mouseleave\",function(){l.hideTimer=setTimeout(n,500)}),w(l,\"mouseenter\",function(){f.clearTimeout(l.hideTimer)}),w(v,\"mouseup\",function(b){e.pointer.inClass(b.target,a)||n()})),u(b,function(a){\"string\"===typeof a&&(a=e.options.exporting.menuItemDefinitions[a]);if(f.isObject(a,!0)){var b;b=a.separator?q(\"hr\",null,null,D):q(\"div\",{className:\"highcharts-menu-item\",\r\nonclick:function(b){b&&b.stopPropagation();n();a.onclick&&a.onclick.apply(e,arguments)},innerHTML:a.text||e.options.lang[a.textKey]},null,D);e.exportDivElements.push(b)}}),e.exportDivElements.push(D,l),e.exportMenuWidth=l.offsetWidth,e.exportMenuHeight=l.offsetHeight);b={display:\"block\"};c+e.exportMenuWidth>k?b.right=k-c-r-m+\"px\":b.left=c-m+\"px\";d+h+e.exportMenuHeight>p&&\"top\"!==g.alignOptions.verticalAlign?b.bottom=p-d-m+\"px\":b.top=d+h-m+\"px\";F(l,b);e.openMenu=!0},addButton:function(a){var b=this,\r\nc=b.renderer,d=x(b.options.navigation.buttonOptions,a),f=d.onclick,h=d.menuItems,g,e,k=d.symbolSize||12;b.btnCount||(b.btnCount=0);b.exportDivElements||(b.exportDivElements=[],b.exportSVGElements=[]);if(!1!==d.enabled){var p=d.theme,t=p.states,l=t&&t.hover,t=t&&t.select,m;delete p.states;f?m=function(a){a.stopPropagation();f.call(b,a)}:h&&(m=function(){b.contextMenu(e.menuClassName,h,e.translateX,e.translateY,e.width,e.height,e);e.setState(2)});d.text&&d.symbol?p.paddingLeft=C(p.paddingLeft,25):d.text||\r\nA(p,{width:d.width,height:d.height,padding:0});e=c.button(d.text,0,0,m,p,l,t).addClass(a.className).attr({title:C(b.options.lang[d._titleKey],\"\"),zIndex:3});e.menuClassName=a.menuClassName||\"highcharts-menu-\"+b.btnCount++;d.symbol&&(g=c.symbol(d.symbol,d.symbolX-k/2,d.symbolY-k/2,k,k,{width:k,height:k}).addClass(\"highcharts-button-symbol\").attr({zIndex:1}).add(e));e.add().align(A(d,{width:e.width,x:C(d.x,b.buttonOffset)}),!0,\"spacingBox\");b.buttonOffset+=(e.width+d.buttonSpacing)*(\"right\"===d.align?\r\n-1:1);b.exportSVGElements.push(e,g)}},destroyExport:function(a){var b=a?a.target:this;a=b.exportSVGElements;var c=b.exportDivElements,d=b.exportEvents,r;a&&(u(a,function(a,d){a&&(a.onclick=a.ontouchstart=null,r=\"cache-\"+a.menuClassName,b[r]&&delete b[r],b.exportSVGElements[d]=a.destroy())}),a.length=0);c&&(u(c,function(a,d){f.clearTimeout(a.hideTimer);K(a,\"mouseleave\");b.exportDivElements[d]=a.onmouseout=a.onmouseover=a.ontouchstart=a.onclick=null;E(a)}),c.length=0);d&&(u(d,function(a){a()}),d.length=\r\n0)}});H.prototype.inlineToAttributes=\"fill stroke strokeLinecap strokeLinejoin strokeWidth textAnchor x y\".split(\" \");H.prototype.inlineBlacklist=[/-/,/^(clipPath|cssText|d|height|width)$/,/^font$/,/[lL]ogical(Width|Height)$/,/perspective/,/TapHighlightColor/,/^transition/,/^length$/];H.prototype.unstyledElements=[\"clipPath\",\"defs\",\"desc\"];B.prototype.inlineStyles=function(){function a(a){return a.replace(/([A-Z])/g,function(a,b){return\"-\"+b.toLowerCase()})}function b(c){function l(b,g){q=v=!1;if(h){for(z=\r\nh.length;z--&&!v;)v=h[z].test(g);q=!v}\"transform\"===g&&\"none\"===b&&(q=!0);for(z=f.length;z--&&!q;)q=f[z].test(g)||\"function\"===typeof b;q||n[g]===b&&\"svg\"!==c.nodeName||e[c.nodeName][g]===b||(-1!==d.indexOf(g)?c.setAttribute(a(g),b):r+=a(g)+\":\"+b+\";\")}var m,n,r=\"\",t,q,v,z;if(1===c.nodeType&&-1===g.indexOf(c.nodeName)){m=y.getComputedStyle(c,null);n=\"svg\"===c.nodeName?{}:y.getComputedStyle(c.parentNode,null);e[c.nodeName]||(k=p.getElementsByTagName(\"svg\")[0],t=p.createElementNS(c.namespaceURI,c.nodeName),\r\nk.appendChild(t),e[c.nodeName]=x(y.getComputedStyle(t,null)),\"text\"===c.nodeName&&delete e.text.fill,k.removeChild(t));if(N||M)for(var w in m)l(m[w],w);else G(m,l);r&&(m=c.getAttribute(\"style\"),c.setAttribute(\"style\",(m?m+\";\":\"\")+r));\"svg\"===c.nodeName&&c.setAttribute(\"stroke-width\",\"1px\");\"text\"!==c.nodeName&&u(c.children||c.childNodes,b)}}var c=this.renderer,d=c.inlineToAttributes,f=c.inlineBlacklist,h=c.inlineWhitelist,g=c.unstyledElements,e={},k,p,c=v.createElement(\"iframe\");F(c,{width:\"1px\",\r\nheight:\"1px\",visibility:\"hidden\"});v.body.appendChild(c);p=c.contentWindow.document;p.open();p.write('\\x3csvg xmlns\\x3d\"http://www.w3.org/2000/svg\"\\x3e\\x3c/svg\\x3e');p.close();b(this.container.querySelector(\"svg\"));k.parentNode.removeChild(k)};L.menu=function(a,b,c,d){return[\"M\",a,b+2.5,\"L\",a+c,b+2.5,\"M\",a,b+d/2+.5,\"L\",a+c,b+d/2+.5,\"M\",a,b+d-1.5,\"L\",a+c,b+d-1.5]};B.prototype.renderExporting=function(){var a=this,b=a.options.exporting,c=b.buttons,d=a.isDirtyExporting||!a.exportSVGElements;a.buttonOffset=\r\n0;a.isDirtyExporting&&a.destroyExport();d&&!1!==b.enabled&&(a.exportEvents=[],G(c,function(b){a.addButton(b)}),a.isDirtyExporting=!1);w(a,\"destroy\",a.destroyExport)};B.prototype.callbacks.push(function(a){a.renderExporting();w(a,\"redraw\",a.renderExporting);u([\"exporting\",\"navigation\"],function(b){a[b]={update:function(c,d){a.isDirtyExporting=!0;x(!0,a.options[b],c);C(d,!0)&&a.redraw()}}})})})(n)});\r\n","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n Plugin for displaying a message when there is no data visible in chart.\r\n\r\n (c) 2010-2017 Highsoft AS\r\n Author: Oystein Moseng\r\n\r\n License: www.highcharts.com/license\r\n*/\r\n(function(d){\"object\"===typeof module&&module.exports?module.exports=d:d(Highcharts)})(function(d){(function(c){var d=c.seriesTypes,e=c.Chart.prototype,f=c.getOptions(),g=c.extend,h=c.each;g(f.lang,{noData:\"No data to display\"});f.noData={position:{x:0,y:0,align:\"center\",verticalAlign:\"middle\"}};h(\"bubble gauge heatmap pie sankey treemap waterfall\".split(\" \"),function(b){d[b]&&(d[b].prototype.hasData=function(){return!!this.points.length})});c.Series.prototype.hasData=function(){return this.visible&&\r\nvoid 0!==this.dataMax&&void 0!==this.dataMin};e.showNoData=function(b){var a=this.options;b=b||a&&a.lang.noData;a=a&&a.noData;!this.noDataLabel&&this.renderer&&(this.noDataLabel=this.renderer.label(b,0,0,null,null,null,a.useHTML,null,\"no-data\"),this.noDataLabel.add(),this.noDataLabel.align(g(this.noDataLabel.getBBox(),a.position),!1,\"plotBox\"))};e.hideNoData=function(){this.noDataLabel&&(this.noDataLabel=this.noDataLabel.destroy())};e.hasData=function(){for(var b=this.series||[],a=b.length;a--;)if(b[a].hasData()&&\r\n!b[a].options.isInternal)return!0;return this.loadingShown};c.addEvent(c.Chart,\"render\",function(){this.hasData()?this.hideNoData():this.showNoData()})})(d)});\r\n","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n Highcharts funnel module\r\n\r\n (c) 2010-2017 Torstein Honsi\r\n\r\n License: www.highcharts.com/license\r\n*/\r\n(function(e){\"object\"===typeof module&&module.exports?module.exports=e:e(Highcharts)})(function(e){(function(g){var e=g.seriesType,C=g.seriesTypes,H=g.noop,D=g.pick,I=g.each;e(\"funnel\",\"pie\",{animation:!1,center:[\"50%\",\"50%\"],width:\"90%\",neckWidth:\"30%\",height:\"100%\",neckHeight:\"25%\",reversed:!1,size:!0},{animate:H,translate:function(){var b=function(a,b){return/%$/.test(a)?b*parseInt(a,10)/100:parseInt(a,10)},E=0,c=this.chart,f=this.options,d=f.reversed,e=f.ignoreHiddenPoint,t=c.plotWidth,c=c.plotHeight,\r\nq=0,g=f.center,h=b(g[0],t),r=b(g[1],c),C=b(f.width,t),l,v,m=b(f.height,c),w=b(f.neckWidth,t),F=b(f.neckHeight,c),x=r-m/2+m-F,b=this.data,z,A,D=\"left\"===f.dataLabels.position?1:0,B,n,G,u,k,y,p;this.getWidthAt=v=function(a){var b=r-m/2;return a>x||m===F?w:w+(C-w)*(1-(a-b)/(m-F))};this.getX=function(a,b,c){return h+(b?-1:1)*(v(d?2*r-a:a)/2+c.labelDistance)};this.center=[h,r,m];this.centerX=h;I(b,function(a){e&&!1===a.visible||(E+=a.y)});I(b,function(a){p=null;A=E?a.y/E:0;n=r-m/2+q*m;k=n+A*m;l=v(n);B=\r\nh-l/2;G=B+l;l=v(k);u=h-l/2;y=u+l;n>x?(B=u=h-w/2,G=y=h+w/2):k>x&&(p=k,l=v(x),u=h-l/2,y=u+l,k=x);d&&(n=2*r-n,k=2*r-k,p=p?2*r-p:null);z=[\"M\",B,n,\"L\",G,n,y,k];p&&z.push(y,p,u,p);z.push(u,k,\"Z\");a.shapeType=\"path\";a.shapeArgs={d:z};a.percentage=100*A;a.plotX=h;a.plotY=(n+(p||k))/2;a.tooltipPos=[h,a.plotY];a.slice=H;a.half=D;e&&!1===a.visible||(q+=A)})},sortByAngle:function(b){b.sort(function(b,c){return b.plotY-c.plotY})},drawDataLabels:function(){var b=this.data,e=this.options.dataLabels.distance,c,f,\r\nd,g=b.length,t,q;for(this.center[2]-=2*e;g--;)d=b[g],f=(c=d.half)?1:-1,q=d.plotY,d.labelDistance=D(d.options.dataLabels&&d.options.dataLabels.distance,e),this.maxLabelDistance=Math.max(d.labelDistance,this.maxLabelDistance||0),t=this.getX(q,c,d),d.labelPos=[0,q,t+(d.labelDistance-5)*f,q,t+d.labelDistance*f,q,c?\"right\":\"left\",0];C.pie.prototype.drawDataLabels.call(this)}});e(\"pyramid\",\"funnel\",{neckWidth:\"0%\",neckHeight:\"0%\",reversed:!0})})(e)});\r\n","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n\r\n (c) 2009-2017 Torstein Honsi\r\n\r\n License: www.highcharts.com/license\r\n*/\r\n(function(m){\"object\"===typeof module&&module.exports?module.exports=m:m(Highcharts)})(function(m){(function(b){var u=b.addEvent,k=b.Axis,m=b.Chart,e=b.color,l,h=b.each,t=b.extend,q=b.isNumber,c=b.Legend,p=b.LegendSymbolMixin,x=b.noop,w=b.merge,n=b.pick;b.ColorAxis||(l=b.ColorAxis=function(){this.init.apply(this,arguments)},t(l.prototype,k.prototype),t(l.prototype,{defaultColorAxisOptions:{lineWidth:0,minPadding:0,maxPadding:0,gridLineWidth:1,tickPixelInterval:72,startOnTick:!0,endOnTick:!0,offset:0,\r\nmarker:{animation:{duration:50},width:.01},labels:{overflow:\"justify\",rotation:0},minColor:\"#e6ebf5\",maxColor:\"#003399\",tickLength:5,showInLegend:!0},keepProps:[\"legendGroup\",\"legendItemHeight\",\"legendItemWidth\",\"legendItem\",\"legendSymbol\"].concat(k.prototype.keepProps),init:function(a,d){var f=\"vertical\"!==a.options.legend.layout,r;this.coll=\"colorAxis\";r=w(this.defaultColorAxisOptions,{side:f?2:1,reversed:!f},d,{opposite:!f,showEmpty:!1,title:null,visible:a.options.legend.enabled});k.prototype.init.call(this,\r\na,r);d.dataClasses&&this.initDataClasses(d);this.initStops();this.horiz=f;this.zoomEnabled=!1;this.defaultLegendLength=200},initDataClasses:function(a){var d,f=0,r=this.chart.options.chart.colorCount,g=this.options,b=a.dataClasses.length;this.dataClasses=d=[];this.legendItems=[];h(a.dataClasses,function(a,c){a=w(a);d.push(a);\"category\"===g.dataClassColor?(a.colorIndex=f,f++,f===r&&(f=0)):a.color=e(g.minColor).tweenTo(e(g.maxColor),2>b?.5:c/(b-1))})},setTickPositions:function(){if(!this.dataClasses)return k.prototype.setTickPositions.call(this)},\r\ninitStops:function(){this.stops=this.options.stops||[[0,this.options.minColor],[1,this.options.maxColor]];h(this.stops,function(a){a.color=e(a[1])})},setOptions:function(a){k.prototype.setOptions.call(this,a);this.options.crosshair=this.options.marker},setAxisSize:function(){var a=this.legendSymbol,d=this.chart,f=d.options.legend||{},b,g;a?(this.left=f=a.attr(\"x\"),this.top=b=a.attr(\"y\"),this.width=g=a.attr(\"width\"),this.height=a=a.attr(\"height\"),this.right=d.chartWidth-f-g,this.bottom=d.chartHeight-\r\nb-a,this.len=this.horiz?g:a,this.pos=this.horiz?f:b):this.len=(this.horiz?f.symbolWidth:f.symbolHeight)||this.defaultLegendLength},normalizedValue:function(a){this.isLog&&(a=this.val2lin(a));return 1-(this.max-a)/(this.max-this.min||1)},toColor:function(a,d){var f=this.stops,b,g,c=this.dataClasses,p,e;if(c)for(e=c.length;e--;){if(p=c[e],b=p.from,f=p.to,(void 0===b||a>=b)&&(void 0===f||a<=f)){d&&(d.dataClass=e,d.colorIndex=p.colorIndex);break}}else{a=this.normalizedValue(a);for(e=f.length;e--&&!(a>\r\nf[e][0]););b=f[e]||f[e+1];f=f[e+1]||b;a=1-(f[0]-a)/(f[0]-b[0]||1);g=b.color.tweenTo(f.color,a)}return g},getOffset:function(){var a=this.legendGroup,d=this.chart.axisOffset[this.side];a&&(this.axisParent=a,k.prototype.getOffset.call(this),this.added||(this.added=!0,this.labelLeft=0,this.labelRight=this.width),this.chart.axisOffset[this.side]=d)},setLegendColor:function(){var a,d=this.reversed;a=d?1:0;d=d?0:1;a=this.horiz?[a,0,d,0]:[0,d,0,a];this.legendColor={linearGradient:{x1:a[0],y1:a[1],x2:a[2],\r\ny2:a[3]},stops:this.stops}},drawLegendSymbol:function(a,d){var f=a.padding,b=a.options,g=this.horiz,c=n(b.symbolWidth,g?this.defaultLegendLength:12),e=n(b.symbolHeight,g?12:this.defaultLegendLength),p=n(b.labelPadding,g?16:30),b=n(b.itemDistance,10);this.setLegendColor();d.legendSymbol=this.chart.renderer.rect(0,a.baseline-11,c,e).attr({zIndex:1}).add(d.legendGroup);this.legendItemWidth=c+f+(g?b:p);this.legendItemHeight=e+f+(g?p:0)},setState:function(a){h(this.series,function(d){d.setState(a)})},\r\nvisible:!0,setVisible:x,getSeriesExtremes:function(){var a=this.series,d=a.length;this.dataMin=Infinity;for(this.dataMax=-Infinity;d--;)void 0!==a[d].valueMin&&(this.dataMin=Math.min(this.dataMin,a[d].valueMin),this.dataMax=Math.max(this.dataMax,a[d].valueMax))},drawCrosshair:function(a,d){var f=d&&d.plotX,b=d&&d.plotY,g,c=this.pos,e=this.len;d&&(g=this.toPixels(d[d.series.colorKey]),g<c?g=c-2:g>c+e&&(g=c+e+2),d.plotX=g,d.plotY=this.len-g,k.prototype.drawCrosshair.call(this,a,d),d.plotX=f,d.plotY=\r\nb,this.cross&&!this.cross.addedToColorAxis&&this.legendGroup&&(this.cross.addClass(\"highcharts-coloraxis-marker\").add(this.legendGroup),this.cross.addedToColorAxis=!0))},getPlotLinePath:function(a,d,f,b,c){return q(c)?this.horiz?[\"M\",c-4,this.top-6,\"L\",c+4,this.top-6,c,this.top,\"Z\"]:[\"M\",this.left,c,\"L\",this.left-6,c+6,this.left-6,c-6,\"Z\"]:k.prototype.getPlotLinePath.call(this,a,d,f,b)},update:function(a,d){var b=this.chart,c=b.legend;h(this.series,function(a){a.isDirtyData=!0});a.dataClasses&&c.allItems&&\r\n(h(c.allItems,function(a){a.isDataClass&&a.legendGroup&&a.legendGroup.destroy()}),b.isDirtyLegend=!0);b.options[this.coll]=w(this.userOptions,a);k.prototype.update.call(this,a,d);this.legendItem&&(this.setLegendColor(),c.colorizeItem(this,!0))},remove:function(){this.legendItem&&this.chart.legend.destroyItem(this);k.prototype.remove.call(this)},getDataClassLegendSymbols:function(){var a=this,d=this.chart,f=this.legendItems,c=d.options.legend,e=c.valueDecimals,k=c.valueSuffix||\"\",l;f.length||h(this.dataClasses,\r\nfunction(c,g){var q=!0,r=c.from,n=c.to;l=\"\";void 0===r?l=\"\\x3c \":void 0===n&&(l=\"\\x3e \");void 0!==r&&(l+=b.numberFormat(r,e)+k);void 0!==r&&void 0!==n&&(l+=\" - \");void 0!==n&&(l+=b.numberFormat(n,e)+k);f.push(t({chart:d,name:l,options:{},drawLegendSymbol:p.drawRectangle,visible:!0,setState:x,isDataClass:!0,setVisible:function(){q=this.visible=!q;h(a.series,function(a){h(a.points,function(a){a.dataClass===g&&a.setVisible(q)})});d.legend.colorizeItem(this,q)}},c))});return f},name:\"\"}),h([\"fill\",\"stroke\"],\r\nfunction(a){b.Fx.prototype[a+\"Setter\"]=function(){this.elem.attr(a,e(this.start).tweenTo(e(this.end),this.pos),null,!0)}}),u(m,\"afterGetAxes\",function(){var a=this.options.colorAxis;this.colorAxis=[];a&&new l(this,a)}),u(c,\"afterGetAllItems\",function(a){var d=[],c=this.chart.colorAxis[0];c&&c.options&&(c.options.showInLegend&&(c.options.dataClasses?d=c.getDataClassLegendSymbols():d.push(c)),h(c.series,function(c){b.erase(a.allItems,c)}));for(;d.length;)a.allItems.unshift(d.pop())}),u(c,\"afterColorizeItem\",\r\nfunction(a){a.visible&&a.item.legendColor&&a.item.legendSymbol.attr({fill:a.item.legendColor})}),u(c,\"afterUpdate\",function(a,c,b){this.chart.colorAxis[0]&&this.chart.colorAxis[0].update({},b)}))})(m);(function(b){var m=b.defined,k=b.each,v=b.noop;b.colorPointMixin={isValid:function(){return null!==this.value&&Infinity!==this.value&&-Infinity!==this.value},setVisible:function(b){var e=this,h=b?\"show\":\"hide\";k([\"graphic\",\"dataLabel\"],function(b){if(e[b])e[b][h]()})},setState:function(e){b.Point.prototype.setState.call(this,\r\ne);this.graphic&&this.graphic.attr({zIndex:\"hover\"===e?1:0})}};b.colorSeriesMixin={pointArrayMap:[\"value\"],axisTypes:[\"xAxis\",\"yAxis\",\"colorAxis\"],optionalAxis:\"colorAxis\",trackerGroups:[\"group\",\"markerGroup\",\"dataLabelsGroup\"],getSymbol:v,parallelArrays:[\"x\",\"y\",\"value\"],colorKey:\"value\",translateColors:function(){var b=this,l=this.options.nullColor,h=this.colorAxis,m=this.colorKey;k(this.data,function(e){var c=e[m];if(c=e.options.color||(e.isNull?l:h&&void 0!==c?h.toColor(c,e):e.color||b.color))e.color=\r\nc})},colorAttribs:function(b){var e={};m(b.color)&&(e[this.colorProp||\"fill\"]=b.color);return e}}})(m);(function(b){var m=b.colorPointMixin,k=b.each,v=b.merge,e=b.noop,l=b.pick,h=b.Series,t=b.seriesType,q=b.seriesTypes;t(\"heatmap\",\"scatter\",{animation:!1,borderWidth:0,dataLabels:{formatter:function(){return this.point.value},inside:!0,verticalAlign:\"middle\",crop:!1,overflow:!1,padding:0},marker:null,pointRange:null,tooltip:{pointFormat:\"{point.x}, {point.y}: {point.value}\\x3cbr/\\x3e\"},states:{hover:{halo:!1,\r\nbrightness:.2}}},v(b.colorSeriesMixin,{pointArrayMap:[\"y\",\"value\"],hasPointSpecificOptions:!0,getExtremesFromAll:!0,directTouch:!0,init:function(){var b;q.scatter.prototype.init.apply(this,arguments);b=this.options;b.pointRange=l(b.pointRange,b.colsize||1);this.yAxis.axisPointRange=b.rowsize||1},translate:function(){var b=this.options,e=this.xAxis,h=this.yAxis,m=b.pointPadding||0,n=function(a,b,c){return Math.min(Math.max(b,a),c)};this.generatePoints();k(this.points,function(a){var c=(b.colsize||\r\n1)/2,f=(b.rowsize||1)/2,p=n(Math.round(e.len-e.translate(a.x-c,0,1,0,1)),-e.len,2*e.len),c=n(Math.round(e.len-e.translate(a.x+c,0,1,0,1)),-e.len,2*e.len),g=n(Math.round(h.translate(a.y-f,0,1,0,1)),-h.len,2*h.len),f=n(Math.round(h.translate(a.y+f,0,1,0,1)),-h.len,2*h.len),k=l(a.pointPadding,m);a.plotX=a.clientX=(p+c)/2;a.plotY=(g+f)/2;a.shapeType=\"rect\";a.shapeArgs={x:Math.min(p,c)+k,y:Math.min(g,f)+k,width:Math.abs(c-p)-2*k,height:Math.abs(f-g)-2*k}});this.translateColors()},drawPoints:function(){q.column.prototype.drawPoints.call(this);\r\nk(this.points,function(b){b.graphic.css(this.colorAttribs(b))},this)},animate:e,getBox:e,drawLegendSymbol:b.LegendSymbolMixin.drawRectangle,alignDataLabel:q.column.prototype.alignDataLabel,getExtremes:function(){h.prototype.getExtremes.call(this,this.valueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;h.prototype.getExtremes.call(this)}}),b.extend({haloPath:function(b){if(!b)return[];var c=this.shapeArgs;return[\"M\",c.x-b,c.y-b,\"L\",c.x-b,c.y+c.height+b,c.x+c.width+b,c.y+c.height+b,c.x+\r\nc.width+b,c.y-b,\"Z\"]}},m))})(m)});\r\n","Highcharts.maps[\"countries/ru/custom/ru-all-disputed\"] = {\"title\":\"Russia with disputed territories\",\"version\":\"1.1.2\",\"type\":\"FeatureCollection\",\"copyright\":\"Copyright (c) 2015 Highsoft AS, Based on data from Natural Earth\",\"copyrightShort\":\"Natural Earth\",\"copyrightUrl\":\"http://www.naturalearthdata.com\",\"crs\":{\"type\":\"name\",\"properties\":{\"name\":\"urn:ogc:def:crs:EPSG:3576\"}},\"hc-transform\":{\"default\":{\"crs\":\"+proj=laea +lat_0=90 +lon_0=90 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs\",\"scale\":8.41717440945e-05,\"jsonres\":15.5,\"jsonmarginX\":-999,\"jsonmarginY\":9851.0,\"xoffset\":-4119438.21957,\"yoffset\":474572.303972}},\r\n\"features\":[{\"type\":\"Feature\",\"id\":\"RU.SC\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.53,\"hc-middle-y\":0.50,\"hc-key\":\"ru-sc\",\"hc-a2\":\"SC\",\"labelrank\":\"5\",\"hasc\":\"RU.SC\",\"alt-name\":null,\"woe-id\":\"20070189\",\"subregion\":null,\"fips\":null,\"postal-code\":\"SC\",\"name\":\"Sevastopol\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Crimean Peninsula\",\"longitude\":\"33.6396\",\"woe-name\":\"Sevastopol City Municipality\",\"latitude\":\"44.5182\",\"woe-label\":null,\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-997,5645],[-999,5692],[-982,5676],[-956,5694],[-960,5675],[-974,5674],[-968,5667],[-985,5636],[-997,5645]]]}},{\"type\":\"Feature\",\"id\":\"RU.KR\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.24,\"hc-middle-y\":0.08,\"hc-key\":\"ru-kr\",\"hc-a2\":\"KR\",\"labelrank\":\"5\",\"hasc\":\"RU.KR\",\"alt-name\":\"Crimée|Criméia|Krim|Krymskaya Respublika|Respublika Krym\",\"woe-id\":\"2347544\",\"subregion\":null,\"fips\":null,\"postal-code\":\"KR\",\"name\":\"Crimea\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Crimean Peninsula\",\"longitude\":\"34.2784\",\"woe-name\":\"Crimea\",\"latitude\":\"45.3115\",\"woe-label\":null,\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-997,5645],[-985,5636],[-968,5667],[-974,5674],[-960,5675],[-956,5694],[-929,5712],[-928,5733],[-941,5745],[-939,5788],[-963,5819],[-959,5836],[-876,5799],[-836,5757],[-823,5755],[-830,5771],[-797,5786],[-801,5768],[-793,5765],[-805,5755],[-801,5743],[-794,5753],[-790,5743],[-799,5721],[-791,5721],[-788,5734],[-777,5710],[-791,5692],[-782,5695],[-785,5686],[-776,5682],[-771,5689],[-769,5679],[-799,5681],[-766,5665],[-786,5665],[-777,5658],[-788,5654],[-778,5626],[-792,5601],[-803,5605],[-806,5587],[-790,5553],[-770,5629],[-786,5552],[-767,5535],[-745,5534],[-747,5512],[-715,5495],[-701,5464],[-705,5453],[-727,5465],[-749,5448],[-796,5496],[-805,5536],[-832,5535],[-838,5547],[-867,5550],[-888,5584],[-913,5601],[-942,5600],[-970,5612],[-997,5645]]]}},{\"type\":\"Feature\",\"id\":\"RU.2485\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.44,\"hc-middle-y\":0.58,\"hc-key\":\"ru-2485\",\"hc-a2\":\"CA\",\"labelrank\":\"2\",\"hasc\":\"RU.\",\"alt-name\":\"Chukotskiy Avtonomnyy Okrug\",\"woe-id\":\"20070513\",\"subregion\":\"Far Eastern\",\"fips\":\"RS15\",\"postal-code\":null,\"name\":\"Chukchi Autonomous Okrug\",\"country\":\"Russia\",\"type-en\":\"Autonomous Province\",\"region\":\"Far Eastern\",\"longitude\":\"170.516\",\"woe-name\":null,\"latitude\":\"66.7517\",\"woe-label\":null,\"type\":\"Avtonomnyy Okrug\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[7257,8693],[7282,8677],[7280,8661],[7232,8612],[7210,8643],[7243,8696],[7257,8693]]],[[[7123,9331],[7144,9264],[7132,9232],[7148,9216],[7157,9175],[7124,9166],[7096,9180],[7046,9244],[7052,9307],[7094,9353],[7123,9331]]],[[[7183,8343],[7201,8410],[7193,8425],[7233,8457],[7240,8500],[7269,8561],[7240,8613],[7275,8628],[7320,8621],[7351,8670],[7399,8678],[7398,8718],[7380,8750],[7336,8758],[7292,8748],[7268,8719],[7268,8753],[7219,8762],[7247,8828],[7256,8867],[7276,8885],[7262,8901],[7275,8928],[7286,9004],[7326,9096],[7352,9139],[7346,9147],[7378,9193],[7418,9230],[7452,9294],[7482,9302],[7508,9357],[7550,9413],[7570,9427],[7578,9466],[7597,9497],[7643,9509],[7637,9528],[7684,9527],[7722,9543],[7738,9528],[7754,9561],[7790,9563],[7760,9587],[7748,9571],[7731,9589],[7690,9579],[7678,9558],[7673,9621],[7692,9659],[7673,9652],[7675,9712],[7711,9738],[7775,9823],[7771,9849],[7789,9851],[7794,9826],[7816,9807],[7852,9811],[7847,9773],[7872,9770],[7880,9714],[7860,9697],[7946,9728],[7982,9690],[8008,9696],[7981,9709],[7988,9737],[8001,9706],[8038,9732],[8055,9695],[8059,9645],[7999,9567],[8008,9523],[7978,9492],[7960,9499],[7921,9485],[7896,9418],[7921,9392],[7923,9338],[7914,9323],[7838,9294],[7846,9309],[7824,9322],[7793,9315],[7821,9305],[7831,9246],[7876,9249],[7898,9276],[7967,9253],[7985,9218],[8013,9199],[8034,9118],[8020,9082],[7995,9070],[7975,9038],[8006,9060],[7990,8982],[8041,9022],[8023,9040],[8017,9072],[8066,9068],[8097,9102],[8078,9121],[8136,9144],[8182,9149],[8212,9138],[8240,9185],[8273,9181],[8312,9205],[8338,9189],[8360,9158],[8334,9098],[8326,9046],[8294,9049],[8308,9021],[8327,9041],[8335,9004],[8359,8973],[8382,8902],[8419,8839],[8396,8842],[8381,8819],[8328,8822],[8311,8784],[8328,8759],[8319,8700],[8308,8683],[8324,8642],[8313,8623],[8326,8595],[8314,8556],[8258,8536],[8205,8496],[8179,8455],[8130,8516],[8117,8544],[8072,8536],[8056,8508],[8010,8492],[7996,8443],[7950,8422],[7957,8392],[7937,8357],[7939,8334],[7909,8330],[7887,8292],[7907,8286],[7862,8246],[7848,8204],[7863,8175],[7877,8161],[7828,8096],[7778,8079],[7759,8036],[7713,8028],[7647,7971],[7587,8010],[7557,7980],[7539,7984],[7506,8024],[7468,8026],[7409,7993],[7363,8013],[7368,8043],[7351,8035],[7324,8057],[7328,8148],[7346,8209],[7338,8235],[7369,8283],[7334,8312],[7305,8314],[7300,8329],[7261,8323],[7253,8340],[7199,8332],[7183,8343]]]]}},{\"type\":\"Feature\",\"id\":\"RU.AR\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.13,\"hc-middle-y\":0.72,\"hc-key\":\"ru-ar\",\"hc-a2\":\"AR\",\"labelrank\":\"6\",\"hasc\":\"RU.VO\",\"alt-name\":\"Vologodskaya Oblast\",\"woe-id\":\"20070508\",\"subregion\":\"Northern\",\"fips\":\"RS06\",\"postal-code\":\"AR\",\"name\":\"Arkhangel'sk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Northwestern\",\"longitude\":\"41.9939\",\"woe-name\":\"Arkhangel'sk\",\"latitude\":\"63.3132\",\"woe-label\":\"Arkhangelrskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[2743,7085],[2738,7043],[2715,7028],[2723,7057],[2713,7084],[2743,7085]]],[[[3577,8069],[3557,8113],[3583,8105],[3576,8074],[3612,8055],[3587,8020],[3564,8042],[3577,8069]]],[[[3545,8085],[3508,8095],[3508,8114],[3532,8119],[3545,8085]]],[[[3625,7993],[3663,7995],[3628,7970],[3602,8021],[3620,8071],[3650,8050],[3656,8022],[3626,8029],[3625,7993]]],[[[3681,8126],[3697,8118],[3667,8105],[3653,8155],[3681,8126]]],[[[3828,8074],[3826,8030],[3794,8016],[3763,8022],[3761,8049],[3801,8052],[3828,8074]]],[[[3698,8152],[3686,8141],[3655,8170],[3660,8191],[3674,8170],[3680,8188],[3698,8152]]],[[[3415,8268],[3487,8236],[3474,8205],[3472,8236],[3410,8230],[3415,8268]]],[[[3735,8076],[3722,8098],[3762,8093],[3745,8080],[3751,8044],[3736,8025],[3699,8010],[3671,8047],[3696,8078],[3730,8066],[3735,8076]]],[[[3621,8123],[3598,8127],[3591,8152],[3628,8152],[3628,8178],[3647,8151],[3663,8100],[3619,8096],[3621,8123]]],[[[1589,6092],[1569,6117],[1578,6129],[1541,6172],[1515,6159],[1506,6208],[1485,6209],[1467,6244],[1477,6259],[1457,6280],[1424,6256],[1378,6316],[1387,6330],[1361,6344],[1322,6333],[1296,6355],[1289,6388],[1266,6393],[1251,6438],[1225,6456],[1202,6439],[1187,6485],[1134,6519],[1131,6543],[1110,6555],[1105,6588],[1082,6597],[1085,6641],[1090,6655],[1088,6659],[1090,6662],[1092,6659],[1098,6675],[1131,6718],[1188,6748],[1216,6801],[1245,6830],[1229,6854],[1224,6900],[1238,6931],[1280,6965],[1285,6996],[1313,6976],[1356,6995],[1368,6942],[1412,6917],[1453,6948],[1453,6974],[1427,7000],[1460,7079],[1479,7064],[1511,7072],[1520,7024],[1515,6993],[1536,6939],[1541,6890],[1568,6890],[1597,6873],[1615,6885],[1641,6960],[1668,6974],[1699,6964],[1748,6964],[1777,6946],[1823,6945],[1901,6958],[1865,6943],[1860,6923],[1893,6897],[1890,6827],[1930,6853],[1961,6754],[1983,6724],[1997,6671],[2020,6647],[2073,6661],[2110,6626],[2030,6535],[2060,6514],[2047,6450],[2058,6423],[2023,6401],[1998,6436],[1978,6429],[1956,6453],[1905,6448],[1902,6474],[1788,6568],[1760,6576],[1759,6533],[1777,6500],[1782,6468],[1771,6437],[1750,6422],[1761,6373],[1734,6360],[1707,6362],[1696,6334],[1668,6305],[1662,6280],[1692,6277],[1720,6252],[1762,6292],[1798,6279],[1830,6240],[1761,6184],[1747,6185],[1701,6150],[1714,6120],[1668,6083],[1612,6108],[1589,6092]]],[[[3721,8191],[3733,8197],[3733,8197],[3733,8197],[3732,8191],[3721,8191],[3721,8191]]],[[[3721,8191],[3720,8191],[3723,8160],[3751,8128],[3723,8144],[3693,8191],[3721,8191],[3721,8191]]],[[[3000,7251],[2998,7262],[2958,7278],[2995,7294],[2979,7305],[2977,7333],[3035,7332],[3067,7358],[3091,7354],[3092,7372],[3124,7357],[3114,7394],[3147,7384],[3141,7409],[3174,7405],[3153,7429],[3164,7448],[3176,7424],[3221,7452],[3238,7429],[3247,7456],[3272,7452],[3331,7477],[3368,7464],[3374,7479],[3398,7462],[3411,7486],[3430,7481],[3464,7446],[3570,7455],[3632,7486],[3656,7486],[3680,7469],[3685,7439],[3674,7410],[3643,7388],[3591,7371],[3451,7360],[3426,7365],[3355,7361],[3282,7323],[3255,7301],[3236,7314],[3217,7292],[3195,7329],[3187,7275],[3167,7279],[3115,7234],[3043,7198],[3015,7226],[3030,7203],[3015,7185],[2981,7192],[3001,7175],[2983,7157],[2969,7167],[2916,7119],[2915,7101],[2880,7078],[2888,7068],[2871,7029],[2860,6976],[2867,6903],[2880,6872],[2863,6862],[2801,6897],[2792,6934],[2765,6918],[2757,6964],[2742,6965],[2718,7008],[2741,7004],[2743,7026],[2775,7010],[2756,7052],[2766,7077],[2715,7116],[2712,7138],[2735,7176],[2777,7196],[2790,7172],[2852,7227],[2845,7245],[2865,7256],[2891,7239],[2909,7275],[2942,7277],[2955,7263],[2993,7262],[3000,7251]]],[[[3402,8164],[3424,8178],[3402,8184],[3408,8207],[3438,8184],[3434,8208],[3465,8205],[3472,8188],[3493,8194],[3495,8218],[3542,8224],[3532,8211],[3534,8167],[3508,8162],[3455,8179],[3441,8153],[3466,8139],[3446,8123],[3469,8112],[3460,8085],[3439,8113],[3446,8142],[3430,8163],[3402,8164]]],[[[3733,8197],[3734,8206],[3742,8221],[3769,8214],[3733,8197],[3733,8197],[3733,8197]]]]}},{\"type\":\"Feature\",\"id\":\"RU.NN\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.77,\"hc-middle-y\":0.84,\"hc-key\":\"ru-nn\",\"hc-a2\":\"NN\",\"labelrank\":\"2\",\"hasc\":\"RU.NN\",\"alt-name\":\"Nenetskiy A.Okr.|Nenetskiy AOk\",\"woe-id\":\"20070509\",\"subregion\":\"Northern\",\"fips\":\"RS50\",\"postal-code\":\"NN\",\"name\":\"Nenets\",\"country\":\"Russia\",\"type-en\":\"Autonomous Province\",\"region\":\"Northwestern\",\"longitude\":\"56.2877\",\"woe-name\":null,\"latitude\":\"67.8271\",\"woe-label\":null,\"type\":\"Avtonomnyy Okrug\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[2421,6894],[2443,6911],[2380,6896],[2338,6922],[2340,6954],[2379,6990],[2419,6996],[2438,6982],[2451,6925],[2447,6907],[2421,6894]]],[[[2875,6782],[2887,6800],[2919,6806],[2941,6700],[2928,6675],[2886,6698],[2893,6723],[2876,6742],[2875,6782]]],[[[3108,6509],[3070,6490],[3061,6469],[3093,6442],[3079,6390],[3041,6404],[3018,6382],[2972,6376],[2969,6356],[2896,6344],[2881,6321],[2795,6306],[2715,6347],[2651,6386],[2409,6548],[2346,6611],[2296,6618],[2285,6603],[2110,6626],[2073,6661],[2020,6647],[1997,6671],[1983,6724],[1961,6754],[1930,6853],[1969,6868],[1994,6892],[2002,6917],[1993,6946],[2009,6963],[2070,6995],[2120,7035],[2123,7107],[2141,7075],[2190,7023],[2205,6989],[2198,6934],[2177,6897],[2110,6939],[2077,6932],[2053,6913],[2063,6871],[2047,6833],[2070,6796],[2137,6770],[2156,6793],[2189,6808],[2195,6825],[2251,6807],[2267,6820],[2312,6803],[2397,6806],[2400,6796],[2475,6781],[2454,6760],[2488,6751],[2481,6782],[2557,6779],[2576,6752],[2547,6740],[2523,6695],[2510,6717],[2491,6709],[2522,6681],[2544,6683],[2558,6649],[2579,6672],[2645,6671],[2700,6619],[2751,6635],[2804,6628],[2811,6585],[2783,6576],[2770,6549],[2792,6524],[2815,6532],[2820,6563],[2857,6551],[2891,6565],[2905,6589],[2892,6601],[2902,6666],[2932,6664],[2950,6684],[3026,6625],[3083,6566],[3108,6509]]]]}},{\"type\":\"Feature\",\"id\":\"RU.YN\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.58,\"hc-middle-y\":0.72,\"hc-key\":\"ru-yn\",\"hc-a2\":\"YN\",\"labelrank\":\"2\",\"hasc\":\"RU.YN\",\"alt-name\":\"Yamalo-Nenetskiy A.Okr\",\"woe-id\":\"20070525\",\"subregion\":\"West Siberian\",\"fips\":\"RS87\",\"postal-code\":\"YN\",\"name\":\"Yamal-Nenets\",\"country\":\"Russia\",\"type-en\":\"Autonomous Province\",\"region\":\"Urals\",\"longitude\":\"75.1874\",\"woe-name\":\"Yamal-Nenets\",\"latitude\":\"65.4117\",\"woe-label\":\"Yamalo-Nenetskiy Avtonomnyy Okrug, RU, Russia\",\"type\":\"Avtonomnyy Okrug\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[3188,6092],[3227,6062],[3216,6037],[3192,6060],[3188,6092]]],[[[3832,6723],[3794,6729],[3835,6770],[3864,6743],[3832,6723]]],[[[3593,6939],[3607,6940],[3605,6894],[3596,6918],[3537,6914],[3528,6920],[3550,6968],[3594,6970],[3593,6939]]],[[[3079,6390],[3093,6442],[3061,6469],[3070,6490],[3108,6509],[3138,6476],[3129,6470],[3184,6408],[3177,6402],[3213,6318],[3207,6298],[3263,6345],[3287,6382],[3258,6398],[3255,6456],[3264,6476],[3237,6509],[3212,6478],[3211,6516],[3237,6566],[3256,6562],[3260,6591],[3278,6613],[3301,6668],[3263,6680],[3313,6737],[3370,6749],[3409,6781],[3476,6889],[3509,6918],[3509,6903],[3591,6880],[3635,6834],[3618,6774],[3578,6725],[3561,6693],[3541,6687],[3542,6650],[3560,6617],[3557,6584],[3535,6522],[3512,6505],[3506,6442],[3489,6419],[3481,6368],[3462,6322],[3499,6245],[3458,6214],[3441,6147],[3408,6142],[3367,6086],[3315,6060],[3309,6029],[3252,6026],[3219,6084],[3171,6101],[3170,6072],[3225,6009],[3271,5997],[3313,5963],[3340,5971],[3358,6007],[3423,6017],[3451,6036],[3464,6076],[3525,6116],[3540,6150],[3542,6185],[3530,6219],[3549,6259],[3593,6274],[3659,6275],[3666,6239],[3693,6199],[3677,6166],[3686,6157],[3658,6095],[3702,6052],[3756,6051],[3709,6067],[3678,6088],[3692,6140],[3731,6153],[3717,6207],[3723,6244],[3688,6270],[3683,6288],[3624,6323],[3598,6307],[3532,6337],[3548,6366],[3543,6418],[3571,6474],[3612,6513],[3606,6625],[3589,6652],[3619,6680],[3628,6703],[3700,6724],[3717,6756],[3725,6803],[3700,6863],[3729,6864],[3721,6827],[3736,6830],[3750,6778],[3740,6736],[3711,6701],[3702,6671],[3707,6640],[3688,6624],[3718,6591],[3797,6559],[3802,6532],[3821,6518],[3823,6571],[3796,6580],[3743,6633],[3740,6685],[3787,6694],[3809,6658],[3834,6660],[3833,6695],[3811,6692],[3849,6730],[3866,6727],[3869,6697],[3910,6671],[3935,6642],[3919,6613],[3884,6611],[3868,6586],[3898,6538],[3924,6520],[3924,6461],[3814,6368],[3815,6344],[3838,6333],[3849,6287],[3893,6273],[3903,6257],[3955,6270],[3950,6246],[3979,6240],[3980,6189],[4000,6165],[3969,6156],[3975,6113],[3957,6100],[3951,6067],[3916,6070],[3945,6009],[3924,5970],[3976,5902],[3981,5879],[3966,5852],[3987,5809],[3971,5794],[3985,5752],[4012,5751],[4028,5734],[4039,5680],[4015,5629],[4048,5625],[4069,5597],[4097,5606],[4112,5595],[4109,5559],[4118,5527],[4111,5495],[4082,5480],[4049,5426],[4083,5400],[4076,5356],[3987,5239],[3975,5268],[3948,5297],[3913,5287],[3878,5334],[3834,5346],[3816,5333],[3786,5356],[3774,5400],[3738,5392],[3688,5368],[3677,5343],[3608,5357],[3552,5347],[3512,5391],[3500,5432],[3475,5447],[3451,5441],[3424,5471],[3363,5475],[3337,5484],[3324,5506],[3269,5527],[3261,5564],[3226,5551],[3195,5564],[3155,5560],[3169,5610],[3163,5631],[3135,5642],[3127,5694],[3148,5713],[3127,5743],[3107,5746],[3069,5783],[3044,5788],[3034,5759],[3011,5780],[2959,5760],[2930,5780],[2910,5810],[2932,5842],[2891,5875],[2847,5892],[2826,5882],[2793,5896],[2724,5903],[2717,5947],[2681,5972],[2707,5985],[2710,6007],[2744,6056],[2731,6070],[2736,6113],[2729,6132],[2783,6128],[2791,6147],[2855,6190],[2970,6201],[2988,6230],[3056,6253],[3051,6280],[3068,6274],[3081,6312],[3047,6325],[3056,6367],[3079,6390]]]]}},{\"type\":\"Feature\",\"id\":\"RU.KY\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.55,\"hc-middle-y\":0.56,\"hc-key\":\"ru-ky\",\"hc-a2\":\"KY\",\"labelrank\":\"6\",\"hasc\":\"RU.KY\",\"alt-name\":\"Krasnoyarskiy Kray|Yeniseisk|Yeniseyskaya G.\",\"woe-id\":\"20070524\",\"subregion\":\"East Siberian\",\"fips\":\"RS39\",\"postal-code\":\"KY\",\"name\":\"Krasnoyarsk\",\"country\":\"Russia\",\"type-en\":\"Territory\",\"region\":\"Siberian\",\"longitude\":\"95.2029\",\"woe-name\":null,\"latitude\":\"65.5602\",\"woe-label\":null,\"type\":\"Kray\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[3926,6795],[3922,6768],[3894,6774],[3884,6794],[3913,6822],[3926,6795]]],[[[4561,7310],[4546,7303],[4549,7349],[4587,7384],[4587,7366],[4563,7344],[4561,7310]]],[[[4412,7753],[4398,7787],[4471,7769],[4444,7731],[4412,7753]]],[[[5215,7030],[5177,7006],[5163,7012],[5170,7051],[5226,7050],[5218,7037],[5215,7030]]],[[[3987,5239],[4076,5356],[4083,5400],[4049,5426],[4082,5480],[4111,5495],[4118,5527],[4109,5559],[4112,5595],[4097,5606],[4069,5597],[4048,5625],[4015,5629],[4039,5680],[4028,5734],[4012,5751],[3985,5752],[3971,5794],[3987,5809],[3966,5852],[3981,5879],[3976,5902],[3924,5970],[3945,6009],[3916,6070],[3951,6067],[3957,6100],[3975,6113],[3969,6156],[4000,6165],[3980,6189],[3979,6240],[3950,6246],[3955,6270],[3903,6257],[3893,6273],[3849,6287],[3838,6333],[3815,6344],[3814,6368],[3924,6461],[3924,6520],[3898,6538],[3868,6586],[3884,6611],[3919,6613],[3935,6642],[3910,6671],[3869,6697],[3866,6727],[3905,6720],[3994,6605],[4047,6610],[4066,6593],[4049,6556],[4012,6543],[4002,6505],[4008,6471],[3987,6441],[4006,6445],[4011,6473],[4034,6498],[4049,6467],[4045,6416],[4010,6394],[4033,6366],[4026,6401],[4052,6400],[4069,6418],[4051,6531],[4079,6581],[4071,6615],[4046,6628],[4022,6658],[4026,6686],[3984,6702],[3966,6732],[3981,6785],[3966,6844],[3995,6877],[4044,6883],[4106,6874],[4162,6884],[4187,6874],[4195,6890],[4244,6898],[4258,6855],[4278,6885],[4263,6891],[4247,6939],[4217,6952],[4215,6981],[4186,6990],[4217,6998],[4220,6975],[4249,6973],[4238,6994],[4210,7006],[4230,7030],[4250,7014],[4263,7032],[4233,7037],[4262,7054],[4264,7036],[4343,7118],[4374,7136],[4503,7180],[4482,7211],[4542,7221],[4577,7251],[4613,7263],[4612,7237],[4582,7230],[4587,7201],[4627,7226],[4653,7215],[4653,7234],[4679,7250],[4719,7234],[4707,7265],[4678,7296],[4700,7292],[4744,7310],[4750,7345],[4734,7373],[4761,7441],[4787,7486],[4808,7501],[4855,7485],[4870,7493],[4889,7471],[4863,7436],[4839,7420],[4886,7429],[4895,7415],[4920,7430],[4947,7416],[4931,7350],[4975,7369],[4970,7398],[5013,7415],[5039,7415],[5070,7435],[5088,7421],[5120,7432],[5143,7400],[5159,7411],[5196,7350],[5208,7352],[5217,7315],[5164,7333],[5187,7301],[5219,7304],[5232,7273],[5223,7223],[5204,7197],[5152,7094],[5156,7074],[5131,7037],[5112,6973],[5077,6959],[5070,6910],[5052,6907],[5043,6822],[5066,6859],[5063,6891],[5119,6905],[5140,6934],[5169,6955],[5161,6977],[5190,6975],[5220,7020],[5220,6975],[5254,6931],[5250,6908],[5266,6877],[5292,6870],[5296,6845],[5346,6828],[5385,6732],[5426,6719],[5417,6681],[5385,6646],[5352,6625],[5341,6595],[5357,6569],[5330,6552],[5323,6524],[5341,6505],[5341,6465],[5292,6460],[5285,6435],[5235,6392],[5213,6392],[5206,6364],[5265,6303],[5295,6204],[5323,6094],[5266,6029],[5299,6020],[5331,5967],[5323,5950],[5336,5921],[5359,5905],[5371,5858],[5407,5846],[5390,5821],[5393,5797],[5369,5761],[5387,5747],[5367,5710],[5379,5685],[5428,5694],[5527,5692],[5554,5673],[5516,5654],[5514,5633],[5458,5637],[5467,5617],[5464,5563],[5481,5552],[5462,5531],[5455,5499],[5494,5455],[5517,5449],[5501,5392],[5514,5364],[5488,5327],[5496,5308],[5429,5240],[5439,5217],[5424,5165],[5453,5110],[5474,5100],[5518,5105],[5527,5044],[5501,5039],[5490,5015],[5512,4987],[5526,4993],[5552,4947],[5518,4896],[5530,4885],[5503,4861],[5449,4891],[5428,4887],[5370,4931],[5332,4899],[5350,4842],[5329,4807],[5301,4792],[5288,4757],[5259,4735],[5264,4718],[5242,4700],[5261,4656],[5246,4633],[5219,4646],[5173,4715],[5148,4711],[5132,4667],[5098,4652],[5082,4658],[5014,4651],[4981,4540],[5003,4530],[4994,4510],[5020,4508],[5033,4455],[5013,4451],[5014,4424],[4999,4402],[4979,4407],[4954,4354],[4974,4298],[4957,4286],[4950,4252],[4963,4240],[4957,4183],[4913,4186],[4882,4135],[4920,4115],[4964,4068],[4981,4063],[4961,4044],[4942,4055],[4931,4032],[4900,4038],[4867,4014],[4855,4025],[4796,4000],[4793,3944],[4759,3931],[4729,3875],[4722,3844],[4693,3830],[4646,3786],[4565,3777],[4522,3791],[4455,3791],[4420,3828],[4441,3866],[4505,3923],[4500,3952],[4544,3982],[4535,4004],[4509,4013],[4495,4054],[4507,4087],[4478,4146],[4451,4165],[4456,4188],[4416,4198],[4393,4237],[4346,4217],[4305,4215],[4284,4257],[4255,4279],[4295,4313],[4321,4324],[4296,4397],[4257,4418],[4251,4444],[4270,4453],[4261,4472],[4270,4507],[4254,4509],[4283,4555],[4325,4583],[4321,4627],[4283,4629],[4228,4651],[4212,4710],[4249,4762],[4284,4779],[4266,4817],[4216,4814],[4189,4867],[4163,4875],[4155,4903],[4071,4918],[4035,4912],[3975,4919],[3964,4930],[3988,4983],[3956,5055],[4063,5107],[4086,5142],[4053,5155],[3990,5200],[3987,5239]]],[[[4656,7515],[4668,7573],[4679,7681],[4703,7730],[4725,7711],[4724,7645],[4731,7678],[4752,7699],[4781,7663],[4802,7661],[4817,7631],[4813,7603],[4847,7592],[4866,7604],[4863,7580],[4894,7594],[4897,7574],[4863,7576],[4847,7590],[4803,7593],[4780,7572],[4709,7547],[4681,7508],[4656,7515]]],[[[4445,7694],[4484,7748],[4501,7797],[4564,7815],[4590,7775],[4591,7801],[4607,7802],[4636,7768],[4635,7754],[4635,7693],[4621,7692],[4653,7651],[4641,7628],[4595,7619],[4565,7641],[4515,7643],[4495,7670],[4491,7705],[4475,7714],[4445,7694]]],[[[4553,7822],[4489,7800],[4477,7775],[4413,7819],[4422,7845],[4441,7853],[4452,7895],[4434,7890],[4445,7923],[4406,7934],[4375,7937],[4377,7953],[4408,7950],[4445,7923],[4485,7947],[4503,7970],[4536,7918],[4563,7891],[4546,7881],[4553,7822]]]]}},{\"type\":\"Feature\",\"id\":\"RU.CK\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.57,\"hc-middle-y\":0.58,\"hc-key\":\"ru-ck\",\"hc-a2\":\"CK\",\"labelrank\":\"2\",\"hasc\":\"RU.CK\",\"alt-name\":\"Chukotka|Chukotskiy AOk\",\"woe-id\":\"2346881\",\"subregion\":\"Far Eastern\",\"fips\":\"RS63\",\"postal-code\":\"CK\",\"name\":\"Sakha (Yakutia)\",\"country\":\"Russia\",\"type-en\":\"Autonomous Province\",\"region\":\"Far Eastern\",\"longitude\":\"130.989\",\"woe-name\":\"Chukot\",\"latitude\":\"65.5964\",\"woe-label\":\"Sakha, RU, Russia\",\"type\":\"Avtonomnyy Okrug\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[7184,8285],[7224,8269],[7263,8267],[7242,8253],[7193,8266],[7184,8285]]],[[[6179,7748],[6137,7766],[6147,7791],[6182,7771],[6179,7748]]],[[[5277,7145],[5270,7101],[5244,7099],[5208,7116],[5223,7124],[5217,7150],[5268,7162],[5277,7145]]],[[[5899,7752],[5890,7741],[5846,7796],[5882,7785],[5899,7752]]],[[[6231,7691],[6198,7763],[6217,7795],[6241,7805],[6294,7808],[6334,7786],[6330,7768],[6273,7723],[6242,7709],[6231,7691]]],[[[5220,7020],[5217,7025],[5215,7030],[5218,7037],[5226,7050],[5276,7044],[5294,7081],[5323,7046],[5319,7022],[5347,7004],[5353,7021],[5330,7036],[5370,7067],[5390,7096],[5474,7117],[5511,7137],[5537,7089],[5600,7093],[5653,7110],[5700,7138],[5703,7157],[5731,7156],[5722,7202],[5697,7216],[5684,7262],[5704,7260],[5702,7291],[5770,7288],[5787,7306],[5804,7293],[5815,7326],[5853,7345],[5862,7326],[5905,7336],[5940,7330],[5914,7277],[5942,7312],[5964,7291],[5962,7246],[5979,7260],[6014,7245],[6010,7209],[5940,7219],[6124,7130],[6200,7124],[6213,7158],[6193,7211],[6152,7295],[6203,7283],[6234,7284],[6268,7305],[6270,7340],[6291,7381],[6401,7412],[6392,7426],[6335,7406],[6378,7476],[6416,7470],[6435,7506],[6371,7532],[6353,7565],[6334,7541],[6308,7584],[6338,7619],[6342,7645],[6294,7656],[6333,7677],[6459,7795],[6521,7828],[6483,7776],[6462,7768],[6479,7727],[6485,7758],[6526,7831],[6557,7759],[6539,7729],[6563,7719],[6566,7763],[6531,7843],[6562,7887],[6610,7922],[6648,7923],[6659,7898],[6634,7894],[6651,7865],[6677,7901],[6701,7882],[6712,7917],[6741,7901],[6736,7925],[6762,7943],[6804,7946],[6801,7923],[6828,7939],[6862,8001],[6861,8032],[6878,8114],[6923,8202],[6975,8247],[7004,8259],[6995,8305],[7018,8262],[7065,8258],[7108,8220],[7151,8239],[7163,8268],[7237,8245],[7261,8262],[7315,8222],[7270,8267],[7228,8272],[7178,8288],[7193,8306],[7183,8343],[7199,8332],[7253,8340],[7261,8323],[7300,8329],[7305,8314],[7334,8312],[7369,8283],[7338,8235],[7346,8209],[7328,8148],[7324,8057],[7351,8035],[7368,8043],[7363,8013],[7409,7993],[7468,8026],[7506,8024],[7539,7984],[7557,7980],[7588,7965],[7571,7922],[7588,7893],[7572,7870],[7534,7866],[7545,7844],[7516,7817],[7500,7767],[7478,7755],[7492,7726],[7514,7726],[7522,7702],[7501,7687],[7507,7668],[7561,7641],[7555,7590],[7586,7561],[7626,7557],[7651,7503],[7627,7504],[7623,7454],[7606,7414],[7626,7403],[7608,7383],[7567,7394],[7551,7385],[7551,7341],[7530,7309],[7503,7300],[7515,7270],[7537,7276],[7564,7236],[7525,7234],[7525,7204],[7481,7176],[7498,7134],[7492,7094],[7514,7086],[7555,7026],[7608,6996],[7638,6988],[7630,6963],[7656,6950],[7666,6906],[7681,6851],[7665,6836],[7640,6854],[7593,6818],[7607,6790],[7590,6760],[7551,6760],[7547,6741],[7478,6746],[7437,6727],[7442,6690],[7474,6658],[7470,6636],[7503,6565],[7479,6507],[7494,6493],[7488,6467],[7501,6436],[7532,6432],[7570,6375],[7627,6332],[7592,6296],[7600,6244],[7587,6212],[7541,6180],[7518,6175],[7513,6141],[7527,6103],[7487,6068],[7450,6053],[7414,6022],[7398,5975],[7417,5949],[7404,5939],[7425,5911],[7414,5872],[7441,5851],[7453,5819],[7406,5804],[7451,5786],[7483,5784],[7475,5752],[7494,5720],[7469,5686],[7545,5681],[7571,5632],[7544,5610],[7576,5532],[7599,5513],[7537,5463],[7510,5450],[7478,5407],[7493,5388],[7453,5363],[7428,5366],[7381,5313],[7333,5300],[7309,5258],[7279,5243],[7267,5258],[7232,5234],[7200,5235],[7184,5215],[7148,5199],[7124,5212],[7060,5226],[7020,5204],[6974,5200],[6966,5180],[6917,5190],[6877,5166],[6846,5185],[6815,5175],[6766,5142],[6745,5111],[6719,5114],[6711,5135],[6668,5165],[6646,5159],[6627,5179],[6597,5241],[6582,5273],[6554,5273],[6542,5306],[6503,5344],[6506,5363],[6452,5381],[6433,5347],[6368,5336],[6364,5367],[6322,5404],[6285,5415],[6248,5405],[6215,5407],[6185,5372],[6167,5337],[6170,5302],[6152,5247],[6128,5219],[6136,5176],[6084,5119],[6077,5153],[6050,5146],[6035,5169],[6027,5131],[5976,5099],[5940,5096],[5933,5059],[5889,5035],[5826,5083],[5834,5172],[5825,5183],[5825,5231],[5837,5272],[5829,5339],[5808,5332],[5775,5344],[5767,5376],[5736,5412],[5748,5460],[5731,5491],[5687,5487],[5689,5546],[5679,5549],[5653,5601],[5622,5623],[5565,5606],[5562,5640],[5587,5648],[5582,5674],[5558,5705],[5527,5692],[5428,5694],[5379,5685],[5367,5710],[5387,5747],[5369,5761],[5393,5797],[5390,5821],[5407,5846],[5371,5858],[5359,5905],[5336,5921],[5323,5950],[5331,5967],[5299,6020],[5266,6029],[5323,6094],[5295,6204],[5265,6303],[5206,6364],[5213,6392],[5235,6392],[5285,6435],[5292,6460],[5341,6465],[5341,6505],[5323,6524],[5330,6552],[5357,6569],[5341,6595],[5352,6625],[5385,6646],[5417,6681],[5426,6719],[5385,6732],[5346,6828],[5296,6845],[5292,6870],[5266,6877],[5250,6908],[5254,6931],[5220,6975],[5220,7020]]],[[[6155,8035],[6120,8072],[6155,8068],[6159,8085],[6180,8122],[6209,8113],[6213,8134],[6263,8180],[6288,8155],[6277,8098],[6251,8068],[6155,8035]]],[[[6006,7983],[6040,8020],[6108,8036],[6104,8010],[6124,8003],[6140,7965],[6097,7930],[6061,7938],[6034,7982],[6018,7964],[6035,7939],[6096,7918],[6138,7938],[6121,7885],[6100,7884],[6065,7817],[6038,7812],[6063,7783],[6023,7757],[5959,7763],[5927,7778],[5942,7790],[5904,7814],[5902,7838],[5879,7851],[5885,7915],[5903,7909],[5999,7917],[5952,7957],[5969,7968],[5944,7978],[6006,7983]]]]}},{\"type\":\"Feature\",\"id\":\"RU.KH\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.67,\"hc-middle-y\":0.75,\"hc-key\":\"ru-kh\",\"hc-a2\":\"KH\",\"labelrank\":\"6\",\"hasc\":\"RU.KH\",\"alt-name\":\"Khabarovskiy Kray\",\"woe-id\":\"2346883\",\"subregion\":\"Far Eastern\",\"fips\":\"RS30\",\"postal-code\":\"KH\",\"name\":\"Khabarovsk\",\"country\":\"Russia\",\"type-en\":\"Territory\",\"region\":\"Far Eastern\",\"longitude\":\"135.443\",\"woe-name\":\"Khabarovsk\",\"latitude\":\"57.0232\",\"woe-label\":\"Khabarovskiy Kray, RU, Russia\",\"type\":\"Kray\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[8055,5810],[8070,5819],[8059,5869],[8083,5885],[8109,5884],[8123,5856],[8124,5822],[8085,5831],[8080,5805],[8055,5810]]],[[[8067,6824],[8037,6803],[8065,6774],[8036,6746],[8021,6769],[7985,6704],[7930,6640],[7923,6606],[7904,6588],[7887,6514],[7911,6428],[7903,6366],[7911,6334],[7940,6293],[7930,6247],[7942,6217],[7933,6161],[7935,6100],[7952,6025],[7968,6022],[7958,5997],[7963,5952],[7954,5814],[7958,5756],[7946,5727],[7946,5689],[7966,5675],[8011,5691],[8078,5765],[8145,5678],[8171,5706],[8159,5739],[8134,5735],[8142,5797],[8153,5822],[8159,5743],[8198,5763],[8213,5695],[8243,5739],[8249,5781],[8240,5822],[8258,5806],[8265,5760],[8283,5775],[8254,5832],[8217,5862],[8267,5893],[8280,5932],[8331,5941],[8350,5927],[8395,5928],[8437,5946],[8497,5946],[8497,5910],[8550,5885],[8554,5862],[8596,5865],[8627,5842],[8636,5795],[8630,5775],[8649,5758],[8648,5736],[8676,5713],[8686,5684],[8715,5647],[8762,5619],[8780,5622],[8785,5586],[8825,5572],[8880,5487],[8917,5444],[8924,5314],[8949,5260],[8909,5239],[8884,5250],[8887,5286],[8853,5282],[8809,5308],[8792,5298],[8784,5241],[8757,5210],[8759,5189],[8831,5190],[8852,5208],[8870,5197],[8857,5118],[8822,5099],[8841,5065],[8835,5011],[8778,4958],[8757,4963],[8729,4931],[8727,4946],[8686,4938],[8661,4894],[8659,4864],[8682,4836],[8654,4801],[8607,4873],[8616,4914],[8611,4962],[8564,4979],[8553,5010],[8519,4999],[8548,5026],[8542,5063],[8511,5033],[8485,5034],[8474,5003],[8437,4992],[8397,4966],[8360,4989],[8322,4972],[8308,4980],[8284,4948],[8247,4950],[8259,4914],[8238,4912],[8215,4876],[8207,4900],[8157,4954],[8140,4946],[8139,4973],[8106,4984],[8066,4966],[8055,4992],[8032,4973],[8010,5060],[8032,5097],[7996,5129],[8018,5147],[8051,5210],[8042,5243],[8050,5268],[8082,5302],[8081,5318],[8052,5323],[8035,5346],[8148,5407],[8137,5441],[8101,5462],[8090,5512],[8069,5526],[8028,5522],[8011,5469],[7971,5452],[7959,5417],[7967,5401],[7903,5329],[7860,5288],[7855,5303],[7808,5341],[7772,5313],[7730,5297],[7712,5326],[7715,5359],[7735,5383],[7714,5418],[7740,5495],[7733,5515],[7751,5535],[7741,5582],[7703,5605],[7680,5589],[7662,5557],[7615,5516],[7599,5513],[7576,5532],[7544,5610],[7571,5632],[7545,5681],[7469,5686],[7494,5720],[7475,5752],[7483,5784],[7451,5786],[7406,5804],[7453,5819],[7441,5851],[7414,5872],[7425,5911],[7404,5939],[7417,5949],[7398,5975],[7414,6022],[7450,6053],[7487,6068],[7527,6103],[7513,6141],[7518,6175],[7541,6180],[7587,6212],[7600,6244],[7592,6296],[7627,6332],[7570,6375],[7532,6432],[7501,6436],[7488,6467],[7494,6493],[7479,6507],[7503,6565],[7470,6636],[7474,6658],[7442,6690],[7437,6727],[7478,6746],[7547,6741],[7551,6760],[7590,6760],[7607,6790],[7593,6818],[7640,6854],[7665,6836],[7681,6851],[7666,6906],[7705,6939],[7705,6964],[7742,6980],[7788,6980],[7856,6950],[7867,6919],[7892,6901],[7876,6884],[7875,6838],[7898,6817],[7924,6820],[7939,6862],[8000,6859],[8021,6877],[8069,6840],[8067,6824]]]]}},{\"type\":\"Feature\",\"id\":\"RU.SL\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.35,\"hc-middle-y\":0.75,\"hc-key\":\"ru-sl\",\"hc-a2\":\"SL\",\"labelrank\":\"2\",\"hasc\":\"RU.SL\",\"alt-name\":\"Sakhalinskaya Oblast\",\"woe-id\":\"2346937\",\"subregion\":\"Far Eastern\",\"fips\":\"RS64\",\"postal-code\":\"SL\",\"name\":\"Sakhalin\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Far Eastern\",\"longitude\":\"152.467\",\"woe-name\":\"Sakhalin\",\"latitude\":\"47.3479\",\"woe-label\":\"Sakhalinskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[9772,6213],[9802,6123],[9809,6049],[9800,6028],[9782,6068],[9787,6084],[9774,6141],[9785,6169],[9772,6213]]],[[[9768,6400],[9783,6359],[9779,6339],[9762,6387],[9768,6400]]],[[[9554,6756],[9583,6777],[9586,6792],[9621,6765],[9629,6733],[9583,6776],[9554,6756]]],[[[9841,5550],[9841,5550],[9841,5550],[9841,5550],[9841,5550],[9841,5550],[9841,5550]]],[[[9841,5550],[9833,5588],[9834,5633],[9851,5668],[9849,5632],[9833,5588],[9844,5554],[9841,5550],[9841,5550]]],[[[9496,6939],[9471,6925],[9495,6941],[9493,6996],[9523,6984],[9505,6961],[9549,6916],[9547,6845],[9516,6857],[9521,6910],[9496,6939]]],[[[9841,5550],[9831,5536],[9769,5517],[9756,5522],[9753,5568],[9726,5639],[9761,5677],[9754,5623],[9767,5567],[9766,5538],[9784,5523],[9827,5538],[9841,5550],[9841,5550],[9841,5550]]],[[[9784,5851],[9766,5824],[9779,5797],[9788,5711],[9775,5709],[9769,5738],[9755,5804],[9754,5856],[9733,5878],[9761,5876],[9772,5900],[9764,5945],[9772,5963],[9792,5957],[9776,5886],[9784,5851]]],[[[8735,5966],[8756,5968],[8826,5943],[8943,5888],[8988,5881],[9054,5860],[9089,5843],[9135,5837],[9070,5822],[9012,5771],[9029,5772],[9023,5739],[9047,5710],[9117,5600],[9144,5579],[9191,5570],[9229,5577],[9298,5546],[9313,5580],[9363,5558],[9375,5528],[9341,5536],[9331,5551],[9286,5504],[9265,5510],[9260,5478],[9313,5387],[9288,5384],[9221,5422],[9188,5479],[9123,5518],[9099,5566],[9059,5591],[8992,5607],[8989,5623],[8914,5706],[8841,5761],[8815,5769],[8781,5806],[8770,5832],[8716,5851],[8663,5844],[8593,5897],[8581,5928],[8539,5970],[8492,5989],[8502,6036],[8523,6027],[8523,6069],[8502,6065],[8514,6091],[8481,6105],[8426,6107],[8434,6122],[8431,6146],[8477,6142],[8506,6107],[8540,6102],[8601,6081],[8653,6048],[8687,6004],[8735,5966]]]]}},{\"type\":\"Feature\",\"id\":\"RU.KA\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.66,\"hc-middle-y\":0.73,\"hc-key\":\"ru-ka\",\"hc-a2\":\"KA\",\"labelrank\":\"2\",\"hasc\":\"RU.KA\",\"alt-name\":\"Kamçatka|Kamchatskaya Oblast\",\"woe-id\":\"20070514\",\"subregion\":\"Far Eastern\",\"fips\":\"RS26\",\"postal-code\":\"KA\",\"name\":\"Kamchatka\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Far Eastern\",\"longitude\":\"160.187\",\"woe-name\":\"Kamchatka\",\"latitude\":\"56.5325\",\"woe-label\":\"Kamchatskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[9192,8027],[9207,8053],[9227,8045],[9277,8069],[9296,8065],[9271,8044],[9212,8025],[9197,8007],[9192,8027]]],[[[8648,8034],[8641,8054],[8673,8059],[8693,8045],[8689,8010],[8712,7954],[8673,7980],[8648,8034]]],[[[8419,8839],[8413,8817],[8438,8791],[8422,8774],[8448,8766],[8492,8701],[8485,8683],[8533,8648],[8536,8616],[8565,8582],[8567,8554],[8597,8526],[8638,8511],[8619,8480],[8569,8470],[8540,8441],[8522,8358],[8539,8274],[8588,8210],[8591,8189],[8507,8232],[8504,8206],[8524,8176],[8538,8127],[8552,8129],[8571,8092],[8521,8081],[8535,8052],[8512,8017],[8533,8016],[8538,7989],[8563,7983],[8574,7962],[8608,7963],[8605,7945],[8634,7951],[8671,7870],[8737,7814],[8759,7810],[8794,7840],[8770,7864],[8819,7901],[8847,7871],[8851,7849],[8933,7820],[8946,7854],[9024,7843],[9040,7810],[9001,7786],[8980,7816],[8967,7800],[8975,7773],[8993,7784],[9000,7742],[9059,7690],[9089,7677],[9132,7675],[9170,7688],[9203,7638],[9194,7602],[9175,7593],[9171,7556],[9197,7482],[9218,7460],[9273,7432],[9337,7432],[9303,7402],[9306,7339],[9317,7300],[9367,7262],[9379,7268],[9424,7222],[9459,7153],[9503,7026],[9464,7043],[9445,7031],[9325,7073],[9222,7085],[9098,7123],[9020,7137],[8906,7172],[8815,7226],[8735,7295],[8720,7359],[8682,7404],[8631,7408],[8626,7426],[8648,7459],[8627,7490],[8642,7513],[8615,7606],[8573,7681],[8543,7704],[8528,7746],[8505,7769],[8506,7794],[8462,7867],[8453,7899],[8425,7911],[8413,7978],[8401,7992],[8398,8061],[8381,8045],[8345,8096],[8331,8081],[8300,8110],[8223,8138],[8205,8173],[8225,8217],[8176,8185],[8171,8091],[8199,8090],[8207,8067],[8231,8067],[8261,8042],[8283,8063],[8302,8035],[8271,8026],[8272,8004],[8230,8002],[8212,8024],[8192,8005],[8190,8046],[8133,8059],[8099,8043],[8077,8050],[8071,8084],[8042,8088],[8016,8117],[7982,8110],[7971,8128],[7941,8128],[7943,8153],[7921,8179],[7893,8168],[7863,8175],[7848,8204],[7862,8246],[7907,8286],[7887,8292],[7909,8330],[7939,8334],[7937,8357],[7957,8392],[7950,8422],[7996,8443],[8010,8492],[8056,8508],[8072,8536],[8117,8544],[8130,8516],[8179,8455],[8205,8496],[8258,8536],[8314,8556],[8326,8595],[8313,8623],[8324,8642],[8308,8683],[8319,8700],[8328,8759],[8311,8784],[8328,8822],[8381,8819],[8396,8842],[8419,8839]]]]}},{\"type\":\"Feature\",\"id\":\"RU.KT\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.44,\"hc-middle-y\":0.41,\"hc-key\":\"ru-kt\",\"hc-a2\":\"KT\",\"labelrank\":\"6\",\"hasc\":\"RU.KT\",\"alt-name\":\"Kostromskaya\",\"woe-id\":\"2346903\",\"subregion\":\"Central\",\"fips\":\"RS37\",\"postal-code\":\"KT\",\"name\":\"Kostroma\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"43.4689\",\"woe-name\":\"Kostroma\",\"latitude\":\"58.3882\",\"woe-label\":\"Kostromskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[1211,6123],[1210,6123],[1211,6130],[1214,6129],[1211,6123]]],[[[1400,6028],[1374,6007],[1373,5947],[1360,5930],[1341,5945],[1300,5933],[1269,5948],[1208,5913],[1154,5958],[1124,5996],[1104,5976],[1036,5973],[999,6002],[999,6022],[968,6025],[944,6052],[970,6073],[923,6103],[912,6154],[877,6132],[839,6151],[799,6183],[834,6207],[836,6197],[875,6231],[952,6238],[962,6273],[992,6269],[1024,6283],[1062,6274],[1075,6259],[1110,6285],[1104,6266],[1127,6241],[1122,6219],[1171,6191],[1205,6128],[1234,6092],[1246,6093],[1292,6048],[1332,6041],[1362,6067],[1400,6028]]]]}},{\"type\":\"Feature\",\"id\":\"RU.MS\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.45,\"hc-middle-y\":0.59,\"hc-key\":\"ru-ms\",\"hc-a2\":\"MS\",\"labelrank\":\"9\",\"hasc\":\"RU.MS\",\"alt-name\":\"Mosca|Moscou|Moscow|Mosc£|Moskau|Moskova|Moskovskaya\",\"woe-id\":\"2346910\",\"subregion\":\"Central\",\"fips\":\"RS47\",\"postal-code\":\"MS\",\"name\":\"Moskva\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"37.6188\",\"woe-name\":\"Moskva\",\"latitude\":\"55.7177\",\"woe-label\":\"Moskva, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[452,6263],[445,6271],[451,6274],[459,6263],[452,6263]]],[[[496,6276],[489,6276],[489,6284],[498,6288],[496,6276]]],[[[375,6204],[385,6215],[390,6239],[422,6262],[429,6239],[464,6240],[489,6257],[504,6229],[413,6199],[375,6204]]]]}},{\"type\":\"Feature\",\"id\":\"RU.RZ\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.53,\"hc-middle-y\":0.49,\"hc-key\":\"ru-rz\",\"hc-a2\":\"RZ\",\"labelrank\":\"6\",\"hasc\":\"RU.RZ\",\"alt-name\":\"Ryazanskaya Oblast|Ryazanskaya Oblast\",\"woe-id\":\"2346922\",\"subregion\":\"Central\",\"fips\":\"RS62\",\"postal-code\":\"RZ\",\"name\":\"Ryazan'\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"40.6258\",\"woe-name\":\"Ryazan'\",\"latitude\":\"54.3363\",\"woe-label\":\"Ryazanskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[653,5820],[651,5823],[654,5829],[657,5827],[653,5820]]],[[[367,5849],[369,5901],[315,5922],[317,5958],[354,5994],[378,6032],[410,6030],[425,6053],[450,6029],[486,6038],[536,6023],[531,6038],[578,6022],[597,6003],[590,5985],[615,5967],[628,5925],[648,5901],[653,5860],[675,5848],[662,5833],[646,5824],[647,5791],[621,5777],[586,5787],[599,5760],[570,5771],[569,5749],[548,5748],[540,5753],[534,5757],[487,5804],[461,5786],[437,5787],[422,5833],[378,5837],[367,5849]]]]}},{\"type\":\"Feature\",\"id\":\"RU.SA\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.36,\"hc-middle-y\":0.44,\"hc-key\":\"ru-sa\",\"hc-a2\":\"SA\",\"labelrank\":\"6\",\"hasc\":\"RU.SA\",\"alt-name\":\"Kuybyshev|Kuybyshevskaya|Samarskaya Oblast\",\"woe-id\":\"2346906\",\"subregion\":\"Volga\",\"fips\":\"RS65\",\"postal-code\":\"SA\",\"name\":\"Samara\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"50.4377\",\"woe-name\":\"Samara\",\"latitude\":\"53.1783\",\"woe-label\":\"Samarskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[1167,5083],[1164,5088],[1169,5091],[1171,5086],[1167,5083]]],[[[1114,5334],[1132,5313],[1127,5289],[1148,5289],[1156,5268],[1179,5284],[1217,5278],[1243,5231],[1237,5206],[1276,5195],[1272,5182],[1249,5191],[1233,5166],[1240,5149],[1191,5119],[1166,5112],[1163,5092],[1122,5058],[1083,5061],[1070,5041],[1057,5053],[1038,5027],[1019,5026],[998,4999],[921,5001],[931,5019],[913,5073],[889,5104],[891,5134],[874,5174],[843,5184],[850,5219],[828,5244],[845,5250],[868,5255],[850,5285],[861,5301],[865,5341],[882,5345],[904,5325],[939,5349],[960,5320],[983,5325],[1019,5287],[1054,5265],[1107,5301],[1114,5334]]]]}},{\"type\":\"Feature\",\"id\":\"RU.UL\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.40,\"hc-middle-y\":0.51,\"hc-key\":\"ru-ul\",\"hc-a2\":\"UL\",\"labelrank\":\"7\",\"hasc\":\"RU.UL\",\"alt-name\":\"Simbirsk|Simbirskaya G.|Ul'yanovskaya Oblast\",\"woe-id\":\"2346931\",\"subregion\":\"Volga\",\"fips\":\"RS81\",\"postal-code\":\"UL\",\"name\":\"Ul'yanovsk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"47.3773\",\"woe-name\":\"Ul'yanovsk\",\"latitude\":\"53.9248\",\"woe-label\":\"Ulryanovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[1019,5498],[1025,5501],[1027,5498],[1021,5497],[1019,5498]]],[[[782,5538],[815,5542],[873,5513],[874,5544],[897,5574],[912,5534],[940,5516],[934,5488],[978,5491],[1014,5460],[1016,5439],[1041,5420],[1094,5418],[1086,5365],[1114,5334],[1107,5301],[1054,5265],[1019,5287],[983,5325],[960,5320],[939,5349],[904,5325],[882,5345],[865,5341],[861,5301],[850,5285],[868,5255],[845,5250],[790,5280],[776,5275],[730,5314],[719,5334],[744,5340],[792,5401],[781,5445],[800,5502],[782,5538]]]]}},{\"type\":\"Feature\",\"id\":\"RU.OM\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.51,\"hc-middle-y\":0.52,\"hc-key\":\"ru-om\",\"hc-a2\":\"OM\",\"labelrank\":\"6\",\"hasc\":\"RU.OM\",\"alt-name\":\"Omskaya Oblast\",\"woe-id\":\"2346915\",\"subregion\":\"West Siberian\",\"fips\":\"RS54\",\"postal-code\":\"OM\",\"name\":\"Omsk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Siberian\",\"longitude\":\"73.3995\",\"woe-name\":\"Omsk\",\"latitude\":\"56.0471\",\"woe-label\":\"Omskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[2770,4626],[2767,4628],[2772,4632],[2774,4632],[2770,4626]]],[[[2765,4620],[2761,4622],[2765,4623],[2767,4621],[2765,4620]]],[[[3106,4253],[3037,4227],[3016,4236],[2982,4225],[2971,4198],[2936,4231],[2883,4217],[2875,4252],[2912,4284],[2873,4299],[2870,4320],[2842,4331],[2818,4305],[2816,4368],[2796,4348],[2773,4369],[2764,4356],[2734,4376],[2718,4367],[2710,4402],[2728,4395],[2745,4449],[2733,4460],[2744,4500],[2741,4533],[2712,4542],[2718,4559],[2749,4574],[2740,4616],[2774,4620],[2783,4666],[2814,4689],[2823,4711],[2865,4702],[2881,4725],[2865,4751],[2855,4795],[2821,4785],[2808,4821],[2831,4828],[2825,4871],[2833,4890],[2893,4958],[2919,4927],[2901,4888],[2959,4875],[2967,4858],[3021,4839],[3044,4852],[3129,4825],[3214,4867],[3225,4845],[3204,4836],[3197,4803],[3225,4771],[3219,4734],[3246,4666],[3243,4592],[3199,4563],[3217,4563],[3228,4519],[3182,4524],[3112,4487],[3121,4447],[3099,4436],[3134,4315],[3121,4310],[3106,4253]]]]}},{\"type\":\"Feature\",\"id\":\"RU.NS\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.46,\"hc-middle-y\":0.52,\"hc-key\":\"ru-ns\",\"hc-a2\":\"NS\",\"labelrank\":\"6\",\"hasc\":\"RU.NS\",\"alt-name\":\"Novosibirskaya Oblast\",\"woe-id\":\"2346914\",\"subregion\":\"West Siberian\",\"fips\":\"RS53\",\"postal-code\":\"NS\",\"name\":\"Novosibirsk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Siberian\",\"longitude\":\"80.08320000000001\",\"woe-name\":\"Novosibirsk\",\"latitude\":\"55.3139\",\"woe-label\":\"Novosibirskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[3265,4104],[3173,4215],[3166,4243],[3191,4235],[3218,4275],[3106,4253],[3121,4310],[3134,4315],[3099,4436],[3121,4447],[3112,4487],[3182,4524],[3228,4519],[3217,4563],[3199,4563],[3243,4592],[3246,4666],[3309,4643],[3431,4612],[3430,4607],[3518,4562],[3565,4485],[3634,4487],[3665,4443],[3732,4447],[3798,4466],[3810,4452],[3791,4423],[3814,4372],[3796,4353],[3831,4344],[3862,4383],[3901,4384],[3911,4383],[3909,4340],[3932,4290],[3928,4234],[3943,4217],[3930,4198],[3939,4162],[3903,4146],[3879,4121],[3863,4133],[3799,4127],[3781,4105],[3765,4123],[3720,4090],[3692,4049],[3639,4090],[3645,4126],[3617,4125],[3613,4145],[3582,4160],[3571,4196],[3543,4174],[3467,4149],[3423,4123],[3374,4131],[3346,4115],[3313,4118],[3312,4133],[3265,4104]]]}},{\"type\":\"Feature\",\"id\":\"RU.MM\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.63,\"hc-middle-y\":0.50,\"hc-key\":\"ru-mm\",\"hc-a2\":\"MM\",\"labelrank\":\"6\",\"hasc\":\"RU.MM\",\"alt-name\":\"Murmanskaya Oblast\",\"woe-id\":\"2346912\",\"subregion\":\"Northern\",\"fips\":\"RS28\",\"postal-code\":\"MM\",\"name\":\"Murmansk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Northwestern\",\"longitude\":\"34.3212\",\"woe-name\":\"Murmansk\",\"latitude\":\"67.9609\",\"woe-label\":\"Murmanskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"MultiPolygon\",\"coordinates\":[[[[1536,7384],[1548,7377],[1537,7377],[1536,7383],[1536,7384]]],[[[1429,7574],[1467,7613],[1554,7608],[1579,7617],[1608,7679],[1607,7718],[1640,7750],[1689,7755],[1689,7776],[1736,7754],[1758,7761],[1785,7739],[1826,7742],[1829,7711],[1863,7732],[1865,7696],[1892,7678],[1914,7691],[1907,7622],[1891,7626],[1880,7662],[1873,7635],[1884,7609],[1864,7610],[1891,7586],[1896,7551],[1934,7460],[1936,7347],[1921,7284],[1930,7279],[1927,7212],[1938,7186],[1940,7113],[1896,7068],[1879,7034],[1851,7023],[1779,7018],[1707,7044],[1668,7074],[1648,7107],[1633,7173],[1617,7197],[1595,7257],[1598,7301],[1578,7314],[1586,7338],[1568,7375],[1577,7425],[1590,7436],[1577,7465],[1547,7408],[1554,7387],[1532,7393],[1521,7408],[1487,7404],[1473,7425],[1498,7465],[1487,7491],[1429,7574]]]]}},{\"type\":\"Feature\",\"id\":\"RU.LN\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.40,\"hc-middle-y\":0.15,\"hc-key\":\"ru-ln\",\"hc-a2\":\"LN\",\"labelrank\":\"2\",\"hasc\":\"RU.LN\",\"alt-name\":\"Saint Petersburg|Sankt-Peterburgskaya G.|Leningradskaya Oblast\",\"woe-id\":\"2346907\",\"subregion\":\"Northwestern\",\"fips\":\"RS42\",\"postal-code\":\"LN\",\"name\":\"Leningrad\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Northwestern\",\"longitude\":\"32.7736\",\"woe-name\":\"Leningrad\",\"latitude\":\"59.9905\",\"woe-label\":\"Leningradskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[427,7156],[471,7161],[460,7143],[488,7141],[499,7169],[539,7187],[535,7157],[564,7161],[577,7128],[605,7128],[618,7089],[598,7028],[638,7008],[639,7030],[665,7056],[655,7115],[635,7122],[623,7151],[636,7175],[626,7188],[648,7213],[647,7190],[678,7209],[638,7227],[625,7254],[726,7226],[769,7210],[763,7182],[774,7164],[818,6948],[844,6932],[890,6930],[895,6906],[915,6909],[906,6939],[919,6941],[966,6885],[998,6835],[1000,6815],[956,6798],[932,6808],[917,6787],[844,6750],[853,6728],[820,6696],[792,6681],[723,6700],[696,6764],[702,6799],[684,6839],[640,6844],[631,6866],[646,6890],[621,6925],[601,6914],[562,6917],[569,6931],[511,6938],[492,6975],[464,6959],[446,6965],[433,6998],[444,7012],[452,7062],[431,7111],[442,7129],[427,7156]]]}},{\"type\":\"Feature\",\"id\":\"RU.SP\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.40,\"hc-middle-y\":0.73,\"hc-key\":\"ru-sp\",\"hc-a2\":\"SP\",\"labelrank\":\"7\",\"hasc\":\"RU.SP\",\"alt-name\":\"Sankt-Peterburg gorsovet\",\"woe-id\":\"20070507\",\"subregion\":\"Northwestern\",\"fips\":\"RS52\",\"postal-code\":\"SP\",\"name\":\"City of St. Petersburg\",\"country\":\"Russia\",\"type-en\":\"City\",\"region\":\"Northwestern\",\"longitude\":\"30.2901\",\"woe-name\":\"City of St. Petersburg\",\"latitude\":\"59.8064\",\"woe-label\":\"St. Peterburg, RU, Russia\",\"type\":\"Gorsovet\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[635,7122],[655,7115],[665,7056],[639,7030],[638,7008],[598,7028],[618,7089],[624,7056],[644,7059],[650,7094],[635,7122]]]}},{\"type\":\"Feature\",\"id\":\"RU.KI\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.60,\"hc-middle-y\":0.46,\"hc-key\":\"ru-ki\",\"hc-a2\":\"KI\",\"labelrank\":\"2\",\"hasc\":\"RU.KI\",\"alt-name\":\"Karelian A.S.S.R.|Karelo-Finnish A.S.S.R.|Karel'skaya A.S.S.R.|Olonets|Olonetskaya G.|Kareliya|Republic of Karelia\",\"woe-id\":\"2346873\",\"subregion\":\"Northern\",\"fips\":\"RS28\",\"postal-code\":\"KI\",\"name\":\"Karelia\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Northwestern\",\"longitude\":\"33.1446\",\"woe-name\":\"Karelia\",\"latitude\":\"63.5295\",\"woe-label\":\"Kareliya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1532,7393],[1531,7391],[1536,7384],[1536,7383],[1537,7377],[1541,7341],[1523,7335],[1529,7276],[1516,7241],[1495,7223],[1440,7219],[1420,7180],[1463,7137],[1440,7118],[1446,7142],[1415,7173],[1371,7130],[1357,7136],[1349,7080],[1370,7060],[1356,6995],[1313,6976],[1285,6996],[1280,6965],[1238,6931],[1224,6900],[1229,6854],[1245,6830],[1216,6801],[1188,6748],[1131,6718],[1107,6744],[1106,6768],[1081,6787],[1062,6783],[1000,6815],[998,6835],[966,6885],[919,6941],[906,6939],[915,6909],[895,6906],[890,6930],[844,6932],[818,6948],[774,7164],[763,7182],[769,7210],[822,7198],[925,7188],[985,7175],[1045,7185],[1068,7227],[1075,7289],[1092,7338],[1140,7325],[1170,7339],[1174,7381],[1223,7407],[1215,7423],[1233,7448],[1267,7449],[1316,7486],[1331,7467],[1381,7510],[1429,7574],[1487,7491],[1498,7465],[1473,7425],[1487,7404],[1521,7408],[1532,7393]]]}},{\"type\":\"Feature\",\"id\":\"RU.KC\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.25,\"hc-middle-y\":0.60,\"hc-key\":\"ru-kc\",\"hc-a2\":\"KC\",\"labelrank\":\"2\",\"hasc\":\"RU.KC\",\"alt-name\":\"Karaçay-Çerkes|Karachay-Cherkessiya|Karachayevo-Cherkesskaya Respublika|Karachayevo-Cherkessiya|Karachayevo-Cherkess Republic|K\",\"woe-id\":\"20070522\",\"subregion\":\"North Caucasus\",\"fips\":\"RS32\",\"postal-code\":\"KC\",\"name\":\"Karachay-Cherkess\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"41.6866\",\"woe-name\":\"Karachay-Cherkess\",\"latitude\":\"43.7073\",\"woe-label\":\"Karachayevo-Cherkesiya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-512,4775],[-539,4795],[-576,4844],[-578,4868],[-602,4904],[-611,4944],[-563,4972],[-545,4962],[-532,4980],[-507,4920],[-480,4916],[-439,4938],[-398,4849],[-429,4860],[-438,4840],[-415,4827],[-431,4799],[-467,4801],[-512,4775]]]}},{\"type\":\"Feature\",\"id\":\"RU.IN\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.83,\"hc-middle-y\":0.15,\"hc-key\":\"ru-in\",\"hc-a2\":\"IN\",\"labelrank\":\"2\",\"hasc\":\"RU.IN\",\"alt-name\":\"Ingouchie|Inguchétia|Inguschetien|Ingushetia|Ingushetiya|Ingush Republic|Ingushskaya Respublika|Respublika Ingushetiya\",\"woe-id\":\"20070521\",\"subregion\":\"North Caucasus\",\"fips\":\"RS19\",\"postal-code\":\"IN\",\"name\":\"Ingush\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"44.8468\",\"woe-name\":\"Ingush\",\"latitude\":\"43.3661\",\"woe-label\":\"Ingushetiya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-347,4497],[-358,4522],[-378,4515],[-378,4538],[-365,4552],[-351,4529],[-324,4546],[-328,4610],[-309,4625],[-282,4601],[-274,4575],[-329,4499],[-347,4497]]]}},{\"type\":\"Feature\",\"id\":\"RU.KB\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.46,\"hc-middle-y\":0.56,\"hc-key\":\"ru-kb\",\"hc-a2\":\"KB\",\"labelrank\":\"2\",\"hasc\":\"RU.KB\",\"alt-name\":\"Kabardin A.S.S.R.|Kabardino-Balkarskaya A.S.S.R.|Kabardino-Balkariya|Kabardino-Balkarsk|Kabard|Kabardino-Balkarskaya Republic\",\"woe-id\":\"2346871\",\"subregion\":\"North Caucasus\",\"fips\":\"RS22\",\"postal-code\":\"KB\",\"name\":\"Kabardin-Balkar\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"43.3982\",\"woe-name\":\"Kabardin-Balkar\",\"latitude\":\"43.3757\",\"woe-label\":\"Kabardino-Balkariya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-465,4656],[-478,4681],[-475,4708],[-503,4746],[-512,4775],[-467,4801],[-431,4799],[-379,4771],[-381,4745],[-346,4715],[-317,4715],[-296,4680],[-304,4668],[-308,4640],[-328,4629],[-367,4646],[-383,4633],[-388,4657],[-446,4646],[-465,4656]]]}},{\"type\":\"Feature\",\"id\":\"RU.NO\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.21,\"hc-middle-y\":0.55,\"hc-key\":\"ru-no\",\"hc-a2\":\"NO\",\"labelrank\":\"2\",\"hasc\":\"RU.NO\",\"alt-name\":\"Kuzey Osetya|Respublika Severnaya Osetiya|Severnaya Osetiya-Alaniya|North Ossetian A.S.S.R.|Republic of North Osetia-Alania\",\"woe-id\":\"2346877\",\"subregion\":\"North Caucasus\",\"fips\":\"RS68\",\"postal-code\":\"NO\",\"name\":\"North Ossetia\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"44.1653\",\"woe-name\":null,\"latitude\":\"42.9969\",\"woe-label\":null,\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-282,4601],[-309,4625],[-328,4610],[-324,4546],[-351,4529],[-365,4552],[-378,4538],[-411,4565],[-453,4579],[-464,4599],[-445,4609],[-465,4656],[-446,4646],[-388,4657],[-383,4633],[-367,4646],[-328,4629],[-308,4640],[-304,4668],[-264,4624],[-275,4608],[-282,4601]]]}},{\"type\":\"Feature\",\"id\":\"RU.ST\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.46,\"hc-middle-y\":0.48,\"hc-key\":\"ru-st\",\"hc-a2\":\"ST\",\"labelrank\":\"7\",\"hasc\":\"RU.ST\",\"alt-name\":\"Stavropol'skiy Kray|Stavropolskiy Kray\",\"woe-id\":\"2346887\",\"subregion\":\"North Caucasus\",\"fips\":\"RS70\",\"postal-code\":\"ST\",\"name\":\"Stavropol'\",\"country\":\"Russia\",\"type-en\":\"Territory\",\"region\":\"Volga\",\"longitude\":\"43.2791\",\"woe-name\":\"Stavropol'\",\"latitude\":\"44.981\",\"woe-label\":\"Stavropolrskiy Kray, RU, Russia\",\"type\":\"Kray\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-275,4608],[-264,4624],[-304,4668],[-296,4680],[-317,4715],[-346,4715],[-381,4745],[-379,4771],[-431,4799],[-415,4827],[-438,4840],[-429,4860],[-398,4849],[-439,4938],[-437,4986],[-394,4992],[-406,5006],[-391,5036],[-415,5064],[-396,5108],[-378,5119],[-343,5091],[-331,5117],[-309,5101],[-287,5076],[-259,5037],[-226,5010],[-175,5003],[-161,4943],[-131,4898],[-139,4850],[-130,4817],[-110,4792],[-74,4691],[-81,4664],[-108,4651],[-152,4661],[-167,4625],[-201,4636],[-171,4604],[-187,4587],[-204,4580],[-227,4616],[-243,4600],[-275,4608]]]}},{\"type\":\"Feature\",\"id\":\"RU.SM\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.50,\"hc-middle-y\":0.66,\"hc-key\":\"ru-sm\",\"hc-a2\":\"SM\",\"labelrank\":\"6\",\"hasc\":\"RU.SM\",\"alt-name\":\"Smolenskaya Oblast\",\"woe-id\":\"2346925\",\"subregion\":\"Central\",\"fips\":\"RS69\",\"postal-code\":\"SM\",\"name\":\"Smolensk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"33.0803\",\"woe-name\":\"Smolensk\",\"latitude\":\"54.6726\",\"woe-label\":\"Smolenskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[141,6697],[170,6700],[184,6666],[208,6638],[202,6619],[221,6602],[240,6552],[268,6526],[315,6513],[337,6516],[350,6496],[353,6454],[383,6418],[373,6392],[316,6357],[313,6348],[237,6343],[200,6362],[168,6359],[171,6384],[154,6413],[80,6388],[59,6403],[47,6390],[-27,6404],[-26,6433],[-7,6444],[-14,6480],[-32,6505],[3,6519],[-0,6569],[39,6609],[40,6651],[79,6650],[101,6684],[141,6697]]]}},{\"type\":\"Feature\",\"id\":\"RU.PS\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.49,\"hc-middle-y\":0.44,\"hc-key\":\"ru-ps\",\"hc-a2\":\"PS\",\"labelrank\":\"6\",\"hasc\":\"RU.PS\",\"alt-name\":\"Pskovskaya Oblast\",\"woe-id\":\"2346920\",\"subregion\":\"Northwestern\",\"fips\":\"RS60\",\"postal-code\":\"PS\",\"name\":\"Pskov\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Northwestern\",\"longitude\":\"29.1229\",\"woe-name\":\"Pskov\",\"latitude\":\"57.2449\",\"woe-label\":\"Pskovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[184,6666],[170,6700],[141,6697],[144,6767],[126,6791],[91,6812],[120,6836],[114,6867],[94,6877],[105,6901],[87,6924],[140,6967],[168,7015],[159,7025],[222,7038],[233,7089],[275,7094],[296,7066],[322,7062],[335,7088],[318,7109],[326,7123],[366,7119],[427,7156],[442,7129],[431,7111],[452,7062],[444,7012],[433,6998],[446,6965],[409,6973],[390,6960],[384,6932],[401,6888],[372,6863],[332,6849],[296,6813],[310,6789],[282,6792],[273,6759],[253,6752],[253,6706],[221,6686],[206,6692],[184,6666]]]}},{\"type\":\"Feature\",\"id\":\"RU.TV\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.47,\"hc-middle-y\":0.46,\"hc-key\":\"ru-tv\",\"hc-a2\":\"TV\",\"labelrank\":\"6\",\"hasc\":\"RU.TV\",\"alt-name\":\"Kalinin|Kalininskaya|Tverskaya Oblast\",\"woe-id\":\"2346898\",\"subregion\":\"Central\",\"fips\":\"RS77\",\"postal-code\":\"TV\",\"name\":\"Tver'\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"34.5445\",\"woe-name\":\"Tver'\",\"latitude\":\"57.0297\",\"woe-label\":\"Tverskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[184,6666],[206,6692],[221,6686],[253,6706],[253,6752],[273,6759],[282,6792],[310,6789],[331,6749],[358,6748],[404,6710],[447,6700],[466,6664],[493,6679],[541,6674],[549,6695],[589,6678],[606,6621],[627,6628],[633,6608],[665,6608],[701,6567],[723,6561],[738,6542],[791,6544],[806,6530],[788,6466],[744,6458],[745,6429],[718,6439],[700,6408],[703,6380],[679,6365],[696,6329],[671,6323],[630,6278],[618,6295],[623,6328],[593,6329],[568,6350],[541,6336],[537,6357],[474,6387],[454,6439],[383,6418],[353,6454],[350,6496],[337,6516],[315,6513],[268,6526],[240,6552],[221,6602],[202,6619],[208,6638],[184,6666]]]}},{\"type\":\"Feature\",\"id\":\"RU.VO\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.34,\"hc-middle-y\":0.35,\"hc-key\":\"ru-vo\",\"hc-a2\":\"VO\",\"labelrank\":\"6\",\"hasc\":\"RU.VO\",\"alt-name\":\"Vologodskaya Oblast\",\"woe-id\":\"2346934\",\"subregion\":\"Northern\",\"fips\":\"RS85\",\"postal-code\":\"VO\",\"name\":\"Vologda\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Northwestern\",\"longitude\":\"40.9333\",\"woe-name\":\"Vologda\",\"latitude\":\"59.6397\",\"woe-label\":\"Vologodskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[788,6466],[806,6530],[791,6544],[738,6542],[723,6561],[735,6565],[737,6613],[708,6652],[722,6657],[723,6700],[792,6681],[820,6696],[853,6728],[844,6750],[917,6787],[932,6808],[956,6798],[1000,6815],[1062,6783],[1081,6787],[1106,6768],[1107,6744],[1131,6718],[1098,6675],[1092,6659],[1092,6658],[1091,6654],[1090,6655],[1085,6641],[1082,6597],[1105,6588],[1110,6555],[1131,6543],[1134,6519],[1187,6485],[1202,6439],[1225,6456],[1251,6438],[1266,6393],[1289,6388],[1296,6355],[1322,6333],[1361,6344],[1387,6330],[1378,6316],[1424,6256],[1457,6280],[1477,6259],[1467,6244],[1485,6209],[1506,6208],[1515,6159],[1442,6113],[1416,6134],[1415,6101],[1442,6082],[1411,6062],[1400,6028],[1362,6067],[1332,6041],[1292,6048],[1246,6093],[1234,6092],[1205,6128],[1171,6191],[1122,6219],[1127,6241],[1104,6266],[1110,6285],[1075,6259],[1062,6274],[1024,6283],[992,6269],[962,6273],[921,6317],[933,6346],[930,6382],[902,6425],[879,6409],[835,6461],[788,6466]],[[1211,6123],[1214,6129],[1211,6130],[1210,6123],[1211,6123]]]}},{\"type\":\"Feature\",\"id\":\"RU.IV\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.49,\"hc-middle-y\":0.49,\"hc-key\":\"ru-iv\",\"hc-a2\":\"IV\",\"labelrank\":\"7\",\"hasc\":\"RU.IV\",\"alt-name\":\"Ivanovskaya Oblast\",\"woe-id\":\"2346897\",\"subregion\":\"Central\",\"fips\":\"RS21\",\"postal-code\":\"IV\",\"name\":\"Ivanovo\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"41.6244\",\"woe-name\":\"Ivanovo\",\"latitude\":\"57.1213\",\"woe-label\":\"Ivanovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[691,6203],[724,6219],[757,6212],[799,6183],[839,6151],[877,6132],[912,6154],[923,6103],[970,6073],[944,6052],[968,6025],[999,6022],[999,6002],[997,5985],[969,5993],[955,5965],[929,5962],[884,5992],[850,5958],[828,5971],[816,5994],[793,5999],[801,6021],[747,6074],[731,6118],[694,6126],[696,6163],[715,6176],[691,6203]]]}},{\"type\":\"Feature\",\"id\":\"RU.YS\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.61,\"hc-middle-y\":0.45,\"hc-key\":\"ru-ys\",\"hc-a2\":\"YS\",\"labelrank\":\"6\",\"hasc\":\"RU.YS\",\"alt-name\":\"Yaroslavskaya Oblast\",\"woe-id\":\"2346936\",\"subregion\":\"Central\",\"fips\":\"RS88\",\"postal-code\":\"YS\",\"name\":\"Yaroslavl'\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"39.2547\",\"woe-name\":\"Yaroslavl'\",\"latitude\":\"57.7329\",\"woe-label\":\"Yaroslavskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[799,6183],[757,6212],[724,6219],[691,6203],[658,6192],[642,6225],[621,6238],[628,6264],[627,6270],[630,6278],[671,6323],[696,6329],[679,6365],[703,6380],[700,6408],[718,6439],[745,6429],[744,6458],[788,6466],[835,6461],[879,6409],[902,6425],[930,6382],[933,6346],[921,6317],[962,6273],[952,6238],[875,6231],[836,6197],[834,6207],[799,6183]]]}},{\"type\":\"Feature\",\"id\":\"RU.KG\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.51,\"hc-middle-y\":0.52,\"hc-key\":\"ru-kg\",\"hc-a2\":\"KG\",\"labelrank\":\"7\",\"hasc\":\"RU.KG\",\"alt-name\":\"Kaluzhskaya Oblast\",\"woe-id\":\"2346899\",\"subregion\":\"Central\",\"fips\":\"RS25\",\"postal-code\":\"KG\",\"name\":\"Kaluga\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"35.3416\",\"woe-name\":\"Kaluga\",\"latitude\":\"54.2421\",\"woe-label\":\"Kaluzhskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[390,6239],[385,6215],[375,6204],[370,6192],[365,6182],[322,6170],[316,6195],[301,6165],[285,6161],[262,6193],[232,6214],[225,6192],[185,6197],[164,6171],[114,6198],[92,6192],[81,6213],[86,6226],[63,6268],[84,6278],[100,6327],[82,6351],[80,6388],[154,6413],[171,6384],[168,6359],[200,6362],[237,6343],[313,6348],[328,6338],[352,6283],[375,6280],[390,6239]]]}},{\"type\":\"Feature\",\"id\":\"RU.BR\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.62,\"hc-middle-y\":0.63,\"hc-key\":\"ru-br\",\"hc-a2\":\"BR\",\"labelrank\":\"7\",\"hasc\":\"RU.BR\",\"alt-name\":\"Bryanskaya Oblast\",\"woe-id\":\"2346892\",\"subregion\":\"Central\",\"fips\":\"RS10\",\"postal-code\":\"BR\",\"name\":\"Bryansk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"33.2803\",\"woe-name\":\"Bryansk\",\"latitude\":\"53.0868\",\"woe-label\":\"Bryanskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[80,6388],[82,6351],[100,6327],[84,6278],[63,6268],[86,6226],[81,6213],[63,6201],[65,6178],[15,6201],[11,6166],[-38,6153],[-82,6148],[-115,6164],[-126,6153],[-126,6185],[-103,6205],[-96,6238],[-117,6255],[-125,6287],[-153,6299],[-174,6350],[-208,6342],[-230,6366],[-214,6412],[-154,6456],[-147,6488],[-117,6488],[-102,6462],[-99,6427],[-70,6410],[-27,6404],[47,6390],[59,6403],[80,6388]]]}},{\"type\":\"Feature\",\"id\":\"RU.KS\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.15,\"hc-middle-y\":0.28,\"hc-key\":\"ru-ks\",\"hc-a2\":\"KS\",\"labelrank\":\"7\",\"hasc\":\"RU.KS\",\"alt-name\":\"Kurskaya Oblast\",\"woe-id\":\"2346905\",\"subregion\":\"Central Black Earth\",\"fips\":\"RS41\",\"postal-code\":\"KS\",\"name\":\"Kursk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"36.2921\",\"woe-name\":\"Kursk\",\"latitude\":\"51.7358\",\"woe-label\":\"Kurskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-173,6014],[-158,6046],[-180,6072],[-201,6123],[-181,6123],[-155,6161],[-126,6153],[-115,6164],[-82,6148],[-38,6153],[7,6107],[-10,6090],[43,6043],[42,5988],[56,5958],[53,5932],[84,5910],[84,5879],[110,5864],[88,5832],[64,5847],[38,5807],[24,5853],[-24,5899],[-36,5892],[-84,5918],[-112,5975],[-146,5970],[-173,6014]]]}},{\"type\":\"Feature\",\"id\":\"RU.LP\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.57,\"hc-middle-y\":0.42,\"hc-key\":\"ru-lp\",\"hc-a2\":\"LP\",\"labelrank\":\"7\",\"hasc\":\"RU.LP\",\"alt-name\":\"Lipetskaya Oblast\",\"woe-id\":\"2346908\",\"subregion\":\"Central Black Earth\",\"fips\":\"RS43\",\"postal-code\":\"LP\",\"name\":\"Lipetsk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"39.2073\",\"woe-name\":\"Lipetsk\",\"latitude\":\"52.7462\",\"woe-label\":\"Lipetskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[110,5864],[84,5879],[84,5910],[102,5919],[137,5915],[147,5962],[176,5966],[197,5986],[208,5986],[220,5946],[245,5935],[266,5966],[290,5952],[317,5958],[315,5922],[369,5901],[367,5849],[306,5807],[282,5803],[279,5754],[287,5716],[242,5701],[183,5776],[177,5810],[156,5816],[149,5846],[110,5864]]]}},{\"type\":\"Feature\",\"id\":\"RU.2509\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.56,\"hc-middle-y\":0.76,\"hc-key\":\"ru-2509\",\"hc-a2\":\"MO\",\"labelrank\":\"2\",\"hasc\":\"RU.MS\",\"alt-name\":\"Moskovsskaya Oblast\",\"woe-id\":\"2346911\",\"subregion\":\"Central\",\"fips\":null,\"postal-code\":null,\"name\":\"Moskovsskaya\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"38.671\",\"woe-name\":\"Moskovsskaya\",\"latitude\":\"55.1508\",\"woe-label\":\"Moskovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[630,6278],[627,6270],[628,6264],[603,6250],[560,6185],[578,6155],[579,6118],[612,6094],[603,6057],[578,6022],[531,6038],[536,6023],[486,6038],[450,6029],[425,6053],[410,6030],[378,6032],[391,6076],[409,6080],[394,6117],[401,6134],[371,6152],[365,6182],[370,6192],[375,6204],[413,6199],[504,6229],[489,6257],[464,6240],[429,6239],[422,6262],[390,6239],[375,6280],[352,6283],[328,6338],[313,6348],[316,6357],[373,6392],[383,6418],[454,6439],[474,6387],[537,6357],[541,6336],[568,6350],[593,6329],[623,6328],[618,6295],[630,6278]],[[452,6263],[459,6263],[451,6274],[445,6271],[452,6263]],[[496,6276],[498,6288],[489,6284],[489,6276],[496,6276]]]}},{\"type\":\"Feature\",\"id\":\"RU.OL\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.55,\"hc-middle-y\":0.48,\"hc-key\":\"ru-ol\",\"hc-a2\":\"OL\",\"labelrank\":\"7\",\"hasc\":\"RU.OL\",\"alt-name\":\"Orlovskaya|Or'ol|Oryol|Orlovskaya Oblast\",\"woe-id\":\"2346917\",\"subregion\":\"Central\",\"fips\":\"RS56\",\"postal-code\":\"OL\",\"name\":\"Orel\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"36.4166\",\"woe-name\":\"Orel\",\"latitude\":\"52.8778\",\"woe-label\":\"Orlovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-38,6153],[11,6166],[15,6201],[65,6178],[63,6201],[81,6213],[92,6192],[114,6198],[164,6171],[171,6086],[188,6053],[213,6030],[199,6020],[197,5986],[176,5966],[147,5962],[137,5915],[102,5919],[84,5910],[53,5932],[56,5958],[42,5988],[43,6043],[-10,6090],[7,6107],[-38,6153]]]}},{\"type\":\"Feature\",\"id\":\"RU.NZ\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.27,\"hc-middle-y\":0.40,\"hc-key\":\"ru-nz\",\"hc-a2\":\"NZ\",\"labelrank\":\"2\",\"hasc\":\"RU.NZ\",\"alt-name\":\"Gor'kiy|Gor'kovskaya|Gorky|Nizhegorodskaya|Nizhniy-Novgorod\",\"woe-id\":\"2346895\",\"subregion\":\"Volga-Vyatka\",\"fips\":\"RS51\",\"postal-code\":\"NZ\",\"name\":\"Nizhegorod\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"44.7751\",\"woe-name\":\"Nizhegorod\",\"latitude\":\"56.1384\",\"woe-label\":\"Nizhegorodskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[662,5833],[675,5848],[653,5860],[648,5901],[698,5907],[713,5930],[750,5924],[803,5937],[819,5926],[828,5971],[850,5958],[884,5992],[929,5962],[955,5965],[969,5993],[997,5985],[999,6002],[1036,5973],[1104,5976],[1124,5996],[1154,5958],[1208,5913],[1208,5902],[1263,5852],[1277,5826],[1223,5795],[1179,5833],[1124,5780],[1069,5813],[1046,5793],[1024,5803],[1012,5790],[1026,5770],[1005,5757],[1006,5716],[953,5697],[960,5647],[917,5638],[899,5625],[881,5642],[890,5659],[859,5661],[844,5647],[803,5655],[791,5629],[753,5658],[739,5707],[745,5731],[724,5783],[693,5786],[664,5815],[662,5833]]]}},{\"type\":\"Feature\",\"id\":\"RU.PZ\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.61,\"hc-middle-y\":0.63,\"hc-key\":\"ru-pz\",\"hc-a2\":\"PZ\",\"labelrank\":\"7\",\"hasc\":\"RU.PZ\",\"alt-name\":\"Penzenskaya Oblast\",\"woe-id\":\"2346918\",\"subregion\":\"Volga\",\"fips\":\"RS57\",\"postal-code\":\"PZ\",\"name\":\"Penza\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"44.8159\",\"woe-name\":\"Penza\",\"latitude\":\"53.0562\",\"woe-label\":\"Penzenskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[534,5757],[540,5753],[548,5748],[550,5725],[574,5716],[598,5691],[617,5705],[649,5664],[641,5641],[669,5585],[686,5577],[696,5601],[740,5574],[742,5555],[782,5538],[800,5502],[781,5445],[792,5401],[744,5340],[719,5334],[687,5374],[641,5368],[618,5405],[586,5424],[570,5422],[560,5476],[524,5467],[496,5519],[450,5561],[455,5576],[486,5575],[504,5734],[534,5757]]]}},{\"type\":\"Feature\",\"id\":\"RU.VL\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.49,\"hc-middle-y\":0.70,\"hc-key\":\"ru-vl\",\"hc-a2\":\"VL\",\"labelrank\":\"7\",\"hasc\":\"RU.VL\",\"alt-name\":\"Vladimirskaya\",\"woe-id\":\"2346932\",\"subregion\":\"Central\",\"fips\":\"RS83\",\"postal-code\":\"VL\",\"name\":\"Vladimir\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"40.6207\",\"woe-name\":\"Vladimir\",\"latitude\":\"55.8966\",\"woe-label\":\"Vladimirskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[628,6264],[621,6238],[642,6225],[658,6192],[691,6203],[715,6176],[696,6163],[694,6126],[731,6118],[747,6074],[801,6021],[793,5999],[816,5994],[828,5971],[819,5926],[803,5937],[750,5924],[713,5930],[698,5907],[648,5901],[628,5925],[615,5967],[590,5985],[597,6003],[578,6022],[603,6057],[612,6094],[579,6118],[578,6155],[560,6185],[603,6250],[628,6264]]]}},{\"type\":\"Feature\",\"id\":\"RU.VR\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.42,\"hc-middle-y\":0.65,\"hc-key\":\"ru-vr\",\"hc-a2\":\"VR\",\"labelrank\":\"6\",\"hasc\":\"RU.VR\",\"alt-name\":\"Voronezhskaya Oblast\",\"woe-id\":\"2346935\",\"subregion\":\"Central Black Earth\",\"fips\":\"RS86\",\"postal-code\":\"VR\",\"name\":\"Voronezh\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"40.5223\",\"woe-name\":\"Voronezh\",\"latitude\":\"50.7774\",\"woe-label\":\"Voronezhskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-29,5521],[-54,5541],[-50,5576],[-65,5594],[-60,5617],[-36,5629],[-11,5681],[15,5692],[10,5732],[32,5731],[41,5755],[21,5781],[38,5807],[64,5847],[88,5832],[110,5864],[149,5846],[156,5816],[177,5810],[183,5776],[242,5701],[263,5664],[244,5654],[276,5629],[318,5543],[332,5528],[334,5481],[319,5466],[269,5501],[249,5535],[224,5529],[163,5548],[167,5505],[118,5484],[101,5472],[66,5479],[32,5471],[-1,5491],[-29,5521]]]}},{\"type\":\"Feature\",\"id\":\"RU.KO\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.46,\"hc-middle-y\":0.52,\"hc-key\":\"ru-ko\",\"hc-a2\":\"KO\",\"labelrank\":\"2\",\"hasc\":\"RU.KO\",\"alt-name\":\"Komi A.S.S.R.|Republic of Komi|Respublika Komi\",\"woe-id\":\"2346874\",\"subregion\":\"Northern\",\"fips\":\"RS34\",\"postal-code\":\"KO\",\"name\":\"Komi\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Northwestern\",\"longitude\":\"55.8183\",\"woe-name\":\"Komi\",\"latitude\":\"64.1194\",\"woe-label\":\"Komi, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[2325,5753],[2307,5742],[2295,5721],[2241,5723],[2123,5802],[2096,5802],[2071,5782],[2050,5804],[2028,5791],[2008,5811],[1967,5795],[1910,5856],[1895,5844],[1873,5868],[1885,5884],[1862,5911],[1845,5899],[1827,5918],[1810,5907],[1786,5931],[1756,5906],[1773,5862],[1755,5842],[1748,5861],[1684,5845],[1668,5879],[1637,5870],[1608,5888],[1557,5893],[1519,5852],[1503,5865],[1518,5882],[1499,5918],[1515,5933],[1488,5967],[1530,6020],[1562,6023],[1589,6092],[1612,6108],[1668,6083],[1714,6120],[1701,6150],[1747,6185],[1761,6184],[1830,6240],[1798,6279],[1762,6292],[1720,6252],[1692,6277],[1662,6280],[1668,6305],[1696,6334],[1707,6362],[1734,6360],[1761,6373],[1750,6422],[1771,6437],[1782,6468],[1777,6500],[1759,6533],[1760,6576],[1788,6568],[1902,6474],[1905,6448],[1956,6453],[1978,6429],[1998,6436],[2023,6401],[2058,6423],[2047,6450],[2060,6514],[2030,6535],[2110,6626],[2285,6603],[2296,6618],[2346,6611],[2409,6548],[2651,6386],[2715,6347],[2795,6306],[2881,6321],[2896,6344],[2969,6356],[2972,6376],[3018,6382],[3041,6404],[3079,6390],[3056,6367],[3047,6325],[3081,6312],[3068,6274],[3051,6280],[3056,6253],[2988,6230],[2970,6201],[2855,6190],[2791,6147],[2783,6128],[2729,6132],[2660,6105],[2660,6096],[2599,6071],[2582,6107],[2534,6087],[2492,6023],[2500,6005],[2471,5987],[2411,5924],[2383,5879],[2372,5811],[2329,5770],[2325,5753]]]}},{\"type\":\"Feature\",\"id\":\"RU.SV\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.64,\"hc-middle-y\":0.50,\"hc-key\":\"ru-sv\",\"hc-a2\":\"SV\",\"labelrank\":\"6\",\"hasc\":\"RU.SV\",\"alt-name\":\"Yekaterinburg|Sverdlovskaya Oblast\",\"woe-id\":\"2346926\",\"subregion\":\"Urals\",\"fips\":\"RS71\",\"postal-code\":\"SV\",\"name\":\"Sverdlovsk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Urals\",\"longitude\":\"61.7078\",\"woe-name\":\"Sverdlovsk\",\"latitude\":\"58.8952\",\"woe-label\":\"Sverdlovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[2295,5721],[2307,5742],[2325,5753],[2349,5725],[2341,5700],[2407,5656],[2461,5567],[2470,5514],[2454,5500],[2449,5414],[2464,5384],[2456,5331],[2438,5291],[2511,5234],[2519,5126],[2535,5112],[2522,5069],[2521,5029],[2399,5024],[2375,4943],[2373,4904],[2359,4909],[2351,4924],[2309,4930],[2279,4901],[2231,4948],[2163,4964],[2164,4976],[2111,4958],[2100,4939],[2080,4979],[2039,5003],[2037,4987],[1969,5023],[1936,5058],[1895,5084],[1878,5071],[1850,5070],[1762,5137],[1773,5161],[1796,5205],[1799,5231],[1826,5220],[1873,5217],[1903,5279],[1927,5288],[1949,5259],[1976,5265],[1980,5306],[2074,5331],[2084,5359],[2068,5379],[2101,5421],[2068,5494],[2094,5517],[2149,5533],[2217,5585],[2239,5610],[2256,5668],[2287,5696],[2295,5721]]]}},{\"type\":\"Feature\",\"id\":\"RU.BK\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.35,\"hc-middle-y\":0.50,\"hc-key\":\"ru-bk\",\"hc-a2\":\"BK\",\"labelrank\":\"2\",\"hasc\":\"RU.BK\",\"alt-name\":\"Bashkir|Bashkiriya|Bashkirskaya A.S.S.R.|Republic of Bashkortostan|Respublika Bashkortostan\",\"woe-id\":\"2346866\",\"subregion\":\"Urals\",\"fips\":\"RS08\",\"postal-code\":\"BK\",\"name\":\"Bashkortostan\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"56.5575\",\"woe-name\":\"Bashkortostan\",\"latitude\":\"54.2086\",\"woe-label\":\"Bashkortostan, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1476,5294],[1517,5291],[1562,5309],[1591,5320],[1602,5275],[1636,5254],[1679,5247],[1676,5219],[1707,5215],[1718,5161],[1742,5153],[1773,5161],[1762,5137],[1850,5070],[1878,5071],[1895,5054],[1861,5019],[1870,4967],[1839,4977],[1828,4965],[1792,4976],[1780,4944],[1760,4944],[1751,4985],[1710,4972],[1740,5009],[1707,5040],[1661,5030],[1642,4996],[1662,4960],[1673,4908],[1712,4908],[1725,4888],[1771,4886],[1782,4876],[1834,4894],[1852,4865],[1808,4842],[1800,4806],[1784,4798],[1761,4820],[1733,4806],[1710,4809],[1651,4728],[1647,4708],[1603,4667],[1596,4637],[1596,4616],[1560,4618],[1558,4599],[1524,4574],[1491,4591],[1460,4629],[1401,4620],[1398,4647],[1374,4677],[1390,4681],[1391,4723],[1369,4742],[1398,4742],[1406,4769],[1397,4799],[1349,4782],[1334,4804],[1358,4857],[1339,4868],[1349,4936],[1307,4991],[1301,5053],[1311,5095],[1328,5135],[1377,5164],[1379,5235],[1416,5219],[1451,5222],[1499,5240],[1496,5269],[1476,5294]]]}},{\"type\":\"Feature\",\"id\":\"RU.UD\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.52,\"hc-middle-y\":0.48,\"hc-key\":\"ru-ud\",\"hc-a2\":\"UD\",\"labelrank\":\"2\",\"hasc\":\"RU.UD\",\"alt-name\":\"Udmurtiya|Udmurt Republic|Udmurtskaya A.S.S.R.|Udmurtskaya Respublika\",\"woe-id\":\"2346880\",\"subregion\":\"Urals\",\"fips\":\"RS80\",\"postal-code\":\"UD\",\"name\":\"Udmurt\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"52.7957\",\"woe-name\":\"Udmurt\",\"latitude\":\"57.3433\",\"woe-label\":\"Udmurtiya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1562,5309],[1517,5291],[1476,5294],[1448,5306],[1494,5329],[1479,5352],[1471,5330],[1456,5359],[1490,5390],[1433,5388],[1444,5370],[1419,5357],[1395,5387],[1384,5370],[1329,5410],[1362,5424],[1348,5434],[1377,5503],[1390,5495],[1419,5509],[1411,5523],[1425,5572],[1445,5589],[1469,5569],[1505,5576],[1536,5613],[1538,5643],[1583,5661],[1634,5612],[1662,5613],[1662,5587],[1695,5572],[1679,5546],[1678,5507],[1659,5471],[1637,5457],[1644,5435],[1617,5394],[1594,5390],[1578,5369],[1566,5383],[1550,5364],[1569,5357],[1562,5309]]]}},{\"type\":\"Feature\",\"id\":\"RU.MR\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.37,\"hc-middle-y\":0.43,\"hc-key\":\"ru-mr\",\"hc-a2\":\"MR\",\"labelrank\":\"2\",\"hasc\":\"RU.MR\",\"alt-name\":\"Mordov|Mordvian Autonomous Republic|Mordvinia|Republic of Mordovia|Mordovian A.S.S.R.\",\"woe-id\":\"2346876\",\"subregion\":\"Volga-Vyatka\",\"fips\":\"RS46\",\"postal-code\":\"MR\",\"name\":\"Mordovia\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"44.4631\",\"woe-name\":\"Mordovia\",\"latitude\":\"54.1154\",\"woe-label\":\"Mordoviya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[897,5574],[874,5544],[873,5513],[815,5542],[782,5538],[742,5555],[740,5574],[696,5601],[686,5577],[669,5585],[641,5641],[649,5664],[617,5705],[598,5691],[574,5716],[550,5725],[548,5748],[569,5749],[570,5771],[599,5760],[586,5787],[621,5777],[647,5791],[646,5824],[662,5833],[664,5815],[693,5786],[724,5783],[745,5731],[739,5707],[753,5658],[791,5629],[803,5655],[844,5647],[859,5661],[890,5659],[881,5642],[899,5625],[911,5619],[897,5574]],[[653,5820],[657,5827],[654,5829],[651,5823],[653,5820]]]}},{\"type\":\"Feature\",\"id\":\"RU.CV\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.48,\"hc-middle-y\":0.49,\"hc-key\":\"ru-cv\",\"hc-a2\":\"CV\",\"labelrank\":\"2\",\"hasc\":\"RU.CV\",\"alt-name\":\"Chuvashskaya A.S.S.R.|Chuvashskaya Respublika|Chuvashiya|Chuvash Republic\",\"woe-id\":\"2346869\",\"subregion\":\"Volga-Vyatka\",\"fips\":\"RS16\",\"postal-code\":\"CV\",\"name\":\"Chuvash\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"47.1662\",\"woe-name\":\"Chuvash\",\"latitude\":\"55.4883\",\"woe-label\":\"Chuvashiya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[897,5574],[911,5619],[899,5625],[917,5638],[960,5647],[953,5697],[1006,5716],[1040,5697],[1079,5692],[1105,5677],[1094,5659],[1117,5625],[1108,5600],[1123,5566],[1079,5568],[1043,5542],[1034,5511],[990,5498],[973,5526],[940,5516],[912,5534],[897,5574]]]}},{\"type\":\"Feature\",\"id\":\"RU.CL\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.34,\"hc-middle-y\":0.68,\"hc-key\":\"ru-cl\",\"hc-a2\":\"CL\",\"labelrank\":\"6\",\"hasc\":\"RU.CL\",\"alt-name\":\"Chelyabinskaya\",\"woe-id\":\"2346893\",\"subregion\":\"Urals\",\"fips\":\"RS13\",\"postal-code\":\"CL\",\"name\":\"Chelyabinsk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Urals\",\"longitude\":\"60.2383\",\"woe-name\":\"Chelyabinsk\",\"latitude\":\"54.1131\",\"woe-label\":\"Chelyabinskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1878,5071],[1895,5084],[1936,5058],[1969,5023],[2037,4987],[2039,5003],[2080,4979],[2100,4939],[2095,4897],[2106,4887],[2099,4842],[2060,4846],[2041,4835],[2051,4818],[2037,4795],[2022,4808],[2009,4754],[2046,4747],[2041,4734],[2094,4717],[2091,4692],[2063,4674],[2072,4646],[2001,4661],[1921,4692],[1893,4718],[1881,4693],[1853,4680],[1872,4655],[1845,4628],[1903,4572],[1898,4554],[1856,4570],[1849,4584],[1809,4591],[1761,4578],[1769,4522],[1726,4516],[1663,4528],[1661,4546],[1691,4555],[1702,4573],[1677,4599],[1634,4623],[1613,4602],[1596,4637],[1603,4667],[1647,4708],[1651,4728],[1710,4809],[1733,4806],[1761,4820],[1784,4798],[1800,4806],[1808,4842],[1852,4865],[1834,4894],[1782,4876],[1771,4886],[1725,4888],[1712,4908],[1673,4908],[1662,4960],[1642,4996],[1661,5030],[1707,5040],[1740,5009],[1710,4972],[1751,4985],[1760,4944],[1780,4944],[1792,4976],[1828,4965],[1839,4977],[1870,4967],[1861,5019],[1895,5054],[1878,5071]]]}},{\"type\":\"Feature\",\"id\":\"RU.OB\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.34,\"hc-middle-y\":0.35,\"hc-key\":\"ru-ob\",\"hc-a2\":\"OB\",\"labelrank\":\"6\",\"hasc\":\"RU.OB\",\"alt-name\":\"Chkalov|Orenburgskaya|Orenburgskaya Oblast\",\"woe-id\":\"2346916\",\"subregion\":\"Urals\",\"fips\":\"RS55\",\"postal-code\":\"OB\",\"name\":\"Orenburg\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"56.2149\",\"woe-name\":\"Orenburg\",\"latitude\":\"51.5157\",\"woe-label\":\"Orenburgskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1596,4637],[1613,4602],[1634,4623],[1677,4599],[1702,4573],[1691,4555],[1661,4546],[1663,4528],[1686,4482],[1668,4474],[1712,4439],[1711,4420],[1745,4392],[1750,4364],[1731,4359],[1694,4320],[1630,4335],[1596,4359],[1584,4393],[1541,4367],[1516,4373],[1519,4395],[1480,4427],[1463,4466],[1477,4484],[1462,4513],[1441,4511],[1415,4537],[1393,4515],[1364,4532],[1364,4565],[1309,4597],[1270,4597],[1248,4582],[1199,4583],[1181,4618],[1177,4656],[1156,4695],[1126,4646],[1103,4665],[1130,4685],[1115,4715],[1114,4753],[1096,4771],[1104,4791],[1094,4821],[1059,4839],[1027,4867],[1038,4908],[995,4926],[974,4912],[936,4938],[954,4951],[921,5001],[998,4999],[1019,5026],[1038,5027],[1057,5053],[1070,5041],[1083,5061],[1122,5058],[1163,5092],[1166,5112],[1191,5119],[1240,5149],[1233,5166],[1249,5191],[1272,5182],[1303,5138],[1285,5120],[1311,5095],[1301,5053],[1307,4991],[1349,4936],[1339,4868],[1358,4857],[1334,4804],[1349,4782],[1397,4799],[1406,4769],[1398,4742],[1369,4742],[1391,4723],[1390,4681],[1374,4677],[1398,4647],[1401,4620],[1460,4629],[1491,4591],[1524,4574],[1558,4599],[1560,4618],[1596,4616],[1596,4637]],[[1167,5083],[1171,5086],[1169,5091],[1164,5088],[1167,5083]]]}},{\"type\":\"Feature\",\"id\":\"RU.SR\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.59,\"hc-middle-y\":0.66,\"hc-key\":\"ru-sr\",\"hc-a2\":\"SR\",\"labelrank\":\"6\",\"hasc\":\"RU.SR\",\"alt-name\":\"Saratovskaya Oblast\",\"woe-id\":\"2346924\",\"subregion\":\"Volga\",\"fips\":\"RS67\",\"postal-code\":\"SR\",\"name\":\"Saratov\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"46.6368\",\"woe-name\":\"Saratov\",\"latitude\":\"51.6742\",\"woe-label\":\"Saratovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[319,5466],[334,5481],[332,5528],[406,5562],[450,5561],[496,5519],[524,5467],[560,5476],[570,5422],[586,5424],[618,5405],[641,5368],[687,5374],[719,5334],[730,5314],[776,5275],[790,5280],[845,5250],[828,5244],[850,5219],[843,5184],[874,5174],[891,5134],[889,5104],[913,5073],[931,5019],[921,5001],[908,4982],[896,4999],[852,4980],[790,4992],[764,5015],[740,4989],[662,5009],[642,4982],[627,4937],[573,4947],[565,4964],[576,5013],[572,5063],[553,5069],[548,5097],[526,5121],[520,5159],[498,5152],[470,5178],[478,5211],[450,5212],[416,5239],[449,5263],[455,5305],[422,5355],[395,5364],[328,5414],[319,5466]]]}},{\"type\":\"Feature\",\"id\":\"RU.TT\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.48,\"hc-middle-y\":0.29,\"hc-key\":\"ru-tt\",\"hc-a2\":\"TT\",\"labelrank\":\"2\",\"hasc\":\"RU.TT\",\"alt-name\":\"Kazan|Kazanskaya G.|Tatar A.S.S.R.|Tatarskaya A.S.S.R.|Republic of Tatarstan|Respublika Tatars\",\"woe-id\":\"2346878\",\"subregion\":\"Volga\",\"fips\":\"RS73\",\"postal-code\":\"TT\",\"name\":\"Tatarstan\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"50.7364\",\"woe-name\":\"Tatarstan\",\"latitude\":\"55.374\",\"woe-label\":\"Tatarstan, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1311,5095],[1285,5120],[1303,5138],[1272,5182],[1276,5195],[1237,5206],[1243,5231],[1217,5278],[1179,5284],[1156,5268],[1148,5289],[1127,5289],[1132,5313],[1114,5334],[1086,5365],[1094,5418],[1041,5420],[1016,5439],[1014,5460],[978,5491],[934,5488],[940,5516],[973,5526],[990,5498],[1034,5511],[1043,5542],[1079,5568],[1123,5566],[1153,5565],[1220,5586],[1273,5566],[1283,5544],[1301,5558],[1323,5549],[1311,5503],[1331,5492],[1317,5477],[1334,5433],[1348,5434],[1362,5424],[1329,5410],[1384,5370],[1395,5387],[1419,5357],[1444,5370],[1433,5388],[1490,5390],[1456,5359],[1471,5330],[1479,5352],[1494,5329],[1448,5306],[1476,5294],[1496,5269],[1499,5240],[1451,5222],[1416,5219],[1379,5235],[1377,5164],[1328,5135],[1311,5095]],[[1019,5498],[1021,5497],[1027,5498],[1025,5501],[1019,5498]]]}},{\"type\":\"Feature\",\"id\":\"RU.TO\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.48,\"hc-middle-y\":0.45,\"hc-key\":\"ru-to\",\"hc-a2\":\"TO\",\"labelrank\":\"6\",\"hasc\":\"RU.TO\",\"alt-name\":\"Tomskaya\",\"woe-id\":\"2346928\",\"subregion\":\"West Siberian\",\"fips\":\"RS75\",\"postal-code\":\"TO\",\"name\":\"Tomsk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Siberian\",\"longitude\":\"82.2299\",\"woe-name\":\"Tomsk\",\"latitude\":\"58.4467\",\"woe-label\":\"Tomskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[3214,4867],[3220,4871],[3221,4875],[3269,4910],[3277,4945],[3328,4977],[3365,4974],[3401,5063],[3402,5090],[3422,5096],[3441,5139],[3558,5103],[3586,5106],[3595,5080],[3654,5069],[3697,5081],[3724,5054],[3775,5047],[3795,5028],[3818,5052],[3877,5088],[3904,5088],[3936,5053],[3956,5055],[3988,4983],[3964,4930],[3975,4919],[4035,4912],[4071,4918],[4155,4903],[4163,4875],[4189,4867],[4216,4814],[4266,4817],[4284,4779],[4249,4762],[4212,4710],[4228,4651],[4283,4629],[4321,4627],[4325,4583],[4283,4555],[4254,4509],[4270,4507],[4261,4472],[4244,4472],[4189,4435],[4139,4455],[4127,4436],[4100,4451],[4047,4434],[4002,4410],[3901,4384],[3862,4383],[3831,4344],[3796,4353],[3814,4372],[3791,4423],[3810,4452],[3798,4466],[3732,4447],[3665,4443],[3634,4487],[3565,4485],[3518,4562],[3430,4607],[3431,4612],[3309,4643],[3246,4666],[3219,4734],[3225,4771],[3197,4803],[3204,4836],[3225,4845],[3214,4867]]]}},{\"type\":\"Feature\",\"id\":\"RU.TY\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.31,\"hc-middle-y\":0.52,\"hc-key\":\"ru-ty\",\"hc-a2\":\"TY\",\"labelrank\":\"6\",\"hasc\":\"RU.TY\",\"alt-name\":\"Tobol'sk|Tobol'skaya G.|Tyumenskaya Oblast\",\"woe-id\":\"20070528\",\"subregion\":\"West Siberian\",\"fips\":\"RS78\",\"postal-code\":\"TY\",\"name\":\"Tyumen'\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Urals\",\"longitude\":\"68.51860000000001\",\"woe-name\":\"Tyumen'\",\"latitude\":\"57.2639\",\"woe-label\":\"Tyumenskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[3221,4875],[3220,4871],[3214,4867],[3129,4825],[3044,4852],[3021,4839],[2967,4858],[2959,4875],[2901,4888],[2919,4927],[2893,4958],[2833,4890],[2825,4871],[2831,4828],[2808,4821],[2821,4785],[2855,4795],[2865,4751],[2881,4725],[2865,4702],[2823,4711],[2814,4689],[2783,4666],[2774,4620],[2740,4616],[2749,4574],[2718,4559],[2712,4542],[2683,4530],[2649,4572],[2609,4586],[2595,4607],[2574,4603],[2541,4652],[2548,4665],[2491,4694],[2491,4727],[2425,4754],[2418,4774],[2393,4774],[2382,4823],[2344,4843],[2341,4876],[2359,4909],[2373,4904],[2375,4943],[2399,5024],[2521,5029],[2522,5069],[2535,5112],[2566,5094],[2597,5093],[2613,5126],[2634,5116],[2698,5133],[2746,5125],[2773,5154],[2838,5164],[2828,5184],[2849,5191],[2867,5172],[2905,5157],[2918,5140],[2979,5132],[2982,5115],[3022,5067],[3051,4990],[3068,4992],[3069,4949],[3112,4935],[3144,4909],[3193,4897],[3221,4875]],[[2770,4626],[2774,4632],[2772,4632],[2767,4628],[2770,4626]],[[2765,4620],[2767,4621],[2765,4623],[2761,4622],[2765,4620]]]}},{\"type\":\"Feature\",\"id\":\"RU.GA\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.48,\"hc-middle-y\":0.56,\"hc-key\":\"ru-ga\",\"hc-a2\":\"GA\",\"labelrank\":\"7\",\"hasc\":\"RU.GA\",\"alt-name\":\"Gorno-Altayskaya A.Obl.|Respublika Altay|Oirot|Republic of Altai\",\"woe-id\":\"20070530\",\"subregion\":\"West Siberian\",\"fips\":\"RS03\",\"postal-code\":\"GA\",\"name\":\"Gorno-Altay\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Siberian\",\"longitude\":\"86.937\",\"woe-name\":\"Gorno-Altay\",\"latitude\":\"50.9782\",\"woe-label\":\"Altay, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[4221,3828],[4198,3819],[4170,3780],[4193,3766],[4171,3745],[4218,3711],[4232,3711],[4254,3743],[4275,3726],[4284,3675],[4315,3646],[4360,3588],[4327,3579],[4339,3516],[4344,3489],[4262,3453],[4238,3461],[4191,3456],[4168,3419],[4111,3408],[4074,3434],[4056,3471],[4033,3483],[4052,3496],[4037,3511],[3990,3469],[3934,3494],[3900,3492],[3877,3561],[3808,3593],[3797,3645],[3842,3649],[3843,3685],[3796,3704],[3835,3728],[3897,3753],[3919,3749],[3950,3778],[3970,3780],[3992,3826],[4039,3816],[4069,3826],[4075,3851],[4058,3863],[4082,3900],[4112,3893],[4154,3869],[4181,3881],[4207,3862],[4227,3867],[4221,3828]]]}},{\"type\":\"Feature\",\"id\":\"RU.KK\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.59,\"hc-middle-y\":0.48,\"hc-key\":\"ru-kk\",\"hc-a2\":\"KK\",\"labelrank\":\"2\",\"hasc\":\"RU.KK\",\"alt-name\":\"Khakassiya|Republic of Khakasia|Khakasskaya A.Obl.|Respublika Khakasiya|Republic of Khakasia\",\"woe-id\":\"20070519\",\"subregion\":\"East Siberian\",\"fips\":\"RS31\",\"postal-code\":\"KK\",\"name\":\"Khakass\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Siberian\",\"longitude\":\"89.84050000000001\",\"woe-name\":\"Khakass\",\"latitude\":\"53.3643\",\"woe-label\":\"Khakasiya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[4254,3743],[4232,3711],[4218,3711],[4171,3745],[4193,3766],[4170,3780],[4198,3819],[4221,3828],[4252,3839],[4251,3852],[4293,3889],[4305,3914],[4273,3939],[4288,3975],[4269,4022],[4310,4057],[4284,4088],[4303,4099],[4298,4127],[4269,4135],[4247,4119],[4244,4137],[4266,4190],[4236,4257],[4255,4279],[4284,4257],[4305,4215],[4346,4217],[4393,4237],[4416,4198],[4456,4188],[4451,4165],[4478,4146],[4507,4087],[4495,4054],[4509,4013],[4535,4004],[4544,3982],[4500,3952],[4505,3923],[4441,3866],[4420,3828],[4387,3820],[4378,3800],[4385,3771],[4350,3745],[4301,3743],[4298,3756],[4254,3743]]]}},{\"type\":\"Feature\",\"id\":\"RU.CN\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.09,\"hc-middle-y\":0.56,\"hc-key\":\"ru-cn\",\"hc-a2\":\"CN\",\"labelrank\":\"2\",\"hasc\":\"RU.CN\",\"alt-name\":\"Cecenia|Chechenia|Chechênia|Tchetchnia|Chechen-Ingush A.S.S.R.|Checheno-Ingushetia|Checheno-Ingushetia\",\"woe-id\":\"2346868\",\"subregion\":\"North Caucasus\",\"fips\":\"RS12\",\"postal-code\":\"CN\",\"name\":\"Chechnya\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"45.757\",\"woe-name\":null,\"latitude\":\"43.2153\",\"woe-label\":null,\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-312,4422],[-339,4458],[-347,4497],[-329,4499],[-274,4575],[-282,4601],[-275,4608],[-243,4600],[-227,4616],[-204,4580],[-187,4587],[-151,4537],[-147,4517],[-120,4519],[-114,4474],[-171,4468],[-190,4414],[-217,4405],[-234,4426],[-252,4412],[-312,4422]]]}},{\"type\":\"Feature\",\"id\":\"RU.KL\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.64,\"hc-middle-y\":0.51,\"hc-key\":\"ru-kl\",\"hc-a2\":\"KL\",\"labelrank\":\"2\",\"hasc\":\"RU.KL\",\"alt-name\":\"Kalmykiya|Khalmg Tangch|Republic of Kalmykia|Kalmytskaya A.S.S.R.|Respublika Kalmykiya\",\"woe-id\":\"2346872\",\"subregion\":\"Volga\",\"fips\":\"RS24\",\"postal-code\":\"KL\",\"name\":\"Kalmyk\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"45.4681\",\"woe-name\":\"Kalmyk\",\"latitude\":\"46.5191\",\"woe-label\":\"Kalmykiya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[117,4585],[115,4576],[39,4548],[-7,4551],[-27,4604],[-81,4664],[-74,4691],[-110,4792],[-130,4817],[-139,4850],[-131,4898],[-161,4943],[-175,5003],[-226,5010],[-259,5037],[-287,5076],[-272,5097],[-262,5080],[-235,5081],[-219,5065],[-208,5100],[-183,5068],[-181,5043],[-155,5020],[-148,4961],[-122,4942],[-94,4950],[-84,4930],[-73,4963],[-10,4958],[51,5007],[41,5029],[2,5017],[7,5053],[25,5074],[75,5067],[93,5040],[115,5053],[125,5083],[136,5060],[123,5047],[139,5030],[168,5030],[182,4994],[194,4946],[187,4877],[198,4853],[242,4848],[243,4834],[208,4839],[193,4778],[202,4722],[162,4725],[151,4712],[129,4732],[103,4728],[128,4697],[111,4684],[140,4662],[117,4658],[69,4632],[118,4606],[117,4585]]]}},{\"type\":\"Feature\",\"id\":\"RU.DA\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.41,\"hc-middle-y\":0.70,\"hc-key\":\"ru-da\",\"hc-a2\":\"DA\",\"labelrank\":\"2\",\"hasc\":\"RU.DA\",\"alt-name\":\"Dagestanskaya A.S.S.R.|Daghestan|Republic of Dagestan|Respublika Dagestan|Dagistan\",\"woe-id\":\"2346870\",\"subregion\":\"North Caucasus\",\"fips\":\"RS17\",\"postal-code\":\"DA\",\"name\":\"Dagestan\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"47.1424\",\"woe-name\":\"Dagestan\",\"latitude\":\"42.36\",\"woe-label\":\"Dagestan, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-81,4664],[-27,4604],[-7,4551],[-29,4554],[-50,4535],[-26,4471],[-46,4417],[-72,4387],[-31,4414],[5,4403],[-37,4399],[-74,4378],[-116,4337],[-109,4303],[-120,4262],[-123,4134],[-164,4124],[-203,4137],[-242,4127],[-287,4185],[-283,4281],[-336,4362],[-345,4408],[-312,4422],[-252,4412],[-234,4426],[-217,4405],[-190,4414],[-171,4468],[-114,4474],[-120,4519],[-147,4517],[-151,4537],[-187,4587],[-171,4604],[-201,4636],[-167,4625],[-152,4661],[-108,4651],[-81,4664]]]}},{\"type\":\"Feature\",\"id\":\"RU.RO\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.49,\"hc-middle-y\":0.47,\"hc-key\":\"ru-ro\",\"hc-a2\":\"RO\",\"labelrank\":\"6\",\"hasc\":\"RU.RO\",\"alt-name\":\"Province of the Don Cossacks|Provinz des Donischen Heeres|Voyska Donskovo|Rostovskaya Oblast\",\"woe-id\":\"2346921\",\"subregion\":\"North Caucasus\",\"fips\":\"RS61\",\"postal-code\":\"RO\",\"name\":\"Rostov\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"41.2613\",\"woe-name\":\"Rostov\",\"latitude\":\"47.9913\",\"woe-label\":\"Rostovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-29,5521],[-1,5491],[32,5471],[66,5479],[101,5472],[118,5484],[108,5441],[119,5416],[116,5372],[92,5365],[57,5330],[75,5313],[78,5272],[66,5249],[35,5236],[-7,5263],[-60,5234],[-29,5197],[-28,5164],[-46,5115],[-30,5086],[7,5053],[2,5017],[41,5029],[51,5007],[-10,4958],[-73,4963],[-84,4930],[-94,4950],[-122,4942],[-148,4961],[-155,5020],[-181,5043],[-183,5068],[-208,5100],[-219,5065],[-235,5081],[-262,5080],[-272,5097],[-287,5076],[-309,5101],[-331,5117],[-320,5163],[-356,5214],[-339,5246],[-348,5260],[-328,5282],[-380,5347],[-401,5340],[-424,5367],[-401,5380],[-409,5402],[-364,5383],[-354,5366],[-328,5387],[-414,5461],[-395,5478],[-352,5491],[-319,5466],[-295,5473],[-235,5396],[-200,5414],[-174,5416],[-143,5480],[-116,5470],[-116,5505],[-98,5489],[-63,5489],[-29,5521]]]}},{\"type\":\"Feature\",\"id\":\"RU.BL\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.43,\"hc-middle-y\":0.65,\"hc-key\":\"ru-bl\",\"hc-a2\":\"BL\",\"labelrank\":\"7\",\"hasc\":\"RU.BL\",\"alt-name\":\"Belgorodskaya Oblast\",\"woe-id\":\"2346891\",\"subregion\":\"Central Black Earth\",\"fips\":\"RS09\",\"postal-code\":\"BL\",\"name\":\"Belgorod\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"37.277\",\"woe-name\":\"Belgorod\",\"latitude\":\"50.8757\",\"woe-label\":\"Belgorodskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[38,5807],[21,5781],[41,5755],[32,5731],[10,5732],[15,5692],[-11,5681],[-36,5629],[-60,5617],[-81,5631],[-101,5712],[-129,5712],[-127,5749],[-107,5800],[-147,5834],[-181,5849],[-192,5881],[-186,5905],[-218,5932],[-218,5962],[-195,5976],[-173,6014],[-146,5970],[-112,5975],[-84,5918],[-36,5892],[-24,5899],[24,5853],[38,5807]]]}},{\"type\":\"Feature\",\"id\":\"RU.TU\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.72,\"hc-middle-y\":0.48,\"hc-key\":\"ru-tu\",\"hc-a2\":\"TU\",\"labelrank\":\"2\",\"hasc\":\"RU.TU\",\"alt-name\":\"Respublika Tyva|Republic of Tuva|Tyva|Tuvinskaya A.S.S.R.|Republic of Tyva\",\"woe-id\":\"2346879\",\"subregion\":\"East Siberian\",\"fips\":\"RS79\",\"postal-code\":\"TU\",\"name\":\"Tuva\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Siberian\",\"longitude\":\"93.9927\",\"woe-name\":\"Tuva\",\"latitude\":\"51.6051\",\"woe-label\":\"Tyva, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[4981,4063],[4997,4078],[5040,4065],[5069,4037],[5103,4039],[5133,4026],[5138,4010],[5173,4022],[5206,4020],[5227,4003],[5199,3993],[5205,3960],[5182,3922],[5188,3899],[5216,3885],[5194,3834],[5168,3822],[5162,3787],[5146,3784],[5132,3717],[5159,3671],[5188,3659],[5178,3594],[5105,3538],[5069,3556],[5010,3549],[4958,3561],[4926,3540],[4881,3544],[4864,3556],[4835,3549],[4805,3579],[4791,3621],[4671,3622],[4665,3643],[4635,3627],[4600,3649],[4587,3627],[4547,3625],[4515,3594],[4475,3588],[4446,3568],[4381,3540],[4372,3524],[4339,3516],[4327,3579],[4360,3588],[4315,3646],[4284,3675],[4275,3726],[4254,3743],[4298,3756],[4301,3743],[4350,3745],[4385,3771],[4378,3800],[4387,3820],[4420,3828],[4455,3791],[4522,3791],[4565,3777],[4646,3786],[4693,3830],[4722,3844],[4729,3875],[4759,3931],[4793,3944],[4796,4000],[4855,4025],[4867,4014],[4900,4038],[4931,4032],[4942,4055],[4961,4044],[4981,4063]]]}},{\"type\":\"Feature\",\"id\":\"RU.IR\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.46,\"hc-middle-y\":0.61,\"hc-key\":\"ru-ir\",\"hc-a2\":\"IR\",\"labelrank\":\"6\",\"hasc\":\"RU.IR\",\"alt-name\":\"Irkutskaya Oblast\",\"woe-id\":\"2346896\",\"subregion\":\"East Siberian\",\"fips\":\"RS20\",\"postal-code\":\"IR\",\"name\":\"Irkutsk\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Siberian\",\"longitude\":\"105.966\",\"woe-name\":\"Irkutsk\",\"latitude\":\"56.8255\",\"woe-label\":\"Irkutskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[5227,4003],[5206,4020],[5173,4022],[5138,4010],[5133,4026],[5103,4039],[5069,4037],[5040,4065],[4997,4078],[4981,4063],[4964,4068],[4920,4115],[4882,4135],[4913,4186],[4957,4183],[4963,4240],[4950,4252],[4957,4286],[4974,4298],[4954,4354],[4979,4407],[4999,4402],[5014,4424],[5013,4451],[5033,4455],[5020,4508],[4994,4510],[5003,4530],[4981,4540],[5014,4651],[5082,4658],[5098,4652],[5132,4667],[5148,4711],[5173,4715],[5219,4646],[5246,4633],[5261,4656],[5242,4700],[5264,4718],[5259,4735],[5288,4757],[5301,4792],[5329,4807],[5350,4842],[5332,4899],[5370,4931],[5428,4887],[5449,4891],[5503,4861],[5530,4885],[5518,4896],[5552,4947],[5526,4993],[5512,4987],[5490,5015],[5501,5039],[5527,5044],[5518,5105],[5474,5100],[5453,5110],[5424,5165],[5439,5217],[5429,5240],[5496,5308],[5488,5327],[5514,5364],[5501,5392],[5517,5449],[5494,5455],[5455,5499],[5462,5531],[5481,5552],[5464,5563],[5467,5617],[5458,5637],[5514,5633],[5516,5654],[5554,5673],[5527,5692],[5558,5705],[5582,5674],[5587,5648],[5562,5640],[5565,5606],[5622,5623],[5653,5601],[5679,5549],[5689,5546],[5687,5487],[5731,5491],[5748,5460],[5736,5412],[5767,5376],[5775,5344],[5808,5332],[5829,5339],[5837,5272],[5825,5231],[5825,5183],[5834,5172],[5826,5083],[5889,5035],[5933,5059],[5940,5096],[5976,5099],[6027,5131],[6035,5169],[6050,5146],[6077,5153],[6084,5119],[6136,5176],[6128,5219],[6152,5247],[6170,5302],[6167,5337],[6185,5372],[6215,5407],[6248,5405],[6285,5415],[6322,5404],[6364,5367],[6368,5336],[6433,5347],[6452,5381],[6506,5363],[6503,5344],[6542,5306],[6554,5273],[6582,5273],[6597,5241],[6567,5217],[6535,5227],[6486,5209],[6477,5190],[6495,5127],[6481,5114],[6577,5033],[6572,5006],[6555,5016],[6530,4969],[6489,4968],[6473,4955],[6433,4959],[6461,5001],[6427,4998],[6406,4966],[6377,4956],[6379,4894],[6331,4867],[6328,4844],[6286,4847],[6274,4835],[6222,4831],[6203,4855],[6192,4835],[6140,4822],[6104,4836],[6107,4806],[6093,4789],[6045,4775],[6002,4778],[5984,4730],[5962,4729],[5913,4689],[5916,4648],[5936,4649],[5982,4614],[5963,4612],[5957,4539],[5979,4514],[5998,4439],[5992,4417],[6033,4424],[6014,4314],[6006,4225],[5873,4076],[5848,4010],[5802,3955],[5762,3929],[5770,3881],[5733,3873],[5700,3844],[5692,3878],[5667,3885],[5646,3873],[5625,3895],[5624,3918],[5577,3935],[5548,3963],[5487,3962],[5440,3988],[5351,4023],[5322,4048],[5309,4075],[5275,4058],[5263,4033],[5235,4026],[5227,4003]]]}},{\"type\":\"Feature\",\"id\":\"RU.CT\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.72,\"hc-middle-y\":0.45,\"hc-key\":\"ru-ct\",\"hc-a2\":\"CT\",\"labelrank\":\"6\",\"hasc\":\"RU.CT\",\"alt-name\":\"Transbaikalia|Zabaykal'skaya|Transbaikalien|Chitinskaya Oblast\",\"woe-id\":\"2346894\",\"subregion\":\"East Siberian\",\"fips\":\"RS14\",\"postal-code\":\"CT\",\"name\":\"Chita\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Siberian\",\"longitude\":\"116.559\",\"woe-name\":\"Chita\",\"latitude\":\"52.159\",\"woe-label\":\"Chitinskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[6597,5241],[6627,5179],[6646,5159],[6668,5165],[6711,5135],[6719,5114],[6745,5111],[6736,5087],[6777,5066],[6803,5074],[6833,5065],[6809,5028],[6836,5001],[6885,5053],[6902,5063],[6926,5045],[6949,5009],[6980,5044],[6997,5034],[7029,4977],[7022,4942],[7041,4950],[7060,4924],[7084,4921],[7055,4898],[7078,4846],[7113,4837],[7150,4796],[7097,4738],[7071,4723],[7053,4646],[7041,4622],[7053,4604],[7081,4626],[7111,4629],[7117,4601],[7146,4581],[7143,4546],[7122,4495],[7132,4409],[7124,4377],[7134,4356],[7128,4296],[7148,4302],[7162,4270],[7149,4247],[7112,4221],[7089,4165],[7063,4126],[7011,4116],[6894,4117],[6860,4081],[6825,4066],[6750,4082],[6706,4068],[6656,4008],[6633,3968],[6630,3932],[6606,3908],[6576,3901],[6545,3871],[6482,3839],[6436,3788],[6397,3789],[6382,3772],[6277,3761],[6218,3738],[6146,3762],[6136,3798],[6115,3796],[6110,3820],[6123,3851],[6180,3896],[6127,3899],[6126,3956],[6140,3975],[6121,3980],[6128,4022],[6194,4024],[6255,4082],[6317,4089],[6341,4144],[6385,4189],[6400,4235],[6434,4239],[6439,4261],[6474,4276],[6492,4302],[6522,4313],[6552,4362],[6551,4418],[6513,4427],[6475,4469],[6550,4562],[6578,4640],[6617,4674],[6655,4694],[6658,4739],[6626,4772],[6596,4774],[6579,4789],[6548,4772],[6519,4806],[6507,4840],[6490,4850],[6454,4912],[6437,4907],[6433,4959],[6473,4955],[6489,4968],[6530,4969],[6555,5016],[6572,5006],[6577,5033],[6481,5114],[6495,5127],[6477,5190],[6486,5209],[6535,5227],[6567,5217],[6597,5241]]]}},{\"type\":\"Feature\",\"id\":\"RU.YV\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.32,\"hc-middle-y\":0.70,\"hc-key\":\"ru-yv\",\"hc-a2\":\"YV\",\"labelrank\":\"2\",\"hasc\":\"RU.YV\",\"alt-name\":\"Den jødiske autonome oblasten|Evrey|Jewish A.Obl.|Yahudi|Yevreyskaya A.Obl.|Evreyskaya AOb\",\"woe-id\":\"20070516\",\"subregion\":\"Far Eastern\",\"fips\":\"RS89\",\"postal-code\":\"YV\",\"name\":\"Yevrey\",\"country\":\"Russia\",\"type-en\":\"Autonomous Region\",\"region\":\"Far Eastern\",\"longitude\":\"132.758\",\"woe-name\":\"Yevrey\",\"latitude\":\"48.64\",\"woe-label\":\"Yevreyskaya Avtonomnaya Oblast, RU, Russia\",\"type\":\"Avtonomnaya Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[8188,4787],[8207,4821],[8198,4863],[8215,4876],[8238,4912],[8259,4914],[8247,4950],[8284,4948],[8308,4980],[8322,4972],[8360,4989],[8397,4966],[8437,4992],[8474,5003],[8485,5034],[8511,5033],[8542,5063],[8548,5026],[8519,4999],[8482,4938],[8477,4904],[8447,4879],[8430,4834],[8441,4799],[8370,4729],[8351,4725],[8325,4692],[8266,4706],[8252,4745],[8202,4756],[8188,4787]]]}},{\"type\":\"Feature\",\"id\":\"RU.AM\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.63,\"hc-middle-y\":0.55,\"hc-key\":\"ru-am\",\"hc-a2\":\"AM\",\"labelrank\":\"2\",\"hasc\":\"RU.AM\",\"alt-name\":\"Amurskaya Oblast\",\"woe-id\":\"2346888\",\"subregion\":\"Far Eastern\",\"fips\":\"RS05\",\"postal-code\":\"AM\",\"name\":\"Amur\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Far Eastern\",\"longitude\":\"128.354\",\"woe-name\":\"Amur\",\"latitude\":\"52.9236\",\"woe-label\":\"Amurskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[8215,4876],[8198,4863],[8207,4821],[8188,4787],[8160,4761],[8119,4757],[8054,4769],[8027,4737],[7989,4729],[7985,4742],[7932,4694],[7907,4684],[7863,4689],[7835,4736],[7807,4733],[7768,4776],[7715,4789],[7685,4825],[7652,4832],[7602,4862],[7595,4886],[7467,4934],[7404,4927],[7347,4893],[7323,4900],[7262,4890],[7234,4872],[7211,4842],[7170,4818],[7150,4796],[7113,4837],[7078,4846],[7055,4898],[7084,4921],[7060,4924],[7041,4950],[7022,4942],[7029,4977],[6997,5034],[6980,5044],[6949,5009],[6926,5045],[6902,5063],[6885,5053],[6836,5001],[6809,5028],[6833,5065],[6803,5074],[6777,5066],[6736,5087],[6745,5111],[6766,5142],[6815,5175],[6846,5185],[6877,5166],[6917,5190],[6966,5180],[6974,5200],[7020,5204],[7060,5226],[7124,5212],[7148,5199],[7184,5215],[7200,5235],[7232,5234],[7267,5258],[7279,5243],[7309,5258],[7333,5300],[7381,5313],[7428,5366],[7453,5363],[7493,5388],[7478,5407],[7510,5450],[7537,5463],[7599,5513],[7615,5516],[7662,5557],[7680,5589],[7703,5605],[7741,5582],[7751,5535],[7733,5515],[7740,5495],[7714,5418],[7735,5383],[7715,5359],[7712,5326],[7730,5297],[7772,5313],[7808,5341],[7855,5303],[7860,5288],[7903,5329],[7967,5401],[7959,5417],[7971,5452],[8011,5469],[8028,5522],[8069,5526],[8090,5512],[8101,5462],[8137,5441],[8148,5407],[8035,5346],[8052,5323],[8081,5318],[8082,5302],[8050,5268],[8042,5243],[8051,5210],[8018,5147],[7996,5129],[8032,5097],[8010,5060],[8032,4973],[8055,4992],[8066,4966],[8106,4984],[8139,4973],[8140,4946],[8157,4954],[8207,4900],[8215,4876]]]}},{\"type\":\"Feature\",\"id\":\"RU.TB\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.46,\"hc-middle-y\":0.52,\"hc-key\":\"ru-tb\",\"hc-a2\":\"TB\",\"labelrank\":\"7\",\"hasc\":\"RU.TB\",\"alt-name\":\"Tambovskaya Oblast\",\"woe-id\":\"2346927\",\"subregion\":\"Central Black Earth\",\"fips\":\"RS72\",\"postal-code\":\"TB\",\"name\":\"Tambov\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"41.5945\",\"woe-name\":\"Tambov\",\"latitude\":\"52.7808\",\"woe-label\":\"Tambovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[450,5561],[406,5562],[332,5528],[318,5543],[276,5629],[244,5654],[263,5664],[242,5701],[287,5716],[279,5754],[282,5803],[306,5807],[367,5849],[378,5837],[422,5833],[437,5787],[461,5786],[487,5804],[534,5757],[504,5734],[486,5575],[455,5576],[450,5561]]]}},{\"type\":\"Feature\",\"id\":\"RU.TL\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.58,\"hc-middle-y\":0.66,\"hc-key\":\"ru-tl\",\"hc-a2\":\"TL\",\"labelrank\":\"7\",\"hasc\":\"RU.TL\",\"alt-name\":\"Tul'skaya|Tulskaya Oblast\",\"woe-id\":\"2346929\",\"subregion\":\"Central\",\"fips\":\"RS76\",\"postal-code\":\"TL\",\"name\":\"Tula\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Central\",\"longitude\":\"37.4161\",\"woe-name\":\"Tula\",\"latitude\":\"54.0668\",\"woe-label\":\"Tulrskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[378,6032],[354,5994],[317,5958],[290,5952],[266,5966],[245,5935],[220,5946],[208,5986],[197,5986],[199,6020],[213,6030],[188,6053],[171,6086],[164,6171],[185,6197],[225,6192],[232,6214],[262,6193],[285,6161],[301,6165],[316,6195],[322,6170],[365,6182],[371,6152],[401,6134],[394,6117],[409,6080],[391,6076],[378,6032]]]}},{\"type\":\"Feature\",\"id\":\"RU.NG\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.47,\"hc-middle-y\":0.39,\"hc-key\":\"ru-ng\",\"hc-a2\":\"NG\",\"labelrank\":\"6\",\"hasc\":\"RU.NG\",\"alt-name\":\"Novgorodskaya Oblast\",\"woe-id\":\"2346913\",\"subregion\":\"Northwestern\",\"fips\":\"RS52\",\"postal-code\":\"NG\",\"name\":\"Novgorod\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Northwestern\",\"longitude\":\"32.9454\",\"woe-name\":\"Novgorod\",\"latitude\":\"58.4228\",\"woe-label\":\"Novgorodskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[723,6700],[722,6657],[708,6652],[737,6613],[735,6565],[723,6561],[701,6567],[665,6608],[633,6608],[627,6628],[606,6621],[589,6678],[549,6695],[541,6674],[493,6679],[466,6664],[447,6700],[404,6710],[358,6748],[331,6749],[310,6789],[296,6813],[332,6849],[372,6863],[401,6888],[384,6932],[390,6960],[409,6973],[446,6965],[464,6959],[492,6975],[511,6938],[569,6931],[562,6917],[601,6914],[621,6925],[646,6890],[631,6866],[640,6844],[684,6839],[702,6799],[696,6764],[723,6700]]]}},{\"type\":\"Feature\",\"id\":\"RU.VG\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.55,\"hc-middle-y\":0.39,\"hc-key\":\"ru-vg\",\"hc-a2\":\"VG\",\"labelrank\":\"6\",\"hasc\":\"RU.VG\",\"alt-name\":\"Stalingrad|Volgogradskaya Oblast\",\"woe-id\":\"2346933\",\"subregion\":\"Volga\",\"fips\":\"RS84\",\"postal-code\":\"VG\",\"name\":\"Volgograd\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"44.4488\",\"woe-name\":\"Volgograd\",\"latitude\":\"49.5014\",\"woe-label\":\"Volgogradskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[553,5069],[533,5069],[513,5045],[462,5050],[407,5010],[414,4979],[334,4955],[326,4995],[300,5019],[252,5020],[216,5042],[175,5034],[182,4994],[168,5030],[139,5030],[123,5047],[136,5060],[125,5083],[115,5053],[93,5040],[75,5067],[25,5074],[7,5053],[-30,5086],[-46,5115],[-28,5164],[-29,5197],[-60,5234],[-7,5263],[35,5236],[66,5249],[78,5272],[75,5313],[57,5330],[92,5365],[116,5372],[119,5416],[108,5441],[118,5484],[167,5505],[163,5548],[224,5529],[249,5535],[269,5501],[319,5466],[328,5414],[395,5364],[422,5355],[455,5305],[449,5263],[416,5239],[450,5212],[478,5211],[470,5178],[498,5152],[520,5159],[526,5121],[548,5097],[553,5069]]]}},{\"type\":\"Feature\",\"id\":\"RU.KV\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.38,\"hc-middle-y\":0.54,\"hc-key\":\"ru-kv\",\"hc-a2\":\"KV\",\"labelrank\":\"6\",\"hasc\":\"RU.KV\",\"alt-name\":\"Vyatka|Vyatskaya G.|Kirovskaya Oblast\",\"woe-id\":\"2346902\",\"subregion\":\"Volga-Vyatka\",\"fips\":\"RS33\",\"postal-code\":\"KV\",\"name\":\"Kirov\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"50.1112\",\"woe-name\":\"Kirov\",\"latitude\":\"58.1926\",\"woe-label\":\"Kirovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1208,5913],[1269,5948],[1300,5933],[1341,5945],[1360,5930],[1373,5947],[1374,6007],[1400,6028],[1411,6062],[1442,6082],[1415,6101],[1416,6134],[1442,6113],[1515,6159],[1541,6172],[1578,6129],[1569,6117],[1589,6092],[1562,6023],[1530,6020],[1488,5967],[1515,5933],[1499,5918],[1518,5882],[1503,5865],[1519,5852],[1557,5893],[1608,5888],[1637,5870],[1668,5879],[1684,5845],[1748,5861],[1755,5842],[1761,5830],[1825,5772],[1820,5752],[1788,5724],[1777,5729],[1736,5702],[1729,5676],[1755,5641],[1731,5628],[1732,5604],[1703,5593],[1695,5572],[1662,5587],[1662,5613],[1634,5612],[1583,5661],[1538,5643],[1536,5613],[1505,5576],[1469,5569],[1445,5589],[1425,5572],[1411,5523],[1419,5509],[1390,5495],[1377,5503],[1348,5434],[1334,5433],[1317,5477],[1331,5492],[1311,5503],[1323,5549],[1301,5558],[1319,5587],[1305,5606],[1318,5626],[1289,5645],[1309,5681],[1273,5668],[1271,5683],[1238,5712],[1212,5704],[1197,5730],[1165,5727],[1124,5780],[1179,5833],[1223,5795],[1277,5826],[1263,5852],[1208,5902],[1208,5913]]]}},{\"type\":\"Feature\",\"id\":\"RU.ME\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.63,\"hc-middle-y\":0.68,\"hc-key\":\"ru-me\",\"hc-a2\":\"ME\",\"labelrank\":\"2\",\"hasc\":\"RU.ME\",\"alt-name\":\"Mari|Mari-El|Republic of Mari El|Mariyskaya A.S.S.R.|Respublika Mariy El\",\"woe-id\":\"2346875\",\"subregion\":\"Volga-Vyatka\",\"fips\":\"RS45\",\"postal-code\":\"ME\",\"name\":\"Mariy-El\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"47.9131\",\"woe-name\":\"Mariy-El\",\"latitude\":\"56.5407\",\"woe-label\":\"Mariy-El, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1301,5558],[1283,5544],[1273,5566],[1220,5586],[1153,5565],[1123,5566],[1108,5600],[1117,5625],[1094,5659],[1105,5677],[1079,5692],[1040,5697],[1006,5716],[1005,5757],[1026,5770],[1012,5790],[1024,5803],[1046,5793],[1069,5813],[1124,5780],[1165,5727],[1197,5730],[1212,5704],[1238,5712],[1271,5683],[1273,5668],[1309,5681],[1289,5645],[1318,5626],[1305,5606],[1319,5587],[1301,5558]]]}},{\"type\":\"Feature\",\"id\":\"RU.KE\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.56,\"hc-middle-y\":0.43,\"hc-key\":\"ru-ke\",\"hc-a2\":\"KE\",\"labelrank\":\"6\",\"hasc\":\"RU.KE\",\"alt-name\":\"Kemerovskaya Oblast\",\"woe-id\":\"2346901\",\"subregion\":\"West Siberian\",\"fips\":\"RS29\",\"postal-code\":\"KE\",\"name\":\"Kemerovo\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Siberian\",\"longitude\":\"87.16759999999999\",\"woe-name\":\"Kemerovo\",\"latitude\":\"54.6462\",\"woe-label\":\"Kemerovskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[4221,3828],[4227,3867],[4207,3862],[4181,3881],[4154,3869],[4112,3893],[4092,3929],[4106,3957],[4073,3976],[4103,4017],[4077,4015],[4053,4035],[4026,4090],[3980,4125],[3968,4123],[3939,4162],[3930,4198],[3943,4217],[3928,4234],[3932,4290],[3909,4340],[3911,4383],[3901,4384],[4002,4410],[4047,4434],[4100,4451],[4127,4436],[4139,4455],[4189,4435],[4244,4472],[4261,4472],[4270,4453],[4251,4444],[4257,4418],[4296,4397],[4321,4324],[4295,4313],[4255,4279],[4236,4257],[4266,4190],[4244,4137],[4247,4119],[4269,4135],[4298,4127],[4303,4099],[4284,4088],[4310,4057],[4269,4022],[4288,3975],[4273,3939],[4305,3914],[4293,3889],[4251,3852],[4252,3839],[4221,3828]]]}},{\"type\":\"Feature\",\"id\":\"RU.AS\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.49,\"hc-middle-y\":0.78,\"hc-key\":\"ru-as\",\"hc-a2\":\"AS\",\"labelrank\":\"7\",\"hasc\":\"RU.AS\",\"alt-name\":\"Astrachan|Astrakhanskaya Oblast\",\"woe-id\":\"2346890\",\"subregion\":\"Volga\",\"fips\":\"RS07\",\"postal-code\":\"AS\",\"name\":\"Astrakhan'\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Volga\",\"longitude\":\"47.7227\",\"woe-name\":\"Astrakhan'\",\"latitude\":\"47.0334\",\"woe-label\":\"Astrakhanskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[334,4955],[299,4940],[332,4884],[293,4836],[299,4805],[319,4815],[329,4793],[360,4765],[366,4695],[352,4652],[347,4597],[320,4605],[310,4628],[293,4625],[326,4536],[299,4536],[267,4552],[247,4518],[241,4547],[188,4552],[140,4590],[117,4585],[118,4606],[69,4632],[117,4658],[140,4662],[111,4684],[128,4697],[103,4728],[129,4732],[151,4712],[162,4725],[202,4722],[193,4778],[208,4839],[243,4834],[242,4848],[198,4853],[187,4877],[194,4946],[182,4994],[175,5034],[216,5042],[252,5020],[300,5019],[326,4995],[334,4955]]]}},{\"type\":\"Feature\",\"id\":\"RU.PR\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.59,\"hc-middle-y\":0.49,\"hc-key\":\"ru-pr\",\"hc-a2\":\"PR\",\"labelrank\":\"2\",\"hasc\":\"RU.PR\",\"alt-name\":\"Küsten-Gebiet|Maritime Territory|Primorsk|Primorskiy Kray\",\"woe-id\":\"2346886\",\"subregion\":\"Far Eastern\",\"fips\":\"RS59\",\"postal-code\":\"PR\",\"name\":\"Primor'ye\",\"country\":\"Russia\",\"type-en\":\"Territory\",\"region\":\"Far Eastern\",\"longitude\":\"134.594\",\"woe-name\":\"Primor'ye\",\"latitude\":\"44.8622\",\"woe-label\":\"Primorskiy Kray, RU, Russia\",\"type\":\"Kray\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[8909,5239],[8949,5260],[8955,5185],[9001,5082],[9013,5008],[9015,4927],[9008,4886],[9017,4836],[9012,4811],[9024,4762],[9013,4736],[9023,4659],[9036,4650],[9029,4615],[9038,4592],[9019,4520],[9001,4474],[8997,4434],[8968,4396],[8950,4354],[8923,4354],[8914,4333],[8894,4342],[8858,4304],[8820,4348],[8812,4296],[8799,4280],[8801,4316],[8776,4304],[8784,4289],[8777,4237],[8787,4193],[8734,4156],[8764,4160],[8771,4123],[8706,4145],[8727,4185],[8748,4200],[8727,4276],[8704,4281],[8666,4342],[8594,4390],[8569,4397],[8599,4444],[8599,4511],[8623,4514],[8654,4499],[8663,4476],[8716,4471],[8722,4505],[8707,4560],[8724,4587],[8697,4620],[8707,4656],[8686,4691],[8693,4708],[8676,4730],[8682,4757],[8657,4775],[8654,4801],[8682,4836],[8659,4864],[8661,4894],[8686,4938],[8727,4946],[8729,4931],[8757,4963],[8778,4958],[8835,5011],[8841,5065],[8822,5099],[8857,5118],[8870,5197],[8852,5208],[8831,5190],[8759,5189],[8757,5210],[8784,5241],[8792,5298],[8809,5308],[8853,5282],[8887,5286],[8884,5250],[8909,5239]]]}},{\"type\":\"Feature\",\"id\":\"RU.MG\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.46,\"hc-middle-y\":0.46,\"hc-key\":\"ru-mg\",\"hc-a2\":\"MG\",\"labelrank\":\"2\",\"hasc\":\"RU.MG\",\"alt-name\":\"Magadanskaya Oblast\",\"woe-id\":\"20070512\",\"subregion\":\"Far Eastern\",\"fips\":\"RS44\",\"postal-code\":\"MG\",\"name\":\"Maga Buryatdan\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Far Eastern\",\"longitude\":\"153.797\",\"woe-name\":\"Maga Buryatdan\",\"latitude\":\"62.6257\",\"woe-label\":\"Magadanskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[8272,8004],[8298,7956],[8361,7793],[8329,7806],[8307,7835],[8306,7788],[8287,7808],[8264,7799],[8235,7849],[8184,7872],[8205,7829],[8200,7803],[8167,7804],[8148,7728],[8155,7711],[8132,7673],[8144,7607],[8184,7589],[8194,7539],[8222,7506],[8241,7425],[8263,7383],[8286,7366],[8280,7346],[8321,7314],[8352,7374],[8400,7372],[8372,7326],[8378,7284],[8331,7249],[8355,7197],[8317,7166],[8328,7132],[8306,7085],[8266,7083],[8287,7132],[8295,7175],[8266,7142],[8217,7139],[8204,7104],[8217,7096],[8199,7072],[8180,7076],[8129,7029],[8125,6991],[8142,6987],[8126,6962],[8142,6945],[8165,6951],[8143,6917],[8127,6923],[8107,6893],[8110,6857],[8067,6824],[8069,6840],[8021,6877],[8000,6859],[7939,6862],[7924,6820],[7898,6817],[7875,6838],[7876,6884],[7892,6901],[7867,6919],[7856,6950],[7788,6980],[7742,6980],[7705,6964],[7705,6939],[7666,6906],[7656,6950],[7630,6963],[7638,6988],[7608,6996],[7555,7026],[7514,7086],[7492,7094],[7498,7134],[7481,7176],[7525,7204],[7525,7234],[7564,7236],[7537,7276],[7515,7270],[7503,7300],[7530,7309],[7551,7341],[7551,7385],[7567,7394],[7608,7383],[7626,7403],[7606,7414],[7623,7454],[7627,7504],[7651,7503],[7626,7557],[7586,7561],[7555,7590],[7561,7641],[7507,7668],[7501,7687],[7522,7702],[7514,7726],[7492,7726],[7478,7755],[7500,7767],[7516,7817],[7545,7844],[7534,7866],[7572,7870],[7588,7893],[7571,7922],[7588,7965],[7557,7980],[7587,8010],[7647,7971],[7713,8028],[7759,8036],[7778,8079],[7828,8096],[7877,8161],[7863,8175],[7893,8168],[7921,8179],[7943,8153],[7941,8128],[7971,8128],[7982,8110],[8016,8117],[8042,8088],[8071,8084],[8077,8050],[8099,8043],[8133,8059],[8190,8046],[8192,8005],[8212,8024],[8230,8002],[8272,8004]]]}},{\"type\":\"Feature\",\"id\":\"RU.BU\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.71,\"hc-middle-y\":0.46,\"hc-key\":\"ru-bu\",\"hc-a2\":\"BU\",\"labelrank\":\"2\",\"hasc\":\"RU.BU\",\"alt-name\":\"Buryatiya|Buryat-Mongol A.S.S.R.|Republic of Buryatia|Buryatskaya A.S.S.R.\",\"woe-id\":\"2346867\",\"subregion\":\"East Siberian\",\"fips\":\"RS11\",\"postal-code\":\"BU\",\"name\":\"Buryat\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Siberian\",\"longitude\":\"109.341\",\"woe-name\":\"Buryat\",\"latitude\":\"52.9061\",\"woe-label\":\"Buryatiya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[6115,3796],[6064,3784],[5997,3811],[5960,3795],[5931,3802],[5866,3794],[5784,3748],[5769,3726],[5719,3708],[5606,3721],[5577,3733],[5544,3803],[5541,3834],[5462,3836],[5373,3857],[5325,3849],[5291,3865],[5257,3865],[5216,3885],[5188,3899],[5182,3922],[5205,3960],[5199,3993],[5227,4003],[5235,4026],[5263,4033],[5275,4058],[5309,4075],[5322,4048],[5351,4023],[5440,3988],[5487,3962],[5548,3963],[5577,3935],[5624,3918],[5625,3895],[5646,3873],[5667,3885],[5692,3878],[5700,3844],[5733,3873],[5770,3881],[5762,3929],[5802,3955],[5848,4010],[5873,4076],[6006,4225],[6014,4314],[6033,4424],[5992,4417],[5998,4439],[5979,4514],[5957,4539],[5963,4612],[5982,4614],[5936,4649],[5916,4648],[5913,4689],[5962,4729],[5984,4730],[6002,4778],[6045,4775],[6093,4789],[6107,4806],[6104,4836],[6140,4822],[6192,4835],[6203,4855],[6222,4831],[6274,4835],[6286,4847],[6328,4844],[6331,4867],[6379,4894],[6377,4956],[6406,4966],[6427,4998],[6461,5001],[6433,4959],[6437,4907],[6454,4912],[6490,4850],[6507,4840],[6519,4806],[6548,4772],[6579,4789],[6596,4774],[6626,4772],[6658,4739],[6655,4694],[6617,4674],[6578,4640],[6550,4562],[6475,4469],[6513,4427],[6551,4418],[6552,4362],[6522,4313],[6492,4302],[6474,4276],[6439,4261],[6434,4239],[6400,4235],[6385,4189],[6341,4144],[6317,4089],[6255,4082],[6194,4024],[6128,4022],[6121,3980],[6140,3975],[6126,3956],[6127,3899],[6180,3896],[6123,3851],[6110,3820],[6115,3796]]]}},{\"type\":\"Feature\",\"id\":\"RU.KN\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.67,\"hc-middle-y\":0.67,\"hc-key\":\"ru-kn\",\"hc-a2\":\"KN\",\"labelrank\":\"7\",\"hasc\":\"RU.KN\",\"alt-name\":\"Kaliningradskaya Oblast\",\"woe-id\":\"2346938\",\"subregion\":\"Kaliningrad\",\"fips\":\"RS23\",\"postal-code\":\"KN\",\"name\":\"Kaliningrad\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Northwestern\",\"longitude\":\"21.2287\",\"woe-name\":\"Kaliningrad\",\"latitude\":\"54.6636\",\"woe-label\":\"Kaliningradskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-266,7403],[-268,7346],[-248,7309],[-262,7282],[-336,7261],[-395,7435],[-419,7510],[-366,7468],[-375,7505],[-343,7511],[-308,7413],[-276,7429],[-266,7403]]]}},{\"type\":\"Feature\",\"id\":\"RU.KD\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.65,\"hc-middle-y\":0.39,\"hc-key\":\"ru-kd\",\"hc-a2\":\"KD\",\"labelrank\":\"6\",\"hasc\":\"RU.KD\",\"alt-name\":\"Cossacks of the Black Sea|Kuban|Kubanskaya|Yekaterinodar|Krasnodarskiy Kray\",\"woe-id\":\"2346884\",\"subregion\":\"North Caucasus\",\"fips\":\"RS38\",\"postal-code\":\"KD\",\"name\":\"Krasnodar\",\"country\":\"Russia\",\"type-en\":\"Territory\",\"region\":\"Volga\",\"longitude\":\"39.4688\",\"woe-name\":\"Krasnodar\",\"latitude\":\"45.8397\",\"woe-label\":\"Krasnodarskiy Kray, RU, Russia\",\"type\":\"Kray\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-611,4944],[-640,4989],[-677,4994],[-678,5033],[-672,5148],[-680,5197],[-701,5240],[-693,5290],[-721,5324],[-707,5362],[-724,5445],[-683,5443],[-674,5408],[-686,5402],[-645,5377],[-636,5353],[-608,5393],[-583,5382],[-543,5393],[-514,5378],[-496,5349],[-497,5408],[-509,5420],[-491,5466],[-476,5436],[-409,5402],[-401,5380],[-424,5367],[-401,5340],[-380,5347],[-328,5282],[-348,5260],[-339,5246],[-356,5214],[-320,5163],[-331,5117],[-343,5091],[-378,5119],[-396,5108],[-415,5064],[-391,5036],[-406,5006],[-394,4992],[-437,4986],[-439,4938],[-480,4916],[-507,4920],[-532,4980],[-545,4962],[-563,4972],[-611,4944]],[[-484,5119],[-506,5141],[-517,5179],[-559,5190],[-582,5211],[-600,5248],[-597,5196],[-563,5153],[-544,5177],[-537,5148],[-519,5142],[-536,5107],[-592,5094],[-583,5060],[-612,5057],[-613,5084],[-642,5062],[-618,5000],[-582,5004],[-553,5032],[-532,5066],[-511,5074],[-500,5060],[-510,5022],[-482,5079],[-484,5119]]]}},{\"type\":\"Feature\",\"id\":\"RU.KU\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.33,\"hc-middle-y\":0.46,\"hc-key\":\"ru-ku\",\"hc-a2\":\"KU\",\"labelrank\":\"6\",\"hasc\":\"RU.KU\",\"alt-name\":\"Kurganskaya Oblast\",\"woe-id\":\"2346904\",\"subregion\":\"Urals\",\"fips\":\"RS40\",\"postal-code\":\"KU\",\"name\":\"Kurgan\",\"country\":\"Russia\",\"type-en\":\"Region\",\"region\":\"Urals\",\"longitude\":\"65.3505\",\"woe-name\":\"Kurgan\",\"latitude\":\"55.4316\",\"woe-label\":\"Kurganskaya Oblast, RU, Russia\",\"type\":\"Oblast\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[2574,4603],[2556,4587],[2528,4598],[2508,4570],[2458,4575],[2355,4597],[2312,4602],[2270,4623],[2245,4619],[2235,4596],[2214,4615],[2133,4638],[2072,4646],[2063,4674],[2091,4692],[2094,4717],[2041,4734],[2046,4747],[2009,4754],[2022,4808],[2037,4795],[2051,4818],[2041,4835],[2060,4846],[2099,4842],[2106,4887],[2095,4897],[2100,4939],[2111,4958],[2164,4976],[2163,4964],[2231,4948],[2279,4901],[2309,4930],[2351,4924],[2359,4909],[2341,4876],[2344,4843],[2382,4823],[2393,4774],[2418,4774],[2425,4754],[2491,4727],[2491,4694],[2548,4665],[2541,4652],[2574,4603]]]}},{\"type\":\"Feature\",\"id\":\"RU.AL\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.57,\"hc-middle-y\":0.47,\"hc-key\":\"ru-al\",\"hc-a2\":\"AL\",\"labelrank\":\"2\",\"hasc\":\"RU.AL\",\"alt-name\":\"Altayskiy Kray\",\"woe-id\":\"20070529\",\"subregion\":\"West Siberian\",\"fips\":\"RS04\",\"postal-code\":\"AL\",\"name\":\"Altay\",\"country\":\"Russia\",\"type-en\":\"Territory\",\"region\":\"Siberian\",\"longitude\":\"82.86669999999999\",\"woe-name\":\"Altay\",\"latitude\":\"52.4268\",\"woe-label\":\"Altayskiy Kray, RU, Russia\",\"type\":\"Kray\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[3797,3645],[3774,3680],[3739,3701],[3673,3697],[3641,3675],[3574,3694],[3543,3691],[3542,3723],[3509,3726],[3522,3750],[3481,3780],[3455,3770],[3450,3737],[3403,3722],[3371,3826],[3278,4079],[3265,4104],[3312,4133],[3313,4118],[3346,4115],[3374,4131],[3423,4123],[3467,4149],[3543,4174],[3571,4196],[3582,4160],[3613,4145],[3617,4125],[3645,4126],[3639,4090],[3692,4049],[3720,4090],[3765,4123],[3781,4105],[3799,4127],[3863,4133],[3879,4121],[3903,4146],[3939,4162],[3968,4123],[3980,4125],[4026,4090],[4053,4035],[4077,4015],[4103,4017],[4073,3976],[4106,3957],[4092,3929],[4112,3893],[4082,3900],[4058,3863],[4075,3851],[4069,3826],[4039,3816],[3992,3826],[3970,3780],[3950,3778],[3919,3749],[3897,3753],[3835,3728],[3796,3704],[3843,3685],[3842,3649],[3797,3645]]]}},{\"type\":\"Feature\",\"id\":\"RU.KM\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.32,\"hc-middle-y\":0.50,\"hc-key\":\"ru-km\",\"hc-a2\":\"KM\",\"labelrank\":\"2\",\"hasc\":\"RU.KM\",\"alt-name\":\"Khanty-Mansiysk|Khanty-Mansiyskiy A.Okr.|Khanty-Mansiyskiy A.Okr.-Yugra|Khanty-Mansiyskiy AOk\",\"woe-id\":\"20070526\",\"subregion\":\"West Siberian\",\"fips\":\"RS32\",\"postal-code\":\"KM\",\"name\":\"Khanty-Mansiy\",\"country\":\"Russia\",\"type-en\":\"Autonomous Province\",\"region\":\"Urals\",\"longitude\":\"71.3806\",\"woe-name\":\"Khanty-Mansiy\",\"latitude\":\"61.4315\",\"woe-label\":\"Khanty-Mansiyskiy Avtonomnyy Okrug, RU, Russia\",\"type\":\"Avtonomnyy Okrug\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[3987,5239],[3990,5200],[4053,5155],[4086,5142],[4063,5107],[3956,5055],[3936,5053],[3904,5088],[3877,5088],[3818,5052],[3795,5028],[3775,5047],[3724,5054],[3697,5081],[3654,5069],[3595,5080],[3586,5106],[3558,5103],[3441,5139],[3422,5096],[3402,5090],[3401,5063],[3365,4974],[3328,4977],[3277,4945],[3269,4910],[3221,4875],[3193,4897],[3144,4909],[3112,4935],[3069,4949],[3068,4992],[3051,4990],[3022,5067],[2982,5115],[2979,5132],[2918,5140],[2905,5157],[2867,5172],[2849,5191],[2828,5184],[2838,5164],[2773,5154],[2746,5125],[2698,5133],[2634,5116],[2613,5126],[2597,5093],[2566,5094],[2535,5112],[2519,5126],[2511,5234],[2438,5291],[2456,5331],[2464,5384],[2449,5414],[2454,5500],[2470,5514],[2461,5567],[2407,5656],[2341,5700],[2349,5725],[2325,5753],[2329,5770],[2372,5811],[2383,5879],[2411,5924],[2471,5987],[2500,6005],[2492,6023],[2534,6087],[2582,6107],[2599,6071],[2660,6096],[2660,6105],[2729,6132],[2736,6113],[2731,6070],[2744,6056],[2710,6007],[2707,5985],[2681,5972],[2717,5947],[2724,5903],[2793,5896],[2826,5882],[2847,5892],[2891,5875],[2932,5842],[2910,5810],[2930,5780],[2959,5760],[3011,5780],[3034,5759],[3044,5788],[3069,5783],[3107,5746],[3127,5743],[3148,5713],[3127,5694],[3135,5642],[3163,5631],[3169,5610],[3155,5560],[3195,5564],[3226,5551],[3261,5564],[3269,5527],[3324,5506],[3337,5484],[3363,5475],[3424,5471],[3451,5441],[3475,5447],[3500,5432],[3512,5391],[3552,5347],[3608,5357],[3677,5343],[3688,5368],[3738,5392],[3774,5400],[3786,5356],[3816,5333],[3834,5346],[3878,5334],[3913,5287],[3948,5297],[3975,5268],[3987,5239]]]}},{\"type\":\"Feature\",\"id\":\"RU.PE\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.51,\"hc-middle-y\":0.48,\"hc-key\":\"ru-pe\",\"hc-a2\":\"PE\",\"labelrank\":\"6\",\"hasc\":\"RU.PE\",\"alt-name\":\"Molotov|Permskaya Oblast\",\"woe-id\":\"20070511\",\"subregion\":\"Urals\",\"fips\":\"RS90\",\"postal-code\":\"PE\",\"name\":\"Perm'\",\"country\":\"Russia\",\"type-en\":\"Territory\",\"region\":\"Volga\",\"longitude\":\"56.5878\",\"woe-name\":\"Perm'\",\"latitude\":\"58.8735\",\"woe-label\":\"Permskiy Kray, RU, Russia\",\"type\":\"Kray\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1773,5161],[1742,5153],[1718,5161],[1707,5215],[1676,5219],[1679,5247],[1636,5254],[1602,5275],[1591,5320],[1562,5309],[1569,5357],[1550,5364],[1566,5383],[1578,5369],[1594,5390],[1617,5394],[1644,5435],[1637,5457],[1659,5471],[1678,5507],[1679,5546],[1695,5572],[1703,5593],[1732,5604],[1731,5628],[1755,5641],[1729,5676],[1736,5702],[1777,5729],[1788,5724],[1820,5752],[1825,5772],[1761,5830],[1755,5842],[1773,5862],[1756,5906],[1786,5931],[1810,5907],[1827,5918],[1845,5899],[1862,5911],[1885,5884],[1873,5868],[1895,5844],[1910,5856],[1967,5795],[2008,5811],[2028,5791],[2050,5804],[2071,5782],[2096,5802],[2123,5802],[2241,5723],[2295,5721],[2287,5696],[2256,5668],[2239,5610],[2217,5585],[2149,5533],[2094,5517],[2068,5494],[2101,5421],[2068,5379],[2084,5359],[2074,5331],[1980,5306],[1976,5265],[1949,5259],[1927,5288],[1903,5279],[1873,5217],[1826,5220],[1799,5231],[1796,5205],[1773,5161]]]}},{\"type\":\"Feature\",\"id\":\"RU.AD\",\"properties\":{\"hc-group\":\"admin1\",\"hc-middle-x\":0.10,\"hc-middle-y\":0.73,\"hc-key\":\"ru-ad\",\"hc-a2\":\"AD\",\"labelrank\":\"2\",\"hasc\":\"RU.AD\",\"alt-name\":\"Adygea|Adygeya|Adygheya|Republic of Adygeya|Adygeyskaya A.Obl.|Respublika Adygeya\",\"woe-id\":\"20070520\",\"subregion\":\"North Caucasus\",\"fips\":\"RS01\",\"postal-code\":\"AD\",\"name\":\"Adygey\",\"country\":\"Russia\",\"type-en\":\"Republic\",\"region\":\"Volga\",\"longitude\":\"40.1293\",\"woe-name\":\"Adygey\",\"latitude\":\"44.4658\",\"woe-label\":\"Adygeya, RU, Russia\",\"type\":\"Respublika\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-484,5119],[-482,5079],[-510,5022],[-500,5060],[-511,5074],[-532,5066],[-553,5032],[-582,5004],[-618,5000],[-642,5062],[-613,5084],[-612,5057],[-583,5060],[-592,5094],[-536,5107],[-519,5142],[-537,5148],[-544,5177],[-563,5153],[-597,5196],[-600,5248],[-582,5211],[-559,5190],[-517,5179],[-506,5141],[-484,5119]]]}}]};","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n\r\n (c) 2014 Highsoft AS\r\n Authors: Jon Arild Nygard / Oystein Moseng\r\n\r\n License: www.highcharts.com/license\r\n*/\r\n(function(u){\"object\"===typeof module&&module.exports?module.exports=u:u(Highcharts)})(function(u){var E=function(b){var u=b.each,w=b.extend,q=b.isArray,t=b.isObject,r=b.isNumber,A=b.merge,x=b.pick,g=b.reduce;return{getColor:function(b,f){var l=f.mapOptionsToLevel,v=f.parentColorIndex,g=f.series,h=f.colors,p=g.points,C,B;b&&(p=p[b.i],l=l[b.level]||{},(b=p&&l.colorByPoint)&&(C=p.index%(h?h.length:g.chart.options.chart.colorCount)),B=x(p&&p.options.colorIndex,l&&l.colorIndex,C,v,f.colorIndex));return{color:void 0,\r\ncolorIndex:B}},getLevelOptions:function(b){var f=null,l,v,z,h;if(t(b))for(f={},z=r(b.from)?b.from:1,h=b.levels,v={},l=t(b.defaults)?b.defaults:{},q(h)&&(v=g(h,function(b,f){var h,g;t(f)&&r(f.level)&&(g=A({},f),h=\"boolean\"===typeof g.levelIsConstant?g.levelIsConstant:l.levelIsConstant,delete g.levelIsConstant,delete g.level,f=f.level+(h?0:z-1),t(b[f])?w(b[f],g):b[f]=g);return b},{})),h=r(b.to)?b.to:1,b=0;b<=h;b++)f[b]=A({},l,t(v[b])?v[b]:{});return f},setTreeValues:function f(b,g){var l=g.before,h=\r\ng.idRoot,p=g.mapIdToNode[h],q=g.points[b.i],t=q&&q.options||{},r=0,v=[];w(b,{levelDynamic:b.level-((\"boolean\"===typeof g.levelIsConstant?g.levelIsConstant:1)?0:p.level),name:x(q&&q.name,\"\"),visible:h===b.id||(\"boolean\"===typeof g.visible?g.visible:!1)});\"function\"===typeof l&&(b=l(b,g));u(b.children,function(l,a){var c=w({},g);w(c,{index:a,siblings:b.children.length,visible:b.visible});l=f(l,c);v.push(l);l.visible&&(r+=l.val)});b.visible=0<r||b.visible;l=x(t.value,r);w(b,{children:v,childrenTotal:r,\r\nisLeaf:b.visible&&!r,val:l});return b},updateRootId:function(b){var g;t(b)&&(g=t(b.options)?b.options:{},g=x(b.rootNode,g.rootId,\"\"),t(b.userOptions)&&(b.userOptions.rootId=g),b.rootNode=g);return g}}}(u);(function(b,u){var w=b.seriesType,q=b.seriesTypes,t=b.map,r=b.merge,A=b.extend,x=b.noop,g=b.each,B=u.getColor,f=u.getLevelOptions,l=b.grep,v=b.isNumber,z=b.isString,h=b.pick,p=b.Series,C=b.stableSort,E=function(a,c,d){d=d||this;b.objectEach(a,function(b,e){c.call(d,b,e,a)})},H=b.reduce,D=function(a,\r\nc,d){d=d||this;a=c.call(d,a);!1!==a&&D(a,c,d)},I=u.updateRootId;w(\"treemap\",\"scatter\",{showInLegend:!1,marker:!1,colorByPoint:!1,dataLabels:{enabled:!0,defer:!1,verticalAlign:\"middle\",formatter:function(){return this.point.name||this.point.id},inside:!0},tooltip:{headerFormat:\"\",pointFormat:\"\\x3cb\\x3e{point.name}\\x3c/b\\x3e: {point.value}\\x3cbr/\\x3e\"},ignoreHiddenPoint:!0,layoutAlgorithm:\"sliceAndDice\",layoutStartingDirection:\"vertical\",alternateStartingDirection:!1,levelIsConstant:!0,drillUpButton:{position:{align:\"right\",\r\nx:-10,y:10}}},{pointArrayMap:[\"value\"],axisTypes:q.heatmap?[\"xAxis\",\"yAxis\",\"colorAxis\"]:[\"xAxis\",\"yAxis\"],directTouch:!0,optionalAxis:\"colorAxis\",getSymbol:x,parallelArrays:[\"x\",\"y\",\"value\",\"colorValue\"],colorKey:\"colorValue\",translateColors:q.heatmap&&q.heatmap.prototype.translateColors,colorAttribs:q.heatmap&&q.heatmap.prototype.colorAttribs,trackerGroups:[\"group\",\"dataLabelsGroup\"],getListOfParents:function(a,c){a=H(a||[],function(a,c,b){c=h(c.parent,\"\");void 0===a[c]&&(a[c]=[]);a[c].push(b);\r\nreturn a},{});E(a,function(a,n,e){\"\"!==n&&-1===b.inArray(n,c)&&(g(a,function(a){e[\"\"].push(a)}),delete e[n])});return a},getTree:function(){var a=t(this.data,function(a){return a.id}),a=this.getListOfParents(this.data,a);this.nodeMap=[];return this.buildNode(\"\",-1,0,a,null)},init:function(a,c){p.prototype.init.call(this,a,c);this.options.allowDrillToNode&&b.addEvent(this,\"click\",this.onClickDrillToNode)},buildNode:function(a,c,d,b,e){var m=this,n=[],k=m.points[c],F=0,G;g(b[a]||[],function(c){G=m.buildNode(m.points[c].id,\r\nc,d+1,b,a);F=Math.max(G.height+1,F);n.push(G)});c={id:a,i:c,children:n,height:F,level:d,parent:e,visible:!1};m.nodeMap[c.id]=c;k&&(k.node=c);return c},setTreeValues:function(a){var c=this,d=c.options,b=c.nodeMap[c.rootNode],d=\"boolean\"===typeof d.levelIsConstant?d.levelIsConstant:!0,e=0,m=[],y,k=c.points[a.i];g(a.children,function(a){a=c.setTreeValues(a);m.push(a);a.ignore||(e+=a.val)});C(m,function(a,c){return a.sortIndex-c.sortIndex});y=h(k&&k.options.value,e);k&&(k.value=y);A(a,{children:m,childrenTotal:e,\r\nignore:!(h(k&&k.visible,!0)&&0<y),isLeaf:a.visible&&!e,levelDynamic:a.level-(d?0:b.level),name:h(k&&k.name,\"\"),sortIndex:h(k&&k.sortIndex,-y),val:y});return a},calculateChildrenAreas:function(a,c){var d=this,b=d.options,e=d.mapOptionsToLevel[a.level+1],m=h(d[e&&e.layoutAlgorithm]&&e.layoutAlgorithm,b.layoutAlgorithm),y=b.alternateStartingDirection,k=[];a=l(a.children,function(a){return!a.ignore});e&&e.layoutStartingDirection&&(c.direction=\"vertical\"===e.layoutStartingDirection?0:1);k=d[m](c,a);g(a,\r\nfunction(a,b){b=k[b];a.values=r(b,{val:a.childrenTotal,direction:y?1-c.direction:c.direction});a.pointValues=r(b,{x:b.x/d.axisRatio,width:b.width/d.axisRatio});a.children.length&&d.calculateChildrenAreas(a,a.values)})},setPointValues:function(){var a=this.xAxis,c=this.yAxis;g(this.points,function(d){var b=d.node,e=b.pointValues,m,g;e&&b.visible?(b=Math.round(a.translate(e.x,0,0,0,1))-0,m=Math.round(a.translate(e.x+e.width,0,0,0,1))-0,g=Math.round(c.translate(e.y,0,0,0,1))-0,e=Math.round(c.translate(e.y+\r\ne.height,0,0,0,1))-0,d.shapeType=\"rect\",d.shapeArgs={x:Math.min(b,m),y:Math.min(g,e),width:Math.abs(m-b),height:Math.abs(e-g)},d.plotX=d.shapeArgs.x+d.shapeArgs.width/2,d.plotY=d.shapeArgs.y+d.shapeArgs.height/2):(delete d.plotX,delete d.plotY)})},setColorRecursive:function(a,c,d,b,e){var m=this,n=m&&m.chart,n=n&&n.options&&n.options.colors,k;if(a){k=B(a,{colors:n,index:b,mapOptionsToLevel:m.mapOptionsToLevel,parentColor:c,parentColorIndex:d,series:m,siblings:e});if(c=m.points[a.i])c.color=k.color,\r\nc.colorIndex=k.colorIndex;g(a.children||[],function(c,d){m.setColorRecursive(c,k.color,k.colorIndex,d,a.children.length)})}},algorithmGroup:function(a,c,d,b){this.height=a;this.width=c;this.plot=b;this.startDirection=this.direction=d;this.lH=this.nH=this.lW=this.nW=this.total=0;this.elArr=[];this.lP={total:0,lH:0,nH:0,lW:0,nW:0,nR:0,lR:0,aspectRatio:function(a,c){return Math.max(a/c,c/a)}};this.addElement=function(a){this.lP.total=this.elArr[this.elArr.length-1];this.total+=a;0===this.direction?(this.lW=\r\nthis.nW,this.lP.lH=this.lP.total/this.lW,this.lP.lR=this.lP.aspectRatio(this.lW,this.lP.lH),this.nW=this.total/this.height,this.lP.nH=this.lP.total/this.nW,this.lP.nR=this.lP.aspectRatio(this.nW,this.lP.nH)):(this.lH=this.nH,this.lP.lW=this.lP.total/this.lH,this.lP.lR=this.lP.aspectRatio(this.lP.lW,this.lH),this.nH=this.total/this.width,this.lP.nW=this.lP.total/this.nH,this.lP.nR=this.lP.aspectRatio(this.lP.nW,this.nH));this.elArr.push(a)};this.reset=function(){this.lW=this.nW=0;this.elArr=[];this.total=\r\n0}},algorithmCalcPoints:function(a,c,d,b){var e,m,n,k,l=d.lW,h=d.lH,f=d.plot,q,r=0,p=d.elArr.length-1;c?(l=d.nW,h=d.nH):q=d.elArr[d.elArr.length-1];g(d.elArr,function(a){if(c||r<p)0===d.direction?(e=f.x,m=f.y,n=l,k=a/n):(e=f.x,m=f.y,k=h,n=a/k),b.push({x:e,y:m,width:n,height:k}),0===d.direction?f.y+=k:f.x+=n;r+=1});d.reset();0===d.direction?d.width-=l:d.height-=h;f.y=f.parent.y+(f.parent.height-d.height);f.x=f.parent.x+(f.parent.width-d.width);a&&(d.direction=1-d.direction);c||d.addElement(q)},algorithmLowAspectRatio:function(a,\r\nc,b){var d=[],e=this,m,f={x:c.x,y:c.y,parent:c},k=0,l=b.length-1,h=new this.algorithmGroup(c.height,c.width,c.direction,f);g(b,function(b){m=b.val/c.val*c.height*c.width;h.addElement(m);h.lP.nR>h.lP.lR&&e.algorithmCalcPoints(a,!1,h,d,f);k===l&&e.algorithmCalcPoints(a,!0,h,d,f);k+=1});return d},algorithmFill:function(a,c,b){var d=[],e,m=c.direction,f=c.x,k=c.y,h=c.width,l=c.height,q,r,p,t;g(b,function(b){e=b.val/c.val*c.height*c.width;q=f;r=k;0===m?(t=l,p=e/t,h-=p,f+=p):(p=h,t=e/p,l-=t,k+=t);d.push({x:q,\r\ny:r,width:p,height:t});a&&(m=1-m)});return d},strip:function(a,c){return this.algorithmLowAspectRatio(!1,a,c)},squarified:function(a,c){return this.algorithmLowAspectRatio(!0,a,c)},sliceAndDice:function(a,c){return this.algorithmFill(!0,a,c)},stripes:function(a,c){return this.algorithmFill(!1,a,c)},translate:function(){var a=this,c=a.options,b=I(a),n,e;p.prototype.translate.call(a);e=a.tree=a.getTree();n=a.nodeMap[b];a.mapOptionsToLevel=f({from:n.level+1,levels:c.levels,to:e.height,defaults:{levelIsConstant:a.options.levelIsConstant,\r\ncolorByPoint:c.colorByPoint}});\"\"===b||n&&n.children.length||(a.drillToNode(\"\",!1),b=a.rootNode,n=a.nodeMap[b]);D(a.nodeMap[a.rootNode],function(b){var c=!1,d=b.parent;b.visible=!0;if(d||\"\"===d)c=a.nodeMap[d];return c});D(a.nodeMap[a.rootNode].children,function(a){var b=!1;g(a,function(a){a.visible=!0;a.children.length&&(b=(b||[]).concat(a.children))});return b});a.setTreeValues(e);a.axisRatio=a.xAxis.len/a.yAxis.len;a.nodeMap[\"\"].pointValues=b={x:0,y:0,width:100,height:100};a.nodeMap[\"\"].values=\r\nb=r(b,{width:b.width*a.axisRatio,direction:\"vertical\"===c.layoutStartingDirection?0:1,val:e.val});a.calculateChildrenAreas(e,b);a.colorAxis?a.translateColors():c.colorByPoint||a.setColorRecursive(a.tree);c.allowDrillToNode&&(c=n.pointValues,a.xAxis.setExtremes(c.x,c.x+c.width,!1),a.yAxis.setExtremes(c.y,c.y+c.height,!1),a.xAxis.setScale(),a.yAxis.setScale());a.setPointValues()},drawDataLabels:function(){var a=this,b=a.mapOptionsToLevel,d=l(a.points,function(a){return a.node.visible}),f,e;g(d,function(c){e=\r\nb[c.node.level];f={style:{}};c.node.isLeaf||(f.enabled=!1);e&&e.dataLabels&&(f=r(f,e.dataLabels),a._hasPointLabels=!0);c.shapeArgs&&(f.style.width=c.shapeArgs.width,c.dataLabel&&c.dataLabel.css({width:c.shapeArgs.width+\"px\"}));c.dlOptions=r(f,c.options.dataLabels)});p.prototype.drawDataLabels.call(this)},alignDataLabel:function(a){q.column.prototype.alignDataLabel.apply(this,arguments);a.dataLabel&&a.dataLabel.attr({zIndex:(a.node.zIndex||0)+1})},drawPoints:function(){var a=this,b=l(a.points,function(a){return a.node.visible});\r\ng(b,function(b){var c=\"level-group-\"+b.node.levelDynamic;a[c]||(a[c]=a.chart.renderer.g(c).attr({zIndex:1E3-b.node.levelDynamic}).add(a.group));b.group=a[c]});q.column.prototype.drawPoints.call(this);this.colorAttribs&&g(this.points,function(a){a.graphic&&a.graphic.css(this.colorAttribs(a))},this);a.options.allowDrillToNode&&g(b,function(b){b.graphic&&(b.drillId=a.options.interactByLeaf?a.drillToByLeaf(b):a.drillToByGroup(b))})},onClickDrillToNode:function(a){var b=(a=a.point)&&a.drillId;z(b)&&(a.setState(\"\"),\r\nthis.drillToNode(b))},drillToByGroup:function(a){var b=!1;1!==a.node.level-this.nodeMap[this.rootNode].level||a.node.isLeaf||(b=a.id);return b},drillToByLeaf:function(a){var b=!1;if(a.node.parent!==this.rootNode&&a.node.isLeaf)for(a=a.node;!b;)a=this.nodeMap[a.parent],a.parent===this.rootNode&&(b=a.id);return b},drillUp:function(){var a=this.nodeMap[this.rootNode];a&&z(a.parent)&&this.drillToNode(a.parent)},drillToNode:function(a,b){var c=this.nodeMap[a];this.idPreviousRoot=this.rootNode;this.rootNode=\r\na;\"\"===a?this.drillUpButton=this.drillUpButton.destroy():this.showDrillUpButton(c&&c.name||a);this.isDirty=!0;h(b,!0)&&this.chart.redraw()},showDrillUpButton:function(a){var b=this;a=a||\"\\x3c Back\";var d=b.options.drillUpButton,f,e;d.text&&(a=d.text);this.drillUpButton?(this.drillUpButton.placed=!1,this.drillUpButton.attr({text:a}).align()):(e=(f=d.theme)&&f.states,this.drillUpButton=this.chart.renderer.button(a,null,null,function(){b.drillUp()},f,e&&e.hover,e&&e.select).addClass(\"highcharts-drillup-button\").attr({align:d.position.align,\r\nzIndex:7}).add().align(d.position,!1,d.relativeTo||\"plotBox\"))},buildKDTree:x,drawLegendSymbol:b.LegendSymbolMixin.drawRectangle,getExtremes:function(){p.prototype.getExtremes.call(this,this.colorValueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;p.prototype.getExtremes.call(this)},getExtremesFromAll:!0,bindAxes:function(){var a={endOnTick:!1,gridLineWidth:0,lineWidth:0,min:0,dataMin:0,minPadding:0,max:100,dataMax:100,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};p.prototype.bindAxes.call(this);\r\nb.extend(this.yAxis.options,a);b.extend(this.xAxis.options,a)},utils:{recursive:D,reduce:H}},{getClassName:function(){var a=b.Point.prototype.getClassName.call(this),c=this.series,d=c.options;this.node.level<=c.nodeMap[c.rootNode].level?a+=\" highcharts-above-level\":this.node.isLeaf||h(d.interactByLeaf,!d.allowDrillToNode)?this.node.isLeaf||(a+=\" highcharts-internal-node\"):a+=\" highcharts-internal-node-interactive\";return a},isValid:function(){return this.id||v(this.value)},setState:function(a){b.Point.prototype.setState.call(this,\r\na);this.graphic&&this.graphic.attr({zIndex:\"hover\"===a?1:0})},setVisible:q.pie.prototype.pointClass.prototype.setVisible})})(u,E)});\r\n","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n\r\n 3D features for Highcharts JS\r\n\r\n @license: www.highcharts.com/license\r\n*/\r\n(function(B){\"object\"===typeof module&&module.exports?module.exports=B:B(Highcharts)})(function(B){(function(b){var p=b.deg2rad,y=b.pick;b.perspective=function(t,g,A){var z=g.options.chart.options3d,n=A?g.inverted:!1,r=g.plotWidth/2,x=g.plotHeight/2,q=z.depth/2,f=y(z.depth,1)*y(z.viewDistance,0),a=g.scale3d||1,d=p*z.beta*(n?-1:1),z=p*z.alpha*(n?-1:1),h=Math.cos(z),k=Math.cos(-d),e=Math.sin(z),c=Math.sin(-d);A||(r+=g.plotLeft,x+=g.plotTop);return b.map(t,function(b){var d,l;l=(n?b.y:b.x)-r;var v=(n?\r\nb.x:b.y)-x,G=(b.z||0)-q;d=k*l-c*G;b=-e*c*l+h*v-k*e*G;l=h*c*l+e*v+h*k*G;v=0<f&&f<Number.POSITIVE_INFINITY?f/(l+q+f):1;d=d*v*a+r;b=b*v*a+x;return{x:n?b:d,y:n?d:b,z:l*a+q}})};b.pointCameraDistance=function(b,g){var t=g.options.chart.options3d,z=g.plotWidth/2;g=g.plotHeight/2;t=y(t.depth,1)*y(t.viewDistance,0)+t.depth;return Math.sqrt(Math.pow(z-b.plotX,2)+Math.pow(g-b.plotY,2)+Math.pow(t-b.plotZ,2))};b.shapeArea=function(b){var g=0,t,z;for(t=0;t<b.length;t++)z=(t+1)%b.length,g+=b[t].x*b[z].y-b[z].x*\r\nb[t].y;return g/2};b.shapeArea3d=function(t,g,p){return b.shapeArea(b.perspective(t,g,p))}})(B);(function(b){function p(a,e,c,b,d,f,k,l){var m=[],C=f-d;return f>d&&f-d>Math.PI/2+.0001?(m=m.concat(p(a,e,c,b,d,d+Math.PI/2,k,l)),m=m.concat(p(a,e,c,b,d+Math.PI/2,f,k,l))):f<d&&d-f>Math.PI/2+.0001?(m=m.concat(p(a,e,c,b,d,d-Math.PI/2,k,l)),m=m.concat(p(a,e,c,b,d-Math.PI/2,f,k,l))):[\"C\",a+c*Math.cos(d)-c*w*C*Math.sin(d)+k,e+b*Math.sin(d)+b*w*C*Math.cos(d)+l,a+c*Math.cos(f)+c*w*C*Math.sin(f)+k,e+b*Math.sin(f)-\r\nb*w*C*Math.cos(f)+l,a+c*Math.cos(f)+k,e+b*Math.sin(f)+l]}var y=Math.cos,t=Math.PI,g=Math.sin,A=b.animObject,z=b.charts,n=b.color,r=b.defined,x=b.deg2rad,q=b.each,f=b.extend,a=b.inArray,d=b.map,h=b.merge,k=b.perspective,e=b.pick,c=b.SVGElement,l=b.SVGRenderer,u=b.wrap,w=4*(Math.sqrt(2)-1)/3/(t/2);l.prototype.toLinePath=function(a,e){var c=[];q(a,function(a){c.push(\"L\",a.x,a.y)});a.length&&(c[0]=\"M\",e&&c.push(\"Z\"));return c};l.prototype.toLineSegments=function(a){var e=[],c=!0;q(a,function(a){e.push(c?\r\n\"M\":\"L\",a.x,a.y);c=!c});return e};l.prototype.face3d=function(a){var c=this,m=this.createElement(\"path\");m.vertexes=[];m.insidePlotArea=!1;m.enabled=!0;u(m,\"attr\",function(a,m){if(\"object\"===typeof m&&(r(m.enabled)||r(m.vertexes)||r(m.insidePlotArea))){this.enabled=e(m.enabled,this.enabled);this.vertexes=e(m.vertexes,this.vertexes);this.insidePlotArea=e(m.insidePlotArea,this.insidePlotArea);delete m.enabled;delete m.vertexes;delete m.insidePlotArea;var d=k(this.vertexes,z[c.chartIndex],this.insidePlotArea),\r\nC=c.toLinePath(d,!0),d=b.shapeArea(d),d=this.enabled&&0<d?\"visible\":\"hidden\";m.d=C;m.visibility=d}return a.apply(this,[].slice.call(arguments,1))});u(m,\"animate\",function(a,m){if(\"object\"===typeof m&&(r(m.enabled)||r(m.vertexes)||r(m.insidePlotArea))){this.enabled=e(m.enabled,this.enabled);this.vertexes=e(m.vertexes,this.vertexes);this.insidePlotArea=e(m.insidePlotArea,this.insidePlotArea);delete m.enabled;delete m.vertexes;delete m.insidePlotArea;var d=k(this.vertexes,z[c.chartIndex],this.insidePlotArea),\r\nC=c.toLinePath(d,!0),d=b.shapeArea(d),d=this.enabled&&0<d?\"visible\":\"hidden\";m.d=C;this.attr(\"visibility\",d)}return a.apply(this,[].slice.call(arguments,1))});return m.attr(a)};l.prototype.polyhedron=function(a){var e=this,c=this.g(),b=c.destroy;c.attr({\"stroke-linejoin\":\"round\"});c.faces=[];c.destroy=function(){for(var a=0;a<c.faces.length;a++)c.faces[a].destroy();return b.call(this)};u(c,\"attr\",function(a,b,m,d,C){if(\"object\"===typeof b&&r(b.faces)){for(;c.faces.length>b.faces.length;)c.faces.pop().destroy();\r\nfor(;c.faces.length<b.faces.length;)c.faces.push(e.face3d().add(c));for(var f=0;f<b.faces.length;f++)c.faces[f].attr(b.faces[f],null,d,C);delete b.faces}return a.apply(this,[].slice.call(arguments,1))});u(c,\"animate\",function(a,b,m,d){if(b&&b.faces){for(;c.faces.length>b.faces.length;)c.faces.pop().destroy();for(;c.faces.length<b.faces.length;)c.faces.push(e.face3d().add(c));for(var C=0;C<b.faces.length;C++)c.faces[C].animate(b.faces[C],m,d);delete b.faces}return a.apply(this,[].slice.call(arguments,\r\n1))});return c.attr(a)};l.prototype.cuboid=function(a){var e=this.g(),b=e.destroy;a=this.cuboidPath(a);e.attr({\"stroke-linejoin\":\"round\"});e.front=this.path(a[0]).attr({\"class\":\"highcharts-3d-front\"}).add(e);e.top=this.path(a[1]).attr({\"class\":\"highcharts-3d-top\"}).add(e);e.side=this.path(a[2]).attr({\"class\":\"highcharts-3d-side\"}).add(e);e.fillSetter=function(a){this.front.attr({fill:a});this.top.attr({fill:n(a).brighten(.1).get()});this.side.attr({fill:n(a).brighten(-.1).get()});this.color=a;e.fill=\r\na;return this};e.opacitySetter=function(a){this.front.attr({opacity:a});this.top.attr({opacity:a});this.side.attr({opacity:a});return this};e.attr=function(a,e,b,m){if(\"string\"===typeof a&&\"undefined\"!==typeof e){var d=a;a={};a[d]=e}if(a.shapeArgs||r(a.x))a=this.renderer.cuboidPath(a.shapeArgs||a),this.front.attr({d:a[0]}),this.top.attr({d:a[1]}),this.side.attr({d:a[2]});else return c.prototype.attr.call(this,a,void 0,b,m);return this};e.animate=function(a,e,b){r(a.x)&&r(a.y)?(a=this.renderer.cuboidPath(a),\r\nthis.front.animate({d:a[0]},e,b),this.top.animate({d:a[1]},e,b),this.side.animate({d:a[2]},e,b),this.attr({zIndex:-a[3]})):a.opacity?(this.front.animate(a,e,b),this.top.animate(a,e,b),this.side.animate(a,e,b)):c.prototype.animate.call(this,a,e,b);return this};e.destroy=function(){this.front.destroy();this.top.destroy();this.side.destroy();return b.call(this)};e.attr({zIndex:-a[3]});return e};b.SVGRenderer.prototype.cuboidPath=function(a){function e(a){return t[a]}var c=a.x,f=a.y,l=a.z,v=a.height,\r\nu=a.width,h=a.depth,q=z[this.chartIndex],D,w,n=q.options.chart.options3d.alpha,g=0,t=[{x:c,y:f,z:l},{x:c+u,y:f,z:l},{x:c+u,y:f+v,z:l},{x:c,y:f+v,z:l},{x:c,y:f+v,z:l+h},{x:c+u,y:f+v,z:l+h},{x:c+u,y:f,z:l+h},{x:c,y:f,z:l+h}],t=k(t,q,a.insidePlotArea);w=function(a,c){var m=[[],-1];a=d(a,e);c=d(c,e);0>b.shapeArea(a)?m=[a,0]:0>b.shapeArea(c)&&(m=[c,1]);return m};D=w([3,2,1,0],[7,6,5,4]);a=D[0];u=D[1];D=w([1,6,7,0],[4,5,2,3]);v=D[0];h=D[1];D=w([1,2,5,6],[0,7,4,3]);w=D[0];D=D[1];1===D?g+=1E4*(1E3-c):D||\r\n(g+=1E4*c);g+=10*(!h||0<=n&&180>=n||360>n&&357.5<n?q.plotHeight-f:10+f);1===u?g+=100*l:u||(g+=100*(1E3-l));g=-Math.round(g);return[this.toLinePath(a,!0),this.toLinePath(v,!0),this.toLinePath(w,!0),g]};b.SVGRenderer.prototype.arc3d=function(b){function d(c){var e=!1,b={};c=h(c);for(var d in c)-1!==a(d,k)&&(b[d]=c[d],delete c[d],e=!0);return e?b:!1}var m=this.g(),l=m.renderer,k=\"x y r innerR start end\".split(\" \");b=h(b);b.alpha*=x;b.beta*=x;m.top=l.path();m.side1=l.path();m.side2=l.path();m.inn=l.path();\r\nm.out=l.path();m.onAdd=function(){var a=m.parentGroup,c=m.attr(\"class\");m.top.add(m);q([\"out\",\"inn\",\"side1\",\"side2\"],function(e){m[e].attr({\"class\":c+\" highcharts-3d-side\"}).add(a)})};q([\"addClass\",\"removeClass\"],function(a){m[a]=function(){var c=arguments;q([\"top\",\"out\",\"inn\",\"side1\",\"side2\"],function(e){m[e][a].apply(m[e],c)})}});m.setPaths=function(a){var c=m.renderer.arc3dPath(a),e=100*c.zTop;m.attribs=a;m.top.attr({d:c.top,zIndex:c.zTop});m.inn.attr({d:c.inn,zIndex:c.zInn});m.out.attr({d:c.out,\r\nzIndex:c.zOut});m.side1.attr({d:c.side1,zIndex:c.zSide1});m.side2.attr({d:c.side2,zIndex:c.zSide2});m.zIndex=e;m.attr({zIndex:e});a.center&&(m.top.setRadialReference(a.center),delete a.center)};m.setPaths(b);m.fillSetter=function(a){var c=n(a).brighten(-.1).get();this.fill=a;this.side1.attr({fill:c});this.side2.attr({fill:c});this.inn.attr({fill:c});this.out.attr({fill:c});this.top.attr({fill:a});return this};q([\"opacity\",\"translateX\",\"translateY\",\"visibility\"],function(a){m[a+\"Setter\"]=function(a,\r\nc){m[c]=a;q([\"out\",\"inn\",\"side1\",\"side2\",\"top\"],function(e){m[e].attr(c,a)})}});u(m,\"attr\",function(a,c){var e;\"object\"===typeof c&&(e=d(c))&&(f(m.attribs,e),m.setPaths(m.attribs));return a.apply(this,[].slice.call(arguments,1))});u(m,\"animate\",function(a,c,b,f){var l,k=this.attribs,u;delete c.center;delete c.z;delete c.depth;delete c.alpha;delete c.beta;u=A(e(b,this.renderer.globalAnimation));u.duration&&(l=d(c),c.dummy=m.dummy++,l&&(u.step=function(a,c){function b(a){return k[a]+(e(l[a],k[a])-k[a])*\r\nc.pos}\"dummy\"===c.prop&&c.elem.setPaths(h(k,{x:b(\"x\"),y:b(\"y\"),r:b(\"r\"),innerR:b(\"innerR\"),start:b(\"start\"),end:b(\"end\")}))}),b=u);return a.call(this,c,b,f)});m.dummy=0;m.destroy=function(){this.top.destroy();this.out.destroy();this.inn.destroy();this.side1.destroy();this.side2.destroy();c.prototype.destroy.call(this)};m.hide=function(){this.top.hide();this.out.hide();this.inn.hide();this.side1.hide();this.side2.hide()};m.show=function(){this.top.show();this.out.show();this.inn.show();this.side1.show();\r\nthis.side2.show()};return m};l.prototype.arc3dPath=function(a){function c(a){a%=2*Math.PI;a>Math.PI&&(a=2*Math.PI-a);return a}var e=a.x,b=a.y,d=a.start,f=a.end-.00001,l=a.r,k=a.innerR,u=a.depth,h=a.alpha,q=a.beta,v=Math.cos(d),w=Math.sin(d);a=Math.cos(f);var n=Math.sin(f),r=l*Math.cos(q),l=l*Math.cos(h),z=k*Math.cos(q),x=k*Math.cos(h),k=u*Math.sin(q),A=u*Math.sin(h),u=[\"M\",e+r*v,b+l*w],u=u.concat(p(e,b,r,l,d,f,0,0)),u=u.concat([\"L\",e+z*a,b+x*n]),u=u.concat(p(e,b,z,x,f,d,0,0)),u=u.concat([\"Z\"]),B=\r\n0<q?Math.PI/2:0,q=0<h?0:Math.PI/2,B=d>-B?d:f>-B?-B:d,E=f<t-q?f:d<t-q?t-q:f,F=2*t-q,h=[\"M\",e+r*y(B),b+l*g(B)],h=h.concat(p(e,b,r,l,B,E,0,0));f>F&&d<F?(h=h.concat([\"L\",e+r*y(E)+k,b+l*g(E)+A]),h=h.concat(p(e,b,r,l,E,F,k,A)),h=h.concat([\"L\",e+r*y(F),b+l*g(F)]),h=h.concat(p(e,b,r,l,F,f,0,0)),h=h.concat([\"L\",e+r*y(f)+k,b+l*g(f)+A]),h=h.concat(p(e,b,r,l,f,F,k,A)),h=h.concat([\"L\",e+r*y(F),b+l*g(F)]),h=h.concat(p(e,b,r,l,F,E,0,0))):f>t-q&&d<t-q&&(h=h.concat([\"L\",e+r*Math.cos(E)+k,b+l*Math.sin(E)+A]),h=h.concat(p(e,\r\nb,r,l,E,f,k,A)),h=h.concat([\"L\",e+r*Math.cos(f),b+l*Math.sin(f)]),h=h.concat(p(e,b,r,l,f,E,0,0)));h=h.concat([\"L\",e+r*Math.cos(E)+k,b+l*Math.sin(E)+A]);h=h.concat(p(e,b,r,l,E,B,k,A));h=h.concat([\"Z\"]);q=[\"M\",e+z*v,b+x*w];q=q.concat(p(e,b,z,x,d,f,0,0));q=q.concat([\"L\",e+z*Math.cos(f)+k,b+x*Math.sin(f)+A]);q=q.concat(p(e,b,z,x,f,d,k,A));q=q.concat([\"Z\"]);v=[\"M\",e+r*v,b+l*w,\"L\",e+r*v+k,b+l*w+A,\"L\",e+z*v+k,b+x*w+A,\"L\",e+z*v,b+x*w,\"Z\"];e=[\"M\",e+r*a,b+l*n,\"L\",e+r*a+k,b+l*n+A,\"L\",e+z*a+k,b+x*n+A,\"L\",e+z*\r\na,b+x*n,\"Z\"];n=Math.atan2(A,-k);b=Math.abs(f+n);a=Math.abs(d+n);d=Math.abs((d+f)/2+n);b=c(b);a=c(a);d=c(d);d*=1E5;f=1E5*a;b*=1E5;return{top:u,zTop:1E5*Math.PI+1,out:h,zOut:Math.max(d,f,b),inn:q,zInn:Math.max(d,f,b),side1:v,zSide1:.99*b,side2:e,zSide2:.99*f}}})(B);(function(b){function p(b,f){var a=b.plotLeft,d=b.plotWidth+a,h=b.plotTop,k=b.plotHeight+h,e=a+b.plotWidth/2,c=h+b.plotHeight/2,l=Number.MAX_VALUE,u=-Number.MAX_VALUE,q=Number.MAX_VALUE,v=-Number.MAX_VALUE,n,m=1;n=[{x:a,y:h,z:0},{x:a,y:h,\r\nz:f}];g([0,1],function(a){n.push({x:d,y:n[a].y,z:n[a].z})});g([0,1,2,3],function(a){n.push({x:n[a].x,y:k,z:n[a].z})});n=z(n,b,!1);g(n,function(a){l=Math.min(l,a.x);u=Math.max(u,a.x);q=Math.min(q,a.y);v=Math.max(v,a.y)});a>l&&(m=Math.min(m,1-Math.abs((a+e)/(l+e))%1));d<u&&(m=Math.min(m,(d-e)/(u-e)));h>q&&(m=0>q?Math.min(m,(h+c)/(-q+h+c)):Math.min(m,1-(h+c)/(q+c)%1));k<v&&(m=Math.min(m,Math.abs((k-c)/(v-c))));return m}var y=b.addEvent,t=b.Chart,g=b.each,A=b.merge,z=b.perspective,n=b.pick,r=b.wrap;t.prototype.is3d=\r\nfunction(){return this.options.chart.options3d&&this.options.chart.options3d.enabled};t.prototype.propsRequireDirtyBox.push(\"chart.options3d\");t.prototype.propsRequireUpdateSeries.push(\"chart.options3d\");y(t,\"afterInit\",function(){var b=this.options;this.is3d()&&g(b.series,function(f){\"scatter\"===(f.type||b.chart.type||b.chart.defaultSeriesType)&&(f.type=\"scatter3d\")})});b.wrap(b.Chart.prototype,\"isInsidePlot\",function(b){return this.is3d()||b.apply(this,[].slice.call(arguments,1))});var x=b.getOptions();\r\nA(!0,x,{chart:{options3d:{enabled:!1,alpha:0,beta:0,depth:100,fitToPlot:!0,viewDistance:25,axisLabelPosition:\"default\",frame:{visible:\"default\",size:1,bottom:{},top:{},left:{},right:{},back:{},front:{}}}}});r(t.prototype,\"setClassName\",function(b){b.apply(this,[].slice.call(arguments,1));this.is3d()&&(this.container.className+=\" highcharts-3d-chart\")});y(b.Chart,\"afterSetChartSize\",function(){var b=this.options.chart.options3d;if(this.is3d()){var f=this.inverted,a=this.clipBox,d=this.margin;a[f?\"y\":\r\n\"x\"]=-(d[3]||0);a[f?\"x\":\"y\"]=-(d[0]||0);a[f?\"height\":\"width\"]=this.chartWidth+(d[3]||0)+(d[1]||0);a[f?\"width\":\"height\"]=this.chartHeight+(d[0]||0)+(d[2]||0);this.scale3d=1;!0===b.fitToPlot&&(this.scale3d=p(this,b.depth));this.frame3d=this.get3dFrame()}});y(t,\"beforeRedraw\",function(){this.is3d()&&(this.isDirtyBox=!0)});y(t,\"beforeRender\",function(){this.is3d()&&(this.frame3d=this.get3dFrame())});r(t.prototype,\"renderSeries\",function(b){var f=this.series.length;if(this.is3d())for(;f--;)b=this.series[f],\r\nb.translate(),b.render();else b.call(this)});y(t,\"afterDrawChartBox\",function(){if(this.is3d()){var n=this.renderer,f=this.options.chart.options3d,a=this.get3dFrame(),d=this.plotLeft,h=this.plotLeft+this.plotWidth,k=this.plotTop,e=this.plotTop+this.plotHeight,f=f.depth,c=d-(a.left.visible?a.left.size:0),l=h+(a.right.visible?a.right.size:0),u=k-(a.top.visible?a.top.size:0),w=e+(a.bottom.visible?a.bottom.size:0),v=0-(a.front.visible?a.front.size:0),g=f+(a.back.visible?a.back.size:0),m=this.hasRendered?\r\n\"animate\":\"attr\";this.frame3d=a;this.frameShapes||(this.frameShapes={bottom:n.polyhedron().add(),top:n.polyhedron().add(),left:n.polyhedron().add(),right:n.polyhedron().add(),back:n.polyhedron().add(),front:n.polyhedron().add()});this.frameShapes.bottom[m]({\"class\":\"highcharts-3d-frame highcharts-3d-frame-bottom\",zIndex:a.bottom.frontFacing?-1E3:1E3,faces:[{fill:b.color(a.bottom.color).brighten(.1).get(),vertexes:[{x:c,y:w,z:v},{x:l,y:w,z:v},{x:l,y:w,z:g},{x:c,y:w,z:g}],enabled:a.bottom.visible},\r\n{fill:b.color(a.bottom.color).brighten(.1).get(),vertexes:[{x:d,y:e,z:f},{x:h,y:e,z:f},{x:h,y:e,z:0},{x:d,y:e,z:0}],enabled:a.bottom.visible},{fill:b.color(a.bottom.color).brighten(-.1).get(),vertexes:[{x:c,y:w,z:v},{x:c,y:w,z:g},{x:d,y:e,z:f},{x:d,y:e,z:0}],enabled:a.bottom.visible&&!a.left.visible},{fill:b.color(a.bottom.color).brighten(-.1).get(),vertexes:[{x:l,y:w,z:g},{x:l,y:w,z:v},{x:h,y:e,z:0},{x:h,y:e,z:f}],enabled:a.bottom.visible&&!a.right.visible},{fill:b.color(a.bottom.color).get(),vertexes:[{x:l,\r\ny:w,z:v},{x:c,y:w,z:v},{x:d,y:e,z:0},{x:h,y:e,z:0}],enabled:a.bottom.visible&&!a.front.visible},{fill:b.color(a.bottom.color).get(),vertexes:[{x:c,y:w,z:g},{x:l,y:w,z:g},{x:h,y:e,z:f},{x:d,y:e,z:f}],enabled:a.bottom.visible&&!a.back.visible}]});this.frameShapes.top[m]({\"class\":\"highcharts-3d-frame highcharts-3d-frame-top\",zIndex:a.top.frontFacing?-1E3:1E3,faces:[{fill:b.color(a.top.color).brighten(.1).get(),vertexes:[{x:c,y:u,z:g},{x:l,y:u,z:g},{x:l,y:u,z:v},{x:c,y:u,z:v}],enabled:a.top.visible},\r\n{fill:b.color(a.top.color).brighten(.1).get(),vertexes:[{x:d,y:k,z:0},{x:h,y:k,z:0},{x:h,y:k,z:f},{x:d,y:k,z:f}],enabled:a.top.visible},{fill:b.color(a.top.color).brighten(-.1).get(),vertexes:[{x:c,y:u,z:g},{x:c,y:u,z:v},{x:d,y:k,z:0},{x:d,y:k,z:f}],enabled:a.top.visible&&!a.left.visible},{fill:b.color(a.top.color).brighten(-.1).get(),vertexes:[{x:l,y:u,z:v},{x:l,y:u,z:g},{x:h,y:k,z:f},{x:h,y:k,z:0}],enabled:a.top.visible&&!a.right.visible},{fill:b.color(a.top.color).get(),vertexes:[{x:c,y:u,z:v},\r\n{x:l,y:u,z:v},{x:h,y:k,z:0},{x:d,y:k,z:0}],enabled:a.top.visible&&!a.front.visible},{fill:b.color(a.top.color).get(),vertexes:[{x:l,y:u,z:g},{x:c,y:u,z:g},{x:d,y:k,z:f},{x:h,y:k,z:f}],enabled:a.top.visible&&!a.back.visible}]});this.frameShapes.left[m]({\"class\":\"highcharts-3d-frame highcharts-3d-frame-left\",zIndex:a.left.frontFacing?-1E3:1E3,faces:[{fill:b.color(a.left.color).brighten(.1).get(),vertexes:[{x:c,y:w,z:v},{x:d,y:e,z:0},{x:d,y:e,z:f},{x:c,y:w,z:g}],enabled:a.left.visible&&!a.bottom.visible},\r\n{fill:b.color(a.left.color).brighten(.1).get(),vertexes:[{x:c,y:u,z:g},{x:d,y:k,z:f},{x:d,y:k,z:0},{x:c,y:u,z:v}],enabled:a.left.visible&&!a.top.visible},{fill:b.color(a.left.color).brighten(-.1).get(),vertexes:[{x:c,y:w,z:g},{x:c,y:u,z:g},{x:c,y:u,z:v},{x:c,y:w,z:v}],enabled:a.left.visible},{fill:b.color(a.left.color).brighten(-.1).get(),vertexes:[{x:d,y:k,z:f},{x:d,y:e,z:f},{x:d,y:e,z:0},{x:d,y:k,z:0}],enabled:a.left.visible},{fill:b.color(a.left.color).get(),vertexes:[{x:c,y:w,z:v},{x:c,y:u,z:v},\r\n{x:d,y:k,z:0},{x:d,y:e,z:0}],enabled:a.left.visible&&!a.front.visible},{fill:b.color(a.left.color).get(),vertexes:[{x:c,y:u,z:g},{x:c,y:w,z:g},{x:d,y:e,z:f},{x:d,y:k,z:f}],enabled:a.left.visible&&!a.back.visible}]});this.frameShapes.right[m]({\"class\":\"highcharts-3d-frame highcharts-3d-frame-right\",zIndex:a.right.frontFacing?-1E3:1E3,faces:[{fill:b.color(a.right.color).brighten(.1).get(),vertexes:[{x:l,y:w,z:g},{x:h,y:e,z:f},{x:h,y:e,z:0},{x:l,y:w,z:v}],enabled:a.right.visible&&!a.bottom.visible},\r\n{fill:b.color(a.right.color).brighten(.1).get(),vertexes:[{x:l,y:u,z:v},{x:h,y:k,z:0},{x:h,y:k,z:f},{x:l,y:u,z:g}],enabled:a.right.visible&&!a.top.visible},{fill:b.color(a.right.color).brighten(-.1).get(),vertexes:[{x:h,y:k,z:0},{x:h,y:e,z:0},{x:h,y:e,z:f},{x:h,y:k,z:f}],enabled:a.right.visible},{fill:b.color(a.right.color).brighten(-.1).get(),vertexes:[{x:l,y:w,z:v},{x:l,y:u,z:v},{x:l,y:u,z:g},{x:l,y:w,z:g}],enabled:a.right.visible},{fill:b.color(a.right.color).get(),vertexes:[{x:l,y:u,z:v},{x:l,\r\ny:w,z:v},{x:h,y:e,z:0},{x:h,y:k,z:0}],enabled:a.right.visible&&!a.front.visible},{fill:b.color(a.right.color).get(),vertexes:[{x:l,y:w,z:g},{x:l,y:u,z:g},{x:h,y:k,z:f},{x:h,y:e,z:f}],enabled:a.right.visible&&!a.back.visible}]});this.frameShapes.back[m]({\"class\":\"highcharts-3d-frame highcharts-3d-frame-back\",zIndex:a.back.frontFacing?-1E3:1E3,faces:[{fill:b.color(a.back.color).brighten(.1).get(),vertexes:[{x:l,y:w,z:g},{x:c,y:w,z:g},{x:d,y:e,z:f},{x:h,y:e,z:f}],enabled:a.back.visible&&!a.bottom.visible},\r\n{fill:b.color(a.back.color).brighten(.1).get(),vertexes:[{x:c,y:u,z:g},{x:l,y:u,z:g},{x:h,y:k,z:f},{x:d,y:k,z:f}],enabled:a.back.visible&&!a.top.visible},{fill:b.color(a.back.color).brighten(-.1).get(),vertexes:[{x:c,y:w,z:g},{x:c,y:u,z:g},{x:d,y:k,z:f},{x:d,y:e,z:f}],enabled:a.back.visible&&!a.left.visible},{fill:b.color(a.back.color).brighten(-.1).get(),vertexes:[{x:l,y:u,z:g},{x:l,y:w,z:g},{x:h,y:e,z:f},{x:h,y:k,z:f}],enabled:a.back.visible&&!a.right.visible},{fill:b.color(a.back.color).get(),\r\nvertexes:[{x:d,y:k,z:f},{x:h,y:k,z:f},{x:h,y:e,z:f},{x:d,y:e,z:f}],enabled:a.back.visible},{fill:b.color(a.back.color).get(),vertexes:[{x:c,y:w,z:g},{x:l,y:w,z:g},{x:l,y:u,z:g},{x:c,y:u,z:g}],enabled:a.back.visible}]});this.frameShapes.front[m]({\"class\":\"highcharts-3d-frame highcharts-3d-frame-front\",zIndex:a.front.frontFacing?-1E3:1E3,faces:[{fill:b.color(a.front.color).brighten(.1).get(),vertexes:[{x:c,y:w,z:v},{x:l,y:w,z:v},{x:h,y:e,z:0},{x:d,y:e,z:0}],enabled:a.front.visible&&!a.bottom.visible},\r\n{fill:b.color(a.front.color).brighten(.1).get(),vertexes:[{x:l,y:u,z:v},{x:c,y:u,z:v},{x:d,y:k,z:0},{x:h,y:k,z:0}],enabled:a.front.visible&&!a.top.visible},{fill:b.color(a.front.color).brighten(-.1).get(),vertexes:[{x:c,y:u,z:v},{x:c,y:w,z:v},{x:d,y:e,z:0},{x:d,y:k,z:0}],enabled:a.front.visible&&!a.left.visible},{fill:b.color(a.front.color).brighten(-.1).get(),vertexes:[{x:l,y:w,z:v},{x:l,y:u,z:v},{x:h,y:k,z:0},{x:h,y:e,z:0}],enabled:a.front.visible&&!a.right.visible},{fill:b.color(a.front.color).get(),\r\nvertexes:[{x:h,y:k,z:0},{x:d,y:k,z:0},{x:d,y:e,z:0},{x:h,y:e,z:0}],enabled:a.front.visible},{fill:b.color(a.front.color).get(),vertexes:[{x:l,y:w,z:v},{x:c,y:w,z:v},{x:c,y:u,z:v},{x:l,y:u,z:v}],enabled:a.front.visible}]})}});t.prototype.retrieveStacks=function(b){var f=this.series,a={},d,h=1;g(this.series,function(k){d=n(k.options.stack,b?0:f.length-1-k.index);a[d]?a[d].series.push(k):(a[d]={series:[k],position:h},h++)});a.totalStacks=h+1;return a};t.prototype.get3dFrame=function(){var q=this,f=q.options.chart.options3d,\r\na=f.frame,d=q.plotLeft,h=q.plotLeft+q.plotWidth,k=q.plotTop,e=q.plotTop+q.plotHeight,c=f.depth,l=function(a){a=b.shapeArea3d(a,q);return.5<a?1:-.5>a?-1:0},u=l([{x:d,y:e,z:c},{x:h,y:e,z:c},{x:h,y:e,z:0},{x:d,y:e,z:0}]),w=l([{x:d,y:k,z:0},{x:h,y:k,z:0},{x:h,y:k,z:c},{x:d,y:k,z:c}]),v=l([{x:d,y:k,z:0},{x:d,y:k,z:c},{x:d,y:e,z:c},{x:d,y:e,z:0}]),r=l([{x:h,y:k,z:c},{x:h,y:k,z:0},{x:h,y:e,z:0},{x:h,y:e,z:c}]),m=l([{x:d,y:e,z:0},{x:h,y:e,z:0},{x:h,y:k,z:0},{x:d,y:k,z:0}]),l=l([{x:d,y:k,z:c},{x:h,y:k,z:c},\r\n{x:h,y:e,z:c},{x:d,y:e,z:c}]),t=!1,A=!1,x=!1,p=!1;g([].concat(q.xAxis,q.yAxis,q.zAxis),function(a){a&&(a.horiz?a.opposite?A=!0:t=!0:a.opposite?p=!0:x=!0)});var y=function(a,c,e){for(var b=[\"size\",\"color\",\"visible\"],d={},f=0;f<b.length;f++)for(var l=b[f],h=0;h<a.length;h++)if(\"object\"===typeof a[h]){var k=a[h][l];if(void 0!==k&&null!==k){d[l]=k;break}}a=e;!0===d.visible||!1===d.visible?a=d.visible:\"auto\"===d.visible&&(a=0<c);return{size:n(d.size,1),color:n(d.color,\"none\"),frontFacing:0<c,visible:a}},\r\na={bottom:y([a.bottom,a.top,a],u,t),top:y([a.top,a.bottom,a],w,A),left:y([a.left,a.right,a.side,a],v,x),right:y([a.right,a.left,a.side,a],r,p),back:y([a.back,a.front,a],l,!0),front:y([a.front,a.back,a],m,!1)};\"auto\"===f.axisLabelPosition?(r=function(a,c){return a.visible!==c.visible||a.visible&&c.visible&&a.frontFacing!==c.frontFacing},f=[],r(a.left,a.front)&&f.push({y:(k+e)/2,x:d,z:0,xDir:{x:1,y:0,z:0}}),r(a.left,a.back)&&f.push({y:(k+e)/2,x:d,z:c,xDir:{x:0,y:0,z:-1}}),r(a.right,a.front)&&f.push({y:(k+\r\ne)/2,x:h,z:0,xDir:{x:0,y:0,z:1}}),r(a.right,a.back)&&f.push({y:(k+e)/2,x:h,z:c,xDir:{x:-1,y:0,z:0}}),u=[],r(a.bottom,a.front)&&u.push({x:(d+h)/2,y:e,z:0,xDir:{x:1,y:0,z:0}}),r(a.bottom,a.back)&&u.push({x:(d+h)/2,y:e,z:c,xDir:{x:-1,y:0,z:0}}),w=[],r(a.top,a.front)&&w.push({x:(d+h)/2,y:k,z:0,xDir:{x:1,y:0,z:0}}),r(a.top,a.back)&&w.push({x:(d+h)/2,y:k,z:c,xDir:{x:-1,y:0,z:0}}),v=[],r(a.bottom,a.left)&&v.push({z:(0+c)/2,y:e,x:d,xDir:{x:0,y:0,z:-1}}),r(a.bottom,a.right)&&v.push({z:(0+c)/2,y:e,x:h,xDir:{x:0,\r\ny:0,z:1}}),e=[],r(a.top,a.left)&&e.push({z:(0+c)/2,y:k,x:d,xDir:{x:0,y:0,z:-1}}),r(a.top,a.right)&&e.push({z:(0+c)/2,y:k,x:h,xDir:{x:0,y:0,z:1}}),d=function(a,c,e){if(0===a.length)return null;if(1===a.length)return a[0];for(var b=0,d=z(a,q,!1),f=1;f<d.length;f++)e*d[f][c]>e*d[b][c]?b=f:e*d[f][c]===e*d[b][c]&&d[f].z<d[b].z&&(b=f);return a[b]},a.axes={y:{left:d(f,\"x\",-1),right:d(f,\"x\",1)},x:{top:d(w,\"y\",-1),bottom:d(u,\"y\",1)},z:{top:d(e,\"y\",-1),bottom:d(v,\"y\",1)}}):a.axes={y:{left:{x:d,z:0,xDir:{x:1,\r\ny:0,z:0}},right:{x:h,z:0,xDir:{x:0,y:0,z:1}}},x:{top:{y:k,z:0,xDir:{x:1,y:0,z:0}},bottom:{y:e,z:0,xDir:{x:1,y:0,z:0}}},z:{top:{x:x?h:d,y:k,xDir:x?{x:0,y:0,z:1}:{x:0,y:0,z:-1}},bottom:{x:x?h:d,y:e,xDir:x?{x:0,y:0,z:1}:{x:0,y:0,z:-1}}}};return a};b.Fx.prototype.matrixSetter=function(){var g;if(1>this.pos&&(b.isArray(this.start)||b.isArray(this.end))){var f=this.start||[1,0,0,1,0,0],a=this.end||[1,0,0,1,0,0];g=[];for(var d=0;6>d;d++)g.push(this.pos*a[d]+(1-this.pos)*f[d])}else g=this.end;this.elem.attr(this.prop,\r\ng,null,!0)}})(B);(function(b){function p(e,c,b){if(!e.chart.is3d()||\"colorAxis\"===e.coll)return c;var d=e.chart,l=z*d.options.chart.options3d.alpha,h=z*d.options.chart.options3d.beta,k=f(b&&e.options.title.position3d,e.options.labels.position3d);b=f(b&&e.options.title.skew3d,e.options.labels.skew3d);var m=d.frame3d,g=d.plotLeft,n=d.plotWidth+g,r=d.plotTop,t=d.plotHeight+r,d=!1,x=0,A=0,p={x:0,y:1,z:0};c=e.swapZ({x:c.x,y:c.y,z:0});if(e.isZAxis)if(e.opposite){if(null===m.axes.z.top)return{};A=c.y-r;\r\nc.x=m.axes.z.top.x;c.y=m.axes.z.top.y;g=m.axes.z.top.xDir;d=!m.top.frontFacing}else{if(null===m.axes.z.bottom)return{};A=c.y-t;c.x=m.axes.z.bottom.x;c.y=m.axes.z.bottom.y;g=m.axes.z.bottom.xDir;d=!m.bottom.frontFacing}else if(e.horiz)if(e.opposite){if(null===m.axes.x.top)return{};A=c.y-r;c.y=m.axes.x.top.y;c.z=m.axes.x.top.z;g=m.axes.x.top.xDir;d=!m.top.frontFacing}else{if(null===m.axes.x.bottom)return{};A=c.y-t;c.y=m.axes.x.bottom.y;c.z=m.axes.x.bottom.z;g=m.axes.x.bottom.xDir;d=!m.bottom.frontFacing}else if(e.opposite){if(null===\r\nm.axes.y.right)return{};x=c.x-n;c.x=m.axes.y.right.x;c.z=m.axes.y.right.z;g=m.axes.y.right.xDir;g={x:g.z,y:g.y,z:-g.x}}else{if(null===m.axes.y.left)return{};x=c.x-g;c.x=m.axes.y.left.x;c.z=m.axes.y.left.z;g=m.axes.y.left.xDir}\"chart\"!==k&&(\"flap\"===k?e.horiz?(h=Math.sin(l),l=Math.cos(l),e.opposite&&(h=-h),d&&(h=-h),p={x:g.z*h,y:l,z:-g.x*h}):g={x:Math.cos(h),y:0,z:Math.sin(h)}:\"ortho\"===k?e.horiz?(p=Math.cos(l),k=Math.sin(h)*p,l=-Math.sin(l),h=-p*Math.cos(h),p={x:g.y*h-g.z*l,y:g.z*k-g.x*h,z:g.x*l-\r\ng.y*k},l=1/Math.sqrt(p.x*p.x+p.y*p.y+p.z*p.z),d&&(l=-l),p={x:l*p.x,y:l*p.y,z:l*p.z}):g={x:Math.cos(h),y:0,z:Math.sin(h)}:e.horiz?p={x:Math.sin(h)*Math.sin(l),y:Math.cos(l),z:-Math.cos(h)*Math.sin(l)}:g={x:Math.cos(h),y:0,z:Math.sin(h)});c.x+=x*g.x+A*p.x;c.y+=x*g.y+A*p.y;c.z+=x*g.z+A*p.z;d=q([c],e.chart)[0];b?(0>a(q([c,{x:c.x+g.x,y:c.y+g.y,z:c.z+g.z},{x:c.x+p.x,y:c.y+p.y,z:c.z+p.z}],e.chart))&&(g={x:-g.x,y:-g.y,z:-g.z}),e=q([{x:c.x,y:c.y,z:c.z},{x:c.x+g.x,y:c.y+g.y,z:c.z+g.z},{x:c.x+p.x,y:c.y+p.y,\r\nz:c.z+p.z}],e.chart),d.matrix=[e[1].x-e[0].x,e[1].y-e[0].y,e[2].x-e[0].x,e[2].y-e[0].y,d.x,d.y],d.matrix[4]-=d.x*d.matrix[0]+d.y*d.matrix[2],d.matrix[5]-=d.x*d.matrix[1]+d.y*d.matrix[3]):d.matrix=null;return d}var y,t=b.addEvent,g=b.Axis,A=b.Chart,z=b.deg2rad,n=b.each,r=b.extend,x=b.merge,q=b.perspective,f=b.pick,a=b.shapeArea,d=b.splat,h=b.Tick,k=b.wrap;x(!0,g.prototype.defaultOptions,{labels:{position3d:\"offset\",skew3d:!1},title:{position3d:null,skew3d:null}});t(g,\"afterSetOptions\",function(){var a;\r\nthis.chart.is3d&&this.chart.is3d()&&\"colorAxis\"!==this.coll&&(a=this.options,a.tickWidth=f(a.tickWidth,0),a.gridLineWidth=f(a.gridLineWidth,1))});k(g.prototype,\"getPlotLinePath\",function(a){var c=a.apply(this,[].slice.call(arguments,1));if(!this.chart.is3d()||\"colorAxis\"===this.coll||null===c)return c;var b=this.chart,e=b.options.chart.options3d,e=this.isZAxis?b.plotWidth:e.depth,b=b.frame3d,c=[this.swapZ({x:c[1],y:c[2],z:0}),this.swapZ({x:c[1],y:c[2],z:e}),this.swapZ({x:c[4],y:c[5],z:0}),this.swapZ({x:c[4],\r\ny:c[5],z:e})],e=[];this.horiz?(this.isZAxis?(b.left.visible&&e.push(c[0],c[2]),b.right.visible&&e.push(c[1],c[3])):(b.front.visible&&e.push(c[0],c[2]),b.back.visible&&e.push(c[1],c[3])),b.top.visible&&e.push(c[0],c[1]),b.bottom.visible&&e.push(c[2],c[3])):(b.front.visible&&e.push(c[0],c[2]),b.back.visible&&e.push(c[1],c[3]),b.left.visible&&e.push(c[0],c[1]),b.right.visible&&e.push(c[2],c[3]));e=q(e,this.chart,!1);return this.chart.renderer.toLineSegments(e)});k(g.prototype,\"getLinePath\",function(a){return this.chart.is3d()&&\r\n\"colorAxis\"!==this.coll?[]:a.apply(this,[].slice.call(arguments,1))});k(g.prototype,\"getPlotBandPath\",function(a){if(!this.chart.is3d()||\"colorAxis\"===this.coll)return a.apply(this,[].slice.call(arguments,1));var b=arguments,e=b[2],d=[],b=this.getPlotLinePath(b[1]),e=this.getPlotLinePath(e);if(b&&e)for(var f=0;f<b.length;f+=6)d.push(\"M\",b[f+1],b[f+2],\"L\",b[f+4],b[f+5],\"L\",e[f+4],e[f+5],\"L\",e[f+1],e[f+2],\"Z\");return d});k(h.prototype,\"getMarkPath\",function(a){var b=a.apply(this,[].slice.call(arguments,\r\n1)),b=[p(this.axis,{x:b[1],y:b[2],z:0}),p(this.axis,{x:b[4],y:b[5],z:0})];return this.axis.chart.renderer.toLineSegments(b)});t(h,\"afterGetLabelPosition\",function(a){r(a.pos,p(this.axis,a.pos))});k(g.prototype,\"getTitlePosition\",function(a){var b=a.apply(this,[].slice.call(arguments,1));return p(this,b,!0)});t(g,\"drawCrosshair\",function(a){this.chart.is3d()&&\"colorAxis\"!==this.coll&&a.point&&(a.point.crosshairPos=this.isXAxis?a.point.plotXold||a.point.plotX:this.len-(a.point.plotYold||a.point.plotY))});\r\nt(g,\"destroy\",function(){n([\"backFrame\",\"bottomFrame\",\"sideFrame\"],function(a){this[a]&&(this[a]=this[a].destroy())},this)});g.prototype.swapZ=function(a,b){return this.isZAxis?(b=b?0:this.chart.plotLeft,{x:b+a.z,y:a.y,z:a.x-b}):a};y=b.ZAxis=function(){this.init.apply(this,arguments)};r(y.prototype,g.prototype);r(y.prototype,{isZAxis:!0,setOptions:function(a){a=x({offset:0,lineWidth:0},a);g.prototype.setOptions.call(this,a);this.coll=\"zAxis\"},setAxisSize:function(){g.prototype.setAxisSize.call(this);\r\nthis.width=this.len=this.chart.options.chart.options3d.depth;this.right=this.chart.chartWidth-this.width-this.left},getSeriesExtremes:function(){var a=this,b=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=a.ignoreMinPadding=a.ignoreMaxPadding=null;a.buildStacks&&a.buildStacks();n(a.series,function(c){if(c.visible||!b.options.chart.ignoreHiddenSeries)a.hasVisibleSeries=!0,c=c.zData,c.length&&(a.dataMin=Math.min(f(a.dataMin,c[0]),Math.min.apply(null,c)),a.dataMax=Math.max(f(a.dataMax,c[0]),Math.max.apply(null,\r\nc)))})}});t(A,\"afterGetAxes\",function(){var a=this,b=this.options,b=b.zAxis=d(b.zAxis||{});a.is3d()&&(this.zAxis=[],n(b,function(b,c){b.index=c;b.isX=!0;(new y(a,b)).setScale()}))})})(B);(function(b){var p=b.addEvent,y=b.perspective,t=b.pick;p(b.Series,\"afterTranslate\",function(){this.chart.is3d()&&this.translate3dPoints()});b.Series.prototype.translate3dPoints=function(){var b=this.chart,p=t(this.zAxis,b.options.zAxis[0]),z=[],n,r,x;for(x=0;x<this.data.length;x++)n=this.data[x],p&&p.translate?(r=\r\np.isLog&&p.val2lin?p.val2lin(n.z):n.z,n.plotZ=p.translate(r),n.isInside=n.isInside?r>=p.min&&r<=p.max:!1):n.plotZ=0,z.push({x:t(n.plotXold,n.plotX),y:t(n.plotYold,n.plotY),z:t(n.plotZold,n.plotZ)});b=y(z,b,!0);for(x=0;x<this.data.length;x++)n=this.data[x],p=b[x],n.plotXold=n.plotX,n.plotYold=n.plotY,n.plotZold=n.plotZ,n.plotX=p.x,n.plotY=p.y,n.plotZ=p.z}})(B);(function(b){function p(b){var a=b.apply(this,[].slice.call(arguments,1));this.chart.is3d&&this.chart.is3d()&&(a.stroke=this.options.edgeColor||\r\na.fill,a[\"stroke-width\"]=A(this.options.edgeWidth,1));return a}var y=b.addEvent,t=b.each,g=b.perspective,A=b.pick,z=b.Series,n=b.seriesTypes,r=b.inArray,x=b.svg,q=b.wrap;q(n.column.prototype,\"translate\",function(b){b.apply(this,[].slice.call(arguments,1));this.chart.is3d()&&this.translate3dShapes()});q(b.Series.prototype,\"alignDataLabel\",function(b){arguments[3].outside3dPlot=arguments[1].outside3dPlot;b.apply(this,[].slice.call(arguments,1))});q(b.Series.prototype,\"justifyDataLabel\",function(b){return arguments[2].outside3dPlot?\r\n!1:b.apply(this,[].slice.call(arguments,1))});n.column.prototype.translate3dPoints=function(){};n.column.prototype.translate3dShapes=function(){var b=this,a=b.chart,d=b.options,h=d.depth||25,k=(d.stacking?d.stack||0:b.index)*(h+(d.groupZPadding||1)),e=b.borderWidth%2?.5:0;a.inverted&&!b.yAxis.reversed&&(e*=-1);!1!==d.grouping&&(k=0);k+=d.groupZPadding||1;t(b.data,function(c){c.outside3dPlot=null;if(null!==c.y){var d=c.shapeArgs,f=c.tooltipPos,n;t([[\"x\",\"width\"],[\"y\",\"height\"]],function(a){n=d[a[0]]-\r\ne;0>n&&(d[a[1]]+=d[a[0]]+e,d[a[0]]=-e,n=0);n+d[a[1]]>b[a[0]+\"Axis\"].len&&0!==d[a[1]]&&(d[a[1]]=b[a[0]+\"Axis\"].len-d[a[0]]);if(0!==d[a[1]]&&(d[a[0]]>=b[a[0]+\"Axis\"].len||d[a[0]]+d[a[1]]<=e)){for(var f in d)d[f]=0;c.outside3dPlot=!0}});c.shapeType=\"cuboid\";d.z=k;d.depth=h;d.insidePlotArea=!0;f=g([{x:f[0],y:f[1],z:k}],a,!0)[0];c.tooltipPos=[f.x,f.y]}});b.z=k};q(n.column.prototype,\"animate\",function(b){if(this.chart.is3d()){var a=arguments[1],d=this.yAxis,f=this,k=this.yAxis.reversed;x&&(a?t(f.data,function(a){null!==\r\na.y&&(a.height=a.shapeArgs.height,a.shapey=a.shapeArgs.y,a.shapeArgs.height=1,k||(a.shapeArgs.y=a.stackY?a.plotY+d.translate(a.stackY):a.plotY+(a.negative?-a.height:a.height)))}):(t(f.data,function(a){null!==a.y&&(a.shapeArgs.height=a.height,a.shapeArgs.y=a.shapey,a.graphic&&a.graphic.animate(a.shapeArgs,f.options.animation))}),this.drawDataLabels(),f.animate=null))}else b.apply(this,[].slice.call(arguments,1))});q(n.column.prototype,\"plotGroup\",function(b,a,d,h,k,e){this.chart.is3d()&&e&&!this[a]&&\r\n(this.chart.columnGroup||(this.chart.columnGroup=this.chart.renderer.g(\"columnGroup\").add(e)),this[a]=this.chart.columnGroup,this.chart.columnGroup.attr(this.getPlotBox()),this[a].survive=!0);return b.apply(this,Array.prototype.slice.call(arguments,1))});q(n.column.prototype,\"setVisible\",function(b,a){var d=this,f;d.chart.is3d()&&t(d.data,function(b){f=(b.visible=b.options.visible=a=void 0===a?!b.visible:a)?\"visible\":\"hidden\";d.options.data[r(b,d.data)]=b.options;b.graphic&&b.graphic.attr({visibility:f})});\r\nb.apply(this,Array.prototype.slice.call(arguments,1))});n.column.prototype.handle3dGrouping=!0;y(z,\"afterInit\",function(){if(this.chart.is3d()&&this.handle3dGrouping){var b=this.options,a=b.grouping,d=b.stacking,h=A(this.yAxis.options.reversedStacks,!0),k=0;if(void 0===a||a){a=this.chart.retrieveStacks(d);k=b.stack||0;for(d=0;d<a[k].series.length&&a[k].series[d]!==this;d++);k=10*(a.totalStacks-a[k].position)+(h?d:-d);this.xAxis.reversed||(k=10*a.totalStacks-k)}b.zIndex=k}});q(n.column.prototype,\"pointAttribs\",\r\np);n.columnrange&&(q(n.columnrange.prototype,\"pointAttribs\",p),n.columnrange.prototype.plotGroup=n.column.prototype.plotGroup,n.columnrange.prototype.setVisible=n.column.prototype.setVisible);q(z.prototype,\"alignDataLabel\",function(b){if(this.chart.is3d()&&(\"column\"===this.type||\"columnrange\"===this.type)){var a=arguments,d=a[4],a=a[1],f={x:d.x,y:d.y,z:this.z},f=g([f],this.chart,!0)[0];d.x=f.x;d.y=a.outside3dPlot?-9E9:f.y}b.apply(this,[].slice.call(arguments,1))});q(b.StackItem.prototype,\"getStackBox\",\r\nfunction(f,a){var d=f.apply(this,[].slice.call(arguments,1));if(a.is3d()){var h={x:d.x,y:d.y,z:0},h=b.perspective([h],a,!0)[0];d.x=h.x;d.y=h.y}return d})})(B);(function(b){var p=b.deg2rad,y=b.each,t=b.pick,g=b.seriesTypes,A=b.svg;b=b.wrap;b(g.pie.prototype,\"translate\",function(b){b.apply(this,[].slice.call(arguments,1));if(this.chart.is3d()){var g=this,r=g.options,t=r.depth||0,q=g.chart.options.chart.options3d,f=q.alpha,a=q.beta,d=r.stacking?(r.stack||0)*t:g._i*t,d=d+t/2;!1!==r.grouping&&(d=0);y(g.data,\r\nfunction(b){var h=b.shapeArgs;b.shapeType=\"arc3d\";h.z=d;h.depth=.75*t;h.alpha=f;h.beta=a;h.center=g.center;h=(h.end+h.start)/2;b.slicedTranslation={translateX:Math.round(Math.cos(h)*r.slicedOffset*Math.cos(f*p)),translateY:Math.round(Math.sin(h)*r.slicedOffset*Math.cos(f*p))}})}});b(g.pie.prototype.pointClass.prototype,\"haloPath\",function(b){var g=arguments;return this.series.chart.is3d()?[]:b.call(this,g[1])});b(g.pie.prototype,\"pointAttribs\",function(b,g,r){b=b.call(this,g,r);r=this.options;this.chart.is3d()&&\r\n(b.stroke=r.edgeColor||g.color||this.color,b[\"stroke-width\"]=t(r.edgeWidth,1));return b});b(g.pie.prototype,\"drawPoints\",function(b){b.apply(this,[].slice.call(arguments,1));this.chart.is3d()&&y(this.points,function(b){var g=b.graphic;if(g)g[b.y&&b.visible?\"show\":\"hide\"]()})});b(g.pie.prototype,\"drawDataLabels\",function(b){if(this.chart.is3d()){var g=this.chart.options.chart.options3d;y(this.data,function(b){var n=b.shapeArgs,q=n.r,f=(n.start+n.end)/2,a=b.labelPos,d=-q*(1-Math.cos((n.alpha||g.alpha)*\r\np))*Math.sin(f),h=q*(Math.cos((n.beta||g.beta)*p)-1)*Math.cos(f);y([0,2,4],function(b){a[b]+=h;a[b+1]+=d})})}b.apply(this,[].slice.call(arguments,1))});b(g.pie.prototype,\"addPoint\",function(b){b.apply(this,[].slice.call(arguments,1));this.chart.is3d()&&this.update(this.userOptions,!0)});b(g.pie.prototype,\"animate\",function(b){if(this.chart.is3d()){var g=arguments[1],r=this.options.animation,p=this.center,q=this.group,f=this.markerGroup;A&&(!0===r&&(r={}),g?(q.oldtranslateX=q.translateX,q.oldtranslateY=\r\nq.translateY,g={translateX:p[0],translateY:p[1],scaleX:.001,scaleY:.001},q.attr(g),f&&(f.attrSetters=q.attrSetters,f.attr(g))):(g={translateX:q.oldtranslateX,translateY:q.oldtranslateY,scaleX:1,scaleY:1},q.animate(g,r),f&&f.animate(g,r),this.animate=null))}else b.apply(this,[].slice.call(arguments,1))})})(B);(function(b){var p=b.Point,y=b.seriesType,t=b.seriesTypes;y(\"scatter3d\",\"scatter\",{tooltip:{pointFormat:\"x: \\x3cb\\x3e{point.x}\\x3c/b\\x3e\\x3cbr/\\x3ey: \\x3cb\\x3e{point.y}\\x3c/b\\x3e\\x3cbr/\\x3ez: \\x3cb\\x3e{point.z}\\x3c/b\\x3e\\x3cbr/\\x3e\"}},\r\n{pointAttribs:function(g){var p=t.scatter.prototype.pointAttribs.apply(this,arguments);this.chart.is3d()&&g&&(p.zIndex=b.pointCameraDistance(g,this.chart));return p},axisTypes:[\"xAxis\",\"yAxis\",\"zAxis\"],pointArrayMap:[\"x\",\"y\",\"z\"],parallelArrays:[\"x\",\"y\",\"z\"],directTouch:!0},{applyOptions:function(){p.prototype.applyOptions.apply(this,arguments);void 0===this.z&&(this.z=0);return this}})})(B);(function(b){var p=b.addEvent,y=b.Axis,t=b.SVGRenderer,g=b.VMLRenderer;g&&(b.setOptions({animate:!1}),g.prototype.face3d=\r\nt.prototype.face3d,g.prototype.polyhedron=t.prototype.polyhedron,g.prototype.cuboid=t.prototype.cuboid,g.prototype.cuboidPath=t.prototype.cuboidPath,g.prototype.toLinePath=t.prototype.toLinePath,g.prototype.toLineSegments=t.prototype.toLineSegments,g.prototype.createElement3D=t.prototype.createElement3D,g.prototype.arc3d=function(b){b=t.prototype.arc3d.call(this,b);b.css({zIndex:b.zIndex});return b},b.VMLRenderer.prototype.arc3dPath=b.SVGRenderer.prototype.arc3dPath,p(y,\"render\",function(){this.sideFrame&&\r\n(this.sideFrame.css({zIndex:0}),this.sideFrame.front.attr({fill:this.sideFrame.color}));this.bottomFrame&&(this.bottomFrame.css({zIndex:1}),this.bottomFrame.front.attr({fill:this.bottomFrame.color}));this.backFrame&&(this.backFrame.css({zIndex:0}),this.backFrame.front.attr({fill:this.backFrame.color}))}))})(B)});\r\n","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n\r\n (c) 2016 Highsoft AS\r\n Authors: Jon Arild Nygard\r\n\r\n License: www.highcharts.com/license\r\n*/\r\n(function(D){\"object\"===typeof module&&module.exports?module.exports=D:D(Highcharts)})(function(D){var N=function(){return function(a){var y=this,r=y.graphic,m=a.animate,z=a.attr,t=a.onComplete,E=a.css,x=a.group,g=a.renderer,I=a.shapeArgs;a=a.shapeType;y.shouldDraw()?(r||(y.graphic=r=g[a](I).add(x)),r.css(E).attr(z).animate(m,void 0,t)):r&&r.animate(m,void 0,function(){y.graphic=r=r.destroy();\"function\"===typeof t&&t()});r&&r.addClass(y.getClassName(),!0)}}(),L=function(a){var y=a.each,r=a.extend,\r\nm=a.isArray,z=a.isObject,t=a.isNumber,E=a.merge,x=a.pick,g=a.reduce;return{getColor:function(a,h){var u=h.mapOptionsToLevel,r=h.parentColorIndex,A=h.series,f=h.colors,B=A.points,g,I;a&&(B=B[a.i],u=u[a.level]||{},(a=B&&u.colorByPoint)&&(g=B.index%(f?f.length:A.chart.options.chart.colorCount)),I=x(B&&B.options.colorIndex,u&&u.colorIndex,g,r,h.colorIndex));return{color:void 0,colorIndex:I}},getLevelOptions:function(a){var h=null,u,G,A,f;if(z(a))for(h={},A=t(a.from)?a.from:1,f=a.levels,G={},u=z(a.defaults)?\r\na.defaults:{},m(f)&&(G=g(f,function(a,f){var g,h;z(f)&&t(f.level)&&(h=E({},f),g=\"boolean\"===typeof h.levelIsConstant?h.levelIsConstant:u.levelIsConstant,delete h.levelIsConstant,delete h.level,f=f.level+(g?0:A-1),z(a[f])?r(a[f],h):a[f]=h);return a},{})),f=t(a.to)?a.to:1,a=0;a<=f;a++)h[a]=E({},u,z(G[a])?G[a]:{});return h},setTreeValues:function h(a,g){var u=g.before,f=g.idRoot,t=g.mapIdToNode[f],m=g.points[a.i],z=m&&m.options||{},F=0,E=[];r(a,{levelDynamic:a.level-((\"boolean\"===typeof g.levelIsConstant?\r\ng.levelIsConstant:1)?0:t.level),name:x(m&&m.name,\"\"),visible:f===a.id||(\"boolean\"===typeof g.visible?g.visible:!1)});\"function\"===typeof u&&(a=u(a,g));y(a.children,function(f,b){var c=r({},g);r(c,{index:b,siblings:a.children.length,visible:a.visible});f=h(f,c);E.push(f);f.visible&&(F+=f.val)});a.visible=0<F||a.visible;u=x(z.value,F);r(a,{children:E,childrenTotal:F,isLeaf:a.visible&&!F,val:u});return a},updateRootId:function(a){var g;z(a)&&(g=z(a.options)?a.options:{},g=x(a.rootNode,g.rootId,\"\"),z(a.userOptions)&&\r\n(a.userOptions.rootId=g),a.rootNode=g);return g}}}(D);(function(a,y){var r=a.seriesType,m=a.seriesTypes,z=a.map,t=a.merge,E=a.extend,x=a.noop,g=a.each,I=y.getColor,h=y.getLevelOptions,u=a.grep,G=a.isNumber,A=a.isString,f=a.pick,B=a.Series,D=a.stableSort,J=function(b,c,e){e=e||this;a.objectEach(b,function(a,d){c.call(e,a,d,b)})},F=a.reduce,K=function(b,c,e){e=e||this;b=c.call(e,b);!1!==b&&K(b,c,e)},M=y.updateRootId;r(\"treemap\",\"scatter\",{showInLegend:!1,marker:!1,colorByPoint:!1,dataLabels:{enabled:!0,\r\ndefer:!1,verticalAlign:\"middle\",formatter:function(){return this.point.name||this.point.id},inside:!0},tooltip:{headerFormat:\"\",pointFormat:\"\\x3cb\\x3e{point.name}\\x3c/b\\x3e: {point.value}\\x3cbr/\\x3e\"},ignoreHiddenPoint:!0,layoutAlgorithm:\"sliceAndDice\",layoutStartingDirection:\"vertical\",alternateStartingDirection:!1,levelIsConstant:!0,drillUpButton:{position:{align:\"right\",x:-10,y:10}}},{pointArrayMap:[\"value\"],axisTypes:m.heatmap?[\"xAxis\",\"yAxis\",\"colorAxis\"]:[\"xAxis\",\"yAxis\"],directTouch:!0,optionalAxis:\"colorAxis\",\r\ngetSymbol:x,parallelArrays:[\"x\",\"y\",\"value\",\"colorValue\"],colorKey:\"colorValue\",translateColors:m.heatmap&&m.heatmap.prototype.translateColors,colorAttribs:m.heatmap&&m.heatmap.prototype.colorAttribs,trackerGroups:[\"group\",\"dataLabelsGroup\"],getListOfParents:function(b,c){b=F(b||[],function(b,c,d){c=f(c.parent,\"\");void 0===b[c]&&(b[c]=[]);b[c].push(d);return b},{});J(b,function(b,v,d){\"\"!==v&&-1===a.inArray(v,c)&&(g(b,function(b){d[\"\"].push(b)}),delete d[v])});return b},getTree:function(){var b=z(this.data,\r\nfunction(b){return b.id}),b=this.getListOfParents(this.data,b);this.nodeMap=[];return this.buildNode(\"\",-1,0,b,null)},init:function(b,c){B.prototype.init.call(this,b,c);this.options.allowDrillToNode&&a.addEvent(this,\"click\",this.onClickDrillToNode)},buildNode:function(b,c,e,a,d){var n=this,k=[],l=n.points[c],v=0,w;g(a[b]||[],function(d){w=n.buildNode(n.points[d].id,d,e+1,a,b);v=Math.max(w.height+1,v);k.push(w)});c={id:b,i:c,children:k,height:v,level:e,parent:d,visible:!1};n.nodeMap[c.id]=c;l&&(l.node=\r\nc);return c},setTreeValues:function(b){var c=this,e=c.options,a=c.nodeMap[c.rootNode],e=\"boolean\"===typeof e.levelIsConstant?e.levelIsConstant:!0,d=0,n=[],k,l=c.points[b.i];g(b.children,function(b){b=c.setTreeValues(b);n.push(b);b.ignore||(d+=b.val)});D(n,function(b,d){return b.sortIndex-d.sortIndex});k=f(l&&l.options.value,d);l&&(l.value=k);E(b,{children:n,childrenTotal:d,ignore:!(f(l&&l.visible,!0)&&0<k),isLeaf:b.visible&&!d,levelDynamic:b.level-(e?0:a.level),name:f(l&&l.name,\"\"),sortIndex:f(l&&\r\nl.sortIndex,-k),val:k});return b},calculateChildrenAreas:function(b,c){var a=this,v=a.options,d=a.mapOptionsToLevel[b.level+1],n=f(a[d&&d.layoutAlgorithm]&&d.layoutAlgorithm,v.layoutAlgorithm),k=v.alternateStartingDirection,l=[];b=u(b.children,function(b){return!b.ignore});d&&d.layoutStartingDirection&&(c.direction=\"vertical\"===d.layoutStartingDirection?0:1);l=a[n](c,b);g(b,function(b,d){d=l[d];b.values=t(d,{val:b.childrenTotal,direction:k?1-c.direction:c.direction});b.pointValues=t(d,{x:d.x/a.axisRatio,\r\nwidth:d.width/a.axisRatio});b.children.length&&a.calculateChildrenAreas(b,b.values)})},setPointValues:function(){var b=this.xAxis,a=this.yAxis;g(this.points,function(c){var e=c.node,d=e.pointValues,n,k;d&&e.visible?(e=Math.round(b.translate(d.x,0,0,0,1))-0,n=Math.round(b.translate(d.x+d.width,0,0,0,1))-0,k=Math.round(a.translate(d.y,0,0,0,1))-0,d=Math.round(a.translate(d.y+d.height,0,0,0,1))-0,c.shapeType=\"rect\",c.shapeArgs={x:Math.min(e,n),y:Math.min(k,d),width:Math.abs(n-e),height:Math.abs(d-k)},\r\nc.plotX=c.shapeArgs.x+c.shapeArgs.width/2,c.plotY=c.shapeArgs.y+c.shapeArgs.height/2):(delete c.plotX,delete c.plotY)})},setColorRecursive:function(b,c,a,v,d){var e=this,k=e&&e.chart,k=k&&k.options&&k.options.colors,l;if(b){l=I(b,{colors:k,index:v,mapOptionsToLevel:e.mapOptionsToLevel,parentColor:c,parentColorIndex:a,series:e,siblings:d});if(c=e.points[b.i])c.color=l.color,c.colorIndex=l.colorIndex;g(b.children||[],function(d,c){e.setColorRecursive(d,l.color,l.colorIndex,c,b.children.length)})}},\r\nalgorithmGroup:function(b,c,a,v){this.height=b;this.width=c;this.plot=v;this.startDirection=this.direction=a;this.lH=this.nH=this.lW=this.nW=this.total=0;this.elArr=[];this.lP={total:0,lH:0,nH:0,lW:0,nW:0,nR:0,lR:0,aspectRatio:function(b,c){return Math.max(b/c,c/b)}};this.addElement=function(b){this.lP.total=this.elArr[this.elArr.length-1];this.total+=b;0===this.direction?(this.lW=this.nW,this.lP.lH=this.lP.total/this.lW,this.lP.lR=this.lP.aspectRatio(this.lW,this.lP.lH),this.nW=this.total/this.height,\r\nthis.lP.nH=this.lP.total/this.nW,this.lP.nR=this.lP.aspectRatio(this.nW,this.lP.nH)):(this.lH=this.nH,this.lP.lW=this.lP.total/this.lH,this.lP.lR=this.lP.aspectRatio(this.lP.lW,this.lH),this.nH=this.total/this.width,this.lP.nW=this.lP.total/this.nH,this.lP.nR=this.lP.aspectRatio(this.lP.nW,this.nH));this.elArr.push(b)};this.reset=function(){this.lW=this.nW=0;this.elArr=[];this.total=0}},algorithmCalcPoints:function(b,c,a,v){var d,n,e,l,f=a.lW,w=a.lH,p=a.plot,H,q=0,C=a.elArr.length-1;c?(f=a.nW,w=a.nH):\r\nH=a.elArr[a.elArr.length-1];g(a.elArr,function(b){if(c||q<C)0===a.direction?(d=p.x,n=p.y,e=f,l=b/e):(d=p.x,n=p.y,l=w,e=b/l),v.push({x:d,y:n,width:e,height:l}),0===a.direction?p.y+=l:p.x+=e;q+=1});a.reset();0===a.direction?a.width-=f:a.height-=w;p.y=p.parent.y+(p.parent.height-a.height);p.x=p.parent.x+(p.parent.width-a.width);b&&(a.direction=1-a.direction);c||a.addElement(H)},algorithmLowAspectRatio:function(b,a,e){var c=[],d=this,n,k={x:a.x,y:a.y,parent:a},l=0,f=e.length-1,w=new this.algorithmGroup(a.height,\r\na.width,a.direction,k);g(e,function(e){n=e.val/a.val*a.height*a.width;w.addElement(n);w.lP.nR>w.lP.lR&&d.algorithmCalcPoints(b,!1,w,c,k);l===f&&d.algorithmCalcPoints(b,!0,w,c,k);l+=1});return c},algorithmFill:function(b,a,e){var c=[],d,n=a.direction,k=a.x,l=a.y,f=a.width,w=a.height,p,H,q,C;g(e,function(e){d=e.val/a.val*a.height*a.width;p=k;H=l;0===n?(C=w,q=d/C,f-=q,k+=q):(q=f,C=d/q,w-=C,l+=C);c.push({x:p,y:H,width:q,height:C});b&&(n=1-n)});return c},strip:function(b,a){return this.algorithmLowAspectRatio(!1,\r\nb,a)},squarified:function(b,a){return this.algorithmLowAspectRatio(!0,b,a)},sliceAndDice:function(b,a){return this.algorithmFill(!0,b,a)},stripes:function(b,a){return this.algorithmFill(!1,b,a)},translate:function(){var b=this,a=b.options,e=M(b),f,d;B.prototype.translate.call(b);d=b.tree=b.getTree();f=b.nodeMap[e];b.mapOptionsToLevel=h({from:f.level+1,levels:a.levels,to:d.height,defaults:{levelIsConstant:b.options.levelIsConstant,colorByPoint:a.colorByPoint}});\"\"===e||f&&f.children.length||(b.drillToNode(\"\",\r\n!1),e=b.rootNode,f=b.nodeMap[e]);K(b.nodeMap[b.rootNode],function(a){var d=!1,c=a.parent;a.visible=!0;if(c||\"\"===c)d=b.nodeMap[c];return d});K(b.nodeMap[b.rootNode].children,function(b){var a=!1;g(b,function(b){b.visible=!0;b.children.length&&(a=(a||[]).concat(b.children))});return a});b.setTreeValues(d);b.axisRatio=b.xAxis.len/b.yAxis.len;b.nodeMap[\"\"].pointValues=e={x:0,y:0,width:100,height:100};b.nodeMap[\"\"].values=e=t(e,{width:e.width*b.axisRatio,direction:\"vertical\"===a.layoutStartingDirection?\r\n0:1,val:d.val});b.calculateChildrenAreas(d,e);b.colorAxis?b.translateColors():a.colorByPoint||b.setColorRecursive(b.tree);a.allowDrillToNode&&(a=f.pointValues,b.xAxis.setExtremes(a.x,a.x+a.width,!1),b.yAxis.setExtremes(a.y,a.y+a.height,!1),b.xAxis.setScale(),b.yAxis.setScale());b.setPointValues()},drawDataLabels:function(){var b=this,a=b.mapOptionsToLevel,e=u(b.points,function(b){return b.node.visible}),f,d;g(e,function(c){d=a[c.node.level];f={style:{}};c.node.isLeaf||(f.enabled=!1);d&&d.dataLabels&&\r\n(f=t(f,d.dataLabels),b._hasPointLabels=!0);c.shapeArgs&&(f.style.width=c.shapeArgs.width,c.dataLabel&&c.dataLabel.css({width:c.shapeArgs.width+\"px\"}));c.dlOptions=t(f,c.options.dataLabels)});B.prototype.drawDataLabels.call(this)},alignDataLabel:function(b){m.column.prototype.alignDataLabel.apply(this,arguments);b.dataLabel&&b.dataLabel.attr({zIndex:(b.node.zIndex||0)+1})},drawPoints:function(){var b=this,a=u(b.points,function(b){return b.node.visible});g(a,function(a){var c=\"level-group-\"+a.node.levelDynamic;\r\nb[c]||(b[c]=b.chart.renderer.g(c).attr({zIndex:1E3-a.node.levelDynamic}).add(b.group));a.group=b[c]});m.column.prototype.drawPoints.call(this);this.colorAttribs&&g(this.points,function(b){b.graphic&&b.graphic.css(this.colorAttribs(b))},this);b.options.allowDrillToNode&&g(a,function(a){a.graphic&&(a.drillId=b.options.interactByLeaf?b.drillToByLeaf(a):b.drillToByGroup(a))})},onClickDrillToNode:function(b){var a=(b=b.point)&&b.drillId;A(a)&&(b.setState(\"\"),this.drillToNode(a))},drillToByGroup:function(a){var b=\r\n!1;1!==a.node.level-this.nodeMap[this.rootNode].level||a.node.isLeaf||(b=a.id);return b},drillToByLeaf:function(a){var b=!1;if(a.node.parent!==this.rootNode&&a.node.isLeaf)for(a=a.node;!b;)a=this.nodeMap[a.parent],a.parent===this.rootNode&&(b=a.id);return b},drillUp:function(){var a=this.nodeMap[this.rootNode];a&&A(a.parent)&&this.drillToNode(a.parent)},drillToNode:function(a,c){var b=this.nodeMap[a];this.idPreviousRoot=this.rootNode;this.rootNode=a;\"\"===a?this.drillUpButton=this.drillUpButton.destroy():\r\nthis.showDrillUpButton(b&&b.name||a);this.isDirty=!0;f(c,!0)&&this.chart.redraw()},showDrillUpButton:function(a){var b=this;a=a||\"\\x3c Back\";var e=b.options.drillUpButton,f,d;e.text&&(a=e.text);this.drillUpButton?(this.drillUpButton.placed=!1,this.drillUpButton.attr({text:a}).align()):(d=(f=e.theme)&&f.states,this.drillUpButton=this.chart.renderer.button(a,null,null,function(){b.drillUp()},f,d&&d.hover,d&&d.select).addClass(\"highcharts-drillup-button\").attr({align:e.position.align,zIndex:7}).add().align(e.position,\r\n!1,e.relativeTo||\"plotBox\"))},buildKDTree:x,drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,getExtremes:function(){B.prototype.getExtremes.call(this,this.colorValueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;B.prototype.getExtremes.call(this)},getExtremesFromAll:!0,bindAxes:function(){var b={endOnTick:!1,gridLineWidth:0,lineWidth:0,min:0,dataMin:0,minPadding:0,max:100,dataMax:100,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};B.prototype.bindAxes.call(this);a.extend(this.yAxis.options,\r\nb);a.extend(this.xAxis.options,b)},utils:{recursive:K,reduce:F}},{getClassName:function(){var b=a.Point.prototype.getClassName.call(this),c=this.series,e=c.options;this.node.level<=c.nodeMap[c.rootNode].level?b+=\" highcharts-above-level\":this.node.isLeaf||f(e.interactByLeaf,!e.allowDrillToNode)?this.node.isLeaf||(b+=\" highcharts-internal-node\"):b+=\" highcharts-internal-node-interactive\";return b},isValid:function(){return this.id||G(this.value)},setState:function(b){a.Point.prototype.setState.call(this,\r\nb);this.graphic&&this.graphic.attr({zIndex:\"hover\"===b?1:0})},setVisible:m.pie.prototype.pointClass.prototype.setVisible})})(D,L);(function(a,y,r){var m=a.CenteredSeriesMixin,z=a.Series,t=a.each,E=a.extend,x=m.getCenter,g=r.getColor,D=r.getLevelOptions,h=m.getStartAndEndRadians,u=a.grep,G=a.inArray,A=a.isNumber,f=a.isObject,B=a.isString,L=a.keys,J=a.merge,F=180/Math.PI,m=a.seriesType,K=r.setTreeValues,M=a.reduce,b=r.updateRootId,c=function(a,b){var d=[];if(A(a)&&A(b)&&a<=b)for(;a<=b;a++)d.push(a);\r\nreturn d},e=function(a,b){var d;b=f(b)?b:{};var e=0,n,w,p,g;f(a)&&(d=J({},a),a=A(b.from)?b.from:0,g=A(b.to)?b.to:0,w=c(a,g),a=u(L(d),function(a){return-1===G(+a,w)}),n=p=A(b.diffRadius)?b.diffRadius:0,t(w,function(a){a=d[a];var b=a.levelSize.unit,c=a.levelSize.value;\"weight\"===b?e+=c:\"percentage\"===b?(a.levelSize={unit:\"pixels\",value:c/100*n},p-=a.levelSize.value):\"pixels\"===b&&(p-=c)}),t(w,function(a){var b=d[a];\"weight\"===b.levelSize.unit&&(b=b.levelSize.value,d[a].levelSize={unit:\"pixels\",value:b/\r\ne*p})}),t(a,function(a){d[a].levelSize={value:0,unit:\"pixels\"}}));return d},v=function(a,b){var d=b.mapIdToNode[a.parent],c=b.series,e=c.chart,f=c.points[a.i],d=g(a,{colors:e&&e.options&&e.options.colors,colorIndex:c.colorIndex,index:b.index,mapOptionsToLevel:b.mapOptionsToLevel,parentColor:d&&d.color,parentColorIndex:d&&d.colorIndex,series:b.series,siblings:b.siblings});a.color=d.color;a.colorIndex=d.colorIndex;f&&(f.color=a.color,f.colorIndex=a.colorIndex,a.sliced=a.id!==b.idRoot?f.sliced:!1);return a};\r\nm(\"sunburst\",\"treemap\",{center:[\"50%\",\"50%\"],colorByPoint:!1,dataLabels:{defer:!0,style:{textOverflow:\"ellipsis\"},rotationMode:\"perpendicular\"},rootId:void 0,levelIsConstant:!0,levelSize:{value:1,unit:\"weight\"},slicedOffset:10},{drawDataLabels:a.noop,drawPoints:function(){var a=this,b=a.mapOptionsToLevel,c=a.shapeRoot,e=a.group,g=a.hasRendered,w=a.rootId,p=a.idPreviousRoot,H=a.nodeMap,q=H[p],r=q&&q.shapeArgs,q=a.points,m=a.startAndEndRadians,h=a.chart,h=h&&h.options&&h.options.chart||{},u=\"boolean\"===\r\ntypeof h.animation?h.animation:!0,v=a.center[3]/2,B=a.chart.renderer,y,x=!1,D=!1;if(h=!!(u&&g&&w!==p&&a.dataLabelsGroup))a.dataLabelsGroup.attr({opacity:0}),y=function(){x=!0;a.dataLabelsGroup&&a.dataLabelsGroup.animate({opacity:1,visibility:\"visible\"})};t(q,function(d){var l,n,k=d.node,q=b[k.level];l=d.shapeExisting||{};var h=k.shapeArgs||{},t,z=!(!k.visible||!k.shapeArgs);if(g&&u){var C={};n={end:h.end,start:h.start,innerR:h.innerR,r:h.r,x:h.x,y:h.y};z?!d.graphic&&r&&(C=w===d.id?{start:m.start,\r\nend:m.end}:r.end<=h.start?{start:m.end,end:m.end}:{start:m.start,end:m.start},C.innerR=C.r=v):d.graphic&&(p===d.id?n={innerR:v,r:v}:c&&(n=c.end<=l.start?{innerR:v,r:v,start:m.end,end:m.end}:{innerR:v,r:v,start:m.start,end:m.start}));l=C}else n=h,l={};var C=[h.plotX,h.plotY],x;d.node.isLeaf||(w===d.id?(x=H[w],x=x.parent):x=d.id);E(d,{shapeExisting:h,tooltipPos:C,drillId:x,name:\"\"+(d.name||d.id||d.index),plotX:h.plotX,plotY:h.plotY,value:k.val,isNull:!z});x=d.options;k=f(h)?h:{};x=f(x)?x.dataLabels:\r\n{};q=f(q)?q.dataLabels:{};q=J({rotationMode:\"perpendicular\",style:{width:k.radius}},q,x);A(q.rotation)||(k=k.end-(k.end-k.start)/2,k=k*F%180,\"parallel\"===q.rotationMode&&(k-=90),90<k&&(k-=180),q.rotation=k);0===q.rotation&&(q.rotation=.001);d.dlOptions=q;!D&&z&&(D=!0,t=y);d.draw({animate:n,attr:E(l,a.pointAttribs&&a.pointAttribs(d,d.selected&&\"select\")),onComplete:t,group:e,renderer:B,shapeType:\"arc\",shapeArgs:h})});h&&D?(a.hasRendered=!1,a.options.dataLabels.defer=!0,z.prototype.drawDataLabels.call(a),\r\na.hasRendered=!0,x&&y()):z.prototype.drawDataLabels.call(a)},layoutAlgorithm:function(a,b,c){var d=a.start,e=a.end-d,k=a.val,p=a.x,g=a.y,h=f(c.levelSize)&&A(c.levelSize.value)?c.levelSize.value:0,n=a.r,m=n+h,r=A(c.slicedOffset)?c.slicedOffset:0;return M(b||[],function(a,b){var c=1/k*b.val*e,f=d+c/2,l=p+Math.cos(f)*r,f=g+Math.sin(f)*r;b={x:b.sliced?l:p,y:b.sliced?f:g,innerR:n,r:m,radius:h,start:d,end:d+c};a.push(b);d=b.end;return a},[])},setShapeArgs:function(a,b,c){var d=[],e=c[a.level+1];a=u(a.children,\r\nfunction(a){return a.visible});d=this.layoutAlgorithm(b,a,e);t(a,function(a,b){b=d[b];var e=b.start+(b.end-b.start)/2,f=b.innerR+(b.r-b.innerR)/2,g=b.end-b.start,e=0===b.innerR&&6.28<g?{x:b.x,y:b.y}:{x:b.x+Math.cos(e)*f,y:b.y+Math.sin(e)*f},f=a.val?a.childrenTotal>a.val?a.childrenTotal:a.val:a.childrenTotal;this.points[a.i]&&(this.points[a.i].innerArcLength=g*b.innerR,this.points[a.i].outerArcLength=g*b.r);a.shapeArgs=J(b,{plotX:e.x,plotY:e.y});a.values=J(b,{val:f});a.children.length&&this.setShapeArgs(a,\r\na.values,c)},this)},translate:function(){var a=this.options,c=this.center=x.call(this),f=this.startAndEndRadians=h(a.startAngle,a.endAngle),g=c[3]/2,m=c[2]/2-g,r=b(this),p=this.nodeMap,t,q=p&&p[r],u,y;this.shapeRoot=q&&q.shapeArgs;z.prototype.translate.call(this);y=this.tree=this.getTree();p=this.nodeMap;q=p[r];t=B(q.parent)?q.parent:\"\";u=p[t];t=D({from:0<q.level?q.level:1,levels:this.options.levels,to:y.height,defaults:{colorByPoint:a.colorByPoint,dataLabels:a.dataLabels,levelIsConstant:a.levelIsConstant,\r\nlevelSize:a.levelSize,slicedOffset:a.slicedOffset}});t=e(t,{diffRadius:m,from:0<q.level?q.level:1,to:y.height});K(y,{before:v,idRoot:r,levelIsConstant:a.levelIsConstant,mapOptionsToLevel:t,mapIdToNode:p,points:this.points,series:this});a=p[\"\"].shapeArgs={end:f.end,r:g,start:f.start,val:q.val,x:c[0],y:c[1]};this.setShapeArgs(u,a,t);this.mapOptionsToLevel=t},animate:function(a){var b=this.chart,c=[b.plotWidth/2,b.plotHeight/2],d=b.plotLeft,e=b.plotTop,b=this.group;a?(a={translateX:c[0]+d,translateY:c[1]+\r\ne,scaleX:.001,scaleY:.001,rotation:10,opacity:.01},b.attr(a)):(a={translateX:d,translateY:e,scaleX:1,scaleY:1,rotation:0,opacity:1},b.animate(a,this.options.animation),this.animate=null)},utils:{calculateLevelSizes:e,range:c}},{draw:y,shouldDraw:function(){return!this.isNull}})})(D,N,L)});\r\n","/*\r\n Highcharts JS v6.1.0 (2018-04-13)\r\n X-range series\r\n\r\n (c) 2010-2017 Torstein Honsi, Lars A. V. Cabrera\r\n\r\n License: www.highcharts.com/license\r\n*/\r\n(function(g){\"object\"===typeof module&&module.exports?module.exports=g:g(Highcharts)})(function(g){(function(d){var g=d.addEvent,t=d.defined,q=d.seriesTypes.column,l=d.each,u=d.isNumber,r=d.isObject,m=d.merge,n=d.pick,v=d.seriesType,w=d.Axis,p=d.Point,x=d.Series;v(\"xrange\",\"column\",{colorByPoint:!0,dataLabels:{verticalAlign:\"middle\",inside:!0,formatter:function(){var a=this.point.partialFill;r(a)&&(a=a.amount);t(a)||(a=0);return 100*a+\"%\"}},tooltip:{headerFormat:'\\x3cspan style\\x3d\"font-size: 0.85em\"\\x3e{point.x} - {point.x2}\\x3c/span\\x3e\\x3cbr/\\x3e',\r\npointFormat:'\\x3cspan style\\x3d\"color:{point.color}\"\\x3e\\u25cf\\x3c/span\\x3e {series.name}: \\x3cb\\x3e{point.yCategory}\\x3c/b\\x3e\\x3cbr/\\x3e'},borderRadius:3,pointRange:0},{type:\"xrange\",parallelArrays:[\"x\",\"x2\",\"y\"],requireSorting:!1,animate:d.seriesTypes.line.prototype.animate,cropShoulder:1,getExtremesFromAll:!0,getColumnMetrics:function(){function a(){l(c.series,function(a){var b=a.xAxis;a.xAxis=a.yAxis;a.yAxis=b})}var b,c=this.chart;a();b=q.prototype.getColumnMetrics.call(this);a();return b},cropData:function(a,\r\nb,c,e){b=x.prototype.cropData.call(this,this.x2Data,b,c,e);b.xData=a.slice(b.start,b.end);return b},translatePoint:function(a){var b=this.xAxis,c=this.columnMetrics,e=this.options.minPointLength||0,d=a.plotX,k=n(a.x2,a.x+(a.len||0)),f=b.translate(k,0,0,0,1),k=f-d,h=this.chart.inverted,g=n(this.options.borderWidth,1)%2/2;e&&(e-=k,0>e&&(e=0),d-=e/2,f+=e/2);d=Math.max(d,-10);f=Math.min(Math.max(f,-10),b.len+10);a.shapeArgs={x:Math.floor(Math.min(d,f))+g,y:Math.floor(a.plotY+c.offset)+g,width:Math.round(Math.abs(f-\r\nd)),height:Math.round(c.width),r:this.options.borderRadius};e=a.shapeArgs.x;f=e+a.shapeArgs.width;0>e||f>b.len?(e=Math.min(b.len,Math.max(0,e)),f=Math.max(0,Math.min(f,b.len)),b=f-e,a.dlBox=m(a.shapeArgs,{x:e,width:f-e,centerX:b?b/2:null})):a.dlBox=null;a.tooltipPos[0]+=h?0:k/2;a.tooltipPos[1]-=h?k/2:c.width/2;if(b=a.partialFill)r(b)&&(b=b.amount),u(b)||(b=0),c=a.shapeArgs,a.partShapeArgs={x:c.x,y:c.y,width:c.width,height:c.height,r:this.options.borderRadius},a.clipRectArgs={x:c.x,y:c.y,width:Math.max(Math.round(k*\r\nb+(a.plotX-d)),0),height:c.height}},translate:function(){q.prototype.translate.apply(this,arguments);l(this.points,function(a){this.translatePoint(a)},this)},drawPoint:function(a,b){var c=this.chart.renderer,e=a.graphic,d=a.shapeType,g=a.shapeArgs,f=a.partShapeArgs,h=a.clipRectArgs;if(a.isNull)e&&(a.graphic=e.destroy());else{if(e)a.graphicOriginal[b](m(g));else a.graphic=e=c.g(\"point\").addClass(a.getClassName()).add(a.group||this.group),a.graphicOriginal=c[d](g).addClass(a.getClassName()).addClass(\"highcharts-partfill-original\").add(e);\r\nf&&(a.graphicOverlay?(a.graphicOverlay[b](m(f)),a.clipRect.animate(m(h))):(a.clipRect=c.clipRect(h.x,h.y,h.width,h.height),a.graphicOverlay=c[d](f).addClass(\"highcharts-partfill-overlay\").add(e).clip(a.clipRect)))}},drawPoints:function(){var a=this,b=a.getAnimationVerb();l(a.points,function(c){a.drawPoint(c,b)})},getAnimationVerb:function(){return this.chart.pointCount<(this.options.animationLimit||250)?\"animate\":\"attr\"}},{init:function(){p.prototype.init.apply(this,arguments);var a=this.series.chart.options.chart.colorCount;\r\nthis.y||(this.y=0);this.colorIndex=n(this.options.colorIndex,this.y%a);return this},setState:function(){p.prototype.setState.apply(this,arguments);this.series.drawPoint(this,this.series.getAnimationVerb())},getLabelConfig:function(){var a=p.prototype.getLabelConfig.call(this),b=this.series.yAxis.categories;a.x2=this.x2;a.yCategory=this.yCategory=b&&b[this.y];return a},tooltipDateKeys:[\"x\",\"x2\"],isValid:function(){return\"number\"===typeof this.x&&\"number\"===typeof this.x2}});g(w,\"afterGetSeriesExtremes\",\r\nfunction(){var a=this.series,b,c;this.isXAxis&&(b=n(this.dataMax,-Number.MAX_VALUE),l(a,function(a){a.x2Data&&l(a.x2Data,function(a){a>b&&(b=a,c=!0)})}),c&&(this.dataMax=b))})})(g)});\r\n","Highcharts.setOptions({\r\n    colors: ['#3cd79a', '#718396', '#ffb652', '#ff6666', '#27bdbe', '#00a1f4', '#58c9f3', '#ef83c9', '#9a60c2', '#02cfaa', '#495764'],\r\n    credits: { enabled: false },\r\n    exporting: { enabled: false },\r\n    plotOptions: { series: { dataLabels: { style: { color: 'contrast', fontSize: '11px', fontWeight: 'normal', textOutline: '0px' } } } },\r\n\tnoData: { style: { fontSize: '18px', color: '#718396', fontWeight: 'nornmal', fontFamily: 'Segoe UI' } },\r\n    lang: { \r\n\t\t\tcontextButtonTitle: \"Параметры\",\r\n\t\t\tdecimalPoint: \",\",\r\n\t\t\tthousandsSep: \" \",\r\n\t\t\tdrillUpText: \"Обратно: {series.name}\",\r\n\t\t\tloading: \"Загрузка...\",\r\n\t\t\tnoData: \"Нет данных\",\r\n\t\t\tprintChart: \"Печать\",\r\n            viewData: \"Данные\",\r\n            zoomIn: \"Ближе\",\r\n            zoomOut: \"Дальше\",\r\n\t\t\tresetZoom: \"Вернуть масштаб\",\r\n\t\t\tresetZoomTitle: \"Вернуть масштаб к первоначальному\",\r\n\t\t\tnumericSymbols: [ \"тыс\" , \"млн\" , \"млрд\" , \"трлн\" , \"квдр\" , \"квнт\"],\r\n\t\t\tmonths: [\"Январь\", \"Февраль\", \"Март\", \"Апрель\", \"Май\", \"Июнь\", \"Июль\", \"Август\", \"Сентябрь\", \"Октябрь\", \"Ноябрь\", \"Декабрь\"],\r\n\t\t\tshortMonths: [\"Янв\", \"Фев\", \"Мар\", \"Апр\", \"Май\", \"Июн\", \"Июл\", \"Авг\", \"Сен\", \"Окт\", \"Ноя\", \"Дек\"],\r\n\t\t\tweekdays: [\"Воскресенье\", \"Понедельник\", \"Вторник\", \"Среда\", \"Четверг\", \"Пятница\", \"Суббота\"],\r\n\t\t\tshortWeekdays: [\"Вс\", \"Пн\", \"Вт\", \"Ср\", \"Чт\", \"Пт\", \"Сб\"]\r\n\t\t  }   \t\r\n});\t","jQuery.fn.timeline = function (settings) {\r\n    \r\n    var settings = jQuery.extend({\r\n        width: 10000,\r\n        array: [{ name: \"Name\", tooltip: \"Tooltip\", finish: \"01.03.2012\", status: -1}],\r\n\t\tisAdaptiveContainer : true\r\n    }, settings);\r\n\r\n    return this.each(function () \r\n\t{\r\n\r\n\t\t//var mon = ['Я', 'Ф', 'М', 'А', 'М', 'И', 'И', 'А', 'С', 'О', 'Н', 'Д'];\r\n        var mon = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];\r\n        var i = 0;\r\n        var emptyWidth = settings.isAdaptiveContainer ? 0 : 50;\r\n        var unit = settings.isAdaptiveContainer ? \"%\" : \"px\";\r\n        \r\n\t\tvar today = new Date();\r\n\t\tvar mindate = today;\r\n\t\tvar maxdate = today;\r\n\t\tvar isempty = true;\r\n\r\n        for (i = 0; i < settings.array.length; i++) {\r\n\t\t\tif (settings.array[i].finish != \"\") {\r\n\t\t\t\tif (isempty) {\r\n\t\t\t\t\tisempty = false;\r\n\t\t\t\t\tdata = strtodate(settings.array[i].finish);\t\t\t\t\r\n\t\t\t\t\tmindate = data;\r\n\t\t\t\t\tmaxdate = data;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdata = strtodate(settings.array[i].finish);\r\n\t\t\t\t\tif (data < mindate) mindate = data;\r\n\t\t\t\t\tif (data > maxdate) maxdate = data;\r\n\t\t\t\t}\r\n\t\t\t}\r\n        }\r\n\r\n\t\tif (!isempty) {\r\n\t\t\tif (mindate == maxdate) {\r\n\t\t\t\tmindate = new Date(mindate.getFullYear(), mindate.getMonth() - 6, 1);\r\n\t\t\t\tmaxdate = new Date(maxdate.getFullYear(), maxdate.getMonth() + 6, 1);\r\n\t\t\t}\r\n\r\n\t\t\tvar monthDiff = maxdate.getMonth() - mindate.getMonth() + (12 * (maxdate.getFullYear() - mindate.getFullYear()));\r\n\t\t\tmindate.setMonth(mindate.getMonth() - (emptyWidth / (settings.width / monthDiff)) - 1);\r\n\t\t\tmaxdate.setMonth(maxdate.getMonth() + 1);\r\n\r\n\t\t\tvar startDate = new Date(mindate.getFullYear(), mindate.getMonth(), 1);\r\n\t\t\t\r\n\t\t\tvar finishDate = maxdate; \r\n\t\t\tfinishDate.setMonth(finishDate.getMonth() + 1); \r\n\t\t\tfinishDate = new Date(finishDate.getFullYear(), finishDate.getMonth(), 1);\r\n\r\n\t\t\tvar daysTotal = days_between(startDate, finishDate);\r\n\t\t\tvar monTotal = days_between(startDate, finishDate);\r\n\t\t\tvar onedayWidth = settings.width / daysTotal;\r\n\r\n\t\t\t//first point\r\n\t\t\tif (settings.array[0].finish != \"\") { \r\n\t\t\t\tsettings.array[0].left = days_between(startDate, strtodate(settings.array[0].finish)) * onedayWidth - emptyWidth;\r\n\t\t\t\tsettings.array[0].width = emptyWidth;\r\n\r\n\t\t\t\tvar row = \"\";\r\n\t\t\t\t\r\n\t\t\t\trow += \"<div style='position: absolute; left: \" + settings.array[0].left + unit+\"; top: 5px; width: \" + settings.array[0].width + unit+\"; max-width: \" + (settings.array[0].width - 5) + unit+\"; z-index: 100;' \";\r\n\t\t\t\trow += \"class='tlEvent tlDivEvent\" + settings.array[0].status + \" tlDivEventEmpty' data-container='body' data-html='true' title='\" + settings.array[0].tooltip + \"'>\" + settings.array[0].name + \"</div>\";\r\n\t\t\t\t\r\n\t\t\t\trow += \"<div style='position: absolute; left: \" + settings.array[0].left + unit+\"; top: 20px; width: \" + settings.array[0].width + unit+\"; max-width: \" + settings.array[0].width + unit+\"; z-index: 100;' \";\r\n\t\t\t\trow += \"class='tlEvent tlDiv\" + settings.array[0].status + \" tlDiv\";\r\n\t\t\t\t\r\n\t\t\t\trow += \" tlDivSepLast\" + settings.array[0].status;\r\n\t\t\t\trow += \"' data-container='body' data-html='true' title='\" + settings.array[0].tooltip + \"'></div>\";\r\n\t\t\t\t\r\n\t\t\t\tjQuery(this).append(row);\r\n\t\t\t}\r\n\t\t\t//end\r\n\r\n\t\t\tfor (i = 1; i < settings.array.length; i++) {\r\n\t\t\t\tif (settings.array[i].finish != \"\") { \r\n\t\t\t\t\t\r\n\t\t\t\t\tsettings.array[i].left = days_between(strtodate(settings.array[i - 1].finish), startDate) * onedayWidth;\r\n\t\t\t\t\tsettings.array[i].width = days_between(strtodate(settings.array[i - 1].finish), strtodate(settings.array[i].finish)) * onedayWidth;\r\n\t\t\t\t\tif (settings.array[i - 1].finish == \"\") { \r\n\t\t\t\t\t\tsettings.array[i].left = days_between(startDate, strtodate(settings.array[i].finish)) * onedayWidth - emptyWidth; \r\n\t\t\t\t\t\tsettings.array[i].width = emptyWidth; \r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar row = \"\";\r\n\t\t\t\t\t\r\n\t\t\t\t\trow += \"<div style='position: absolute; left: \" + settings.array[i].left + unit+\"; top: 5px; width: \" + settings.array[i].width + unit+\"; max-width: \" + settings.array[i].width + unit+\"; z-index: \" + (100 - i) + \";' \";\r\n\t\t\t\t\trow += \"class='tlEvent tlDivEvent\" + settings.array[i].status;\r\n\t\t\t\t\tif (settings.array[i - 1].finish == \"\") { row += \" tlDivEventEmpty\"; }\r\n\t\t\t\t\trow += \"' data-container='body' data-html='true' title='\" + settings.array[i].tooltip + \"'>\" + settings.array[i].name + \"</div>\";\r\n\r\n\t\t\t\t\trow += \"<div style='position: absolute; left: \" + settings.array[i].left + unit+\"; top: 20px; width: \" + settings.array[i].width + unit+\"; max-width: \" + settings.array[i].width + unit+\"; z-index: \" + (100 - i) + \";' \";\r\n\t\t\t\t\trow += \"class='tlEvent tlDiv\" + settings.array[i].status;\r\n\r\n\t\t\t\t\tif (settings.array[i - 1].finish == \"\") { row += \" tlDiv\"; }\r\n\t\t\t\t\trow += \" tlDivSepLast\" + settings.array[i].status;\r\n\t\t\t\t\trow += \"' data-container='body' data-html='true' title='\" + settings.array[i].tooltip + \"'></div>\";\r\n\t\t\t\t\tjQuery(this).append(row);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t$(\"div[title]\").tooltip();\r\n\r\n\t\t\tvar timelineYears = \"<br/><br/>\";\r\n\t\t\ttimelineYears += \"<div id='timelineYears' style='width: \" + (settings.isAdaptiveContainer ? \"100%\" : settings.width.toString() + unit) +\"; position: absolute;'>\";\r\n\r\n\t\t\tvar months = (finishDate.getYear() - startDate.getYear()) * 12 + (finishDate.getMonth() - startDate.getMonth());\r\n\t\t\tvar onemonthWidth = (settings.width) / months;\r\n\r\n\t\t\tvar finishMonth = finishDate.getYear().toString() + finishDate.getMonth().toString();\r\n\t\t\tvar years = \"\";\r\n\t\t\tvar k = 0;\r\n\t\t\tvar l = 0;\r\n\t\t\tvar h = 14;\r\n\t\t\tdo {\r\n\t\t\t\tif (startDate.getMonth() == 11) h = 30; else h = 14;\r\n\t\t\t\tvar cls = 'tlTick';\r\n\t\t\t\tif (startDate.getMonth() == today.getMonth() && startDate.getFullYear() == today.getFullYear())\r\n\t\t\t\t\tcls += ' tlTickCurrent';\r\n\t\t\t\ttimelineYears += \"<div class='\" + cls + \"' style='width: \" + onemonthWidth + unit+\"; float: left; height: \" + h +\"px;'>\" + mon[startDate.getMonth()] + \"</div>\";\r\n\r\n\t\t\t\tk = k + 1;\r\n\t\t\t\tif (startDate.getMonth() == 11 || startMonth == finishMonth - 1)\r\n\t\t\t\t{ years += \"<div style='width: \" + (onemonthWidth * k) + unit+\"; float: left; position: absolute; top: 18px; left: \" + l + unit+\";' class='tlYear'>\" + startDate.getFullYear().toString() + \"</div>\"; l += onemonthWidth * k; k = 0; }\r\n\r\n\t\t\t\tstartDate.setMonth(startDate.getMonth() + 1);\r\n\t\t\t\tvar startMonth = startDate.getYear().toString() + startDate.getMonth().toString();\r\n\r\n\t\t\t} while (startMonth != finishMonth);\r\n\r\n\t\t\t//timelineYears  += \"</tr>\";\r\n\t\t\ttimelineYears += years;\r\n\r\n\t\t\t//timelineYears  += \"</table>\";\r\n\t\t\ttimelineYears += \"</div>\";\r\n\r\n\t\t\tjQuery(this).append(timelineYears);\r\n\t\t}\r\n\t});\r\n};\r\n\r\nfunction days_between(date1, date2) {\r\n\r\n    // The number of milliseconds in one day\r\n    var ONE_DAY = 1000 * 60 * 60 * 24;\r\n\r\n    // Convert both dates to milliseconds\r\n    var date1_ms = date1.getTime();\r\n    var date2_ms = date2.getTime();\r\n\r\n    // Calculate the difference in milliseconds\r\n    var difference_ms = Math.abs(date1_ms - date2_ms);\r\n\r\n    // Convert back to days and return\r\n    return difference_ms > 0 ? Math.round(difference_ms / ONE_DAY) : 0;\r\n\r\n};\r\n\r\nfunction months_between(date1, date2) {\r\n\r\n    // The number of milliseconds in one day\r\n    var ONE_DAY = 1000 * 60 * 60 * 24;\r\n\r\n    // Convert both dates to milliseconds\r\n    var date1_ms = date1.getTime();\r\n    var date2_ms = date2.getTime();\r\n\r\n    // Calculate the difference in milliseconds\r\n    var difference_ms = Math.abs(date1_ms - date2_ms);\r\n\r\n    // Convert back to days and return\r\n    return Math.round(difference_ms / ONE_DAY);\r\n\r\n};\r\n\r\nfunction strtodate(str)\r\n{\r\n   var dateArray = str.split(\".\");\r\n   return new Date(dateArray[2], dateArray[1]-1, dateArray[0]);\r\n};\r\n","var Comments = {};\r\n\r\nComments.Create = function (selector,settings) {\r\n    Comments.form = Asyst.Workspace.currentForm;\r\n    Comments.selector = selector;\r\n\r\n    var el = $(selector);\r\n    var access = Comments.form.Access[el.attr('id')];\r\n    while (access === undefined && el.length != 0) {\r\n        el = el.parent();\r\n        access = Comments.form.Access[el.attr('id')];\r\n    }\r\n    if (access !== undefined) {\r\n        settings = $.extend({ isReadOnly: access.IsReadonly }, settings);\r\n    } else {\r\n        settings = $.extend({ isReadOnly: false }, settings);\r\n    }\r\n    $(selector).comments(settings);\r\n\r\n    Comments.Refresh();\r\n};\r\n\r\nComments.RefreshCount = function () {\r\n    var commentID = 0;\r\n    if (Comments.Data.length == 0)\r\n        commentID = null;\r\n    else\r\n        commentID = Comments.Data[0].commentID;\r\n    \r\n    Asyst.APIv2.Comments.getCount({\r\n            entityName: Comments.form.EntityName,\r\n            dataId: Comments.form.EntityId,\r\n            commentId: commentID,\r\n            success: function(result) {\r\n                $('#commentNewCounter')[0].innerHTML = Comments.CountForm(result.count);\r\n                if (result.count == 0)\r\n                    $('#commentNewCounter').hide();\r\n                else\r\n                    $('#commentNewCounter').show();\r\n            },\r\n            error: function(jqXHR, textStatus, errorThrown) {\r\n                //alert(jqXHR);\r\n            }\r\n        }\r\n    );\r\n};\r\n\r\nComments.Refresh = function () {\r\n    \r\n    Asyst.APIv2.Comments.load({\r\n            entityName: Comments.form.EntityName,\r\n            dataId: Comments.form.EntityId,\r\n            success: function(result) {\r\n                Comments.Data = result;\r\n                if (typeof Comments.timer == \"undefined\")\r\n                    Comments.timer = setInterval(function() {\r\n                        Comments.RefreshCount();\r\n                    }, 1000 * Comments.Settings.update);\r\n                Comments.LoadPage(0);\r\n                Comments.RefreshCount();\r\n            },\r\n            error: function(jqXHR, textStatus, errorThrown) {\r\n                //alert(jqXHR);\r\n            }\r\n        }\r\n    );    \r\n};\r\n\r\nComments.LoadPage = function (pageNo) {\r\n    \r\n    $('.comList').empty();\r\n    \r\n    Comments.PageNo = pageNo;\r\n    \r\n    for (var i = pageNo * Comments.Settings.showBy; i < Math.min(Comments.Data.length, (pageNo + 1) * Comments.Settings.showBy) ; i++) {\r\n        var row = \"\";\r\n        row += \"<li>\";\r\n        row += \"   <span class='comListAuthor comListBold'> \" + Comments.Data[i].author + \" </span>\";\r\n        row += \"   <span class='comListInto comListDate'>\" + Comments.Data[i].creationDate + \"</span>\";\r\n\r\n        row += \"<span class='comListInto'>\";\r\n        if (Asyst.Workspace.currentUser.Id == Comments.Data[i].authorID && Comments.Settings.allowDelete && !Comments.Settings.isReadOnly)\r\n            row += \"<a href='#' onClick='Comments.Delete(\" + Comments.Data[i].commentID + \")'>\" + Globa.Delete.locale() + \"</a>\";\r\n        if (Comments.Settings.allowReply)\r\n            row += \"<a href='#' onClick='Comments.Reply(\" + Comments.Data[i].commentID + \", \\\"\" + Comments.Data[i].author + \"\\\")'>\" + Globa.Reply.locale() + \"</a>\";\r\n        if (Comments.Data[i].answerCount !=0)\r\n            row += \"<span>\" + Comments.Data[i].answerCount + \" \" + Globa.Answer.locale() + \"</span>\";\r\n        row += \"</span>\";\r\n\r\n        row += \"   <br/>\";\r\n        if (Comments.Data[i].isDeleted == \"True\") {\r\n            row += \"   \" + Globa.CommetDeletedAt.locale() + Comments.Data[i].deletionDate;\r\n        } else {\r\n            if (Comments.Data[i].parentAuthor.trim() == \"\") {\r\n                row += Comments.Data[i].content;\r\n            } else {\r\n                row += \"<span class='comListAuthor'>\" + Comments.Data[i].parentAuthor.trim() + \", </span> \" + Comments.Data[i].content;\r\n            }\r\n        }\r\n\r\n        row += \"</li>\";\r\n        $('.comList').append(row);\r\n    }\r\n\r\n    // на первой странице не показываем кнопку Назад\r\n    if (pageNo == 0)\r\n        $('.comPaging.comPagingBack').hide();\r\n    else\r\n        $('.comPaging.comPagingBack').show();\r\n    \r\n    // на последней странице не показываем кнопку Вперед\r\n    if (pageNo >= Math.floor((Comments.Data.length-1) / Comments.Settings.showBy))\r\n        $('.comPaging.comPagingForward').hide();\r\n    else \r\n        $('.comPaging.comPagingForward').show();\r\n};\r\n\r\nComments.LoadPrev = function() {\r\n    Comments.LoadPage(Comments.PageNo - 1);\r\n};\r\n\r\nComments.LoadNext = function () {\r\n    Comments.LoadPage(Comments.PageNo + 1);\r\n};\r\n\r\nComments.Save = function () {\r\n    \r\n    var data = {};\r\n    data.content = $(\"#commentText\").val();\r\n    if (Comments.ParentId !== undefined && Comments.ParentId != null)\r\n        data.parentId = Comments.ParentId;\r\n\r\n    Asyst.APIv2.Comments.save({\r\n        entityName: Comments.form.EntityName,\r\n        dataId: Comments.form.EntityId,\r\n        data: data,\r\n        success: function() {\r\n            Comments.RefreshCount();\r\n            $(\"#commentText\").val(\"\");\r\n            $(\"#commentText\").change();\r\n\r\n            $('.comAnswerInfo').hide();\r\n            if (Comments.ParentId !== undefined)\r\n                Comments.ParentId = null;\r\n        },\r\n        error: function(message, info, context) {\r\n            if (message == Globa.LicenseError) {\r\n                return;\r\n            }\r\n        },\r\n        async: true\r\n    });\r\n};\r\n\r\nComments.Delete = function (commentId) {\r\n    \r\n    var data = {};\r\n    data.CommentId = commentId;\r\n\r\n    Asyst.APIv2.Comments.delete({\r\n        entityName: Comments.form.EntityName,\r\n        dataId: Comments.form.EntityId,\r\n        data: data,\r\n        success: function() {\r\n            Comments.Refresh();\r\n        },\r\n        error: function(message, info, context) {\r\n            if (message == Globa.LicenseError) {\r\n                return;\r\n            }\r\n        },\r\n        async: false\r\n    });\r\n    \r\n};\r\n\r\nComments.Reply = function(commentId, author) {\r\n    Comments.ParentId = commentId;\r\n    $(\"#commentText\").focus();\r\n    $('.comAnswerInfo')[0].innerHTML = Globa.AnswerToComment.locale() + author;\r\n    $('.comAnswerInfo').show();\r\n};\r\n\r\njQuery.fn.comments = function (settings) {\r\n\r\n    Comments.Settings = jQuery.extend({\r\n        width: 10000,\r\n        css: \"/asyst/comments/jquery.comments.widget.css\",\r\n        update: 60,\r\n        allowReply: true,\r\n        allowDelete: true,\r\n        showBy: 2,\r\n        symbolsLimit: 255,\r\n        array: [{ author: \"\", parentAuthor: \"\", content: \"\", creationDate: \"\", deletionDate: \"\", isDeleted: \"\", commentID: \"\", authorID: \"\", answerCount: \"\" }],\r\n        isReadOnly: true\r\n    }, settings);\r\n\r\n\r\n    return this.each(function () {\r\n     \r\n        //чистим текущее содержимое узла\r\n        jQuery(Comments.selector).empty();\r\n        \r\n        var head = \"\";\r\n        \r\n        head += \"<div style='width: 100%'>\";\r\n\r\n        //подгрузка стилей\r\n        dynjs.load(Comments.Settings.css, dynjs.type.css);\r\n        head += \"<span class='comAnswerInfo' style='display: none'></span>\";\r\n        \r\n        head += \"<textarea id='commentText' rows='3' cols='100' class='comTextarea' onchange='Comments.SymbCounter(this);' oninput='Comments.SymbCounter(this);' onkeyup='Comments.SymbCounter(this);' oncut='Comments.SymbCounter(this);' onpropertychange='function() { if (event.propertyName == \\\"value\\\") Comments.SymbCounter(this);}'></textarea>\";\r\n        \r\n        head += \"<input id='commentSubmit' type='button' class='comSubmitButton' value='\" + Globa.Send.locale() + \"' onClick='Comments.Save();' disabled='true'/>\";\r\n        head += \"<span id='commentCounter' class='comCounter'>\" + Comments.Settings.symbolsLimit + \"</span>\";\r\n        head += \"<span id='commentCounterText' class='comCounterText'>Осталось символов:</span>\";\r\n\r\n        head += \"<div id='commentNewCounter' class='comNew' onClick='Comments.Refresh();' style='display: none'>0 новых комментариев</div>\";\r\n\r\n        head += \"<ul class='comList'>\";\r\n\r\n        jQuery(Comments.selector).append(head);\r\n\r\n        var addbottom = \"\";\r\n        addbottom += \"</ul>\";\r\n        addbottom += \"<a href='#' class='comPaging comPagingBack' style='display: none' onClick='Comments.LoadPrev()';>\" + Globa.Back.locale() + \"</a>\";\r\n        addbottom += \"<a href='#' class='comPaging comPagingForward' style='display: none' onClick='Comments.LoadNext()';>\" + Globa.Forward.locale() + \"</a>\";\r\n\r\n        addbottom += \"</div>\";\r\n\r\n        jQuery(Comments.selector).append(addbottom);\r\n    });\r\n};\r\n\r\nComments.SymbCounter = function (selector) {\r\n    var symbCount = selector.value.length;\r\n    $('#commentCounter')[0].innerText = Comments.Settings.symbolsLimit - symbCount;\r\n    if (!Comments.Settings.isReadOnly)\r\n        $('#commentSubmit').prop(\"disabled\", Comments.Settings.symbolsLimit - symbCount < 0 || symbCount == 0);\r\n    if (Comments.Settings.symbolsLimit - symbCount > 10) {\r\n        $('#commentCounter').removeClass(\"comCounterLow\");\r\n    }\r\n    else {\r\n        $('#commentCounter').addClass(\"comCounterLow\");\r\n    }\r\n};\r\n\r\nComments.CountForm = function (count) {\r\n    var mod = count % 10;\r\n    var cnt = Math.floor(count / 10);\r\n\r\n    if (count == 1)\r\n        return count + Globa.NewComment1.locale();\r\n    if ((cnt == 0 || cnt > 1) && (mod == 1))\r\n        return count + Globa.NewCommentx1.locale();\r\n    else if ((cnt == 0 || cnt > 1) && (mod == 2 || mod == 3 || mod == 4))\r\n        return count + Globa.NewComment234.locale();\r\n    else //if ((count == 11 || count == 12) || (mod == 5 || mod == 6 || mod == 7 || mod == 8 || mod == 9  || mod == 0))\r\n        return count + Globa.NewCommentx.locale();\r\n};\r\n\r\n","/*--------------------------------------------------------------------------\r\n* linq.js - LINQ for JavaScript\r\n* ver 2.2.0.2 (Jan. 21th, 2011)\r\n*\r\n* created and maintained by neuecc <ils@neue.cc>\r\n* licensed under Microsoft Public License(Ms-PL)\r\n* http://neue.cc/\r\n* http://linqjs.codeplex.com/\r\n*--------------------------------------------------------------------------*/\r\nEnumerable=function(){var m=\"Single:sequence contains more than one element.\",e=true,b=null,a=false,c=function(a){this.GetEnumerator=a};c.Choice=function(){var a=arguments[0]instanceof Array?arguments[0]:arguments;return new c(function(){return new f(g.Blank,function(){return this.Yield(a[Math.floor(Math.random()*a.length)])},g.Blank)})};c.Cycle=function(){var a=arguments[0]instanceof Array?arguments[0]:arguments;return new c(function(){var b=0;return new f(g.Blank,function(){if(b>=a.length)b=0;return this.Yield(a[b++])},g.Blank)})};c.Empty=function(){return new c(function(){return new f(g.Blank,function(){return a},g.Blank)})};c.From=function(j){if(j==b)return c.Empty();if(j instanceof c)return j;if(typeof j==i.Number||typeof j==i.Boolean)return c.Repeat(j,1);if(typeof j==i.String)return new c(function(){var b=0;return new f(g.Blank,function(){return b<j.length?this.Yield(j.charAt(b++)):a},g.Blank)});if(typeof j!=i.Function){if(typeof j.length==i.Number)return new h(j);if(!(j instanceof Object)&&d.IsIEnumerable(j))return new c(function(){var c=e,b;return new f(function(){b=new Enumerator(j)},function(){if(c)c=a;else b.moveNext();return b.atEnd()?a:this.Yield(b.item())},g.Blank)})}return new c(function(){var b=[],c=0;return new f(function(){for(var a in j)!(j[a]instanceof Function)&&b.push({Key:a,Value:j[a]})},function(){return c<b.length?this.Yield(b[c++]):a},g.Blank)})},c.Return=function(a){return c.Repeat(a,1)};c.Matches=function(h,e,d){if(d==b)d=\"\";if(e instanceof RegExp){d+=e.ignoreCase?\"i\":\"\";d+=e.multiline?\"m\":\"\";e=e.source}if(d.indexOf(\"g\")===-1)d+=\"g\";return new c(function(){var b;return new f(function(){b=new RegExp(e,d)},function(){var c=b.exec(h);return c?this.Yield(c):a},g.Blank)})};c.Range=function(e,d,a){if(a==b)a=1;return c.ToInfinity(e,a).Take(d)};c.RangeDown=function(e,d,a){if(a==b)a=1;return c.ToNegativeInfinity(e,a).Take(d)};c.RangeTo=function(d,e,a){if(a==b)a=1;return d<e?c.ToInfinity(d,a).TakeWhile(function(a){return a<=e}):c.ToNegativeInfinity(d,a).TakeWhile(function(a){return a>=e})};c.Repeat=function(d,a){return a!=b?c.Repeat(d).Take(a):new c(function(){return new f(g.Blank,function(){return this.Yield(d)},g.Blank)})};c.RepeatWithFinalize=function(a,e){a=d.CreateLambda(a);e=d.CreateLambda(e);return new c(function(){var c;return new f(function(){c=a()},function(){return this.Yield(c)},function(){if(c!=b){e(c);c=b}})})};c.Generate=function(a,e){if(e!=b)return c.Generate(a).Take(e);a=d.CreateLambda(a);return new c(function(){return new f(g.Blank,function(){return this.Yield(a())},g.Blank)})};c.ToInfinity=function(d,a){if(d==b)d=0;if(a==b)a=1;return new c(function(){var b;return new f(function(){b=d-a},function(){return this.Yield(b+=a)},g.Blank)})};c.ToNegativeInfinity=function(d,a){if(d==b)d=0;if(a==b)a=1;return new c(function(){var b;return new f(function(){b=d+a},function(){return this.Yield(b-=a)},g.Blank)})};c.Unfold=function(h,b){b=d.CreateLambda(b);return new c(function(){var d=e,c;return new f(g.Blank,function(){if(d){d=a;c=h;return this.Yield(c)}c=b(c);return this.Yield(c)},g.Blank)})};c.prototype={CascadeBreadthFirst:function(g,b){var h=this;g=d.CreateLambda(g);b=d.CreateLambda(b);return new c(function(){var i,k=0,j=[];return new f(function(){i=h.GetEnumerator()},function(){while(e){if(i.MoveNext()){j.push(i.Current());return this.Yield(b(i.Current(),k))}var f=c.From(j).SelectMany(function(a){return g(a)});if(!f.Any())return a;else{k++;j=[];d.Dispose(i);i=f.GetEnumerator()}}},function(){d.Dispose(i)})})},CascadeDepthFirst:function(g,b){var h=this;g=d.CreateLambda(g);b=d.CreateLambda(b);return new c(function(){var j=[],i;return new f(function(){i=h.GetEnumerator()},function(){while(e){if(i.MoveNext()){var f=b(i.Current(),j.length);j.push(i);i=c.From(g(i.Current())).GetEnumerator();return this.Yield(f)}if(j.length<=0)return a;d.Dispose(i);i=j.pop()}},function(){try{d.Dispose(i)}finally{c.From(j).ForEach(function(a){a.Dispose()})}})})},Flatten:function(){var h=this;return new c(function(){var j,i=b;return new f(function(){j=h.GetEnumerator()},function(){while(e){if(i!=b)if(i.MoveNext())return this.Yield(i.Current());else i=b;if(j.MoveNext())if(j.Current()instanceof Array){d.Dispose(i);i=c.From(j.Current()).SelectMany(g.Identity).Flatten().GetEnumerator();continue}else return this.Yield(j.Current());return a}},function(){try{d.Dispose(j)}finally{d.Dispose(i)}})})},Pairwise:function(b){var e=this;b=d.CreateLambda(b);return new c(function(){var c;return new f(function(){c=e.GetEnumerator();c.MoveNext()},function(){var d=c.Current();return c.MoveNext()?this.Yield(b(d,c.Current())):a},function(){d.Dispose(c)})})},Scan:function(i,g,j){if(j!=b)return this.Scan(i,g).Select(j);var h;if(g==b){g=d.CreateLambda(i);h=a}else{g=d.CreateLambda(g);h=e}var k=this;return new c(function(){var b,c,j=e;return new f(function(){b=k.GetEnumerator()},function(){if(j){j=a;if(!h){if(b.MoveNext())return this.Yield(c=b.Current())}else return this.Yield(c=i)}return b.MoveNext()?this.Yield(c=g(c,b.Current())):a},function(){d.Dispose(b)})})},Select:function(b){var e=this;b=d.CreateLambda(b);return new c(function(){var c,g=0;return new f(function(){c=e.GetEnumerator()},function(){return c.MoveNext()?this.Yield(b(c.Current(),g++)):a},function(){d.Dispose(c)})})},SelectMany:function(g,e){var h=this;g=d.CreateLambda(g);if(e==b)e=function(b,a){return a};e=d.CreateLambda(e);return new c(function(){var j,i=undefined,k=0;return new f(function(){j=h.GetEnumerator()},function(){if(i===undefined)if(!j.MoveNext())return a;do{if(i==b){var f=g(j.Current(),k++);i=c.From(f).GetEnumerator()}if(i.MoveNext())return this.Yield(e(j.Current(),i.Current()));d.Dispose(i);i=b}while(j.MoveNext());return a},function(){try{d.Dispose(j)}finally{d.Dispose(i)}})})},Where:function(b){b=d.CreateLambda(b);var e=this;return new c(function(){var c,g=0;return new f(function(){c=e.GetEnumerator()},function(){while(c.MoveNext())if(b(c.Current(),g++))return this.Yield(c.Current());return a},function(){d.Dispose(c)})})},OfType:function(c){var a;switch(c){case Number:a=i.Number;break;case String:a=i.String;break;case Boolean:a=i.Boolean;break;case Function:a=i.Function;break;default:a=b}return a===b?this.Where(function(a){return a instanceof c}):this.Where(function(b){return typeof b===a})},Zip:function(e,b){b=d.CreateLambda(b);var g=this;return new c(function(){var i,h,j=0;return new f(function(){i=g.GetEnumerator();h=c.From(e).GetEnumerator()},function(){return i.MoveNext()&&h.MoveNext()?this.Yield(b(i.Current(),h.Current(),j++)):a},function(){try{d.Dispose(i)}finally{d.Dispose(h)}})})},Join:function(m,i,h,k,j){i=d.CreateLambda(i);h=d.CreateLambda(h);k=d.CreateLambda(k);j=d.CreateLambda(j);var l=this;return new c(function(){var n,q,o=b,p=0;return new f(function(){n=l.GetEnumerator();q=c.From(m).ToLookup(h,g.Identity,j)},function(){while(e){if(o!=b){var c=o[p++];if(c!==undefined)return this.Yield(k(n.Current(),c));c=b;p=0}if(n.MoveNext()){var d=i(n.Current());o=q.Get(d).ToArray()}else return a}},function(){d.Dispose(n)})})},GroupJoin:function(l,h,e,j,i){h=d.CreateLambda(h);e=d.CreateLambda(e);j=d.CreateLambda(j);i=d.CreateLambda(i);var k=this;return new c(function(){var m=k.GetEnumerator(),n=b;return new f(function(){m=k.GetEnumerator();n=c.From(l).ToLookup(e,g.Identity,i)},function(){if(m.MoveNext()){var b=n.Get(h(m.Current()));return this.Yield(j(m.Current(),b))}return a},function(){d.Dispose(m)})})},All:function(b){b=d.CreateLambda(b);var c=e;this.ForEach(function(d){if(!b(d)){c=a;return a}});return c},Any:function(c){c=d.CreateLambda(c);var b=this.GetEnumerator();try{if(arguments.length==0)return b.MoveNext();while(b.MoveNext())if(c(b.Current()))return e;return a}finally{d.Dispose(b)}},Concat:function(e){var g=this;return new c(function(){var i,h;return new f(function(){i=g.GetEnumerator()},function(){if(h==b){if(i.MoveNext())return this.Yield(i.Current());h=c.From(e).GetEnumerator()}return h.MoveNext()?this.Yield(h.Current()):a},function(){try{d.Dispose(i)}finally{d.Dispose(h)}})})},Insert:function(h,b){var g=this;return new c(function(){var j,i,l=0,k=a;return new f(function(){j=g.GetEnumerator();i=c.From(b).GetEnumerator()},function(){if(l==h&&i.MoveNext()){k=e;return this.Yield(i.Current())}if(j.MoveNext()){l++;return this.Yield(j.Current())}return!k&&i.MoveNext()?this.Yield(i.Current()):a},function(){try{d.Dispose(j)}finally{d.Dispose(i)}})})},Alternate:function(a){a=c.Return(a);return this.SelectMany(function(b){return c.Return(b).Concat(a)}).TakeExceptLast()},Contains:function(f,b){b=d.CreateLambda(b);var c=this.GetEnumerator();try{while(c.MoveNext())if(b(c.Current())===f)return e;return a}finally{d.Dispose(c)}},DefaultIfEmpty:function(b){var g=this;return new c(function(){var c,h=e;return new f(function(){c=g.GetEnumerator()},function(){if(c.MoveNext()){h=a;return this.Yield(c.Current())}else if(h){h=a;return this.Yield(b)}return a},function(){d.Dispose(c)})})},Distinct:function(a){return this.Except(c.Empty(),a)},Except:function(e,b){b=d.CreateLambda(b);var g=this;return new c(function(){var h,i;return new f(function(){h=g.GetEnumerator();i=new n(b);c.From(e).ForEach(function(a){i.Add(a)})},function(){while(h.MoveNext()){var b=h.Current();if(!i.Contains(b)){i.Add(b);return this.Yield(b)}}return a},function(){d.Dispose(h)})})},Intersect:function(e,b){b=d.CreateLambda(b);var g=this;return new c(function(){var h,i,j;return new f(function(){h=g.GetEnumerator();i=new n(b);c.From(e).ForEach(function(a){i.Add(a)});j=new n(b)},function(){while(h.MoveNext()){var b=h.Current();if(!j.Contains(b)&&i.Contains(b)){j.Add(b);return this.Yield(b)}}return a},function(){d.Dispose(h)})})},SequenceEqual:function(h,f){f=d.CreateLambda(f);var g=this.GetEnumerator();try{var b=c.From(h).GetEnumerator();try{while(g.MoveNext())if(!b.MoveNext()||f(g.Current())!==f(b.Current()))return a;return b.MoveNext()?a:e}finally{d.Dispose(b)}}finally{d.Dispose(g)}},Union:function(e,b){b=d.CreateLambda(b);var g=this;return new c(function(){var j,h,i;return new f(function(){j=g.GetEnumerator();i=new n(b)},function(){var b;if(h===undefined){while(j.MoveNext()){b=j.Current();if(!i.Contains(b)){i.Add(b);return this.Yield(b)}}h=c.From(e).GetEnumerator()}while(h.MoveNext()){b=h.Current();if(!i.Contains(b)){i.Add(b);return this.Yield(b)}}return a},function(){try{d.Dispose(j)}finally{d.Dispose(h)}})})},OrderBy:function(b){return new j(this,b,a)},OrderByDescending:function(a){return new j(this,a,e)},Reverse:function(){var b=this;return new c(function(){var c,d;return new f(function(){c=b.ToArray();d=c.length},function(){return d>0?this.Yield(c[--d]):a},g.Blank)})},Shuffle:function(){var b=this;return new c(function(){var c;return new f(function(){c=b.ToArray()},function(){if(c.length>0){var b=Math.floor(Math.random()*c.length);return this.Yield(c.splice(b,1)[0])}return a},g.Blank)})},GroupBy:function(i,h,e,g){var j=this;i=d.CreateLambda(i);h=d.CreateLambda(h);if(e!=b)e=d.CreateLambda(e);g=d.CreateLambda(g);return new c(function(){var c;return new f(function(){c=j.ToLookup(i,h,g).ToEnumerable().GetEnumerator()},function(){while(c.MoveNext())return e==b?this.Yield(c.Current()):this.Yield(e(c.Current().Key(),c.Current()));return a},function(){d.Dispose(c)})})},PartitionBy:function(j,i,g,h){var l=this;j=d.CreateLambda(j);i=d.CreateLambda(i);h=d.CreateLambda(h);var k;if(g==b){k=a;g=function(b,a){return new o(b,a)}}else{k=e;g=d.CreateLambda(g)}return new c(function(){var b,n,o,m=[];return new f(function(){b=l.GetEnumerator();if(b.MoveNext()){n=j(b.Current());o=h(n);m.push(i(b.Current()))}},function(){var d;while((d=b.MoveNext())==e)if(o===h(j(b.Current())))m.push(i(b.Current()));else break;if(m.length>0){var f=k?g(n,c.From(m)):g(n,m);if(d){n=j(b.Current());o=h(n);m=[i(b.Current())]}else m=[];return this.Yield(f)}return a},function(){d.Dispose(b)})})},BufferWithCount:function(e){var b=this;return new c(function(){var c;return new f(function(){c=b.GetEnumerator()},function(){var b=[],d=0;while(c.MoveNext()){b.push(c.Current());if(++d>=e)return this.Yield(b)}return b.length>0?this.Yield(b):a},function(){d.Dispose(c)})})},Aggregate:function(c,b,a){return this.Scan(c,b,a).Last()},Average:function(a){a=d.CreateLambda(a);var c=0,b=0;this.ForEach(function(d){c+=a(d);++b});return c/b},Count:function(a){a=a==b?g.True:d.CreateLambda(a);var c=0;this.ForEach(function(d,b){if(a(d,b))++c});return c},Max:function(a){if(a==b)a=g.Identity;return this.Select(a).Aggregate(function(a,b){return a>b?a:b})},Min:function(a){if(a==b)a=g.Identity;return this.Select(a).Aggregate(function(a,b){return a<b?a:b})},MaxBy:function(a){a=d.CreateLambda(a);return this.Aggregate(function(b,c){return a(b)>a(c)?b:c})},MinBy:function(a){a=d.CreateLambda(a);return this.Aggregate(function(b,c){return a(b)<a(c)?b:c})},Sum:function(a){if(a==b)a=g.Identity;return this.Select(a).Aggregate(0,function(a,b){return a+b})},ElementAt:function(d){var c,b=a;this.ForEach(function(g,f){if(f==d){c=g;b=e;return a}});if(!b)throw new Error(\"index is less than 0 or greater than or equal to the number of elements in source.\");return c},ElementAtOrDefault:function(f,d){var c,b=a;this.ForEach(function(g,d){if(d==f){c=g;b=e;return a}});return!b?d:c},First:function(c){if(c!=b)return this.Where(c).First();var f,d=a;this.ForEach(function(b){f=b;d=e;return a});if(!d)throw new Error(\"First:No element satisfies the condition.\");return f},FirstOrDefault:function(c,d){if(d!=b)return this.Where(d).FirstOrDefault(c);var g,f=a;this.ForEach(function(b){g=b;f=e;return a});return!f?c:g},Last:function(c){if(c!=b)return this.Where(c).Last();var f,d=a;this.ForEach(function(a){d=e;f=a});if(!d)throw new Error(\"Last:No element satisfies the condition.\");return f},LastOrDefault:function(c,d){if(d!=b)return this.Where(d).LastOrDefault(c);var g,f=a;this.ForEach(function(a){f=e;g=a});return!f?c:g},Single:function(d){if(d!=b)return this.Where(d).Single();var f,c=a;this.ForEach(function(a){if(!c){c=e;f=a}else throw new Error(m);});if(!c)throw new Error(\"Single:No element satisfies the condition.\");return f},SingleOrDefault:function(d,f){if(f!=b)return this.Where(f).SingleOrDefault(d);var g,c=a;this.ForEach(function(a){if(!c){c=e;g=a}else throw new Error(m);});return!c?d:g},Skip:function(e){var b=this;return new c(function(){var c,g=0;return new f(function(){c=b.GetEnumerator();while(g++<e&&c.MoveNext());},function(){return c.MoveNext()?this.Yield(c.Current()):a},function(){d.Dispose(c)})})},SkipWhile:function(b){b=d.CreateLambda(b);var g=this;return new c(function(){var c,i=0,h=a;return new f(function(){c=g.GetEnumerator()},function(){while(!h)if(c.MoveNext()){if(!b(c.Current(),i++)){h=e;return this.Yield(c.Current())}continue}else return a;return c.MoveNext()?this.Yield(c.Current()):a},function(){d.Dispose(c)})})},Take:function(e){var b=this;return new c(function(){var c,g=0;return new f(function(){c=b.GetEnumerator()},function(){return g++<e&&c.MoveNext()?this.Yield(c.Current()):a},function(){d.Dispose(c)})})},TakeWhile:function(b){b=d.CreateLambda(b);var e=this;return new c(function(){var c,g=0;return new f(function(){c=e.GetEnumerator()},function(){return c.MoveNext()&&b(c.Current(),g++)?this.Yield(c.Current()):a},function(){d.Dispose(c)})})},TakeExceptLast:function(e){if(e==b)e=1;var g=this;return new c(function(){if(e<=0)return g.GetEnumerator();var b,c=[];return new f(function(){b=g.GetEnumerator()},function(){while(b.MoveNext()){if(c.length==e){c.push(b.Current());return this.Yield(c.shift())}c.push(b.Current())}return a},function(){d.Dispose(b)})})},TakeFromLast:function(e){if(e<=0||e==b)return c.Empty();var g=this;return new c(function(){var j,h,i=[];return new f(function(){j=g.GetEnumerator()},function(){while(j.MoveNext()){i.length==e&&i.shift();i.push(j.Current())}if(h==b)h=c.From(i).GetEnumerator();return h.MoveNext()?this.Yield(h.Current()):a},function(){d.Dispose(h)})})},IndexOf:function(c){var a=b;this.ForEach(function(d,b){if(d===c){a=b;return e}});return a!==b?a:-1},LastIndexOf:function(b){var a=-1;this.ForEach(function(d,c){if(d===b)a=c});return a},ToArray:function(){var a=[];this.ForEach(function(b){a.push(b)});return a},ToLookup:function(c,b,a){c=d.CreateLambda(c);b=d.CreateLambda(b);a=d.CreateLambda(a);var e=new n(a);this.ForEach(function(g){var f=c(g),a=b(g),d=e.Get(f);if(d!==undefined)d.push(a);else e.Add(f,[a])});return new q(e)},ToObject:function(b,a){b=d.CreateLambda(b);a=d.CreateLambda(a);var c={};this.ForEach(function(d){c[b(d)]=a(d)});return c},ToDictionary:function(c,b,a){c=d.CreateLambda(c);b=d.CreateLambda(b);a=d.CreateLambda(a);var e=new n(a);this.ForEach(function(a){e.Add(c(a),b(a))});return e},ToJSON:function(a,b){return JSON.stringify(this.ToArray(),a,b)},ToString:function(a,c){if(a==b)a=\"\";if(c==b)c=g.Identity;return this.Select(c).ToArray().join(a)},Do:function(b){var e=this;b=d.CreateLambda(b);return new c(function(){var c,g=0;return new f(function(){c=e.GetEnumerator()},function(){if(c.MoveNext()){b(c.Current(),g++);return this.Yield(c.Current())}return a},function(){d.Dispose(c)})})},ForEach:function(c){c=d.CreateLambda(c);var e=0,b=this.GetEnumerator();try{while(b.MoveNext())if(c(b.Current(),e++)===a)break}finally{d.Dispose(b)}},Write:function(c,f){if(c==b)c=\"\";f=d.CreateLambda(f);var g=e;this.ForEach(function(b){if(g)g=a;else document.write(c);document.write(f(b))})},WriteLine:function(a){a=d.CreateLambda(a);this.ForEach(function(b){document.write(a(b));document.write(\"<br />\")})},Force:function(){var a=this.GetEnumerator();try{while(a.MoveNext());}finally{d.Dispose(a)}},Let:function(b){b=d.CreateLambda(b);var e=this;return new c(function(){var g;return new f(function(){g=c.From(b(e)).GetEnumerator()},function(){return g.MoveNext()?this.Yield(g.Current()):a},function(){d.Dispose(g)})})},Share:function(){var e=this,d;return new c(function(){return new f(function(){if(d==b)d=e.GetEnumerator()},function(){return d.MoveNext()?this.Yield(d.Current()):a},g.Blank)})},MemoizeAll:function(){var h=this,e,d;return new c(function(){var c=-1;return new f(function(){if(d==b){d=h.GetEnumerator();e=[]}},function(){c++;return e.length<=c?d.MoveNext()?this.Yield(e[c]=d.Current()):a:this.Yield(e[c])},g.Blank)})},Catch:function(b){b=d.CreateLambda(b);var e=this;return new c(function(){var c;return new f(function(){c=e.GetEnumerator()},function(){try{return c.MoveNext()?this.Yield(c.Current()):a}catch(d){b(d);return a}},function(){d.Dispose(c)})})},Finally:function(b){b=d.CreateLambda(b);var e=this;return new c(function(){var c;return new f(function(){c=e.GetEnumerator()},function(){return c.MoveNext()?this.Yield(c.Current()):a},function(){try{d.Dispose(c)}finally{b()}})})},Trace:function(c,a){if(c==b)c=\"Trace\";a=d.CreateLambda(a);return this.Do(function(b){console.log(c,\":\",a(b))})}};var g={Identity:function(a){return a},True:function(){return e},Blank:function(){}},i={Boolean:typeof e,Number:typeof 0,String:typeof\"\",Object:typeof{},Undefined:typeof undefined,Function:typeof function(){}},d={CreateLambda:function(a){if(a==b)return g.Identity;if(typeof a==i.String)if(a==\"\")return g.Identity;else if(a.indexOf(\"=>\")==-1)return new Function(\"$,$$,$$$,$$$$\",\"return \"+a);else{var c=a.match(/^[(\\s]*([^()]*?)[)\\s]*=>(.*)/);return new Function(c[1],\"return \"+c[2])}return a},IsIEnumerable:function(b){if(typeof Enumerator!=i.Undefined)try{new Enumerator(b);return e}catch(c){}return a},Compare:function(a,b){return a===b?0:a>b?1:-1},Dispose:function(a){a!=b&&a.Dispose()}},k={Before:0,Running:1,After:2},f=function(d,f,g){var c=new p,b=k.Before;this.Current=c.Current;this.MoveNext=function(){try{switch(b){case k.Before:b=k.Running;d();case k.Running:if(f.apply(c))return e;else{this.Dispose();return a}case k.After:return a}}catch(g){this.Dispose();throw g;}};this.Dispose=function(){if(b!=k.Running)return;try{g()}finally{b=k.After}}},p=function(){var a=b;this.Current=function(){return a};this.Yield=function(b){a=b;return e}},j=function(f,b,c,e){var a=this;a.source=f;a.keySelector=d.CreateLambda(b);a.descending=c;a.parent=e};j.prototype=new c;j.prototype.CreateOrderedEnumerable=function(a,b){return new j(this.source,a,b,this)};j.prototype.ThenBy=function(b){return this.CreateOrderedEnumerable(b,a)};j.prototype.ThenByDescending=function(a){return this.CreateOrderedEnumerable(a,e)};j.prototype.GetEnumerator=function(){var h=this,d,c,e=0;return new f(function(){d=[];c=[];h.source.ForEach(function(b,a){d.push(b);c.push(a)});var a=l.Create(h,b);a.GenerateKeys(d);c.sort(function(b,c){return a.Compare(b,c)})},function(){return e<c.length?this.Yield(d[c[e++]]):a},g.Blank)};var l=function(c,d,e){var a=this;a.keySelector=c;a.descending=d;a.child=e;a.keys=b};l.Create=function(a,d){var c=new l(a.keySelector,a.descending,d);return a.parent!=b?l.Create(a.parent,c):c};l.prototype.GenerateKeys=function(d){var a=this;for(var f=d.length,g=a.keySelector,e=new Array(f),c=0;c<f;c++)e[c]=g(d[c]);a.keys=e;a.child!=b&&a.child.GenerateKeys(d)};l.prototype.Compare=function(e,f){var a=this,c=d.Compare(a.keys[e],a.keys[f]);if(c==0){if(a.child!=b)return a.child.Compare(e,f);c=d.Compare(e,f)}return a.descending?-c:c};var h=function(a){this.source=a};h.prototype=new c;h.prototype.Any=function(a){return a==b?this.source.length>0:c.prototype.Any.apply(this,arguments)};h.prototype.Count=function(a){return a==b?this.source.length:c.prototype.Count.apply(this,arguments)};h.prototype.ElementAt=function(a){return 0<=a&&a<this.source.length?this.source[a]:c.prototype.ElementAt.apply(this,arguments)};h.prototype.ElementAtOrDefault=function(a,b){return 0<=a&&a<this.source.length?this.source[a]:b};h.prototype.First=function(a){return a==b&&this.source.length>0?this.source[0]:c.prototype.First.apply(this,arguments)};h.prototype.FirstOrDefault=function(a,d){return d!=b?c.prototype.FirstOrDefault.apply(this,arguments):this.source.length>0?this.source[0]:a};h.prototype.Last=function(d){var a=this;return d==b&&a.source.length>0?a.source[a.source.length-1]:c.prototype.Last.apply(a,arguments)};h.prototype.LastOrDefault=function(d,e){var a=this;return e!=b?c.prototype.LastOrDefault.apply(a,arguments):a.source.length>0?a.source[a.source.length-1]:d};h.prototype.Skip=function(d){var b=this.source;return new c(function(){var c;return new f(function(){c=d<0?0:d},function(){return c<b.length?this.Yield(b[c++]):a},g.Blank)})};h.prototype.TakeExceptLast=function(a){if(a==b)a=1;return this.Take(this.source.length-a)};h.prototype.TakeFromLast=function(a){return this.Skip(this.source.length-a)};h.prototype.Reverse=function(){var b=this.source;return new c(function(){var c;return new f(function(){c=b.length},function(){return c>0?this.Yield(b[--c]):a},g.Blank)})};h.prototype.SequenceEqual=function(d,e){return(d instanceof h||d instanceof Array)&&e==b&&c.From(d).Count()!=this.Count()?a:c.prototype.SequenceEqual.apply(this,arguments)};h.prototype.ToString=function(a,d){if(d!=b||!(this.source instanceof Array))return c.prototype.ToString.apply(this,arguments);if(a==b)a=\"\";return this.source.join(a)};h.prototype.GetEnumerator=function(){var b=this.source,c=0;return new f(g.Blank,function(){return c<b.length?this.Yield(b[c++]):a},g.Blank)};var n=function(){var h=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},d=function(a){return a===b?\"null\":a===undefined?\"undefined\":typeof a.toString===i.Function?a.toString():Object.prototype.toString.call(a)},l=function(d,c){var a=this;a.Key=d;a.Value=c;a.Prev=b;a.Next=b},j=function(){this.First=b;this.Last=b};j.prototype={AddLast:function(c){var a=this;if(a.Last!=b){a.Last.Next=c;c.Prev=a.Last;a.Last=c}else a.First=a.Last=c},Replace:function(c,a){if(c.Prev!=b){c.Prev.Next=a;a.Prev=c.Prev}else this.First=a;if(c.Next!=b){c.Next.Prev=a;a.Next=c.Next}else this.Last=a},Remove:function(a){if(a.Prev!=b)a.Prev.Next=a.Next;else this.First=a.Next;if(a.Next!=b)a.Next.Prev=a.Prev;else this.Last=a.Prev}};var k=function(c){var a=this;a.count=0;a.entryList=new j;a.buckets={};a.compareSelector=c==b?g.Identity:c};k.prototype={Add:function(i,j){var a=this,g=a.compareSelector(i),f=d(g),c=new l(i,j);if(h(a.buckets,f)){for(var b=a.buckets[f],e=0;e<b.length;e++)if(a.compareSelector(b[e].Key)===g){a.entryList.Replace(b[e],c);b[e]=c;return}b.push(c)}else a.buckets[f]=[c];a.count++;a.entryList.AddLast(c)},Get:function(i){var a=this,c=a.compareSelector(i),g=d(c);if(!h(a.buckets,g))return undefined;for(var e=a.buckets[g],b=0;b<e.length;b++){var f=e[b];if(a.compareSelector(f.Key)===c)return f.Value}return undefined},Set:function(k,m){var b=this,g=b.compareSelector(k),j=d(g);if(h(b.buckets,j))for(var f=b.buckets[j],c=0;c<f.length;c++)if(b.compareSelector(f[c].Key)===g){var i=new l(k,m);b.entryList.Replace(f[c],i);f[c]=i;return e}return a},Contains:function(j){var b=this,f=b.compareSelector(j),i=d(f);if(!h(b.buckets,i))return a;for(var g=b.buckets[i],c=0;c<g.length;c++)if(b.compareSelector(g[c].Key)===f)return e;return a},Clear:function(){this.count=0;this.buckets={};this.entryList=new j},Remove:function(g){var a=this,f=a.compareSelector(g),e=d(f);if(!h(a.buckets,e))return;for(var b=a.buckets[e],c=0;c<b.length;c++)if(a.compareSelector(b[c].Key)===f){a.entryList.Remove(b[c]);b.splice(c,1);if(b.length==0)delete a.buckets[e];a.count--;return}},Count:function(){return this.count},ToEnumerable:function(){var d=this;return new c(function(){var c;return new f(function(){c=d.entryList.First},function(){if(c!=b){var d={Key:c.Key,Value:c.Value};c=c.Next;return this.Yield(d)}return a},g.Blank)})}};return k}(),q=function(a){var b=this;b.Count=function(){return a.Count()};b.Get=function(b){return c.From(a.Get(b))};b.Contains=function(b){return a.Contains(b)};b.ToEnumerable=function(){return a.ToEnumerable().Select(function(a){return new o(a.Key,a.Value)})}},o=function(b,a){this.Key=function(){return b};h.call(this,a)};o.prototype=new h;return c}()","/* jquery.sparkline 2.1.2 - http://omnipotent.net/jquery.sparkline/ \r\n** Licensed under the New BSD License - see above site for details */\r\n;\r\n(function(a,b,c){(function(a){typeof define==\"function\"&&define.amd?define([\"jquery\"],a):jQuery&&!jQuery.fn.sparkline&&a(jQuery)})(function(d){\"use strict\";var e={},f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=0;f=function(){return{common:{type:\"line\",lineColor:\"#00f\",fillColor:\"#cdf\",defaultPixelsPerValue:3,width:\"auto\",height:\"auto\",composite:!1,tagValuesAttribute:\"values\",tagOptionsPrefix:\"spark\",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:\"\",tooltipSuffix:\"\",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:\",\",numberDecimalMark:\".\",disableTooltips:!1,disableInteraction:!1},line:{spotColor:\"#f80\",highlightSpotColor:\"#5f5\",highlightLineColor:\"#f22\",spotRadius:1.5,minSpotColor:\"#f80\",maxSpotColor:\"#f80\",lineWidth:1,normalRangeMin:c,normalRangeMax:c,normalRangeColor:\"#ccc\",drawNormalOnTop:!1,chartRangeMin:c,chartRangeMax:c,chartRangeMinX:c,chartRangeMaxX:c,tooltipFormat:new h('<span style=\"color: {{color}}\">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:\"#3366cc\",negBarColor:\"#f44\",stackedBarColor:[\"#3366cc\",\"#dc3912\",\"#ff9900\",\"#109618\",\"#66aa00\",\"#dd4477\",\"#0099c6\",\"#990099\"],zeroColor:c,nullColor:c,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:c,chartRangeMin:c,chartRangeClip:!1,colorMap:c,tooltipFormat:new h('<span style=\"color: {{color}}\">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:\"#6f6\",negBarColor:\"#f44\",zeroBarColor:\"#999\",colorMap:{},tooltipFormat:new h('<span style=\"color: {{color}}\">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{\"-1\":\"Loss\",0:\"Draw\",1:\"Win\"}}},discrete:{lineHeight:\"auto\",thresholdColor:c,thresholdValue:0,chartRangeMax:c,chartRangeMin:c,chartRangeClip:!1,tooltipFormat:new h(\"{{prefix}}{{value}}{{suffix}}\")},bullet:{targetColor:\"#f33\",targetWidth:3,performanceColor:\"#33f\",rangeColors:[\"#d3dafe\",\"#a8b6ff\",\"#7f94ff\"],base:c,tooltipFormat:new h(\"{{fieldkey:fields}} - {{value}}\"),tooltipValueLookups:{fields:{r:\"Range\",p:\"Performance\",t:\"Target\"}}},pie:{offset:0,sliceColors:[\"#3366cc\",\"#dc3912\",\"#ff9900\",\"#109618\",\"#66aa00\",\"#dd4477\",\"#0099c6\",\"#990099\"],borderWidth:0,borderColor:\"#000\",tooltipFormat:new h('<span style=\"color: {{color}}\">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:\"#000\",boxFillColor:\"#cdf\",whiskerColor:\"#000\",outlierLineColor:\"#333\",outlierFillColor:\"#fff\",medianColor:\"#f00\",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:c,targetColor:\"#4a2\",chartRangeMax:c,chartRangeMin:c,tooltipFormat:new h(\"{{field:fields}}: {{value}}\"),tooltipFormatFieldlistKey:\"field\",tooltipValueLookups:{fields:{lq:\"Lower Quartile\",med:\"Median\",uq:\"Upper Quartile\",lo:\"Left Outlier\",ro:\"Right Outlier\",lw:\"Left Whisker\",rw:\"Right Whisker\"}}}}},E='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: \"progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)\";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',g=function(){var a,b;return a=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(a.prototype=d.extend(new arguments[0],arguments[arguments.length-1]),a._super=arguments[0].prototype):a.prototype=arguments[arguments.length-1],arguments.length>2&&(b=Array.prototype.slice.call(arguments,1,-1),b.unshift(a.prototype),d.extend.apply(d,b))):a.prototype=arguments[0],a.prototype.cls=a,a},d.SPFormatClass=h=g({fre:/\\{\\{([\\w.]+?)(:(.+?))?\\}\\}/g,precre:/(\\w+)\\.(\\d+)/,init:function(a,b){this.format=a,this.fclass=b},render:function(a,b,d){var e=this,f=a,g,h,i,j,k;return this.format.replace(this.fre,function(){var a;return h=arguments[1],i=arguments[3],g=e.precre.exec(h),g?(k=g[2],h=g[1]):k=!1,j=f[h],j===c?\"\":i&&b&&b[i]?(a=b[i],a.get?b[i].get(j)||j:b[i][j]||j):(n(j)&&(d.get(\"numberFormatter\")?j=d.get(\"numberFormatter\")(j):j=s(j,k,d.get(\"numberDigitGroupCount\"),d.get(\"numberDigitGroupSep\"),d.get(\"numberDecimalMark\"))),j)})}}),d.spformat=function(a,b){return new h(a,b)},i=function(a,b,c){return a<b?b:a>c?c:a},j=function(a,c){var d;return c===2?(d=b.floor(a.length/2),a.length%2?a[d]:(a[d-1]+a[d])/2):a.length%2?(d=(a.length*c+c)/4,d%1?(a[b.floor(d)]+a[b.floor(d)-1])/2:a[d-1]):(d=(a.length*c+2)/4,d%1?(a[b.floor(d)]+a[b.floor(d)-1])/2:a[d-1])},k=function(a){var b;switch(a){case\"undefined\":a=c;break;case\"null\":a=null;break;case\"true\":a=!0;break;case\"false\":a=!1;break;default:b=parseFloat(a),a==b&&(a=b)}return a},l=function(a){var b,c=[];for(b=a.length;b--;)c[b]=k(a[b]);return c},m=function(a,b){var c,d,e=[];for(c=0,d=a.length;c<d;c++)a[c]!==b&&e.push(a[c]);return e},n=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},s=function(a,b,c,e,f){var g,h;a=(b===!1?parseFloat(a).toString():a.toFixed(b)).split(\"\"),g=(g=d.inArray(\".\",a))<0?a.length:g,g<a.length&&(a[g]=f);for(h=g-c;h>0;h-=c)a.splice(h,0,e);return a.join(\"\")},o=function(a,b,c){var d;for(d=b.length;d--;){if(c&&b[d]===null)continue;if(b[d]!==a)return!1}return!0},p=function(a){var b=0,c;for(c=a.length;c--;)b+=typeof a[c]==\"number\"?a[c]:0;return b},r=function(a){return d.isArray(a)?a:[a]},q=function(b){var c;a.createStyleSheet?a.createStyleSheet().cssText=b:(c=a.createElement(\"style\"),c.type=\"text/css\",a.getElementsByTagName(\"head\")[0].appendChild(c),c[typeof a.body.style.WebkitAppearance==\"string\"?\"innerText\":\"innerHTML\"]=b)},d.fn.simpledraw=function(b,e,f,g){var h,i;if(f&&(h=this.data(\"_jqs_vcanvas\")))return h;if(d.fn.sparkline.canvas===!1)return!1;if(d.fn.sparkline.canvas===c){var j=a.createElement(\"canvas\");if(!j.getContext||!j.getContext(\"2d\")){if(!a.namespaces||!!a.namespaces.v)return d.fn.sparkline.canvas=!1,!1;a.namespaces.add(\"v\",\"urn:schemas-microsoft-com:vml\",\"#default#VML\"),d.fn.sparkline.canvas=function(a,b,c,d){return new J(a,b,c)}}else d.fn.sparkline.canvas=function(a,b,c,d){return new I(a,b,c,d)}}return b===c&&(b=d(this).innerWidth()),e===c&&(e=d(this).innerHeight()),h=d.fn.sparkline.canvas(b,e,this,g),i=d(this).data(\"_jqs_mhandler\"),i&&i.registerCanvas(h),h},d.fn.cleardraw=function(){var a=this.data(\"_jqs_vcanvas\");a&&a.reset()},d.RangeMapClass=t=g({init:function(a){var b,c,d=[];for(b in a)a.hasOwnProperty(b)&&typeof b==\"string\"&&b.indexOf(\":\")>-1&&(c=b.split(\":\"),c[0]=c[0].length===0?-Infinity:parseFloat(c[0]),c[1]=c[1].length===0?Infinity:parseFloat(c[1]),c[2]=a[b],d.push(c));this.map=a,this.rangelist=d||!1},get:function(a){var b=this.rangelist,d,e,f;if((f=this.map[a])!==c)return f;if(b)for(d=b.length;d--;){e=b[d];if(e[0]<=a&&e[1]>=a)return e[2]}return c}}),d.range_map=function(a){return new t(a)},u=g({init:function(a,b){var c=d(a);this.$el=c,this.options=b,this.currentPageX=0,this.currentPageY=0,this.el=a,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!b.get(\"disableTooltips\"),this.highlightEnabled=!b.get(\"disableHighlight\")},registerSparkline:function(a){this.splist.push(a),this.over&&this.updateDisplay()},registerCanvas:function(a){var b=d(a.canvas);this.canvas=a,this.$canvas=b,b.mouseenter(d.proxy(this.mouseenter,this)),b.mouseleave(d.proxy(this.mouseleave,this)),b.click(d.proxy(this.mouseclick,this))},reset:function(a){this.splist=[],this.tooltip&&a&&(this.tooltip.remove(),this.tooltip=c)},mouseclick:function(a){var b=d.Event(\"sparklineClick\");b.originalEvent=a,b.sparklines=this.splist,this.$el.trigger(b)},mouseenter:function(b){d(a.body).unbind(\"mousemove.jqs\"),d(a.body).bind(\"mousemove.jqs\",d.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=b.pageX,this.currentPageY=b.pageY,this.currentEl=b.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new v(this.options),this.tooltip.updatePosition(b.pageX,b.pageY)),this.updateDisplay()},mouseleave:function(){d(a.body).unbind(\"mousemove.jqs\");var b=this.splist,c=b.length,e=!1,f,g;this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null);for(g=0;g<c;g++)f=b[g],f.clearRegionHighlight()&&(e=!0);e&&this.canvas.render()},mousemove:function(a){this.currentPageX=a.pageX,this.currentPageY=a.pageY,this.currentEl=a.target,this.tooltip&&this.tooltip.updatePosition(a.pageX,a.pageY),this.updateDisplay()},updateDisplay:function(){var a=this.splist,b=a.length,c=!1,e=this.$canvas.offset(),f=this.currentPageX-e.left,g=this.currentPageY-e.top,h,i,j,k,l;if(!this.over)return;for(j=0;j<b;j++)i=a[j],k=i.setRegionHighlight(this.currentEl,f,g),k&&(c=!0);if(c){l=d.Event(\"sparklineRegionChange\"),l.sparklines=this.splist,this.$el.trigger(l);if(this.tooltip){h=\"\";for(j=0;j<b;j++)i=a[j],h+=i.getCurrentRegionTooltip();this.tooltip.setContent(h)}this.disableHighlight||this.canvas.render()}k===null&&this.mouseleave()}}),v=g({sizeStyle:\"position: static !important;display: block !important;visibility: hidden !important;float: left !important;\",init:function(b){var c=b.get(\"tooltipClassname\",\"jqstooltip\"),e=this.sizeStyle,f;this.container=b.get(\"tooltipContainer\")||a.body,this.tooltipOffsetX=b.get(\"tooltipOffsetX\",10),this.tooltipOffsetY=b.get(\"tooltipOffsetY\",12),d(\"#jqssizetip\").remove(),d(\"#jqstooltip\").remove(),this.sizetip=d(\"<div/>\",{id:\"jqssizetip\",style:e,\"class\":c}),this.tooltip=d(\"<div/>\",{id:\"jqstooltip\",\"class\":c}).appendTo(this.container),f=this.tooltip.offset(),this.offsetLeft=f.left,this.offsetTop=f.top,this.hidden=!0,d(window).unbind(\"resize.jqs scroll.jqs\"),d(window).bind(\"resize.jqs scroll.jqs\",d.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=d(window).scrollTop(),this.scrollLeft=d(window).scrollLeft(),this.scrollRight=this.scrollLeft+d(window).width(),this.updatePosition()},getSize:function(a){this.sizetip.html(a).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(a){if(!a){this.tooltip.css(\"visibility\",\"hidden\"),this.hidden=!0;return}this.getSize(a),this.tooltip.html(a).css({width:this.width,height:this.height,visibility:\"visible\"}),this.hidden&&(this.hidden=!1,this.updatePosition())},updatePosition:function(a,b){if(a===c){if(this.mousex===c)return;a=this.mousex-this.offsetLeft,b=this.mousey-this.offsetTop}else this.mousex=a-=this.offsetLeft,this.mousey=b-=this.offsetTop;if(!this.height||!this.width||this.hidden)return;b-=this.height+this.tooltipOffsetY,a+=this.tooltipOffsetX,b<this.scrollTop&&(b=this.scrollTop),a<this.scrollLeft?a=this.scrollLeft:a+this.width>this.scrollRight&&(a=this.scrollRight-this.width),this.tooltip.css({left:a,top:b})},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=c,d(window).unbind(\"resize.jqs scroll.jqs\")}}),F=function(){q(E)},d(F),K=[],d.fn.sparkline=function(b,e){return this.each(function(){var f=new d.fn.sparkline.options(this,e),g=d(this),h,i;h=function(){var e,h,i,j,k,l,m;if(b===\"html\"||b===c){m=this.getAttribute(f.get(\"tagValuesAttribute\"));if(m===c||m===null)m=g.html();e=m.replace(/(^\\s*<!--)|(-->\\s*$)|\\s+/g,\"\").split(\",\")}else e=b;h=f.get(\"width\")===\"auto\"?e.length*f.get(\"defaultPixelsPerValue\"):f.get(\"width\");if(f.get(\"height\")===\"auto\"){if(!f.get(\"composite\")||!d.data(this,\"_jqs_vcanvas\"))j=a.createElement(\"span\"),j.innerHTML=\"a\",g.html(j),i=d(j).innerHeight()||d(j).height(),d(j).remove(),j=null}else i=f.get(\"height\");f.get(\"disableInteraction\")?k=!1:(k=d.data(this,\"_jqs_mhandler\"),k?f.get(\"composite\")||k.reset():(k=new u(this,f),d.data(this,\"_jqs_mhandler\",k)));if(f.get(\"composite\")&&!d.data(this,\"_jqs_vcanvas\")){d.data(this,\"_jqs_errnotify\")||(alert(\"Attempted to attach a composite sparkline to an element with no existing sparkline\"),d.data(this,\"_jqs_errnotify\",!0));return}l=new(d.fn.sparkline[f.get(\"type\")])(this,e,f,h,i),l.render(),k&&k.registerSparkline(l)};if(d(this).html()&&!f.get(\"disableHiddenCheck\")&&d(this).is(\":hidden\")||!d(this).parents(\"body\").length){if(!f.get(\"composite\")&&d.data(this,\"_jqs_pending\"))for(i=K.length;i;i--)K[i-1][0]==this&&K.splice(i-1,1);K.push([this,h]),d.data(this,\"_jqs_pending\",!0)}else h.call(this)})},d.fn.sparkline.defaults=f(),d.sparkline_display_visible=function(){var a,b,c,e=[];for(b=0,c=K.length;b<c;b++)a=K[b][0],d(a).is(\":visible\")&&!d(a).parents().is(\":hidden\")?(K[b][1].call(a),d.data(K[b][0],\"_jqs_pending\",!1),e.push(b)):!d(a).closest(\"html\").length&&!d.data(a,\"_jqs_pending\")&&(d.data(K[b][0],\"_jqs_pending\",!1),e.push(b));for(b=e.length;b;b--)K.splice(e[b-1],1)},d.fn.sparkline.options=g({init:function(a,b){var c,f,g,h;this.userOptions=b=b||{},this.tag=a,this.tagValCache={},f=d.fn.sparkline.defaults,g=f.common,this.tagOptionsPrefix=b.enableTagOptions&&(b.tagOptionsPrefix||g.tagOptionsPrefix),h=this.getTagSetting(\"type\"),h===e?c=f[b.type||g.type]:c=f[h],this.mergedOptions=d.extend({},g,c,b)},getTagSetting:function(a){var b=this.tagOptionsPrefix,d,f,g,h;if(b===!1||b===c)return e;if(this.tagValCache.hasOwnProperty(a))d=this.tagValCache.key;else{d=this.tag.getAttribute(b+a);if(d===c||d===null)d=e;else if(d.substr(0,1)===\"[\"){d=d.substr(1,d.length-2).split(\",\");for(f=d.length;f--;)d[f]=k(d[f].replace(/(^\\s*)|(\\s*$)/g,\"\"))}else if(d.substr(0,1)===\"{\"){g=d.substr(1,d.length-2).split(\",\"),d={};for(f=g.length;f--;)h=g[f].split(\":\",2),d[h[0].replace(/(^\\s*)|(\\s*$)/g,\"\")]=k(h[1].replace(/(^\\s*)|(\\s*$)/g,\"\"))}else d=k(d);this.tagValCache.key=d}return d},get:function(a,b){var d=this.getTagSetting(a),f;return d!==e?d:(f=this.mergedOptions[a])===c?b:f}}),d.fn.sparkline._base=g({disabled:!1,init:function(a,b,e,f,g){this.el=a,this.$el=d(a),this.values=b,this.options=e,this.width=f,this.height=g,this.currentRegion=c},initTarget:function(){var a=!this.options.get(\"disableInteraction\");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get(\"composite\"),a))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML=\"\",!1):!0},getRegion:function(a,b){},setRegionHighlight:function(a,b,d){var e=this.currentRegion,f=!this.options.get(\"disableHighlight\"),g;return b>this.canvasWidth||d>this.canvasHeight||b<0||d<0?null:(g=this.getRegion(a,b,d),e!==g?(e!==c&&f&&this.removeHighlight(),this.currentRegion=g,g!==c&&f&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return this.currentRegion!==c?(this.removeHighlight(),this.currentRegion=c,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(a){},getCurrentRegionTooltip:function(){var a=this.options,b=\"\",e=[],f,g,i,j,k,l,m,n,o,p,q,r,s,t;if(this.currentRegion===c)return\"\";f=this.getCurrentRegionFields(),q=a.get(\"tooltipFormatter\");if(q)return q(this,a,f);a.get(\"tooltipChartTitle\")&&(b+='<div class=\"jqs jqstitle\">'+a.get(\"tooltipChartTitle\")+\"</div>\\n\"),g=this.options.get(\"tooltipFormat\");if(!g)return\"\";d.isArray(g)||(g=[g]),d.isArray(f)||(f=[f]),m=this.options.get(\"tooltipFormatFieldlist\"),n=this.options.get(\"tooltipFormatFieldlistKey\");if(m&&n){o=[];for(l=f.length;l--;)p=f[l][n],(t=d.inArray(p,m))!=-1&&(o[t]=f[l]);f=o}i=g.length,s=f.length;for(l=0;l<i;l++){r=g[l],typeof r==\"string\"&&(r=new h(r)),j=r.fclass||\"jqsfield\";for(t=0;t<s;t++)if(!f[t].isNull||!a.get(\"tooltipSkipNull\"))d.extend(f[t],{prefix:a.get(\"tooltipPrefix\"),suffix:a.get(\"tooltipSuffix\")}),k=r.render(f[t],a.get(\"tooltipValueLookups\"),a),e.push('<div class=\"'+j+'\">'+k+\"</div>\")}return e.length?b+e.join(\"\\n\"):\"\"},getCurrentRegionFields:function(){},calcHighlightColor:function(a,c){var d=c.get(\"highlightColor\"),e=c.get(\"highlightLighten\"),f,g,h,j;if(d)return d;if(e){f=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a);if(f){h=[],g=a.length===4?16:1;for(j=0;j<3;j++)h[j]=i(b.round(parseInt(f[j+1],16)*g*e),0,255);return\"rgb(\"+h.join(\",\")+\")\"}}return a}}),w={changeHighlight:function(a){var b=this.currentRegion,c=this.target,e=this.regionShapes[b],f;e&&(f=this.renderRegion(b,a),d.isArray(f)||d.isArray(e)?(c.replaceWithShapes(e,f),this.regionShapes[b]=d.map(f,function(a){return a.id})):(c.replaceWithShape(e,f),this.regionShapes[b]=f.id))},render:function(){var a=this.values,b=this.target,c=this.regionShapes,e,f,g,h;if(!this.cls._super.render.call(this))return;for(g=a.length;g--;){e=this.renderRegion(g);if(e)if(d.isArray(e)){f=[];for(h=e.length;h--;)e[h].append(),f.push(e[h].id);c[g]=f}else e.append(),c[g]=e.id;else c[g]=null}b.render()}},d.fn.sparkline.line=x=g(d.fn.sparkline._base,{type:\"line\",init:function(a,b,c,d,e){x._super.init.call(this,a,b,c,d,e),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(a,b,d){var e,f=this.regionMap;for(e=f.length;e--;)if(f[e]!==null&&b>=f[e][0]&&b<=f[e][1])return f[e][2];return c},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.yvalues[a]===null,x:this.xvalues[a],y:this.yvalues[a],color:this.options.get(\"lineColor\"),fillColor:this.options.get(\"fillColor\"),offset:a}},renderHighlight:function(){var a=this.currentRegion,b=this.target,d=this.vertices[a],e=this.options,f=e.get(\"spotRadius\"),g=e.get(\"highlightSpotColor\"),h=e.get(\"highlightLineColor\"),i,j;if(!d)return;f&&g&&(i=b.drawCircle(d[0],d[1],f,c,g),this.highlightSpotId=i.id,b.insertAfterShape(this.lastShapeId,i)),h&&(j=b.drawLine(d[0],this.canvasTop,d[0],this.canvasTop+this.canvasHeight,h),this.highlightLineId=j.id,b.insertAfterShape(this.lastShapeId,j))},removeHighlight:function(){var a=this.target;this.highlightSpotId&&(a.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(a.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var a=this.values,c=a.length,d=this.xvalues,e=this.yvalues,f=this.yminmax,g,h,i,j,k;for(g=0;g<c;g++)h=a[g],i=typeof a[g]==\"string\",j=typeof a[g]==\"object\"&&a[g]instanceof Array,k=i&&a[g].split(\":\"),i&&k.length===2?(d.push(Number(k[0])),e.push(Number(k[1])),f.push(Number(k[1]))):j?(d.push(h[0]),e.push(h[1]),f.push(h[1])):(d.push(g),a[g]===null||a[g]===\"null\"?e.push(null):(e.push(Number(h)),f.push(Number(h))));this.options.get(\"xvalues\")&&(d=this.options.get(\"xvalues\")),this.maxy=this.maxyorg=b.max.apply(b,f),this.miny=this.minyorg=b.min.apply(b,f),this.maxx=b.max.apply(b,d),this.minx=b.min.apply(b,d),this.xvalues=d,this.yvalues=e,this.yminmax=f},processRangeOptions:function(){var a=this.options,b=a.get(\"normalRangeMin\"),d=a.get(\"normalRangeMax\");b!==c&&(b<this.miny&&(this.miny=b),d>this.maxy&&(this.maxy=d)),a.get(\"chartRangeMin\")!==c&&(a.get(\"chartRangeClip\")||a.get(\"chartRangeMin\")<this.miny)&&(this.miny=a.get(\"chartRangeMin\")),a.get(\"chartRangeMax\")!==c&&(a.get(\"chartRangeClip\")||a.get(\"chartRangeMax\")>this.maxy)&&(this.maxy=a.get(\"chartRangeMax\")),a.get(\"chartRangeMinX\")!==c&&(a.get(\"chartRangeClipX\")||a.get(\"chartRangeMinX\")<this.minx)&&(this.minx=a.get(\"chartRangeMinX\")),a.get(\"chartRangeMaxX\")!==c&&(a.get(\"chartRangeClipX\")||a.get(\"chartRangeMaxX\")>this.maxx)&&(this.maxx=a.get(\"chartRangeMaxX\"))},drawNormalRange:function(a,d,e,f,g){var h=this.options.get(\"normalRangeMin\"),i=this.options.get(\"normalRangeMax\"),j=d+b.round(e-e*((i-this.miny)/g)),k=b.round(e*(i-h)/g);this.target.drawRect(a,j,f,k,c,this.options.get(\"normalRangeColor\")).append()},render:function(){var a=this.options,e=this.target,f=this.canvasWidth,g=this.canvasHeight,h=this.vertices,i=a.get(\"spotRadius\"),j=this.regionMap,k,l,m,n,o,p,q,r,s,u,v,w,y,z,A,B,C,D,E,F,G,H,I,J,K;if(!x._super.render.call(this))return;this.scanValues(),this.processRangeOptions(),I=this.xvalues,J=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2)return;n=o=0,k=this.maxx-this.minx===0?1:this.maxx-this.minx,l=this.maxy-this.miny===0?1:this.maxy-this.miny,m=this.yvalues.length-1,i&&(f<i*4||g<i*4)&&(i=0);if(i){G=a.get(\"highlightSpotColor\")&&!a.get(\"disableInteraction\");if(G||a.get(\"minSpotColor\")||a.get(\"spotColor\")&&J[m]===this.miny)g-=b.ceil(i);if(G||a.get(\"maxSpotColor\")||a.get(\"spotColor\")&&J[m]===this.maxy)g-=b.ceil(i),n+=b.ceil(i);if(G||(a.get(\"minSpotColor\")||a.get(\"maxSpotColor\"))&&(J[0]===this.miny||J[0]===this.maxy))o+=b.ceil(i),f-=b.ceil(i);if(G||a.get(\"spotColor\")||a.get(\"minSpotColor\")||a.get(\"maxSpotColor\")&&(J[m]===this.miny||J[m]===this.maxy))f-=b.ceil(i)}g--,a.get(\"normalRangeMin\")!==c&&!a.get(\"drawNormalOnTop\")&&this.drawNormalRange(o,n,g,f,l),q=[],r=[q],z=A=null,B=J.length;for(K=0;K<B;K++)s=I[K],v=I[K+1],u=J[K],w=o+b.round((s-this.minx)*(f/k)),y=K<B-1?o+b.round((v-this.minx)*(f/k)):f,A=w+(y-w)/2,j[K]=[z||0,A,K],z=A,u===null?K&&(J[K-1]!==null&&(q=[],r.push(q)),h.push(null)):(u<this.miny&&(u=this.miny),u>this.maxy&&(u=this.maxy),q.length||q.push([w,n+g]),p=[w,n+b.round(g-g*((u-this.miny)/l))],q.push(p),h.push(p));C=[],D=[],E=r.length;for(K=0;K<E;K++)q=r[K],q.length&&(a.get(\"fillColor\")&&(q.push([q[q.length-1][0],n+g]),D.push(q.slice(0)),q.pop()),q.length>2&&(q[0]=[q[0][0],q[1][1]]),C.push(q));E=D.length;for(K=0;K<E;K++)e.drawShape(D[K],a.get(\"fillColor\"),a.get(\"fillColor\")).append();a.get(\"normalRangeMin\")!==c&&a.get(\"drawNormalOnTop\")&&this.drawNormalRange(o,n,g,f,l),E=C.length;for(K=0;K<E;K++)e.drawShape(C[K],a.get(\"lineColor\"),c,a.get(\"lineWidth\")).append();if(i&&a.get(\"valueSpots\")){F=a.get(\"valueSpots\"),F.get===c&&(F=new t(F));for(K=0;K<B;K++)H=F.get(J[K]),H&&e.drawCircle(o+b.round((I[K]-this.minx)*(f/k)),n+b.round(g-g*((J[K]-this.miny)/l)),i,c,H).append()}i&&a.get(\"spotColor\")&&J[m]!==null&&e.drawCircle(o+b.round((I[I.length-1]-this.minx)*(f/k)),n+b.round(g-g*((J[m]-this.miny)/l)),i,c,a.get(\"spotColor\")).append(),this.maxy!==this.minyorg&&(i&&a.get(\"minSpotColor\")&&(s=I[d.inArray(this.minyorg,J)],e.drawCircle(o+b.round((s-this.minx)*(f/k)),n+b.round(g-g*((this.minyorg-this.miny)/l)),i,c,a.get(\"minSpotColor\")).append()),i&&a.get(\"maxSpotColor\")&&(s=I[d.inArray(this.maxyorg,J)],e.drawCircle(o+b.round((s-this.minx)*(f/k)),n+b.round(g-g*((this.maxyorg-this.miny)/l)),i,c,a.get(\"maxSpotColor\")).append())),this.lastShapeId=e.getLastShapeId(),this.canvasTop=n,e.render()}}),d.fn.sparkline.bar=y=g(d.fn.sparkline._base,w,{type:\"bar\",init:function(a,e,f,g,h){var j=parseInt(f.get(\"barWidth\"),10),n=parseInt(f.get(\"barSpacing\"),10),o=f.get(\"chartRangeMin\"),p=f.get(\"chartRangeMax\"),q=f.get(\"chartRangeClip\"),r=Infinity,s=-Infinity,u,v,w,x,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R;y._super.init.call(this,a,e,f,g,h);for(A=0,B=e.length;A<B;A++){O=e[A],u=typeof O==\"string\"&&O.indexOf(\":\")>-1;if(u||d.isArray(O))J=!0,u&&(O=e[A]=l(O.split(\":\"))),O=m(O,null),v=b.min.apply(b,O),w=b.max.apply(b,O),v<r&&(r=v),w>s&&(s=w)}this.stacked=J,this.regionShapes={},this.barWidth=j,this.barSpacing=n,this.totalBarWidth=j+n,this.width=g=e.length*j+(e.length-1)*n,this.initTarget(),q&&(H=o===c?-Infinity:o,I=p===c?Infinity:p),z=[],x=J?[]:z;var S=[],T=[];for(A=0,B=e.length;A<B;A++)if(J){K=e[A],e[A]=N=[],S[A]=0,x[A]=T[A]=0;for(L=0,M=K.length;L<M;L++)O=N[L]=q?i(K[L],H,I):K[L],O!==null&&(O>0&&(S[A]+=O),r<0&&s>0?O<0?T[A]+=b.abs(O):x[A]+=O:x[A]+=b.abs(O-(O<0?s:r)),z.push(O))}else O=q?i(e[A],H,I):e[A],O=e[A]=k(O),O!==null&&z.push(O);this.max=G=b.max.apply(b,z),this.min=F=b.min.apply(b,z),this.stackMax=s=J?b.max.apply(b,S):G,this.stackMin=r=J?b.min.apply(b,z):F,f.get(\"chartRangeMin\")!==c&&(f.get(\"chartRangeClip\")||f.get(\"chartRangeMin\")<F)&&(F=f.get(\"chartRangeMin\")),f.get(\"chartRangeMax\")!==c&&(f.get(\"chartRangeClip\")||f.get(\"chartRangeMax\")>G)&&(G=f.get(\"chartRangeMax\")),this.zeroAxis=D=f.get(\"zeroAxis\",!0),F<=0&&G>=0&&D?E=0:D==0?E=F:F>0?E=F:E=G,this.xaxisOffset=E,C=J?b.max.apply(b,x)+b.max.apply(b,T):G-F,this.canvasHeightEf=D&&F<0?this.canvasHeight-2:this.canvasHeight-1,F<E?(Q=J&&G>=0?s:G,P=(Q-E)/C*this.canvasHeight,P!==b.ceil(P)&&(this.canvasHeightEf-=2,P=b.ceil(P))):P=this.canvasHeight,this.yoffset=P,d.isArray(f.get(\"colorMap\"))?(this.colorMapByIndex=f.get(\"colorMap\"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=f.get(\"colorMap\"),this.colorMapByValue&&this.colorMapByValue.get===c&&(this.colorMapByValue=new t(this.colorMapByValue))),this.range=C},getRegion:function(a,d,e){var f=b.floor(d/this.totalBarWidth);return f<0||f>=this.values.length?c:f},getCurrentRegionFields:function(){var a=this.currentRegion,b=r(this.values[a]),c=[],d,e;for(e=b.length;e--;)d=b[e],c.push({isNull:d===null,value:d,color:this.calcColor(e,d,a),offset:a});return c},calcColor:function(a,b,e){var f=this.colorMapByIndex,g=this.colorMapByValue,h=this.options,i,j;return this.stacked?i=h.get(\"stackedBarColor\"):i=b<0?h.get(\"negBarColor\"):h.get(\"barColor\"),b===0&&h.get(\"zeroColor\")!==c&&(i=h.get(\"zeroColor\")),g&&(j=g.get(b))?i=j:f&&f.length>e&&(i=f[e]),d.isArray(i)?i[a%i.length]:i},renderRegion:function(a,e){var f=this.values[a],g=this.options,h=this.xaxisOffset,i=[],j=this.range,k=this.stacked,l=this.target,m=a*this.totalBarWidth,n=this.canvasHeightEf,p=this.yoffset,q,r,s,t,u,v,w,x,y,z;f=d.isArray(f)?f:[f],w=f.length,x=f[0],t=o(null,f),z=o(h,f,!0);if(t)return g.get(\"nullColor\")?(s=e?g.get(\"nullColor\"):this.calcHighlightColor(g.get(\"nullColor\"),g),q=p>0?p-1:p,l.drawRect(m,q,this.barWidth-1,0,s,s)):c;u=p;for(v=0;v<w;v++){x=f[v];if(k&&x===h){if(!z||y)continue;y=!0}j>0?r=b.floor(n*(b.abs(x-h)/j))+1:r=1,x<h||x===h&&p===0?(q=u,u+=r):(q=p-r,p-=r),s=this.calcColor(v,x,a),e&&(s=this.calcHighlightColor(s,g)),i.push(l.drawRect(m,q,this.barWidth-1,r-1,s,s))}return i.length===1?i[0]:i}}),d.fn.sparkline.tristate=z=g(d.fn.sparkline._base,w,{type:\"tristate\",init:function(a,b,e,f,g){var h=parseInt(e.get(\"barWidth\"),10),i=parseInt(e.get(\"barSpacing\"),10);z._super.init.call(this,a,b,e,f,g),this.regionShapes={},this.barWidth=h,this.barSpacing=i,this.totalBarWidth=h+i,this.values=d.map(b,Number),this.width=f=b.length*h+(b.length-1)*i,d.isArray(e.get(\"colorMap\"))?(this.colorMapByIndex=e.get(\"colorMap\"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=e.get(\"colorMap\"),this.colorMapByValue&&this.colorMapByValue.get===c&&(this.colorMapByValue=new t(this.colorMapByValue))),this.initTarget()},getRegion:function(a,c,d){return b.floor(c/this.totalBarWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===c,value:this.values[a],color:this.calcColor(this.values[a],a),offset:a}},calcColor:function(a,b){var c=this.values,d=this.options,e=this.colorMapByIndex,f=this.colorMapByValue,g,h;return f&&(h=f.get(a))?g=h:e&&e.length>b?g=e[b]:c[b]<0?g=d.get(\"negBarColor\"):c[b]>0?g=d.get(\"posBarColor\"):g=d.get(\"zeroBarColor\"),g},renderRegion:function(a,c){var d=this.values,e=this.options,f=this.target,g,h,i,j,k,l;g=f.pixelHeight,i=b.round(g/2),j=a*this.totalBarWidth,d[a]<0?(k=i,h=i-1):d[a]>0?(k=0,h=i-1):(k=i-1,h=2),l=this.calcColor(d[a],a);if(l===null)return;return c&&(l=this.calcHighlightColor(l,e)),f.drawRect(j,k,this.barWidth-1,h-1,l,l)}}),d.fn.sparkline.discrete=A=g(d.fn.sparkline._base,w,{type:\"discrete\",init:function(a,e,f,g,h){A._super.init.call(this,a,e,f,g,h),this.regionShapes={},this.values=e=d.map(e,Number),this.min=b.min.apply(b,e),this.max=b.max.apply(b,e),this.range=this.max-this.min,this.width=g=f.get(\"width\")===\"auto\"?e.length*2:this.width,this.interval=b.floor(g/e.length),this.itemWidth=g/e.length,f.get(\"chartRangeMin\")!==c&&(f.get(\"chartRangeClip\")||f.get(\"chartRangeMin\")<this.min)&&(this.min=f.get(\"chartRangeMin\")),f.get(\"chartRangeMax\")!==c&&(f.get(\"chartRangeClip\")||f.get(\"chartRangeMax\")>this.max)&&(this.max=f.get(\"chartRangeMax\")),this.initTarget(),this.target&&(this.lineHeight=f.get(\"lineHeight\")===\"auto\"?b.round(this.canvasHeight*.3):f.get(\"lineHeight\"))},getRegion:function(a,c,d){return b.floor(c/this.itemWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===c,value:this.values[a],offset:a}},renderRegion:function(a,c){var d=this.values,e=this.options,f=this.min,g=this.max,h=this.range,j=this.interval,k=this.target,l=this.canvasHeight,m=this.lineHeight,n=l-m,o,p,q,r;return p=i(d[a],f,g),r=a*j,o=b.round(n-n*((p-f)/h)),q=e.get(\"thresholdColor\")&&p<e.get(\"thresholdValue\")?e.get(\"thresholdColor\"):e.get(\"lineColor\"),c&&(q=this.calcHighlightColor(q,e)),k.drawLine(r,o,r,o+m,q)}}),d.fn.sparkline.bullet=B=g(d.fn.sparkline._base,{type:\"bullet\",init:function(a,d,e,f,g){var h,i,j;B._super.init.call(this,a,d,e,f,g),this.values=d=l(d),j=d.slice(),j[0]=j[0]===null?j[2]:j[0],j[1]=d[1]===null?j[2]:j[1],h=b.min.apply(b,d),i=b.max.apply(b,d),e.get(\"base\")===c?h=h<0?h:0:h=e.get(\"base\"),this.min=h,this.max=i,this.range=i-h,this.shapes={},this.valueShapes={},this.regiondata={},this.width=f=e.get(\"width\")===\"auto\"?\"4.0em\":f,this.target=this.$el.simpledraw(f,g,e.get(\"composite\")),d.length||(this.disabled=!0),this.initTarget()},getRegion:function(a,b,d){var e=this.target.getShapeAt(a,b,d);return e!==c&&this.shapes[e]!==c?this.shapes[e]:c},getCurrentRegionFields:function(){var a=this.currentRegion;return{fieldkey:a.substr(0,1),value:this.values[a.substr(1)],region:a}},changeHighlight:function(a){var b=this.currentRegion,c=this.valueShapes[b],d;delete this.shapes[c];switch(b.substr(0,1)){case\"r\":d=this.renderRange(b.substr(1),a);break;case\"p\":d=this.renderPerformance(a);break;case\"t\":d=this.renderTarget(a)}this.valueShapes[b]=d.id,this.shapes[d.id]=b,this.target.replaceWithShape(c,d)},renderRange:function(a,c){var d=this.values[a],e=b.round(this.canvasWidth*((d-this.min)/this.range)),f=this.options.get(\"rangeColors\")[a-2];return c&&(f=this.calcHighlightColor(f,this.options)),this.target.drawRect(0,0,e-1,this.canvasHeight-1,f,f)},renderPerformance:function(a){var c=this.values[1],d=b.round(this.canvasWidth*((c-this.min)/this.range)),e=this.options.get(\"performanceColor\");return a&&(e=this.calcHighlightColor(e,this.options)),this.target.drawRect(0,b.round(this.canvasHeight*.3),d-1,b.round(this.canvasHeight*.4)-1,e,e)},renderTarget:function(a){var c=this.values[0],d=b.round(this.canvasWidth*((c-this.min)/this.range)-this.options.get(\"targetWidth\")/2),e=b.round(this.canvasHeight*.1),f=this.canvasHeight-e*2,g=this.options.get(\"targetColor\");return a&&(g=this.calcHighlightColor(g,this.options)),this.target.drawRect(d,e,this.options.get(\"targetWidth\")-1,f-1,g,g)},render:function(){var a=this.values.length,b=this.target,c,d;if(!B._super.render.call(this))return;for(c=2;c<a;c++)d=this.renderRange(c).append(),this.shapes[d.id]=\"r\"+c,this.valueShapes[\"r\"+c]=d.id;this.values[1]!==null&&(d=this.renderPerformance().append(),this.shapes[d.id]=\"p1\",this.valueShapes.p1=d.id),this.values[0]!==null&&(d=this.renderTarget().append(),this.shapes[d.id]=\"t0\",this.valueShapes.t0=d.id),b.render()}}),d.fn.sparkline.pie=C=g(d.fn.sparkline._base,{type:\"pie\",init:function(a,c,e,f,g){var h=0,i;C._super.init.call(this,a,c,e,f,g),this.shapes={},this.valueShapes={},this.values=c=d.map(c,Number),e.get(\"width\")===\"auto\"&&(this.width=this.height);if(c.length>0)for(i=c.length;i--;)h+=c[i];this.total=h,this.initTarget(),this.radius=b.floor(b.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(a,b,d){var e=this.target.getShapeAt(a,b,d);return e!==c&&this.shapes[e]!==c?this.shapes[e]:c},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===c,value:this.values[a],percent:this.values[a]/this.total*100,color:this.options.get(\"sliceColors\")[a%this.options.get(\"sliceColors\").length],offset:a}},changeHighlight:function(a){var b=this.currentRegion,c=this.renderSlice(b,a),d=this.valueShapes[b];delete this.shapes[d],this.target.replaceWithShape(d,c),this.valueShapes[b]=c.id,this.shapes[c.id]=b},renderSlice:function(a,d){var e=this.target,f=this.options,g=this.radius,h=f.get(\"borderWidth\"),i=f.get(\"offset\"),j=2*b.PI,k=this.values,l=this.total,m=i?2*b.PI*(i/360):0,n,o,p,q,r;q=k.length;for(p=0;p<q;p++){n=m,o=m,l>0&&(o=m+j*(k[p]/l));if(a===p)return r=f.get(\"sliceColors\")[p%f.get(\"sliceColors\").length],d&&(r=this.calcHighlightColor(r,f)),e.drawPieSlice(g,g,g-h,n,o,c,r);m=o}},render:function(){var a=this.target,d=this.values,e=this.options,f=this.radius,g=e.get(\"borderWidth\"),h,i;if(!C._super.render.call(this))return;g&&a.drawCircle(f,f,b.floor(f-g/2),e.get(\"borderColor\"),c,g).append();for(i=d.length;i--;)d[i]&&(h=this.renderSlice(i).append(),this.valueShapes[i]=h.id,this.shapes[h.id]=i);a.render()}}),d.fn.sparkline.box=D=g(d.fn.sparkline._base,{type:\"box\",init:function(a,b,c,e,f){D._super.init.call(this,a,b,c,e,f),this.values=d.map(b,Number),this.width=c.get(\"width\")===\"auto\"?\"4.0em\":e,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var a=[{field:\"lq\",value:this.quartiles[0]},{field:\"med\",value:this.quartiles\r\n[1]},{field:\"uq\",value:this.quartiles[2]}];return this.loutlier!==c&&a.push({field:\"lo\",value:this.loutlier}),this.routlier!==c&&a.push({field:\"ro\",value:this.routlier}),this.lwhisker!==c&&a.push({field:\"lw\",value:this.lwhisker}),this.rwhisker!==c&&a.push({field:\"rw\",value:this.rwhisker}),a},render:function(){var a=this.target,d=this.values,e=d.length,f=this.options,g=this.canvasWidth,h=this.canvasHeight,i=f.get(\"chartRangeMin\")===c?b.min.apply(b,d):f.get(\"chartRangeMin\"),k=f.get(\"chartRangeMax\")===c?b.max.apply(b,d):f.get(\"chartRangeMax\"),l=0,m,n,o,p,q,r,s,t,u,v,w;if(!D._super.render.call(this))return;if(f.get(\"raw\"))f.get(\"showOutliers\")&&d.length>5?(n=d[0],m=d[1],p=d[2],q=d[3],r=d[4],s=d[5],t=d[6]):(m=d[0],p=d[1],q=d[2],r=d[3],s=d[4]);else{d.sort(function(a,b){return a-b}),p=j(d,1),q=j(d,2),r=j(d,3),o=r-p;if(f.get(\"showOutliers\")){m=s=c;for(u=0;u<e;u++)m===c&&d[u]>p-o*f.get(\"outlierIQR\")&&(m=d[u]),d[u]<r+o*f.get(\"outlierIQR\")&&(s=d[u]);n=d[0],t=d[e-1]}else m=d[0],s=d[e-1]}this.quartiles=[p,q,r],this.lwhisker=m,this.rwhisker=s,this.loutlier=n,this.routlier=t,w=g/(k-i+1),f.get(\"showOutliers\")&&(l=b.ceil(f.get(\"spotRadius\")),g-=2*b.ceil(f.get(\"spotRadius\")),w=g/(k-i+1),n<m&&a.drawCircle((n-i)*w+l,h/2,f.get(\"spotRadius\"),f.get(\"outlierLineColor\"),f.get(\"outlierFillColor\")).append(),t>s&&a.drawCircle((t-i)*w+l,h/2,f.get(\"spotRadius\"),f.get(\"outlierLineColor\"),f.get(\"outlierFillColor\")).append()),a.drawRect(b.round((p-i)*w+l),b.round(h*.1),b.round((r-p)*w),b.round(h*.8),f.get(\"boxLineColor\"),f.get(\"boxFillColor\")).append(),a.drawLine(b.round((m-i)*w+l),b.round(h/2),b.round((p-i)*w+l),b.round(h/2),f.get(\"lineColor\")).append(),a.drawLine(b.round((m-i)*w+l),b.round(h/4),b.round((m-i)*w+l),b.round(h-h/4),f.get(\"whiskerColor\")).append(),a.drawLine(b.round((s-i)*w+l),b.round(h/2),b.round((r-i)*w+l),b.round(h/2),f.get(\"lineColor\")).append(),a.drawLine(b.round((s-i)*w+l),b.round(h/4),b.round((s-i)*w+l),b.round(h-h/4),f.get(\"whiskerColor\")).append(),a.drawLine(b.round((q-i)*w+l),b.round(h*.1),b.round((q-i)*w+l),b.round(h*.9),f.get(\"medianColor\")).append(),f.get(\"target\")&&(v=b.ceil(f.get(\"spotRadius\")),a.drawLine(b.round((f.get(\"target\")-i)*w+l),b.round(h/2-v),b.round((f.get(\"target\")-i)*w+l),b.round(h/2+v),f.get(\"targetColor\")).append(),a.drawLine(b.round((f.get(\"target\")-i)*w+l-v),b.round(h/2),b.round((f.get(\"target\")-i)*w+l+v),b.round(h/2),f.get(\"targetColor\")).append()),a.render()}}),G=g({init:function(a,b,c,d){this.target=a,this.id=b,this.type=c,this.args=d},append:function(){return this.target.appendShape(this),this}}),H=g({_pxregex:/(\\d+)(px)?\\s*$/i,init:function(a,b,c){if(!a)return;this.width=a,this.height=b,this.target=c,this.lastShapeId=null,c[0]&&(c=c[0]),d.data(c,\"_jqs_vcanvas\",this)},drawLine:function(a,b,c,d,e,f){return this.drawShape([[a,b],[c,d]],e,f)},drawShape:function(a,b,c,d){return this._genShape(\"Shape\",[a,b,c,d])},drawCircle:function(a,b,c,d,e,f){return this._genShape(\"Circle\",[a,b,c,d,e,f])},drawPieSlice:function(a,b,c,d,e,f,g){return this._genShape(\"PieSlice\",[a,b,c,d,e,f,g])},drawRect:function(a,b,c,d,e,f){return this._genShape(\"Rect\",[a,b,c,d,e,f])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert(\"reset not implemented\")},_insert:function(a,b){d(b).html(a)},_calculatePixelDims:function(a,b,c){var e;e=this._pxregex.exec(b),e?this.pixelHeight=e[1]:this.pixelHeight=d(c).height(),e=this._pxregex.exec(a),e?this.pixelWidth=e[1]:this.pixelWidth=d(c).width()},_genShape:function(a,b){var c=L++;return b.unshift(c),new G(this,c,a,b)},appendShape:function(a){alert(\"appendShape not implemented\")},replaceWithShape:function(a,b){alert(\"replaceWithShape not implemented\")},insertAfterShape:function(a,b){alert(\"insertAfterShape not implemented\")},removeShapeId:function(a){alert(\"removeShapeId not implemented\")},getShapeAt:function(a,b,c){alert(\"getShapeAt not implemented\")},render:function(){alert(\"render not implemented\")}}),I=g(H,{init:function(b,e,f,g){I._super.init.call(this,b,e,f),this.canvas=a.createElement(\"canvas\"),f[0]&&(f=f[0]),d.data(f,\"_jqs_vcanvas\",this),d(this.canvas).css({display:\"inline-block\",width:b,height:e,verticalAlign:\"top\"}),this._insert(this.canvas,f),this._calculatePixelDims(b,e,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=g,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=c,d(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(a,b,d){var e=this.canvas.getContext(\"2d\");return a!==c&&(e.strokeStyle=a),e.lineWidth=d===c?1:d,b!==c&&(e.fillStyle=b),e},reset:function(){var a=this._getContext();a.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=c},_drawShape:function(a,b,d,e,f){var g=this._getContext(d,e,f),h,i;g.beginPath(),g.moveTo(b[0][0]+.5,b[0][1]+.5);for(h=1,i=b.length;h<i;h++)g.lineTo(b[h][0]+.5,b[h][1]+.5);d!==c&&g.stroke(),e!==c&&g.fill(),this.targetX!==c&&this.targetY!==c&&g.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawCircle:function(a,d,e,f,g,h,i){var j=this._getContext(g,h,i);j.beginPath(),j.arc(d,e,f,0,2*b.PI,!1),this.targetX!==c&&this.targetY!==c&&j.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a),g!==c&&j.stroke(),h!==c&&j.fill()},_drawPieSlice:function(a,b,d,e,f,g,h,i){var j=this._getContext(h,i);j.beginPath(),j.moveTo(b,d),j.arc(b,d,e,f,g,!1),j.lineTo(b,d),j.closePath(),h!==c&&j.stroke(),i&&j.fill(),this.targetX!==c&&this.targetY!==c&&j.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b+d,c],[b+d,c+e],[b,c+e],[b,c]],f,g)},appendShape:function(a){return this.shapes[a.id]=a,this.shapeseq.push(a.id),this.lastShapeId=a.id,a.id},replaceWithShape:function(a,b){var c=this.shapeseq,d;this.shapes[b.id]=b;for(d=c.length;d--;)c[d]==a&&(c[d]=b.id);delete this.shapes[a]},replaceWithShapes:function(a,b){var c=this.shapeseq,d={},e,f,g;for(f=a.length;f--;)d[a[f]]=!0;for(f=c.length;f--;)e=c[f],d[e]&&(c.splice(f,1),delete this.shapes[e],g=f);for(f=b.length;f--;)c.splice(g,0,b[f].id),this.shapes[b[f].id]=b[f]},insertAfterShape:function(a,b){var c=this.shapeseq,d;for(d=c.length;d--;)if(c[d]===a){c.splice(d+1,0,b.id),this.shapes[b.id]=b;return}},removeShapeId:function(a){var b=this.shapeseq,c;for(c=b.length;c--;)if(b[c]===a){b.splice(c,1);break}delete this.shapes[a]},getShapeAt:function(a,b,c){return this.targetX=b,this.targetY=c,this.render(),this.currentTargetShapeId},render:function(){var a=this.shapeseq,b=this.shapes,c=a.length,d=this._getContext(),e,f,g;d.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(g=0;g<c;g++)e=a[g],f=b[e],this[\"_draw\"+f.type].apply(this,f.args);this.interact||(this.shapes={},this.shapeseq=[])}}),J=g(H,{init:function(b,c,e){var f;J._super.init.call(this,b,c,e),e[0]&&(e=e[0]),d.data(e,\"_jqs_vcanvas\",this),this.canvas=a.createElement(\"span\"),d(this.canvas).css({display:\"inline-block\",position:\"relative\",overflow:\"hidden\",width:b,height:c,margin:\"0px\",padding:\"0px\",verticalAlign:\"top\"}),this._insert(this.canvas,e),this._calculatePixelDims(b,c,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,f='<v:group coordorigin=\"0 0\" coordsize=\"'+this.pixelWidth+\" \"+this.pixelHeight+'\"'+' style=\"position:absolute;top:0;left:0;width:'+this.pixelWidth+\"px;height=\"+this.pixelHeight+'px;\"></v:group>',this.canvas.insertAdjacentHTML(\"beforeEnd\",f),this.group=d(this.canvas).children()[0],this.rendered=!1,this.prerender=\"\"},_drawShape:function(a,b,d,e,f){var g=[],h,i,j,k,l,m,n;for(n=0,m=b.length;n<m;n++)g[n]=\"\"+b[n][0]+\",\"+b[n][1];return h=g.splice(0,1),f=f===c?1:f,i=d===c?' stroked=\"false\" ':' strokeWeight=\"'+f+'px\" strokeColor=\"'+d+'\" ',j=e===c?' filled=\"false\"':' fillColor=\"'+e+'\" filled=\"true\" ',k=g[0]===g[g.length-1]?\"x \":\"\",l='<v:shape coordorigin=\"0 0\" coordsize=\"'+this.pixelWidth+\" \"+this.pixelHeight+'\" '+' id=\"jqsshape'+a+'\" '+i+j+' style=\"position:absolute;left:0px;top:0px;height:'+this.pixelHeight+\"px;width:\"+this.pixelWidth+'px;padding:0px;margin:0px;\" '+' path=\"m '+h+\" l \"+g.join(\", \")+\" \"+k+'e\">'+\" </v:shape>\",l},_drawCircle:function(a,b,d,e,f,g,h){var i,j,k;return b-=e,d-=e,i=f===c?' stroked=\"false\" ':' strokeWeight=\"'+h+'px\" strokeColor=\"'+f+'\" ',j=g===c?' filled=\"false\"':' fillColor=\"'+g+'\" filled=\"true\" ',k='<v:oval  id=\"jqsshape'+a+'\" '+i+j+' style=\"position:absolute;top:'+d+\"px; left:\"+b+\"px; width:\"+e*2+\"px; height:\"+e*2+'px\"></v:oval>',k},_drawPieSlice:function(a,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r;if(g===h)return\"\";h-g===2*b.PI&&(g=0,h=2*b.PI),l=d+b.round(b.cos(g)*f),m=e+b.round(b.sin(g)*f),n=d+b.round(b.cos(h)*f),o=e+b.round(b.sin(h)*f);if(l===n&&m===o){if(h-g<b.PI)return\"\";l=n=d+f,m=o=e}return l===n&&m===o&&h-g<b.PI?\"\":(k=[d-f,e-f,d+f,e+f,l,m,n,o],p=i===c?' stroked=\"false\" ':' strokeWeight=\"1px\" strokeColor=\"'+i+'\" ',q=j===c?' filled=\"false\"':' fillColor=\"'+j+'\" filled=\"true\" ',r='<v:shape coordorigin=\"0 0\" coordsize=\"'+this.pixelWidth+\" \"+this.pixelHeight+'\" '+' id=\"jqsshape'+a+'\" '+p+q+' style=\"position:absolute;left:0px;top:0px;height:'+this.pixelHeight+\"px;width:\"+this.pixelWidth+'px;padding:0px;margin:0px;\" '+' path=\"m '+d+\",\"+e+\" wa \"+k.join(\", \")+' x e\">'+\" </v:shape>\",r)},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b,c+e],[b+d,c+e],[b+d,c],[b,c]],f,g)},reset:function(){this.group.innerHTML=\"\"},appendShape:function(a){var b=this[\"_draw\"+a.type].apply(this,a.args);return this.rendered?this.group.insertAdjacentHTML(\"beforeEnd\",b):this.prerender+=b,this.lastShapeId=a.id,a.id},replaceWithShape:function(a,b){var c=d(\"#jqsshape\"+a),e=this[\"_draw\"+b.type].apply(this,b.args);c[0].outerHTML=e},replaceWithShapes:function(a,b){var c=d(\"#jqsshape\"+a[0]),e=\"\",f=b.length,g;for(g=0;g<f;g++)e+=this[\"_draw\"+b[g].type].apply(this,b[g].args);c[0].outerHTML=e;for(g=1;g<a.length;g++)d(\"#jqsshape\"+a[g]).remove()},insertAfterShape:function(a,b){var c=d(\"#jqsshape\"+a),e=this[\"_draw\"+b.type].apply(this,b.args);c[0].insertAdjacentHTML(\"afterEnd\",e)},removeShapeId:function(a){var b=d(\"#jqsshape\"+a);this.group.removeChild(b[0])},getShapeAt:function(a,b,c){var d=a.id.substr(8);return d},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})})})(document,Math);","/*changed from download version - add ru-lang file to numeral.min.js*/\r\n/*!\r\n * numeral.js\r\n * version : 1.5.3\r\n * author : Adam Draper\r\n * license : MIT\r\n * http://adamwdraper.github.com/Numeral-js/\r\n */\r\n(function(){function a(a){this._value=a}function b(a,b,c,d){var e,f,g=Math.pow(10,b);return f=(c(a*g)/g).toFixed(b),d&&(e=new RegExp(\"0{1,\"+d+\"}$\"),f=f.replace(e,\"\")),f}function c(a,b,c){var d;return d=b.indexOf(\"$\")>-1?e(a,b,c):b.indexOf(\"%\")>-1?f(a,b,c):b.indexOf(\":\")>-1?g(a,b):i(a._value,b,c)}function d(a,b){var c,d,e,f,g,i=b,j=[\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"],k=!1;if(b.indexOf(\":\")>-1)a._value=h(b);else if(b===q)a._value=0;else{for(\".\"!==o[p].delimiters.decimal&&(b=b.replace(/\\./g,\"\").replace(o[p].delimiters.decimal,\".\")),c=new RegExp(\"[^a-zA-Z]\"+o[p].abbreviations.thousand+\"(?:\\\\)|(\\\\\"+o[p].currency.symbol+\")?(?:\\\\))?)?$\"),d=new RegExp(\"[^a-zA-Z]\"+o[p].abbreviations.million+\"(?:\\\\)|(\\\\\"+o[p].currency.symbol+\")?(?:\\\\))?)?$\"),e=new RegExp(\"[^a-zA-Z]\"+o[p].abbreviations.billion+\"(?:\\\\)|(\\\\\"+o[p].currency.symbol+\")?(?:\\\\))?)?$\"),f=new RegExp(\"[^a-zA-Z]\"+o[p].abbreviations.trillion+\"(?:\\\\)|(\\\\\"+o[p].currency.symbol+\")?(?:\\\\))?)?$\"),g=0;g<=j.length&&!(k=b.indexOf(j[g])>-1?Math.pow(1024,g+1):!1);g++);a._value=(k?k:1)*(i.match(c)?Math.pow(10,3):1)*(i.match(d)?Math.pow(10,6):1)*(i.match(e)?Math.pow(10,9):1)*(i.match(f)?Math.pow(10,12):1)*(b.indexOf(\"%\")>-1?.01:1)*((b.split(\"-\").length+Math.min(b.split(\"(\").length-1,b.split(\")\").length-1))%2?1:-1)*Number(b.replace(/[^0-9\\.]+/g,\"\")),a._value=k?Math.ceil(a._value):a._value}return a._value}function e(a,b,c){var d,e,f=b.indexOf(\"$\"),g=b.indexOf(\"(\"),h=b.indexOf(\"-\"),j=\"\";return b.indexOf(\" $\")>-1?(j=\" \",b=b.replace(\" $\",\"\")):b.indexOf(\"$ \")>-1?(j=\" \",b=b.replace(\"$ \",\"\")):b=b.replace(\"$\",\"\"),e=i(a._value,b,c),1>=f?e.indexOf(\"(\")>-1||e.indexOf(\"-\")>-1?(e=e.split(\"\"),d=1,(g>f||h>f)&&(d=0),e.splice(d,0,o[p].currency.symbol+j),e=e.join(\"\")):e=o[p].currency.symbol+j+e:e.indexOf(\")\")>-1?(e=e.split(\"\"),e.splice(-1,0,j+o[p].currency.symbol),e=e.join(\"\")):e=e+j+o[p].currency.symbol,e}function f(a,b,c){var d,e=\"\",f=100*a._value;return b.indexOf(\" %\")>-1?(e=\" \",b=b.replace(\" %\",\"\")):b=b.replace(\"%\",\"\"),d=i(f,b,c),d.indexOf(\")\")>-1?(d=d.split(\"\"),d.splice(-1,0,e+\"%\"),d=d.join(\"\")):d=d+e+\"%\",d}function g(a){var b=Math.floor(a._value/60/60),c=Math.floor((a._value-60*b*60)/60),d=Math.round(a._value-60*b*60-60*c);return b+\":\"+(10>c?\"0\"+c:c)+\":\"+(10>d?\"0\"+d:d)}function h(a){var b=a.split(\":\"),c=0;return 3===b.length?(c+=60*Number(b[0])*60,c+=60*Number(b[1]),c+=Number(b[2])):2===b.length&&(c+=60*Number(b[0]),c+=Number(b[1])),Number(c)}function i(a,c,d){var e,f,g,h,i,j,k=!1,l=!1,m=!1,n=\"\",r=!1,s=!1,t=!1,u=!1,v=!1,w=\"\",x=\"\",y=Math.abs(a),z=[\"B\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"],A=\"\",B=!1;if(0===a&&null!==q)return q;if(c.indexOf(\"(\")>-1?(k=!0,c=c.slice(1,-1)):c.indexOf(\"+\")>-1&&(l=!0,c=c.replace(/\\+/g,\"\")),c.indexOf(\"a\")>-1&&(r=c.indexOf(\"aK\")>=0,s=c.indexOf(\"aM\")>=0,t=c.indexOf(\"aB\")>=0,u=c.indexOf(\"aT\")>=0,v=r||s||t||u,c.indexOf(\" a\")>-1?(n=\" \",c=c.replace(\" a\",\"\")):c=c.replace(\"a\",\"\"),y>=Math.pow(10,12)&&!v||u?(n+=o[p].abbreviations.trillion,a/=Math.pow(10,12)):y<Math.pow(10,12)&&y>=Math.pow(10,9)&&!v||t?(n+=o[p].abbreviations.billion,a/=Math.pow(10,9)):y<Math.pow(10,9)&&y>=Math.pow(10,6)&&!v||s?(n+=o[p].abbreviations.million,a/=Math.pow(10,6)):(y<Math.pow(10,6)&&y>=Math.pow(10,3)&&!v||r)&&(n+=o[p].abbreviations.thousand,a/=Math.pow(10,3))),c.indexOf(\"b\")>-1)for(c.indexOf(\" b\")>-1?(w=\" \",c=c.replace(\" b\",\"\")):c=c.replace(\"b\",\"\"),g=0;g<=z.length;g++)if(e=Math.pow(1024,g),f=Math.pow(1024,g+1),a>=e&&f>a){w+=z[g],e>0&&(a/=e);break}return c.indexOf(\"o\")>-1&&(c.indexOf(\" o\")>-1?(x=\" \",c=c.replace(\" o\",\"\")):c=c.replace(\"o\",\"\"),x+=o[p].ordinal(a)),c.indexOf(\"[.]\")>-1&&(m=!0,c=c.replace(\"[.]\",\".\")),h=a.toString().split(\".\")[0],i=c.split(\".\")[1],j=c.indexOf(\",\"),i?(i.indexOf(\"[\")>-1?(i=i.replace(\"]\",\"\"),i=i.split(\"[\"),A=b(a,i[0].length+i[1].length,d,i[1].length)):A=b(a,i.length,d),h=A.split(\".\")[0],A=A.split(\".\")[1].length?o[p].delimiters.decimal+A.split(\".\")[1]:\"\",m&&0===Number(A.slice(1))&&(A=\"\")):h=b(a,null,d),h.indexOf(\"-\")>-1&&(h=h.slice(1),B=!0),j>-1&&(h=h.toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g,\"$1\"+o[p].delimiters.thousands)),0===c.indexOf(\".\")&&(h=\"\"),(k&&B?\"(\":\"\")+(!k&&B?\"-\":\"\")+(!B&&l?\"+\":\"\")+h+A+(x?x:\"\")+(n?n:\"\")+(w?w:\"\")+(k&&B?\")\":\"\")}function j(a,b){o[a]=b}function k(a){var b=a.toString().split(\".\");return b.length<2?1:Math.pow(10,b[1].length)}function l(){var a=Array.prototype.slice.call(arguments);return a.reduce(function(a,b){var c=k(a),d=k(b);return c>d?c:d},-1/0)}var m,n=\"1.5.3\",o={},p=\"en\",q=null,r=\"0,0\",s=\"undefined\"!=typeof module&&module.exports;m=function(b){return m.isNumeral(b)?b=b.value():0===b||\"undefined\"==typeof b?b=0:Number(b)||(b=m.fn.unformat(b)),new a(Number(b))},m.version=n,m.isNumeral=function(b){return b instanceof a},m.language=function(a,b){if(!a)return p;if(a&&!b){if(!o[a])throw new Error(\"Unknown language : \"+a);p=a}return(b||!o[a])&&j(a,b),m},m.languageData=function(a){if(!a)return o[p];if(!o[a])throw new Error(\"Unknown language : \"+a);return o[a]},m.language(\"en\",{delimiters:{thousands:\",\",decimal:\".\"},abbreviations:{thousand:\"k\",million:\"m\",billion:\"b\",trillion:\"t\"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?\"th\":1===b?\"st\":2===b?\"nd\":3===b?\"rd\":\"th\"},currency:{symbol:\"$\"}}),m.zeroFormat=function(a){q=\"string\"==typeof a?a:null},m.defaultFormat=function(a){r=\"string\"==typeof a?a:\"0.0\"},\"function\"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){\"use strict\";if(null===this||\"undefined\"==typeof this)throw new TypeError(\"Array.prototype.reduce called on null or undefined\");if(\"function\"!=typeof a)throw new TypeError(a+\" is not a function\");var c,d,e=this.length>>>0,f=!1;for(1<arguments.length&&(d=b,f=!0),c=0;e>c;++c)this.hasOwnProperty(c)&&(f?d=a(d,this[c],c,this):(d=this[c],f=!0));if(!f)throw new TypeError(\"Reduce of empty array with no initial value\");return d}),m.fn=a.prototype={clone:function(){return m(this)},format:function(a,b){return c(this,a?a:r,void 0!==b?b:Math.round)},unformat:function(a){return\"[object Number]\"===Object.prototype.toString.call(a)?a:d(this,a?a:r)},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){return this._value=Number(a),this},add:function(a){function b(a,b){return a+c*b}var c=l.call(null,this._value,a);return this._value=[this._value,a].reduce(b,0)/c,this},subtract:function(a){function b(a,b){return a-c*b}var c=l.call(null,this._value,a);return this._value=[a].reduce(b,this._value*c)/c,this},multiply:function(a){function b(a,b){var c=l(a,b);return a*c*b*c/(c*c)}return this._value=[this._value,a].reduce(b,1),this},divide:function(a){function b(a,b){var c=l(a,b);return a*c/(b*c)}return this._value=[this._value,a].reduce(b),this},difference:function(a){return Math.abs(m(this._value).subtract(a).value())}},s&&(module.exports=m),\"undefined\"==typeof ender&&(this.numeral=m),\"function\"==typeof define&&define.amd&&define([],function(){return m})}).call(this);\r\n/*! \r\n * numeral.js language configuration\r\n * language : russian (ru)\r\n * author : Anatoli Papirovski : https://github.com/apapirovski\r\n */\r\n!function () { var a = { delimiters: { thousands: \" \", decimal: \",\" }, abbreviations: { thousand: \"тыс.\", million: \"млн\", billion: \"млрд\", trillion: \"трлн\" }, ordinal: function () { return \".\" }, currency: { symbol: \"руб.\" } }; \"undefined\" != typeof module && module.exports && (module.exports = a), \"undefined\" != typeof window && this.numeral && this.numeral.language && this.numeral.language(\"ru\", a) }();","/*!\r\n\r\nJSZip - A Javascript class for generating and reading zip files\r\n<http://stuartk.com/jszip>\r\n\r\n(c) 2009-2014 Stuart Knightley <stuart [at] stuartk.com>\r\nDual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.\r\n\r\nJSZip uses the library pako released under the MIT license :\r\nhttps://github.com/nodeca/pako/blob/master/LICENSE\r\n*/\r\n!function(a){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=a();else if(\"function\"==typeof define&&define.amd)define([],a);else{var b;\"undefined\"!=typeof window?b=window:\"undefined\"!=typeof global?b=global:\"undefined\"!=typeof self&&(b=self),b.JSZip=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i=\"function\"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error(\"Cannot find module '\"+g+\"'\")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f=\"function\"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){\"use strict\";var d=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";c.encode=function(a){for(var b,c,e,f,g,h,i,j=\"\",k=0;k<a.length;)b=a.charCodeAt(k++),c=a.charCodeAt(k++),e=a.charCodeAt(k++),f=b>>2,g=(3&b)<<4|c>>4,h=(15&c)<<2|e>>6,i=63&e,isNaN(c)?h=i=64:isNaN(e)&&(i=64),j=j+d.charAt(f)+d.charAt(g)+d.charAt(h)+d.charAt(i);return j},c.decode=function(a){var b,c,e,f,g,h,i,j=\"\",k=0;for(a=a.replace(/[^A-Za-z0-9\\+\\/\\=]/g,\"\");k<a.length;)f=d.indexOf(a.charAt(k++)),g=d.indexOf(a.charAt(k++)),h=d.indexOf(a.charAt(k++)),i=d.indexOf(a.charAt(k++)),b=f<<2|g>>4,c=(15&g)<<4|h>>2,e=(3&h)<<6|i,j+=String.fromCharCode(b),64!=h&&(j+=String.fromCharCode(c)),64!=i&&(j+=String.fromCharCode(e));return j}},{}],2:[function(a,b){\"use strict\";function c(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}c.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},b.exports=c},{}],3:[function(a,b,c){\"use strict\";c.STORE={magic:\"\\x00\\x00\",compress:function(a){return a},uncompress:function(a){return a},compressInputType:null,uncompressInputType:null},c.DEFLATE=a(\"./flate\")},{\"./flate\":8}],4:[function(a,b){\"use strict\";var c=a(\"./utils\"),d=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];b.exports=function(a,b){if(\"undefined\"==typeof a||!a.length)return 0;var e=\"string\"!==c.getTypeOf(a);\"undefined\"==typeof b&&(b=0);var f=0,g=0,h=0;b=-1^b;for(var i=0,j=a.length;j>i;i++)h=e?a[i]:a.charCodeAt(i),g=255&(b^h),f=d[g],b=b>>>8^f;return-1^b}},{\"./utils\":21}],5:[function(a,b){\"use strict\";function c(){this.data=null,this.length=0,this.index=0}var d=a(\"./utils\");c.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<a||0>a)throw new Error(\"End of data reached (data length = \"+this.length+\", asked index = \"+a+\"). Corrupted zip ?\")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var b,c=0;for(this.checkOffset(a),b=this.index+a-1;b>=this.index;b--)c=(c<<8)+this.byteAt(b);return this.index+=a,c},readString:function(a){return d.transformTo(\"string\",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1)}},b.exports=c},{\"./utils\":21}],6:[function(a,b,c){\"use strict\";c.base64=!1,c.binary=!1,c.dir=!1,c.createFolders=!1,c.date=null,c.compression=null,c.compressionOptions=null,c.comment=null,c.unixPermissions=null,c.dosPermissions=null},{}],7:[function(a,b,c){\"use strict\";var d=a(\"./utils\");c.string2binary=function(a){return d.string2binary(a)},c.string2Uint8Array=function(a){return d.transformTo(\"uint8array\",a)},c.uint8Array2String=function(a){return d.transformTo(\"string\",a)},c.string2Blob=function(a){var b=d.transformTo(\"arraybuffer\",a);return d.arrayBuffer2Blob(b)},c.arrayBuffer2Blob=function(a){return d.arrayBuffer2Blob(a)},c.transformTo=function(a,b){return d.transformTo(a,b)},c.getTypeOf=function(a){return d.getTypeOf(a)},c.checkSupport=function(a){return d.checkSupport(a)},c.MAX_VALUE_16BITS=d.MAX_VALUE_16BITS,c.MAX_VALUE_32BITS=d.MAX_VALUE_32BITS,c.pretty=function(a){return d.pretty(a)},c.findCompression=function(a){return d.findCompression(a)},c.isRegExp=function(a){return d.isRegExp(a)}},{\"./utils\":21}],8:[function(a,b,c){\"use strict\";var d=\"undefined\"!=typeof Uint8Array&&\"undefined\"!=typeof Uint16Array&&\"undefined\"!=typeof Uint32Array,e=a(\"pako\");c.uncompressInputType=d?\"uint8array\":\"array\",c.compressInputType=d?\"uint8array\":\"array\",c.magic=\"\\b\\x00\",c.compress=function(a,b){return e.deflateRaw(a,{level:b.level||-1})},c.uncompress=function(a){return e.inflateRaw(a)}},{pako:24}],9:[function(a,b){\"use strict\";function c(a,b){return this instanceof c?(this.files={},this.comment=null,this.root=\"\",a&&this.load(a,b),void(this.clone=function(){var a=new c;for(var b in this)\"function\"!=typeof this[b]&&(a[b]=this[b]);return a})):new c(a,b)}var d=a(\"./base64\");c.prototype=a(\"./object\"),c.prototype.load=a(\"./load\"),c.support=a(\"./support\"),c.defaults=a(\"./defaults\"),c.utils=a(\"./deprecatedPublicUtils\"),c.base64={encode:function(a){return d.encode(a)},decode:function(a){return d.decode(a)}},c.compressions=a(\"./compressions\"),b.exports=c},{\"./base64\":1,\"./compressions\":3,\"./defaults\":6,\"./deprecatedPublicUtils\":7,\"./load\":10,\"./object\":13,\"./support\":17}],10:[function(a,b){\"use strict\";var c=a(\"./base64\"),d=a(\"./zipEntries\");b.exports=function(a,b){var e,f,g,h;for(b=b||{},b.base64&&(a=c.decode(a)),f=new d(a,b),e=f.files,g=0;g<e.length;g++)h=e[g],this.file(h.fileName,h.decompressed,{binary:!0,optimizedBinaryString:!0,date:h.date,dir:h.dir,comment:h.fileComment.length?h.fileComment:null,unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions,createFolders:b.createFolders});return f.zipComment.length&&(this.comment=f.zipComment),this}},{\"./base64\":1,\"./zipEntries\":22}],11:[function(a,b){(function(a){\"use strict\";b.exports=function(b,c){return new a(b,c)},b.exports.test=function(b){return a.isBuffer(b)}}).call(this,\"undefined\"!=typeof Buffer?Buffer:void 0)},{}],12:[function(a,b){\"use strict\";function c(a){this.data=a,this.length=this.data.length,this.index=0}var d=a(\"./uint8ArrayReader\");c.prototype=new d,c.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.index,this.index+a);return this.index+=a,b},b.exports=c},{\"./uint8ArrayReader\":18}],13:[function(a,b){\"use strict\";var c=a(\"./support\"),d=a(\"./utils\"),e=a(\"./crc32\"),f=a(\"./signature\"),g=a(\"./defaults\"),h=a(\"./base64\"),i=a(\"./compressions\"),j=a(\"./compressedObject\"),k=a(\"./nodeBuffer\"),l=a(\"./utf8\"),m=a(\"./stringWriter\"),n=a(\"./uint8ArrayWriter\"),o=function(a){if(a._data instanceof j&&(a._data=a._data.getContent(),a.options.binary=!0,a.options.base64=!1,\"uint8array\"===d.getTypeOf(a._data))){var b=a._data;a._data=new Uint8Array(b.length),0!==b.length&&a._data.set(b,0)}return a._data},p=function(a){var b=o(a),e=d.getTypeOf(b);return\"string\"===e?!a.options.binary&&c.nodebuffer?k(b,\"utf-8\"):a.asBinary():b},q=function(a){var b=o(this);return null===b||\"undefined\"==typeof b?\"\":(this.options.base64&&(b=h.decode(b)),b=a&&this.options.binary?D.utf8decode(b):d.transformTo(\"string\",b),a||this.options.binary||(b=d.transformTo(\"string\",D.utf8encode(b))),b)},r=function(a,b,c){this.name=a,this.dir=c.dir,this.date=c.date,this.comment=c.comment,this.unixPermissions=c.unixPermissions,this.dosPermissions=c.dosPermissions,this._data=b,this.options=c,this._initialMetadata={dir:c.dir,date:c.date}};r.prototype={asText:function(){return q.call(this,!0)},asBinary:function(){return q.call(this,!1)},asNodeBuffer:function(){var a=p(this);return d.transformTo(\"nodebuffer\",a)},asUint8Array:function(){var a=p(this);return d.transformTo(\"uint8array\",a)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var s=function(a,b){var c,d=\"\";for(c=0;b>c;c++)d+=String.fromCharCode(255&a),a>>>=8;return d},t=function(){var a,b,c={};for(a=0;a<arguments.length;a++)for(b in arguments[a])arguments[a].hasOwnProperty(b)&&\"undefined\"==typeof c[b]&&(c[b]=arguments[a][b]);return c},u=function(a){return a=a||{},a.base64!==!0||null!==a.binary&&void 0!==a.binary||(a.binary=!0),a=t(a,g),a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),a},v=function(a,b,c){var e,f=d.getTypeOf(b);if(c=u(c),\"string\"==typeof c.unixPermissions&&(c.unixPermissions=parseInt(c.unixPermissions,8)),c.unixPermissions&&16384&c.unixPermissions&&(c.dir=!0),c.dosPermissions&&16&c.dosPermissions&&(c.dir=!0),c.dir&&(a=x(a)),c.createFolders&&(e=w(a))&&y.call(this,e,!0),c.dir||null===b||\"undefined\"==typeof b)c.base64=!1,c.binary=!1,b=null,f=null;else if(\"string\"===f)c.binary&&!c.base64&&c.optimizedBinaryString!==!0&&(b=d.string2binary(b));else{if(c.base64=!1,c.binary=!0,!(f||b instanceof j))throw new Error(\"The data of '\"+a+\"' is in an unsupported format !\");\"arraybuffer\"===f&&(b=d.transformTo(\"uint8array\",b))}var g=new r(a,b,c);return this.files[a]=g,g},w=function(a){\"/\"==a.slice(-1)&&(a=a.substring(0,a.length-1));var b=a.lastIndexOf(\"/\");return b>0?a.substring(0,b):\"\"},x=function(a){return\"/\"!=a.slice(-1)&&(a+=\"/\"),a},y=function(a,b){return b=\"undefined\"!=typeof b?b:!1,a=x(a),this.files[a]||v.call(this,a,null,{dir:!0,createFolders:b}),this.files[a]},z=function(a,b,c){var f,g=new j;return a._data instanceof j?(g.uncompressedSize=a._data.uncompressedSize,g.crc32=a._data.crc32,0===g.uncompressedSize||a.dir?(b=i.STORE,g.compressedContent=\"\",g.crc32=0):a._data.compressionMethod===b.magic?g.compressedContent=a._data.getCompressedContent():(f=a._data.getContent(),g.compressedContent=b.compress(d.transformTo(b.compressInputType,f),c))):(f=p(a),(!f||0===f.length||a.dir)&&(b=i.STORE,f=\"\"),g.uncompressedSize=f.length,g.crc32=e(f),g.compressedContent=b.compress(d.transformTo(b.compressInputType,f),c)),g.compressedSize=g.compressedContent.length,g.compressionMethod=b.magic,g},A=function(a,b){var c=a;return a||(c=b?16893:33204),(65535&c)<<16},B=function(a){return 63&(a||0)},C=function(a,b,c,g,h){var i,j,k,m,n=(c.compressedContent,d.transformTo(\"string\",l.utf8encode(b.name))),o=b.comment||\"\",p=d.transformTo(\"string\",l.utf8encode(o)),q=n.length!==b.name.length,r=p.length!==o.length,t=b.options,u=\"\",v=\"\",w=\"\";k=b._initialMetadata.dir!==b.dir?b.dir:t.dir,m=b._initialMetadata.date!==b.date?b.date:t.date;var x=0,y=0;k&&(x|=16),\"UNIX\"===h?(y=798,x|=A(b.unixPermissions,k)):(y=20,x|=B(b.dosPermissions,k)),i=m.getHours(),i<<=6,i|=m.getMinutes(),i<<=5,i|=m.getSeconds()/2,j=m.getFullYear()-1980,j<<=4,j|=m.getMonth()+1,j<<=5,j|=m.getDate(),q&&(v=s(1,1)+s(e(n),4)+n,u+=\"up\"+s(v.length,2)+v),r&&(w=s(1,1)+s(this.crc32(p),4)+p,u+=\"uc\"+s(w.length,2)+w);var z=\"\";z+=\"\\n\\x00\",z+=q||r?\"\\x00\\b\":\"\\x00\\x00\",z+=c.compressionMethod,z+=s(i,2),z+=s(j,2),z+=s(c.crc32,4),z+=s(c.compressedSize,4),z+=s(c.uncompressedSize,4),z+=s(n.length,2),z+=s(u.length,2);var C=f.LOCAL_FILE_HEADER+z+n+u,D=f.CENTRAL_FILE_HEADER+s(y,2)+z+s(p.length,2)+\"\\x00\\x00\\x00\\x00\"+s(x,4)+s(g,4)+n+u+p;return{fileRecord:C,dirRecord:D,compressedObject:c}},D={load:function(){throw new Error(\"Load method is not defined. Is the file jszip-load.js included ?\")},filter:function(a){var b,c,d,e,f=[];for(b in this.files)this.files.hasOwnProperty(b)&&(d=this.files[b],e=new r(d.name,d._data,t(d.options)),c=b.slice(this.root.length,b.length),b.slice(0,this.root.length)===this.root&&a(c,e)&&f.push(e));return f},file:function(a,b,c){if(1===arguments.length){if(d.isRegExp(a)){var e=a;return this.filter(function(a,b){return!b.dir&&e.test(a)})}return this.filter(function(b,c){return!c.dir&&b===a})[0]||null}return a=this.root+a,v.call(this,a,b,c),this},folder:function(a){if(!a)return this;if(d.isRegExp(a))return this.filter(function(b,c){return c.dir&&a.test(b)});var b=this.root+a,c=y.call(this,b),e=this.clone();return e.root=c.name,e},remove:function(a){a=this.root+a;var b=this.files[a];if(b||(\"/\"!=a.slice(-1)&&(a+=\"/\"),b=this.files[a]),b&&!b.dir)delete this.files[a];else for(var c=this.filter(function(b,c){return c.name.slice(0,a.length)===a}),d=0;d<c.length;d++)delete this.files[c[d].name];return this},generate:function(a){a=t(a||{},{base64:!0,compression:\"STORE\",compressionOptions:null,type:\"base64\",platform:\"DOS\",comment:null,mimeType:\"application/zip\"}),d.checkSupport(a.type),(\"darwin\"===a.platform||\"freebsd\"===a.platform||\"linux\"===a.platform||\"sunos\"===a.platform)&&(a.platform=\"UNIX\"),\"win32\"===a.platform&&(a.platform=\"DOS\");var b,c,e=[],g=0,j=0,k=d.transformTo(\"string\",this.utf8encode(a.comment||this.comment||\"\"));for(var l in this.files)if(this.files.hasOwnProperty(l)){var o=this.files[l],p=o.options.compression||a.compression.toUpperCase(),q=i[p];if(!q)throw new Error(p+\" is not a valid compression method !\");var r=o.options.compressionOptions||a.compressionOptions||{},u=z.call(this,o,q,r),v=C.call(this,l,o,u,g,a.platform);g+=v.fileRecord.length+u.compressedSize,j+=v.dirRecord.length,e.push(v)}var w=\"\";w=f.CENTRAL_DIRECTORY_END+\"\\x00\\x00\\x00\\x00\"+s(e.length,2)+s(e.length,2)+s(j,4)+s(g,4)+s(k.length,2)+k;var x=a.type.toLowerCase();for(b=\"uint8array\"===x||\"arraybuffer\"===x||\"blob\"===x||\"nodebuffer\"===x?new n(g+j+w.length):new m(g+j+w.length),c=0;c<e.length;c++)b.append(e[c].fileRecord),b.append(e[c].compressedObject.compressedContent);for(c=0;c<e.length;c++)b.append(e[c].dirRecord);b.append(w);var y=b.finalize();switch(a.type.toLowerCase()){case\"uint8array\":case\"arraybuffer\":case\"nodebuffer\":return d.transformTo(a.type.toLowerCase(),y);case\"blob\":return d.arrayBuffer2Blob(d.transformTo(\"arraybuffer\",y),a.mimeType);case\"base64\":return a.base64?h.encode(y):y;default:return y}},crc32:function(a,b){return e(a,b)},utf8encode:function(a){return d.transformTo(\"string\",l.utf8encode(a))},utf8decode:function(a){return l.utf8decode(a)}};b.exports=D},{\"./base64\":1,\"./compressedObject\":2,\"./compressions\":3,\"./crc32\":4,\"./defaults\":6,\"./nodeBuffer\":11,\"./signature\":14,\"./stringWriter\":16,\"./support\":17,\"./uint8ArrayWriter\":19,\"./utf8\":20,\"./utils\":21}],14:[function(a,b,c){\"use strict\";c.LOCAL_FILE_HEADER=\"PK\u0003\u0004\",c.CENTRAL_FILE_HEADER=\"PK\u0001\u0002\",c.CENTRAL_DIRECTORY_END=\"PK\u0005\u0006\",c.ZIP64_CENTRAL_DIRECTORY_LOCATOR=\"PK\u0006\u0007\",c.ZIP64_CENTRAL_DIRECTORY_END=\"PK\u0006\u0006\",c.DATA_DESCRIPTOR=\"PK\u0007\\b\"},{}],15:[function(a,b){\"use strict\";function c(a,b){this.data=a,b||(this.data=e.string2binary(this.data)),this.length=this.data.length,this.index=0}var d=a(\"./dataReader\"),e=a(\"./utils\");c.prototype=new d,c.prototype.byteAt=function(a){return this.data.charCodeAt(a)},c.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)},c.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.index,this.index+a);return this.index+=a,b},b.exports=c},{\"./dataReader\":5,\"./utils\":21}],16:[function(a,b){\"use strict\";var c=a(\"./utils\"),d=function(){this.data=[]};d.prototype={append:function(a){a=c.transformTo(\"string\",a),this.data.push(a)},finalize:function(){return this.data.join(\"\")}},b.exports=d},{\"./utils\":21}],17:[function(a,b,c){(function(a){\"use strict\";if(c.base64=!0,c.array=!0,c.string=!0,c.arraybuffer=\"undefined\"!=typeof ArrayBuffer&&\"undefined\"!=typeof Uint8Array,c.nodebuffer=\"undefined\"!=typeof a,c.uint8array=\"undefined\"!=typeof Uint8Array,\"undefined\"==typeof ArrayBuffer)c.blob=!1;else{var b=new ArrayBuffer(0);try{c.blob=0===new Blob([b],{type:\"application/zip\"}).size}catch(d){try{var e=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,f=new e;f.append(b),c.blob=0===f.getBlob(\"application/zip\").size}catch(d){c.blob=!1}}}}).call(this,\"undefined\"!=typeof Buffer?Buffer:void 0)},{}],18:[function(a,b){\"use strict\";function c(a){a&&(this.data=a,this.length=this.data.length,this.index=0)}var d=a(\"./dataReader\");c.prototype=new d,c.prototype.byteAt=function(a){return this.data[a]},c.prototype.lastIndexOfSignature=function(a){for(var b=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2),e=a.charCodeAt(3),f=this.length-4;f>=0;--f)if(this.data[f]===b&&this.data[f+1]===c&&this.data[f+2]===d&&this.data[f+3]===e)return f;return-1},c.prototype.readData=function(a){if(this.checkOffset(a),0===a)return new Uint8Array(0);var b=this.data.subarray(this.index,this.index+a);return this.index+=a,b},b.exports=c},{\"./dataReader\":5}],19:[function(a,b){\"use strict\";var c=a(\"./utils\"),d=function(a){this.data=new Uint8Array(a),this.index=0};d.prototype={append:function(a){0!==a.length&&(a=c.transformTo(\"uint8array\",a),this.data.set(a,this.index),this.index+=a.length)},finalize:function(){return this.data}},b.exports=d},{\"./utils\":21}],20:[function(a,b,c){\"use strict\";for(var d=a(\"./utils\"),e=a(\"./support\"),f=a(\"./nodeBuffer\"),g=new Array(256),h=0;256>h;h++)g[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;g[254]=g[254]=1;var i=function(a){var b,c,d,f,g,h=a.length,i=0;for(f=0;h>f;f++)c=a.charCodeAt(f),55296===(64512&c)&&h>f+1&&(d=a.charCodeAt(f+1),56320===(64512&d)&&(c=65536+(c-55296<<10)+(d-56320),f++)),i+=128>c?1:2048>c?2:65536>c?3:4;for(b=e.uint8array?new Uint8Array(i):new Array(i),g=0,f=0;i>g;f++)c=a.charCodeAt(f),55296===(64512&c)&&h>f+1&&(d=a.charCodeAt(f+1),56320===(64512&d)&&(c=65536+(c-55296<<10)+(d-56320),f++)),128>c?b[g++]=c:2048>c?(b[g++]=192|c>>>6,b[g++]=128|63&c):65536>c?(b[g++]=224|c>>>12,b[g++]=128|c>>>6&63,b[g++]=128|63&c):(b[g++]=240|c>>>18,b[g++]=128|c>>>12&63,b[g++]=128|c>>>6&63,b[g++]=128|63&c);return b},j=function(a,b){var c;for(b=b||a.length,b>a.length&&(b=a.length),c=b-1;c>=0&&128===(192&a[c]);)c--;return 0>c?b:0===c?b:c+g[a[c]]>b?c:b},k=function(a){var b,c,e,f,h=a.length,i=new Array(2*h);for(c=0,b=0;h>b;)if(e=a[b++],128>e)i[c++]=e;else if(f=g[e],f>4)i[c++]=65533,b+=f-1;else{for(e&=2===f?31:3===f?15:7;f>1&&h>b;)e=e<<6|63&a[b++],f--;f>1?i[c++]=65533:65536>e?i[c++]=e:(e-=65536,i[c++]=55296|e>>10&1023,i[c++]=56320|1023&e)}return i.length!==c&&(i.subarray?i=i.subarray(0,c):i.length=c),d.applyFromCharCode(i)};c.utf8encode=function(a){return e.nodebuffer?f(a,\"utf-8\"):i(a)},c.utf8decode=function(a){if(e.nodebuffer)return d.transformTo(\"nodebuffer\",a).toString(\"utf-8\");a=d.transformTo(e.uint8array?\"uint8array\":\"array\",a);for(var b=[],c=0,f=a.length,g=65536;f>c;){var h=j(a,Math.min(c+g,f));b.push(e.uint8array?k(a.subarray(c,h)):k(a.slice(c,h))),c=h}return b.join(\"\")}},{\"./nodeBuffer\":11,\"./support\":17,\"./utils\":21}],21:[function(a,b,c){\"use strict\";function d(a){return a}function e(a,b){for(var c=0;c<a.length;++c)b[c]=255&a.charCodeAt(c);return b}function f(a){var b=65536,d=[],e=a.length,f=c.getTypeOf(a),g=0,h=!0;try{switch(f){case\"uint8array\":String.fromCharCode.apply(null,new Uint8Array(0));break;case\"nodebuffer\":String.fromCharCode.apply(null,j(0))}}catch(i){h=!1}if(!h){for(var k=\"\",l=0;l<a.length;l++)k+=String.fromCharCode(a[l]);return k}for(;e>g&&b>1;)try{d.push(\"array\"===f||\"nodebuffer\"===f?String.fromCharCode.apply(null,a.slice(g,Math.min(g+b,e))):String.fromCharCode.apply(null,a.subarray(g,Math.min(g+b,e)))),g+=b}catch(i){b=Math.floor(b/2)}return d.join(\"\")}function g(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b}var h=a(\"./support\"),i=a(\"./compressions\"),j=a(\"./nodeBuffer\");c.string2binary=function(a){for(var b=\"\",c=0;c<a.length;c++)b+=String.fromCharCode(255&a.charCodeAt(c));return b},c.arrayBuffer2Blob=function(a,b){c.checkSupport(\"blob\"),b=b||\"application/zip\";try{return new Blob([a],{type:b})}catch(d){try{var e=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,f=new e;return f.append(a),f.getBlob(b)}catch(d){throw new Error(\"Bug : can't construct the Blob.\")}}},c.applyFromCharCode=f;var k={};k.string={string:d,array:function(a){return e(a,new Array(a.length))},arraybuffer:function(a){return k.string.uint8array(a).buffer},uint8array:function(a){return e(a,new Uint8Array(a.length))},nodebuffer:function(a){return e(a,j(a.length))}},k.array={string:f,array:d,arraybuffer:function(a){return new Uint8Array(a).buffer},uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return j(a)}},k.arraybuffer={string:function(a){return f(new Uint8Array(a))},array:function(a){return g(new Uint8Array(a),new Array(a.byteLength))},arraybuffer:d,uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return j(new Uint8Array(a))}},k.uint8array={string:f,array:function(a){return g(a,new Array(a.length))},arraybuffer:function(a){return a.buffer},uint8array:d,nodebuffer:function(a){return j(a)}},k.nodebuffer={string:f,array:function(a){return g(a,new Array(a.length))},arraybuffer:function(a){return k.nodebuffer.uint8array(a).buffer},uint8array:function(a){return g(a,new Uint8Array(a.length))},nodebuffer:d},c.transformTo=function(a,b){if(b||(b=\"\"),!a)return b;c.checkSupport(a);var d=c.getTypeOf(b),e=k[d][a](b);return e},c.getTypeOf=function(a){return\"string\"==typeof a?\"string\":\"[object Array]\"===Object.prototype.toString.call(a)?\"array\":h.nodebuffer&&j.test(a)?\"nodebuffer\":h.uint8array&&a instanceof Uint8Array?\"uint8array\":h.arraybuffer&&a instanceof ArrayBuffer?\"arraybuffer\":void 0},c.checkSupport=function(a){var b=h[a.toLowerCase()];if(!b)throw new Error(a+\" is not supported by this browser\")},c.MAX_VALUE_16BITS=65535,c.MAX_VALUE_32BITS=-1,c.pretty=function(a){var b,c,d=\"\";for(c=0;c<(a||\"\").length;c++)b=a.charCodeAt(c),d+=\"\\\\x\"+(16>b?\"0\":\"\")+b.toString(16).toUpperCase();return d},c.findCompression=function(a){for(var b in i)if(i.hasOwnProperty(b)&&i[b].magic===a)return i[b];return null},c.isRegExp=function(a){return\"[object RegExp]\"===Object.prototype.toString.call(a)}},{\"./compressions\":3,\"./nodeBuffer\":11,\"./support\":17}],22:[function(a,b){\"use strict\";function c(a,b){this.files=[],this.loadOptions=b,a&&this.load(a)}var d=a(\"./stringReader\"),e=a(\"./nodeBufferReader\"),f=a(\"./uint8ArrayReader\"),g=a(\"./utils\"),h=a(\"./signature\"),i=a(\"./zipEntry\"),j=a(\"./support\"),k=a(\"./object\");c.prototype={checkSignature:function(a){var b=this.reader.readString(4);if(b!==a)throw new Error(\"Corrupted zip or bug : unexpected signature (\"+g.pretty(b)+\", expected \"+g.pretty(a)+\")\")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=k.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var a,b,c,d=this.zip64EndOfCentralSize-44,e=0;d>e;)a=this.reader.readInt(2),b=this.reader.readInt(4),c=this.reader.readString(b),this.zip64ExtensibleData[a]={id:a,length:b,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error(\"Multi-volumes zip are not supported\")},readLocalFiles:function(){var a,b;for(a=0;a<this.files.length;a++)b=this.files[a],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(h.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var a;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===h.CENTRAL_FILE_HEADER;)a=new i({zip64:this.zip64},this.loadOptions),a.readCentralPart(this.reader),this.files.push(a)},readEndOfCentral:function(){var a=this.reader.lastIndexOfSignature(h.CENTRAL_DIRECTORY_END);if(-1===a){var b=!0;try{this.reader.setIndex(0),this.checkSignature(h.LOCAL_FILE_HEADER),b=!1}catch(c){}throw new Error(b?\"Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html\":\"Corrupted zip : can't find end of central directory\")}if(this.reader.setIndex(a),this.checkSignature(h.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===g.MAX_VALUE_16BITS||this.diskWithCentralDirStart===g.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===g.MAX_VALUE_16BITS||this.centralDirRecords===g.MAX_VALUE_16BITS||this.centralDirSize===g.MAX_VALUE_32BITS||this.centralDirOffset===g.MAX_VALUE_32BITS){if(this.zip64=!0,a=this.reader.lastIndexOfSignature(h.ZIP64_CENTRAL_DIRECTORY_LOCATOR),-1===a)throw new Error(\"Corrupted zip : can't find the ZIP64 end of central directory locator\");this.reader.setIndex(a),this.checkSignature(h.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(h.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(a){var b=g.getTypeOf(a);this.reader=\"string\"!==b||j.uint8array?\"nodebuffer\"===b?new e(a):new f(g.transformTo(\"uint8array\",a)):new d(a,this.loadOptions.optimizedBinaryString)},load:function(a){this.prepareReader(a),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},b.exports=c},{\"./nodeBufferReader\":12,\"./object\":13,\"./signature\":14,\"./stringReader\":15,\"./support\":17,\"./uint8ArrayReader\":18,\"./utils\":21,\"./zipEntry\":23}],23:[function(a,b){\"use strict\";function c(a,b){this.options=a,this.loadOptions=b}var d=a(\"./stringReader\"),e=a(\"./utils\"),f=a(\"./compressedObject\"),g=a(\"./object\"),h=0,i=3;c.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},prepareCompressedContent:function(a,b,c){return function(){var d=a.index;a.setIndex(b);var e=a.readData(c);return a.setIndex(d),e}},prepareContent:function(a,b,c,d,f){return function(){var a=e.transformTo(d.uncompressInputType,this.getCompressedContent()),b=d.uncompress(a);if(b.length!==f)throw new Error(\"Bug : uncompressed data size mismatch\");return b}},readLocalPart:function(a){var b,c;if(a.skip(22),this.fileNameLength=a.readInt(2),c=a.readInt(2),this.fileName=a.readString(this.fileNameLength),a.skip(c),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error(\"Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)\");if(b=e.findCompression(this.compressionMethod),null===b)throw new Error(\"Corrupted zip : compression \"+e.pretty(this.compressionMethod)+\" unknown (inner file : \"+this.fileName+\")\");if(this.decompressed=new f,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(a,a.index,this.compressedSize,b),this.decompressed.getContent=this.prepareContent(a,a.index,this.compressedSize,b,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=e.transformTo(\"string\",this.decompressed.getContent()),g.crc32(this.decompressed)!==this.crc32))throw new Error(\"Corrupted zip : CRC32 mismatch\")},readCentralPart:function(a){if(this.versionMadeBy=a.readInt(2),this.versionNeeded=a.readInt(2),this.bitFlag=a.readInt(2),this.compressionMethod=a.readString(2),this.date=a.readDate(),this.crc32=a.readInt(4),this.compressedSize=a.readInt(4),this.uncompressedSize=a.readInt(4),this.fileNameLength=a.readInt(2),this.extraFieldsLength=a.readInt(2),this.fileCommentLength=a.readInt(2),this.diskNumberStart=a.readInt(2),this.internalFileAttributes=a.readInt(2),this.externalFileAttributes=a.readInt(4),this.localHeaderOffset=a.readInt(4),this.isEncrypted())throw new Error(\"Encrypted zip are not supported\");this.fileName=a.readString(this.fileNameLength),this.readExtraFields(a),this.parseZIP64ExtraField(a),this.fileComment=a.readString(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var a=this.versionMadeBy>>8;this.dir=16&this.externalFileAttributes?!0:!1,a===h&&(this.dosPermissions=63&this.externalFileAttributes),a===i&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||\"/\"!==this.fileName.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var a=new d(this.extraFields[1].value);this.uncompressedSize===e.MAX_VALUE_32BITS&&(this.uncompressedSize=a.readInt(8)),this.compressedSize===e.MAX_VALUE_32BITS&&(this.compressedSize=a.readInt(8)),this.localHeaderOffset===e.MAX_VALUE_32BITS&&(this.localHeaderOffset=a.readInt(8)),this.diskNumberStart===e.MAX_VALUE_32BITS&&(this.diskNumberStart=a.readInt(4))}},readExtraFields:function(a){var b,c,d,e=a.index;for(this.extraFields=this.extraFields||{};a.index<e+this.extraFieldsLength;)b=a.readInt(2),c=a.readInt(2),d=a.readString(c),this.extraFields[b]={id:b,length:c,value:d}},handleUTF8:function(){if(this.useUTF8())this.fileName=g.utf8decode(this.fileName),this.fileComment=g.utf8decode(this.fileComment);else{var a=this.findExtraFieldUnicodePath();null!==a&&(this.fileName=a);var b=this.findExtraFieldUnicodeComment();null!==b&&(this.fileComment=b)}},findExtraFieldUnicodePath:function(){var a=this.extraFields[28789];if(a){var b=new d(a.value);return 1!==b.readInt(1)?null:g.crc32(this.fileName)!==b.readInt(4)?null:g.utf8decode(b.readString(a.length-5))\r\n}return null},findExtraFieldUnicodeComment:function(){var a=this.extraFields[25461];if(a){var b=new d(a.value);return 1!==b.readInt(1)?null:g.crc32(this.fileComment)!==b.readInt(4)?null:g.utf8decode(b.readString(a.length-5))}return null}},b.exports=c},{\"./compressedObject\":2,\"./object\":13,\"./stringReader\":15,\"./utils\":21}],24:[function(a,b){\"use strict\";var c=a(\"./lib/utils/common\").assign,d=a(\"./lib/deflate\"),e=a(\"./lib/inflate\"),f=a(\"./lib/zlib/constants\"),g={};c(g,d,e,f),b.exports=g},{\"./lib/deflate\":25,\"./lib/inflate\":26,\"./lib/utils/common\":27,\"./lib/zlib/constants\":30}],25:[function(a,b,c){\"use strict\";function d(a,b){var c=new s(b);if(c.push(a,!0),c.err)throw c.msg;return c.result}function e(a,b){return b=b||{},b.raw=!0,d(a,b)}function f(a,b){return b=b||{},b.gzip=!0,d(a,b)}var g=a(\"./zlib/deflate.js\"),h=a(\"./utils/common\"),i=a(\"./utils/strings\"),j=a(\"./zlib/messages\"),k=a(\"./zlib/zstream\"),l=0,m=4,n=0,o=1,p=-1,q=0,r=8,s=function(a){this.options=h.assign({level:p,method:r,chunkSize:16384,windowBits:15,memLevel:8,strategy:q,to:\"\"},a||{});var b=this.options;b.raw&&b.windowBits>0?b.windowBits=-b.windowBits:b.gzip&&b.windowBits>0&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg=\"\",this.ended=!1,this.chunks=[],this.strm=new k,this.strm.avail_out=0;var c=g.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(c!==n)throw new Error(j[c]);b.header&&g.deflateSetHeader(this.strm,b.header)};s.prototype.push=function(a,b){var c,d,e=this.strm,f=this.options.chunkSize;if(this.ended)return!1;d=b===~~b?b:b===!0?m:l,e.input=\"string\"==typeof a?i.string2buf(a):a,e.next_in=0,e.avail_in=e.input.length;do{if(0===e.avail_out&&(e.output=new h.Buf8(f),e.next_out=0,e.avail_out=f),c=g.deflate(e,d),c!==o&&c!==n)return this.onEnd(c),this.ended=!0,!1;(0===e.avail_out||0===e.avail_in&&d===m)&&this.onData(\"string\"===this.options.to?i.buf2binstring(h.shrinkBuf(e.output,e.next_out)):h.shrinkBuf(e.output,e.next_out))}while((e.avail_in>0||0===e.avail_out)&&c!==o);return d===m?(c=g.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===n):!0},s.prototype.onData=function(a){this.chunks.push(a)},s.prototype.onEnd=function(a){a===n&&(this.result=\"string\"===this.options.to?this.chunks.join(\"\"):h.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg},c.Deflate=s,c.deflate=d,c.deflateRaw=e,c.gzip=f},{\"./utils/common\":27,\"./utils/strings\":28,\"./zlib/deflate.js\":32,\"./zlib/messages\":37,\"./zlib/zstream\":39}],26:[function(a,b,c){\"use strict\";function d(a,b){var c=new m(b);if(c.push(a,!0),c.err)throw c.msg;return c.result}function e(a,b){return b=b||{},b.raw=!0,d(a,b)}var f=a(\"./zlib/inflate.js\"),g=a(\"./utils/common\"),h=a(\"./utils/strings\"),i=a(\"./zlib/constants\"),j=a(\"./zlib/messages\"),k=a(\"./zlib/zstream\"),l=a(\"./zlib/gzheader\"),m=function(a){this.options=g.assign({chunkSize:16384,windowBits:0,to:\"\"},a||{});var b=this.options;b.raw&&b.windowBits>=0&&b.windowBits<16&&(b.windowBits=-b.windowBits,0===b.windowBits&&(b.windowBits=-15)),!(b.windowBits>=0&&b.windowBits<16)||a&&a.windowBits||(b.windowBits+=32),b.windowBits>15&&b.windowBits<48&&0===(15&b.windowBits)&&(b.windowBits|=15),this.err=0,this.msg=\"\",this.ended=!1,this.chunks=[],this.strm=new k,this.strm.avail_out=0;var c=f.inflateInit2(this.strm,b.windowBits);if(c!==i.Z_OK)throw new Error(j[c]);this.header=new l,f.inflateGetHeader(this.strm,this.header)};m.prototype.push=function(a,b){var c,d,e,j,k,l=this.strm,m=this.options.chunkSize;if(this.ended)return!1;d=b===~~b?b:b===!0?i.Z_FINISH:i.Z_NO_FLUSH,l.input=\"string\"==typeof a?h.binstring2buf(a):a,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new g.Buf8(m),l.next_out=0,l.avail_out=m),c=f.inflate(l,i.Z_NO_FLUSH),c!==i.Z_STREAM_END&&c!==i.Z_OK)return this.onEnd(c),this.ended=!0,!1;l.next_out&&(0===l.avail_out||c===i.Z_STREAM_END||0===l.avail_in&&d===i.Z_FINISH)&&(\"string\"===this.options.to?(e=h.utf8border(l.output,l.next_out),j=l.next_out-e,k=h.buf2string(l.output,e),l.next_out=j,l.avail_out=m-j,j&&g.arraySet(l.output,l.output,e,j,0),this.onData(k)):this.onData(g.shrinkBuf(l.output,l.next_out)))}while(l.avail_in>0&&c!==i.Z_STREAM_END);return c===i.Z_STREAM_END&&(d=i.Z_FINISH),d===i.Z_FINISH?(c=f.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===i.Z_OK):!0},m.prototype.onData=function(a){this.chunks.push(a)},m.prototype.onEnd=function(a){a===i.Z_OK&&(this.result=\"string\"===this.options.to?this.chunks.join(\"\"):g.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg},c.Inflate=m,c.inflate=d,c.inflateRaw=e,c.ungzip=d},{\"./utils/common\":27,\"./utils/strings\":28,\"./zlib/constants\":30,\"./zlib/gzheader\":33,\"./zlib/inflate.js\":35,\"./zlib/messages\":37,\"./zlib/zstream\":39}],27:[function(a,b,c){\"use strict\";var d=\"undefined\"!=typeof Uint8Array&&\"undefined\"!=typeof Uint16Array&&\"undefined\"!=typeof Int32Array;c.assign=function(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var c=b.shift();if(c){if(\"object\"!=typeof c)throw new TypeError(c+\"must be non-object\");for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}}return a},c.shrinkBuf=function(a,b){return a.length===b?a:a.subarray?a.subarray(0,b):(a.length=b,a)};var e={arraySet:function(a,b,c,d,e){if(b.subarray&&a.subarray)return void a.set(b.subarray(c,c+d),e);for(var f=0;d>f;f++)a[e+f]=b[c+f]},flattenChunks:function(a){var b,c,d,e,f,g;for(d=0,b=0,c=a.length;c>b;b++)d+=a[b].length;for(g=new Uint8Array(d),e=0,b=0,c=a.length;c>b;b++)f=a[b],g.set(f,e),e+=f.length;return g}},f={arraySet:function(a,b,c,d,e){for(var f=0;d>f;f++)a[e+f]=b[c+f]},flattenChunks:function(a){return[].concat.apply([],a)}};c.setTyped=function(a){a?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,c.assign(c,e)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,f))},c.setTyped(d)},{}],28:[function(a,b,c){\"use strict\";function d(a,b){if(65537>b&&(a.subarray&&g||!a.subarray&&f))return String.fromCharCode.apply(null,e.shrinkBuf(a,b));for(var c=\"\",d=0;b>d;d++)c+=String.fromCharCode(a[d]);return c}var e=a(\"./common\"),f=!0,g=!0;try{String.fromCharCode.apply(null,[0])}catch(h){f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){g=!1}for(var i=new e.Buf8(256),j=0;256>j;j++)i[j]=j>=252?6:j>=248?5:j>=240?4:j>=224?3:j>=192?2:1;i[254]=i[254]=1,c.string2buf=function(a){var b,c,d,f,g,h=a.length,i=0;for(f=0;h>f;f++)c=a.charCodeAt(f),55296===(64512&c)&&h>f+1&&(d=a.charCodeAt(f+1),56320===(64512&d)&&(c=65536+(c-55296<<10)+(d-56320),f++)),i+=128>c?1:2048>c?2:65536>c?3:4;for(b=new e.Buf8(i),g=0,f=0;i>g;f++)c=a.charCodeAt(f),55296===(64512&c)&&h>f+1&&(d=a.charCodeAt(f+1),56320===(64512&d)&&(c=65536+(c-55296<<10)+(d-56320),f++)),128>c?b[g++]=c:2048>c?(b[g++]=192|c>>>6,b[g++]=128|63&c):65536>c?(b[g++]=224|c>>>12,b[g++]=128|c>>>6&63,b[g++]=128|63&c):(b[g++]=240|c>>>18,b[g++]=128|c>>>12&63,b[g++]=128|c>>>6&63,b[g++]=128|63&c);return b},c.buf2binstring=function(a){return d(a,a.length)},c.binstring2buf=function(a){for(var b=new e.Buf8(a.length),c=0,d=b.length;d>c;c++)b[c]=a.charCodeAt(c);return b},c.buf2string=function(a,b){var c,e,f,g,h=b||a.length,j=new Array(2*h);for(e=0,c=0;h>c;)if(f=a[c++],128>f)j[e++]=f;else if(g=i[f],g>4)j[e++]=65533,c+=g-1;else{for(f&=2===g?31:3===g?15:7;g>1&&h>c;)f=f<<6|63&a[c++],g--;g>1?j[e++]=65533:65536>f?j[e++]=f:(f-=65536,j[e++]=55296|f>>10&1023,j[e++]=56320|1023&f)}return d(j,e)},c.utf8border=function(a,b){var c;for(b=b||a.length,b>a.length&&(b=a.length),c=b-1;c>=0&&128===(192&a[c]);)c--;return 0>c?b:0===c?b:c+i[a[c]]>b?c:b}},{\"./common\":27}],29:[function(a,b){\"use strict\";function c(a,b,c,d){for(var e=65535&a|0,f=a>>>16&65535|0,g=0;0!==c;){g=c>2e3?2e3:c,c-=g;do e=e+b[d++]|0,f=f+e|0;while(--g);e%=65521,f%=65521}return e|f<<16|0}b.exports=c},{}],30:[function(a,b){b.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(a,b){\"use strict\";function c(){for(var a,b=[],c=0;256>c;c++){a=c;for(var d=0;8>d;d++)a=1&a?3988292384^a>>>1:a>>>1;b[c]=a}return b}function d(a,b,c,d){var f=e,g=d+c;a=-1^a;for(var h=d;g>h;h++)a=a>>>8^f[255&(a^b[h])];return-1^a}var e=c();b.exports=d},{}],32:[function(a,b,c){\"use strict\";function d(a,b){return a.msg=G[b],b}function e(a){return(a<<1)-(a>4?9:0)}function f(a){for(var b=a.length;--b>=0;)a[b]=0}function g(a){var b=a.state,c=b.pending;c>a.avail_out&&(c=a.avail_out),0!==c&&(C.arraySet(a.output,b.pending_buf,b.pending_out,c,a.next_out),a.next_out+=c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))}function h(a,b){D._tr_flush_block(a,a.block_start>=0?a.block_start:-1,a.strstart-a.block_start,b),a.block_start=a.strstart,g(a.strm)}function i(a,b){a.pending_buf[a.pending++]=b}function j(a,b){a.pending_buf[a.pending++]=b>>>8&255,a.pending_buf[a.pending++]=255&b}function k(a,b,c,d){var e=a.avail_in;return e>d&&(e=d),0===e?0:(a.avail_in-=e,C.arraySet(b,a.input,a.next_in,e,c),1===a.state.wrap?a.adler=E(a.adler,b,e,c):2===a.state.wrap&&(a.adler=F(a.adler,b,e,c)),a.next_in+=e,a.total_in+=e,e)}function l(a,b){var c,d,e=a.max_chain_length,f=a.strstart,g=a.prev_length,h=a.nice_match,i=a.strstart>a.w_size-jb?a.strstart-(a.w_size-jb):0,j=a.window,k=a.w_mask,l=a.prev,m=a.strstart+ib,n=j[f+g-1],o=j[f+g];a.prev_length>=a.good_match&&(e>>=2),h>a.lookahead&&(h=a.lookahead);do if(c=b,j[c+g]===o&&j[c+g-1]===n&&j[c]===j[f]&&j[++c]===j[f+1]){f+=2,c++;do;while(j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&m>f);if(d=ib-(m-f),f=m-ib,d>g){if(a.match_start=b,g=d,d>=h)break;n=j[f+g-1],o=j[f+g]}}while((b=l[b&k])>i&&0!==--e);return g<=a.lookahead?g:a.lookahead}function m(a){var b,c,d,e,f,g=a.w_size;do{if(e=a.window_size-a.lookahead-a.strstart,a.strstart>=g+(g-jb)){C.arraySet(a.window,a.window,g,g,0),a.match_start-=g,a.strstart-=g,a.block_start-=g,c=a.hash_size,b=c;do d=a.head[--b],a.head[b]=d>=g?d-g:0;while(--c);c=g,b=c;do d=a.prev[--b],a.prev[b]=d>=g?d-g:0;while(--c);e+=g}if(0===a.strm.avail_in)break;if(c=k(a.strm,a.window,a.strstart+a.lookahead,e),a.lookahead+=c,a.lookahead+a.insert>=hb)for(f=a.strstart-a.insert,a.ins_h=a.window[f],a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+hb-1])&a.hash_mask,a.prev[f&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=f,f++,a.insert--,!(a.lookahead+a.insert<hb)););}while(a.lookahead<jb&&0!==a.strm.avail_in)}function n(a,b){var c=65535;for(c>a.pending_buf_size-5&&(c=a.pending_buf_size-5);;){if(a.lookahead<=1){if(m(a),0===a.lookahead&&b===H)return sb;if(0===a.lookahead)break}a.strstart+=a.lookahead,a.lookahead=0;var d=a.block_start+c;if((0===a.strstart||a.strstart>=d)&&(a.lookahead=a.strstart-d,a.strstart=d,h(a,!1),0===a.strm.avail_out))return sb;if(a.strstart-a.block_start>=a.w_size-jb&&(h(a,!1),0===a.strm.avail_out))return sb}return a.insert=0,b===K?(h(a,!0),0===a.strm.avail_out?ub:vb):a.strstart>a.block_start&&(h(a,!1),0===a.strm.avail_out)?sb:sb}function o(a,b){for(var c,d;;){if(a.lookahead<jb){if(m(a),a.lookahead<jb&&b===H)return sb;if(0===a.lookahead)break}if(c=0,a.lookahead>=hb&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+hb-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!==c&&a.strstart-c<=a.w_size-jb&&(a.match_length=l(a,c)),a.match_length>=hb)if(d=D._tr_tally(a,a.strstart-a.match_start,a.match_length-hb),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=hb){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+hb-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!==--a.match_length);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else d=D._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(d&&(h(a,!1),0===a.strm.avail_out))return sb}return a.insert=a.strstart<hb-1?a.strstart:hb-1,b===K?(h(a,!0),0===a.strm.avail_out?ub:vb):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sb:tb}function p(a,b){for(var c,d,e;;){if(a.lookahead<jb){if(m(a),a.lookahead<jb&&b===H)return sb;if(0===a.lookahead)break}if(c=0,a.lookahead>=hb&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+hb-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=hb-1,0!==c&&a.prev_length<a.max_lazy_match&&a.strstart-c<=a.w_size-jb&&(a.match_length=l(a,c),a.match_length<=5&&(a.strategy===S||a.match_length===hb&&a.strstart-a.match_start>4096)&&(a.match_length=hb-1)),a.prev_length>=hb&&a.match_length<=a.prev_length){e=a.strstart+a.lookahead-hb,d=D._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-hb),a.lookahead-=a.prev_length-1,a.prev_length-=2;do++a.strstart<=e&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+hb-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!==--a.prev_length);if(a.match_available=0,a.match_length=hb-1,a.strstart++,d&&(h(a,!1),0===a.strm.avail_out))return sb}else if(a.match_available){if(d=D._tr_tally(a,0,a.window[a.strstart-1]),d&&h(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return sb}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(d=D._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<hb-1?a.strstart:hb-1,b===K?(h(a,!0),0===a.strm.avail_out?ub:vb):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sb:tb}function q(a,b){for(var c,d,e,f,g=a.window;;){if(a.lookahead<=ib){if(m(a),a.lookahead<=ib&&b===H)return sb;if(0===a.lookahead)break}if(a.match_length=0,a.lookahead>=hb&&a.strstart>0&&(e=a.strstart-1,d=g[e],d===g[++e]&&d===g[++e]&&d===g[++e])){f=a.strstart+ib;do;while(d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&f>e);a.match_length=ib-(f-e),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(a.match_length>=hb?(c=D._tr_tally(a,1,a.match_length-hb),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(c=D._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),c&&(h(a,!1),0===a.strm.avail_out))return sb}return a.insert=0,b===K?(h(a,!0),0===a.strm.avail_out?ub:vb):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sb:tb}function r(a,b){for(var c;;){if(0===a.lookahead&&(m(a),0===a.lookahead)){if(b===H)return sb;break}if(a.match_length=0,c=D._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,c&&(h(a,!1),0===a.strm.avail_out))return sb}return a.insert=0,b===K?(h(a,!0),0===a.strm.avail_out?ub:vb):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sb:tb}function s(a){a.window_size=2*a.w_size,f(a.head),a.max_lazy_match=B[a.level].max_lazy,a.good_match=B[a.level].good_length,a.nice_match=B[a.level].nice_length,a.max_chain_length=B[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=hb-1,a.match_available=0,a.ins_h=0}function t(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new C.Buf16(2*fb),this.dyn_dtree=new C.Buf16(2*(2*db+1)),this.bl_tree=new C.Buf16(2*(2*eb+1)),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new C.Buf16(gb+1),this.heap=new C.Buf16(2*cb+1),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new C.Buf16(2*cb+1),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function u(a){var b;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=X,b=a.state,b.pending=0,b.pending_out=0,b.wrap<0&&(b.wrap=-b.wrap),b.status=b.wrap?lb:qb,a.adler=2===b.wrap?0:1,b.last_flush=H,D._tr_init(b),M):d(a,O)}function v(a){var b=u(a);return b===M&&s(a.state),b}function w(a,b){return a&&a.state?2!==a.state.wrap?O:(a.state.gzhead=b,M):O}function x(a,b,c,e,f,g){if(!a)return O;var h=1;if(b===R&&(b=6),0>e?(h=0,e=-e):e>15&&(h=2,e-=16),1>f||f>Z||c!==Y||8>e||e>15||0>b||b>9||0>g||g>V)return d(a,O);8===e&&(e=9);var i=new t;return a.state=i,i.strm=a,i.wrap=h,i.gzhead=null,i.w_bits=e,i.w_size=1<<i.w_bits,i.w_mask=i.w_size-1,i.hash_bits=f+7,i.hash_size=1<<i.hash_bits,i.hash_mask=i.hash_size-1,i.hash_shift=~~((i.hash_bits+hb-1)/hb),i.window=new C.Buf8(2*i.w_size),i.head=new C.Buf16(i.hash_size),i.prev=new C.Buf16(i.w_size),i.lit_bufsize=1<<f+6,i.pending_buf_size=4*i.lit_bufsize,i.pending_buf=new C.Buf8(i.pending_buf_size),i.d_buf=i.lit_bufsize>>1,i.l_buf=3*i.lit_bufsize,i.level=b,i.strategy=g,i.method=c,v(a)}function y(a,b){return x(a,b,Y,$,_,W)}function z(a,b){var c,h,k,l;if(!a||!a.state||b>L||0>b)return a?d(a,O):O;if(h=a.state,!a.output||!a.input&&0!==a.avail_in||h.status===rb&&b!==K)return d(a,0===a.avail_out?Q:O);if(h.strm=a,c=h.last_flush,h.last_flush=b,h.status===lb)if(2===h.wrap)a.adler=0,i(h,31),i(h,139),i(h,8),h.gzhead?(i(h,(h.gzhead.text?1:0)+(h.gzhead.hcrc?2:0)+(h.gzhead.extra?4:0)+(h.gzhead.name?8:0)+(h.gzhead.comment?16:0)),i(h,255&h.gzhead.time),i(h,h.gzhead.time>>8&255),i(h,h.gzhead.time>>16&255),i(h,h.gzhead.time>>24&255),i(h,9===h.level?2:h.strategy>=T||h.level<2?4:0),i(h,255&h.gzhead.os),h.gzhead.extra&&h.gzhead.extra.length&&(i(h,255&h.gzhead.extra.length),i(h,h.gzhead.extra.length>>8&255)),h.gzhead.hcrc&&(a.adler=F(a.adler,h.pending_buf,h.pending,0)),h.gzindex=0,h.status=mb):(i(h,0),i(h,0),i(h,0),i(h,0),i(h,0),i(h,9===h.level?2:h.strategy>=T||h.level<2?4:0),i(h,wb),h.status=qb);else{var m=Y+(h.w_bits-8<<4)<<8,n=-1;n=h.strategy>=T||h.level<2?0:h.level<6?1:6===h.level?2:3,m|=n<<6,0!==h.strstart&&(m|=kb),m+=31-m%31,h.status=qb,j(h,m),0!==h.strstart&&(j(h,a.adler>>>16),j(h,65535&a.adler)),a.adler=1}if(h.status===mb)if(h.gzhead.extra){for(k=h.pending;h.gzindex<(65535&h.gzhead.extra.length)&&(h.pending!==h.pending_buf_size||(h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending!==h.pending_buf_size));)i(h,255&h.gzhead.extra[h.gzindex]),h.gzindex++;h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),h.gzindex===h.gzhead.extra.length&&(h.gzindex=0,h.status=nb)}else h.status=nb;if(h.status===nb)if(h.gzhead.name){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.name.length?255&h.gzhead.name.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.gzindex=0,h.status=ob)}else h.status=ob;if(h.status===ob)if(h.gzhead.comment){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.comment.length?255&h.gzhead.comment.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=F(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.status=pb)}else h.status=pb;if(h.status===pb&&(h.gzhead.hcrc?(h.pending+2>h.pending_buf_size&&g(a),h.pending+2<=h.pending_buf_size&&(i(h,255&a.adler),i(h,a.adler>>8&255),a.adler=0,h.status=qb)):h.status=qb),0!==h.pending){if(g(a),0===a.avail_out)return h.last_flush=-1,M}else if(0===a.avail_in&&e(b)<=e(c)&&b!==K)return d(a,Q);if(h.status===rb&&0!==a.avail_in)return d(a,Q);if(0!==a.avail_in||0!==h.lookahead||b!==H&&h.status!==rb){var o=h.strategy===T?r(h,b):h.strategy===U?q(h,b):B[h.level].func(h,b);if((o===ub||o===vb)&&(h.status=rb),o===sb||o===ub)return 0===a.avail_out&&(h.last_flush=-1),M;if(o===tb&&(b===I?D._tr_align(h):b!==L&&(D._tr_stored_block(h,0,0,!1),b===J&&(f(h.head),0===h.lookahead&&(h.strstart=0,h.block_start=0,h.insert=0))),g(a),0===a.avail_out))return h.last_flush=-1,M}return b!==K?M:h.wrap<=0?N:(2===h.wrap?(i(h,255&a.adler),i(h,a.adler>>8&255),i(h,a.adler>>16&255),i(h,a.adler>>24&255),i(h,255&a.total_in),i(h,a.total_in>>8&255),i(h,a.total_in>>16&255),i(h,a.total_in>>24&255)):(j(h,a.adler>>>16),j(h,65535&a.adler)),g(a),h.wrap>0&&(h.wrap=-h.wrap),0!==h.pending?M:N)}function A(a){var b;return a&&a.state?(b=a.state.status,b!==lb&&b!==mb&&b!==nb&&b!==ob&&b!==pb&&b!==qb&&b!==rb?d(a,O):(a.state=null,b===qb?d(a,P):M)):O}var B,C=a(\"../utils/common\"),D=a(\"./trees\"),E=a(\"./adler32\"),F=a(\"./crc32\"),G=a(\"./messages\"),H=0,I=1,J=3,K=4,L=5,M=0,N=1,O=-2,P=-3,Q=-5,R=-1,S=1,T=2,U=3,V=4,W=0,X=2,Y=8,Z=9,$=15,_=8,ab=29,bb=256,cb=bb+1+ab,db=30,eb=19,fb=2*cb+1,gb=15,hb=3,ib=258,jb=ib+hb+1,kb=32,lb=42,mb=69,nb=73,ob=91,pb=103,qb=113,rb=666,sb=1,tb=2,ub=3,vb=4,wb=3,xb=function(a,b,c,d,e){this.good_length=a,this.max_lazy=b,this.nice_length=c,this.max_chain=d,this.func=e};B=[new xb(0,0,0,0,n),new xb(4,4,8,4,o),new xb(4,5,16,8,o),new xb(4,6,32,32,o),new xb(4,4,16,16,p),new xb(8,16,32,32,p),new xb(8,16,128,128,p),new xb(8,32,128,256,p),new xb(32,128,258,1024,p),new xb(32,258,258,4096,p)],c.deflateInit=y,c.deflateInit2=x,c.deflateReset=v,c.deflateResetKeep=u,c.deflateSetHeader=w,c.deflate=z,c.deflateEnd=A,c.deflateInfo=\"pako deflate (from Nodeca project)\"},{\"../utils/common\":27,\"./adler32\":29,\"./crc32\":31,\"./messages\":37,\"./trees\":38}],33:[function(a,b){\"use strict\";function c(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=\"\",this.comment=\"\",this.hcrc=0,this.done=!1}b.exports=c},{}],34:[function(a,b){\"use strict\";var c=30,d=12;b.exports=function(a,b){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;e=a.state,f=a.next_in,B=a.input,g=f+(a.avail_in-5),h=a.next_out,C=a.output,i=h-(b-a.avail_out),j=h+(a.avail_out-257),k=e.dmax,l=e.wsize,m=e.whave,n=e.wnext,o=e.window,p=e.hold,q=e.bits,r=e.lencode,s=e.distcode,t=(1<<e.lenbits)-1,u=(1<<e.distbits)-1;a:do{15>q&&(p+=B[f++]<<q,q+=8,p+=B[f++]<<q,q+=8),v=r[p&t];b:for(;;){if(w=v>>>24,p>>>=w,q-=w,w=v>>>16&255,0===w)C[h++]=65535&v;else{if(!(16&w)){if(0===(64&w)){v=r[(65535&v)+(p&(1<<w)-1)];continue b}if(32&w){e.mode=d;break a}a.msg=\"invalid literal/length code\",e.mode=c;break a}x=65535&v,w&=15,w&&(w>q&&(p+=B[f++]<<q,q+=8),x+=p&(1<<w)-1,p>>>=w,q-=w),15>q&&(p+=B[f++]<<q,q+=8,p+=B[f++]<<q,q+=8),v=s[p&u];c:for(;;){if(w=v>>>24,p>>>=w,q-=w,w=v>>>16&255,!(16&w)){if(0===(64&w)){v=s[(65535&v)+(p&(1<<w)-1)];continue c}a.msg=\"invalid distance code\",e.mode=c;break a}if(y=65535&v,w&=15,w>q&&(p+=B[f++]<<q,q+=8,w>q&&(p+=B[f++]<<q,q+=8)),y+=p&(1<<w)-1,y>k){a.msg=\"invalid distance too far back\",e.mode=c;break a}if(p>>>=w,q-=w,w=h-i,y>w){if(w=y-w,w>m&&e.sane){a.msg=\"invalid distance too far back\",e.mode=c;break a}if(z=0,A=o,0===n){if(z+=l-w,x>w){x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}}else if(w>n){if(z+=l+n-w,w-=n,x>w){x-=w;do C[h++]=o[z++];while(--w);if(z=0,x>n){w=n,x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}}}else if(z+=n-w,x>w){x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}for(;x>2;)C[h++]=A[z++],C[h++]=A[z++],C[h++]=A[z++],x-=3;x&&(C[h++]=A[z++],x>1&&(C[h++]=A[z++]))}else{z=h-y;do C[h++]=C[z++],C[h++]=C[z++],C[h++]=C[z++],x-=3;while(x>2);x&&(C[h++]=C[z++],x>1&&(C[h++]=C[z++]))}break}}break}}while(g>f&&j>h);x=q>>3,f-=x,q-=x<<3,p&=(1<<q)-1,a.next_in=f,a.next_out=h,a.avail_in=g>f?5+(g-f):5-(f-g),a.avail_out=j>h?257+(j-h):257-(h-j),e.hold=p,e.bits=q}},{}],35:[function(a,b,c){\"use strict\";function d(a){return(a>>>24&255)+(a>>>8&65280)+((65280&a)<<8)+((255&a)<<24)}function e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(a){var b;return a&&a.state?(b=a.state,a.total_in=a.total_out=b.total=0,a.msg=\"\",b.wrap&&(a.adler=1&b.wrap),b.mode=K,b.last=0,b.havedict=0,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new r.Buf32(ob),b.distcode=b.distdyn=new r.Buf32(pb),b.sane=1,b.back=-1,C):F}function g(a){var b;return a&&a.state?(b=a.state,b.wsize=0,b.whave=0,b.wnext=0,f(a)):F}function h(a,b){var c,d;return a&&a.state?(d=a.state,0>b?(c=0,b=-b):(c=(b>>4)+1,48>b&&(b&=15)),b&&(8>b||b>15)?F:(null!==d.window&&d.wbits!==b&&(d.window=null),d.wrap=c,d.wbits=b,g(a))):F}function i(a,b){var c,d;return a?(d=new e,a.state=d,d.window=null,c=h(a,b),c!==C&&(a.state=null),c):F}function j(a){return i(a,rb)}function k(a){if(sb){var b;for(p=new r.Buf32(512),q=new r.Buf32(32),b=0;144>b;)a.lens[b++]=8;for(;256>b;)a.lens[b++]=9;for(;280>b;)a.lens[b++]=7;for(;288>b;)a.lens[b++]=8;for(v(x,a.lens,0,288,p,0,a.work,{bits:9}),b=0;32>b;)a.lens[b++]=5;v(y,a.lens,0,32,q,0,a.work,{bits:5}),sb=!1}a.lencode=p,a.lenbits=9,a.distcode=q,a.distbits=5}function l(a,b,c,d){var e,f=a.state;return null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new r.Buf8(f.wsize)),d>=f.wsize?(r.arraySet(f.window,b,c-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(e=f.wsize-f.wnext,e>d&&(e=d),r.arraySet(f.window,b,c-d,e,f.wnext),d-=e,d?(r.arraySet(f.window,b,c-d,d,0),f.wnext=d,f.whave=f.wsize):(f.wnext+=e,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=e))),0}function m(a,b){var c,e,f,g,h,i,j,m,n,o,p,q,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab=0,Bb=new r.Buf8(4),Cb=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return F;c=a.state,c.mode===V&&(c.mode=W),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,o=i,p=j,xb=C;a:for(;;)switch(c.mode){case K:if(0===c.wrap){c.mode=W;break}for(;16>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(2&c.wrap&&35615===m){c.check=0,Bb[0]=255&m,Bb[1]=m>>>8&255,c.check=t(c.check,Bb,2,0),m=0,n=0,c.mode=L;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&m)<<8)+(m>>8))%31){a.msg=\"incorrect header check\",c.mode=lb;break}if((15&m)!==J){a.msg=\"unknown compression method\",c.mode=lb;break}if(m>>>=4,n-=4,wb=(15&m)+8,0===c.wbits)c.wbits=wb;else if(wb>c.wbits){a.msg=\"invalid window size\",c.mode=lb;break}c.dmax=1<<wb,a.adler=c.check=1,c.mode=512&m?T:V,m=0,n=0;break;case L:for(;16>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.flags=m,(255&c.flags)!==J){a.msg=\"unknown compression method\",c.mode=lb;break}if(57344&c.flags){a.msg=\"unknown header flags set\",c.mode=lb;break}c.head&&(c.head.text=m>>8&1),512&c.flags&&(Bb[0]=255&m,Bb[1]=m>>>8&255,c.check=t(c.check,Bb,2,0)),m=0,n=0,c.mode=M;case M:for(;32>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.time=m),512&c.flags&&(Bb[0]=255&m,Bb[1]=m>>>8&255,Bb[2]=m>>>16&255,Bb[3]=m>>>24&255,c.check=t(c.check,Bb,4,0)),m=0,n=0,c.mode=N;case N:for(;16>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.xflags=255&m,c.head.os=m>>8),512&c.flags&&(Bb[0]=255&m,Bb[1]=m>>>8&255,c.check=t(c.check,Bb,2,0)),m=0,n=0,c.mode=O;case O:if(1024&c.flags){for(;16>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length=m,c.head&&(c.head.extra_len=m),512&c.flags&&(Bb[0]=255&m,Bb[1]=m>>>8&255,c.check=t(c.check,Bb,2,0)),m=0,n=0}else c.head&&(c.head.extra=null);c.mode=P;case P:if(1024&c.flags&&(q=c.length,q>i&&(q=i),q&&(c.head&&(wb=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),r.arraySet(c.head.extra,e,g,q,wb)),512&c.flags&&(c.check=t(c.check,e,q,g)),i-=q,g+=q,c.length-=q),c.length))break a;c.length=0,c.mode=Q;case Q:if(2048&c.flags){if(0===i)break a;q=0;do wb=e[g+q++],c.head&&wb&&c.length<65536&&(c.head.name+=String.fromCharCode(wb));while(wb&&i>q);if(512&c.flags&&(c.check=t(c.check,e,q,g)),i-=q,g+=q,wb)break a}else c.head&&(c.head.name=null);c.length=0,c.mode=R;case R:if(4096&c.flags){if(0===i)break a;q=0;do wb=e[g+q++],c.head&&wb&&c.length<65536&&(c.head.comment+=String.fromCharCode(wb));while(wb&&i>q);if(512&c.flags&&(c.check=t(c.check,e,q,g)),i-=q,g+=q,wb)break a}else c.head&&(c.head.comment=null);c.mode=S;case S:if(512&c.flags){for(;16>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(65535&c.check)){a.msg=\"header crc mismatch\",c.mode=lb;break}m=0,n=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),a.adler=c.check=0,c.mode=V;break;case T:for(;32>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}a.adler=c.check=d(m),m=0,n=0,c.mode=U;case U:if(0===c.havedict)return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,E;a.adler=c.check=1,c.mode=V;case V:if(b===A||b===B)break a;case W:if(c.last){m>>>=7&n,n-=7&n,c.mode=ib;break}for(;3>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}switch(c.last=1&m,m>>>=1,n-=1,3&m){case 0:c.mode=X;break;case 1:if(k(c),c.mode=bb,b===B){m>>>=2,n-=2;break a}break;case 2:c.mode=$;break;case 3:a.msg=\"invalid block type\",c.mode=lb}m>>>=2,n-=2;break;case X:for(m>>>=7&n,n-=7&n;32>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if((65535&m)!==(m>>>16^65535)){a.msg=\"invalid stored block lengths\",c.mode=lb;break}if(c.length=65535&m,m=0,n=0,c.mode=Y,b===B)break a;case Y:c.mode=Z;case Z:if(q=c.length){if(q>i&&(q=i),q>j&&(q=j),0===q)break a;r.arraySet(f,e,g,q,h),i-=q,g+=q,j-=q,h+=q,c.length-=q;break}c.mode=V;break;case $:for(;14>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.nlen=(31&m)+257,m>>>=5,n-=5,c.ndist=(31&m)+1,m>>>=5,n-=5,c.ncode=(15&m)+4,m>>>=4,n-=4,c.nlen>286||c.ndist>30){a.msg=\"too many length or distance symbols\",c.mode=lb;break}c.have=0,c.mode=_;case _:for(;c.have<c.ncode;){for(;3>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.lens[Cb[c.have++]]=7&m,m>>>=3,n-=3}for(;c.have<19;)c.lens[Cb[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,yb={bits:c.lenbits},xb=v(w,c.lens,0,19,c.lencode,0,c.work,yb),c.lenbits=yb.bits,xb){a.msg=\"invalid code lengths set\",c.mode=lb;break}c.have=0,c.mode=ab;case ab:for(;c.have<c.nlen+c.ndist;){for(;Ab=c.lencode[m&(1<<c.lenbits)-1],qb=Ab>>>24,rb=Ab>>>16&255,sb=65535&Ab,!(n>=qb);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(16>sb)m>>>=qb,n-=qb,c.lens[c.have++]=sb;else{if(16===sb){for(zb=qb+2;zb>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m>>>=qb,n-=qb,0===c.have){a.msg=\"invalid bit length repeat\",c.mode=lb;break}wb=c.lens[c.have-1],q=3+(3&m),m>>>=2,n-=2}else if(17===sb){for(zb=qb+3;zb>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qb,n-=qb,wb=0,q=3+(7&m),m>>>=3,n-=3}else{for(zb=qb+7;zb>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qb,n-=qb,wb=0,q=11+(127&m),m>>>=7,n-=7}if(c.have+q>c.nlen+c.ndist){a.msg=\"invalid bit length repeat\",c.mode=lb;break}for(;q--;)c.lens[c.have++]=wb}}if(c.mode===lb)break;if(0===c.lens[256]){a.msg=\"invalid code -- missing end-of-block\",c.mode=lb;break}if(c.lenbits=9,yb={bits:c.lenbits},xb=v(x,c.lens,0,c.nlen,c.lencode,0,c.work,yb),c.lenbits=yb.bits,xb){a.msg=\"invalid literal/lengths set\",c.mode=lb;break}if(c.distbits=6,c.distcode=c.distdyn,yb={bits:c.distbits},xb=v(y,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,yb),c.distbits=yb.bits,xb){a.msg=\"invalid distances set\",c.mode=lb;break}if(c.mode=bb,b===B)break a;case bb:c.mode=cb;case cb:if(i>=6&&j>=258){a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,u(a,p),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,c.mode===V&&(c.back=-1);\r\nbreak}for(c.back=0;Ab=c.lencode[m&(1<<c.lenbits)-1],qb=Ab>>>24,rb=Ab>>>16&255,sb=65535&Ab,!(n>=qb);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(rb&&0===(240&rb)){for(tb=qb,ub=rb,vb=sb;Ab=c.lencode[vb+((m&(1<<tb+ub)-1)>>tb)],qb=Ab>>>24,rb=Ab>>>16&255,sb=65535&Ab,!(n>=tb+qb);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=tb,n-=tb,c.back+=tb}if(m>>>=qb,n-=qb,c.back+=qb,c.length=sb,0===rb){c.mode=hb;break}if(32&rb){c.back=-1,c.mode=V;break}if(64&rb){a.msg=\"invalid literal/length code\",c.mode=lb;break}c.extra=15&rb,c.mode=db;case db:if(c.extra){for(zb=c.extra;zb>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=eb;case eb:for(;Ab=c.distcode[m&(1<<c.distbits)-1],qb=Ab>>>24,rb=Ab>>>16&255,sb=65535&Ab,!(n>=qb);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(0===(240&rb)){for(tb=qb,ub=rb,vb=sb;Ab=c.distcode[vb+((m&(1<<tb+ub)-1)>>tb)],qb=Ab>>>24,rb=Ab>>>16&255,sb=65535&Ab,!(n>=tb+qb);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=tb,n-=tb,c.back+=tb}if(m>>>=qb,n-=qb,c.back+=qb,64&rb){a.msg=\"invalid distance code\",c.mode=lb;break}c.offset=sb,c.extra=15&rb,c.mode=fb;case fb:if(c.extra){for(zb=c.extra;zb>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.offset+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){a.msg=\"invalid distance too far back\",c.mode=lb;break}c.mode=gb;case gb:if(0===j)break a;if(q=p-j,c.offset>q){if(q=c.offset-q,q>c.whave&&c.sane){a.msg=\"invalid distance too far back\",c.mode=lb;break}q>c.wnext?(q-=c.wnext,ob=c.wsize-q):ob=c.wnext-q,q>c.length&&(q=c.length),pb=c.window}else pb=f,ob=h-c.offset,q=c.length;q>j&&(q=j),j-=q,c.length-=q;do f[h++]=pb[ob++];while(--q);0===c.length&&(c.mode=cb);break;case hb:if(0===j)break a;f[h++]=c.length,j--,c.mode=cb;break;case ib:if(c.wrap){for(;32>n;){if(0===i)break a;i--,m|=e[g++]<<n,n+=8}if(p-=j,a.total_out+=p,c.total+=p,p&&(a.adler=c.check=c.flags?t(c.check,f,p,h-p):s(c.check,f,p,h-p)),p=j,(c.flags?m:d(m))!==c.check){a.msg=\"incorrect data check\",c.mode=lb;break}m=0,n=0}c.mode=jb;case jb:if(c.wrap&&c.flags){for(;32>n;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(4294967295&c.total)){a.msg=\"incorrect length check\",c.mode=lb;break}m=0,n=0}c.mode=kb;case kb:xb=D;break a;case lb:xb=G;break a;case mb:return H;case nb:default:return F}return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,(c.wsize||p!==a.avail_out&&c.mode<lb&&(c.mode<ib||b!==z))&&l(a,a.output,a.next_out,p-a.avail_out)?(c.mode=mb,H):(o-=a.avail_in,p-=a.avail_out,a.total_in+=o,a.total_out+=p,c.total+=p,c.wrap&&p&&(a.adler=c.check=c.flags?t(c.check,f,p,a.next_out-p):s(c.check,f,p,a.next_out-p)),a.data_type=c.bits+(c.last?64:0)+(c.mode===V?128:0)+(c.mode===bb||c.mode===Y?256:0),(0===o&&0===p||b===z)&&xb===C&&(xb=I),xb)}function n(a){if(!a||!a.state)return F;var b=a.state;return b.window&&(b.window=null),a.state=null,C}function o(a,b){var c;return a&&a.state?(c=a.state,0===(2&c.wrap)?F:(c.head=b,b.done=!1,C)):F}var p,q,r=a(\"../utils/common\"),s=a(\"./adler32\"),t=a(\"./crc32\"),u=a(\"./inffast\"),v=a(\"./inftrees\"),w=0,x=1,y=2,z=4,A=5,B=6,C=0,D=1,E=2,F=-2,G=-3,H=-4,I=-5,J=8,K=1,L=2,M=3,N=4,O=5,P=6,Q=7,R=8,S=9,T=10,U=11,V=12,W=13,X=14,Y=15,Z=16,$=17,_=18,ab=19,bb=20,cb=21,db=22,eb=23,fb=24,gb=25,hb=26,ib=27,jb=28,kb=29,lb=30,mb=31,nb=32,ob=852,pb=592,qb=15,rb=qb,sb=!0;c.inflateReset=g,c.inflateReset2=h,c.inflateResetKeep=f,c.inflateInit=j,c.inflateInit2=i,c.inflate=m,c.inflateEnd=n,c.inflateGetHeader=o,c.inflateInfo=\"pako inflate (from Nodeca project)\"},{\"../utils/common\":27,\"./adler32\":29,\"./crc32\":31,\"./inffast\":34,\"./inftrees\":36}],36:[function(a,b){\"use strict\";var c=a(\"../utils/common\"),d=15,e=852,f=592,g=0,h=1,i=2,j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],k=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];b.exports=function(a,b,n,o,p,q,r,s){var t,u,v,w,x,y,z,A,B,C=s.bits,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=null,O=0,P=new c.Buf16(d+1),Q=new c.Buf16(d+1),R=null,S=0;for(D=0;d>=D;D++)P[D]=0;for(E=0;o>E;E++)P[b[n+E]]++;for(H=C,G=d;G>=1&&0===P[G];G--);if(H>G&&(H=G),0===G)return p[q++]=20971520,p[q++]=20971520,s.bits=1,0;for(F=1;G>F&&0===P[F];F++);for(F>H&&(H=F),K=1,D=1;d>=D;D++)if(K<<=1,K-=P[D],0>K)return-1;if(K>0&&(a===g||1!==G))return-1;for(Q[1]=0,D=1;d>D;D++)Q[D+1]=Q[D]+P[D];for(E=0;o>E;E++)0!==b[n+E]&&(r[Q[b[n+E]]++]=E);if(a===g?(N=R=r,y=19):a===h?(N=j,O-=257,R=k,S-=257,y=256):(N=l,R=m,y=-1),M=0,E=0,D=F,x=q,I=H,J=0,v=-1,L=1<<H,w=L-1,a===h&&L>e||a===i&&L>f)return 1;for(var T=0;;){T++,z=D-J,r[E]<y?(A=0,B=r[E]):r[E]>y?(A=R[S+r[E]],B=N[O+r[E]]):(A=96,B=0),t=1<<D-J,u=1<<I,F=u;do u-=t,p[x+(M>>J)+u]=z<<24|A<<16|B|0;while(0!==u);for(t=1<<D-1;M&t;)t>>=1;if(0!==t?(M&=t-1,M+=t):M=0,E++,0===--P[D]){if(D===G)break;D=b[n+r[E]]}if(D>H&&(M&w)!==v){for(0===J&&(J=H),x+=F,I=D-J,K=1<<I;G>I+J&&(K-=P[I+J],!(0>=K));)I++,K<<=1;if(L+=1<<I,a===h&&L>e||a===i&&L>f)return 1;v=M&w,p[v]=H<<24|I<<16|x-q|0}}return 0!==M&&(p[x+M]=D-J<<24|64<<16|0),s.bits=H,0}},{\"../utils/common\":27}],37:[function(a,b){\"use strict\";b.exports={2:\"need dictionary\",1:\"stream end\",0:\"\",\"-1\":\"file error\",\"-2\":\"stream error\",\"-3\":\"data error\",\"-4\":\"insufficient memory\",\"-5\":\"buffer error\",\"-6\":\"incompatible version\"}},{}],38:[function(a,b,c){\"use strict\";function d(a){for(var b=a.length;--b>=0;)a[b]=0}function e(a){return 256>a?gb[a]:gb[256+(a>>>7)]}function f(a,b){a.pending_buf[a.pending++]=255&b,a.pending_buf[a.pending++]=b>>>8&255}function g(a,b,c){a.bi_valid>V-c?(a.bi_buf|=b<<a.bi_valid&65535,f(a,a.bi_buf),a.bi_buf=b>>V-a.bi_valid,a.bi_valid+=c-V):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function h(a,b,c){g(a,c[2*b],c[2*b+1])}function i(a,b){var c=0;do c|=1&a,a>>>=1,c<<=1;while(--b>0);return c>>>1}function j(a){16===a.bi_valid?(f(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)}function k(a,b){var c,d,e,f,g,h,i=b.dyn_tree,j=b.max_code,k=b.stat_desc.static_tree,l=b.stat_desc.has_stree,m=b.stat_desc.extra_bits,n=b.stat_desc.extra_base,o=b.stat_desc.max_length,p=0;for(f=0;U>=f;f++)a.bl_count[f]=0;for(i[2*a.heap[a.heap_max]+1]=0,c=a.heap_max+1;T>c;c++)d=a.heap[c],f=i[2*i[2*d+1]+1]+1,f>o&&(f=o,p++),i[2*d+1]=f,d>j||(a.bl_count[f]++,g=0,d>=n&&(g=m[d-n]),h=i[2*d],a.opt_len+=h*(f+g),l&&(a.static_len+=h*(k[2*d+1]+g)));if(0!==p){do{for(f=o-1;0===a.bl_count[f];)f--;a.bl_count[f]--,a.bl_count[f+1]+=2,a.bl_count[o]--,p-=2}while(p>0);for(f=o;0!==f;f--)for(d=a.bl_count[f];0!==d;)e=a.heap[--c],e>j||(i[2*e+1]!==f&&(a.opt_len+=(f-i[2*e+1])*i[2*e],i[2*e+1]=f),d--)}}function l(a,b,c){var d,e,f=new Array(U+1),g=0;for(d=1;U>=d;d++)f[d]=g=g+c[d-1]<<1;for(e=0;b>=e;e++){var h=a[2*e+1];0!==h&&(a[2*e]=i(f[h]++,h))}}function m(){var a,b,c,d,e,f=new Array(U+1);for(c=0,d=0;O-1>d;d++)for(ib[d]=c,a=0;a<1<<_[d];a++)hb[c++]=d;for(hb[c-1]=d,e=0,d=0;16>d;d++)for(jb[d]=e,a=0;a<1<<ab[d];a++)gb[e++]=d;for(e>>=7;R>d;d++)for(jb[d]=e<<7,a=0;a<1<<ab[d]-7;a++)gb[256+e++]=d;for(b=0;U>=b;b++)f[b]=0;for(a=0;143>=a;)eb[2*a+1]=8,a++,f[8]++;for(;255>=a;)eb[2*a+1]=9,a++,f[9]++;for(;279>=a;)eb[2*a+1]=7,a++,f[7]++;for(;287>=a;)eb[2*a+1]=8,a++,f[8]++;for(l(eb,Q+1,f),a=0;R>a;a++)fb[2*a+1]=5,fb[2*a]=i(a,5);kb=new nb(eb,_,P+1,Q,U),lb=new nb(fb,ab,0,R,U),mb=new nb(new Array(0),bb,0,S,W)}function n(a){var b;for(b=0;Q>b;b++)a.dyn_ltree[2*b]=0;for(b=0;R>b;b++)a.dyn_dtree[2*b]=0;for(b=0;S>b;b++)a.bl_tree[2*b]=0;a.dyn_ltree[2*X]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0}function o(a){a.bi_valid>8?f(a,a.bi_buf):a.bi_valid>0&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function p(a,b,c,d){o(a),d&&(f(a,c),f(a,~c)),E.arraySet(a.pending_buf,a.window,b,c,a.pending),a.pending+=c}function q(a,b,c,d){var e=2*b,f=2*c;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function r(a,b,c){for(var d=a.heap[c],e=c<<1;e<=a.heap_len&&(e<a.heap_len&&q(b,a.heap[e+1],a.heap[e],a.depth)&&e++,!q(b,d,a.heap[e],a.depth));)a.heap[c]=a.heap[e],c=e,e<<=1;a.heap[c]=d}function s(a,b,c){var d,f,i,j,k=0;if(0!==a.last_lit)do d=a.pending_buf[a.d_buf+2*k]<<8|a.pending_buf[a.d_buf+2*k+1],f=a.pending_buf[a.l_buf+k],k++,0===d?h(a,f,b):(i=hb[f],h(a,i+P+1,b),j=_[i],0!==j&&(f-=ib[i],g(a,f,j)),d--,i=e(d),h(a,i,c),j=ab[i],0!==j&&(d-=jb[i],g(a,d,j)));while(k<a.last_lit);h(a,X,b)}function t(a,b){var c,d,e,f=b.dyn_tree,g=b.stat_desc.static_tree,h=b.stat_desc.has_stree,i=b.stat_desc.elems,j=-1;for(a.heap_len=0,a.heap_max=T,c=0;i>c;c++)0!==f[2*c]?(a.heap[++a.heap_len]=j=c,a.depth[c]=0):f[2*c+1]=0;for(;a.heap_len<2;)e=a.heap[++a.heap_len]=2>j?++j:0,f[2*e]=1,a.depth[e]=0,a.opt_len--,h&&(a.static_len-=g[2*e+1]);for(b.max_code=j,c=a.heap_len>>1;c>=1;c--)r(a,f,c);e=i;do c=a.heap[1],a.heap[1]=a.heap[a.heap_len--],r(a,f,1),d=a.heap[1],a.heap[--a.heap_max]=c,a.heap[--a.heap_max]=d,f[2*e]=f[2*c]+f[2*d],a.depth[e]=(a.depth[c]>=a.depth[d]?a.depth[c]:a.depth[d])+1,f[2*c+1]=f[2*d+1]=e,a.heap[1]=e++,r(a,f,1);while(a.heap_len>=2);a.heap[--a.heap_max]=a.heap[1],k(a,b),l(f,j,a.bl_count)}function u(a,b,c){var d,e,f=-1,g=b[1],h=0,i=7,j=4;for(0===g&&(i=138,j=3),b[2*(c+1)+1]=65535,d=0;c>=d;d++)e=g,g=b[2*(d+1)+1],++h<i&&e===g||(j>h?a.bl_tree[2*e]+=h:0!==e?(e!==f&&a.bl_tree[2*e]++,a.bl_tree[2*Y]++):10>=h?a.bl_tree[2*Z]++:a.bl_tree[2*$]++,h=0,f=e,0===g?(i=138,j=3):e===g?(i=6,j=3):(i=7,j=4))}function v(a,b,c){var d,e,f=-1,i=b[1],j=0,k=7,l=4;for(0===i&&(k=138,l=3),d=0;c>=d;d++)if(e=i,i=b[2*(d+1)+1],!(++j<k&&e===i)){if(l>j){do h(a,e,a.bl_tree);while(0!==--j)}else 0!==e?(e!==f&&(h(a,e,a.bl_tree),j--),h(a,Y,a.bl_tree),g(a,j-3,2)):10>=j?(h(a,Z,a.bl_tree),g(a,j-3,3)):(h(a,$,a.bl_tree),g(a,j-11,7));j=0,f=e,0===i?(k=138,l=3):e===i?(k=6,l=3):(k=7,l=4)}}function w(a){var b;for(u(a,a.dyn_ltree,a.l_desc.max_code),u(a,a.dyn_dtree,a.d_desc.max_code),t(a,a.bl_desc),b=S-1;b>=3&&0===a.bl_tree[2*cb[b]+1];b--);return a.opt_len+=3*(b+1)+5+5+4,b}function x(a,b,c,d){var e;for(g(a,b-257,5),g(a,c-1,5),g(a,d-4,4),e=0;d>e;e++)g(a,a.bl_tree[2*cb[e]+1],3);v(a,a.dyn_ltree,b-1),v(a,a.dyn_dtree,c-1)}function y(a){var b,c=4093624447;for(b=0;31>=b;b++,c>>>=1)if(1&c&&0!==a.dyn_ltree[2*b])return G;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return H;for(b=32;P>b;b++)if(0!==a.dyn_ltree[2*b])return H;return G}function z(a){pb||(m(),pb=!0),a.l_desc=new ob(a.dyn_ltree,kb),a.d_desc=new ob(a.dyn_dtree,lb),a.bl_desc=new ob(a.bl_tree,mb),a.bi_buf=0,a.bi_valid=0,n(a)}function A(a,b,c,d){g(a,(J<<1)+(d?1:0),3),p(a,b,c,!0)}function B(a){g(a,K<<1,3),h(a,X,eb),j(a)}function C(a,b,c,d){var e,f,h=0;a.level>0?(a.strm.data_type===I&&(a.strm.data_type=y(a)),t(a,a.l_desc),t(a,a.d_desc),h=w(a),e=a.opt_len+3+7>>>3,f=a.static_len+3+7>>>3,e>=f&&(e=f)):e=f=c+5,e>=c+4&&-1!==b?A(a,b,c,d):a.strategy===F||f===e?(g(a,(K<<1)+(d?1:0),3),s(a,eb,fb)):(g(a,(L<<1)+(d?1:0),3),x(a,a.l_desc.max_code+1,a.d_desc.max_code+1,h+1),s(a,a.dyn_ltree,a.dyn_dtree)),n(a),d&&o(a)}function D(a,b,c){return a.pending_buf[a.d_buf+2*a.last_lit]=b>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&b,a.pending_buf[a.l_buf+a.last_lit]=255&c,a.last_lit++,0===b?a.dyn_ltree[2*c]++:(a.matches++,b--,a.dyn_ltree[2*(hb[c]+P+1)]++,a.dyn_dtree[2*e(b)]++),a.last_lit===a.lit_bufsize-1}var E=a(\"../utils/common\"),F=4,G=0,H=1,I=2,J=0,K=1,L=2,M=3,N=258,O=29,P=256,Q=P+1+O,R=30,S=19,T=2*Q+1,U=15,V=16,W=7,X=256,Y=16,Z=17,$=18,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ab=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],bb=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],cb=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],db=512,eb=new Array(2*(Q+2));d(eb);var fb=new Array(2*R);d(fb);var gb=new Array(db);d(gb);var hb=new Array(N-M+1);d(hb);var ib=new Array(O);d(ib);var jb=new Array(R);d(jb);var kb,lb,mb,nb=function(a,b,c,d,e){this.static_tree=a,this.extra_bits=b,this.extra_base=c,this.elems=d,this.max_length=e,this.has_stree=a&&a.length},ob=function(a,b){this.dyn_tree=a,this.max_code=0,this.stat_desc=b},pb=!1;c._tr_init=z,c._tr_stored_block=A,c._tr_flush_block=C,c._tr_tally=D,c._tr_align=B},{\"../utils/common\":27}],39:[function(a,b){\"use strict\";function c(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\"\",this.state=null,this.data_type=2,this.adler=0}b.exports=c},{}]},{},[9])(9)});","/* xlsx.js (C) 2013-2015 SheetJS -- http://sheetjs.com */\r\n/* vim: set ts=2: */\r\n/*jshint -W041 */\r\n/*jshint funcscope:true, eqnull:true */\r\nvar XLSX = {};\r\n(function make_xlsx(XLSX) {\r\n    XLSX.version = '0.8.0';\r\n    var current_codepage = 1200, current_cptable;\r\n    if (typeof module !== \"undefined\" && typeof require !== 'undefined') {\r\n        if (typeof cptable === 'undefined') cptable = require('./dist/cpexcel');\r\n        current_cptable = cptable[current_codepage];\r\n    }\r\n    function reset_cp() { set_cp(1200); }\r\n    var set_cp = function (cp) { current_codepage = cp; };\r\n\r\n    function char_codes(data) { var o = []; for (var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i); return o; }\r\n    var debom_xml = function (data) { return data; };\r\n\r\n    var _getchar = function _gc1(x) { return String.fromCharCode(x); };\r\n    if (typeof cptable !== 'undefined') {\r\n        set_cp = function (cp) { current_codepage = cp; current_cptable = cptable[cp]; };\r\n        debom_xml = function (data) {\r\n            if (data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) { return cptable.utils.decode(1200, char_codes(data.substr(2))); }\r\n            return data;\r\n        };\r\n        _getchar = function _gc2(x) {\r\n            if (current_codepage === 1200) return String.fromCharCode(x);\r\n            return cptable.utils.decode(current_codepage, [x & 255, x >> 8])[0];\r\n        };\r\n    }\r\n    var Base64 = (function make_b64() {\r\n        var map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\r\n        return {\r\n            encode: function (input, utf8) {\r\n                var o = \"\";\r\n                var c1, c2, c3, e1, e2, e3, e4;\r\n                for (var i = 0; i < input.length;) {\r\n                    c1 = input.charCodeAt(i++);\r\n                    c2 = input.charCodeAt(i++);\r\n                    c3 = input.charCodeAt(i++);\r\n                    e1 = c1 >> 2;\r\n                    e2 = (c1 & 3) << 4 | c2 >> 4;\r\n                    e3 = (c2 & 15) << 2 | c3 >> 6;\r\n                    e4 = c3 & 63;\r\n                    if (isNaN(c2)) { e3 = e4 = 64; }\r\n                    else if (isNaN(c3)) { e4 = 64; }\r\n                    o += map.charAt(e1) + map.charAt(e2) + map.charAt(e3) + map.charAt(e4);\r\n                }\r\n                return o;\r\n            },\r\n            decode: function b64_decode(input, utf8) {\r\n                var o = \"\";\r\n                var c1, c2, c3;\r\n                var e1, e2, e3, e4;\r\n                input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\r\n                for (var i = 0; i < input.length;) {\r\n                    e1 = map.indexOf(input.charAt(i++));\r\n                    e2 = map.indexOf(input.charAt(i++));\r\n                    e3 = map.indexOf(input.charAt(i++));\r\n                    e4 = map.indexOf(input.charAt(i++));\r\n                    c1 = e1 << 2 | e2 >> 4;\r\n                    c2 = (e2 & 15) << 4 | e3 >> 2;\r\n                    c3 = (e3 & 3) << 6 | e4;\r\n                    o += String.fromCharCode(c1);\r\n                    if (e3 != 64) { o += String.fromCharCode(c2); }\r\n                    if (e4 != 64) { o += String.fromCharCode(c3); }\r\n                }\r\n                return o;\r\n            }\r\n        };\r\n    })();\r\n    var has_buf = (typeof Buffer !== 'undefined');\r\n\r\n    function new_raw_buf(len) {\r\n        /* jshint -W056 */\r\n        return new (has_buf ? Buffer : Array)(len);\r\n        /* jshint +W056 */\r\n    }\r\n\r\n    function s2a(s) {\r\n        if (has_buf) return new Buffer(s, \"binary\");\r\n        return s.split(\"\").map(function (x) { return x.charCodeAt(0) & 0xff; });\r\n    }\r\n\r\n    var bconcat = function (bufs) { return [].concat.apply([], bufs); };\r\n\r\n    var chr0 = /\\u0000/g, chr1 = /[\\u0001-\\u0006]/;\r\n    /* ssf.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\r\n    /*jshint -W041 */\r\n    var SSF = {};\r\n    var make_ssf = function make_ssf(SSF) {\r\n        SSF.version = '0.8.1';\r\n        function _strrev(x) { var o = \"\", i = x.length - 1; while (i >= 0) o += x.charAt(i--); return o; }\r\n        function fill(c, l) { var o = \"\"; while (o.length < l) o += c; return o; }\r\n        function pad0(v, d) { var t = \"\" + v; return t.length >= d ? t : fill('0', d - t.length) + t; }\r\n        function pad_(v, d) { var t = \"\" + v; return t.length >= d ? t : fill(' ', d - t.length) + t; }\r\n        function rpad_(v, d) { var t = \"\" + v; return t.length >= d ? t : t + fill(' ', d - t.length); }\r\n        function pad0r1(v, d) { var t = \"\" + Math.round(v); return t.length >= d ? t : fill('0', d - t.length) + t; }\r\n        function pad0r2(v, d) { var t = \"\" + v; return t.length >= d ? t : fill('0', d - t.length) + t; }\r\n        var p2_32 = Math.pow(2, 32);\r\n        function pad0r(v, d) { if (v > p2_32 || v < -p2_32) return pad0r1(v, d); var i = Math.round(v); return pad0r2(i, d); }\r\n        function isgeneral(s, i) { return s.length >= 7 + i && (s.charCodeAt(i) | 32) === 103 && (s.charCodeAt(i + 1) | 32) === 101 && (s.charCodeAt(i + 2) | 32) === 110 && (s.charCodeAt(i + 3) | 32) === 101 && (s.charCodeAt(i + 4) | 32) === 114 && (s.charCodeAt(i + 5) | 32) === 97 && (s.charCodeAt(i + 6) | 32) === 108; }\r\n        /* Options */\r\n        var opts_fmt = [\r\n            [\"date1904\", 0],\r\n            [\"output\", \"\"],\r\n            [\"WTF\", false]\r\n        ];\r\n        function fixopts(o) {\r\n            for (var y = 0; y != opts_fmt.length; ++y) if (o[opts_fmt[y][0]] === undefined) o[opts_fmt[y][0]] = opts_fmt[y][1];\r\n        }\r\n        SSF.opts = opts_fmt;\r\n        var table_fmt = {\r\n            0: 'General',\r\n            1: '0',\r\n            2: '0.00',\r\n            3: '#,##0',\r\n            4: '#,##0.00',\r\n            9: '0%',\r\n            10: '0.00%',\r\n            11: '0.00E+00',\r\n            12: '# ?/?',\r\n            13: '# ??/??',\r\n            14: 'm/d/yy',\r\n            15: 'd-mmm-yy',\r\n            16: 'd-mmm',\r\n            17: 'mmm-yy',\r\n            18: 'h:mm AM/PM',\r\n            19: 'h:mm:ss AM/PM',\r\n            20: 'h:mm',\r\n            21: 'h:mm:ss',\r\n            22: 'm/d/yy h:mm',\r\n            37: '#,##0 ;(#,##0)',\r\n            38: '#,##0 ;[Red](#,##0)',\r\n            39: '#,##0.00;(#,##0.00)',\r\n            40: '#,##0.00;[Red](#,##0.00)',\r\n            45: 'mm:ss',\r\n            46: '[h]:mm:ss',\r\n            47: 'mmss.0',\r\n            48: '##0.0E+0',\r\n            49: '@',\r\n            56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"',\r\n            65535: 'General'\r\n        };\r\n        var days = [\r\n            ['Sun', 'Sunday'],\r\n            ['Mon', 'Monday'],\r\n            ['Tue', 'Tuesday'],\r\n            ['Wed', 'Wednesday'],\r\n            ['Thu', 'Thursday'],\r\n            ['Fri', 'Friday'],\r\n            ['Sat', 'Saturday']\r\n        ];\r\n        var months = [\r\n            ['J', 'Jan', 'January'],\r\n            ['F', 'Feb', 'February'],\r\n            ['M', 'Mar', 'March'],\r\n            ['A', 'Apr', 'April'],\r\n            ['M', 'May', 'May'],\r\n            ['J', 'Jun', 'June'],\r\n            ['J', 'Jul', 'July'],\r\n            ['A', 'Aug', 'August'],\r\n            ['S', 'Sep', 'September'],\r\n            ['O', 'Oct', 'October'],\r\n            ['N', 'Nov', 'November'],\r\n            ['D', 'Dec', 'December']\r\n        ];\r\n        function frac(x, D, mixed) {\r\n            var sgn = x < 0 ? -1 : 1;\r\n            var B = x * sgn;\r\n            var P_2 = 0, P_1 = 1, P = 0;\r\n            var Q_2 = 1, Q_1 = 0, Q = 0;\r\n            var A = Math.floor(B);\r\n            while (Q_1 < D) {\r\n                A = Math.floor(B);\r\n                P = A * P_1 + P_2;\r\n                Q = A * Q_1 + Q_2;\r\n                if ((B - A) < 0.0000000005) break;\r\n                B = 1 / (B - A);\r\n                P_2 = P_1; P_1 = P;\r\n                Q_2 = Q_1; Q_1 = Q;\r\n            }\r\n            if (Q > D) { Q = Q_1; P = P_1; }\r\n            if (Q > D) { Q = Q_2; P = P_2; }\r\n            if (!mixed) return [0, sgn * P, Q];\r\n            if (Q === 0) throw \"Unexpected state: \" + P + \" \" + P_1 + \" \" + P_2 + \" \" + Q + \" \" + Q_1 + \" \" + Q_2;\r\n            var q = Math.floor(sgn * P / Q);\r\n            return [q, sgn * P - q * Q, Q];\r\n        }\r\n        function general_fmt_int(v, opts) { return \"\" + v; }\r\n        SSF._general_int = general_fmt_int;\r\n        var general_fmt_num = (function make_general_fmt_num() {\r\n            var gnr1 = /\\.(\\d*[1-9])0+$/, gnr2 = /\\.0*$/, gnr4 = /\\.(\\d*[1-9])0+/, gnr5 = /\\.0*[Ee]/, gnr6 = /(E[+-])(\\d)$/;\r\n            function gfn2(v) {\r\n                var w = (v < 0 ? 12 : 11);\r\n                var o = gfn5(v.toFixed(12)); if (o.length <= w) return o;\r\n                o = v.toPrecision(10); if (o.length <= w) return o;\r\n                return v.toExponential(5);\r\n            }\r\n            function gfn3(v) {\r\n                var o = v.toFixed(11).replace(gnr1, \".$1\");\r\n                if (o.length > (v < 0 ? 12 : 11)) o = v.toPrecision(6);\r\n                return o;\r\n            }\r\n            function gfn4(o) {\r\n                for (var i = 0; i != o.length; ++i) if ((o.charCodeAt(i) | 0x20) === 101) return o.replace(gnr4, \".$1\").replace(gnr5, \"E\").replace(\"e\", \"E\").replace(gnr6, \"$10$2\");\r\n                return o;\r\n            }\r\n            function gfn5(o) {\r\n                //for(var i = 0; i != o.length; ++i) if(o.charCodeAt(i) === 46) return o.replace(gnr2,\"\").replace(gnr1,\".$1\");\r\n                //return o;\r\n                return o.indexOf(\".\") > -1 ? o.replace(gnr2, \"\").replace(gnr1, \".$1\") : o;\r\n            }\r\n            return function general_fmt_num(v, opts) {\r\n                var V = Math.floor(Math.log(Math.abs(v)) * Math.LOG10E), o;\r\n                if (V >= -4 && V <= -1) o = v.toPrecision(10 + V);\r\n                else if (Math.abs(V) <= 9) o = gfn2(v);\r\n                else if (V === 10) o = v.toFixed(10).substr(0, 12);\r\n                else o = gfn3(v);\r\n                return gfn5(gfn4(o));\r\n            };\r\n        })();\r\n        SSF._general_num = general_fmt_num;\r\n        function general_fmt(v, opts) {\r\n            switch (typeof v) {\r\n                case 'string': return v;\r\n                case 'boolean': return v ? \"TRUE\" : \"FALSE\";\r\n                case 'number': return (v | 0) === v ? general_fmt_int(v, opts) : general_fmt_num(v, opts);\r\n            }\r\n            throw new Error(\"unsupported value in General format: \" + v);\r\n        }\r\n        SSF._general = general_fmt;\r\n        function fix_hijri(date, o) { return 0; }\r\n        function parse_date_code(v, opts, b2) {\r\n            if (v > 2958465 || v < 0) return null;\r\n            var date = (v | 0), time = Math.floor(86400 * (v - date)), dow = 0;\r\n            var dout = [];\r\n            var out = { D: date, T: time, u: 86400 * (v - date) - time, y: 0, m: 0, d: 0, H: 0, M: 0, S: 0, q: 0 };\r\n            if (Math.abs(out.u) < 1e-6) out.u = 0;\r\n            fixopts(opts != null ? opts : (opts = []));\r\n            if (opts.date1904) date += 1462;\r\n            if (out.u > 0.999) {\r\n                out.u = 0;\r\n                if (++time == 86400) { time = 0; ++date; }\r\n            }\r\n            if (date === 60) { dout = b2 ? [1317, 10, 29] : [1900, 2, 29]; dow = 3; }\r\n            else if (date === 0) { dout = b2 ? [1317, 8, 29] : [1900, 1, 0]; dow = 6; }\r\n            else {\r\n                if (date > 60)--date;\r\n                /* 1 = Jan 1 1900 */\r\n                var d = new Date(1900, 0, 1);\r\n                d.setDate(d.getDate() + date - 1);\r\n                dout = [d.getFullYear(), d.getMonth() + 1, d.getDate()];\r\n                dow = d.getDay();\r\n                if (date < 60) dow = (dow + 6) % 7;\r\n                if (b2) dow = fix_hijri(d, dout);\r\n            }\r\n            out.y = dout[0]; out.m = dout[1]; out.d = dout[2];\r\n            out.S = time % 60; time = Math.floor(time / 60);\r\n            out.M = time % 60; time = Math.floor(time / 60);\r\n            out.H = time;\r\n            out.q = dow;\r\n            return out;\r\n        }\r\n        SSF.parse_date_code = parse_date_code;\r\n        /*jshint -W086 */\r\n        function write_date(type, fmt, val, ss0) {\r\n            var o = \"\", ss = 0, tt = 0, y = val.y, out, outl = 0;\r\n            switch (type) {\r\n                case 98: /* 'b' buddhist year */\r\n                    y = val.y + 543;\r\n                /* falls through */\r\n                case 121: /* 'y' year */\r\n                    switch (fmt.length) {\r\n                        case 1: case 2: out = y % 100; outl = 2; break;\r\n                        default: out = y % 10000; outl = 4; break;\r\n                    } break;\r\n                case 109: /* 'm' month */\r\n                    switch (fmt.length) {\r\n                        case 1: case 2: out = val.m; outl = fmt.length; break;\r\n                        case 3: return months[val.m - 1][1];\r\n                        case 5: return months[val.m - 1][0];\r\n                        default: return months[val.m - 1][2];\r\n                    } break;\r\n                case 100: /* 'd' day */\r\n                    switch (fmt.length) {\r\n                        case 1: case 2: out = val.d; outl = fmt.length; break;\r\n                        case 3: return days[val.q][0];\r\n                        default: return days[val.q][1];\r\n                    } break;\r\n                case 104: /* 'h' 12-hour */\r\n                    switch (fmt.length) {\r\n                        case 1: case 2: out = 1 + (val.H + 11) % 12; outl = fmt.length; break;\r\n                        default: throw 'bad hour format: ' + fmt;\r\n                    } break;\r\n                case 72: /* 'H' 24-hour */\r\n                    switch (fmt.length) {\r\n                        case 1: case 2: out = val.H; outl = fmt.length; break;\r\n                        default: throw 'bad hour format: ' + fmt;\r\n                    } break;\r\n                case 77: /* 'M' minutes */\r\n                    switch (fmt.length) {\r\n                        case 1: case 2: out = val.M; outl = fmt.length; break;\r\n                        default: throw 'bad minute format: ' + fmt;\r\n                    } break;\r\n                case 115: /* 's' seconds */\r\n                    if (val.u === 0) switch (fmt) {\r\n                        case 's': case 'ss': return pad0(val.S, fmt.length);\r\n                        case '.0': case '.00': case '.000':\r\n                    }\r\n                    switch (fmt) {\r\n                        case 's': case 'ss': case '.0': case '.00': case '.000':\r\n                            if (ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;\r\n                            else tt = ss0 === 1 ? 10 : 1;\r\n                            ss = Math.round((tt) * (val.S + val.u));\r\n                            if (ss >= 60 * tt) ss = 0;\r\n                            if (fmt === 's') return ss === 0 ? \"0\" : \"\" + ss / tt;\r\n                            o = pad0(ss, 2 + ss0);\r\n                            if (fmt === 'ss') return o.substr(0, 2);\r\n                            return \".\" + o.substr(2, fmt.length - 1);\r\n                        default: throw 'bad second format: ' + fmt;\r\n                    }\r\n                case 90: /* 'Z' absolute time */\r\n                    switch (fmt) {\r\n                        case '[h]': case '[hh]': out = val.D * 24 + val.H; break;\r\n                        case '[m]': case '[mm]': out = (val.D * 24 + val.H) * 60 + val.M; break;\r\n                        case '[s]': case '[ss]': out = ((val.D * 24 + val.H) * 60 + val.M) * 60 + Math.round(val.S + val.u); break;\r\n                        default: throw 'bad abstime format: ' + fmt;\r\n                    } outl = fmt.length === 3 ? 1 : 2; break;\r\n                case 101: /* 'e' era */\r\n                    out = y; outl = 1;\r\n            }\r\n            if (outl > 0) return pad0(out, outl); else return \"\";\r\n        }\r\n        /*jshint +W086 */\r\n        function commaify(s) {\r\n            if (s.length <= 3) return s;\r\n            var j = (s.length % 3), o = s.substr(0, j);\r\n            for (; j != s.length; j += 3) o += (o.length > 0 ? \",\" : \"\") + s.substr(j, 3);\r\n            return o;\r\n        }\r\n        var write_num = (function make_write_num() {\r\n            var pct1 = /%/g;\r\n            function write_num_pct(type, fmt, val) {\r\n                var sfmt = fmt.replace(pct1, \"\"), mul = fmt.length - sfmt.length;\r\n                return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\r\n            }\r\n            function write_num_cm(type, fmt, val) {\r\n                var idx = fmt.length - 1;\r\n                while (fmt.charCodeAt(idx - 1) === 44)--idx;\r\n                return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\r\n            }\r\n            function write_num_exp(fmt, val) {\r\n                var o;\r\n                var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\r\n                if (fmt.match(/^#+0.0E\\+0$/)) {\r\n                    var period = fmt.indexOf(\".\"); if (period === -1) period = fmt.indexOf('E');\r\n                    var ee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E) % period;\r\n                    if (ee < 0) ee += period;\r\n                    o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\r\n                    if (o.indexOf(\"e\") === -1) {\r\n                        var fakee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E);\r\n                        if (o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);\r\n                        else o += \"E+\" + (fakee - ee);\r\n                        while (o.substr(0, 2) === \"0.\") {\r\n                            o = o[0] + o.substr(2, period) + \".\" + o.substr(2 + period);\r\n                            o = o.replace(/^0+([1-9])/, \"$1\").replace(/^0+\\./, \"0.\");\r\n                        }\r\n                        o = o.replace(/\\+-/, \"-\");\r\n                    }\r\n                    o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) { return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\"; });\r\n                } else o = val.toExponential(idx);\r\n                if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o[o.length - 1];\r\n                if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\r\n                return o.replace(\"e\", \"E\");\r\n            }\r\n            var frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\r\n            function write_num_f1(r, aval, sign) {\r\n                var den = parseInt(r[4]), rr = Math.round(aval * den), base = Math.floor(rr / den);\r\n                var myn = (rr - base * den), myd = den;\r\n                return sign + (base === 0 ? \"\" : \"\" + base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn, r[1].length) + r[2] + \"/\" + r[3] + pad0(myd, r[4].length));\r\n            }\r\n            function write_num_f2(r, aval, sign) {\r\n                return sign + (aval === 0 ? \"\" : \"\" + aval) + fill(\" \", r[1].length + 2 + r[4].length);\r\n            }\r\n            var dec1 = /^#*0*\\.(0+)/;\r\n            var closeparen = /\\).*[0#]/;\r\n            var phone = /\\(###\\) ###\\\\?-####/;\r\n            function hashq(str) {\r\n                var o = \"\", cc;\r\n                for (var i = 0; i != str.length; ++i) switch ((cc = str.charCodeAt(i))) {\r\n                    case 35: break;\r\n                    case 63: o += \" \"; break;\r\n                    case 48: o += \"0\"; break;\r\n                    default: o += String.fromCharCode(cc);\r\n                }\r\n                return o;\r\n            }\r\n            function rnd(val, d) { var dd = Math.pow(10, d); return \"\" + (Math.round(val * dd) / dd); }\r\n            function dec(val, d) { return Math.round((val - Math.floor(val)) * Math.pow(10, d)); }\r\n            function flr(val) { if (val < 2147483647 && val > -2147483648) return \"\" + (val >= 0 ? (val | 0) : (val - 1 | 0)); return \"\" + Math.floor(val); }\r\n            function write_num_flt(type, fmt, val) {\r\n                if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\r\n                    var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\r\n                    if (val >= 0) return write_num_flt('n', ffmt, val);\r\n                    return '(' + write_num_flt('n', ffmt, -val) + ')';\r\n                }\r\n                if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\r\n                if (fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\r\n                if (fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\r\n                if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_flt(type, fmt.substr(fmt[1] == ' ' ? 2 : 1), val);\r\n                var o, oo;\r\n                var r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\r\n                if (fmt.match(/^00+$/)) return sign + pad0r(aval, fmt.length);\r\n                if (fmt.match(/^[#?]+$/)) {\r\n                    o = pad0r(val, 0); if (o === \"0\") o = \"\";\r\n                    return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\r\n                }\r\n                if ((r = fmt.match(frac1)) !== null) return write_num_f1(r, aval, sign);\r\n                if (fmt.match(/^#+0+$/) !== null) return sign + pad0r(aval, fmt.length - fmt.indexOf(\"0\"));\r\n                if ((r = fmt.match(dec1)) !== null) {\r\n                    o = rnd(val, r[1].length).replace(/^([^\\.]+)$/, \"$1.\" + r[1]).replace(/\\.$/, \".\" + r[1]).replace(/\\.(\\d*)$/, function ($$, $1) { return \".\" + $1 + fill(\"0\", r[1].length - $1.length); });\r\n                    return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\r\n                }\r\n                fmt = fmt.replace(/^#+([0.])/, \"$1\");\r\n                if ((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\r\n                    return sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\r\n                }\r\n                if ((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(pad0r(aval, 0));\r\n                if ((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\r\n                    return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\" + (Math.floor(val))) + \".\" + pad0(dec(val, r[1].length), r[1].length);\r\n                }\r\n                if ((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_flt(type, fmt.replace(/^#,#*,/, \"\"), val);\r\n                if ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\r\n                    o = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g, \"\"), val));\r\n                    ri = 0;\r\n                    return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) { return ri < o.length ? o[ri++] : x === '0' ? '0' : \"\"; }));\r\n                }\r\n                if (fmt.match(phone) !== null) {\r\n                    o = write_num_flt(type, \"##########\", val);\r\n                    return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\r\n                }\r\n                var oa = \"\";\r\n                if ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\r\n                    ri = Math.min(r[4].length, 7);\r\n                    ff = frac(aval, Math.pow(10, ri) - 1, false);\r\n                    o = \"\" + sign;\r\n                    oa = write_num(\"n\", r[1], ff[1]);\r\n                    if (oa[oa.length - 1] == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\r\n                    o += oa + r[2] + \"/\" + r[3];\r\n                    oa = rpad_(ff[2], ri);\r\n                    if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\r\n                    o += oa;\r\n                    return o;\r\n                }\r\n                if ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\r\n                    ri = Math.min(Math.max(r[1].length, r[4].length), 7);\r\n                    ff = frac(aval, Math.pow(10, ri) - 1, true);\r\n                    return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\r\n                }\r\n                if ((r = fmt.match(/^[#0?]+$/)) !== null) {\r\n                    o = pad0r(val, 0);\r\n                    if (fmt.length <= o.length) return o;\r\n                    return hashq(fmt.substr(0, fmt.length - o.length)) + o;\r\n                }\r\n                if ((r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) !== null) {\r\n                    o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\r\n                    ri = o.indexOf(\".\");\r\n                    var lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\r\n                    return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\r\n                }\r\n                if ((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\r\n                    ri = dec(val, r[1].length);\r\n                    return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) { return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$; }) + \".\" + pad0(ri, r[1].length);\r\n                }\r\n                switch (fmt) {\r\n                    case \"#,###\": var x = commaify(pad0r(aval, 0)); return x !== \"0\" ? sign + x : \"\";\r\n                    default:\r\n                }\r\n                throw new Error(\"unsupported format |\" + fmt + \"|\");\r\n            }\r\n            function write_num_cm2(type, fmt, val) {\r\n                var idx = fmt.length - 1;\r\n                while (fmt.charCodeAt(idx - 1) === 44)--idx;\r\n                return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\r\n            }\r\n            function write_num_pct2(type, fmt, val) {\r\n                var sfmt = fmt.replace(pct1, \"\"), mul = fmt.length - sfmt.length;\r\n                return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\r\n            }\r\n            function write_num_exp2(fmt, val) {\r\n                var o;\r\n                var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\r\n                if (fmt.match(/^#+0.0E\\+0$/)) {\r\n                    var period = fmt.indexOf(\".\"); if (period === -1) period = fmt.indexOf('E');\r\n                    var ee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E) % period;\r\n                    if (ee < 0) ee += period;\r\n                    o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\r\n                    if (!o.match(/[Ee]/)) {\r\n                        var fakee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E);\r\n                        if (o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);\r\n                        else o += \"E+\" + (fakee - ee);\r\n                        o = o.replace(/\\+-/, \"-\");\r\n                    }\r\n                    o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) { return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\"; });\r\n                } else o = val.toExponential(idx);\r\n                if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o[o.length - 1];\r\n                if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\r\n                return o.replace(\"e\", \"E\");\r\n            }\r\n            function write_num_int(type, fmt, val) {\r\n                if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\r\n                    var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\r\n                    if (val >= 0) return write_num_int('n', ffmt, val);\r\n                    return '(' + write_num_int('n', ffmt, -val) + ')';\r\n                }\r\n                if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\r\n                if (fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\r\n                if (fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\r\n                if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_int(type, fmt.substr(fmt[1] == ' ' ? 2 : 1), val);\r\n                var o;\r\n                var r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\r\n                if (fmt.match(/^00+$/)) return sign + pad0(aval, fmt.length);\r\n                if (fmt.match(/^[#?]+$/)) {\r\n                    o = (\"\" + val); if (val === 0) o = \"\";\r\n                    return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\r\n                }\r\n                if ((r = fmt.match(frac1)) !== null) return write_num_f2(r, aval, sign);\r\n                if (fmt.match(/^#+0+$/) !== null) return sign + pad0(aval, fmt.length - fmt.indexOf(\"0\"));\r\n                if ((r = fmt.match(dec1)) !== null) {\r\n                    o = (\"\" + val).replace(/^([^\\.]+)$/, \"$1.\" + r[1]).replace(/\\.$/, \".\" + r[1]).replace(/\\.(\\d*)$/, function ($$, $1) { return \".\" + $1 + fill(\"0\", r[1].length - $1.length); });\r\n                    return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\r\n                }\r\n                fmt = fmt.replace(/^#+([0.])/, \"$1\");\r\n                if ((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\r\n                    return sign + (\"\" + aval).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\r\n                }\r\n                if ((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify((\"\" + aval));\r\n                if ((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\r\n                    return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify((\"\" + val)) + \".\" + fill('0', r[1].length);\r\n                }\r\n                if ((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_int(type, fmt.replace(/^#,#*,/, \"\"), val);\r\n                if ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\r\n                    o = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g, \"\"), val));\r\n                    ri = 0;\r\n                    return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) { return ri < o.length ? o[ri++] : x === '0' ? '0' : \"\"; }));\r\n                }\r\n                if (fmt.match(phone) !== null) {\r\n                    o = write_num_int(type, \"##########\", val);\r\n                    return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\r\n                }\r\n                var oa = \"\";\r\n                if ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\r\n                    ri = Math.min(r[4].length, 7);\r\n                    ff = frac(aval, Math.pow(10, ri) - 1, false);\r\n                    o = \"\" + sign;\r\n                    oa = write_num(\"n\", r[1], ff[1]);\r\n                    if (oa[oa.length - 1] == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\r\n                    o += oa + r[2] + \"/\" + r[3];\r\n                    oa = rpad_(ff[2], ri);\r\n                    if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\r\n                    o += oa;\r\n                    return o;\r\n                }\r\n                if ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\r\n                    ri = Math.min(Math.max(r[1].length, r[4].length), 7);\r\n                    ff = frac(aval, Math.pow(10, ri) - 1, true);\r\n                    return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\r\n                }\r\n                if ((r = fmt.match(/^[#0?]+$/)) !== null) {\r\n                    o = \"\" + val;\r\n                    if (fmt.length <= o.length) return o;\r\n                    return hashq(fmt.substr(0, fmt.length - o.length)) + o;\r\n                }\r\n                if ((r = fmt.match(/^([#0]+)\\.([#0]+)$/)) !== null) {\r\n                    o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\r\n                    ri = o.indexOf(\".\");\r\n                    var lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\r\n                    return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\r\n                }\r\n                if ((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\r\n                    return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) { return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$; }) + \".\" + pad0(0, r[1].length);\r\n                }\r\n                switch (fmt) {\r\n                    case \"#,###\": var x = commaify(\"\" + aval); return x !== \"0\" ? sign + x : \"\";\r\n                    default:\r\n                }\r\n                throw new Error(\"unsupported format |\" + fmt + \"|\");\r\n            }\r\n            return function write_num(type, fmt, val) {\r\n                return (val | 0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\r\n            };\r\n        })();\r\n        function split_fmt(fmt) {\r\n            var out = [];\r\n            var in_str = false, cc;\r\n            for (var i = 0, j = 0; i < fmt.length; ++i) switch ((cc = fmt.charCodeAt(i))) {\r\n                case 34: /* '\"' */\r\n                    in_str = !in_str; break;\r\n                case 95: case 42: case 92: /* '_' '*' '\\\\' */\r\n                    ++i; break;\r\n                case 59: /* ';' */\r\n                    out[out.length] = fmt.substr(j, i - j);\r\n                    j = i + 1;\r\n            }\r\n            out[out.length] = fmt.substr(j);\r\n            if (in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\r\n            return out;\r\n        }\r\n        SSF._split = split_fmt;\r\n        var abstime = /\\[[HhMmSs]*\\]/;\r\n        function eval_fmt(fmt, v, opts, flen) {\r\n            var out = [], o = \"\", i = 0, c = \"\", lst = 't', q, dt, j, cc;\r\n            var hr = 'H';\r\n            /* Tokenize */\r\n            while (i < fmt.length) {\r\n                switch ((c = fmt[i])) {\r\n                    case 'G': /* General */\r\n                        if (!isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' + fmt);\r\n                        out[out.length] = { t: 'G', v: 'General' }; i += 7; break;\r\n                    case '\"': /* Literal text */\r\n                        for (o = \"\"; (cc = fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\r\n                        out[out.length] = { t: 't', v: o }; ++i; break;\r\n                    case '\\\\': var w = fmt[++i], t = (w === \"(\" || w === \")\") ? w : 't';\r\n                        out[out.length] = { t: t, v: w }; ++i; break;\r\n                    case '_': out[out.length] = { t: 't', v: \" \" }; i += 2; break;\r\n                    case '@': /* Text Placeholder */\r\n                        out[out.length] = { t: 'T', v: v }; ++i; break;\r\n                    case 'B': case 'b':\r\n                        if (fmt[i + 1] === \"1\" || fmt[i + 1] === \"2\") {\r\n                            if (dt == null) { dt = parse_date_code(v, opts, fmt[i + 1] === \"2\"); if (dt == null) return \"\"; }\r\n                            out[out.length] = { t: 'X', v: fmt.substr(i, 2) }; lst = c; i += 2; break;\r\n                        }\r\n                    /* falls through */\r\n                    case 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\r\n                        c = c.toLowerCase();\r\n                    /* falls through */\r\n                    case 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g':\r\n                        if (v < 0) return \"\";\r\n                        if (dt == null) { dt = parse_date_code(v, opts); if (dt == null) return \"\"; }\r\n                        o = c; while (++i < fmt.length && fmt[i].toLowerCase() === c) o += c;\r\n                        if (c === 'm' && lst.toLowerCase() === 'h') c = 'M'; /* m = minute */\r\n                        if (c === 'h') c = hr;\r\n                        out[out.length] = { t: c, v: o }; lst = c; break;\r\n                    case 'A':\r\n                        q = { t: c, v: \"A\" };\r\n                        if (dt == null) dt = parse_date_code(v, opts);\r\n                        if (fmt.substr(i, 3) === \"A/P\") { if (dt != null) q.v = dt.H >= 12 ? \"P\" : \"A\"; q.t = 'T'; hr = 'h'; i += 3; }\r\n                        else if (fmt.substr(i, 5) === \"AM/PM\") { if (dt != null) q.v = dt.H >= 12 ? \"PM\" : \"AM\"; q.t = 'T'; i += 5; hr = 'h'; }\r\n                        else { q.t = \"t\"; ++i; }\r\n                        if (dt == null && q.t === 'T') return \"\";\r\n                        out[out.length] = q; lst = c; break;\r\n                    case '[':\r\n                        o = c;\r\n                        while (fmt[i++] !== ']' && i < fmt.length) o += fmt[i];\r\n                        if (o.substr(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\r\n                        if (o.match(abstime)) {\r\n                            if (dt == null) { dt = parse_date_code(v, opts); if (dt == null) return \"\"; }\r\n                            out[out.length] = { t: 'Z', v: o.toLowerCase() };\r\n                        } else { o = \"\"; }\r\n                        break;\r\n                    /* Numbers */\r\n                    case '.':\r\n                        if (dt != null) {\r\n                            o = c; while ((c = fmt[++i]) === \"0\") o += c;\r\n                            out[out.length] = { t: 's', v: o }; break;\r\n                        }\r\n                    /* falls through */\r\n                    case '0': case '#':\r\n                        o = c; while (\"0#?.,E+-%\".indexOf(c = fmt[++i]) > -1 || c == '\\\\' && fmt[i + 1] == \"-\" && \"0#\".indexOf(fmt[i + 2]) > -1) o += c;\r\n                        out[out.length] = { t: 'n', v: o }; break;\r\n                    case '?':\r\n                        o = c; while (fmt[++i] === c) o += c;\r\n                        q = { t: c, v: o }; out[out.length] = q; lst = c; break;\r\n                    case '*': ++i; if (fmt[i] == ' ' || fmt[i] == '*')++i; break; // **\r\n                    case '(': case ')': out[out.length] = { t: (flen === 1 ? 't' : c), v: c }; ++i; break;\r\n                    case '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\r\n                        o = c; while (\"0123456789\".indexOf(fmt[++i]) > -1) o += fmt[i];\r\n                        out[out.length] = { t: 'D', v: o }; break;\r\n                    case ' ': out[out.length] = { t: c, v: c }; ++i; break;\r\n                    default:\r\n                        if (\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxz\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\r\n                        out[out.length] = { t: 't', v: c }; ++i; break;\r\n                }\r\n            }\r\n            var bt = 0, ss0 = 0, ssm;\r\n            for (i = out.length - 1, lst = 't'; i >= 0; --i) {\r\n                switch (out[i].t) {\r\n                    case 'h': case 'H': out[i].t = hr; lst = 'h'; if (bt < 1) bt = 1; break;\r\n                    case 's':\r\n                        if ((ssm = out[i].v.match(/\\.0+$/))) ss0 = Math.max(ss0, ssm[0].length - 1);\r\n                        if (bt < 3) bt = 3;\r\n                    /* falls through */\r\n                    case 'd': case 'y': case 'M': case 'e': lst = out[i].t; break;\r\n                    case 'm': if (lst === 's') { out[i].t = 'M'; if (bt < 2) bt = 2; } break;\r\n                    case 'X': if (out[i].v === \"B2\");\r\n                        break;\r\n                    case 'Z':\r\n                        if (bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\r\n                        if (bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\r\n                        if (bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\r\n                }\r\n            }\r\n            switch (bt) {\r\n                case 0: break;\r\n                case 1:\r\n                    if (dt.u >= 0.5) { dt.u = 0; ++dt.S; }\r\n                    if (dt.S >= 60) { dt.S = 0; ++dt.M; }\r\n                    if (dt.M >= 60) { dt.M = 0; ++dt.H; }\r\n                    break;\r\n                case 2:\r\n                    if (dt.u >= 0.5) { dt.u = 0; ++dt.S; }\r\n                    if (dt.S >= 60) { dt.S = 0; ++dt.M; }\r\n                    break;\r\n            }\r\n            /* replace fields */\r\n            var nstr = \"\", jj;\r\n            for (i = 0; i < out.length; ++i) {\r\n                switch (out[i].t) {\r\n                    case 't': case 'T': case ' ': case 'D': break;\r\n                    case 'X': out[i] = undefined; break;\r\n                    case 'd': case 'm': case 'y': case 'h': case 'H': case 'M': case 's': case 'e': case 'b': case 'Z':\r\n                        out[i].v = write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\r\n                        out[i].t = 't'; break;\r\n                    case 'n': case '(': case '?':\r\n                        jj = i + 1;\r\n                        while (out[jj] != null && (\r\n                            (c = out[jj].t) === \"?\" || c === \"D\" ||\r\n                            (c === \" \" || c === \"t\") && out[jj + 1] != null && (out[jj + 1].t === '?' || out[jj + 1].t === \"t\" && out[jj + 1].v === '/') ||\r\n                            out[i].t === '(' && (c === ' ' || c === 'n' || c === ')') ||\r\n                            c === 't' && (out[jj].v === '/' || '$€'.indexOf(out[jj].v) > -1 || out[jj].v === ' ' && out[jj + 1] != null && out[jj + 1].t == '?')\r\n                        )) {\r\n                            out[i].v += out[jj].v;\r\n                            out[jj] = undefined; ++jj;\r\n                        }\r\n                        nstr += out[i].v;\r\n                        i = jj - 1; break;\r\n                    case 'G': out[i].t = 't'; out[i].v = general_fmt(v, opts); break;\r\n                }\r\n            }\r\n            var vv = \"\", myv, ostr;\r\n            if (nstr.length > 0) {\r\n                myv = (v < 0 && nstr.charCodeAt(0) === 45 ? -v : v); /* '-' */\r\n                ostr = write_num(nstr.charCodeAt(0) === 40 ? '(' : 'n', nstr, myv); /* '(' */\r\n                jj = ostr.length - 1;\r\n                var decpt = out.length;\r\n                for (i = 0; i < out.length; ++i) if (out[i] != null && out[i].v.indexOf(\".\") > -1) { decpt = i; break; }\r\n                var lasti = out.length;\r\n                if (decpt === out.length && ostr.indexOf(\"E\") === -1) {\r\n                    for (i = out.length - 1; i >= 0; --i) {\r\n                        if (out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\r\n                        if (jj >= out[i].v.length - 1) { jj -= out[i].v.length; out[i].v = ostr.substr(jj + 1, out[i].v.length); }\r\n                        else if (jj < 0) out[i].v = \"\";\r\n                        else { out[i].v = ostr.substr(0, jj + 1); jj = -1; }\r\n                        out[i].t = 't';\r\n                        lasti = i;\r\n                    }\r\n                    if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\r\n                }\r\n                else if (decpt !== out.length && ostr.indexOf(\"E\") === -1) {\r\n                    jj = ostr.indexOf(\".\") - 1;\r\n                    for (i = decpt; i >= 0; --i) {\r\n                        if (out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\r\n                        j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") - 1 : out[i].v.length - 1;\r\n                        vv = out[i].v.substr(j + 1);\r\n                        for (; j >= 0; --j) {\r\n                            if (jj >= 0 && (out[i].v[j] === \"0\" || out[i].v[j] === \"#\")) vv = ostr[jj--] + vv;\r\n                        }\r\n                        out[i].v = vv;\r\n                        out[i].t = 't';\r\n                        lasti = i;\r\n                    }\r\n                    if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\r\n                    jj = ostr.indexOf(\".\") + 1;\r\n                    for (i = decpt; i < out.length; ++i) {\r\n                        if (out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt) continue;\r\n                        j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") + 1 : 0;\r\n                        vv = out[i].v.substr(0, j);\r\n                        for (; j < out[i].v.length; ++j) {\r\n                            if (jj < ostr.length) vv += ostr[jj++];\r\n                        }\r\n                        out[i].v = vv;\r\n                        out[i].t = 't';\r\n                        lasti = i;\r\n                    }\r\n                }\r\n            }\r\n            for (i = 0; i < out.length; ++i) if (out[i] != null && 'n(?'.indexOf(out[i].t) > -1) {\r\n                myv = (flen > 1 && v < 0 && i > 0 && out[i - 1].v === \"-\" ? -v : v);\r\n                out[i].v = write_num(out[i].t, out[i].v, myv);\r\n                out[i].t = 't';\r\n            }\r\n            var retval = \"\";\r\n            for (i = 0; i !== out.length; ++i) if (out[i] != null) retval += out[i].v;\r\n            return retval;\r\n        }\r\n        SSF._eval = eval_fmt;\r\n        var cfregex = /\\[[=<>]/;\r\n        var cfregex2 = /\\[([=<>]*)(-?\\d+\\.?\\d*)\\]/;\r\n        function chkcond(v, rr) {\r\n            if (rr == null) return false;\r\n            var thresh = parseFloat(rr[2]);\r\n            switch (rr[1]) {\r\n                case \"=\": if (v == thresh) return true; break;\r\n                case \">\": if (v > thresh) return true; break;\r\n                case \"<\": if (v < thresh) return true; break;\r\n                case \"<>\": if (v != thresh) return true; break;\r\n                case \">=\": if (v >= thresh) return true; break;\r\n                case \"<=\": if (v <= thresh) return true; break;\r\n            }\r\n            return false;\r\n        }\r\n        function choose_fmt(f, v) {\r\n            var fmt = split_fmt(f);\r\n            var l = fmt.length, lat = fmt[l - 1].indexOf(\"@\");\r\n            if (l < 4 && lat > -1)--l;\r\n            if (fmt.length > 4) throw \"cannot find right format for |\" + fmt + \"|\";\r\n            if (typeof v !== \"number\") return [4, fmt.length === 4 || lat > -1 ? fmt[fmt.length - 1] : \"@\"];\r\n            switch (fmt.length) {\r\n                case 1: fmt = lat > -1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"]; break;\r\n                case 2: fmt = lat > -1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"]; break;\r\n                case 3: fmt = lat > -1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"]; break;\r\n                case 4: break;\r\n            }\r\n            var ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\r\n            if (fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\r\n            if (fmt[0].match(cfregex) != null || fmt[1].match(cfregex) != null) {\r\n                var m1 = fmt[0].match(cfregex2);\r\n                var m2 = fmt[1].match(cfregex2);\r\n                return chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\r\n            }\r\n            return [l, ff];\r\n        }\r\n        function format(fmt, v, o) {\r\n            fixopts(o != null ? o : (o = []));\r\n            var sfmt = \"\";\r\n            switch (typeof fmt) {\r\n                case \"string\": sfmt = fmt; break;\r\n                case \"number\": sfmt = (o.table != null ? o.table : table_fmt)[fmt]; break;\r\n            }\r\n            if (isgeneral(sfmt, 0)) return general_fmt(v, o);\r\n            var f = choose_fmt(sfmt, v);\r\n            if (isgeneral(f[1])) return general_fmt(v, o);\r\n            if (v === true) v = \"TRUE\"; else if (v === false) v = \"FALSE\";\r\n            else if (v === \"\" || v == null) return \"\";\r\n            return eval_fmt(f[1], v, o, f[0]);\r\n        }\r\n        SSF._table = table_fmt;\r\n        SSF.load = function load_entry(fmt, idx) { table_fmt[idx] = fmt; };\r\n        SSF.format = format;\r\n        SSF.get_table = function get_table() { return table_fmt; };\r\n        SSF.load_table = function load_table(tbl) { for (var i = 0; i != 0x0188; ++i) if (tbl[i] !== undefined) SSF.load(tbl[i], i); };\r\n    };\r\n    make_ssf(SSF);\r\n    /* map from xlml named formats to SSF TODO: localize */\r\n    var XLMLFormatMap = {\r\n        \"General Number\": \"General\",\r\n        \"General Date\": SSF._table[22],\r\n        \"Long Date\": \"dddd, mmmm dd, yyyy\",\r\n        \"Medium Date\": SSF._table[15],\r\n        \"Short Date\": SSF._table[14],\r\n        \"Long Time\": SSF._table[19],\r\n        \"Medium Time\": SSF._table[18],\r\n        \"Short Time\": SSF._table[20],\r\n        \"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\r\n        \"Fixed\": SSF._table[2],\r\n        \"Standard\": SSF._table[4],\r\n        \"Percent\": SSF._table[10],\r\n        \"Scientific\": SSF._table[11],\r\n        \"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\r\n        \"True/False\": '\"True\";\"True\";\"False\";@',\r\n        \"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\r\n    };\r\n\r\n    var DO_NOT_EXPORT_CFB = true;\r\n    /* cfb.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\r\n    /* vim: set ts=2: */\r\n    /*jshint eqnull:true */\r\n\r\n    /* [MS-CFB] v20130118 */\r\n    var CFB = (function _CFB() {\r\n        var exports = {};\r\n        exports.version = '0.10.2';\r\n        function parse(file) {\r\n            var mver = 3; // major version\r\n            var ssz = 512; // sector size\r\n            var nmfs = 0; // number of mini FAT sectors\r\n            var ndfs = 0; // number of DIFAT sectors\r\n            var dir_start = 0; // first directory sector location\r\n            var minifat_start = 0; // first mini FAT sector location\r\n            var difat_start = 0; // first mini FAT sector location\r\n\r\n            var fat_addrs = []; // locations of FAT sectors\r\n\r\n            /* [MS-CFB] 2.2 Compound File Header */\r\n            var blob = file.slice(0, 512);\r\n            prep_blob(blob, 0);\r\n\r\n            /* major version */\r\n            var mv = check_get_mver(blob);\r\n            mver = mv[0];\r\n            switch (mver) {\r\n                case 3: ssz = 512; break; case 4: ssz = 4096; break;\r\n                default: throw \"Major Version: Expected 3 or 4 saw \" + mver;\r\n            }\r\n\r\n            /* reprocess header */\r\n            if (ssz !== 512) { blob = file.slice(0, ssz); prep_blob(blob, 28 /* blob.l */); }\r\n            /* Save header for final object */\r\n            var header = file.slice(0, ssz);\r\n\r\n            check_shifts(blob, mver);\r\n\r\n            // Number of Directory Sectors\r\n            var nds = blob.read_shift(4, 'i');\r\n            if (mver === 3 && nds !== 0) throw '# Directory Sectors: Expected 0 saw ' + nds;\r\n\r\n            // Number of FAT Sectors\r\n            //var nfs = blob.read_shift(4, 'i');\r\n            blob.l += 4;\r\n\r\n            // First Directory Sector Location\r\n            dir_start = blob.read_shift(4, 'i');\r\n\r\n            // Transaction Signature\r\n            blob.l += 4;\r\n\r\n            // Mini Stream Cutoff Size\r\n            blob.chk('00100000', 'Mini Stream Cutoff Size: ');\r\n\r\n            // First Mini FAT Sector Location\r\n            minifat_start = blob.read_shift(4, 'i');\r\n\r\n            // Number of Mini FAT Sectors\r\n            nmfs = blob.read_shift(4, 'i');\r\n\r\n            // First DIFAT sector location\r\n            difat_start = blob.read_shift(4, 'i');\r\n\r\n            // Number of DIFAT Sectors\r\n            ndfs = blob.read_shift(4, 'i');\r\n\r\n            // Grab FAT Sector Locations\r\n            for (var q, j = 0; j < 109; ++j) { /* 109 = (512 - blob.l)>>>2; */\r\n                q = blob.read_shift(4, 'i');\r\n                if (q < 0) break;\r\n                fat_addrs[j] = q;\r\n            }\r\n\r\n            /** Break the file up into sectors */\r\n            var sectors = sectorify(file, ssz);\r\n\r\n            sleuth_fat(difat_start, ndfs, sectors, ssz, fat_addrs);\r\n\r\n            /** Chains */\r\n            var sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\r\n\r\n            sector_list[dir_start].name = \"!Directory\";\r\n            if (nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\r\n            sector_list[fat_addrs[0]].name = \"!FAT\";\r\n            sector_list.fat_addrs = fat_addrs;\r\n            sector_list.ssz = ssz;\r\n\r\n            /* [MS-CFB] 2.6.1 Compound File Directory Entry */\r\n            var files = {}, Paths = [], FileIndex = [], FullPaths = [], FullPathDir = {};\r\n            read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex);\r\n\r\n            build_full_paths(FileIndex, FullPathDir, FullPaths, Paths);\r\n\r\n            var root_name = Paths.shift();\r\n            Paths.root = root_name;\r\n\r\n            /* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\r\n            var find_path = make_find_path(FullPaths, Paths, FileIndex, files, root_name);\r\n\r\n            return {\r\n                raw: { header: header, sectors: sectors },\r\n                FileIndex: FileIndex,\r\n                FullPaths: FullPaths,\r\n                FullPathDir: FullPathDir,\r\n                find: find_path\r\n            };\r\n        } // parse\r\n\r\n        /* [MS-CFB] 2.2 Compound File Header -- read up to major version */\r\n        function check_get_mver(blob) {\r\n            // header signature 8\r\n            blob.chk(HEADER_SIGNATURE, 'Header Signature: ');\r\n\r\n            // clsid 16\r\n            blob.chk(HEADER_CLSID, 'CLSID: ');\r\n\r\n            // minor version 2\r\n            var mver = blob.read_shift(2, 'u');\r\n\r\n            return [blob.read_shift(2, 'u'), mver];\r\n        }\r\n        function check_shifts(blob, mver) {\r\n            var shift = 0x09;\r\n\r\n            // Byte Order\r\n            blob.chk('feff', 'Byte Order: ');\r\n\r\n            // Sector Shift\r\n            switch ((shift = blob.read_shift(2))) {\r\n                case 0x09: if (mver !== 3) throw 'MajorVersion/SectorShift Mismatch'; break;\r\n                case 0x0c: if (mver !== 4) throw 'MajorVersion/SectorShift Mismatch'; break;\r\n                default: throw 'Sector Shift: Expected 9 or 12 saw ' + shift;\r\n            }\r\n\r\n            // Mini Sector Shift\r\n            blob.chk('0600', 'Mini Sector Shift: ');\r\n\r\n            // Reserved\r\n            blob.chk('000000000000', 'Reserved: ');\r\n        }\r\n\r\n        /** Break the file up into sectors */\r\n        function sectorify(file, ssz) {\r\n            var nsectors = Math.ceil(file.length / ssz) - 1;\r\n            var sectors = new Array(nsectors);\r\n            for (var i = 1; i < nsectors; ++i) sectors[i - 1] = file.slice(i * ssz, (i + 1) * ssz);\r\n            sectors[nsectors - 1] = file.slice(nsectors * ssz);\r\n            return sectors;\r\n        }\r\n\r\n        /* [MS-CFB] 2.6.4 Red-Black Tree */\r\n        function build_full_paths(FI, FPD, FP, Paths) {\r\n            var i = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;\r\n            var dad = new Array(pl), q = new Array(pl);\r\n\r\n            for (; i < pl; ++i) { dad[i] = q[i] = i; FP[i] = Paths[i]; }\r\n\r\n            for (; j < q.length; ++j) {\r\n                i = q[j];\r\n                L = FI[i].L; R = FI[i].R; C = FI[i].C;\r\n                if (dad[i] === i) {\r\n                    if (L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\r\n                    if (R !== -1 && dad[R] !== R) dad[i] = dad[R];\r\n                }\r\n                if (C !== -1 /*NOSTREAM*/) dad[C] = i;\r\n                if (L !== -1) { dad[L] = dad[i]; q.push(L); }\r\n                if (R !== -1) { dad[R] = dad[i]; q.push(R); }\r\n            }\r\n            for (i = 1; i !== pl; ++i) if (dad[i] === i) {\r\n                if (R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];\r\n                else if (L !== -1 && dad[L] !== L) dad[i] = dad[L];\r\n            }\r\n\r\n            for (i = 1; i < pl; ++i) {\r\n                if (FI[i].type === 0 /* unknown */) continue;\r\n                j = dad[i];\r\n                if (j === 0) FP[i] = FP[0] + \"/\" + FP[i];\r\n                else while (j !== 0) {\r\n                    FP[i] = FP[j] + \"/\" + FP[i];\r\n                    j = dad[j];\r\n                }\r\n                dad[i] = 0;\r\n            }\r\n\r\n            FP[0] += \"/\";\r\n            for (i = 1; i < pl; ++i) {\r\n                if (FI[i].type !== 2 /* stream */) FP[i] += \"/\";\r\n                FPD[FP[i]] = FI[i];\r\n            }\r\n        }\r\n\r\n        /* [MS-CFB] 2.6.4 */\r\n        function make_find_path(FullPaths, Paths, FileIndex, files, root_name) {\r\n            var UCFullPaths = new Array(FullPaths.length);\r\n            var UCPaths = new Array(Paths.length), i;\r\n            for (i = 0; i < FullPaths.length; ++i) UCFullPaths[i] = FullPaths[i].toUpperCase().replace(chr0, '').replace(chr1, '!');\r\n            for (i = 0; i < Paths.length; ++i) UCPaths[i] = Paths[i].toUpperCase().replace(chr0, '').replace(chr1, '!');\r\n            return function find_path(path) {\r\n                var k;\r\n                if (path.charCodeAt(0) === 47 /* \"/\" */) { k = true; path = root_name + path; }\r\n                else k = path.indexOf(\"/\") !== -1;\r\n                var UCPath = path.toUpperCase().replace(chr0, '').replace(chr1, '!');\r\n                var w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\r\n                if (w === -1) return null;\r\n                return k === true ? FileIndex[w] : files[Paths[w]];\r\n            };\r\n        }\r\n\r\n        /** Chase down the rest of the DIFAT chain to build a comprehensive list\r\n            DIFAT chains by storing the next sector number as the last 32 bytes */\r\n        function sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\r\n            var q;\r\n            if (idx === ENDOFCHAIN) {\r\n                if (cnt !== 0) throw \"DIFAT chain shorter than expected\";\r\n            } else if (idx !== -1 /*FREESECT*/) {\r\n                var sector = sectors[idx], m = (ssz >>> 2) - 1;\r\n                for (var i = 0; i < m; ++i) {\r\n                    if ((q = __readInt32LE(sector, i * 4)) === ENDOFCHAIN) break;\r\n                    fat_addrs.push(q);\r\n                }\r\n                sleuth_fat(__readInt32LE(sector, ssz - 4), cnt - 1, sectors, ssz, fat_addrs);\r\n            }\r\n        }\r\n\r\n        /** Follow the linked list of sectors for a given starting point */\r\n        function get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\r\n            var sl = sectors.length;\r\n            var buf, buf_chain;\r\n            if (!chkd) chkd = new Array(sl);\r\n            var modulus = ssz - 1, j, jj;\r\n            buf = [];\r\n            buf_chain = [];\r\n            for (j = start; j >= 0;) {\r\n                chkd[j] = true;\r\n                buf[buf.length] = j;\r\n                buf_chain.push(sectors[j]);\r\n                var addr = fat_addrs[Math.floor(j * 4 / ssz)];\r\n                jj = ((j * 4) & modulus);\r\n                if (ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \" + ssz;\r\n                j = __readInt32LE(sectors[addr], jj);\r\n            }\r\n            return { nodes: buf, data: __toBuffer([buf_chain]) };\r\n        }\r\n\r\n        /** Chase down the sector linked lists */\r\n        function make_sector_list(sectors, dir_start, fat_addrs, ssz) {\r\n            var sl = sectors.length, sector_list = new Array(sl);\r\n            var chkd = new Array(sl), buf, buf_chain;\r\n            var modulus = ssz - 1, i, j, k, jj;\r\n            for (i = 0; i < sl; ++i) {\r\n                buf = [];\r\n                k = (i + dir_start); if (k >= sl) k -= sl;\r\n                if (chkd[k] === true) continue;\r\n                buf_chain = [];\r\n                for (j = k; j >= 0;) {\r\n                    chkd[j] = true;\r\n                    buf[buf.length] = j;\r\n                    buf_chain.push(sectors[j]);\r\n                    var addr = fat_addrs[Math.floor(j * 4 / ssz)];\r\n                    jj = ((j * 4) & modulus);\r\n                    if (ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \" + ssz;\r\n                    j = __readInt32LE(sectors[addr], jj);\r\n                }\r\n                sector_list[k] = { nodes: buf, data: __toBuffer([buf_chain]) };\r\n            }\r\n            return sector_list;\r\n        }\r\n\r\n        /* [MS-CFB] 2.6.1 Compound File Directory Entry */\r\n        function read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex) {\r\n            var blob;\r\n            var minifat_store = 0, pl = (Paths.length ? 2 : 0);\r\n            var sector = sector_list[dir_start].data;\r\n            var i = 0, namelen = 0, name, o, ctime, mtime;\r\n            for (; i < sector.length; i += 128) {\r\n                blob = sector.slice(i, i + 128);\r\n                prep_blob(blob, 64);\r\n                namelen = blob.read_shift(2);\r\n                if (namelen === 0) continue;\r\n                name = __utf16le(blob, 0, namelen - pl);\r\n                Paths.push(name);\r\n                o = {\r\n                    name: name,\r\n                    type: blob.read_shift(1),\r\n                    color: blob.read_shift(1),\r\n                    L: blob.read_shift(4, 'i'),\r\n                    R: blob.read_shift(4, 'i'),\r\n                    C: blob.read_shift(4, 'i'),\r\n                    clsid: blob.read_shift(16),\r\n                    state: blob.read_shift(4, 'i')\r\n                };\r\n                ctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\r\n                if (ctime !== 0) {\r\n                    o.ctime = ctime; o.ct = read_date(blob, blob.l - 8);\r\n                }\r\n                mtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\r\n                if (mtime !== 0) {\r\n                    o.mtime = mtime; o.mt = read_date(blob, blob.l - 8);\r\n                }\r\n                o.start = blob.read_shift(4, 'i');\r\n                o.size = blob.read_shift(4, 'i');\r\n                if (o.type === 5) { /* root */\r\n                    minifat_store = o.start;\r\n                    if (nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\r\n                    /*minifat_size = o.size;*/\r\n                } else if (o.size >= 4096 /* MSCSZ */) {\r\n                    o.storage = 'fat';\r\n                    if (sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\r\n                    sector_list[o.start].name = o.name;\r\n                    o.content = sector_list[o.start].data.slice(0, o.size);\r\n                    prep_blob(o.content, 0);\r\n                } else {\r\n                    o.storage = 'minifat';\r\n                    if (minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN) {\r\n                        o.content = sector_list[minifat_store].data.slice(o.start * MSSZ, o.start * MSSZ + o.size);\r\n                        prep_blob(o.content, 0);\r\n                    }\r\n                }\r\n                files[name] = o;\r\n                FileIndex.push(o);\r\n            }\r\n        }\r\n\r\n        function read_date(blob, offset) {\r\n            return new Date((((__readUInt32LE(blob, offset + 4) / 1e7) * Math.pow(2, 32) + __readUInt32LE(blob, offset) / 1e7) - 11644473600) * 1000);\r\n        }\r\n\r\n        var fs;\r\n        function readFileSync(filename, options) {\r\n            if (fs === undefined) fs = require('fs');\r\n            return parse(fs.readFileSync(filename), options);\r\n        }\r\n\r\n        function readSync(blob, options) {\r\n            switch (options !== undefined && options.type !== undefined ? options.type : \"base64\") {\r\n                case \"file\": return readFileSync(blob, options);\r\n                case \"base64\": return parse(s2a(Base64.decode(blob)), options);\r\n                case \"binary\": return parse(s2a(blob), options);\r\n            }\r\n            return parse(blob);\r\n        }\r\n\r\n        /** CFB Constants */\r\n        var MSSZ = 64; /* Mini Sector Size = 1<<6 */\r\n        //var MSCSZ = 4096; /* Mini Stream Cutoff Size */\r\n        /* 2.1 Compound File Sector Numbers and Types */\r\n        var ENDOFCHAIN = -2;\r\n        /* 2.2 Compound File Header */\r\n        var HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\r\n        var HEADER_CLSID = '00000000000000000000000000000000';\r\n        var consts = {\r\n            /* 2.1 Compund File Sector Numbers and Types */\r\n            MAXREGSECT: -6,\r\n            DIFSECT: -4,\r\n            FATSECT: -3,\r\n            ENDOFCHAIN: ENDOFCHAIN,\r\n            FREESECT: -1,\r\n            /* 2.2 Compound File Header */\r\n            HEADER_SIGNATURE: HEADER_SIGNATURE,\r\n            HEADER_MINOR_VERSION: '3e00',\r\n            MAXREGSID: -6,\r\n            NOSTREAM: -1,\r\n            HEADER_CLSID: HEADER_CLSID,\r\n            /* 2.6.1 Compound File Directory Entry */\r\n            EntryTypes: ['unknown', 'storage', 'stream', 'lockbytes', 'property', 'root']\r\n        };\r\n\r\n        exports.read = readSync;\r\n        exports.parse = parse;\r\n        exports.utils = {\r\n            ReadShift: ReadShift,\r\n            CheckField: CheckField,\r\n            prep_blob: prep_blob,\r\n            bconcat: bconcat,\r\n            consts: consts\r\n        };\r\n\r\n        return exports;\r\n    })();\r\n\r\n    if (typeof require !== 'undefined' && typeof module !== 'undefined' && typeof DO_NOT_EXPORT_CFB === 'undefined') { module.exports = CFB; }\r\n    function isval(x) { return x !== undefined && x !== null; }\r\n\r\n    function keys(o) { return Object.keys(o); }\r\n\r\n    function evert_key(obj, key) {\r\n        var o = [], K = keys(obj);\r\n        for (var i = 0; i !== K.length; ++i) o[obj[K[i]][key]] = K[i];\r\n        return o;\r\n    }\r\n\r\n    function evert(obj) {\r\n        var o = [], K = keys(obj);\r\n        for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\r\n        return o;\r\n    }\r\n\r\n    function evert_num(obj) {\r\n        var o = [], K = keys(obj);\r\n        for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i], 10);\r\n        return o;\r\n    }\r\n\r\n    function evert_arr(obj) {\r\n        var o = [], K = keys(obj);\r\n        for (var i = 0; i !== K.length; ++i) {\r\n            if (o[obj[K[i]]] == null) o[obj[K[i]]] = [];\r\n            o[obj[K[i]]].push(K[i]);\r\n        }\r\n        return o;\r\n    }\r\n\r\n    /* TODO: date1904 logic */\r\n    function datenum(v, date1904) {\r\n        if (date1904) v += 1462;\r\n        var epoch = Date.parse(v);\r\n        return (epoch + 2209161600000) / (24 * 60 * 60 * 1000);\r\n    }\r\n\r\n    function cc2str(arr) {\r\n        var o = \"\";\r\n        for (var i = 0; i != arr.length; ++i) o += String.fromCharCode(arr[i]);\r\n        return o;\r\n    }\r\n\r\n    function getdata(data) {\r\n        if (!data) return null;\r\n        if (data.name.substr(-4) === \".bin\") {\r\n            if (data.data) return char_codes(data.data);\r\n            if (data.asNodeBuffer && has_buf) return data.asNodeBuffer();\r\n            if (data._data && data._data.getContent) return Array.prototype.slice.call(data._data.getContent());\r\n        } else {\r\n            if (data.data) return data.name.substr(-4) !== \".bin\" ? debom_xml(data.data) : char_codes(data.data);\r\n            if (data.asNodeBuffer && has_buf) return debom_xml(data.asNodeBuffer().toString('binary'));\r\n            if (data.asBinary) return debom_xml(data.asBinary());\r\n            if (data._data && data._data.getContent) return debom_xml(cc2str(Array.prototype.slice.call(data._data.getContent(), 0)));\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function safegetzipfile(zip, file) {\r\n        var f = file; if (zip.files[f]) return zip.files[f];\r\n        f = file.toLowerCase(); if (zip.files[f]) return zip.files[f];\r\n        f = f.replace(/\\//g, '\\\\'); if (zip.files[f]) return zip.files[f];\r\n        return null;\r\n    }\r\n\r\n    function getzipfile(zip, file) {\r\n        var o = safegetzipfile(zip, file);\r\n        if (o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\r\n        return o;\r\n    }\r\n\r\n    function getzipdata(zip, file, safe) {\r\n        if (!safe) return getdata(getzipfile(zip, file));\r\n        if (!file) return null;\r\n        try { return getzipdata(zip, file); } catch (e) { return null; }\r\n    }\r\n\r\n    var _fs, jszip;\r\n    if (typeof JSZip !== 'undefined') jszip = JSZip;\r\n    if (typeof exports !== 'undefined') {\r\n        if (typeof module !== 'undefined' && module.exports) {\r\n            if (has_buf && typeof jszip === 'undefined') jszip = require('js' + 'zip');\r\n            if (typeof jszip === 'undefined') jszip = require('./js' + 'zip').JSZip;\r\n            _fs = require('f' + 's');\r\n        }\r\n    }\r\n    var attregexg = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\r\n    var tagregex = /<[^>]*>/g;\r\n    var nsregex = /<\\w*:/, nsregex2 = /<(\\/?)\\w+:/;\r\n    function parsexmltag(tag, skip_root) {\r\n        var z = [];\r\n        var eq = 0, c = 0;\r\n        for (; eq !== tag.length; ++eq) if ((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\r\n        if (!skip_root) z[0] = tag.substr(0, eq);\r\n        if (eq === tag.length) return z;\r\n        var m = tag.match(attregexg), j = 0, w = \"\", v = \"\", i = 0, q = \"\", cc = \"\";\r\n        if (m) for (i = 0; i != m.length; ++i) {\r\n            cc = m[i];\r\n            for (c = 0; c != cc.length; ++c) if (cc.charCodeAt(c) === 61) break;\r\n            q = cc.substr(0, c); v = cc.substring(c + 2, cc.length - 1);\r\n            for (j = 0; j != q.length; ++j) if (q.charCodeAt(j) === 58) break;\r\n            if (j === q.length) z[q] = v;\r\n            else z[(j === 5 && q.substr(0, 5) === \"xmlns\" ? \"xmlns\" : \"\") + q.substr(j + 1)] = v;\r\n        }\r\n        return z;\r\n    }\r\n    function strip_ns(x) { return x.replace(nsregex2, \"<$1\"); }\r\n\r\n    var encodings = {\r\n        '&quot;': '\"',\r\n        '&apos;': \"'\",\r\n        '&gt;': '>',\r\n        '&lt;': '<',\r\n        '&amp;': '&'\r\n    };\r\n    var rencoding = evert(encodings);\r\n    var rencstr = \"&<>'\\\"\".split(\"\");\r\n\r\n    // TODO: CP remap (need to read file version to determine OS)\r\n    var unescapexml = (function () {\r\n        var encregex = /&[a-z]*;/g, coderegex = /_x([\\da-fA-F]+)_/g;\r\n        return function unescapexml(text) {\r\n            var s = text + '';\r\n            return s.replace(encregex, function ($$) { return encodings[$$]; }).replace(coderegex, function (m, c) { return String.fromCharCode(parseInt(c, 16)); });\r\n        };\r\n    })();\r\n\r\n    var decregex = /[&<>'\"]/g, charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\r\n    function escapexml(text) {\r\n        var s = text + '';\r\n        return s.replace(decregex, function (y) { return rencoding[y]; }).replace(charegex, function (s) { return \"_x\" + (\"000\" + s.charCodeAt(0).toString(16)).substr(-4) + \"_\"; });\r\n    }\r\n\r\n    /* TODO: handle codepages */\r\n    var xlml_fixstr = (function () {\r\n        var entregex = /&#(\\d+);/g;\r\n        function entrepl($$, $1) { return String.fromCharCode(parseInt($1, 10)); }\r\n        return function xlml_fixstr(str) { return str.replace(entregex, entrepl); };\r\n    })();\r\n\r\n    function parsexmlbool(value, tag) {\r\n        switch (value) {\r\n            case '1': case 'true': case 'TRUE': return true;\r\n            /* case '0': case 'false': case 'FALSE':*/\r\n            default: return false;\r\n        }\r\n    }\r\n\r\n    var utf8read = function utf8reada(orig) {\r\n        var out = \"\", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;\r\n        while (i < orig.length) {\r\n            c = orig.charCodeAt(i++);\r\n            if (c < 128) { out += String.fromCharCode(c); continue; }\r\n            d = orig.charCodeAt(i++);\r\n            if (c > 191 && c < 224) { out += String.fromCharCode(((c & 31) << 6) | (d & 63)); continue; }\r\n            e = orig.charCodeAt(i++);\r\n            if (c < 240) { out += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63)); continue; }\r\n            f = orig.charCodeAt(i++);\r\n            w = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63)) - 65536;\r\n            out += String.fromCharCode(0xD800 + ((w >>> 10) & 1023));\r\n            out += String.fromCharCode(0xDC00 + (w & 1023));\r\n        }\r\n        return out;\r\n    };\r\n\r\n\r\n    if (has_buf) {\r\n        var utf8readb = function utf8readb(data) {\r\n            var out = new Buffer(2 * data.length), w, i, j = 1, k = 0, ww = 0, c;\r\n            for (i = 0; i < data.length; i += j) {\r\n                j = 1;\r\n                if ((c = data.charCodeAt(i)) < 128) w = c;\r\n                else if (c < 224) { w = (c & 31) * 64 + (data.charCodeAt(i + 1) & 63); j = 2; }\r\n                else if (c < 240) { w = (c & 15) * 4096 + (data.charCodeAt(i + 1) & 63) * 64 + (data.charCodeAt(i + 2) & 63); j = 3; }\r\n                else {\r\n                    j = 4;\r\n                    w = (c & 7) * 262144 + (data.charCodeAt(i + 1) & 63) * 4096 + (data.charCodeAt(i + 2) & 63) * 64 + (data.charCodeAt(i + 3) & 63);\r\n                    w -= 65536; ww = 0xD800 + ((w >>> 10) & 1023); w = 0xDC00 + (w & 1023);\r\n                }\r\n                if (ww !== 0) { out[k++] = ww & 255; out[k++] = ww >>> 8; ww = 0; }\r\n                out[k++] = w % 256; out[k++] = w >>> 8;\r\n            }\r\n            out.length = k;\r\n            return out.toString('ucs2');\r\n        };\r\n        var corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\r\n        if (utf8read(corpus) == utf8readb(corpus)) utf8read = utf8readb;\r\n        var utf8readc = function utf8readc(data) { return Buffer(data, 'binary').toString('utf8'); };\r\n        if (utf8read(corpus) == utf8readc(corpus)) utf8read = utf8readc;\r\n    }\r\n\r\n    // matches <foo>...</foo> extracts content\r\n    var matchtag = (function () {\r\n        var mtcache = {};\r\n        return function matchtag(f, g) {\r\n            var t = f + \"|\" + g;\r\n            if (mtcache[t] !== undefined) return mtcache[t];\r\n            return (mtcache[t] = new RegExp('<(?:\\\\w+:)?' + f + '(?: xml:space=\"preserve\")?(?:[^>]*)>([^\\u2603]*)</(?:\\\\w+:)?' + f + '>', (g || \"\")));\r\n        };\r\n    })();\r\n\r\n    var vtregex = (function () {\r\n        var vt_cache = {};\r\n        return function vt_regex(bt) {\r\n            if (vt_cache[bt] !== undefined) return vt_cache[bt];\r\n            return (vt_cache[bt] = new RegExp(\"<vt:\" + bt + \">(.*?)</vt:\" + bt + \">\", 'g'));\r\n        };\r\n    })();\r\n    var vtvregex = /<\\/?vt:variant>/g, vtmregex = /<vt:([^>]*)>(.*)</;\r\n    function parseVector(data) {\r\n        var h = parsexmltag(data);\r\n\r\n        var matches = data.match(vtregex(h.baseType)) || [];\r\n        if (matches.length != h.size) throw \"unexpected vector length \" + matches.length + \" != \" + h.size;\r\n        var res = [];\r\n        matches.forEach(function (x) {\r\n            var v = x.replace(vtvregex, \"\").match(vtmregex);\r\n            res.push({ v: v[2], t: v[1] });\r\n        });\r\n        return res;\r\n    }\r\n\r\n    var wtregex = /(^\\s|\\s$|\\n)/;\r\n    function writetag(f, g) { return '<' + f + (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>'; }\r\n\r\n    function wxt_helper(h) { return keys(h).map(function (k) { return \" \" + k + '=\"' + h[k] + '\"'; }).join(\"\"); }\r\n    function writextag(f, g, h) { return '<' + f + (isval(h) ? wxt_helper(h) : \"\") + (isval(g) ? (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>'; }\r\n\r\n    function write_w3cdtf(d, t) { try { return d.toISOString().replace(/\\.\\d*/, \"\"); } catch (e) { if (t) throw e; } }\r\n\r\n    function write_vt(s) {\r\n        switch (typeof s) {\r\n            case 'string': return writextag('vt:lpwstr', s);\r\n            case 'number': return writextag((s | 0) == s ? 'vt:i4' : 'vt:r8', String(s));\r\n            case 'boolean': return writextag('vt:bool', s ? 'true' : 'false');\r\n        }\r\n        if (s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\r\n        throw new Error(\"Unable to serialize \" + s);\r\n    }\r\n\r\n    var XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\r\n    var XMLNS = {\r\n        'dc': 'http://purl.org/dc/elements/1.1/',\r\n        'dcterms': 'http://purl.org/dc/terms/',\r\n        'dcmitype': 'http://purl.org/dc/dcmitype/',\r\n        'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\r\n        'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\r\n        'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\r\n        'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\r\n        'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\r\n        'xsd': 'http://www.w3.org/2001/XMLSchema'\r\n    };\r\n\r\n    XMLNS.main = [\r\n        'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\r\n        'http://purl.oclc.org/ooxml/spreadsheetml/main',\r\n        'http://schemas.microsoft.com/office/excel/2006/main',\r\n        'http://schemas.microsoft.com/office/excel/2006/2'\r\n    ];\r\n\r\n    function readIEEE754(buf, idx, isLE, nl, ml) {\r\n        if (isLE === undefined) isLE = true;\r\n        if (!nl) nl = 8;\r\n        if (!ml && nl === 8) ml = 52;\r\n        var e, m, el = nl * 8 - ml - 1, eMax = (1 << el) - 1, eBias = eMax >> 1;\r\n        var bits = -7, d = isLE ? -1 : 1, i = isLE ? (nl - 1) : 0, s = buf[idx + i];\r\n\r\n        i += d;\r\n        e = s & ((1 << (-bits)) - 1); s >>>= (-bits); bits += el;\r\n        for (; bits > 0; e = e * 256 + buf[idx + i], i += d, bits -= 8);\r\n        m = e & ((1 << (-bits)) - 1); e >>>= (-bits); bits += ml;\r\n        for (; bits > 0; m = m * 256 + buf[idx + i], i += d, bits -= 8);\r\n        if (e === eMax) return m ? NaN : ((s ? -1 : 1) * Infinity);\r\n        else if (e === 0) e = 1 - eBias;\r\n        else { m = m + Math.pow(2, ml); e = e - eBias; }\r\n        return (s ? -1 : 1) * m * Math.pow(2, e - ml);\r\n    }\r\n\r\n    var __toBuffer, ___toBuffer;\r\n    __toBuffer = ___toBuffer = function toBuffer_(bufs) { var x = []; for (var i = 0; i < bufs[0].length; ++i) { x.push.apply(x, bufs[0][i]); } return x; };\r\n    var __utf16le, ___utf16le;\r\n    __utf16le = ___utf16le = function utf16le_(b, s, e) { var ss = []; for (var i = s; i < e; i += 2) ss.push(String.fromCharCode(__readUInt16LE(b, i))); return ss.join(\"\"); };\r\n    var __hexlify, ___hexlify;\r\n    __hexlify = ___hexlify = function hexlify_(b, s, l) { return b.slice(s, (s + l)).map(function (x) { return (x < 16 ? \"0\" : \"\") + x.toString(16); }).join(\"\"); };\r\n    var __utf8, ___utf8;\r\n    __utf8 = ___utf8 = function (b, s, e) { var ss = []; for (var i = s; i < e; i++) ss.push(String.fromCharCode(__readUInt8(b, i))); return ss.join(\"\"); };\r\n    var __lpstr, ___lpstr;\r\n    __lpstr = ___lpstr = function lpstr_(b, i) { var len = __readUInt32LE(b, i); return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\"; };\r\n    var __lpwstr, ___lpwstr;\r\n    __lpwstr = ___lpwstr = function lpwstr_(b, i) { var len = 2 * __readUInt32LE(b, i); return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\"; };\r\n    var __double, ___double;\r\n    __double = ___double = function (b, idx) { return readIEEE754(b, idx); };\r\n\r\n    var is_buf = function is_buf_a(a) { return Array.isArray(a); };\r\n    if (has_buf) {\r\n        __utf16le = function utf16le_b(b, s, e) { if (!Buffer.isBuffer(b)) return ___utf16le(b, s, e); return b.toString('utf16le', s, e); };\r\n        __hexlify = function (b, s, l) { return Buffer.isBuffer(b) ? b.toString('hex', s, s + l) : ___hexlify(b, s, l); };\r\n        __lpstr = function lpstr_b(b, i) { if (!Buffer.isBuffer(b)) return ___lpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\"; };\r\n        __lpwstr = function lpwstr_b(b, i) { if (!Buffer.isBuffer(b)) return ___lpwstr(b, i); var len = 2 * b.readUInt32LE(i); return b.toString('utf16le', i + 4, i + 4 + len - 1); };\r\n        __utf8 = function utf8_b(s, e) { return this.toString('utf8', s, e); };\r\n        __toBuffer = function (bufs) { return (bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0])) ? Buffer.concat(bufs[0]) : ___toBuffer(bufs); };\r\n        bconcat = function (bufs) { return Buffer.isBuffer(bufs[0]) ? Buffer.concat(bufs) : [].concat.apply([], bufs); };\r\n        __double = function double_(b, i) { if (Buffer.isBuffer(b)) return b.readDoubleLE(i); return ___double(b, i); };\r\n        is_buf = function is_buf_b(a) { return Buffer.isBuffer(a) || Array.isArray(a); };\r\n    }\r\n\r\n    /* from js-xls */\r\n    if (typeof cptable !== 'undefined') {\r\n        __utf16le = function (b, s, e) { return cptable.utils.decode(1200, b.slice(s, e)); };\r\n        __utf8 = function (b, s, e) { return cptable.utils.decode(65001, b.slice(s, e)); };\r\n        __lpstr = function (b, i) { var len = __readUInt32LE(b, i); return len > 0 ? cptable.utils.decode(current_codepage, b.slice(i + 4, i + 4 + len - 1)) : \"\"; };\r\n        __lpwstr = function (b, i) { var len = 2 * __readUInt32LE(b, i); return len > 0 ? cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len - 1)) : \"\"; };\r\n    }\r\n\r\n    var __readUInt8 = function (b, idx) { return b[idx]; };\r\n    var __readUInt16LE = function (b, idx) { return b[idx + 1] * (1 << 8) + b[idx]; };\r\n    var __readInt16LE = function (b, idx) { var u = b[idx + 1] * (1 << 8) + b[idx]; return (u < 0x8000) ? u : (0xffff - u + 1) * -1; };\r\n    var __readUInt32LE = function (b, idx) { return b[idx + 3] * (1 << 24) + (b[idx + 2] << 16) + (b[idx + 1] << 8) + b[idx]; };\r\n    var __readInt32LE = function (b, idx) { return (b[idx + 3] << 24) | (b[idx + 2] << 16) | (b[idx + 1] << 8) | b[idx]; };\r\n\r\n    var ___unhexlify = function (s) { return s.match(/../g).map(function (x) { return parseInt(x, 16); }); };\r\n    var __unhexlify = typeof Buffer !== \"undefined\" ? function (s) { return Buffer.isBuffer(s) ? new Buffer(s, 'hex') : ___unhexlify(s); } : ___unhexlify;\r\n\r\n    function ReadShift(size, t) {\r\n        var o = \"\", oI, oR, oo = [], w, vv, i, loc;\r\n        switch (t) {\r\n            case 'dbcs':\r\n                loc = this.l;\r\n                if (has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l + 2 * size).toString(\"utf16le\");\r\n                else for (i = 0; i != size; ++i) { o += String.fromCharCode(__readUInt16LE(this, loc)); loc += 2; }\r\n                size *= 2;\r\n                break;\r\n\r\n            case 'utf8': o = __utf8(this, this.l, this.l + size); break;\r\n            case 'utf16le': size *= 2; o = __utf16le(this, this.l, this.l + size); break;\r\n\r\n            /* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\r\n            case 'lpstr': o = __lpstr(this, this.l); size = 5 + o.length; break;\r\n            /* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\r\n            case 'lpwstr': o = __lpwstr(this, this.l); size = 5 + o.length; if (o[o.length - 1] == '\\u0000') size += 2; break;\r\n\r\n            case 'cstr': size = 0; o = \"\";\r\n                while ((w = __readUInt8(this, this.l + size++)) !== 0) oo.push(_getchar(w));\r\n                o = oo.join(\"\"); break;\r\n            case 'wstr': size = 0; o = \"\";\r\n                while ((w = __readUInt16LE(this, this.l + size)) !== 0) { oo.push(_getchar(w)); size += 2; }\r\n                size += 2; o = oo.join(\"\"); break;\r\n\r\n            /* sbcs and dbcs support continue records in the SST way TODO codepages */\r\n            case 'dbcs-cont': o = \"\"; loc = this.l;\r\n                for (i = 0; i != size; ++i) {\r\n                    if (this.lens && this.lens.indexOf(loc) !== -1) {\r\n                        w = __readUInt8(this, loc);\r\n                        this.l = loc + 1;\r\n                        vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\r\n                        return oo.join(\"\") + vv;\r\n                    }\r\n                    oo.push(_getchar(__readUInt16LE(this, loc)));\r\n                    loc += 2;\r\n                } o = oo.join(\"\"); size *= 2; break;\r\n\r\n            case 'sbcs-cont': o = \"\"; loc = this.l;\r\n                for (i = 0; i != size; ++i) {\r\n                    if (this.lens && this.lens.indexOf(loc) !== -1) {\r\n                        w = __readUInt8(this, loc);\r\n                        this.l = loc + 1;\r\n                        vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\r\n                        return oo.join(\"\") + vv;\r\n                    }\r\n                    oo.push(_getchar(__readUInt8(this, loc)));\r\n                    loc += 1;\r\n                } o = oo.join(\"\"); break;\r\n\r\n            default:\r\n                switch (size) {\r\n                    case 1: oI = __readUInt8(this, this.l); this.l++; return oI;\r\n                    case 2: oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l); this.l += 2; return oI;\r\n                    case 4:\r\n                        if (t === 'i' || (this[this.l + 3] & 0x80) === 0) { oI = __readInt32LE(this, this.l); this.l += 4; return oI; }\r\n                        else { oR = __readUInt32LE(this, this.l); this.l += 4; return oR; } break;\r\n                    case 8: if (t === 'f') { oR = __double(this, this.l); this.l += 8; return oR; }\r\n                    /* falls through */\r\n                    case 16: o = __hexlify(this, this.l, size); break;\r\n                }\r\n        }\r\n        this.l += size; return o;\r\n    }\r\n\r\n    function WriteShift(t, val, f) {\r\n        var size, i;\r\n        if (f === 'dbcs') {\r\n            for (i = 0; i != val.length; ++i) this.writeUInt16LE(val.charCodeAt(i), this.l + 2 * i);\r\n            size = 2 * val.length;\r\n        } else switch (t) {\r\n            case 1: size = 1; this[this.l] = val & 255; break;\r\n            case 3: size = 3; this[this.l + 2] = val & 255; val >>>= 8; this[this.l + 1] = val & 255; val >>>= 8; this[this.l] = val & 255; break;\r\n            case 4: size = 4; this.writeUInt32LE(val, this.l); break;\r\n            case 8: size = 8; if (f === 'f') { this.writeDoubleLE(val, this.l); break; }\r\n            /* falls through */\r\n            case 16: break;\r\n            case -4: size = 4; this.writeInt32LE(val, this.l); break;\r\n        }\r\n        this.l += size; return this;\r\n    }\r\n\r\n    function CheckField(hexstr, fld) {\r\n        var m = __hexlify(this, this.l, hexstr.length >> 1);\r\n        if (m !== hexstr) throw fld + 'Expected ' + hexstr + ' saw ' + m;\r\n        this.l += hexstr.length >> 1;\r\n    }\r\n\r\n    function prep_blob(blob, pos) {\r\n        blob.l = pos;\r\n        blob.read_shift = ReadShift;\r\n        blob.chk = CheckField;\r\n        blob.write_shift = WriteShift;\r\n    }\r\n\r\n    function parsenoop(blob, length) { blob.l += length; }\r\n\r\n    function writenoop(blob, length) { blob.l += length; }\r\n\r\n    function new_buf(sz) {\r\n        var o = new_raw_buf(sz);\r\n        prep_blob(o, 0);\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.4 Record */\r\n    function recordhopper(data, cb, opts) {\r\n        var tmpbyte, cntbyte, length;\r\n        prep_blob(data, data.l || 0);\r\n        while (data.l < data.length) {\r\n            var RT = data.read_shift(1);\r\n            if (RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F) << 7);\r\n            var R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\r\n            tmpbyte = data.read_shift(1);\r\n            length = tmpbyte & 0x7F;\r\n            for (cntbyte = 1; cntbyte < 4 && (tmpbyte & 0x80); ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F) << (7 * cntbyte);\r\n            var d = R.f(data, length, opts);\r\n            if (cb(d, R, RT)) return;\r\n        }\r\n    }\r\n\r\n    /* control buffer usage for fixed-length buffers */\r\n    function buf_array() {\r\n        var bufs = [], blksz = 2048;\r\n        var newblk = function ba_newblk(sz) {\r\n            var o = new_buf(sz);\r\n            prep_blob(o, 0);\r\n            return o;\r\n        };\r\n\r\n        var curbuf = newblk(blksz);\r\n\r\n        var endbuf = function ba_endbuf() {\r\n            curbuf.length = curbuf.l;\r\n            if (curbuf.length > 0) bufs.push(curbuf);\r\n            curbuf = null;\r\n        };\r\n\r\n        var next = function ba_next(sz) {\r\n            if (sz < curbuf.length - curbuf.l) return curbuf;\r\n            endbuf();\r\n            return (curbuf = newblk(Math.max(sz + 1, blksz)));\r\n        };\r\n\r\n        var end = function ba_end() {\r\n            endbuf();\r\n            return __toBuffer([bufs]);\r\n        };\r\n\r\n        var push = function ba_push(buf) { endbuf(); curbuf = buf; next(blksz); };\r\n\r\n        return { next: next, push: push, end: end, _bufs: bufs };\r\n    }\r\n\r\n    function write_record(ba, type, payload, length) {\r\n        var t = evert_RE[type], l;\r\n        if (!length) length = XLSBRecordEnum[t].p || (payload || []).length || 0;\r\n        l = 1 + (t >= 0x80 ? 1 : 0) + 1 + length;\r\n        if (length >= 0x80)++l; if (length >= 0x4000)++l; if (length >= 0x200000)++l;\r\n        var o = ba.next(l);\r\n        if (t <= 0x7F) o.write_shift(1, t);\r\n        else {\r\n            o.write_shift(1, (t & 0x7F) + 0x80);\r\n            o.write_shift(1, (t >> 7));\r\n        }\r\n        for (var i = 0; i != 4; ++i) {\r\n            if (length >= 0x80) { o.write_shift(1, (length & 0x7F) + 0x80); length >>= 7; }\r\n            else { o.write_shift(1, length); break; }\r\n        }\r\n        if (length > 0 && is_buf(payload)) ba.push(payload);\r\n    }\r\n    /* XLS ranges enforced */\r\n    function shift_cell_xls(cell, tgt) {\r\n        if (tgt.s) {\r\n            if (cell.cRel) cell.c += tgt.s.c;\r\n            if (cell.rRel) cell.r += tgt.s.r;\r\n        } else {\r\n            cell.c += tgt.c;\r\n            cell.r += tgt.r;\r\n        }\r\n        cell.cRel = cell.rRel = 0;\r\n        while (cell.c >= 0x100) cell.c -= 0x100;\r\n        while (cell.r >= 0x10000) cell.r -= 0x10000;\r\n        return cell;\r\n    }\r\n\r\n    function shift_range_xls(cell, range) {\r\n        cell.s = shift_cell_xls(cell.s, range.s);\r\n        cell.e = shift_cell_xls(cell.e, range.s);\r\n        return cell;\r\n    }\r\n\r\n    var OFFCRYPTO = {};\r\n    var make_offcrypto = function (O, _crypto) {\r\n        var crypto;\r\n        if (typeof _crypto !== 'undefined') crypto = _crypto;\r\n        else if (typeof require !== 'undefined') {\r\n            try { crypto = require('cry' + 'pto'); }\r\n            catch (e) { crypto = null; }\r\n        }\r\n\r\n        O.rc4 = function (key, data) {\r\n            var S = new Array(256);\r\n            var c = 0, i = 0, j = 0, t = 0;\r\n            for (i = 0; i != 256; ++i) S[i] = i;\r\n            for (i = 0; i != 256; ++i) {\r\n                j = (j + S[i] + (key[i % key.length]).charCodeAt(0)) & 255;\r\n                t = S[i]; S[i] = S[j]; S[j] = t;\r\n            }\r\n            i = j = 0; out = Buffer(data.length);\r\n            for (c = 0; c != data.length; ++c) {\r\n                i = (i + 1) & 255;\r\n                j = (j + S[i]) % 256;\r\n                t = S[i]; S[i] = S[j]; S[j] = t;\r\n                out[c] = (data[c] ^ S[(S[i] + S[j]) & 255]);\r\n            }\r\n            return out;\r\n        };\r\n\r\n        if (crypto) {\r\n            O.md5 = function (hex) { return crypto.createHash('md5').update(hex).digest('hex'); };\r\n        } else {\r\n            O.md5 = function (hex) { throw \"unimplemented\"; };\r\n        }\r\n    };\r\n    make_offcrypto(OFFCRYPTO, typeof crypto !== \"undefined\" ? crypto : undefined);\r\n\r\n\r\n    /* [MS-XLSB] 2.5.143 */\r\n    function parse_StrRun(data, length) {\r\n        return { ich: data.read_shift(2), ifnt: data.read_shift(2) };\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.7.121 */\r\n    function parse_RichStr(data, length) {\r\n        var start = data.l;\r\n        var flags = data.read_shift(1);\r\n        var str = parse_XLWideString(data);\r\n        var rgsStrRun = [];\r\n        var z = { t: str, h: str };\r\n        if ((flags & 1) !== 0) { /* fRichStr */\r\n            /* TODO: formatted string */\r\n            var dwSizeStrRun = data.read_shift(4);\r\n            for (var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\r\n            z.r = rgsStrRun;\r\n        }\r\n        else z.r = \"<t>\" + escapexml(str) + \"</t>\";\r\n        if ((flags & 2) !== 0) { /* fExtStr */\r\n            /* TODO: phonetic string */\r\n        }\r\n        data.l = start + length;\r\n        return z;\r\n    }\r\n    function write_RichStr(str, o) {\r\n        /* TODO: formatted string */\r\n        if (o == null) o = new_buf(5 + 2 * str.t.length);\r\n        o.write_shift(1, 0);\r\n        write_XLWideString(str.t, o);\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.5.9 */\r\n    function parse_XLSBCell(data) {\r\n        var col = data.read_shift(4);\r\n        var iStyleRef = data.read_shift(2);\r\n        iStyleRef += data.read_shift(1) << 16;\r\n        var fPhShow = data.read_shift(1);\r\n        return { c: col, iStyleRef: iStyleRef };\r\n    }\r\n    function write_XLSBCell(cell, o) {\r\n        if (o == null) o = new_buf(8);\r\n        o.write_shift(-4, cell.c);\r\n        o.write_shift(3, cell.iStyleRef === undefined ? cell.iStyleRef : cell.s);\r\n        o.write_shift(1, 0); /* fPhShow */\r\n        return o;\r\n    }\r\n\r\n\r\n    /* [MS-XLSB] 2.5.21 */\r\n    function parse_XLSBCodeName(data, length) { return parse_XLWideString(data, length); }\r\n\r\n    /* [MS-XLSB] 2.5.166 */\r\n    function parse_XLNullableWideString(data) {\r\n        var cchCharacters = data.read_shift(4);\r\n        return cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\r\n    }\r\n    function write_XLNullableWideString(data, o) {\r\n        if (!o) o = new_buf(127);\r\n        o.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\r\n        if (data.length > 0) o.write_shift(0, data, 'dbcs');\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.5.168 */\r\n    function parse_XLWideString(data) {\r\n        var cchCharacters = data.read_shift(4);\r\n        return cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\r\n    }\r\n    function write_XLWideString(data, o) {\r\n        if (o == null) o = new_buf(4 + 2 * data.length);\r\n        o.write_shift(4, data.length);\r\n        if (data.length > 0) o.write_shift(0, data, 'dbcs');\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.5.114 */\r\n    var parse_RelID = parse_XLNullableWideString;\r\n    var write_RelID = write_XLNullableWideString;\r\n\r\n\r\n    /* [MS-XLSB] 2.5.122 */\r\n    /* [MS-XLS] 2.5.217 */\r\n    function parse_RkNumber(data) {\r\n        var b = data.slice(data.l, data.l + 4);\r\n        var fX100 = b[0] & 1, fInt = b[0] & 2;\r\n        data.l += 4;\r\n        b[0] &= 0xFC; // b[0] &= ~3;\r\n        var RK = fInt === 0 ? __double([0, 0, 0, 0, b[0], b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\r\n        return fX100 ? RK / 100 : RK;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.5.153 */\r\n    function parse_UncheckedRfX(data) {\r\n        var cell = { s: {}, e: {} };\r\n        cell.s.r = data.read_shift(4);\r\n        cell.e.r = data.read_shift(4);\r\n        cell.s.c = data.read_shift(4);\r\n        cell.e.c = data.read_shift(4);\r\n        return cell;\r\n    }\r\n\r\n    function write_UncheckedRfX(r, o) {\r\n        if (!o) o = new_buf(16);\r\n        o.write_shift(4, r.s.r);\r\n        o.write_shift(4, r.e.r);\r\n        o.write_shift(4, r.s.c);\r\n        o.write_shift(4, r.e.c);\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.5.171 */\r\n    /* [MS-XLS] 2.5.342 */\r\n    function parse_Xnum(data, length) { return data.read_shift(8, 'f'); }\r\n    function write_Xnum(data, o) { return (o || new_buf(8)).write_shift(8, 'f', data); }\r\n\r\n    /* [MS-XLSB] 2.5.198.2 */\r\n    var BErr = {\r\n        0x00: \"#NULL!\",\r\n        0x07: \"#DIV/0!\",\r\n        0x0F: \"#VALUE!\",\r\n        0x17: \"#REF!\",\r\n        0x1D: \"#NAME?\",\r\n        0x24: \"#NUM!\",\r\n        0x2A: \"#N/A\",\r\n        0x2B: \"#GETTING_DATA\",\r\n        0xFF: \"#WTF?\"\r\n    };\r\n    var RBErr = evert_num(BErr);\r\n\r\n    /* [MS-XLSB] 2.4.321 BrtColor */\r\n    function parse_BrtColor(data, length) {\r\n        var out = {};\r\n        var d = data.read_shift(1);\r\n        out.fValidRGB = d & 1;\r\n        out.xColorType = d >>> 1;\r\n        out.index = data.read_shift(1);\r\n        out.nTintAndShade = data.read_shift(2, 'i');\r\n        out.bRed = data.read_shift(1);\r\n        out.bGreen = data.read_shift(1);\r\n        out.bBlue = data.read_shift(1);\r\n        out.bAlpha = data.read_shift(1);\r\n    }\r\n\r\n    /* [MS-XLSB] 2.5.52 */\r\n    function parse_FontFlags(data, length) {\r\n        var d = data.read_shift(1);\r\n        data.l++;\r\n        var out = {\r\n            fItalic: d & 0x2,\r\n            fStrikeout: d & 0x8,\r\n            fOutline: d & 0x10,\r\n            fShadow: d & 0x20,\r\n            fCondense: d & 0x40,\r\n            fExtend: d & 0x80\r\n        };\r\n        return out;\r\n    }\r\n    /* [MS-OLEPS] 2.2 PropertyType */\r\n    {\r\n        var VT_EMPTY = 0x0000;\r\n        var VT_NULL = 0x0001;\r\n        var VT_I2 = 0x0002;\r\n        var VT_I4 = 0x0003;\r\n        var VT_R4 = 0x0004;\r\n        var VT_R8 = 0x0005;\r\n        var VT_CY = 0x0006;\r\n        var VT_DATE = 0x0007;\r\n        var VT_BSTR = 0x0008;\r\n        var VT_ERROR = 0x000A;\r\n        var VT_BOOL = 0x000B;\r\n        var VT_VARIANT = 0x000C;\r\n        var VT_DECIMAL = 0x000E;\r\n        var VT_I1 = 0x0010;\r\n        var VT_UI1 = 0x0011;\r\n        var VT_UI2 = 0x0012;\r\n        var VT_UI4 = 0x0013;\r\n        var VT_I8 = 0x0014;\r\n        var VT_UI8 = 0x0015;\r\n        var VT_INT = 0x0016;\r\n        var VT_UINT = 0x0017;\r\n        var VT_LPSTR = 0x001E;\r\n        var VT_LPWSTR = 0x001F;\r\n        var VT_FILETIME = 0x0040;\r\n        var VT_BLOB = 0x0041;\r\n        var VT_STREAM = 0x0042;\r\n        var VT_STORAGE = 0x0043;\r\n        var VT_STREAMED_Object = 0x0044;\r\n        var VT_STORED_Object = 0x0045;\r\n        var VT_BLOB_Object = 0x0046;\r\n        var VT_CF = 0x0047;\r\n        var VT_CLSID = 0x0048;\r\n        var VT_VERSIONED_STREAM = 0x0049;\r\n        var VT_VECTOR = 0x1000;\r\n        var VT_ARRAY = 0x2000;\r\n\r\n        var VT_STRING = 0x0050; // 2.3.3.1.11 VtString\r\n        var VT_USTR = 0x0051; // 2.3.3.1.12 VtUnalignedString\r\n        var VT_CUSTOM = [VT_STRING, VT_USTR];\r\n    }\r\n\r\n    /* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\r\n    var DocSummaryPIDDSI = {\r\n        0x01: { n: 'CodePage', t: VT_I2 },\r\n        0x02: { n: 'Category', t: VT_STRING },\r\n        0x03: { n: 'PresentationFormat', t: VT_STRING },\r\n        0x04: { n: 'ByteCount', t: VT_I4 },\r\n        0x05: { n: 'LineCount', t: VT_I4 },\r\n        0x06: { n: 'ParagraphCount', t: VT_I4 },\r\n        0x07: { n: 'SlideCount', t: VT_I4 },\r\n        0x08: { n: 'NoteCount', t: VT_I4 },\r\n        0x09: { n: 'HiddenCount', t: VT_I4 },\r\n        0x0a: { n: 'MultimediaClipCount', t: VT_I4 },\r\n        0x0b: { n: 'Scale', t: VT_BOOL },\r\n        0x0c: { n: 'HeadingPair', t: VT_VECTOR | VT_VARIANT },\r\n        0x0d: { n: 'DocParts', t: VT_VECTOR | VT_LPSTR },\r\n        0x0e: { n: 'Manager', t: VT_STRING },\r\n        0x0f: { n: 'Company', t: VT_STRING },\r\n        0x10: { n: 'LinksDirty', t: VT_BOOL },\r\n        0x11: { n: 'CharacterCount', t: VT_I4 },\r\n        0x13: { n: 'SharedDoc', t: VT_BOOL },\r\n        0x16: { n: 'HLinksChanged', t: VT_BOOL },\r\n        0x17: { n: 'AppVersion', t: VT_I4, p: 'version' },\r\n        0x1A: { n: 'ContentType', t: VT_STRING },\r\n        0x1B: { n: 'ContentStatus', t: VT_STRING },\r\n        0x1C: { n: 'Language', t: VT_STRING },\r\n        0x1D: { n: 'Version', t: VT_STRING },\r\n        0xFF: {}\r\n    };\r\n\r\n    /* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\r\n    var SummaryPIDSI = {\r\n        0x01: { n: 'CodePage', t: VT_I2 },\r\n        0x02: { n: 'Title', t: VT_STRING },\r\n        0x03: { n: 'Subject', t: VT_STRING },\r\n        0x04: { n: 'Author', t: VT_STRING },\r\n        0x05: { n: 'Keywords', t: VT_STRING },\r\n        0x06: { n: 'Comments', t: VT_STRING },\r\n        0x07: { n: 'Template', t: VT_STRING },\r\n        0x08: { n: 'LastAuthor', t: VT_STRING },\r\n        0x09: { n: 'RevNumber', t: VT_STRING },\r\n        0x0A: { n: 'EditTime', t: VT_FILETIME },\r\n        0x0B: { n: 'LastPrinted', t: VT_FILETIME },\r\n        0x0C: { n: 'CreatedDate', t: VT_FILETIME },\r\n        0x0D: { n: 'ModifiedDate', t: VT_FILETIME },\r\n        0x0E: { n: 'PageCount', t: VT_I4 },\r\n        0x0F: { n: 'WordCount', t: VT_I4 },\r\n        0x10: { n: 'CharCount', t: VT_I4 },\r\n        0x11: { n: 'Thumbnail', t: VT_CF },\r\n        0x12: { n: 'ApplicationName', t: VT_LPSTR },\r\n        0x13: { n: 'DocumentSecurity', t: VT_I4 },\r\n        0xFF: {}\r\n    };\r\n\r\n    /* [MS-OLEPS] 2.18 */\r\n    var SpecialProperties = {\r\n        0x80000000: { n: 'Locale', t: VT_UI4 },\r\n        0x80000003: { n: 'Behavior', t: VT_UI4 },\r\n        0x72627262: {}\r\n    };\r\n\r\n    (function () {\r\n        for (var y in SpecialProperties) if (SpecialProperties.hasOwnProperty(y))\r\n            DocSummaryPIDDSI[y] = SummaryPIDSI[y] = SpecialProperties[y];\r\n    })();\r\n\r\n    /* [MS-XLS] 2.4.63 Country/Region codes */\r\n    var CountryEnum = {\r\n        0x0001: \"US\", // United States\r\n        0x0002: \"CA\", // Canada\r\n        0x0003: \"\", // Latin America (except Brazil)\r\n        0x0007: \"RU\", // Russia\r\n        0x0014: \"EG\", // Egypt\r\n        0x001E: \"GR\", // Greece\r\n        0x001F: \"NL\", // Netherlands\r\n        0x0020: \"BE\", // Belgium\r\n        0x0021: \"FR\", // France\r\n        0x0022: \"ES\", // Spain\r\n        0x0024: \"HU\", // Hungary\r\n        0x0027: \"IT\", // Italy\r\n        0x0029: \"CH\", // Switzerland\r\n        0x002B: \"AT\", // Austria\r\n        0x002C: \"GB\", // United Kingdom\r\n        0x002D: \"DK\", // Denmark\r\n        0x002E: \"SE\", // Sweden\r\n        0x002F: \"NO\", // Norway\r\n        0x0030: \"PL\", // Poland\r\n        0x0031: \"DE\", // Germany\r\n        0x0034: \"MX\", // Mexico\r\n        0x0037: \"BR\", // Brazil\r\n        0x003d: \"AU\", // Australia\r\n        0x0040: \"NZ\", // New Zealand\r\n        0x0042: \"TH\", // Thailand\r\n        0x0051: \"JP\", // Japan\r\n        0x0052: \"KR\", // Korea\r\n        0x0054: \"VN\", // Viet Nam\r\n        0x0056: \"CN\", // China\r\n        0x005A: \"TR\", // Turkey\r\n        0x0069: \"JS\", // Ramastan\r\n        0x00D5: \"DZ\", // Algeria\r\n        0x00D8: \"MA\", // Morocco\r\n        0x00DA: \"LY\", // Libya\r\n        0x015F: \"PT\", // Portugal\r\n        0x0162: \"IS\", // Iceland\r\n        0x0166: \"FI\", // Finland\r\n        0x01A4: \"CZ\", // Czech Republic\r\n        0x0376: \"TW\", // Taiwan\r\n        0x03C1: \"LB\", // Lebanon\r\n        0x03C2: \"JO\", // Jordan\r\n        0x03C3: \"SY\", // Syria\r\n        0x03C4: \"IQ\", // Iraq\r\n        0x03C5: \"KW\", // Kuwait\r\n        0x03C6: \"SA\", // Saudi Arabia\r\n        0x03CB: \"AE\", // United Arab Emirates\r\n        0x03CC: \"IL\", // Israel\r\n        0x03CE: \"QA\", // Qatar\r\n        0x03D5: \"IR\", // Iran\r\n        0xFFFF: \"US\"  // United States\r\n    };\r\n\r\n    /* [MS-XLS] 2.5.127 */\r\n    var XLSFillPattern = [\r\n        null,\r\n        'solid',\r\n        'mediumGray',\r\n        'darkGray',\r\n        'lightGray',\r\n        'darkHorizontal',\r\n        'darkVertical',\r\n        'darkDown',\r\n        'darkUp',\r\n        'darkGrid',\r\n        'darkTrellis',\r\n        'lightHorizontal',\r\n        'lightVertical',\r\n        'lightDown',\r\n        'lightUp',\r\n        'lightGrid',\r\n        'lightTrellis',\r\n        'gray125',\r\n        'gray0625'\r\n    ];\r\n\r\n    function rgbify(arr) { return arr.map(function (x) { return [(x >> 16) & 255, (x >> 8) & 255, x & 255]; }); }\r\n\r\n    /* [MS-XLS] 2.5.161 */\r\n    var XLSIcv = rgbify([\r\n        /* Color Constants */\r\n        0x000000,\r\n        0xFFFFFF,\r\n        0xFF0000,\r\n        0x00FF00,\r\n        0x0000FF,\r\n        0xFFFF00,\r\n        0xFF00FF,\r\n        0x00FFFF,\r\n\r\n        /* Defaults */\r\n        0x000000,\r\n        0xFFFFFF,\r\n        0xFF0000,\r\n        0x00FF00,\r\n        0x0000FF,\r\n        0xFFFF00,\r\n        0xFF00FF,\r\n        0x00FFFF,\r\n\r\n        0x800000,\r\n        0x008000,\r\n        0x000080,\r\n        0x808000,\r\n        0x800080,\r\n        0x008080,\r\n        0xC0C0C0,\r\n        0x808080,\r\n        0x9999FF,\r\n        0x993366,\r\n        0xFFFFCC,\r\n        0xCCFFFF,\r\n        0x660066,\r\n        0xFF8080,\r\n        0x0066CC,\r\n        0xCCCCFF,\r\n\r\n        0x000080,\r\n        0xFF00FF,\r\n        0xFFFF00,\r\n        0x00FFFF,\r\n        0x800080,\r\n        0x800000,\r\n        0x008080,\r\n        0x0000FF,\r\n        0x00CCFF,\r\n        0xCCFFFF,\r\n        0xCCFFCC,\r\n        0xFFFF99,\r\n        0x99CCFF,\r\n        0xFF99CC,\r\n        0xCC99FF,\r\n        0xFFCC99,\r\n\r\n        0x3366FF,\r\n        0x33CCCC,\r\n        0x99CC00,\r\n        0xFFCC00,\r\n        0xFF9900,\r\n        0xFF6600,\r\n        0x666699,\r\n        0x969696,\r\n        0x003366,\r\n        0x339966,\r\n        0x003300,\r\n        0x333300,\r\n        0x993300,\r\n        0x993366,\r\n        0x333399,\r\n        0x333333,\r\n\r\n        /* Sheet */\r\n        0xFFFFFF,\r\n        0x000000\r\n    ]);\r\n\r\n    /* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\r\n    /* 12.3 Part Summary <SpreadsheetML> */\r\n    /* 14.2 Part Summary <DrawingML> */\r\n    /* [MS-XLSX] 2.1 Part Enumerations */\r\n    /* [MS-XLSB] 2.1.7 Part Enumeration */\r\n    var ct2type = {\r\n        /* Workbook */\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\r\n\r\n        /* Worksheet */\r\n        \"application/vnd.ms-excel.binIndexWs\": \"TODO\", /* Binary Index */\r\n\r\n        /* Chartsheet */\r\n        \"application/vnd.ms-excel.chartsheet\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"TODO\",\r\n\r\n        /* Dialogsheet */\r\n        \"application/vnd.ms-excel.dialogsheet\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"TODO\",\r\n\r\n        /* Macrosheet */\r\n        \"application/vnd.ms-excel.macrosheet\": \"TODO\",\r\n        \"application/vnd.ms-excel.macrosheet+xml\": \"TODO\",\r\n        \"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\r\n        \"application/vnd.ms-excel.binIndexMs\": \"TODO\", /* Binary Index */\r\n\r\n        /* File Properties */\r\n        \"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\r\n        \"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\r\n        \"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\r\n\r\n        /* Custom Data Properties */\r\n        \"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\r\n\r\n        /* Comments */\r\n        \"application/vnd.ms-excel.comments\": \"comments\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\r\n\r\n        /* PivotTable */\r\n        \"application/vnd.ms-excel.pivotTable\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\r\n\r\n        /* Calculation Chain */\r\n        \"application/vnd.ms-excel.calcChain\": \"calcchains\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\r\n\r\n        /* Printer Settings */\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\r\n\r\n        /* ActiveX */\r\n        \"application/vnd.ms-office.activeX\": \"TODO\",\r\n        \"application/vnd.ms-office.activeX+xml\": \"TODO\",\r\n\r\n        /* Custom Toolbars */\r\n        \"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\r\n\r\n        /* External Data Connections */\r\n        \"application/vnd.ms-excel.connections\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\r\n\r\n        /* External Links */\r\n        \"application/vnd.ms-excel.externalLink\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"TODO\",\r\n\r\n        /* Metadata */\r\n        \"application/vnd.ms-excel.sheetMetadata\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"TODO\",\r\n\r\n        /* PivotCache */\r\n        \"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\r\n        \"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\r\n\r\n        /* Query Table */\r\n        \"application/vnd.ms-excel.queryTable\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\r\n\r\n        /* Shared Workbook */\r\n        \"application/vnd.ms-excel.userNames\": \"TODO\",\r\n        \"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\r\n        \"application/vnd.ms-excel.revisionLog\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\r\n\r\n        /* Single Cell Table */\r\n        \"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\r\n\r\n        /* Slicer */\r\n        \"application/vnd.ms-excel.slicer\": \"TODO\",\r\n        \"application/vnd.ms-excel.slicerCache\": \"TODO\",\r\n        \"application/vnd.ms-excel.slicer+xml\": \"TODO\",\r\n        \"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\r\n\r\n        /* Sort Map */\r\n        \"application/vnd.ms-excel.wsSortMap\": \"TODO\",\r\n\r\n        /* Table */\r\n        \"application/vnd.ms-excel.table\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\r\n\r\n        /* Themes */\r\n        \"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\r\n\r\n        /* Timeline */\r\n        \"application/vnd.ms-excel.Timeline+xml\": \"TODO\", /* verify */\r\n        \"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\", /* verify */\r\n\r\n        /* VBA */\r\n        \"application/vnd.ms-office.vbaProject\": \"vba\",\r\n        \"application/vnd.ms-office.vbaProjectSignature\": \"vba\",\r\n\r\n        /* Volatile Dependencies */\r\n        \"application/vnd.ms-office.volatileDependencies\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\r\n\r\n        /* Control Properties */\r\n        \"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\r\n\r\n        /* Data Model */\r\n        \"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\r\n\r\n        /* Survey */\r\n        \"application/vnd.ms-excel.Survey+xml\": \"TODO\",\r\n\r\n        /* Drawing */\r\n        \"application/vnd.openxmlformats-officedocument.drawing+xml\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\r\n        \"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\r\n\r\n        /* VML */\r\n        \"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\r\n\r\n        \"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\r\n        \"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\r\n\r\n        \"sheet\": \"js\"\r\n    };\r\n\r\n    var CT_LIST = (function () {\r\n        var o = {\r\n            workbooks: {\r\n                xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\r\n                xlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\r\n                xlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\r\n                xltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\r\n            },\r\n            strs: { /* Shared Strings */\r\n                xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\r\n                xlsb: \"application/vnd.ms-excel.sharedStrings\"\r\n            },\r\n            sheets: {\r\n                xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\r\n                xlsb: \"application/vnd.ms-excel.worksheet\"\r\n            },\r\n            styles: {/* Styles */\r\n                xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\r\n                xlsb: \"application/vnd.ms-excel.styles\"\r\n            }\r\n        };\r\n        keys(o).forEach(function (k) { if (!o[k].xlsm) o[k].xlsm = o[k].xlsx; });\r\n        keys(o).forEach(function (k) { keys(o[k]).forEach(function (v) { ct2type[o[k][v]] = k; }); });\r\n        return o;\r\n    })();\r\n\r\n    var type2ct = evert_arr(ct2type);\r\n\r\n    XMLNS.CT = 'http://schemas.openxmlformats.org/package/2006/content-types';\r\n\r\n    function parse_ct(data, opts) {\r\n        var ctext = {};\r\n        if (!data || !data.match) return data;\r\n        var ct = {\r\n            workbooks: [], sheets: [], calcchains: [], themes: [], styles: [],\r\n            coreprops: [], extprops: [], custprops: [], strs: [], comments: [], vba: [],\r\n            TODO: [], rels: [], xmlns: \"\"\r\n        };\r\n        (data.match(tagregex) || []).forEach(function (x) {\r\n            var y = parsexmltag(x);\r\n            switch (y[0].replace(nsregex, \"<\")) {\r\n                case '<?xml': break;\r\n                case '<Types': ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/) || [\"\", \"\"])[1]]; break;\r\n                case '<Default': ctext[y.Extension] = y.ContentType; break;\r\n                case '<Override':\r\n                    if (ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\r\n                    else if (opts.WTF) console.error(y);\r\n                    break;\r\n            }\r\n        });\r\n        if (ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\r\n        ct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\r\n        ct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\r\n        ct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\r\n        ct.defaults = ctext;\r\n        delete ct.calcchains;\r\n        return ct;\r\n    }\r\n\r\n    var CTYPE_XML_ROOT = writextag('Types', null, {\r\n        'xmlns': XMLNS.CT,\r\n        'xmlns:xsd': XMLNS.xsd,\r\n        'xmlns:xsi': XMLNS.xsi\r\n    });\r\n\r\n    var CTYPE_DEFAULTS = [\r\n        ['xml', 'application/xml'],\r\n        ['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'],\r\n        ['rels', type2ct.rels[0]]\r\n    ].map(function (x) {\r\n        return writextag('Default', null, { 'Extension': x[0], 'ContentType': x[1] });\r\n    });\r\n\r\n    function write_ct(ct, opts) {\r\n        var o = [], v;\r\n        o[o.length] = (XML_HEADER);\r\n        o[o.length] = (CTYPE_XML_ROOT);\r\n        o = o.concat(CTYPE_DEFAULTS);\r\n        var f1 = function (w) {\r\n            if (ct[w] && ct[w].length > 0) {\r\n                v = ct[w][0];\r\n                o[o.length] = (writextag('Override', null, {\r\n                    'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\r\n                    'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\r\n                }));\r\n            }\r\n        };\r\n        var f2 = function (w) {\r\n            ct[w].forEach(function (v) {\r\n                o[o.length] = (writextag('Override', null, {\r\n                    'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\r\n                    'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\r\n                }));\r\n            });\r\n        };\r\n        var f3 = function (t) {\r\n            (ct[t] || []).forEach(function (v) {\r\n                o[o.length] = (writextag('Override', null, {\r\n                    'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\r\n                    'ContentType': type2ct[t][0]\r\n                }));\r\n            });\r\n        };\r\n        f1('workbooks');\r\n        f2('sheets');\r\n        f3('themes');\r\n        ['strs', 'styles'].forEach(f1);\r\n        ['coreprops', 'extprops', 'custprops'].forEach(f3);\r\n        if (o.length > 2) { o[o.length] = ('</Types>'); o[1] = o[1].replace(\"/>\", \">\"); }\r\n        return o.join(\"\");\r\n    }\r\n    /* 9.3.2 OPC Relationships Markup */\r\n    var RELS = {\r\n        WB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\r\n        SHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\"\r\n    };\r\n\r\n    function parse_rels(data, currentFilePath) {\r\n        if (!data) return data;\r\n        if (currentFilePath.charAt(0) !== '/') {\r\n            currentFilePath = '/' + currentFilePath;\r\n        }\r\n        var rels = {};\r\n        var hash = {};\r\n        var resolveRelativePathIntoAbsolute = function (to) {\r\n            var toksFrom = currentFilePath.split('/');\r\n            toksFrom.pop(); // folder path\r\n            var toksTo = to.split('/');\r\n            var reversed = [];\r\n            while (toksTo.length !== 0) {\r\n                var tokTo = toksTo.shift();\r\n                if (tokTo === '..') {\r\n                    toksFrom.pop();\r\n                } else if (tokTo !== '.') {\r\n                    toksFrom.push(tokTo);\r\n                }\r\n            }\r\n            return toksFrom.join('/');\r\n        };\r\n\r\n        data.match(tagregex).forEach(function (x) {\r\n            var y = parsexmltag(x);\r\n            /* 9.3.2.2 OPC_Relationships */\r\n            if (y[0] === '<Relationship') {\r\n                var rel = {}; rel.Type = y.Type; rel.Target = y.Target; rel.Id = y.Id; rel.TargetMode = y.TargetMode;\r\n                var canonictarget = y.TargetMode === 'External' ? y.Target : resolveRelativePathIntoAbsolute(y.Target);\r\n                rels[canonictarget] = rel;\r\n                hash[y.Id] = rel;\r\n            }\r\n        });\r\n        rels[\"!id\"] = hash;\r\n        return rels;\r\n    }\r\n\r\n    XMLNS.RELS = 'http://schemas.openxmlformats.org/package/2006/relationships';\r\n\r\n    var RELS_ROOT = writextag('Relationships', null, {\r\n        //'xmlns:ns0': XMLNS.RELS,\r\n        'xmlns': XMLNS.RELS\r\n    });\r\n\r\n    /* TODO */\r\n    function write_rels(rels) {\r\n        var o = [];\r\n        o[o.length] = (XML_HEADER);\r\n        o[o.length] = (RELS_ROOT);\r\n        keys(rels['!id']).forEach(function (rid) {\r\n            var rel = rels['!id'][rid];\r\n            o[o.length] = (writextag('Relationship', null, rel));\r\n        });\r\n        if (o.length > 2) { o[o.length] = ('</Relationships>'); o[1] = o[1].replace(\"/>\", \">\"); }\r\n        return o.join(\"\");\r\n    }\r\n    /* ECMA-376 Part II 11.1 Core Properties Part */\r\n    /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\r\n    var CORE_PROPS = [\r\n        [\"cp:category\", \"Category\"],\r\n        [\"cp:contentStatus\", \"ContentStatus\"],\r\n        [\"cp:keywords\", \"Keywords\"],\r\n        [\"cp:lastModifiedBy\", \"LastAuthor\"],\r\n        [\"cp:lastPrinted\", \"LastPrinted\"],\r\n        [\"cp:revision\", \"RevNumber\"],\r\n        [\"cp:version\", \"Version\"],\r\n        [\"dc:creator\", \"Author\"],\r\n        [\"dc:description\", \"Comments\"],\r\n        [\"dc:identifier\", \"Identifier\"],\r\n        [\"dc:language\", \"Language\"],\r\n        [\"dc:subject\", \"Subject\"],\r\n        [\"dc:title\", \"Title\"],\r\n        [\"dcterms:created\", \"CreatedDate\", 'date'],\r\n        [\"dcterms:modified\", \"ModifiedDate\", 'date']\r\n    ];\r\n\r\n    XMLNS.CORE_PROPS = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\r\n    RELS.CORE_PROPS = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\r\n\r\n    var CORE_PROPS_REGEX = (function () {\r\n        var r = new Array(CORE_PROPS.length);\r\n        for (var i = 0; i < CORE_PROPS.length; ++i) {\r\n            var f = CORE_PROPS[i];\r\n            var g = \"(?:\" + f[0].substr(0, f[0].indexOf(\":\")) + \":)\" + f[0].substr(f[0].indexOf(\":\") + 1);\r\n            r[i] = new RegExp(\"<\" + g + \"[^>]*>(.*)<\\/\" + g + \">\");\r\n        }\r\n        return r;\r\n    })();\r\n\r\n    function parse_core_props(data) {\r\n        var p = {};\r\n\r\n        for (var i = 0; i < CORE_PROPS.length; ++i) {\r\n            var f = CORE_PROPS[i], cur = data.match(CORE_PROPS_REGEX[i]);\r\n            if (cur != null && cur.length > 0) p[f[1]] = cur[1];\r\n            if (f[2] === 'date' && p[f[1]]) p[f[1]] = new Date(p[f[1]]);\r\n        }\r\n\r\n        return p;\r\n    }\r\n\r\n    var CORE_PROPS_XML_ROOT = writextag('cp:coreProperties', null, {\r\n        //'xmlns': XMLNS.CORE_PROPS,\r\n        'xmlns:cp': XMLNS.CORE_PROPS,\r\n        'xmlns:dc': XMLNS.dc,\r\n        'xmlns:dcterms': XMLNS.dcterms,\r\n        'xmlns:dcmitype': XMLNS.dcmitype,\r\n        'xmlns:xsi': XMLNS.xsi\r\n    });\r\n\r\n    function cp_doit(f, g, h, o, p) {\r\n        if (p[f] != null || g == null || g === \"\") return;\r\n        p[f] = g;\r\n        o[o.length] = (h ? writextag(f, g, h) : writetag(f, g));\r\n    }\r\n\r\n    function write_core_props(cp, opts) {\r\n        var o = [XML_HEADER, CORE_PROPS_XML_ROOT], p = {};\r\n        if (!cp) return o.join(\"\");\r\n\r\n\r\n        if (cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), { \"xsi:type\": \"dcterms:W3CDTF\" }, o, p);\r\n        if (cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), { \"xsi:type\": \"dcterms:W3CDTF\" }, o, p);\r\n\r\n        for (var i = 0; i != CORE_PROPS.length; ++i) { var f = CORE_PROPS[i]; cp_doit(f[0], cp[f[1]], null, o, p); }\r\n        if (o.length > 2) { o[o.length] = ('</cp:coreProperties>'); o[1] = o[1].replace(\"/>\", \">\"); }\r\n        return o.join(\"\");\r\n    }\r\n    /* 15.2.12.3 Extended File Properties Part */\r\n    /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\r\n    var EXT_PROPS = [\r\n        [\"Application\", \"Application\", \"string\"],\r\n        [\"AppVersion\", \"AppVersion\", \"string\"],\r\n        [\"Company\", \"Company\", \"string\"],\r\n        [\"DocSecurity\", \"DocSecurity\", \"string\"],\r\n        [\"Manager\", \"Manager\", \"string\"],\r\n        [\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"],\r\n        [\"SharedDoc\", \"SharedDoc\", \"bool\"],\r\n        [\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"],\r\n        [\"ScaleCrop\", \"ScaleCrop\", \"bool\"],\r\n        [\"HeadingPairs\", \"HeadingPairs\", \"raw\"],\r\n        [\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]\r\n    ];\r\n\r\n    XMLNS.EXT_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\r\n    RELS.EXT_PROPS = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\r\n\r\n    function parse_ext_props(data, p) {\r\n        var q = {}; if (!p) p = {};\r\n\r\n        EXT_PROPS.forEach(function (f) {\r\n            switch (f[2]) {\r\n                case \"string\": p[f[1]] = (data.match(matchtag(f[0])) || [])[1]; break;\r\n                case \"bool\": p[f[1]] = (data.match(matchtag(f[0])) || [])[1] === \"true\"; break;\r\n                case \"raw\":\r\n                    var cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>(.*)<\\/\" + f[0] + \">\"));\r\n                    if (cur && cur.length > 0) q[f[1]] = cur[1];\r\n                    break;\r\n            }\r\n        });\r\n\r\n        if (q.HeadingPairs && q.TitlesOfParts) {\r\n            var v = parseVector(q.HeadingPairs);\r\n            var j = 0, widx = 0;\r\n            for (var i = 0; i !== v.length; ++i) {\r\n                switch (v[i].v) {\r\n                    case \"Worksheets\": widx = j; p.Worksheets = +(v[++i].v); break;\r\n                    case \"Named Ranges\": ++i; break; // TODO: Handle Named Ranges\r\n                }\r\n            }\r\n            var parts = parseVector(q.TitlesOfParts).map(function (x) { return utf8read(x.v); });\r\n            p.SheetNames = parts.slice(widx, widx + p.Worksheets);\r\n        }\r\n        return p;\r\n    }\r\n\r\n    var EXT_PROPS_XML_ROOT = writextag('Properties', null, {\r\n        'xmlns': XMLNS.EXT_PROPS,\r\n        'xmlns:vt': XMLNS.vt\r\n    });\r\n\r\n    function write_ext_props(cp, opts) {\r\n        var o = [], p = {}, W = writextag;\r\n        if (!cp) cp = {};\r\n        cp.Application = \"SheetJS\";\r\n        o[o.length] = (XML_HEADER);\r\n        o[o.length] = (EXT_PROPS_XML_ROOT);\r\n\r\n        EXT_PROPS.forEach(function (f) {\r\n            if (cp[f[1]] === undefined) return;\r\n            var v;\r\n            switch (f[2]) {\r\n                case 'string': v = cp[f[1]]; break;\r\n                case 'bool': v = cp[f[1]] ? 'true' : 'false'; break;\r\n            }\r\n            if (v !== undefined) o[o.length] = (W(f[0], v));\r\n        });\r\n\r\n        /* TODO: HeadingPairs, TitlesOfParts */\r\n        o[o.length] = (W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>') + W('vt:variant', W('vt:i4', String(cp.Worksheets))), { size: 2, baseType: \"variant\" })));\r\n        o[o.length] = (W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function (s) { return \"<vt:lpstr>\" + s + \"</vt:lpstr>\"; }).join(\"\"), { size: cp.Worksheets, baseType: \"lpstr\" })));\r\n        if (o.length > 2) { o[o.length] = ('</Properties>'); o[1] = o[1].replace(\"/>\", \">\"); }\r\n        return o.join(\"\");\r\n    }\r\n    /* 15.2.12.2 Custom File Properties Part */\r\n    XMLNS.CUST_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\";\r\n    RELS.CUST_PROPS = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\r\n\r\n    var custregex = /<[^>]+>[^<]*/g;\r\n    function parse_cust_props(data, opts) {\r\n        var p = {}, name;\r\n        var m = data.match(custregex);\r\n        if (m) for (var i = 0; i != m.length; ++i) {\r\n            var x = m[i], y = parsexmltag(x);\r\n            switch (y[0]) {\r\n                case '<?xml': break;\r\n                case '<Properties':\r\n                    if (y.xmlns !== XMLNS.CUST_PROPS) throw \"unrecognized xmlns \" + y.xmlns;\r\n                    if (y.xmlnsvt && y.xmlnsvt !== XMLNS.vt) throw \"unrecognized vt \" + y.xmlnsvt;\r\n                    break;\r\n                case '<property': name = y.name; break;\r\n                case '</property>': name = null; break;\r\n                default: if (x.indexOf('<vt:') === 0) {\r\n                    var toks = x.split('>');\r\n                    var type = toks[0].substring(4), text = toks[1];\r\n                    /* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\r\n                    switch (type) {\r\n                        case 'lpstr': case 'lpwstr': case 'bstr': case 'lpwstr':\r\n                            p[name] = unescapexml(text);\r\n                            break;\r\n                        case 'bool':\r\n                            p[name] = parsexmlbool(text, '<vt:bool>');\r\n                            break;\r\n                        case 'i1': case 'i2': case 'i4': case 'i8': case 'int': case 'uint':\r\n                            p[name] = parseInt(text, 10);\r\n                            break;\r\n                        case 'r4': case 'r8': case 'decimal':\r\n                            p[name] = parseFloat(text);\r\n                            break;\r\n                        case 'filetime': case 'date':\r\n                            p[name] = new Date(text);\r\n                            break;\r\n                        case 'cy': case 'error':\r\n                            p[name] = unescapexml(text);\r\n                            break;\r\n                        default:\r\n                            if (typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\r\n                    }\r\n                } else if (x.substr(0, 2) === \"</\") {\r\n                } else if (opts.WTF) throw new Error(x);\r\n            }\r\n        }\r\n        return p;\r\n    }\r\n\r\n    var CUST_PROPS_XML_ROOT = writextag('Properties', null, {\r\n        'xmlns': XMLNS.CUST_PROPS,\r\n        'xmlns:vt': XMLNS.vt\r\n    });\r\n\r\n    function write_cust_props(cp, opts) {\r\n        var o = [XML_HEADER, CUST_PROPS_XML_ROOT];\r\n        if (!cp) return o.join(\"\");\r\n        var pid = 1;\r\n        keys(cp).forEach(function custprop(k) {\r\n            ++pid;\r\n            o[o.length] = (writextag('property', write_vt(cp[k]), {\r\n                'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\r\n                'pid': pid,\r\n                'name': k\r\n            }));\r\n        });\r\n        if (o.length > 2) { o[o.length] = '</Properties>'; o[1] = o[1].replace(\"/>\", \">\"); }\r\n        return o.join(\"\");\r\n    }\r\n    function xlml_set_prop(Props, tag, val) {\r\n        /* TODO: Normalize the properties */\r\n        switch (tag) {\r\n            case 'Description': tag = 'Comments'; break;\r\n        }\r\n        Props[tag] = val;\r\n    }\r\n\r\n    /* [MS-DTYP] 2.3.3 FILETIME */\r\n    /* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\r\n    /* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\r\n    function parse_FILETIME(blob) {\r\n        var dwLowDateTime = blob.read_shift(4), dwHighDateTime = blob.read_shift(4);\r\n        return new Date(((dwHighDateTime / 1e7 * Math.pow(2, 32) + dwLowDateTime / 1e7) - 11644473600) * 1000).toISOString().replace(/\\.000/, \"\");\r\n    }\r\n\r\n    /* [MS-OSHARED] 2.3.3.1.4 Lpstr */\r\n    function parse_lpstr(blob, type, pad) {\r\n        var str = blob.read_shift(0, 'lpstr');\r\n        if (pad) blob.l += (4 - ((str.length + 1) & 3)) & 3;\r\n        return str;\r\n    }\r\n\r\n    /* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\r\n    function parse_lpwstr(blob, type, pad) {\r\n        var str = blob.read_shift(0, 'lpwstr');\r\n        if (pad) blob.l += (4 - ((str.length + 1) & 3)) & 3;\r\n        return str;\r\n    }\r\n\r\n\r\n    /* [MS-OSHARED] 2.3.3.1.11 VtString */\r\n    /* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\r\n    function parse_VtStringBase(blob, stringType, pad) {\r\n        if (stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\r\n        return parse_lpstr(blob, stringType, pad);\r\n    }\r\n\r\n    function parse_VtString(blob, t, pad) { return parse_VtStringBase(blob, t, pad === false ? 0 : 4); }\r\n    function parse_VtUnalignedString(blob, t) { if (!t) throw new Error(\"dafuq?\"); return parse_VtStringBase(blob, t, 0); }\r\n\r\n    /* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\r\n    function parse_VtVecUnalignedLpstrValue(blob) {\r\n        var length = blob.read_shift(4);\r\n        var ret = [];\r\n        for (var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr');\r\n        return ret;\r\n    }\r\n\r\n    /* [MS-OSHARED] 2.3.3.1.10 VtVecUnalignedLpstr */\r\n    function parse_VtVecUnalignedLpstr(blob) {\r\n        return parse_VtVecUnalignedLpstrValue(blob);\r\n    }\r\n\r\n    /* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\r\n    function parse_VtHeadingPair(blob) {\r\n        var headingString = parse_TypedPropertyValue(blob, VT_USTR);\r\n        var headerParts = parse_TypedPropertyValue(blob, VT_I4);\r\n        return [headingString, headerParts];\r\n    }\r\n\r\n    /* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\r\n    function parse_VtVecHeadingPairValue(blob) {\r\n        var cElements = blob.read_shift(4);\r\n        var out = [];\r\n        for (var i = 0; i != cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\r\n        return out;\r\n    }\r\n\r\n    /* [MS-OSHARED] 2.3.3.1.15 VtVecHeadingPair */\r\n    function parse_VtVecHeadingPair(blob) {\r\n        // NOTE: When invoked, wType & padding were already consumed\r\n        return parse_VtVecHeadingPairValue(blob);\r\n    }\r\n\r\n    /* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\r\n    function parse_dictionary(blob, CodePage) {\r\n        var cnt = blob.read_shift(4);\r\n        var dict = {};\r\n        for (var j = 0; j != cnt; ++j) {\r\n            var pid = blob.read_shift(4);\r\n            var len = blob.read_shift(4);\r\n            dict[pid] = blob.read_shift(len, (CodePage === 0x4B0 ? 'utf16le' : 'utf8')).replace(chr0, '').replace(chr1, '!');\r\n        }\r\n        if (blob.l & 3) blob.l = (blob.l >> 2 + 1) << 2;\r\n        return dict;\r\n    }\r\n\r\n    /* [MS-OLEPS] 2.9 BLOB */\r\n    function parse_BLOB(blob) {\r\n        var size = blob.read_shift(4);\r\n        var bytes = blob.slice(blob.l, blob.l + size);\r\n        if (size & 3 > 0) blob.l += (4 - (size & 3)) & 3;\r\n        return bytes;\r\n    }\r\n\r\n    /* [MS-OLEPS] 2.11 ClipboardData */\r\n    function parse_ClipboardData(blob) {\r\n        // TODO\r\n        var o = {};\r\n        o.Size = blob.read_shift(4);\r\n        //o.Format = blob.read_shift(4);\r\n        blob.l += o.Size;\r\n        return o;\r\n    }\r\n\r\n    /* [MS-OLEPS] 2.14 Vector and Array Property Types */\r\n    function parse_VtVector(blob, cb) {\r\n        /* [MS-OLEPS] 2.14.2 VectorHeader */\r\n        /*\tvar Length = blob.read_shift(4);\r\n            var o = [];\r\n            for(var i = 0; i != Length; ++i) {\r\n                o.push(cb(blob));\r\n            }\r\n            return o;*/\r\n    }\r\n\r\n    /* [MS-OLEPS] 2.15 TypedPropertyValue */\r\n    function parse_TypedPropertyValue(blob, type, _opts) {\r\n        var t = blob.read_shift(2), ret, opts = _opts || {};\r\n        blob.l += 2;\r\n        if (type !== VT_VARIANT)\r\n            if (t !== type && VT_CUSTOM.indexOf(type) === -1) throw new Error('Expected type ' + type + ' saw ' + t);\r\n        switch (type === VT_VARIANT ? t : type) {\r\n            case 0x02 /*VT_I2*/: ret = blob.read_shift(2, 'i'); if (!opts.raw) blob.l += 2; return ret;\r\n            case 0x03 /*VT_I4*/: ret = blob.read_shift(4, 'i'); return ret;\r\n            case 0x0B /*VT_BOOL*/: return blob.read_shift(4) !== 0x0;\r\n            case 0x13 /*VT_UI4*/: ret = blob.read_shift(4); return ret;\r\n            case 0x1E /*VT_LPSTR*/: return parse_lpstr(blob, t, 4).replace(chr0, '');\r\n            case 0x1F /*VT_LPWSTR*/: return parse_lpwstr(blob);\r\n            case 0x40 /*VT_FILETIME*/: return parse_FILETIME(blob);\r\n            case 0x41 /*VT_BLOB*/: return parse_BLOB(blob);\r\n            case 0x47 /*VT_CF*/: return parse_ClipboardData(blob);\r\n            case 0x50 /*VT_STRING*/: return parse_VtString(blob, t, !opts.raw && 4).replace(chr0, '');\r\n            case 0x51 /*VT_USTR*/: return parse_VtUnalignedString(blob, t, 4).replace(chr0, '');\r\n            case 0x100C /*VT_VECTOR|VT_VARIANT*/: return parse_VtVecHeadingPair(blob);\r\n            case 0x101E /*VT_LPSTR*/: return parse_VtVecUnalignedLpstr(blob);\r\n            default: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\r\n        }\r\n    }\r\n    /* [MS-OLEPS] 2.14.2 VectorHeader */\r\n    /*function parse_VTVectorVariant(blob) {\r\n        var Length = blob.read_shift(4);\r\n    \r\n        if(Length & 1 !== 0) throw new Error(\"VectorHeader Length=\" + Length + \" must be even\");\r\n        var o = [];\r\n        for(var i = 0; i != Length; ++i) {\r\n            o.push(parse_TypedPropertyValue(blob, VT_VARIANT));\r\n        }\r\n        return o;\r\n    }*/\r\n\r\n    /* [MS-OLEPS] 2.20 PropertySet */\r\n    function parse_PropertySet(blob, PIDSI) {\r\n        var start_addr = blob.l;\r\n        var size = blob.read_shift(4);\r\n        var NumProps = blob.read_shift(4);\r\n        var Props = [], i = 0;\r\n        var CodePage = 0;\r\n        var Dictionary = -1, DictObj;\r\n        for (i = 0; i != NumProps; ++i) {\r\n            var PropID = blob.read_shift(4);\r\n            var Offset = blob.read_shift(4);\r\n            Props[i] = [PropID, Offset + start_addr];\r\n        }\r\n        var PropH = {};\r\n        for (i = 0; i != NumProps; ++i) {\r\n            if (blob.l !== Props[i][1]) {\r\n                var fail = true;\r\n                if (i > 0 && PIDSI) switch (PIDSI[Props[i - 1][0]].t) {\r\n                    case 0x02 /*VT_I2*/: if (blob.l + 2 === Props[i][1]) { blob.l += 2; fail = false; } break;\r\n                    case 0x50 /*VT_STRING*/: if (blob.l <= Props[i][1]) { blob.l = Props[i][1]; fail = false; } break;\r\n                    case 0x100C /*VT_VECTOR|VT_VARIANT*/: if (blob.l <= Props[i][1]) { blob.l = Props[i][1]; fail = false; } break;\r\n                }\r\n                if (!PIDSI && blob.l <= Props[i][1]) { fail = false; blob.l = Props[i][1]; }\r\n                if (fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\r\n            }\r\n            if (PIDSI) {\r\n                var piddsi = PIDSI[Props[i][0]];\r\n                PropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, { raw: true });\r\n                if (piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + String(PropH[piddsi.n] & 0xFFFF);\r\n                if (piddsi.n == \"CodePage\") switch (PropH[piddsi.n]) {\r\n                    case 0: PropH[piddsi.n] = 1252;\r\n                    /* falls through */\r\n                    case 10000: // OSX Roman\r\n                    case 1252: // Windows Latin\r\n\r\n                    case 874: // SB Windows Thai\r\n                    case 1250: // SB Windows Central Europe\r\n                    case 1251: // SB Windows Cyrillic\r\n                    case 1253: // SB Windows Greek\r\n                    case 1254: // SB Windows Turkish\r\n                    case 1255: // SB Windows Hebrew\r\n                    case 1256: // SB Windows Arabic\r\n                    case 1257: // SB Windows Baltic\r\n                    case 1258: // SB Windows Vietnam\r\n\r\n                    case 932: // DB Windows Japanese Shift-JIS\r\n                    case 936: // DB Windows Simplified Chinese GBK\r\n                    case 949: // DB Windows Korean\r\n                    case 950: // DB Windows Traditional Chinese Big5\r\n\r\n                    case 1200: // UTF16LE\r\n                    case 1201: // UTF16BE\r\n                    case 65000: case -536: // UTF-7\r\n                    case 65001: case -535: // UTF-8\r\n                        set_cp(CodePage = PropH[piddsi.n]); break;\r\n                    default: throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\r\n                }\r\n            } else {\r\n                if (Props[i][0] === 0x1) {\r\n                    CodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2);\r\n                    set_cp(CodePage);\r\n                    if (Dictionary !== -1) {\r\n                        var oldpos = blob.l;\r\n                        blob.l = Props[Dictionary][1];\r\n                        DictObj = parse_dictionary(blob, CodePage);\r\n                        blob.l = oldpos;\r\n                    }\r\n                } else if (Props[i][0] === 0) {\r\n                    if (CodePage === 0) { Dictionary = i; blob.l = Props[i + 1][1]; continue; }\r\n                    DictObj = parse_dictionary(blob, CodePage);\r\n                } else {\r\n                    var name = DictObj[Props[i][0]];\r\n                    var val;\r\n                    /* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\r\n                    switch (blob[blob.l]) {\r\n                        case 0x41 /*VT_BLOB*/: blob.l += 4; val = parse_BLOB(blob); break;\r\n                        case 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l - 4]); break;\r\n                        case 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l - 4]); break;\r\n                        case 0x03 /*VT_I4*/: blob.l += 4; val = blob.read_shift(4, 'i'); break;\r\n                        case 0x13 /*VT_UI4*/: blob.l += 4; val = blob.read_shift(4); break;\r\n                        case 0x05 /*VT_R8*/: blob.l += 4; val = blob.read_shift(8, 'f'); break;\r\n                        case 0x0B /*VT_BOOL*/: blob.l += 4; val = parsebool(blob, 4); break;\r\n                        case 0x40 /*VT_FILETIME*/: blob.l += 4; val = new Date(parse_FILETIME(blob)); break;\r\n                        default: throw new Error(\"unparsed value: \" + blob[blob.l]);\r\n                    }\r\n                    PropH[name] = val;\r\n                }\r\n            }\r\n        }\r\n        blob.l = start_addr + size; /* step ahead to skip padding */\r\n        return PropH;\r\n    }\r\n\r\n    /* [MS-OLEPS] 2.21 PropertySetStream */\r\n    function parse_PropertySetStream(file, PIDSI) {\r\n        var blob = file.content;\r\n        prep_blob(blob, 0);\r\n\r\n        var NumSets, FMTID0, FMTID1, Offset0, Offset1;\r\n        blob.chk('feff', 'Byte Order: ');\r\n\r\n        var vers = blob.read_shift(2); // TODO: check version\r\n        var SystemIdentifier = blob.read_shift(4);\r\n        blob.chk(CFB.utils.consts.HEADER_CLSID, 'CLSID: ');\r\n        NumSets = blob.read_shift(4);\r\n        if (NumSets !== 1 && NumSets !== 2) throw \"Unrecognized #Sets: \" + NumSets;\r\n        FMTID0 = blob.read_shift(16); Offset0 = blob.read_shift(4);\r\n\r\n        if (NumSets === 1 && Offset0 !== blob.l) throw \"Length mismatch\";\r\n        else if (NumSets === 2) { FMTID1 = blob.read_shift(16); Offset1 = blob.read_shift(4); }\r\n        var PSet0 = parse_PropertySet(blob, PIDSI);\r\n\r\n        var rval = { SystemIdentifier: SystemIdentifier };\r\n        for (var y in PSet0) rval[y] = PSet0[y];\r\n        //rval.blob = blob;\r\n        rval.FMTID = FMTID0;\r\n        //rval.PSet0 = PSet0;\r\n        if (NumSets === 1) return rval;\r\n        if (blob.l !== Offset1) throw \"Length mismatch 2: \" + blob.l + \" !== \" + Offset1;\r\n        var PSet1;\r\n        try { PSet1 = parse_PropertySet(blob, null); } catch (e) { }\r\n        for (y in PSet1) rval[y] = PSet1[y];\r\n        rval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\r\n        return rval;\r\n    }\r\n\r\n\r\n    function parsenoop2(blob, length) { blob.read_shift(length); return null; }\r\n\r\n    function parslurp(blob, length, cb) {\r\n        var arr = [], target = blob.l + length;\r\n        while (blob.l < target) arr.push(cb(blob, target - blob.l));\r\n        if (target !== blob.l) throw new Error(\"Slurp error\");\r\n        return arr;\r\n    }\r\n\r\n    function parslurp2(blob, length, cb) {\r\n        var arr = [], target = blob.l + length, len = blob.read_shift(2);\r\n        while (len-- !== 0) arr.push(cb(blob, target - blob.l));\r\n        if (target !== blob.l) throw new Error(\"Slurp error\");\r\n        return arr;\r\n    }\r\n\r\n    function parsebool(blob, length) { return blob.read_shift(length) === 0x1; }\r\n\r\n    function parseuint16(blob) { return blob.read_shift(2, 'u'); }\r\n    function parseuint16a(blob, length) { return parslurp(blob, length, parseuint16); }\r\n\r\n    /* --- 2.5 Structures --- */\r\n\r\n    /* [MS-XLS] 2.5.14 Boolean */\r\n    var parse_Boolean = parsebool;\r\n\r\n    /* [MS-XLS] 2.5.10 Bes (boolean or error) */\r\n    function parse_Bes(blob) {\r\n        var v = blob.read_shift(1), t = blob.read_shift(1);\r\n        return t === 0x01 ? v : v === 0x01;\r\n    }\r\n\r\n    /* [MS-XLS] 2.5.240 ShortXLUnicodeString */\r\n    function parse_ShortXLUnicodeString(blob, length, opts) {\r\n        var cch = blob.read_shift(1);\r\n        var width = 1, encoding = 'sbcs-cont';\r\n        var cp = current_codepage;\r\n        if (opts && opts.biff >= 8) current_codepage = 1200;\r\n        if (opts === undefined || opts.biff !== 5) {\r\n            var fHighByte = blob.read_shift(1);\r\n            if (fHighByte) { width = 2; encoding = 'dbcs-cont'; }\r\n        }\r\n        var o = cch ? blob.read_shift(cch, encoding) : \"\";\r\n        current_codepage = cp;\r\n        return o;\r\n    }\r\n\r\n    /* 2.5.293 XLUnicodeRichExtendedString */\r\n    function parse_XLUnicodeRichExtendedString(blob) {\r\n        var cp = current_codepage;\r\n        current_codepage = 1200;\r\n        var cch = blob.read_shift(2), flags = blob.read_shift(1);\r\n        var fHighByte = flags & 0x1, fExtSt = flags & 0x4, fRichSt = flags & 0x8;\r\n        var width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\r\n        var cRun, cbExtRst;\r\n        var z = {};\r\n        if (fRichSt) cRun = blob.read_shift(2);\r\n        if (fExtSt) cbExtRst = blob.read_shift(4);\r\n        var encoding = (flags & 0x1) ? 'dbcs-cont' : 'sbcs-cont';\r\n        var msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\r\n        if (fRichSt) blob.l += 4 * cRun; //TODO: parse this\r\n        if (fExtSt) blob.l += cbExtRst; //TODO: parse this\r\n        z.t = msg;\r\n        if (!fRichSt) { z.raw = \"<t>\" + z.t + \"</t>\"; z.r = z.t; }\r\n        current_codepage = cp;\r\n        return z;\r\n    }\r\n\r\n    /* 2.5.296 XLUnicodeStringNoCch */\r\n    function parse_XLUnicodeStringNoCch(blob, cch, opts) {\r\n        var retval;\r\n        var fHighByte = blob.read_shift(1);\r\n        if (fHighByte === 0) { retval = blob.read_shift(cch, 'sbcs-cont'); }\r\n        else { retval = blob.read_shift(cch, 'dbcs-cont'); }\r\n        return retval;\r\n    }\r\n\r\n    /* 2.5.294 XLUnicodeString */\r\n    function parse_XLUnicodeString(blob, length, opts) {\r\n        var cch = blob.read_shift(opts !== undefined && opts.biff > 0 && opts.biff < 8 ? 1 : 2);\r\n        if (cch === 0) { blob.l++; return \"\"; }\r\n        return parse_XLUnicodeStringNoCch(blob, cch, opts);\r\n    }\r\n    /* BIFF5 override */\r\n    function parse_XLUnicodeString2(blob, length, opts) {\r\n        if (opts.biff !== 5 && opts.biff !== 2) return parse_XLUnicodeString(blob, length, opts);\r\n        var cch = blob.read_shift(1);\r\n        if (cch === 0) { blob.l++; return \"\"; }\r\n        return blob.read_shift(cch, 'sbcs-cont');\r\n    }\r\n\r\n    /* [MS-XLS] 2.5.61 ControlInfo */\r\n    var parse_ControlInfo = parsenoop;\r\n\r\n    /* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\r\n    var parse_URLMoniker = function (blob, length) {\r\n        var len = blob.read_shift(4), start = blob.l;\r\n        var extra = false;\r\n        if (len > 24) {\r\n            /* look ahead */\r\n            blob.l += len - 24;\r\n            if (blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\r\n            blob.l = start;\r\n        }\r\n        var url = blob.read_shift((extra ? len - 24 : len) >> 1, 'utf16le').replace(chr0, \"\");\r\n        if (extra) blob.l += 24;\r\n        return url;\r\n    };\r\n\r\n    /* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\r\n    var parse_FileMoniker = function (blob, length) {\r\n        var cAnti = blob.read_shift(2);\r\n        var ansiLength = blob.read_shift(4);\r\n        var ansiPath = blob.read_shift(ansiLength, 'cstr');\r\n        var endServer = blob.read_shift(2);\r\n        var versionNumber = blob.read_shift(2);\r\n        var cbUnicodePathSize = blob.read_shift(4);\r\n        if (cbUnicodePathSize === 0) return ansiPath.replace(/\\\\/g, \"/\");\r\n        var cbUnicodePathBytes = blob.read_shift(4);\r\n        var usKeyValue = blob.read_shift(2);\r\n        var unicodePath = blob.read_shift(cbUnicodePathBytes >> 1, 'utf16le').replace(chr0, \"\");\r\n        return unicodePath;\r\n    };\r\n\r\n    /* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\r\n    var parse_HyperlinkMoniker = function (blob, length) {\r\n        var clsid = blob.read_shift(16); length -= 16;\r\n        switch (clsid) {\r\n            case \"e0c9ea79f9bace118c8200aa004ba90b\": return parse_URLMoniker(blob, length);\r\n            case \"0303000000000000c000000000000046\": return parse_FileMoniker(blob, length);\r\n            default: throw \"unsupported moniker \" + clsid;\r\n        }\r\n    };\r\n\r\n    /* [MS-OSHARED] 2.3.7.9 HyperlinkString */\r\n    var parse_HyperlinkString = function (blob, length) {\r\n        var len = blob.read_shift(4);\r\n        var o = blob.read_shift(len, 'utf16le').replace(chr0, \"\");\r\n        return o;\r\n    };\r\n\r\n    /* [MS-OSHARED] 2.3.7.1 Hyperlink Object TODO: unify params with XLSX */\r\n    var parse_Hyperlink = function (blob, length) {\r\n        var end = blob.l + length;\r\n        var sVer = blob.read_shift(4);\r\n        if (sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\r\n        var flags = blob.read_shift(2);\r\n        blob.l += 2;\r\n        var displayName, targetFrameName, moniker, oleMoniker, location, guid, fileTime;\r\n        if (flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\r\n        if (flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\r\n        if ((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\r\n        if ((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\r\n        if (flags & 0x0008) location = parse_HyperlinkString(blob, end - blob.l);\r\n        if (flags & 0x0020) guid = blob.read_shift(16);\r\n        if (flags & 0x0040) fileTime = parse_FILETIME(blob, 8);\r\n        blob.l = end;\r\n        var target = (targetFrameName || moniker || oleMoniker);\r\n        if (location) target += \"#\" + location;\r\n        return { Target: target };\r\n    };\r\n\r\n    /* 2.5.178 LongRGBA */\r\n    function parse_LongRGBA(blob, length) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r, g, b, a]; }\r\n\r\n    /* 2.5.177 LongRGB */\r\n    function parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }\r\n\r\n\r\n    /* --- MS-XLS --- */\r\n\r\n    /* 2.5.19 */\r\n    function parse_XLSCell(blob, length) {\r\n        var rw = blob.read_shift(2); // 0-indexed\r\n        var col = blob.read_shift(2);\r\n        var ixfe = blob.read_shift(2);\r\n        return { r: rw, c: col, ixfe: ixfe };\r\n    }\r\n\r\n    /* 2.5.134 */\r\n    function parse_frtHeader(blob) {\r\n        var rt = blob.read_shift(2);\r\n        var flags = blob.read_shift(2); // TODO: parse these flags\r\n        blob.l += 8;\r\n        return { type: rt, flags: flags };\r\n    }\r\n\r\n\r\n\r\n    function parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts); }\r\n\r\n    /* 2.5.158 */\r\n    var HIDEOBJENUM = ['SHOWALL', 'SHOWPLACEHOLDER', 'HIDEALL'];\r\n    var parse_HideObjEnum = parseuint16;\r\n\r\n    /* 2.5.344 */\r\n    function parse_XTI(blob, length) {\r\n        var iSupBook = blob.read_shift(2), itabFirst = blob.read_shift(2, 'i'), itabLast = blob.read_shift(2, 'i');\r\n        return [iSupBook, itabFirst, itabLast];\r\n    }\r\n\r\n    /* 2.5.218 */\r\n    function parse_RkRec(blob, length) {\r\n        var ixfe = blob.read_shift(2);\r\n        var RK = parse_RkNumber(blob);\r\n        //console.log(\"::\", ixfe, RK,\";;\");\r\n        return [ixfe, RK];\r\n    }\r\n\r\n    /* 2.5.1 */\r\n    function parse_AddinUdf(blob, length) {\r\n        blob.l += 4; length -= 4;\r\n        var l = blob.l + length;\r\n        var udfName = parse_ShortXLUnicodeString(blob, length);\r\n        var cb = blob.read_shift(2);\r\n        l -= blob.l;\r\n        if (cb !== l) throw \"Malformed AddinUdf: padding = \" + l + \" != \" + cb;\r\n        blob.l += cb;\r\n        return udfName;\r\n    }\r\n\r\n    /* 2.5.209 TODO: Check sizes */\r\n    function parse_Ref8U(blob, length) {\r\n        var rwFirst = blob.read_shift(2);\r\n        var rwLast = blob.read_shift(2);\r\n        var colFirst = blob.read_shift(2);\r\n        var colLast = blob.read_shift(2);\r\n        return { s: { c: colFirst, r: rwFirst }, e: { c: colLast, r: rwLast } };\r\n    }\r\n\r\n    /* 2.5.211 */\r\n    function parse_RefU(blob, length) {\r\n        var rwFirst = blob.read_shift(2);\r\n        var rwLast = blob.read_shift(2);\r\n        var colFirst = blob.read_shift(1);\r\n        var colLast = blob.read_shift(1);\r\n        return { s: { c: colFirst, r: rwFirst }, e: { c: colLast, r: rwLast } };\r\n    }\r\n\r\n    /* 2.5.207 */\r\n    var parse_Ref = parse_RefU;\r\n\r\n    /* 2.5.143 */\r\n    function parse_FtCmo(blob, length) {\r\n        blob.l += 4;\r\n        var ot = blob.read_shift(2);\r\n        var id = blob.read_shift(2);\r\n        var flags = blob.read_shift(2);\r\n        blob.l += 12;\r\n        return [id, ot, flags];\r\n    }\r\n\r\n    /* 2.5.149 */\r\n    function parse_FtNts(blob, length) {\r\n        var out = {};\r\n        blob.l += 4;\r\n        blob.l += 16; // GUID TODO\r\n        out.fSharedNote = blob.read_shift(2);\r\n        blob.l += 4;\r\n        return out;\r\n    }\r\n\r\n    /* 2.5.142 */\r\n    function parse_FtCf(blob, length) {\r\n        var out = {};\r\n        blob.l += 4;\r\n        blob.cf = blob.read_shift(2);\r\n        return out;\r\n    }\r\n\r\n    /* 2.5.140 - 2.5.154 and friends */\r\n    var FtTab = {\r\n        0x15: parse_FtCmo,\r\n        0x13: parsenoop,                                /* FtLbsData */\r\n        0x12: function (blob, length) { blob.l += 12; }, /* FtCblsData */\r\n        0x11: function (blob, length) { blob.l += 8; },  /* FtRboData */\r\n        0x10: parsenoop,                                /* FtEdoData */\r\n        0x0F: parsenoop,                                /* FtGboData */\r\n        0x0D: parse_FtNts,                              /* FtNts */\r\n        0x0C: function (blob, length) { blob.l += 24; }, /* FtSbs */\r\n        0x0B: function (blob, length) { blob.l += 10; }, /* FtRbo */\r\n        0x0A: function (blob, length) { blob.l += 16; }, /* FtCbls */\r\n        0x09: parsenoop,                                /* FtPictFmla */\r\n        0x08: function (blob, length) { blob.l += 6; },  /* FtPioGrbit */\r\n        0x07: parse_FtCf,                               /* FtCf */\r\n        0x06: function (blob, length) { blob.l += 6; },  /* FtGmo */\r\n        0x04: parsenoop,                                /* FtMacro */\r\n        0x00: function (blob, length) { blob.l += 4; }   /* FtEnding */\r\n    };\r\n    function parse_FtArray(blob, length, ot) {\r\n        var s = blob.l;\r\n        var fts = [];\r\n        while (blob.l < s + length) {\r\n            var ft = blob.read_shift(2);\r\n            blob.l -= 2;\r\n            try {\r\n                fts.push(FtTab[ft](blob, s + length - blob.l));\r\n            } catch (e) { blob.l = s + length; return fts; }\r\n        }\r\n        if (blob.l != s + length) blob.l = s + length; //throw \"bad Object Ft-sequence\";\r\n        return fts;\r\n    }\r\n\r\n    /* 2.5.129 */\r\n    var parse_FontIndex = parseuint16;\r\n\r\n    /* --- 2.4 Records --- */\r\n\r\n    /* 2.4.21 */\r\n    function parse_BOF(blob, length) {\r\n        var o = {};\r\n        o.BIFFVer = blob.read_shift(2); length -= 2;\r\n        switch (o.BIFFVer) {\r\n            case 0x0600: /* BIFF8 */\r\n            case 0x0500: /* BIFF5 */\r\n            case 0x0002: case 0x0007: /* BIFF2 */\r\n                break;\r\n            default: throw \"Unexpected BIFF Ver \" + o.BIFFVer;\r\n        }\r\n        blob.read_shift(length);\r\n        return o;\r\n    }\r\n\r\n\r\n    /* 2.4.146 */\r\n    function parse_InterfaceHdr(blob, length) {\r\n        if (length === 0) return 0x04b0;\r\n        var q;\r\n        if ((q = blob.read_shift(2)) !== 0x04b0) throw 'InterfaceHdr codePage ' + q;\r\n        return 0x04b0;\r\n    }\r\n\r\n\r\n    /* 2.4.349 */\r\n    function parse_WriteAccess(blob, length, opts) {\r\n        if (opts.enc) { blob.l += length; return \"\"; }\r\n        var l = blob.l;\r\n        // TODO: make sure XLUnicodeString doesnt overrun\r\n        var UserName = parse_XLUnicodeString(blob, 0, opts);\r\n        blob.read_shift(length + l - blob.l);\r\n        return UserName;\r\n    }\r\n\r\n    /* 2.4.28 */\r\n    function parse_BoundSheet8(blob, length, opts) {\r\n        var pos = blob.read_shift(4);\r\n        var hidden = blob.read_shift(1) >> 6;\r\n        var dt = blob.read_shift(1);\r\n        switch (dt) {\r\n            case 0: dt = 'Worksheet'; break;\r\n            case 1: dt = 'Macrosheet'; break;\r\n            case 2: dt = 'Chartsheet'; break;\r\n            case 6: dt = 'VBAModule'; break;\r\n        }\r\n        var name = parse_ShortXLUnicodeString(blob, 0, opts);\r\n        if (name.length === 0) name = \"Sheet1\";\r\n        return { pos: pos, hs: hidden, dt: dt, name: name };\r\n    }\r\n\r\n    /* 2.4.265 TODO */\r\n    function parse_SST(blob, length) {\r\n        var cnt = blob.read_shift(4);\r\n        var ucnt = blob.read_shift(4);\r\n        var strs = [];\r\n        for (var i = 0; i != ucnt; ++i) {\r\n            strs.push(parse_XLUnicodeRichExtendedString(blob));\r\n        }\r\n        strs.Count = cnt; strs.Unique = ucnt;\r\n        return strs;\r\n    }\r\n\r\n    /* 2.4.107 */\r\n    function parse_ExtSST(blob, length) {\r\n        var extsst = {};\r\n        extsst.dsst = blob.read_shift(2);\r\n        blob.l += length - 2;\r\n        return extsst;\r\n    }\r\n\r\n\r\n    /* 2.4.221 TODO*/\r\n    function parse_Row(blob, length) {\r\n        var rw = blob.read_shift(2), col = blob.read_shift(2), Col = blob.read_shift(2), rht = blob.read_shift(2);\r\n        blob.read_shift(4); // reserved(2), unused(2)\r\n        var flags = blob.read_shift(1); // various flags\r\n        blob.read_shift(1); // reserved\r\n        blob.read_shift(2); //ixfe, other flags\r\n        return { r: rw, c: col, cnt: Col - col };\r\n    }\r\n\r\n\r\n    /* 2.4.125 */\r\n    function parse_ForceFullCalculation(blob, length) {\r\n        var header = parse_frtHeader(blob);\r\n        if (header.type != 0x08A3) throw \"Invalid Future Record \" + header.type;\r\n        var fullcalc = blob.read_shift(4);\r\n        return fullcalc !== 0x0;\r\n    }\r\n\r\n\r\n    var parse_CompressPictures = parsenoop2; /* 2.4.55 Not interesting */\r\n\r\n\r\n\r\n    /* 2.4.215 rt */\r\n    function parse_RecalcId(blob, length) {\r\n        blob.read_shift(2);\r\n        return blob.read_shift(4);\r\n    }\r\n\r\n    /* 2.4.87 */\r\n    function parse_DefaultRowHeight(blob, length) {\r\n        var f = blob.read_shift(2), miyRw;\r\n        miyRw = blob.read_shift(2); // flags & 0x02 -> hidden, else empty\r\n        var fl = { Unsynced: f & 1, DyZero: (f & 2) >> 1, ExAsc: (f & 4) >> 2, ExDsc: (f & 8) >> 3 };\r\n        return [fl, miyRw];\r\n    }\r\n\r\n    /* 2.4.345 TODO */\r\n    function parse_Window1(blob, length) {\r\n        var xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);\r\n        var flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);\r\n        var ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);\r\n        return {\r\n            Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,\r\n            FirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio\r\n        };\r\n    }\r\n\r\n    /* 2.4.122 TODO */\r\n    function parse_Font(blob, length, opts) {\r\n        blob.l += 14;\r\n        var name = parse_ShortXLUnicodeString(blob, 0, opts);\r\n        return name;\r\n    }\r\n\r\n    /* 2.4.149 */\r\n    function parse_LabelSst(blob, length) {\r\n        var cell = parse_XLSCell(blob);\r\n        cell.isst = blob.read_shift(4);\r\n        return cell;\r\n    }\r\n\r\n    /* 2.4.148 */\r\n    function parse_Label(blob, length, opts) {\r\n        var cell = parse_XLSCell(blob, 6);\r\n        var str = parse_XLUnicodeString(blob, length - 6, opts);\r\n        cell.val = str;\r\n        return cell;\r\n    }\r\n\r\n    /* 2.4.126 Number Formats */\r\n    function parse_Format(blob, length, opts) {\r\n        var ifmt = blob.read_shift(2);\r\n        var fmtstr = parse_XLUnicodeString2(blob, 0, opts);\r\n        return [ifmt, fmtstr];\r\n    }\r\n\r\n    /* 2.4.90 */\r\n    function parse_Dimensions(blob, length) {\r\n        var w = length === 10 ? 2 : 4;\r\n        var r = blob.read_shift(w), R = blob.read_shift(w),\r\n            c = blob.read_shift(2), C = blob.read_shift(2);\r\n        blob.l += 2;\r\n        return { s: { r: r, c: c }, e: { r: R, c: C } };\r\n    }\r\n\r\n    /* 2.4.220 */\r\n    function parse_RK(blob, length) {\r\n        var rw = blob.read_shift(2), col = blob.read_shift(2);\r\n        var rkrec = parse_RkRec(blob);\r\n        return { r: rw, c: col, ixfe: rkrec[0], rknum: rkrec[1] };\r\n    }\r\n\r\n    /* 2.4.175 */\r\n    function parse_MulRk(blob, length) {\r\n        var target = blob.l + length - 2;\r\n        var rw = blob.read_shift(2), col = blob.read_shift(2);\r\n        var rkrecs = [];\r\n        while (blob.l < target) rkrecs.push(parse_RkRec(blob));\r\n        if (blob.l !== target) throw \"MulRK read error\";\r\n        var lastcol = blob.read_shift(2);\r\n        if (rkrecs.length != lastcol - col + 1) throw \"MulRK length mismatch\";\r\n        return { r: rw, c: col, C: lastcol, rkrec: rkrecs };\r\n    }\r\n\r\n    /* 2.5.20 2.5.249 TODO */\r\n    function parse_CellStyleXF(blob, length, style) {\r\n        var o = {};\r\n        var a = blob.read_shift(4), b = blob.read_shift(4);\r\n        var c = blob.read_shift(4), d = blob.read_shift(2);\r\n        o.patternType = XLSFillPattern[c >> 26];\r\n        o.icvFore = d & 0x7F;\r\n        o.icvBack = (d >> 7) & 0x7F;\r\n        return o;\r\n    }\r\n    function parse_CellXF(blob, length) { return parse_CellStyleXF(blob, length, 0); }\r\n    function parse_StyleXF(blob, length) { return parse_CellStyleXF(blob, length, 1); }\r\n\r\n    /* 2.4.353 TODO: actually do this right */\r\n    function parse_XF(blob, length) {\r\n        var o = {};\r\n        o.ifnt = blob.read_shift(2); o.ifmt = blob.read_shift(2); o.flags = blob.read_shift(2);\r\n        o.fStyle = (o.flags >> 2) & 0x01;\r\n        length -= 6;\r\n        o.data = parse_CellStyleXF(blob, length, o.fStyle);\r\n        return o;\r\n    }\r\n\r\n    /* 2.4.134 */\r\n    function parse_Guts(blob, length) {\r\n        blob.l += 4;\r\n        var out = [blob.read_shift(2), blob.read_shift(2)];\r\n        if (out[0] !== 0) out[0]--;\r\n        if (out[1] !== 0) out[1]--;\r\n        if (out[0] > 7 || out[1] > 7) throw \"Bad Gutters: \" + out;\r\n        return out;\r\n    }\r\n\r\n    /* 2.4.24 */\r\n    function parse_BoolErr(blob, length) {\r\n        var cell = parse_XLSCell(blob, 6);\r\n        var val = parse_Bes(blob, 2);\r\n        cell.val = val;\r\n        cell.t = (val === true || val === false) ? 'b' : 'e';\r\n        return cell;\r\n    }\r\n\r\n    /* 2.4.180 Number */\r\n    function parse_Number(blob, length) {\r\n        var cell = parse_XLSCell(blob, 6);\r\n        var xnum = parse_Xnum(blob, 8);\r\n        cell.val = xnum;\r\n        return cell;\r\n    }\r\n\r\n    var parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\r\n\r\n    /* 2.4.271 */\r\n    function parse_SupBook(blob, length, opts) {\r\n        var end = blob.l + length;\r\n        var ctab = blob.read_shift(2);\r\n        var cch = blob.read_shift(2);\r\n        var virtPath;\r\n        if (cch >= 0x01 && cch <= 0xff) virtPath = parse_XLUnicodeStringNoCch(blob, cch);\r\n        var rgst = blob.read_shift(end - blob.l);\r\n        opts.sbcch = cch;\r\n        return [cch, ctab, virtPath, rgst];\r\n    }\r\n\r\n    /* 2.4.105 TODO */\r\n    function parse_ExternName(blob, length, opts) {\r\n        var flags = blob.read_shift(2);\r\n        var body;\r\n        var o = {\r\n            fBuiltIn: flags & 0x01,\r\n            fWantAdvise: (flags >>> 1) & 0x01,\r\n            fWantPict: (flags >>> 2) & 0x01,\r\n            fOle: (flags >>> 3) & 0x01,\r\n            fOleLink: (flags >>> 4) & 0x01,\r\n            cf: (flags >>> 5) & 0x3FF,\r\n            fIcon: flags >>> 15 & 0x01\r\n        };\r\n        if (opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length - 2);\r\n        //else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\r\n        o.body = body || blob.read_shift(length - 2);\r\n        return o;\r\n    }\r\n\r\n    /* 2.4.150 TODO */\r\n    function parse_Lbl(blob, length, opts) {\r\n        if (opts.biff < 8) return parse_Label(blob, length, opts);\r\n        var target = blob.l + length;\r\n        var flags = blob.read_shift(2);\r\n        var chKey = blob.read_shift(1);\r\n        var cch = blob.read_shift(1);\r\n        var cce = blob.read_shift(2);\r\n        blob.l += 2;\r\n        var itab = blob.read_shift(2);\r\n        blob.l += 4;\r\n        var name = parse_XLUnicodeStringNoCch(blob, cch, opts);\r\n        var rgce = parse_NameParsedFormula(blob, target - blob.l, opts, cce);\r\n        return {\r\n            chKey: chKey,\r\n            Name: name,\r\n            rgce: rgce\r\n        };\r\n    }\r\n\r\n    /* 2.4.106 TODO: verify supbook manipulation */\r\n    function parse_ExternSheet(blob, length, opts) {\r\n        if (opts.biff < 8) return parse_ShortXLUnicodeString(blob, length, opts);\r\n        var o = parslurp2(blob, length, parse_XTI);\r\n        var oo = [];\r\n        if (opts.sbcch === 0x0401) {\r\n            for (var i = 0; i != o.length; ++i) oo.push(opts.snames[o[i][1]]);\r\n            return oo;\r\n        }\r\n        else return o;\r\n    }\r\n\r\n    /* 2.4.260 */\r\n    function parse_ShrFmla(blob, length, opts) {\r\n        var ref = parse_RefU(blob, 6);\r\n        blob.l++;\r\n        var cUse = blob.read_shift(1);\r\n        length -= 8;\r\n        return [parse_SharedParsedFormula(blob, length, opts), cUse];\r\n    }\r\n\r\n    /* 2.4.4 TODO */\r\n    function parse_Array(blob, length, opts) {\r\n        var ref = parse_Ref(blob, 6);\r\n        blob.l += 6; length -= 12; /* TODO: fAlwaysCalc */\r\n        return [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\r\n    }\r\n\r\n    /* 2.4.173 */\r\n    function parse_MTRSettings(blob, length) {\r\n        var fMTREnabled = blob.read_shift(4) !== 0x00;\r\n        var fUserSetThreadCount = blob.read_shift(4) !== 0x00;\r\n        var cUserThreadCount = blob.read_shift(4);\r\n        return [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\r\n    }\r\n\r\n    /* 2.5.186 TODO: BIFF5 */\r\n    function parse_NoteSh(blob, length, opts) {\r\n        if (opts.biff < 8) return;\r\n        var row = blob.read_shift(2), col = blob.read_shift(2);\r\n        var flags = blob.read_shift(2), idObj = blob.read_shift(2);\r\n        var stAuthor = parse_XLUnicodeString2(blob, 0, opts);\r\n        if (opts.biff < 8) blob.read_shift(1);\r\n        return [{ r: row, c: col }, stAuthor, idObj, flags];\r\n    }\r\n\r\n    /* 2.4.179 */\r\n    function parse_Note(blob, length, opts) {\r\n        /* TODO: Support revisions */\r\n        return parse_NoteSh(blob, length, opts);\r\n    }\r\n\r\n    /* 2.4.168 */\r\n    function parse_MergeCells(blob, length) {\r\n        var merges = [];\r\n        var cmcs = blob.read_shift(2);\r\n        while (cmcs--) merges.push(parse_Ref8U(blob, length));\r\n        return merges;\r\n    }\r\n\r\n    /* 2.4.181 TODO: parse all the things! */\r\n    function parse_Obj(blob, length) {\r\n        var cmo = parse_FtCmo(blob, 22); // id, ot, flags\r\n        var fts = parse_FtArray(blob, length - 22, cmo[1]);\r\n        return { cmo: cmo, ft: fts };\r\n    }\r\n\r\n    /* 2.4.329 TODO: parse properly */\r\n    function parse_TxO(blob, length, opts) {\r\n        var s = blob.l;\r\n        try {\r\n            blob.l += 4;\r\n            var ot = (opts.lastobj || { cmo: [0, 0] }).cmo[1];\r\n            var controlInfo;\r\n            if ([0, 5, 7, 11, 12, 14].indexOf(ot) == -1) blob.l += 6;\r\n            else controlInfo = parse_ControlInfo(blob, 6, opts);\r\n            var cchText = blob.read_shift(2);\r\n            var cbRuns = blob.read_shift(2);\r\n            var ifntEmpty = parse_FontIndex(blob, 2);\r\n            var len = blob.read_shift(2);\r\n            blob.l += len;\r\n            //var fmla = parse_ObjFmla(blob, s + length - blob.l);\r\n\r\n            var texts = \"\";\r\n            for (var i = 1; i < blob.lens.length - 1; ++i) {\r\n                if (blob.l - s != blob.lens[i]) throw \"TxO: bad continue record\";\r\n                var hdr = blob[blob.l];\r\n                var t = parse_XLUnicodeStringNoCch(blob, blob.lens[i + 1] - blob.lens[i] - 1);\r\n                texts += t;\r\n                if (texts.length >= (hdr ? cchText : 2 * cchText)) break;\r\n            }\r\n            if (texts.length !== cchText && texts.length !== cchText * 2) {\r\n                throw \"cchText: \" + cchText + \" != \" + texts.length;\r\n            }\r\n\r\n            blob.l = s + length;\r\n            /* 2.5.272 TxORuns */\r\n            //\tvar rgTxoRuns = [];\r\n            //\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\r\n            //\tvar cchText2 = blob.read_shift(2);\r\n            //\tif(cchText2 !== cchText) throw \"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText;\r\n            //\tblob.l += 6;\r\n            //\tif(s + length != blob.l) throw \"TxO \" + (s + length) + \", at \" + blob.l;\r\n            return { t: texts };\r\n        } catch (e) { blob.l = s + length; return { t: texts || \"\" }; }\r\n    }\r\n\r\n    /* 2.4.140 */\r\n    var parse_HLink = function (blob, length) {\r\n        var ref = parse_Ref8U(blob, 8);\r\n        blob.l += 16; /* CLSID */\r\n        var hlink = parse_Hyperlink(blob, length - 24);\r\n        return [ref, hlink];\r\n    };\r\n\r\n    /* 2.4.141 */\r\n    var parse_HLinkTooltip = function (blob, length) {\r\n        var end = blob.l + length;\r\n        blob.read_shift(2);\r\n        var ref = parse_Ref8U(blob, 8);\r\n        var wzTooltip = blob.read_shift((length - 10) / 2, 'dbcs-cont');\r\n        wzTooltip = wzTooltip.replace(chr0, \"\");\r\n        return [ref, wzTooltip];\r\n    };\r\n\r\n    /* 2.4.63 */\r\n    function parse_Country(blob, length) {\r\n        var o = [], d;\r\n        d = blob.read_shift(2); o[0] = CountryEnum[d] || d;\r\n        d = blob.read_shift(2); o[1] = CountryEnum[d] || d;\r\n        return o;\r\n    }\r\n\r\n    /* 2.4.50 ClrtClient */\r\n    function parse_ClrtClient(blob, length) {\r\n        var ccv = blob.read_shift(2);\r\n        var o = [];\r\n        while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\r\n        return o;\r\n    }\r\n\r\n    /* 2.4.188 */\r\n    function parse_Palette(blob, length) {\r\n        var ccv = blob.read_shift(2);\r\n        var o = [];\r\n        while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\r\n        return o;\r\n    }\r\n\r\n    /* 2.4.354 */\r\n    function parse_XFCRC(blob, length) {\r\n        blob.l += 2;\r\n        var o = { cxfs: 0, crc: 0 };\r\n        o.cxfs = blob.read_shift(2);\r\n        o.crc = blob.read_shift(4);\r\n        return o;\r\n    }\r\n\r\n\r\n    var parse_Style = parsenoop;\r\n    var parse_StyleExt = parsenoop;\r\n\r\n    var parse_ColInfo = parsenoop;\r\n\r\n    var parse_Window2 = parsenoop;\r\n\r\n\r\n    var parse_Backup = parsebool; /* 2.4.14 */\r\n    var parse_Blank = parse_XLSCell; /* 2.4.20 Just the cell */\r\n    var parse_BottomMargin = parse_Xnum; /* 2.4.27 */\r\n    var parse_BuiltInFnGroupCount = parseuint16; /* 2.4.30 0x0E or 0x10 but excel 2011 generates 0x11? */\r\n    var parse_CalcCount = parseuint16; /* 2.4.31 #Iterations */\r\n    var parse_CalcDelta = parse_Xnum; /* 2.4.32 */\r\n    var parse_CalcIter = parsebool;  /* 2.4.33 1=iterative calc */\r\n    var parse_CalcMode = parseuint16; /* 2.4.34 0=manual, 1=auto (def), 2=table */\r\n    var parse_CalcPrecision = parsebool; /* 2.4.35 */\r\n    var parse_CalcRefMode = parsenoop2; /* 2.4.36 */\r\n    var parse_CalcSaveRecalc = parsebool; /* 2.4.37 */\r\n    var parse_CodePage = parseuint16; /* 2.4.52 */\r\n    var parse_Compat12 = parsebool; /* 2.4.54 true = no compatibility check */\r\n    var parse_Date1904 = parsebool; /* 2.4.77 - 1=1904,0=1900 */\r\n    var parse_DefColWidth = parseuint16; /* 2.4.89 */\r\n    var parse_DSF = parsenoop2; /* 2.4.94 -- MUST be ignored */\r\n    var parse_EntExU2 = parsenoop2; /* 2.4.102 -- Explicitly says to ignore */\r\n    var parse_EOF = parsenoop2; /* 2.4.103 */\r\n    var parse_Excel9File = parsenoop2; /* 2.4.104 -- Optional and unused */\r\n    var parse_FeatHdr = parsenoop2; /* 2.4.112 */\r\n    var parse_FontX = parseuint16; /* 2.4.123 */\r\n    var parse_Footer = parse_XLHeaderFooter; /* 2.4.124 */\r\n    var parse_GridSet = parseuint16; /* 2.4.132, =1 */\r\n    var parse_HCenter = parsebool; /* 2.4.135 sheet centered horizontal on print */\r\n    var parse_Header = parse_XLHeaderFooter; /* 2.4.136 */\r\n    var parse_HideObj = parse_HideObjEnum; /* 2.4.139 */\r\n    var parse_InterfaceEnd = parsenoop2; /* 2.4.145 -- noop */\r\n    var parse_LeftMargin = parse_Xnum; /* 2.4.151 */\r\n    var parse_Mms = parsenoop2; /* 2.4.169 -- Explicitly says to ignore */\r\n    var parse_ObjProtect = parsebool; /* 2.4.183 -- must be 1 if present */\r\n    var parse_Password = parseuint16; /* 2.4.191 */\r\n    var parse_PrintGrid = parsebool; /* 2.4.202 */\r\n    var parse_PrintRowCol = parsebool; /* 2.4.203 */\r\n    var parse_PrintSize = parseuint16; /* 2.4.204 0:3 */\r\n    var parse_Prot4Rev = parsebool; /* 2.4.205 */\r\n    var parse_Prot4RevPass = parseuint16; /* 2.4.206 */\r\n    var parse_Protect = parsebool; /* 2.4.207 */\r\n    var parse_RefreshAll = parsebool; /* 2.4.217 -- must be 0 if not template */\r\n    var parse_RightMargin = parse_Xnum; /* 2.4.219 */\r\n    var parse_RRTabId = parseuint16a; /* 2.4.241 */\r\n    var parse_ScenarioProtect = parsebool; /* 2.4.245 */\r\n    var parse_Scl = parseuint16a; /* 2.4.247 num, den */\r\n    var parse_String = parse_XLUnicodeString; /* 2.4.268 */\r\n    var parse_SxBool = parsebool; /* 2.4.274 */\r\n    var parse_TopMargin = parse_Xnum; /* 2.4.328 */\r\n    var parse_UsesELFs = parsebool; /* 2.4.337 -- should be 0 */\r\n    var parse_VCenter = parsebool; /* 2.4.342 */\r\n    var parse_WinProtect = parsebool; /* 2.4.347 */\r\n    var parse_WriteProtect = parsenoop; /* 2.4.350 empty record */\r\n\r\n\r\n    /* ---- */\r\n    var parse_VerticalPageBreaks = parsenoop;\r\n    var parse_HorizontalPageBreaks = parsenoop;\r\n    var parse_Selection = parsenoop;\r\n    var parse_Continue = parsenoop;\r\n    var parse_Pane = parsenoop;\r\n    var parse_Pls = parsenoop;\r\n    var parse_DCon = parsenoop;\r\n    var parse_DConRef = parsenoop;\r\n    var parse_DConName = parsenoop;\r\n    var parse_XCT = parsenoop;\r\n    var parse_CRN = parsenoop;\r\n    var parse_FileSharing = parsenoop;\r\n    var parse_Uncalced = parsenoop;\r\n    var parse_Template = parsenoop;\r\n    var parse_Intl = parsenoop;\r\n    var parse_WsBool = parsenoop;\r\n    var parse_Sort = parsenoop;\r\n    var parse_Sync = parsenoop;\r\n    var parse_LPr = parsenoop;\r\n    var parse_DxGCol = parsenoop;\r\n    var parse_FnGroupName = parsenoop;\r\n    var parse_FilterMode = parsenoop;\r\n    var parse_AutoFilterInfo = parsenoop;\r\n    var parse_AutoFilter = parsenoop;\r\n    var parse_Setup = parsenoop;\r\n    var parse_ScenMan = parsenoop;\r\n    var parse_SCENARIO = parsenoop;\r\n    var parse_SxView = parsenoop;\r\n    var parse_Sxvd = parsenoop;\r\n    var parse_SXVI = parsenoop;\r\n    var parse_SxIvd = parsenoop;\r\n    var parse_SXLI = parsenoop;\r\n    var parse_SXPI = parsenoop;\r\n    var parse_DocRoute = parsenoop;\r\n    var parse_RecipName = parsenoop;\r\n    var parse_MulBlank = parsenoop;\r\n    var parse_SXDI = parsenoop;\r\n    var parse_SXDB = parsenoop;\r\n    var parse_SXFDB = parsenoop;\r\n    var parse_SXDBB = parsenoop;\r\n    var parse_SXNum = parsenoop;\r\n    var parse_SxErr = parsenoop;\r\n    var parse_SXInt = parsenoop;\r\n    var parse_SXString = parsenoop;\r\n    var parse_SXDtr = parsenoop;\r\n    var parse_SxNil = parsenoop;\r\n    var parse_SXTbl = parsenoop;\r\n    var parse_SXTBRGIITM = parsenoop;\r\n    var parse_SxTbpg = parsenoop;\r\n    var parse_ObProj = parsenoop;\r\n    var parse_SXStreamID = parsenoop;\r\n    var parse_DBCell = parsenoop;\r\n    var parse_SXRng = parsenoop;\r\n    var parse_SxIsxoper = parsenoop;\r\n    var parse_BookBool = parsenoop;\r\n    var parse_DbOrParamQry = parsenoop;\r\n    var parse_OleObjectSize = parsenoop;\r\n    var parse_SXVS = parsenoop;\r\n    var parse_BkHim = parsenoop;\r\n    var parse_MsoDrawingGroup = parsenoop;\r\n    var parse_MsoDrawing = parsenoop;\r\n    var parse_MsoDrawingSelection = parsenoop;\r\n    var parse_PhoneticInfo = parsenoop;\r\n    var parse_SxRule = parsenoop;\r\n    var parse_SXEx = parsenoop;\r\n    var parse_SxFilt = parsenoop;\r\n    var parse_SxDXF = parsenoop;\r\n    var parse_SxItm = parsenoop;\r\n    var parse_SxName = parsenoop;\r\n    var parse_SxSelect = parsenoop;\r\n    var parse_SXPair = parsenoop;\r\n    var parse_SxFmla = parsenoop;\r\n    var parse_SxFormat = parsenoop;\r\n    var parse_SXVDEx = parsenoop;\r\n    var parse_SXFormula = parsenoop;\r\n    var parse_SXDBEx = parsenoop;\r\n    var parse_RRDInsDel = parsenoop;\r\n    var parse_RRDHead = parsenoop;\r\n    var parse_RRDChgCell = parsenoop;\r\n    var parse_RRDRenSheet = parsenoop;\r\n    var parse_RRSort = parsenoop;\r\n    var parse_RRDMove = parsenoop;\r\n    var parse_RRFormat = parsenoop;\r\n    var parse_RRAutoFmt = parsenoop;\r\n    var parse_RRInsertSh = parsenoop;\r\n    var parse_RRDMoveBegin = parsenoop;\r\n    var parse_RRDMoveEnd = parsenoop;\r\n    var parse_RRDInsDelBegin = parsenoop;\r\n    var parse_RRDInsDelEnd = parsenoop;\r\n    var parse_RRDConflict = parsenoop;\r\n    var parse_RRDDefName = parsenoop;\r\n    var parse_RRDRstEtxp = parsenoop;\r\n    var parse_LRng = parsenoop;\r\n    var parse_CUsr = parsenoop;\r\n    var parse_CbUsr = parsenoop;\r\n    var parse_UsrInfo = parsenoop;\r\n    var parse_UsrExcl = parsenoop;\r\n    var parse_FileLock = parsenoop;\r\n    var parse_RRDInfo = parsenoop;\r\n    var parse_BCUsrs = parsenoop;\r\n    var parse_UsrChk = parsenoop;\r\n    var parse_UserBView = parsenoop;\r\n    var parse_UserSViewBegin = parsenoop; // overloaded\r\n    var parse_UserSViewEnd = parsenoop;\r\n    var parse_RRDUserView = parsenoop;\r\n    var parse_Qsi = parsenoop;\r\n    var parse_CondFmt = parsenoop;\r\n    var parse_CF = parsenoop;\r\n    var parse_DVal = parsenoop;\r\n    var parse_DConBin = parsenoop;\r\n    var parse_Lel = parsenoop;\r\n    var parse_XLSCodeName = parse_XLUnicodeString;\r\n    var parse_SXFDBType = parsenoop;\r\n    var parse_ObNoMacros = parsenoop;\r\n    var parse_Dv = parsenoop;\r\n    var parse_Index = parsenoop;\r\n    var parse_Table = parsenoop;\r\n    var parse_BigName = parsenoop;\r\n    var parse_ContinueBigName = parsenoop;\r\n    var parse_WebPub = parsenoop;\r\n    var parse_QsiSXTag = parsenoop;\r\n    var parse_DBQueryExt = parsenoop;\r\n    var parse_ExtString = parsenoop;\r\n    var parse_TxtQry = parsenoop;\r\n    var parse_Qsir = parsenoop;\r\n    var parse_Qsif = parsenoop;\r\n    var parse_RRDTQSIF = parsenoop;\r\n    var parse_OleDbConn = parsenoop;\r\n    var parse_WOpt = parsenoop;\r\n    var parse_SXViewEx = parsenoop;\r\n    var parse_SXTH = parsenoop;\r\n    var parse_SXPIEx = parsenoop;\r\n    var parse_SXVDTEx = parsenoop;\r\n    var parse_SXViewEx9 = parsenoop;\r\n    var parse_ContinueFrt = parsenoop;\r\n    var parse_RealTimeData = parsenoop;\r\n    var parse_ChartFrtInfo = parsenoop;\r\n    var parse_FrtWrapper = parsenoop;\r\n    var parse_StartBlock = parsenoop;\r\n    var parse_EndBlock = parsenoop;\r\n    var parse_StartObject = parsenoop;\r\n    var parse_EndObject = parsenoop;\r\n    var parse_CatLab = parsenoop;\r\n    var parse_YMult = parsenoop;\r\n    var parse_SXViewLink = parsenoop;\r\n    var parse_PivotChartBits = parsenoop;\r\n    var parse_FrtFontList = parsenoop;\r\n    var parse_SheetExt = parsenoop;\r\n    var parse_BookExt = parsenoop;\r\n    var parse_SXAddl = parsenoop;\r\n    var parse_CrErr = parsenoop;\r\n    var parse_HFPicture = parsenoop;\r\n    var parse_Feat = parsenoop;\r\n    var parse_DataLabExt = parsenoop;\r\n    var parse_DataLabExtContents = parsenoop;\r\n    var parse_CellWatch = parsenoop;\r\n    var parse_FeatHdr11 = parsenoop;\r\n    var parse_Feature11 = parsenoop;\r\n    var parse_DropDownObjIds = parsenoop;\r\n    var parse_ContinueFrt11 = parsenoop;\r\n    var parse_DConn = parsenoop;\r\n    var parse_List12 = parsenoop;\r\n    var parse_Feature12 = parsenoop;\r\n    var parse_CondFmt12 = parsenoop;\r\n    var parse_CF12 = parsenoop;\r\n    var parse_CFEx = parsenoop;\r\n    var parse_AutoFilter12 = parsenoop;\r\n    var parse_ContinueFrt12 = parsenoop;\r\n    var parse_MDTInfo = parsenoop;\r\n    var parse_MDXStr = parsenoop;\r\n    var parse_MDXTuple = parsenoop;\r\n    var parse_MDXSet = parsenoop;\r\n    var parse_MDXProp = parsenoop;\r\n    var parse_MDXKPI = parsenoop;\r\n    var parse_MDB = parsenoop;\r\n    var parse_PLV = parsenoop;\r\n    var parse_DXF = parsenoop;\r\n    var parse_TableStyles = parsenoop;\r\n    var parse_TableStyle = parsenoop;\r\n    var parse_TableStyleElement = parsenoop;\r\n    var parse_NamePublish = parsenoop;\r\n    var parse_NameCmt = parsenoop;\r\n    var parse_SortData = parsenoop;\r\n    var parse_GUIDTypeLib = parsenoop;\r\n    var parse_FnGrp12 = parsenoop;\r\n    var parse_NameFnGrp12 = parsenoop;\r\n    var parse_HeaderFooter = parsenoop;\r\n    var parse_CrtLayout12 = parsenoop;\r\n    var parse_CrtMlFrt = parsenoop;\r\n    var parse_CrtMlFrtContinue = parsenoop;\r\n    var parse_ShapePropsStream = parsenoop;\r\n    var parse_TextPropsStream = parsenoop;\r\n    var parse_RichTextStream = parsenoop;\r\n    var parse_CrtLayout12A = parsenoop;\r\n    var parse_Units = parsenoop;\r\n    var parse_Chart = parsenoop;\r\n    var parse_Series = parsenoop;\r\n    var parse_DataFormat = parsenoop;\r\n    var parse_LineFormat = parsenoop;\r\n    var parse_MarkerFormat = parsenoop;\r\n    var parse_AreaFormat = parsenoop;\r\n    var parse_PieFormat = parsenoop;\r\n    var parse_AttachedLabel = parsenoop;\r\n    var parse_SeriesText = parsenoop;\r\n    var parse_ChartFormat = parsenoop;\r\n    var parse_Legend = parsenoop;\r\n    var parse_SeriesList = parsenoop;\r\n    var parse_Bar = parsenoop;\r\n    var parse_Line = parsenoop;\r\n    var parse_Pie = parsenoop;\r\n    var parse_Area = parsenoop;\r\n    var parse_Scatter = parsenoop;\r\n    var parse_CrtLine = parsenoop;\r\n    var parse_Axis = parsenoop;\r\n    var parse_Tick = parsenoop;\r\n    var parse_ValueRange = parsenoop;\r\n    var parse_CatSerRange = parsenoop;\r\n    var parse_AxisLine = parsenoop;\r\n    var parse_CrtLink = parsenoop;\r\n    var parse_DefaultText = parsenoop;\r\n    var parse_Text = parsenoop;\r\n    var parse_ObjectLink = parsenoop;\r\n    var parse_Frame = parsenoop;\r\n    var parse_Begin = parsenoop;\r\n    var parse_End = parsenoop;\r\n    var parse_PlotArea = parsenoop;\r\n    var parse_Chart3d = parsenoop;\r\n    var parse_PicF = parsenoop;\r\n    var parse_DropBar = parsenoop;\r\n    var parse_Radar = parsenoop;\r\n    var parse_Surf = parsenoop;\r\n    var parse_RadarArea = parsenoop;\r\n    var parse_AxisParent = parsenoop;\r\n    var parse_LegendException = parsenoop;\r\n    var parse_ShtProps = parsenoop;\r\n    var parse_SerToCrt = parsenoop;\r\n    var parse_AxesUsed = parsenoop;\r\n    var parse_SBaseRef = parsenoop;\r\n    var parse_SerParent = parsenoop;\r\n    var parse_SerAuxTrend = parsenoop;\r\n    var parse_IFmtRecord = parsenoop;\r\n    var parse_Pos = parsenoop;\r\n    var parse_AlRuns = parsenoop;\r\n    var parse_BRAI = parsenoop;\r\n    var parse_SerAuxErrBar = parsenoop;\r\n    var parse_SerFmt = parsenoop;\r\n    var parse_Chart3DBarShape = parsenoop;\r\n    var parse_Fbi = parsenoop;\r\n    var parse_BopPop = parsenoop;\r\n    var parse_AxcExt = parsenoop;\r\n    var parse_Dat = parsenoop;\r\n    var parse_PlotGrowth = parsenoop;\r\n    var parse_SIIndex = parsenoop;\r\n    var parse_GelFrame = parsenoop;\r\n    var parse_BopPopCustom = parsenoop;\r\n    var parse_Fbi2 = parsenoop;\r\n\r\n    /* --- Specific to versions before BIFF8 --- */\r\n    function parse_BIFF5String(blob) {\r\n        var len = blob.read_shift(1);\r\n        return blob.read_shift(len, 'sbcs-cont');\r\n    }\r\n\r\n    /* BIFF2_??? where ??? is the name from [XLS] */\r\n    function parse_BIFF2STR(blob, length, opts) {\r\n        var cell = parse_XLSCell(blob, 6);\r\n        ++blob.l;\r\n        var str = parse_XLUnicodeString2(blob, length - 7, opts);\r\n        cell.val = str;\r\n        return cell;\r\n    }\r\n\r\n    function parse_BIFF2NUM(blob, length, opts) {\r\n        var cell = parse_XLSCell(blob, 6);\r\n        ++blob.l;\r\n        var num = parse_Xnum(blob, 8);\r\n        cell.val = num;\r\n        return cell;\r\n    }\r\n\r\n    /* 18.4.1 charset to codepage mapping */\r\n    var CS2CP = {\r\n        0: 1252, /* ANSI */\r\n        1: 65001, /* DEFAULT */\r\n        2: 65001, /* SYMBOL */\r\n        77: 10000, /* MAC */\r\n        128: 932, /* SHIFTJIS */\r\n        129: 949, /* HANGUL */\r\n        130: 1361, /* JOHAB */\r\n        134: 936, /* GB2312 */\r\n        136: 950, /* CHINESEBIG5 */\r\n        161: 1253, /* GREEK */\r\n        162: 1254, /* TURKISH */\r\n        163: 1258, /* VIETNAMESE */\r\n        177: 1255, /* HEBREW */\r\n        178: 1256, /* ARABIC */\r\n        186: 1257, /* BALTIC */\r\n        204: 1251, /* RUSSIAN */\r\n        222: 874, /* THAI */\r\n        238: 1250, /* EASTEUROPE */\r\n        255: 1252, /* OEM */\r\n        69: 6969  /* MISC */\r\n    };\r\n\r\n    /* Parse a list of <r> tags */\r\n    var parse_rs = (function parse_rs_factory() {\r\n        var tregex = matchtag(\"t\"), rpregex = matchtag(\"rPr\"), rregex = /<r>/g, rend = /<\\/r>/, nlregex = /\\r\\n/g;\r\n        /* 18.4.7 rPr CT_RPrElt */\r\n        var parse_rpr = function parse_rpr(rpr, intro, outro) {\r\n            var font = {}, cp = 65001;\r\n            var m = rpr.match(tagregex), i = 0;\r\n            if (m) for (; i != m.length; ++i) {\r\n                var y = parsexmltag(m[i]);\r\n                switch (y[0]) {\r\n                    /* 18.8.12 condense CT_BooleanProperty */\r\n                    /* ** not required . */\r\n                    case '<condense': break;\r\n                    /* 18.8.17 extend CT_BooleanProperty */\r\n                    /* ** not required . */\r\n                    case '<extend': break;\r\n                    /* 18.8.36 shadow CT_BooleanProperty */\r\n                    /* ** not required . */\r\n                    case '<shadow':\r\n                    /* falls through */\r\n                    case '<shadow/>': break;\r\n\r\n                    /* 18.4.1 charset CT_IntProperty TODO */\r\n                    case '<charset':\r\n                        if (y.val == '1') break;\r\n                        cp = CS2CP[parseInt(y.val, 10)];\r\n                        break;\r\n\r\n                    /* 18.4.2 outline CT_BooleanProperty TODO */\r\n                    case '<outline':\r\n                    /* falls through */\r\n                    case '<outline/>': break;\r\n\r\n                    /* 18.4.5 rFont CT_FontName */\r\n                    case '<rFont': font.name = y.val; break;\r\n\r\n                    /* 18.4.11 sz CT_FontSize */\r\n                    case '<sz': font.sz = y.val; break;\r\n\r\n                    /* 18.4.10 strike CT_BooleanProperty */\r\n                    case '<strike':\r\n                        if (!y.val) break;\r\n                    /* falls through */\r\n                    case '<strike/>': font.strike = 1; break;\r\n                    case '</strike>': break;\r\n\r\n                    /* 18.4.13 u CT_UnderlineProperty */\r\n                    case '<u':\r\n                        if (!y.val) break;\r\n                    /* falls through */\r\n                    case '<u/>': font.u = 1; break;\r\n                    case '</u>': break;\r\n\r\n                    /* 18.8.2 b */\r\n                    case '<b':\r\n                        if (!y.val) break;\r\n                    /* falls through */\r\n                    case '<b/>': font.b = 1; break;\r\n                    case '</b>': break;\r\n\r\n                    /* 18.8.26 i */\r\n                    case '<i':\r\n                        if (!y.val) break;\r\n                    /* falls through */\r\n                    case '<i/>': font.i = 1; break;\r\n                    case '</i>': break;\r\n\r\n                    /* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\r\n                    case '<color':\r\n                        if (y.rgb) font.color = y.rgb.substr(2, 6);\r\n                        break;\r\n\r\n                    /* 18.8.18 family ST_FontFamily */\r\n                    case '<family': font.family = y.val; break;\r\n\r\n                    /* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\r\n                    case '<vertAlign': break;\r\n\r\n                    /* 18.8.35 scheme CT_FontScheme TODO */\r\n                    case '<scheme': break;\r\n\r\n                    default:\r\n                        if (y[0].charCodeAt(1) !== 47) throw 'Unrecognized rich format ' + y[0];\r\n                }\r\n            }\r\n            /* TODO: These should be generated styles, not inline */\r\n            var style = [];\r\n            if (font.b) style.push(\"font-weight: bold;\");\r\n            if (font.i) style.push(\"font-style: italic;\");\r\n            intro.push('<span style=\"' + style.join(\"\") + '\">');\r\n            outro.push(\"</span>\");\r\n            return cp;\r\n        };\r\n\r\n        /* 18.4.4 r CT_RElt */\r\n        function parse_r(r) {\r\n            var terms = [[], \"\", []];\r\n            /* 18.4.12 t ST_Xstring */\r\n            var t = r.match(tregex), cp = 65001;\r\n            if (!isval(t)) return \"\";\r\n            terms[1] = t[1];\r\n\r\n            var rpr = r.match(rpregex);\r\n            if (isval(rpr)) cp = parse_rpr(rpr[1], terms[0], terms[2]);\r\n\r\n            return terms[0].join(\"\") + terms[1].replace(nlregex, '<br/>') + terms[2].join(\"\");\r\n        }\r\n        return function parse_rs(rs) {\r\n            return rs.replace(rregex, \"\").split(rend).map(parse_r).join(\"\");\r\n        };\r\n    })();\r\n\r\n    /* 18.4.8 si CT_Rst */\r\n    var sitregex = /<t[^>]*>([^<]*)<\\/t>/g, sirregex = /<r>/;\r\n    function parse_si(x, opts) {\r\n        var html = opts ? opts.cellHTML : true;\r\n        var z = {};\r\n        if (!x) return null;\r\n        var y;\r\n        /* 18.4.12 t ST_Xstring (Plaintext String) */\r\n        if (x.charCodeAt(1) === 116) {\r\n            z.t = utf8read(unescapexml(x.substr(x.indexOf(\">\") + 1).split(/<\\/t>/)[0]));\r\n            z.r = x;\r\n            if (html) z.h = z.t;\r\n        }\r\n        /* 18.4.4 r CT_RElt (Rich Text Run) */\r\n        else if ((y = x.match(sirregex))) {\r\n            z.r = x;\r\n            z.t = utf8read(unescapexml(x.match(sitregex).join(\"\").replace(tagregex, \"\")));\r\n            if (html) z.h = parse_rs(x);\r\n        }\r\n        /* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\r\n        /* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\r\n        return z;\r\n    }\r\n\r\n    /* 18.4 Shared String Table */\r\n    var sstr0 = /<sst([^>]*)>([\\s\\S]*)<\\/sst>/;\r\n    var sstr1 = /<(?:si|sstItem)>/g;\r\n    var sstr2 = /<\\/(?:si|sstItem)>/;\r\n    function parse_sst_xml(data, opts) {\r\n        var s = [], ss;\r\n        /* 18.4.9 sst CT_Sst */\r\n        var sst = data.match(sstr0);\r\n        if (isval(sst)) {\r\n            ss = sst[2].replace(sstr1, \"\").split(sstr2);\r\n            for (var i = 0; i != ss.length; ++i) {\r\n                var o = parse_si(ss[i], opts);\r\n                if (o != null) s[s.length] = o;\r\n            }\r\n            sst = parsexmltag(sst[1]); s.Count = sst.count; s.Unique = sst.uniqueCount;\r\n        }\r\n        return s;\r\n    }\r\n\r\n    RELS.SST = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\";\r\n    var straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\r\n    function write_sst_xml(sst, opts) {\r\n        if (!opts.bookSST) return \"\";\r\n        var o = [XML_HEADER];\r\n        o[o.length] = (writextag('sst', null, {\r\n            xmlns: XMLNS.main[0],\r\n            count: sst.Count,\r\n            uniqueCount: sst.Unique\r\n        }));\r\n        for (var i = 0; i != sst.length; ++i) {\r\n            if (sst[i] == null) continue;\r\n            var s = sst[i];\r\n            var sitag = \"<si>\";\r\n            if (s.r) sitag += s.r;\r\n            else {\r\n                sitag += \"<t\";\r\n                if (s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\r\n                sitag += \">\" + escapexml(s.t) + \"</t>\";\r\n            }\r\n            sitag += \"</si>\";\r\n            o[o.length] = (sitag);\r\n        }\r\n        if (o.length > 2) { o[o.length] = ('</sst>'); o[1] = o[1].replace(\"/>\", \">\"); }\r\n        return o.join(\"\");\r\n    }\r\n    /* [MS-XLSB] 2.4.219 BrtBeginSst */\r\n    function parse_BrtBeginSst(data, length) {\r\n        return [data.read_shift(4), data.read_shift(4)];\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.7.45 Shared Strings */\r\n    function parse_sst_bin(data, opts) {\r\n        var s = [];\r\n        var pass = false;\r\n        recordhopper(data, function hopper_sst(val, R, RT) {\r\n            switch (R.n) {\r\n                case 'BrtBeginSst': s.Count = val[0]; s.Unique = val[1]; break;\r\n                case 'BrtSSTItem': s.push(val); break;\r\n                case 'BrtEndSst': return true;\r\n                /* TODO: produce a test case with a future record */\r\n                case 'BrtFRTBegin': pass = true; break;\r\n                case 'BrtFRTEnd': pass = false; break;\r\n                default: if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\r\n            }\r\n        });\r\n        return s;\r\n    }\r\n\r\n    function write_BrtBeginSst(sst, o) {\r\n        if (!o) o = new_buf(8);\r\n        o.write_shift(4, sst.Count);\r\n        o.write_shift(4, sst.Unique);\r\n        return o;\r\n    }\r\n\r\n    var write_BrtSSTItem = write_RichStr;\r\n\r\n    function write_sst_bin(sst, opts) {\r\n        var ba = buf_array();\r\n        write_record(ba, \"BrtBeginSst\", write_BrtBeginSst(sst));\r\n        for (var i = 0; i < sst.length; ++i) write_record(ba, \"BrtSSTItem\", write_BrtSSTItem(sst[i]));\r\n        write_record(ba, \"BrtEndSst\");\r\n        return ba.end();\r\n    }\r\n    function _JS2ANSI(str) { if (typeof cptable !== 'undefined') return cptable.utils.encode(1252, str); return str.split(\"\").map(function (x) { return x.charCodeAt(0); }); }\r\n\r\n    /* [MS-OFFCRYPTO] 2.1.4 Version */\r\n    function parse_Version(blob, length) {\r\n        var o = {};\r\n        o.Major = blob.read_shift(2);\r\n        o.Minor = blob.read_shift(2);\r\n        return o;\r\n    }\r\n    /* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\r\n    function parse_EncryptionHeader(blob, length) {\r\n        var o = {};\r\n        o.Flags = blob.read_shift(4);\r\n\r\n        // Check if SizeExtra is 0x00000000\r\n        var tmp = blob.read_shift(4);\r\n        if (tmp !== 0) throw 'Unrecognized SizeExtra: ' + tmp;\r\n\r\n        o.AlgID = blob.read_shift(4);\r\n        switch (o.AlgID) {\r\n            case 0: case 0x6801: case 0x660E: case 0x660F: case 0x6610: break;\r\n            default: throw 'Unrecognized encryption algorithm: ' + o.AlgID;\r\n        }\r\n        parsenoop(blob, length - 12);\r\n        return o;\r\n    }\r\n\r\n    /* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\r\n    function parse_EncryptionVerifier(blob, length) {\r\n        return parsenoop(blob, length);\r\n    }\r\n    /* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\r\n    function parse_RC4CryptoHeader(blob, length) {\r\n        var o = {};\r\n        var vers = o.EncryptionVersionInfo = parse_Version(blob, 4); length -= 4;\r\n        if (vers.Minor != 2) throw 'unrecognized minor version code: ' + vers.Minor;\r\n        if (vers.Major > 4 || vers.Major < 2) throw 'unrecognized major version code: ' + vers.Major;\r\n        o.Flags = blob.read_shift(4); length -= 4;\r\n        var sz = blob.read_shift(4); length -= 4;\r\n        o.EncryptionHeader = parse_EncryptionHeader(blob, sz); length -= sz;\r\n        o.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\r\n        return o;\r\n    }\r\n    /* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\r\n    function parse_RC4Header(blob, length) {\r\n        var o = {};\r\n        var vers = o.EncryptionVersionInfo = parse_Version(blob, 4); length -= 4;\r\n        if (vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\r\n        o.Salt = blob.read_shift(16);\r\n        o.EncryptedVerifier = blob.read_shift(16);\r\n        o.EncryptedVerifierHash = blob.read_shift(16);\r\n        return o;\r\n    }\r\n\r\n    /* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\r\n    function crypto_CreatePasswordVerifier_Method1(Password) {\r\n        var Verifier = 0x0000, PasswordArray;\r\n        var PasswordDecoded = _JS2ANSI(Password);\r\n        var len = PasswordDecoded.length + 1, i, PasswordByte;\r\n        var Intermediate1, Intermediate2, Intermediate3;\r\n        PasswordArray = new_raw_buf(len);\r\n        PasswordArray[0] = PasswordDecoded.length;\r\n        for (i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i - 1];\r\n        for (i = len - 1; i >= 0; --i) {\r\n            PasswordByte = PasswordArray[i];\r\n            Intermediate1 = ((Verifier & 0x4000) === 0x0000) ? 0 : 1;\r\n            Intermediate2 = (Verifier << 1) & 0x7FFF;\r\n            Intermediate3 = Intermediate1 | Intermediate2;\r\n            Verifier = Intermediate3 ^ PasswordByte;\r\n        }\r\n        return Verifier ^ 0xCE4B;\r\n    }\r\n\r\n    /* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\r\n    var crypto_CreateXorArray_Method1 = (function () {\r\n        var PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\r\n        var InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\r\n        var XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\r\n        var Ror = function (Byte) { return ((Byte / 2) | (Byte * 128)) & 0xFF; };\r\n        var XorRor = function (byte1, byte2) { return Ror(byte1 ^ byte2); };\r\n        var CreateXorKey_Method1 = function (Password) {\r\n            var XorKey = InitialCode[Password.length - 1];\r\n            var CurrentElement = 0x68;\r\n            for (var i = Password.length - 1; i >= 0; --i) {\r\n                var Char = Password[i];\r\n                for (var j = 0; j != 7; ++j) {\r\n                    if (Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\r\n                    Char *= 2; --CurrentElement;\r\n                }\r\n            }\r\n            return XorKey;\r\n        };\r\n        return function (password) {\r\n            var Password = _JS2ANSI(password);\r\n            var XorKey = CreateXorKey_Method1(Password);\r\n            var Index = Password.length;\r\n            var ObfuscationArray = new_raw_buf(16);\r\n            for (var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\r\n            var Temp, PasswordLastChar, PadIndex;\r\n            if ((Index & 1) === 1) {\r\n                Temp = XorKey >> 8;\r\n                ObfuscationArray[Index] = XorRor(PadArray[0], Temp);\r\n                --Index;\r\n                Temp = XorKey & 0xFF;\r\n                PasswordLastChar = Password[Password.length - 1];\r\n                ObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\r\n            }\r\n            while (Index > 0) {\r\n                --Index;\r\n                Temp = XorKey >> 8;\r\n                ObfuscationArray[Index] = XorRor(Password[Index], Temp);\r\n                --Index;\r\n                Temp = XorKey & 0xFF;\r\n                ObfuscationArray[Index] = XorRor(Password[Index], Temp);\r\n            }\r\n            Index = 15;\r\n            PadIndex = 15 - Password.length;\r\n            while (PadIndex > 0) {\r\n                Temp = XorKey >> 8;\r\n                ObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\r\n                --Index;\r\n                --PadIndex;\r\n                Temp = XorKey & 0xFF;\r\n                ObfuscationArray[Index] = XorRor(Password[Index], Temp);\r\n                --Index;\r\n                --PadIndex;\r\n            }\r\n            return ObfuscationArray;\r\n        };\r\n    })();\r\n\r\n    /* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\r\n    var crypto_DecryptData_Method1 = function (password, Data, XorArrayIndex, XorArray, O) {\r\n        /* If XorArray is set, use it; if O is not set, make changes in-place */\r\n        if (!O) O = Data;\r\n        if (!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\r\n        var Index, Value;\r\n        for (Index = 0; Index != Data.length; ++Index) {\r\n            Value = Data[Index];\r\n            Value ^= XorArray[XorArrayIndex];\r\n            Value = ((Value >> 5) | (Value << 3)) & 0xFF;\r\n            O[Index] = Value;\r\n            ++XorArrayIndex;\r\n        }\r\n        return [O, XorArrayIndex, XorArray];\r\n    };\r\n\r\n    var crypto_MakeXorDecryptor = function (password) {\r\n        var XorArrayIndex = 0, XorArray = crypto_CreateXorArray_Method1(password);\r\n        return function (Data) {\r\n            var O = crypto_DecryptData_Method1(null, Data, XorArrayIndex, XorArray);\r\n            XorArrayIndex = O[1];\r\n            return O[0];\r\n        };\r\n    };\r\n\r\n    /* 2.5.343 */\r\n    function parse_XORObfuscation(blob, length, opts, out) {\r\n        var o = { key: parseuint16(blob), verificationBytes: parseuint16(blob) };\r\n        if (opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\r\n        out.valid = o.verificationBytes === o.verifier;\r\n        if (out.valid) out.insitu_decrypt = crypto_MakeXorDecryptor(opts.password);\r\n        return o;\r\n    }\r\n\r\n    /* 2.4.117 */\r\n    function parse_FilePassHeader(blob, length, oo) {\r\n        var o = oo || {}; o.Info = blob.read_shift(2); blob.l -= 2;\r\n        if (o.Info === 1) o.Data = parse_RC4Header(blob, length);\r\n        else o.Data = parse_RC4CryptoHeader(blob, length);\r\n        return o;\r\n    }\r\n    function parse_FilePass(blob, length, opts) {\r\n        var o = { Type: blob.read_shift(2) }; /* wEncryptionType */\r\n        if (o.Type) parse_FilePassHeader(blob, length - 2, o);\r\n        else parse_XORObfuscation(blob, length - 2, opts, o);\r\n        return o;\r\n    }\r\n\r\n\r\n    function hex2RGB(h) {\r\n        var o = h.substr(h[0] === \"#\" ? 1 : 0, 6);\r\n        return [parseInt(o.substr(0, 2), 16), parseInt(o.substr(2, 2), 16), parseInt(o.substr(4, 2), 16)];\r\n    }\r\n    function rgb2Hex(rgb) {\r\n        for (var i = 0, o = 1; i != 3; ++i) o = o * 256 + (rgb[i] > 255 ? 255 : rgb[i] < 0 ? 0 : rgb[i]);\r\n        return o.toString(16).toUpperCase().substr(1);\r\n    }\r\n\r\n    function rgb2HSL(rgb) {\r\n        var R = rgb[0] / 255, G = rgb[1] / 255, B = rgb[2] / 255;\r\n        var M = Math.max(R, G, B), m = Math.min(R, G, B), C = M - m;\r\n        if (C === 0) return [0, 0, R];\r\n\r\n        var H6 = 0, S = 0, L2 = (M + m);\r\n        S = C / (L2 > 1 ? 2 - L2 : L2);\r\n        switch (M) {\r\n            case R: H6 = ((G - B) / C + 6) % 6; break;\r\n            case G: H6 = ((B - R) / C + 2); break;\r\n            case B: H6 = ((R - G) / C + 4); break;\r\n        }\r\n        return [H6 / 6, S, L2 / 2];\r\n    }\r\n\r\n    function hsl2RGB(hsl) {\r\n        var H = hsl[0], S = hsl[1], L = hsl[2];\r\n        var C = S * 2 * (L < 0.5 ? L : 1 - L), m = L - C / 2;\r\n        var rgb = [m, m, m], h6 = 6 * H;\r\n\r\n        var X;\r\n        if (S !== 0) switch (h6 | 0) {\r\n            case 0: case 6: X = C * h6; rgb[0] += C; rgb[1] += X; break;\r\n            case 1: X = C * (2 - h6); rgb[0] += X; rgb[1] += C; break;\r\n            case 2: X = C * (h6 - 2); rgb[1] += C; rgb[2] += X; break;\r\n            case 3: X = C * (4 - h6); rgb[1] += X; rgb[2] += C; break;\r\n            case 4: X = C * (h6 - 4); rgb[2] += C; rgb[0] += X; break;\r\n            case 5: X = C * (6 - h6); rgb[2] += X; rgb[0] += C; break;\r\n        }\r\n        for (var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i] * 255);\r\n        return rgb;\r\n    }\r\n\r\n    /* 18.8.3 bgColor tint algorithm */\r\n    function rgb_tint(hex, tint) {\r\n        if (tint == 0) return hex;\r\n        var hsl = rgb2HSL(hex2RGB(hex));\r\n        if (tint < 0) hsl[2] = hsl[2] * (1 + tint);\r\n        else hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\r\n        var rev = rgb2Hex(hsl2RGB(hsl))\r\n        return rev;\r\n    }\r\n\r\n    /* 18.3.1.13 width calculations */\r\n    var DEF_MDW = 7, MAX_MDW = 15, MIN_MDW = 1, MDW = DEF_MDW;\r\n    function width2px(width) { return ((width + ((128 / MDW) | 0) / 256) * MDW) | 0; }\r\n    function px2char(px) { return (((px - 5) / MDW * 100 + 0.5) | 0) / 100; }\r\n    function char2width(chr) { return (((chr * MDW + 5) / MDW * 256) | 0) / 256; }\r\n    function cycle_width(collw) { return char2width(px2char(width2px(collw))); }\r\n    function find_mdw(collw, coll) {\r\n        if (cycle_width(collw) != collw) {\r\n            for (MDW = DEF_MDW; MDW > MIN_MDW; --MDW) if (cycle_width(collw) === collw) break;\r\n            if (MDW === MIN_MDW) for (MDW = DEF_MDW + 1; MDW < MAX_MDW; ++MDW) if (cycle_width(collw) === collw) break;\r\n            if (MDW === MAX_MDW) MDW = DEF_MDW;\r\n        }\r\n    }\r\n\r\n    /* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\r\n    var XLMLPatternTypeMap = {\r\n        \"None\": \"none\",\r\n        \"Solid\": \"solid\",\r\n        \"Gray50\": \"mediumGray\",\r\n        \"Gray75\": \"darkGray\",\r\n        \"Gray25\": \"lightGray\",\r\n        \"HorzStripe\": \"darkHorizontal\",\r\n        \"VertStripe\": \"darkVertical\",\r\n        \"ReverseDiagStripe\": \"darkDown\",\r\n        \"DiagStripe\": \"darkUp\",\r\n        \"DiagCross\": \"darkGrid\",\r\n        \"ThickDiagCross\": \"darkTrellis\",\r\n        \"ThinHorzStripe\": \"lightHorizontal\",\r\n        \"ThinVertStripe\": \"lightVertical\",\r\n        \"ThinReverseDiagStripe\": \"lightDown\",\r\n        \"ThinHorzCross\": \"lightGrid\"\r\n    };\r\n\r\n    var styles = {}; // shared styles\r\n\r\n    var themes = {}; // shared themes\r\n\r\n    /* 18.8.21 fills CT_Fills */\r\n    function parse_fills(t, opts) {\r\n        styles.Fills = [];\r\n        var fill = {};\r\n        t[0].match(tagregex).forEach(function (x) {\r\n            var y = parsexmltag(x);\r\n            switch (y[0]) {\r\n                case '<fills':\r\n                case '<fills>':\r\n                case '</fills>':\r\n                    break;\r\n\r\n                /* 18.8.20 fill CT_Fill */\r\n                case '<fill>':\r\n                    break;\r\n                case '</fill>':\r\n                    styles.Fills.push(fill);\r\n                    fill = {};\r\n                    break;\r\n\r\n                /* 18.8.32 patternFill CT_PatternFill */\r\n                case '<patternFill':\r\n                    if (y.patternType) fill.patternType = y.patternType;\r\n                    break;\r\n                case '<patternFill/>':\r\n                case '</patternFill>':\r\n                    break;\r\n\r\n                /* 18.8.3 bgColor CT_Color */\r\n                case '<bgColor':\r\n                    if (!fill.bgColor) fill.bgColor = {};\r\n                    if (y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\r\n                    if (y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\r\n                    if (y.tint) fill.bgColor.tint = parseFloat(y.tint);\r\n\r\n\r\n                    if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\r\n                        fill.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb, fill.bgColor.tint || 0);\r\n                        if (opts.WTF) fill.bgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb, 0);\r\n                    }\r\n                    /* Excel uses ARGB strings */\r\n                    if (y.rgb) fill.bgColor.rgb = y.rgb;//.substring(y.rgb.length - 6);\r\n                    break;\r\n                case '<bgColor/>':\r\n                case '</bgColor>':\r\n                    break;\r\n\r\n                /* 18.8.19 fgColor CT_Color */\r\n                case '<fgColor':\r\n                    if (!fill.fgColor) fill.fgColor = {};\r\n                    if (y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\r\n                    if (y.tint) fill.fgColor.tint = parseFloat(y.tint);\r\n\r\n                    if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\r\n                        fill.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb, fill.fgColor.tint || 0);\r\n                        if (opts.WTF) fill.fgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb, 0);\r\n                    }\r\n\r\n                    /* Excel uses ARGB strings */\r\n                    if (y.rgb) fill.fgColor.rgb = y.rgb;//.substring(y.rgb.length - 6);\r\n                    break;\r\n                case '<fgColor/>':\r\n                case '</fgColor>':\r\n                    break;\r\n\r\n                default:\r\n                    if (opts.WTF) throw 'unrecognized ' + y[0] + ' in fills';\r\n            }\r\n        });\r\n    }\r\n\r\n    function parse_fonts(t, opts) {\r\n        styles.Fonts = [];\r\n        var font = {};\r\n        t[0].match(tagregex).forEach(function (x) {\r\n            var y = parsexmltag(x);\r\n            switch (y[0]) {\r\n\r\n                case '<fonts':\r\n                case '<fonts>':\r\n                case '</fonts>':\r\n                    break;\r\n                case '<font':\r\n                    break;\r\n                case '</font>':\r\n                    styles.Fonts.push(font);\r\n                    ;\r\n                    font = {};\r\n                    break;\r\n\r\n                case '<name':\r\n                    if (y.val) font.name = y.val;\r\n                    break;\r\n                case '<name/>':\r\n                case '</name>':\r\n                    break;\r\n\r\n\r\n                case '<b/>':\r\n                    font.bold = true;\r\n                    break;\r\n                case '<u/>':\r\n                    font.underline = true;\r\n                    break;\r\n                case '<i/>':\r\n                    font.italic = true;\r\n                    break;\r\n                case '<strike/>':\r\n                    font.strike = true;\r\n                    break;\r\n                case '<outline/>':\r\n                    font.outline = true;\r\n                    break;\r\n                case '<shadow/>':\r\n                    font.shadow = true;\r\n                    break;\r\n\r\n\r\n                case '<sz':\r\n                    if (y.val) font.sz = y.val;\r\n                    break;\r\n                case '<sz/>':\r\n                case '</sz>':\r\n                    break;\r\n\r\n                case '<vertAlign':\r\n                    if (y.val) font.vertAlign = y.val;\r\n                    break;\r\n                case '<vertAlign/>':\r\n                case '</vertAlign>':\r\n                    break;\r\n\r\n\r\n                case '<color':\r\n                    if (!font.color) font.color = {};\r\n                    if (y.theme) font.color.theme = y.theme;\r\n                    if (y.tint) font.color.tint = y.tint;\r\n                    if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\r\n                        font.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\r\n                    }\r\n                    if (y.rgb) font.color.rgb = y.rgb;\r\n                    break;\r\n                case '<color/>':\r\n                case '</color>':\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    function parse_borders(t, opts) {\r\n        styles.Borders = [];\r\n        var border = {}, sub_border = {};\r\n        t[0].match(tagregex).forEach(function (x) {\r\n            var y = parsexmltag(x);\r\n            switch (y[0]) {\r\n                case '<borders':\r\n                case '<borders>':\r\n                case '</borders>':\r\n                    break;\r\n                case '<border':\r\n                case '<border>':\r\n                    border = {};\r\n                    if (y.diagonalUp) { border.diagonalUp = y.diagonalUp; }\r\n                    if (y.diagonalDown) { border.diagonalDown = y.diagonalDown; }\r\n                    styles.Borders.push(border);\r\n\r\n                    break;\r\n                    break;\r\n                case '</border>':\r\n                    break;\r\n\r\n                case '<left':\r\n                    sub_border = border.left = {};\r\n                    if (y.style) {\r\n                        sub_border.style = y.style;\r\n                    }\r\n                    break;\r\n                case '<right':\r\n                    sub_border = border.right = {};\r\n                    if (y.style) {\r\n                        sub_border.style = y.style;\r\n                    }\r\n                    break;\r\n                case '<top':\r\n                    sub_border = border.top = {};\r\n                    if (y.style) {\r\n                        sub_border.style = y.style;\r\n                    }\r\n                    break;\r\n                case '<bottom':\r\n                    sub_border = border.bottom = {};\r\n                    if (y.style) {\r\n                        sub_border.style = y.style;\r\n                    }\r\n                    break;\r\n                case '<diagonal':\r\n                    sub_border = border.diagonal = {};\r\n                    if (y.style) {\r\n                        sub_border.style = y.style;\r\n                    }\r\n                    break;\r\n\r\n                case '<color':\r\n                    sub_border.color = {};\r\n                    if (y.theme) sub_border.color.theme = y.theme;\r\n                    if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\r\n                        sub_border.color.rgb = rgb_tint(themes.themeElements.clrScheme[sub_border.color.theme].rgb, sub_border.color.tint || 0);\r\n                    }\r\n\r\n                    if (y.tint) sub_border.color.tint = y.tint;\r\n                    if (y.rgb) sub_border.color.rgb = y.rgb;\r\n                    if (y.auto) sub_border.color.auto = y.auto;\r\n                    break;\r\n                case '<name/>':\r\n                case '</name>':\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    /* 18.8.31 numFmts CT_NumFmts */\r\n    function parse_numFmts(t, opts) {\r\n        styles.NumberFmt = [];\r\n        var k = keys(SSF._table);\r\n        for (var i = 0; i < k.length; ++i) styles.NumberFmt[k[i]] = SSF._table[k[i]];\r\n        var m = t[0].match(tagregex);\r\n        for (i = 0; i < m.length; ++i) {\r\n            var y = parsexmltag(m[i]);\r\n            switch (y[0]) {\r\n                case '<numFmts':\r\n                case '</numFmts>':\r\n                case '<numFmts/>':\r\n                case '<numFmts>':\r\n                    break;\r\n                case '<numFmt':\r\n                    {\r\n                        var f = unescapexml(utf8read(y.formatCode)), j = parseInt(y.numFmtId, 10);\r\n                        styles.NumberFmt[j] = f;\r\n                        if (j > 0) SSF.load(f, j);\r\n                    }\r\n                    break;\r\n                default:\r\n                    if (opts.WTF) throw 'unrecognized ' + y[0] + ' in numFmts';\r\n            }\r\n        }\r\n    }\r\n\r\n    function write_numFmts(NF, opts) {\r\n        var o = [\"<numFmts>\"];\r\n        [\r\n            [5, 8],\r\n            [23, 26],\r\n            [41, 44],\r\n            [63, 66],\r\n            [164, 392]\r\n        ].forEach(function (r) {\r\n            for (var i = r[0]; i <= r[1]; ++i) if (NF[i] !== undefined) o[o.length] = (writextag('numFmt', null, { numFmtId: i, formatCode: escapexml(NF[i]) }));\r\n        });\r\n        if (o.length === 1) return \"\";\r\n        o[o.length] = (\"</numFmts>\");\r\n        o[0] = writextag('numFmts', null, { count: o.length - 2 }).replace(\"/>\", \">\");\r\n        return o.join(\"\");\r\n    }\r\n\r\n    /* 18.8.10 cellXfs CT_CellXfs */\r\n    function parse_cellXfs(t, opts) {\r\n        styles.CellXf = [];\r\n        var xf;\r\n        t[0].match(tagregex).forEach(function (x) {\r\n            var y = parsexmltag(x);\r\n            switch (y[0]) {\r\n                case '<cellXfs':\r\n                case '<cellXfs>':\r\n                case '<cellXfs/>':\r\n                case '</cellXfs>':\r\n                    break;\r\n\r\n                /* 18.8.45 xf CT_Xf */\r\n                case '<xf':\r\n                    xf = y;\r\n                    delete xf[0];\r\n                    delete y[0];\r\n                    if (xf.numFmtId) xf.numFmtId = parseInt(xf.numFmtId, 10);\r\n                    if (xf.fillId) xf.fillId = parseInt(xf.fillId, 10);\r\n                    styles.CellXf.push(xf);\r\n                    break;\r\n                case '</xf>':\r\n                    break;\r\n\r\n                /* 18.8.1 alignment CT_CellAlignment */\r\n                case '<alignment':\r\n                case '<alignment/>':\r\n                    var alignment = {}\r\n                    if (y.vertical) { alignment.vertical = y.vertical; }\r\n                    if (y.horizontal) { alignment.horizontal = y.horizontal; }\r\n                    if (y.textRotation != undefined) { alignment.textRotation = y.textRotation; }\r\n                    if (y.indent) { alignment.indent = y.indent; }\r\n                    if (y.wrapText) { alignment.wrapText = y.wrapText; }\r\n                    xf.alignment = alignment;\r\n\r\n                    break;\r\n\r\n                /* 18.8.33 protection CT_CellProtection */\r\n                case '<protection':\r\n                case '</protection>':\r\n                case '<protection/>':\r\n                    break;\r\n\r\n                case '<extLst':\r\n                case '</extLst>':\r\n                    break;\r\n                case '<ext':\r\n                    break;\r\n                default:\r\n                    if (opts.WTF) throw 'unrecognized ' + y[0] + ' in cellXfs';\r\n            }\r\n        });\r\n    }\r\n\r\n    function write_cellXfs(cellXfs) {\r\n        var o = [];\r\n        o[o.length] = (writextag('cellXfs', null));\r\n        cellXfs.forEach(function (c) {\r\n            o[o.length] = (writextag('xf', null, c));\r\n        });\r\n        o[o.length] = (\"</cellXfs>\");\r\n        if (o.length === 2) return \"\";\r\n        o[0] = writextag('cellXfs', null, { count: o.length - 2 }).replace(\"/>\", \">\");\r\n        return o.join(\"\");\r\n    }\r\n\r\n    /* 18.8 Styles CT_Stylesheet*/\r\n    var parse_sty_xml = (function make_pstyx() {\r\n        var numFmtRegex = /<numFmts([^>]*)>.*<\\/numFmts>/;\r\n        var cellXfRegex = /<cellXfs([^>]*)>.*<\\/cellXfs>/;\r\n        var fillsRegex = /<fills([^>]*)>.*<\\/fills>/;\r\n        var bordersRegex = /<borders([^>]*)>.*<\\/borders>/;\r\n\r\n        return function parse_sty_xml(data, opts) {\r\n            /* 18.8.39 styleSheet CT_Stylesheet */\r\n            var t;\r\n\r\n            /* numFmts CT_NumFmts ? */\r\n            if ((t = data.match(numFmtRegex))) parse_numFmts(t, opts);\r\n\r\n            /* fonts CT_Fonts ? */\r\n            if ((t = data.match(/<fonts([^>]*)>.*<\\/fonts>/))) parse_fonts(t, opts)\r\n\r\n            /* fills CT_Fills */\r\n            if ((t = data.match(fillsRegex))) parse_fills(t, opts);\r\n\r\n            /* borders CT_Borders ? */\r\n            if ((t = data.match(bordersRegex))) parse_borders(t, opts);\r\n            /* cellStyleXfs CT_CellStyleXfs ? */\r\n\r\n            /* cellXfs CT_CellXfs ? */\r\n            if ((t = data.match(cellXfRegex))) parse_cellXfs(t, opts);\r\n\r\n            /* dxfs CT_Dxfs ? */\r\n            /* tableStyles CT_TableStyles ? */\r\n            /* colors CT_Colors ? */\r\n            /* extLst CT_ExtensionList ? */\r\n\r\n            return styles;\r\n        };\r\n    })();\r\n\r\n    var STYLES_XML_ROOT = writextag('styleSheet', null, {\r\n        'xmlns': XMLNS.main[0],\r\n        'xmlns:vt': XMLNS.vt\r\n    });\r\n\r\n    RELS.STY = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\";\r\n\r\n    function write_sty_xml(wb, opts) {\r\n\r\n        if (typeof style_builder != 'undefined' && typeof 'require' != 'undefined') {\r\n            return style_builder.toXml();\r\n        }\r\n\r\n        var o = [XML_HEADER, STYLES_XML_ROOT], w;\r\n        if ((w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\r\n        o[o.length] = ('<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>');\r\n        o[o.length] = ('<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>');\r\n        o[o.length] = ('<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>');\r\n        o[o.length] = ('<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>');\r\n        if ((w = write_cellXfs(opts.cellXfs))) o[o.length] = (w);\r\n        o[o.length] = ('<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>');\r\n        o[o.length] = ('<dxfs count=\"0\"/>');\r\n        o[o.length] = ('<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>');\r\n\r\n        if (o.length > 2) {\r\n            o[o.length] = ('</styleSheet>');\r\n            o[1] = o[1].replace(\"/>\", \">\");\r\n        }\r\n        return o.join(\"\");\r\n    }\r\n    /* [MS-XLSB] 2.4.651 BrtFmt */\r\n    function parse_BrtFmt(data, length) {\r\n        var ifmt = data.read_shift(2);\r\n        var stFmtCode = parse_XLWideString(data, length - 2);\r\n        return [ifmt, stFmtCode];\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.653 BrtFont TODO */\r\n    function parse_BrtFont(data, length) {\r\n        var out = { flags: {} };\r\n        out.dyHeight = data.read_shift(2);\r\n        out.grbit = parse_FontFlags(data, 2);\r\n        out.bls = data.read_shift(2);\r\n        out.sss = data.read_shift(2);\r\n        out.uls = data.read_shift(1);\r\n        out.bFamily = data.read_shift(1);\r\n        out.bCharSet = data.read_shift(1);\r\n        data.l++;\r\n        out.brtColor = parse_BrtColor(data, 8);\r\n        out.bFontScheme = data.read_shift(1);\r\n        out.name = parse_XLWideString(data, length - 21);\r\n\r\n        out.flags.Bold = out.bls === 0x02BC;\r\n        out.flags.Italic = out.grbit.fItalic;\r\n        out.flags.Strikeout = out.grbit.fStrikeout;\r\n        out.flags.Outline = out.grbit.fOutline;\r\n        out.flags.Shadow = out.grbit.fShadow;\r\n        out.flags.Condense = out.grbit.fCondense;\r\n        out.flags.Extend = out.grbit.fExtend;\r\n        out.flags.Sub = out.sss & 0x2;\r\n        out.flags.Sup = out.sss & 0x1;\r\n        return out;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.816 BrtXF */\r\n    function parse_BrtXF(data, length) {\r\n        var ixfeParent = data.read_shift(2);\r\n        var ifmt = data.read_shift(2);\r\n        parsenoop(data, length - 4);\r\n        return { ixfe: ixfeParent, ifmt: ifmt };\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.7.50 Styles */\r\n    function parse_sty_bin(data, opts) {\r\n        styles.NumberFmt = [];\r\n        for (var y in SSF._table) styles.NumberFmt[y] = SSF._table[y];\r\n\r\n        styles.CellXf = [];\r\n        var state = \"\"; /* TODO: this should be a stack */\r\n        var pass = false;\r\n        recordhopper(data, function hopper_sty(val, R, RT) {\r\n            switch (R.n) {\r\n                case 'BrtFmt':\r\n                    styles.NumberFmt[val[0]] = val[1]; SSF.load(val[1], val[0]);\r\n                    break;\r\n                case 'BrtFont': break; /* TODO */\r\n                case 'BrtKnownFonts': break; /* TODO */\r\n                case 'BrtFill': break; /* TODO */\r\n                case 'BrtBorder': break; /* TODO */\r\n                case 'BrtXF':\r\n                    if (state === \"CELLXFS\") {\r\n                        styles.CellXf.push(val);\r\n                    }\r\n                    break; /* TODO */\r\n                case 'BrtStyle': break; /* TODO */\r\n                case 'BrtDXF': break; /* TODO */\r\n                case 'BrtMRUColor': break; /* TODO */\r\n                case 'BrtIndexedColor': break; /* TODO */\r\n                case 'BrtBeginStyleSheet': break;\r\n                case 'BrtEndStyleSheet': break;\r\n                case 'BrtBeginTableStyle': break;\r\n                case 'BrtTableStyleElement': break;\r\n                case 'BrtEndTableStyle': break;\r\n                case 'BrtBeginFmts': state = \"FMTS\"; break;\r\n                case 'BrtEndFmts': state = \"\"; break;\r\n                case 'BrtBeginFonts': state = \"FONTS\"; break;\r\n                case 'BrtEndFonts': state = \"\"; break;\r\n                case 'BrtACBegin': state = \"ACFONTS\"; break;\r\n                case 'BrtACEnd': state = \"\"; break;\r\n                case 'BrtBeginFills': state = \"FILLS\"; break;\r\n                case 'BrtEndFills': state = \"\"; break;\r\n                case 'BrtBeginBorders': state = \"BORDERS\"; break;\r\n                case 'BrtEndBorders': state = \"\"; break;\r\n                case 'BrtBeginCellStyleXFs': state = \"CELLSTYLEXFS\"; break;\r\n                case 'BrtEndCellStyleXFs': state = \"\"; break;\r\n                case 'BrtBeginCellXFs': state = \"CELLXFS\"; break;\r\n                case 'BrtEndCellXFs': state = \"\"; break;\r\n                case 'BrtBeginStyles': state = \"STYLES\"; break;\r\n                case 'BrtEndStyles': state = \"\"; break;\r\n                case 'BrtBeginDXFs': state = \"DXFS\"; break;\r\n                case 'BrtEndDXFs': state = \"\"; break;\r\n                case 'BrtBeginTableStyles': state = \"TABLESTYLES\"; break;\r\n                case 'BrtEndTableStyles': state = \"\"; break;\r\n                case 'BrtBeginColorPalette': state = \"COLORPALETTE\"; break;\r\n                case 'BrtEndColorPalette': state = \"\"; break;\r\n                case 'BrtBeginIndexedColors': state = \"INDEXEDCOLORS\"; break;\r\n                case 'BrtEndIndexedColors': state = \"\"; break;\r\n                case 'BrtBeginMRUColors': state = \"MRUCOLORS\"; break;\r\n                case 'BrtEndMRUColors': state = \"\"; break;\r\n                case 'BrtFRTBegin': pass = true; break;\r\n                case 'BrtFRTEnd': pass = false; break;\r\n                case 'BrtBeginStyleSheetExt14': break;\r\n                case 'BrtBeginSlicerStyles': break;\r\n                case 'BrtEndSlicerStyles': break;\r\n                case 'BrtBeginTimelineStylesheetExt15': break;\r\n                case 'BrtEndTimelineStylesheetExt15': break;\r\n                case 'BrtBeginTimelineStyles': break;\r\n                case 'BrtEndTimelineStyles': break;\r\n                case 'BrtEndStyleSheetExt14': break;\r\n                default: if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\r\n            }\r\n        });\r\n        return styles;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.7.50 Styles */\r\n    function write_sty_bin(data, opts) {\r\n        var ba = buf_array();\r\n        write_record(ba, \"BrtBeginStyleSheet\");\r\n        /* [FMTS] */\r\n        /* [FONTS] */\r\n        /* [FILLS] */\r\n        /* [BORDERS] */\r\n        /* CELLSTYLEXFS */\r\n        /* CELLXFS*/\r\n        /* STYLES */\r\n        /* DXFS */\r\n        /* TABLESTYLES */\r\n        /* [COLORPALETTE] */\r\n        /* FRTSTYLESHEET*/\r\n        write_record(ba, \"BrtEndStyleSheet\");\r\n        return ba.end();\r\n    }\r\n    RELS.THEME = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\";\r\n\r\n    /* 20.1.6.2 clrScheme CT_ColorScheme */\r\n    function parse_clrScheme(t, opts) {\r\n        themes.themeElements.clrScheme = [];\r\n        var color = {};\r\n        t[0].match(tagregex).forEach(function (x) {\r\n            var y = parsexmltag(x);\r\n            switch (y[0]) {\r\n                case '<a:clrScheme': case '</a:clrScheme>': break;\r\n\r\n                /* 20.1.2.3.32 srgbClr CT_SRgbColor */\r\n                case '<a:srgbClr': color.rgb = y.val; break;\r\n\r\n                /* 20.1.2.3.33 sysClr CT_SystemColor */\r\n                case '<a:sysClr': color.rgb = y.lastClr; break;\r\n\r\n                /* 20.1.4.1.9 dk1 (Dark 1) */\r\n                case '<a:dk1>':\r\n                case '</a:dk1>':\r\n                /* 20.1.4.1.10 dk2 (Dark 2) */\r\n                case '<a:dk2>':\r\n                case '</a:dk2>':\r\n                /* 20.1.4.1.22 lt1 (Light 1) */\r\n                case '<a:lt1>':\r\n                case '</a:lt1>':\r\n                /* 20.1.4.1.23 lt2 (Light 2) */\r\n                case '<a:lt2>':\r\n                case '</a:lt2>':\r\n                /* 20.1.4.1.1 accent1 (Accent 1) */\r\n                case '<a:accent1>':\r\n                case '</a:accent1>':\r\n                /* 20.1.4.1.2 accent2 (Accent 2) */\r\n                case '<a:accent2>':\r\n                case '</a:accent2>':\r\n                /* 20.1.4.1.3 accent3 (Accent 3) */\r\n                case '<a:accent3>':\r\n                case '</a:accent3>':\r\n                /* 20.1.4.1.4 accent4 (Accent 4) */\r\n                case '<a:accent4>':\r\n                case '</a:accent4>':\r\n                /* 20.1.4.1.5 accent5 (Accent 5) */\r\n                case '<a:accent5>':\r\n                case '</a:accent5>':\r\n                /* 20.1.4.1.6 accent6 (Accent 6) */\r\n                case '<a:accent6>':\r\n                case '</a:accent6>':\r\n                /* 20.1.4.1.19 hlink (Hyperlink) */\r\n                case '<a:hlink>':\r\n                case '</a:hlink>':\r\n                /* 20.1.4.1.15 folHlink (Followed Hyperlink) */\r\n                case '<a:folHlink>':\r\n                case '</a:folHlink>':\r\n                    if (y[0][1] === '/') {\r\n                        themes.themeElements.clrScheme.push(color);\r\n                        color = {};\r\n                    } else {\r\n                        color.name = y[0].substring(3, y[0].length - 1);\r\n                    }\r\n                    break;\r\n\r\n                default: if (opts.WTF) throw 'unrecognized ' + y[0] + ' in clrScheme';\r\n            }\r\n        });\r\n    }\r\n\r\n    /* 20.1.4.1.18 fontScheme CT_FontScheme */\r\n    function parse_fontScheme(t, opts) { }\r\n\r\n    /* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\r\n    function parse_fmtScheme(t, opts) { }\r\n\r\n    var clrsregex = /<a:clrScheme([^>]*)>[^\\u2603]*<\\/a:clrScheme>/;\r\n    var fntsregex = /<a:fontScheme([^>]*)>[^\\u2603]*<\\/a:fontScheme>/;\r\n    var fmtsregex = /<a:fmtScheme([^>]*)>[^\\u2603]*<\\/a:fmtScheme>/;\r\n\r\n    /* 20.1.6.10 themeElements CT_BaseStyles */\r\n    function parse_themeElements(data, opts) {\r\n        themes.themeElements = {};\r\n\r\n        var t;\r\n\r\n        [\r\n            /* clrScheme CT_ColorScheme */\r\n            ['clrScheme', clrsregex, parse_clrScheme],\r\n            /* fontScheme CT_FontScheme */\r\n            ['fontScheme', fntsregex, parse_fontScheme],\r\n            /* fmtScheme CT_StyleMatrix */\r\n            ['fmtScheme', fmtsregex, parse_fmtScheme]\r\n        ].forEach(function (m) {\r\n            if (!(t = data.match(m[1]))) throw m[0] + ' not found in themeElements';\r\n            m[2](t, opts);\r\n        });\r\n    }\r\n\r\n    var themeltregex = /<a:themeElements([^>]*)>[^\\u2603]*<\\/a:themeElements>/;\r\n\r\n    /* 14.2.7 Theme Part */\r\n    function parse_theme_xml(data, opts) {\r\n        /* 20.1.6.9 theme CT_OfficeStyleSheet */\r\n        if (!data || data.length === 0) return themes;\r\n\r\n        var t;\r\n\r\n        /* themeElements CT_BaseStyles */\r\n        if (!(t = data.match(themeltregex))) throw 'themeElements not found in theme';\r\n        parse_themeElements(t[0], opts);\r\n\r\n        return themes;\r\n    }\r\n\r\n    //function write_theme() { return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>'; }\r\n    function write_theme(opts) {\r\n        if (opts.themeXml) { return opts.themeXml; }\r\n        return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>';\r\n    }/* [MS-XLS] 2.4.326 TODO: payload is a zip file */\r\n    function parse_Theme(blob, length) {\r\n        var dwThemeVersion = blob.read_shift(4);\r\n        if (dwThemeVersion === 124226) return;\r\n        blob.l += length - 4;\r\n    }\r\n\r\n    /* 2.5.49 */\r\n    function parse_ColorTheme(blob, length) { return blob.read_shift(4); }\r\n\r\n    /* 2.5.155 */\r\n    function parse_FullColorExt(blob, length) {\r\n        var o = {};\r\n        o.xclrType = blob.read_shift(2);\r\n        o.nTintShade = blob.read_shift(2);\r\n        switch (o.xclrType) {\r\n            case 0: blob.l += 4; break;\r\n            case 1: o.xclrValue = parse_IcvXF(blob, 4); break;\r\n            case 2: o.xclrValue = parse_LongRGBA(blob, 4); break;\r\n            case 3: o.xclrValue = parse_ColorTheme(blob, 4); break;\r\n            case 4: blob.l += 4; break;\r\n        }\r\n        blob.l += 8;\r\n        return o;\r\n    }\r\n\r\n    /* 2.5.164 TODO: read 7 bits*/\r\n    function parse_IcvXF(blob, length) {\r\n        return parsenoop(blob, length);\r\n    }\r\n\r\n    /* 2.5.280 */\r\n    function parse_XFExtGradient(blob, length) {\r\n        return parsenoop(blob, length);\r\n    }\r\n\r\n    /* 2.5.108 */\r\n    function parse_ExtProp(blob, length) {\r\n        var extType = blob.read_shift(2);\r\n        var cb = blob.read_shift(2);\r\n        var o = [extType];\r\n        switch (extType) {\r\n            case 0x04: case 0x05: case 0x07: case 0x08:\r\n            case 0x09: case 0x0A: case 0x0B: case 0x0D:\r\n                o[1] = parse_FullColorExt(blob, cb); break;\r\n            case 0x06: o[1] = parse_XFExtGradient(blob, cb); break;\r\n            case 0x0E: case 0x0F: o[1] = blob.read_shift(cb === 5 ? 1 : 2); break;\r\n            default: throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\r\n        }\r\n        return o;\r\n    }\r\n\r\n    /* 2.4.355 */\r\n    function parse_XFExt(blob, length) {\r\n        var end = blob.l + length;\r\n        blob.l += 2;\r\n        var ixfe = blob.read_shift(2);\r\n        blob.l += 2;\r\n        var cexts = blob.read_shift(2);\r\n        var ext = [];\r\n        while (cexts-- > 0) ext.push(parse_ExtProp(blob, end - blob.l));\r\n        return { ixfe: ixfe, ext: ext };\r\n    }\r\n\r\n    /* xf is an XF, see parse_XFExt for xfext */\r\n    function update_xfext(xf, xfext) {\r\n        xfext.forEach(function (xfe) {\r\n            switch (xfe[0]) { /* 2.5.108 extPropData */\r\n                case 0x04: break; /* foreground color */\r\n                case 0x05: break; /* background color */\r\n                case 0x07: case 0x08: case 0x09: case 0x0a: break;\r\n                case 0x0d: break; /* text color */\r\n                case 0x0e: break; /* font scheme */\r\n                default: throw \"bafuq\" + xfe[0].toString(16);\r\n            }\r\n        });\r\n    }\r\n\r\n    /* 18.6 Calculation Chain */\r\n    function parse_cc_xml(data, opts) {\r\n        var d = [];\r\n        var l = 0, i = 1;\r\n        (data.match(tagregex) || []).forEach(function (x) {\r\n            var y = parsexmltag(x);\r\n            switch (y[0]) {\r\n                case '<?xml': break;\r\n                /* 18.6.2  calcChain CT_CalcChain 1 */\r\n                case '<calcChain': case '<calcChain>': case '</calcChain>': break;\r\n                /* 18.6.1  c CT_CalcCell 1 */\r\n                case '<c': delete y[0]; if (y.i) i = y.i; else y.i = i; d.push(y); break;\r\n            }\r\n        });\r\n        return d;\r\n    }\r\n\r\n    function write_cc_xml(data, opts) { }\r\n    /* [MS-XLSB] 2.6.4.1 */\r\n    function parse_BrtCalcChainItem$(data, length) {\r\n        var out = {};\r\n        out.i = data.read_shift(4);\r\n        var cell = {};\r\n        cell.r = data.read_shift(4);\r\n        cell.c = data.read_shift(4);\r\n        out.r = encode_cell(cell);\r\n        var flags = data.read_shift(1);\r\n        if (flags & 0x2) out.l = '1';\r\n        if (flags & 0x8) out.a = '1';\r\n        return out;\r\n    }\r\n\r\n    /* 18.6 Calculation Chain */\r\n    function parse_cc_bin(data, opts) {\r\n        var out = [];\r\n        var pass = false;\r\n        recordhopper(data, function hopper_cc(val, R, RT) {\r\n            switch (R.n) {\r\n                case 'BrtCalcChainItem$': out.push(val); break;\r\n                case 'BrtBeginCalcChain$': break;\r\n                case 'BrtEndCalcChain$': break;\r\n                default: if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\r\n            }\r\n        });\r\n        return out;\r\n    }\r\n\r\n    function write_cc_bin(data, opts) { }\r\n\r\n    function parse_comments(zip, dirComments, sheets, sheetRels, opts) {\r\n        for (var i = 0; i != dirComments.length; ++i) {\r\n            var canonicalpath = dirComments[i];\r\n            var comments = parse_cmnt(getzipdata(zip, canonicalpath.replace(/^\\//, ''), true), canonicalpath, opts);\r\n            if (!comments || !comments.length) continue;\r\n            // find the sheets targeted by these comments\r\n            var sheetNames = keys(sheets);\r\n            for (var j = 0; j != sheetNames.length; ++j) {\r\n                var sheetName = sheetNames[j];\r\n                var rels = sheetRels[sheetName];\r\n                if (rels) {\r\n                    var rel = rels[canonicalpath];\r\n                    if (rel) insertCommentsIntoSheet(sheetName, sheets[sheetName], comments);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function insertCommentsIntoSheet(sheetName, sheet, comments) {\r\n        comments.forEach(function (comment) {\r\n            var cell = sheet[comment.ref];\r\n            if (!cell) {\r\n                cell = {};\r\n                sheet[comment.ref] = cell;\r\n                var range = safe_decode_range(sheet[\"!ref\"] || \"BDWGO1000001:A1\");\r\n                var thisCell = decode_cell(comment.ref);\r\n                if (range.s.r > thisCell.r) range.s.r = thisCell.r;\r\n                if (range.e.r < thisCell.r) range.e.r = thisCell.r;\r\n                if (range.s.c > thisCell.c) range.s.c = thisCell.c;\r\n                if (range.e.c < thisCell.c) range.e.c = thisCell.c;\r\n                var encoded = encode_range(range);\r\n                if (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\r\n            }\r\n\r\n            if (!cell.c) cell.c = [];\r\n            var o = { a: comment.author, t: comment.t, r: comment.r };\r\n            if (comment.h) o.h = comment.h;\r\n            cell.c.push(o);\r\n        });\r\n    }\r\n\r\n    /* 18.7.3 CT_Comment */\r\n    function parse_comments_xml(data, opts) {\r\n        if (data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\r\n        var authors = [];\r\n        var commentList = [];\r\n        data.match(/<(?:\\w+:)?authors>([^\\u2603]*)<\\/(?:\\w+:)?authors>/)[1].split(/<\\/\\w*:?author>/).forEach(function (x) {\r\n            if (x === \"\" || x.trim() === \"\") return;\r\n            authors.push(x.match(/<(?:\\w+:)?author[^>]*>(.*)/)[1]);\r\n        });\r\n        (data.match(/<(?:\\w+:)?commentList>([^\\u2603]*)<\\/(?:\\w+:)?commentList>/) || [\"\", \"\"])[1].split(/<\\/\\w*:?comment>/).forEach(function (x, index) {\r\n            if (x === \"\" || x.trim() === \"\") return;\r\n            var y = parsexmltag(x.match(/<(?:\\w+:)?comment[^>]*>/)[0]);\r\n            var comment = { author: y.authorId && authors[y.authorId] ? authors[y.authorId] : undefined, ref: y.ref, guid: y.guid };\r\n            var cell = decode_cell(y.ref);\r\n            if (opts.sheetRows && opts.sheetRows <= cell.r) return;\r\n            var textMatch = x.match(/<text>([^\\u2603]*)<\\/text>/);\r\n            if (!textMatch || !textMatch[1]) return; // a comment may contain an empty text tag.\r\n            var rt = parse_si(textMatch[1]);\r\n            comment.r = rt.r;\r\n            comment.t = rt.t;\r\n            if (opts.cellHTML) comment.h = rt.h;\r\n            commentList.push(comment);\r\n        });\r\n        return commentList;\r\n    }\r\n\r\n    function write_comments_xml(data, opts) { }\r\n    /* [MS-XLSB] 2.4.28 BrtBeginComment */\r\n    function parse_BrtBeginComment(data, length) {\r\n        var out = {};\r\n        out.iauthor = data.read_shift(4);\r\n        var rfx = parse_UncheckedRfX(data, 16);\r\n        out.rfx = rfx.s;\r\n        out.ref = encode_cell(rfx.s);\r\n        data.l += 16; /*var guid = parse_GUID(data); */\r\n        return out;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.324 BrtCommentAuthor */\r\n    var parse_BrtCommentAuthor = parse_XLWideString;\r\n\r\n    /* [MS-XLSB] 2.4.325 BrtCommentText */\r\n    var parse_BrtCommentText = parse_RichStr;\r\n\r\n    /* [MS-XLSB] 2.1.7.8 Comments */\r\n    function parse_comments_bin(data, opts) {\r\n        var out = [];\r\n        var authors = [];\r\n        var c = {};\r\n        var pass = false;\r\n        recordhopper(data, function hopper_cmnt(val, R, RT) {\r\n            switch (R.n) {\r\n                case 'BrtCommentAuthor': authors.push(val); break;\r\n                case 'BrtBeginComment': c = val; break;\r\n                case 'BrtCommentText': c.t = val.t; c.h = val.h; c.r = val.r; break;\r\n                case 'BrtEndComment':\r\n                    c.author = authors[c.iauthor];\r\n                    delete c.iauthor;\r\n                    if (opts.sheetRows && opts.sheetRows <= c.rfx.r) break;\r\n                    delete c.rfx; out.push(c); break;\r\n                case 'BrtBeginComments': break;\r\n                case 'BrtEndComments': break;\r\n                case 'BrtBeginCommentAuthors': break;\r\n                case 'BrtEndCommentAuthors': break;\r\n                case 'BrtBeginCommentList': break;\r\n                case 'BrtEndCommentList': break;\r\n                default: if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\r\n            }\r\n        });\r\n        return out;\r\n    }\r\n\r\n    function write_comments_bin(data, opts) { }\r\n    /* TODO: it will be useful to parse the function str */\r\n    var rc_to_a1 = (function () {\r\n        var rcregex = /(^|[^A-Za-z])R(\\[?)(-?\\d+|)\\]?C(\\[?)(-?\\d+|)\\]?/g;\r\n        var rcbase;\r\n        function rcfunc($$, $1, $2, $3, $4, $5) {\r\n            var R = $3.length > 0 ? parseInt($3, 10) | 0 : 0, C = $5.length > 0 ? parseInt($5, 10) | 0 : 0;\r\n            if (C < 0 && $4.length === 0) C = 0;\r\n            if ($4.length > 0) C += rcbase.c;\r\n            if ($2.length > 0) R += rcbase.r;\r\n            return $1 + encode_col(C) + encode_row(R);\r\n        }\r\n        return function rc_to_a1(fstr, base) {\r\n            rcbase = base;\r\n            return fstr.replace(rcregex, rcfunc);\r\n        };\r\n    })();\r\n\r\n    /* --- formula references point to MS-XLS --- */\r\n    /* Small helpers */\r\n    function parseread(l) { return function (blob, length) { blob.l += l; return; }; }\r\n    function parseread1(blob, length) { blob.l += 1; return; }\r\n\r\n    /* Rgce Helpers */\r\n\r\n    /* 2.5.51 */\r\n    function parse_ColRelU(blob, length) {\r\n        var c = blob.read_shift(2);\r\n        return [c & 0x3FFF, (c >> 14) & 1, (c >> 15) & 1];\r\n    }\r\n\r\n    /* 2.5.198.105 */\r\n    function parse_RgceArea(blob, length) {\r\n        var r = blob.read_shift(2), R = blob.read_shift(2);\r\n        var c = parse_ColRelU(blob, 2);\r\n        var C = parse_ColRelU(blob, 2);\r\n        return { s: { r: r, c: c[0], cRel: c[1], rRel: c[2] }, e: { r: R, c: C[0], cRel: C[1], rRel: C[2] } };\r\n    }\r\n\r\n    /* 2.5.198.105 TODO */\r\n    function parse_RgceAreaRel(blob, length) {\r\n        var r = blob.read_shift(2), R = blob.read_shift(2);\r\n        var c = parse_ColRelU(blob, 2);\r\n        var C = parse_ColRelU(blob, 2);\r\n        return { s: { r: r, c: c[0], cRel: c[1], rRel: c[2] }, e: { r: R, c: C[0], cRel: C[1], rRel: C[2] } };\r\n    }\r\n\r\n    /* 2.5.198.109 */\r\n    function parse_RgceLoc(blob, length) {\r\n        var r = blob.read_shift(2);\r\n        var c = parse_ColRelU(blob, 2);\r\n        return { r: r, c: c[0], cRel: c[1], rRel: c[2] };\r\n    }\r\n\r\n    /* 2.5.198.111 */\r\n    function parse_RgceLocRel(blob, length) {\r\n        var r = blob.read_shift(2);\r\n        var cl = blob.read_shift(2);\r\n        var cRel = (cl & 0x8000) >> 15, rRel = (cl & 0x4000) >> 14;\r\n        cl &= 0x3FFF;\r\n        if (cRel !== 0) while (cl >= 0x100) cl -= 0x100;\r\n        return { r: r, c: cl, cRel: cRel, rRel: rRel };\r\n    }\r\n\r\n    /* Ptg Tokens */\r\n\r\n    /* 2.5.198.27 */\r\n    function parse_PtgArea(blob, length) {\r\n        var type = (blob[blob.l++] & 0x60) >> 5;\r\n        var area = parse_RgceArea(blob, 8);\r\n        return [type, area];\r\n    }\r\n\r\n    /* 2.5.198.28 */\r\n    function parse_PtgArea3d(blob, length) {\r\n        var type = (blob[blob.l++] & 0x60) >> 5;\r\n        var ixti = blob.read_shift(2);\r\n        var area = parse_RgceArea(blob, 8);\r\n        return [type, ixti, area];\r\n    }\r\n\r\n    /* 2.5.198.29 */\r\n    function parse_PtgAreaErr(blob, length) {\r\n        var type = (blob[blob.l++] & 0x60) >> 5;\r\n        blob.l += 8;\r\n        return [type];\r\n    }\r\n    /* 2.5.198.30 */\r\n    function parse_PtgAreaErr3d(blob, length) {\r\n        var type = (blob[blob.l++] & 0x60) >> 5;\r\n        var ixti = blob.read_shift(2);\r\n        blob.l += 8;\r\n        return [type, ixti];\r\n    }\r\n\r\n    /* 2.5.198.31 */\r\n    function parse_PtgAreaN(blob, length) {\r\n        var type = (blob[blob.l++] & 0x60) >> 5;\r\n        var area = parse_RgceAreaRel(blob, 8);\r\n        return [type, area];\r\n    }\r\n\r\n    /* 2.5.198.32 -- ignore this and look in PtgExtraArray for shape + values */\r\n    function parse_PtgArray(blob, length) {\r\n        var type = (blob[blob.l++] & 0x60) >> 5;\r\n        blob.l += 7;\r\n        return [type];\r\n    }\r\n\r\n    /* 2.5.198.33 */\r\n    function parse_PtgAttrBaxcel(blob, length) {\r\n        var bitSemi = blob[blob.l + 1] & 0x01; /* 1 = volatile */\r\n        var bitBaxcel = 1;\r\n        blob.l += 4;\r\n        return [bitSemi, bitBaxcel];\r\n    }\r\n\r\n    /* 2.5.198.34 */\r\n    function parse_PtgAttrChoose(blob, length) {\r\n        blob.l += 2;\r\n        var offset = blob.read_shift(2);\r\n        var o = [];\r\n        /* offset is 1 less than the number of elements */\r\n        for (var i = 0; i <= offset; ++i) o.push(blob.read_shift(2));\r\n        return o;\r\n    }\r\n\r\n    /* 2.5.198.35 */\r\n    function parse_PtgAttrGoto(blob, length) {\r\n        var bitGoto = (blob[blob.l + 1] & 0xFF) ? 1 : 0;\r\n        blob.l += 2;\r\n        return [bitGoto, blob.read_shift(2)];\r\n    }\r\n\r\n    /* 2.5.198.36 */\r\n    function parse_PtgAttrIf(blob, length) {\r\n        var bitIf = (blob[blob.l + 1] & 0xFF) ? 1 : 0;\r\n        blob.l += 2;\r\n        return [bitIf, blob.read_shift(2)];\r\n    }\r\n\r\n    /* 2.5.198.37 */\r\n    function parse_PtgAttrSemi(blob, length) {\r\n        var bitSemi = (blob[blob.l + 1] & 0xFF) ? 1 : 0;\r\n        blob.l += 4;\r\n        return [bitSemi];\r\n    }\r\n\r\n    /* 2.5.198.40 (used by PtgAttrSpace and PtgAttrSpaceSemi) */\r\n    function parse_PtgAttrSpaceType(blob, length) {\r\n        var type = blob.read_shift(1), cch = blob.read_shift(1);\r\n        return [type, cch];\r\n    }\r\n\r\n    /* 2.5.198.38 */\r\n    function parse_PtgAttrSpace(blob, length) {\r\n        blob.read_shift(2);\r\n        return parse_PtgAttrSpaceType(blob, 2);\r\n    }\r\n\r\n    /* 2.5.198.39 */\r\n    function parse_PtgAttrSpaceSemi(blob, length) {\r\n        blob.read_shift(2);\r\n        return parse_PtgAttrSpaceType(blob, 2);\r\n    }\r\n\r\n    /* 2.5.198.84 TODO */\r\n    function parse_PtgRef(blob, length) {\r\n        var ptg = blob[blob.l] & 0x1F;\r\n        var type = (blob[blob.l] & 0x60) >> 5;\r\n        blob.l += 1;\r\n        var loc = parse_RgceLoc(blob, 4);\r\n        return [type, loc];\r\n    }\r\n\r\n    /* 2.5.198.88 TODO */\r\n    function parse_PtgRefN(blob, length) {\r\n        var ptg = blob[blob.l] & 0x1F;\r\n        var type = (blob[blob.l] & 0x60) >> 5;\r\n        blob.l += 1;\r\n        var loc = parse_RgceLocRel(blob, 4);\r\n        return [type, loc];\r\n    }\r\n\r\n    /* 2.5.198.85 TODO */\r\n    function parse_PtgRef3d(blob, length) {\r\n        var ptg = blob[blob.l] & 0x1F;\r\n        var type = (blob[blob.l] & 0x60) >> 5;\r\n        blob.l += 1;\r\n        var ixti = blob.read_shift(2); // XtiIndex\r\n        var loc = parse_RgceLoc(blob, 4);\r\n        return [type, ixti, loc];\r\n    }\r\n\r\n\r\n    /* 2.5.198.62 TODO */\r\n    function parse_PtgFunc(blob, length) {\r\n        var ptg = blob[blob.l] & 0x1F;\r\n        var type = (blob[blob.l] & 0x60) >> 5;\r\n        blob.l += 1;\r\n        var iftab = blob.read_shift(2);\r\n        return [FtabArgc[iftab], Ftab[iftab]];\r\n    }\r\n    /* 2.5.198.63 TODO */\r\n    function parse_PtgFuncVar(blob, length) {\r\n        blob.l++;\r\n        var cparams = blob.read_shift(1), tab = parsetab(blob);\r\n        return [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\r\n    }\r\n\r\n    function parsetab(blob, length) {\r\n        return [blob[blob.l + 1] >> 7, blob.read_shift(2) & 0x7FFF];\r\n    }\r\n\r\n    /* 2.5.198.41 */\r\n    var parse_PtgAttrSum = parseread(4);\r\n    /* 2.5.198.43 */\r\n    var parse_PtgConcat = parseread1;\r\n\r\n    /* 2.5.198.58 */\r\n    function parse_PtgExp(blob, length) {\r\n        blob.l++;\r\n        var row = blob.read_shift(2);\r\n        var col = blob.read_shift(2);\r\n        return [row, col];\r\n    }\r\n\r\n    /* 2.5.198.57 */\r\n    function parse_PtgErr(blob, length) { blob.l++; return BErr[blob.read_shift(1)]; }\r\n\r\n    /* 2.5.198.66 TODO */\r\n    function parse_PtgInt(blob, length) { blob.l++; return blob.read_shift(2); }\r\n\r\n    /* 2.5.198.42 */\r\n    function parse_PtgBool(blob, length) { blob.l++; return blob.read_shift(1) !== 0; }\r\n\r\n    /* 2.5.198.79 */\r\n    function parse_PtgNum(blob, length) { blob.l++; return parse_Xnum(blob, 8); }\r\n\r\n    /* 2.5.198.89 */\r\n    function parse_PtgStr(blob, length) { blob.l++; return parse_ShortXLUnicodeString(blob); }\r\n\r\n    /* 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\r\n    function parse_SerAr(blob) {\r\n        var val = [];\r\n        switch ((val[0] = blob.read_shift(1))) {\r\n            /* 2.5.192.113 */\r\n            case 0x04: /* SerBool -- boolean */\r\n                val[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\r\n                blob.l += 7; break;\r\n            /* 2.5.192.114 */\r\n            case 0x10: /* SerErr -- error */\r\n                val[1] = BErr[blob[blob.l]];\r\n                blob.l += 8; break;\r\n            /* 2.5.192.115 */\r\n            case 0x00: /* SerNil -- honestly, I'm not sure how to reproduce this */\r\n                blob.l += 8; break;\r\n            /* 2.5.192.116 */\r\n            case 0x01: /* SerNum -- Xnum */\r\n                val[1] = parse_Xnum(blob, 8); break;\r\n            /* 2.5.192.117 */\r\n            case 0x02: /* SerStr -- XLUnicodeString (<256 chars) */\r\n                val[1] = parse_XLUnicodeString(blob); break;\r\n            // default: throw \"Bad SerAr: \" + val[0]; /* Unreachable */\r\n        }\r\n        return val;\r\n    }\r\n\r\n    /* 2.5.198.61 */\r\n    function parse_PtgExtraMem(blob, cce) {\r\n        var count = blob.read_shift(2);\r\n        var out = [];\r\n        for (var i = 0; i != count; ++i) out.push(parse_Ref8U(blob, 8));\r\n        return out;\r\n    }\r\n\r\n    /* 2.5.198.59 */\r\n    function parse_PtgExtraArray(blob) {\r\n        var cols = 1 + blob.read_shift(1); //DColByteU\r\n        var rows = 1 + blob.read_shift(2); //DRw\r\n        for (var i = 0, o = []; i != rows && (o[i] = []); ++i)\r\n            for (var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob);\r\n        return o;\r\n    }\r\n\r\n    /* 2.5.198.76 */\r\n    function parse_PtgName(blob, length) {\r\n        var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n        var nameindex = blob.read_shift(4);\r\n        return [type, 0, nameindex];\r\n    }\r\n\r\n    /* 2.5.198.77 */\r\n    function parse_PtgNameX(blob, length) {\r\n        var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n        var ixti = blob.read_shift(2); // XtiIndex\r\n        var nameindex = blob.read_shift(4);\r\n        return [type, ixti, nameindex];\r\n    }\r\n\r\n    /* 2.5.198.70 */\r\n    function parse_PtgMemArea(blob, length) {\r\n        var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n        blob.l += 4;\r\n        var cce = blob.read_shift(2);\r\n        return [type, cce];\r\n    }\r\n\r\n    /* 2.5.198.72 */\r\n    function parse_PtgMemFunc(blob, length) {\r\n        var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n        var cce = blob.read_shift(2);\r\n        return [type, cce];\r\n    }\r\n\r\n\r\n    /* 2.5.198.86 */\r\n    function parse_PtgRefErr(blob, length) {\r\n        var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n        blob.l += 4;\r\n        return [type];\r\n    }\r\n\r\n    /* 2.5.198.26 */\r\n    var parse_PtgAdd = parseread1;\r\n    /* 2.5.198.45 */\r\n    var parse_PtgDiv = parseread1;\r\n    /* 2.5.198.56 */\r\n    var parse_PtgEq = parseread1;\r\n    /* 2.5.198.64 */\r\n    var parse_PtgGe = parseread1;\r\n    /* 2.5.198.65 */\r\n    var parse_PtgGt = parseread1;\r\n    /* 2.5.198.67 */\r\n    var parse_PtgIsect = parseread1;\r\n    /* 2.5.198.68 */\r\n    var parse_PtgLe = parseread1;\r\n    /* 2.5.198.69 */\r\n    var parse_PtgLt = parseread1;\r\n    /* 2.5.198.74 */\r\n    var parse_PtgMissArg = parseread1;\r\n    /* 2.5.198.75 */\r\n    var parse_PtgMul = parseread1;\r\n    /* 2.5.198.78 */\r\n    var parse_PtgNe = parseread1;\r\n    /* 2.5.198.80 */\r\n    var parse_PtgParen = parseread1;\r\n    /* 2.5.198.81 */\r\n    var parse_PtgPercent = parseread1;\r\n    /* 2.5.198.82 */\r\n    var parse_PtgPower = parseread1;\r\n    /* 2.5.198.83 */\r\n    var parse_PtgRange = parseread1;\r\n    /* 2.5.198.90 */\r\n    var parse_PtgSub = parseread1;\r\n    /* 2.5.198.93 */\r\n    var parse_PtgUminus = parseread1;\r\n    /* 2.5.198.94 */\r\n    var parse_PtgUnion = parseread1;\r\n    /* 2.5.198.95 */\r\n    var parse_PtgUplus = parseread1;\r\n\r\n    /* 2.5.198.71 */\r\n    var parse_PtgMemErr = parsenoop;\r\n    /* 2.5.198.73 */\r\n    var parse_PtgMemNoMem = parsenoop;\r\n    /* 2.5.198.87 */\r\n    var parse_PtgRefErr3d = parsenoop;\r\n    /* 2.5.198.92 */\r\n    var parse_PtgTbl = parsenoop;\r\n\r\n    /* 2.5.198.25 */\r\n    var PtgTypes = {\r\n        0x01: { n: 'PtgExp', f: parse_PtgExp },\r\n        0x02: { n: 'PtgTbl', f: parse_PtgTbl },\r\n        0x03: { n: 'PtgAdd', f: parse_PtgAdd },\r\n        0x04: { n: 'PtgSub', f: parse_PtgSub },\r\n        0x05: { n: 'PtgMul', f: parse_PtgMul },\r\n        0x06: { n: 'PtgDiv', f: parse_PtgDiv },\r\n        0x07: { n: 'PtgPower', f: parse_PtgPower },\r\n        0x08: { n: 'PtgConcat', f: parse_PtgConcat },\r\n        0x09: { n: 'PtgLt', f: parse_PtgLt },\r\n        0x0A: { n: 'PtgLe', f: parse_PtgLe },\r\n        0x0B: { n: 'PtgEq', f: parse_PtgEq },\r\n        0x0C: { n: 'PtgGe', f: parse_PtgGe },\r\n        0x0D: { n: 'PtgGt', f: parse_PtgGt },\r\n        0x0E: { n: 'PtgNe', f: parse_PtgNe },\r\n        0x0F: { n: 'PtgIsect', f: parse_PtgIsect },\r\n        0x10: { n: 'PtgUnion', f: parse_PtgUnion },\r\n        0x11: { n: 'PtgRange', f: parse_PtgRange },\r\n        0x12: { n: 'PtgUplus', f: parse_PtgUplus },\r\n        0x13: { n: 'PtgUminus', f: parse_PtgUminus },\r\n        0x14: { n: 'PtgPercent', f: parse_PtgPercent },\r\n        0x15: { n: 'PtgParen', f: parse_PtgParen },\r\n        0x16: { n: 'PtgMissArg', f: parse_PtgMissArg },\r\n        0x17: { n: 'PtgStr', f: parse_PtgStr },\r\n        0x1C: { n: 'PtgErr', f: parse_PtgErr },\r\n        0x1D: { n: 'PtgBool', f: parse_PtgBool },\r\n        0x1E: { n: 'PtgInt', f: parse_PtgInt },\r\n        0x1F: { n: 'PtgNum', f: parse_PtgNum },\r\n        0x20: { n: 'PtgArray', f: parse_PtgArray },\r\n        0x21: { n: 'PtgFunc', f: parse_PtgFunc },\r\n        0x22: { n: 'PtgFuncVar', f: parse_PtgFuncVar },\r\n        0x23: { n: 'PtgName', f: parse_PtgName },\r\n        0x24: { n: 'PtgRef', f: parse_PtgRef },\r\n        0x25: { n: 'PtgArea', f: parse_PtgArea },\r\n        0x26: { n: 'PtgMemArea', f: parse_PtgMemArea },\r\n        0x27: { n: 'PtgMemErr', f: parse_PtgMemErr },\r\n        0x28: { n: 'PtgMemNoMem', f: parse_PtgMemNoMem },\r\n        0x29: { n: 'PtgMemFunc', f: parse_PtgMemFunc },\r\n        0x2A: { n: 'PtgRefErr', f: parse_PtgRefErr },\r\n        0x2B: { n: 'PtgAreaErr', f: parse_PtgAreaErr },\r\n        0x2C: { n: 'PtgRefN', f: parse_PtgRefN },\r\n        0x2D: { n: 'PtgAreaN', f: parse_PtgAreaN },\r\n        0x39: { n: 'PtgNameX', f: parse_PtgNameX },\r\n        0x3A: { n: 'PtgRef3d', f: parse_PtgRef3d },\r\n        0x3B: { n: 'PtgArea3d', f: parse_PtgArea3d },\r\n        0x3C: { n: 'PtgRefErr3d', f: parse_PtgRefErr3d },\r\n        0x3D: { n: 'PtgAreaErr3d', f: parse_PtgAreaErr3d },\r\n        0xFF: {}\r\n    };\r\n    /* These are duplicated in the PtgTypes table */\r\n    var PtgDupes = {\r\n        0x40: 0x20, 0x60: 0x20,\r\n        0x41: 0x21, 0x61: 0x21,\r\n        0x42: 0x22, 0x62: 0x22,\r\n        0x43: 0x23, 0x63: 0x23,\r\n        0x44: 0x24, 0x64: 0x24,\r\n        0x45: 0x25, 0x65: 0x25,\r\n        0x46: 0x26, 0x66: 0x26,\r\n        0x47: 0x27, 0x67: 0x27,\r\n        0x48: 0x28, 0x68: 0x28,\r\n        0x49: 0x29, 0x69: 0x29,\r\n        0x4A: 0x2A, 0x6A: 0x2A,\r\n        0x4B: 0x2B, 0x6B: 0x2B,\r\n        0x4C: 0x2C, 0x6C: 0x2C,\r\n        0x4D: 0x2D, 0x6D: 0x2D,\r\n        0x59: 0x39, 0x79: 0x39,\r\n        0x5A: 0x3A, 0x7A: 0x3A,\r\n        0x5B: 0x3B, 0x7B: 0x3B,\r\n        0x5C: 0x3C, 0x7C: 0x3C,\r\n        0x5D: 0x3D, 0x7D: 0x3D\r\n    };\r\n    (function () { for (var y in PtgDupes) PtgTypes[y] = PtgTypes[PtgDupes[y]]; })();\r\n\r\n    var Ptg18 = {};\r\n    var Ptg19 = {\r\n        0x01: { n: 'PtgAttrSemi', f: parse_PtgAttrSemi },\r\n        0x02: { n: 'PtgAttrIf', f: parse_PtgAttrIf },\r\n        0x04: { n: 'PtgAttrChoose', f: parse_PtgAttrChoose },\r\n        0x08: { n: 'PtgAttrGoto', f: parse_PtgAttrGoto },\r\n        0x10: { n: 'PtgAttrSum', f: parse_PtgAttrSum },\r\n        0x20: { n: 'PtgAttrBaxcel', f: parse_PtgAttrBaxcel },\r\n        0x40: { n: 'PtgAttrSpace', f: parse_PtgAttrSpace },\r\n        0x41: { n: 'PtgAttrSpaceSemi', f: parse_PtgAttrSpaceSemi },\r\n        0xFF: {}\r\n    };\r\n\r\n    /* 2.4.127 TODO */\r\n    function parse_Formula(blob, length, opts) {\r\n        var cell = parse_XLSCell(blob, 6);\r\n        var val = parse_FormulaValue(blob, 8);\r\n        var flags = blob.read_shift(1);\r\n        blob.read_shift(1);\r\n        var chn = blob.read_shift(4);\r\n        var cbf = \"\";\r\n        if (opts.biff === 5) blob.l += length - 20;\r\n        else cbf = parse_XLSCellParsedFormula(blob, length - 20, opts);\r\n        return { cell: cell, val: val[0], formula: cbf, shared: (flags >> 3) & 1, tt: val[1] };\r\n    }\r\n\r\n    /* 2.5.133 TODO: how to emit empty strings? */\r\n    function parse_FormulaValue(blob) {\r\n        var b;\r\n        if (__readUInt16LE(blob, blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob), 'n'];\r\n        switch (blob[blob.l]) {\r\n            case 0x00: blob.l += 8; return [\"String\", 's'];\r\n            case 0x01: b = blob[blob.l + 2] === 0x1; blob.l += 8; return [b, 'b'];\r\n            case 0x02: b = blob[blob.l + 2]; blob.l += 8; return [b, 'e'];\r\n            case 0x03: blob.l += 8; return [\"\", 's'];\r\n        }\r\n    }\r\n\r\n    /* 2.5.198.103 */\r\n    function parse_RgbExtra(blob, length, rgce, opts) {\r\n        if (opts.biff < 8) return parsenoop(blob, length);\r\n        var target = blob.l + length;\r\n        var o = [];\r\n        for (var i = 0; i !== rgce.length; ++i) {\r\n            switch (rgce[i][0]) {\r\n                case 'PtgArray': /* PtgArray -> PtgExtraArray */\r\n                    rgce[i][1] = parse_PtgExtraArray(blob);\r\n                    o.push(rgce[i][1]);\r\n                    break;\r\n                case 'PtgMemArea': /* PtgMemArea -> PtgExtraMem */\r\n                    rgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1]);\r\n                    o.push(rgce[i][2]);\r\n                    break;\r\n                default: break;\r\n            }\r\n        }\r\n        length = target - blob.l;\r\n        if (length !== 0) o.push(parsenoop(blob, length));\r\n        return o;\r\n    }\r\n\r\n    /* 2.5.198.21 */\r\n    function parse_NameParsedFormula(blob, length, opts, cce) {\r\n        var target = blob.l + length;\r\n        var rgce = parse_Rgce(blob, cce);\r\n        var rgcb;\r\n        if (target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\r\n        return [rgce, rgcb];\r\n    }\r\n\r\n    /* 2.5.198.3 TODO */\r\n    function parse_XLSCellParsedFormula(blob, length, opts) {\r\n        var target = blob.l + length;\r\n        var rgcb, cce = blob.read_shift(2); // length of rgce\r\n        if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\r\n        var rgce = parse_Rgce(blob, cce);\r\n        if (length !== cce + 2) rgcb = parse_RgbExtra(blob, length - cce - 2, rgce, opts);\r\n        return [rgce, rgcb];\r\n    }\r\n\r\n    /* 2.5.198.118 TODO */\r\n    function parse_SharedParsedFormula(blob, length, opts) {\r\n        var target = blob.l + length;\r\n        var rgcb, cce = blob.read_shift(2); // length of rgce\r\n        var rgce = parse_Rgce(blob, cce);\r\n        if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\r\n        if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\r\n        return [rgce, rgcb];\r\n    }\r\n\r\n    /* 2.5.198.1 TODO */\r\n    function parse_ArrayParsedFormula(blob, length, opts, ref) {\r\n        var target = blob.l + length;\r\n        var rgcb, cce = blob.read_shift(2); // length of rgce\r\n        if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\r\n        var rgce = parse_Rgce(blob, cce);\r\n        if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\r\n        return [rgce, rgcb];\r\n    }\r\n\r\n    /* 2.5.198.104 */\r\n    function parse_Rgce(blob, length) {\r\n        var target = blob.l + length;\r\n        var R, id, ptgs = [];\r\n        while (target != blob.l) {\r\n            length = target - blob.l;\r\n            id = blob[blob.l];\r\n            R = PtgTypes[id];\r\n            //console.log(\"ptg\", id, R)\r\n            if (id === 0x18 || id === 0x19) {\r\n                id = blob[blob.l + 1];\r\n                R = (id === 0x18 ? Ptg18 : Ptg19)[id];\r\n            }\r\n            if (!R || !R.f) { ptgs.push(parsenoop(blob, length)); }\r\n            else { ptgs.push([R.n, R.f(blob, length)]); }\r\n        }\r\n        return ptgs;\r\n    }\r\n\r\n    function mapper(x) { return x.map(function f2(y) { return y[1]; }).join(\",\"); }\r\n\r\n    /* 2.2.2 + Magic TODO */\r\n    function stringify_formula(formula, range, cell, supbooks, opts) {\r\n        if (opts !== undefined && opts.biff === 5) return \"BIFF5??\";\r\n        var _range = range !== undefined ? range : { s: { c: 0, r: 0 } };\r\n        var stack = [], e1, e2, type, c, ixti, nameidx, r;\r\n        if (!formula[0] || !formula[0][0]) return \"\";\r\n        //console.log(\"--\",cell,formula[0])\r\n        for (var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\r\n            var f = formula[0][ff];\r\n            //console.log(\"++\",f, stack)\r\n            switch (f[0]) {\r\n                /* 2.2.2.1 Unary Operator Tokens */\r\n                /* 2.5.198.93 */\r\n                case 'PtgUminus': stack.push(\"-\" + stack.pop()); break;\r\n                /* 2.5.198.95 */\r\n                case 'PtgUplus': stack.push(\"+\" + stack.pop()); break;\r\n                /* 2.5.198.81 */\r\n                case 'PtgPercent': stack.push(stack.pop() + \"%\"); break;\r\n\r\n                /* 2.2.2.1 Binary Value Operator Token */\r\n                /* 2.5.198.26 */\r\n                case 'PtgAdd':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"+\" + e1);\r\n                    break;\r\n                /* 2.5.198.90 */\r\n                case 'PtgSub':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"-\" + e1);\r\n                    break;\r\n                /* 2.5.198.75 */\r\n                case 'PtgMul':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"*\" + e1);\r\n                    break;\r\n                /* 2.5.198.45 */\r\n                case 'PtgDiv':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"/\" + e1);\r\n                    break;\r\n                /* 2.5.198.82 */\r\n                case 'PtgPower':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"^\" + e1);\r\n                    break;\r\n                /* 2.5.198.43 */\r\n                case 'PtgConcat':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"&\" + e1);\r\n                    break;\r\n                /* 2.5.198.69 */\r\n                case 'PtgLt':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"<\" + e1);\r\n                    break;\r\n                /* 2.5.198.68 */\r\n                case 'PtgLe':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"<=\" + e1);\r\n                    break;\r\n                /* 2.5.198.56 */\r\n                case 'PtgEq':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"=\" + e1);\r\n                    break;\r\n                /* 2.5.198.64 */\r\n                case 'PtgGe':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \">=\" + e1);\r\n                    break;\r\n                /* 2.5.198.65 */\r\n                case 'PtgGt':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \">\" + e1);\r\n                    break;\r\n                /* 2.5.198.78 */\r\n                case 'PtgNe':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \"<>\" + e1);\r\n                    break;\r\n\r\n                /* 2.2.2.1 Binary Reference Operator Token */\r\n                /* 2.5.198.67 */\r\n                case 'PtgIsect':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \" \" + e1);\r\n                    break;\r\n                case 'PtgUnion':\r\n                    e1 = stack.pop(); e2 = stack.pop();\r\n                    stack.push(e2 + \",\" + e1);\r\n                    break;\r\n                case 'PtgRange': break;\r\n\r\n                /* 2.2.2.3 Control Tokens \"can be ignored\" */\r\n                /* 2.5.198.34 */\r\n                case 'PtgAttrChoose': break;\r\n                /* 2.5.198.35 */\r\n                case 'PtgAttrGoto': break;\r\n                /* 2.5.198.36 */\r\n                case 'PtgAttrIf': break;\r\n\r\n\r\n                /* 2.5.198.84 */\r\n                case 'PtgRef':\r\n                    type = f[1][0]; c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), _range);\r\n                    stack.push(encode_cell(c));\r\n                    break;\r\n                /* 2.5.198.88 */\r\n                case 'PtgRefN':\r\n                    type = f[1][0]; c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), cell);\r\n                    stack.push(encode_cell(c));\r\n                    break;\r\n                case 'PtgRef3d': // TODO: lots of stuff\r\n                    type = f[1][0]; ixti = f[1][1]; c = shift_cell_xls(f[1][2], _range);\r\n                    stack.push(supbooks[1][ixti + 1] + \"!\" + encode_cell(c));\r\n                    break;\r\n\r\n                /* Function Call */\r\n                /* 2.5.198.62 */\r\n                case 'PtgFunc':\r\n                /* 2.5.198.63 */\r\n                case 'PtgFuncVar':\r\n                    /* f[1] = [argc, func] */\r\n                    var argc = f[1][0], func = f[1][1];\r\n                    if (!argc) argc = 0;\r\n                    var args = stack.slice(-argc);\r\n                    stack.length -= argc;\r\n                    if (func === 'User') func = args.shift();\r\n                    stack.push(func + \"(\" + args.join(\",\") + \")\");\r\n                    break;\r\n\r\n                /* 2.5.198.42 */\r\n                case 'PtgBool': stack.push(f[1] ? \"TRUE\" : \"FALSE\"); break;\r\n                /* 2.5.198.66 */\r\n                case 'PtgInt': stack.push(f[1]); break;\r\n                /* 2.5.198.79 TODO: precision? */\r\n                case 'PtgNum': stack.push(String(f[1])); break;\r\n                /* 2.5.198.89 */\r\n                case 'PtgStr': stack.push('\"' + f[1] + '\"'); break;\r\n                /* 2.5.198.57 */\r\n                case 'PtgErr': stack.push(f[1]); break;\r\n                /* 2.5.198.27 TODO: fixed points */\r\n                case 'PtgArea':\r\n                    type = f[1][0]; r = shift_range_xls(f[1][1], _range);\r\n                    stack.push(encode_range(r));\r\n                    break;\r\n                /* 2.5.198.28 */\r\n                case 'PtgArea3d': // TODO: lots of stuff\r\n                    type = f[1][0]; ixti = f[1][1]; r = f[1][2];\r\n                    stack.push(supbooks[1][ixti + 1] + \"!\" + encode_range(r));\r\n                    break;\r\n                /* 2.5.198.41 */\r\n                case 'PtgAttrSum':\r\n                    stack.push(\"SUM(\" + stack.pop() + \")\");\r\n                    break;\r\n\r\n                /* Expression Prefixes */\r\n                /* 2.5.198.37 */\r\n                case 'PtgAttrSemi': break;\r\n\r\n                /* 2.5.97.60 TODO: do something different for revisions */\r\n                case 'PtgName':\r\n                    /* f[1] = type, 0, nameindex */\r\n                    nameidx = f[1][2];\r\n                    var lbl = supbooks[0][nameidx];\r\n                    var name = lbl.Name;\r\n                    if (name in XLSXFutureFunctions) name = XLSXFutureFunctions[name];\r\n                    stack.push(name);\r\n                    break;\r\n\r\n                /* 2.5.97.61 TODO: do something different for revisions */\r\n                case 'PtgNameX':\r\n                    /* f[1] = type, ixti, nameindex */\r\n                    var bookidx = f[1][1]; nameidx = f[1][2]; var externbook;\r\n                    /* TODO: Properly handle missing values */\r\n                    if (supbooks[bookidx + 1]) externbook = supbooks[bookidx + 1][nameidx];\r\n                    else if (supbooks[bookidx - 1]) externbook = supbooks[bookidx - 1][nameidx];\r\n                    if (!externbook) externbook = { body: \"??NAMEX??\" };\r\n                    stack.push(externbook.body);\r\n                    break;\r\n\r\n                /* 2.2.2.4 Display Tokens */\r\n                /* 2.5.198.80 */\r\n                case 'PtgParen': stack.push('(' + stack.pop() + ')'); break;\r\n\r\n                /* 2.5.198.86 */\r\n                case 'PtgRefErr': stack.push('#REF!'); break;\r\n\r\n                /* */\r\n                /* 2.5.198.58 TODO */\r\n                case 'PtgExp':\r\n                    c = { c: f[1][1], r: f[1][0] };\r\n                    var q = { c: cell.c, r: cell.r };\r\n                    if (supbooks.sharedf[encode_cell(c)]) {\r\n                        var parsedf = (supbooks.sharedf[encode_cell(c)]);\r\n                        stack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\r\n                    }\r\n                    else {\r\n                        var fnd = false;\r\n                        for (e1 = 0; e1 != supbooks.arrayf.length; ++e1) {\r\n                            /* TODO: should be something like range_has */\r\n                            e2 = supbooks.arrayf[e1];\r\n                            if (c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\r\n                            if (c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\r\n                            stack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\r\n                        }\r\n                        if (!fnd) stack.push(f[1]);\r\n                    }\r\n                    break;\r\n\r\n                /* 2.5.198.32 TODO */\r\n                case 'PtgArray':\r\n                    stack.push(\"{\" + f[1].map(mapper).join(\";\") + \"}\");\r\n                    break;\r\n\r\n                /* 2.2.2.5 Mem Tokens */\r\n                /* 2.5.198.70 TODO: confirm this is a non-display */\r\n                case 'PtgMemArea':\r\n                    //stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\r\n                    break;\r\n\r\n                /* 2.5.198.38 TODO */\r\n                case 'PtgAttrSpace': break;\r\n\r\n                /* 2.5.198.92 TODO */\r\n                case 'PtgTbl': break;\r\n\r\n                /* 2.5.198.71 */\r\n                case 'PtgMemErr': break;\r\n\r\n                /* 2.5.198.74 */\r\n                case 'PtgMissArg':\r\n                    stack.push(\"\");\r\n                    break;\r\n\r\n                /* 2.5.198.29 TODO */\r\n                case 'PtgAreaErr': break;\r\n\r\n                /* 2.5.198.31 TODO */\r\n                case 'PtgAreaN': stack.push(\"\"); break;\r\n\r\n                /* 2.5.198.87 TODO */\r\n                case 'PtgRefErr3d': break;\r\n\r\n                /* 2.5.198.72 TODO */\r\n                case 'PtgMemFunc': break;\r\n\r\n                default: throw 'Unrecognized Formula Token: ' + f;\r\n            }\r\n            //console.log(\"::\",f, stack)\r\n        }\r\n        //console.log(\"--\",stack);\r\n        return stack[0];\r\n    }\r\n\r\n    /* [MS-XLSB] 2.5.97.4 CellParsedFormula TODO: use similar logic to js-xls */\r\n    function parse_XLSBCellParsedFormula(data, length) {\r\n        var cce = data.read_shift(4);\r\n        return parsenoop(data, length - 4);\r\n    }\r\n    /* [MS-XLS] 2.5.198.44 */\r\n    var PtgDataType = {\r\n        0x1: \"REFERENCE\", // reference to range\r\n        0x2: \"VALUE\", // single value\r\n        0x3: \"ARRAY\" // array of values\r\n    };\r\n\r\n    /* [MS-XLS] 2.5.198.4 */\r\n    var Cetab = {\r\n        0x0000: 'BEEP',\r\n        0x0001: 'OPEN',\r\n        0x0002: 'OPEN.LINKS',\r\n        0x0003: 'CLOSE.ALL',\r\n        0x0004: 'SAVE',\r\n        0x0005: 'SAVE.AS',\r\n        0x0006: 'FILE.DELETE',\r\n        0x0007: 'PAGE.SETUP',\r\n        0x0008: 'PRINT',\r\n        0x0009: 'PRINTER.SETUP',\r\n        0x000A: 'QUIT',\r\n        0x000B: 'NEW.WINDOW',\r\n        0x000C: 'ARRANGE.ALL',\r\n        0x000D: 'WINDOW.SIZE',\r\n        0x000E: 'WINDOW.MOVE',\r\n        0x000F: 'FULL',\r\n        0x0010: 'CLOSE',\r\n        0x0011: 'RUN',\r\n        0x0016: 'SET.PRINT.AREA',\r\n        0x0017: 'SET.PRINT.TITLES',\r\n        0x0018: 'SET.PAGE.BREAK',\r\n        0x0019: 'REMOVE.PAGE.BREAK',\r\n        0x001A: 'FONT',\r\n        0x001B: 'DISPLAY',\r\n        0x001C: 'PROTECT.DOCUMENT',\r\n        0x001D: 'PRECISION',\r\n        0x001E: 'A1.R1C1',\r\n        0x001F: 'CALCULATE.NOW',\r\n        0x0020: 'CALCULATION',\r\n        0x0022: 'DATA.FIND',\r\n        0x0023: 'EXTRACT',\r\n        0x0024: 'DATA.DELETE',\r\n        0x0025: 'SET.DATABASE',\r\n        0x0026: 'SET.CRITERIA',\r\n        0x0027: 'SORT',\r\n        0x0028: 'DATA.SERIES',\r\n        0x0029: 'TABLE',\r\n        0x002A: 'FORMAT.NUMBER',\r\n        0x002B: 'ALIGNMENT',\r\n        0x002C: 'STYLE',\r\n        0x002D: 'BORDER',\r\n        0x002E: 'CELL.PROTECTION',\r\n        0x002F: 'COLUMN.WIDTH',\r\n        0x0030: 'UNDO',\r\n        0x0031: 'CUT',\r\n        0x0032: 'COPY',\r\n        0x0033: 'PASTE',\r\n        0x0034: 'CLEAR',\r\n        0x0035: 'PASTE.SPECIAL',\r\n        0x0036: 'EDIT.DELETE',\r\n        0x0037: 'INSERT',\r\n        0x0038: 'FILL.RIGHT',\r\n        0x0039: 'FILL.DOWN',\r\n        0x003D: 'DEFINE.NAME',\r\n        0x003E: 'CREATE.NAMES',\r\n        0x003F: 'FORMULA.GOTO',\r\n        0x0040: 'FORMULA.FIND',\r\n        0x0041: 'SELECT.LAST.CELL',\r\n        0x0042: 'SHOW.ACTIVE.CELL',\r\n        0x0043: 'GALLERY.AREA',\r\n        0x0044: 'GALLERY.BAR',\r\n        0x0045: 'GALLERY.COLUMN',\r\n        0x0046: 'GALLERY.LINE',\r\n        0x0047: 'GALLERY.PIE',\r\n        0x0048: 'GALLERY.SCATTER',\r\n        0x0049: 'COMBINATION',\r\n        0x004A: 'PREFERRED',\r\n        0x004B: 'ADD.OVERLAY',\r\n        0x004C: 'GRIDLINES',\r\n        0x004D: 'SET.PREFERRED',\r\n        0x004E: 'AXES',\r\n        0x004F: 'LEGEND',\r\n        0x0050: 'ATTACH.TEXT',\r\n        0x0051: 'ADD.ARROW',\r\n        0x0052: 'SELECT.CHART',\r\n        0x0053: 'SELECT.PLOT.AREA',\r\n        0x0054: 'PATTERNS',\r\n        0x0055: 'MAIN.CHART',\r\n        0x0056: 'OVERLAY',\r\n        0x0057: 'SCALE',\r\n        0x0058: 'FORMAT.LEGEND',\r\n        0x0059: 'FORMAT.TEXT',\r\n        0x005A: 'EDIT.REPEAT',\r\n        0x005B: 'PARSE',\r\n        0x005C: 'JUSTIFY',\r\n        0x005D: 'HIDE',\r\n        0x005E: 'UNHIDE',\r\n        0x005F: 'WORKSPACE',\r\n        0x0060: 'FORMULA',\r\n        0x0061: 'FORMULA.FILL',\r\n        0x0062: 'FORMULA.ARRAY',\r\n        0x0063: 'DATA.FIND.NEXT',\r\n        0x0064: 'DATA.FIND.PREV',\r\n        0x0065: 'FORMULA.FIND.NEXT',\r\n        0x0066: 'FORMULA.FIND.PREV',\r\n        0x0067: 'ACTIVATE',\r\n        0x0068: 'ACTIVATE.NEXT',\r\n        0x0069: 'ACTIVATE.PREV',\r\n        0x006A: 'UNLOCKED.NEXT',\r\n        0x006B: 'UNLOCKED.PREV',\r\n        0x006C: 'COPY.PICTURE',\r\n        0x006D: 'SELECT',\r\n        0x006E: 'DELETE.NAME',\r\n        0x006F: 'DELETE.FORMAT',\r\n        0x0070: 'VLINE',\r\n        0x0071: 'HLINE',\r\n        0x0072: 'VPAGE',\r\n        0x0073: 'HPAGE',\r\n        0x0074: 'VSCROLL',\r\n        0x0075: 'HSCROLL',\r\n        0x0076: 'ALERT',\r\n        0x0077: 'NEW',\r\n        0x0078: 'CANCEL.COPY',\r\n        0x0079: 'SHOW.CLIPBOARD',\r\n        0x007A: 'MESSAGE',\r\n        0x007C: 'PASTE.LINK',\r\n        0x007D: 'APP.ACTIVATE',\r\n        0x007E: 'DELETE.ARROW',\r\n        0x007F: 'ROW.HEIGHT',\r\n        0x0080: 'FORMAT.MOVE',\r\n        0x0081: 'FORMAT.SIZE',\r\n        0x0082: 'FORMULA.REPLACE',\r\n        0x0083: 'SEND.KEYS',\r\n        0x0084: 'SELECT.SPECIAL',\r\n        0x0085: 'APPLY.NAMES',\r\n        0x0086: 'REPLACE.FONT',\r\n        0x0087: 'FREEZE.PANES',\r\n        0x0088: 'SHOW.INFO',\r\n        0x0089: 'SPLIT',\r\n        0x008A: 'ON.WINDOW',\r\n        0x008B: 'ON.DATA',\r\n        0x008C: 'DISABLE.INPUT',\r\n        0x008E: 'OUTLINE',\r\n        0x008F: 'LIST.NAMES',\r\n        0x0090: 'FILE.CLOSE',\r\n        0x0091: 'SAVE.WORKBOOK',\r\n        0x0092: 'DATA.FORM',\r\n        0x0093: 'COPY.CHART',\r\n        0x0094: 'ON.TIME',\r\n        0x0095: 'WAIT',\r\n        0x0096: 'FORMAT.FONT',\r\n        0x0097: 'FILL.UP',\r\n        0x0098: 'FILL.LEFT',\r\n        0x0099: 'DELETE.OVERLAY',\r\n        0x009B: 'SHORT.MENUS',\r\n        0x009F: 'SET.UPDATE.STATUS',\r\n        0x00A1: 'COLOR.PALETTE',\r\n        0x00A2: 'DELETE.STYLE',\r\n        0x00A3: 'WINDOW.RESTORE',\r\n        0x00A4: 'WINDOW.MAXIMIZE',\r\n        0x00A6: 'CHANGE.LINK',\r\n        0x00A7: 'CALCULATE.DOCUMENT',\r\n        0x00A8: 'ON.KEY',\r\n        0x00A9: 'APP.RESTORE',\r\n        0x00AA: 'APP.MOVE',\r\n        0x00AB: 'APP.SIZE',\r\n        0x00AC: 'APP.MINIMIZE',\r\n        0x00AD: 'APP.MAXIMIZE',\r\n        0x00AE: 'BRING.TO.FRONT',\r\n        0x00AF: 'SEND.TO.BACK',\r\n        0x00B9: 'MAIN.CHART.TYPE',\r\n        0x00BA: 'OVERLAY.CHART.TYPE',\r\n        0x00BB: 'SELECT.END',\r\n        0x00BC: 'OPEN.MAIL',\r\n        0x00BD: 'SEND.MAIL',\r\n        0x00BE: 'STANDARD.FONT',\r\n        0x00BF: 'CONSOLIDATE',\r\n        0x00C0: 'SORT.SPECIAL',\r\n        0x00C1: 'GALLERY.3D.AREA',\r\n        0x00C2: 'GALLERY.3D.COLUMN',\r\n        0x00C3: 'GALLERY.3D.LINE',\r\n        0x00C4: 'GALLERY.3D.PIE',\r\n        0x00C5: 'VIEW.3D',\r\n        0x00C6: 'GOAL.SEEK',\r\n        0x00C7: 'WORKGROUP',\r\n        0x00C8: 'FILL.GROUP',\r\n        0x00C9: 'UPDATE.LINK',\r\n        0x00CA: 'PROMOTE',\r\n        0x00CB: 'DEMOTE',\r\n        0x00CC: 'SHOW.DETAIL',\r\n        0x00CE: 'UNGROUP',\r\n        0x00CF: 'OBJECT.PROPERTIES',\r\n        0x00D0: 'SAVE.NEW.OBJECT',\r\n        0x00D1: 'SHARE',\r\n        0x00D2: 'SHARE.NAME',\r\n        0x00D3: 'DUPLICATE',\r\n        0x00D4: 'APPLY.STYLE',\r\n        0x00D5: 'ASSIGN.TO.OBJECT',\r\n        0x00D6: 'OBJECT.PROTECTION',\r\n        0x00D7: 'HIDE.OBJECT',\r\n        0x00D8: 'SET.EXTRACT',\r\n        0x00D9: 'CREATE.PUBLISHER',\r\n        0x00DA: 'SUBSCRIBE.TO',\r\n        0x00DB: 'ATTRIBUTES',\r\n        0x00DC: 'SHOW.TOOLBAR',\r\n        0x00DE: 'PRINT.PREVIEW',\r\n        0x00DF: 'EDIT.COLOR',\r\n        0x00E0: 'SHOW.LEVELS',\r\n        0x00E1: 'FORMAT.MAIN',\r\n        0x00E2: 'FORMAT.OVERLAY',\r\n        0x00E3: 'ON.RECALC',\r\n        0x00E4: 'EDIT.SERIES',\r\n        0x00E5: 'DEFINE.STYLE',\r\n        0x00F0: 'LINE.PRINT',\r\n        0x00F3: 'ENTER.DATA',\r\n        0x00F9: 'GALLERY.RADAR',\r\n        0x00FA: 'MERGE.STYLES',\r\n        0x00FB: 'EDITION.OPTIONS',\r\n        0x00FC: 'PASTE.PICTURE',\r\n        0x00FD: 'PASTE.PICTURE.LINK',\r\n        0x00FE: 'SPELLING',\r\n        0x0100: 'ZOOM',\r\n        0x0103: 'INSERT.OBJECT',\r\n        0x0104: 'WINDOW.MINIMIZE',\r\n        0x0109: 'SOUND.NOTE',\r\n        0x010A: 'SOUND.PLAY',\r\n        0x010B: 'FORMAT.SHAPE',\r\n        0x010C: 'EXTEND.POLYGON',\r\n        0x010D: 'FORMAT.AUTO',\r\n        0x0110: 'GALLERY.3D.BAR',\r\n        0x0111: 'GALLERY.3D.SURFACE',\r\n        0x0112: 'FILL.AUTO',\r\n        0x0114: 'CUSTOMIZE.TOOLBAR',\r\n        0x0115: 'ADD.TOOL',\r\n        0x0116: 'EDIT.OBJECT',\r\n        0x0117: 'ON.DOUBLECLICK',\r\n        0x0118: 'ON.ENTRY',\r\n        0x0119: 'WORKBOOK.ADD',\r\n        0x011A: 'WORKBOOK.MOVE',\r\n        0x011B: 'WORKBOOK.COPY',\r\n        0x011C: 'WORKBOOK.OPTIONS',\r\n        0x011D: 'SAVE.WORKSPACE',\r\n        0x0120: 'CHART.WIZARD',\r\n        0x0121: 'DELETE.TOOL',\r\n        0x0122: 'MOVE.TOOL',\r\n        0x0123: 'WORKBOOK.SELECT',\r\n        0x0124: 'WORKBOOK.ACTIVATE',\r\n        0x0125: 'ASSIGN.TO.TOOL',\r\n        0x0127: 'COPY.TOOL',\r\n        0x0128: 'RESET.TOOL',\r\n        0x0129: 'CONSTRAIN.NUMERIC',\r\n        0x012A: 'PASTE.TOOL',\r\n        0x012E: 'WORKBOOK.NEW',\r\n        0x0131: 'SCENARIO.CELLS',\r\n        0x0132: 'SCENARIO.DELETE',\r\n        0x0133: 'SCENARIO.ADD',\r\n        0x0134: 'SCENARIO.EDIT',\r\n        0x0135: 'SCENARIO.SHOW',\r\n        0x0136: 'SCENARIO.SHOW.NEXT',\r\n        0x0137: 'SCENARIO.SUMMARY',\r\n        0x0138: 'PIVOT.TABLE.WIZARD',\r\n        0x0139: 'PIVOT.FIELD.PROPERTIES',\r\n        0x013A: 'PIVOT.FIELD',\r\n        0x013B: 'PIVOT.ITEM',\r\n        0x013C: 'PIVOT.ADD.FIELDS',\r\n        0x013E: 'OPTIONS.CALCULATION',\r\n        0x013F: 'OPTIONS.EDIT',\r\n        0x0140: 'OPTIONS.VIEW',\r\n        0x0141: 'ADDIN.MANAGER',\r\n        0x0142: 'MENU.EDITOR',\r\n        0x0143: 'ATTACH.TOOLBARS',\r\n        0x0144: 'VBAActivate',\r\n        0x0145: 'OPTIONS.CHART',\r\n        0x0148: 'VBA.INSERT.FILE',\r\n        0x014A: 'VBA.PROCEDURE.DEFINITION',\r\n        0x0150: 'ROUTING.SLIP',\r\n        0x0152: 'ROUTE.DOCUMENT',\r\n        0x0153: 'MAIL.LOGON',\r\n        0x0156: 'INSERT.PICTURE',\r\n        0x0157: 'EDIT.TOOL',\r\n        0x0158: 'GALLERY.DOUGHNUT',\r\n        0x015E: 'CHART.TREND',\r\n        0x0160: 'PIVOT.ITEM.PROPERTIES',\r\n        0x0162: 'WORKBOOK.INSERT',\r\n        0x0163: 'OPTIONS.TRANSITION',\r\n        0x0164: 'OPTIONS.GENERAL',\r\n        0x0172: 'FILTER.ADVANCED',\r\n        0x0175: 'MAIL.ADD.MAILER',\r\n        0x0176: 'MAIL.DELETE.MAILER',\r\n        0x0177: 'MAIL.REPLY',\r\n        0x0178: 'MAIL.REPLY.ALL',\r\n        0x0179: 'MAIL.FORWARD',\r\n        0x017A: 'MAIL.NEXT.LETTER',\r\n        0x017B: 'DATA.LABEL',\r\n        0x017C: 'INSERT.TITLE',\r\n        0x017D: 'FONT.PROPERTIES',\r\n        0x017E: 'MACRO.OPTIONS',\r\n        0x017F: 'WORKBOOK.HIDE',\r\n        0x0180: 'WORKBOOK.UNHIDE',\r\n        0x0181: 'WORKBOOK.DELETE',\r\n        0x0182: 'WORKBOOK.NAME',\r\n        0x0184: 'GALLERY.CUSTOM',\r\n        0x0186: 'ADD.CHART.AUTOFORMAT',\r\n        0x0187: 'DELETE.CHART.AUTOFORMAT',\r\n        0x0188: 'CHART.ADD.DATA',\r\n        0x0189: 'AUTO.OUTLINE',\r\n        0x018A: 'TAB.ORDER',\r\n        0x018B: 'SHOW.DIALOG',\r\n        0x018C: 'SELECT.ALL',\r\n        0x018D: 'UNGROUP.SHEETS',\r\n        0x018E: 'SUBTOTAL.CREATE',\r\n        0x018F: 'SUBTOTAL.REMOVE',\r\n        0x0190: 'RENAME.OBJECT',\r\n        0x019C: 'WORKBOOK.SCROLL',\r\n        0x019D: 'WORKBOOK.NEXT',\r\n        0x019E: 'WORKBOOK.PREV',\r\n        0x019F: 'WORKBOOK.TAB.SPLIT',\r\n        0x01A0: 'FULL.SCREEN',\r\n        0x01A1: 'WORKBOOK.PROTECT',\r\n        0x01A4: 'SCROLLBAR.PROPERTIES',\r\n        0x01A5: 'PIVOT.SHOW.PAGES',\r\n        0x01A6: 'TEXT.TO.COLUMNS',\r\n        0x01A7: 'FORMAT.CHARTTYPE',\r\n        0x01A8: 'LINK.FORMAT',\r\n        0x01A9: 'TRACER.DISPLAY',\r\n        0x01AE: 'TRACER.NAVIGATE',\r\n        0x01AF: 'TRACER.CLEAR',\r\n        0x01B0: 'TRACER.ERROR',\r\n        0x01B1: 'PIVOT.FIELD.GROUP',\r\n        0x01B2: 'PIVOT.FIELD.UNGROUP',\r\n        0x01B3: 'CHECKBOX.PROPERTIES',\r\n        0x01B4: 'LABEL.PROPERTIES',\r\n        0x01B5: 'LISTBOX.PROPERTIES',\r\n        0x01B6: 'EDITBOX.PROPERTIES',\r\n        0x01B7: 'PIVOT.REFRESH',\r\n        0x01B8: 'LINK.COMBO',\r\n        0x01B9: 'OPEN.TEXT',\r\n        0x01BA: 'HIDE.DIALOG',\r\n        0x01BB: 'SET.DIALOG.FOCUS',\r\n        0x01BC: 'ENABLE.OBJECT',\r\n        0x01BD: 'PUSHBUTTON.PROPERTIES',\r\n        0x01BE: 'SET.DIALOG.DEFAULT',\r\n        0x01BF: 'FILTER',\r\n        0x01C0: 'FILTER.SHOW.ALL',\r\n        0x01C1: 'CLEAR.OUTLINE',\r\n        0x01C2: 'FUNCTION.WIZARD',\r\n        0x01C3: 'ADD.LIST.ITEM',\r\n        0x01C4: 'SET.LIST.ITEM',\r\n        0x01C5: 'REMOVE.LIST.ITEM',\r\n        0x01C6: 'SELECT.LIST.ITEM',\r\n        0x01C7: 'SET.CONTROL.VALUE',\r\n        0x01C8: 'SAVE.COPY.AS',\r\n        0x01CA: 'OPTIONS.LISTS.ADD',\r\n        0x01CB: 'OPTIONS.LISTS.DELETE',\r\n        0x01CC: 'SERIES.AXES',\r\n        0x01CD: 'SERIES.X',\r\n        0x01CE: 'SERIES.Y',\r\n        0x01CF: 'ERRORBAR.X',\r\n        0x01D0: 'ERRORBAR.Y',\r\n        0x01D1: 'FORMAT.CHART',\r\n        0x01D2: 'SERIES.ORDER',\r\n        0x01D3: 'MAIL.LOGOFF',\r\n        0x01D4: 'CLEAR.ROUTING.SLIP',\r\n        0x01D5: 'APP.ACTIVATE.MICROSOFT',\r\n        0x01D6: 'MAIL.EDIT.MAILER',\r\n        0x01D7: 'ON.SHEET',\r\n        0x01D8: 'STANDARD.WIDTH',\r\n        0x01D9: 'SCENARIO.MERGE',\r\n        0x01DA: 'SUMMARY.INFO',\r\n        0x01DB: 'FIND.FILE',\r\n        0x01DC: 'ACTIVE.CELL.FONT',\r\n        0x01DD: 'ENABLE.TIPWIZARD',\r\n        0x01DE: 'VBA.MAKE.ADDIN',\r\n        0x01E0: 'INSERTDATATABLE',\r\n        0x01E1: 'WORKGROUP.OPTIONS',\r\n        0x01E2: 'MAIL.SEND.MAILER',\r\n        0x01E5: 'AUTOCORRECT',\r\n        0x01E9: 'POST.DOCUMENT',\r\n        0x01EB: 'PICKLIST',\r\n        0x01ED: 'VIEW.SHOW',\r\n        0x01EE: 'VIEW.DEFINE',\r\n        0x01EF: 'VIEW.DELETE',\r\n        0x01FD: 'SHEET.BACKGROUND',\r\n        0x01FE: 'INSERT.MAP.OBJECT',\r\n        0x01FF: 'OPTIONS.MENONO',\r\n        0x0205: 'MSOCHECKS',\r\n        0x0206: 'NORMAL',\r\n        0x0207: 'LAYOUT',\r\n        0x0208: 'RM.PRINT.AREA',\r\n        0x0209: 'CLEAR.PRINT.AREA',\r\n        0x020A: 'ADD.PRINT.AREA',\r\n        0x020B: 'MOVE.BRK',\r\n        0x0221: 'HIDECURR.NOTE',\r\n        0x0222: 'HIDEALL.NOTES',\r\n        0x0223: 'DELETE.NOTE',\r\n        0x0224: 'TRAVERSE.NOTES',\r\n        0x0225: 'ACTIVATE.NOTES',\r\n        0x026C: 'PROTECT.REVISIONS',\r\n        0x026D: 'UNPROTECT.REVISIONS',\r\n        0x0287: 'OPTIONS.ME',\r\n        0x028D: 'WEB.PUBLISH',\r\n        0x029B: 'NEWWEBQUERY',\r\n        0x02A1: 'PIVOT.TABLE.CHART',\r\n        0x02F1: 'OPTIONS.SAVE',\r\n        0x02F3: 'OPTIONS.SPELL',\r\n        0x0328: 'HIDEALL.INKANNOTS'\r\n    };\r\n\r\n    /* [MS-XLS] 2.5.198.17 */\r\n    var Ftab = {\r\n        0x0000: 'COUNT',\r\n        0x0001: 'IF',\r\n        0x0002: 'ISNA',\r\n        0x0003: 'ISERROR',\r\n        0x0004: 'SUM',\r\n        0x0005: 'AVERAGE',\r\n        0x0006: 'MIN',\r\n        0x0007: 'MAX',\r\n        0x0008: 'ROW',\r\n        0x0009: 'COLUMN',\r\n        0x000A: 'NA',\r\n        0x000B: 'NPV',\r\n        0x000C: 'STDEV',\r\n        0x000D: 'DOLLAR',\r\n        0x000E: 'FIXED',\r\n        0x000F: 'SIN',\r\n        0x0010: 'COS',\r\n        0x0011: 'TAN',\r\n        0x0012: 'ATAN',\r\n        0x0013: 'PI',\r\n        0x0014: 'SQRT',\r\n        0x0015: 'EXP',\r\n        0x0016: 'LN',\r\n        0x0017: 'LOG10',\r\n        0x0018: 'ABS',\r\n        0x0019: 'INT',\r\n        0x001A: 'SIGN',\r\n        0x001B: 'ROUND',\r\n        0x001C: 'LOOKUP',\r\n        0x001D: 'INDEX',\r\n        0x001E: 'REPT',\r\n        0x001F: 'MID',\r\n        0x0020: 'LEN',\r\n        0x0021: 'VALUE',\r\n        0x0022: 'TRUE',\r\n        0x0023: 'FALSE',\r\n        0x0024: 'AND',\r\n        0x0025: 'OR',\r\n        0x0026: 'NOT',\r\n        0x0027: 'MOD',\r\n        0x0028: 'DCOUNT',\r\n        0x0029: 'DSUM',\r\n        0x002A: 'DAVERAGE',\r\n        0x002B: 'DMIN',\r\n        0x002C: 'DMAX',\r\n        0x002D: 'DSTDEV',\r\n        0x002E: 'VAR',\r\n        0x002F: 'DVAR',\r\n        0x0030: 'TEXT',\r\n        0x0031: 'LINEST',\r\n        0x0032: 'TREND',\r\n        0x0033: 'LOGEST',\r\n        0x0034: 'GROWTH',\r\n        0x0035: 'GOTO',\r\n        0x0036: 'HALT',\r\n        0x0037: 'RETURN',\r\n        0x0038: 'PV',\r\n        0x0039: 'FV',\r\n        0x003A: 'NPER',\r\n        0x003B: 'PMT',\r\n        0x003C: 'RATE',\r\n        0x003D: 'MIRR',\r\n        0x003E: 'IRR',\r\n        0x003F: 'RAND',\r\n        0x0040: 'MATCH',\r\n        0x0041: 'DATE',\r\n        0x0042: 'TIME',\r\n        0x0043: 'DAY',\r\n        0x0044: 'MONTH',\r\n        0x0045: 'YEAR',\r\n        0x0046: 'WEEKDAY',\r\n        0x0047: 'HOUR',\r\n        0x0048: 'MINUTE',\r\n        0x0049: 'SECOND',\r\n        0x004A: 'NOW',\r\n        0x004B: 'AREAS',\r\n        0x004C: 'ROWS',\r\n        0x004D: 'COLUMNS',\r\n        0x004E: 'OFFSET',\r\n        0x004F: 'ABSREF',\r\n        0x0050: 'RELREF',\r\n        0x0051: 'ARGUMENT',\r\n        0x0052: 'SEARCH',\r\n        0x0053: 'TRANSPOSE',\r\n        0x0054: 'ERROR',\r\n        0x0055: 'STEP',\r\n        0x0056: 'TYPE',\r\n        0x0057: 'ECHO',\r\n        0x0058: 'SET.NAME',\r\n        0x0059: 'CALLER',\r\n        0x005A: 'DEREF',\r\n        0x005B: 'WINDOWS',\r\n        0x005C: 'SERIES',\r\n        0x005D: 'DOCUMENTS',\r\n        0x005E: 'ACTIVE.CELL',\r\n        0x005F: 'SELECTION',\r\n        0x0060: 'RESULT',\r\n        0x0061: 'ATAN2',\r\n        0x0062: 'ASIN',\r\n        0x0063: 'ACOS',\r\n        0x0064: 'CHOOSE',\r\n        0x0065: 'HLOOKUP',\r\n        0x0066: 'VLOOKUP',\r\n        0x0067: 'LINKS',\r\n        0x0068: 'INPUT',\r\n        0x0069: 'ISREF',\r\n        0x006A: 'GET.FORMULA',\r\n        0x006B: 'GET.NAME',\r\n        0x006C: 'SET.VALUE',\r\n        0x006D: 'LOG',\r\n        0x006E: 'EXEC',\r\n        0x006F: 'CHAR',\r\n        0x0070: 'LOWER',\r\n        0x0071: 'UPPER',\r\n        0x0072: 'PROPER',\r\n        0x0073: 'LEFT',\r\n        0x0074: 'RIGHT',\r\n        0x0075: 'EXACT',\r\n        0x0076: 'TRIM',\r\n        0x0077: 'REPLACE',\r\n        0x0078: 'SUBSTITUTE',\r\n        0x0079: 'CODE',\r\n        0x007A: 'NAMES',\r\n        0x007B: 'DIRECTORY',\r\n        0x007C: 'FIND',\r\n        0x007D: 'CELL',\r\n        0x007E: 'ISERR',\r\n        0x007F: 'ISTEXT',\r\n        0x0080: 'ISNUMBER',\r\n        0x0081: 'ISBLANK',\r\n        0x0082: 'T',\r\n        0x0083: 'N',\r\n        0x0084: 'FOPEN',\r\n        0x0085: 'FCLOSE',\r\n        0x0086: 'FSIZE',\r\n        0x0087: 'FREADLN',\r\n        0x0088: 'FREAD',\r\n        0x0089: 'FWRITELN',\r\n        0x008A: 'FWRITE',\r\n        0x008B: 'FPOS',\r\n        0x008C: 'DATEVALUE',\r\n        0x008D: 'TIMEVALUE',\r\n        0x008E: 'SLN',\r\n        0x008F: 'SYD',\r\n        0x0090: 'DDB',\r\n        0x0091: 'GET.DEF',\r\n        0x0092: 'REFTEXT',\r\n        0x0093: 'TEXTREF',\r\n        0x0094: 'INDIRECT',\r\n        0x0095: 'REGISTER',\r\n        0x0096: 'CALL',\r\n        0x0097: 'ADD.BAR',\r\n        0x0098: 'ADD.MENU',\r\n        0x0099: 'ADD.COMMAND',\r\n        0x009A: 'ENABLE.COMMAND',\r\n        0x009B: 'CHECK.COMMAND',\r\n        0x009C: 'RENAME.COMMAND',\r\n        0x009D: 'SHOW.BAR',\r\n        0x009E: 'DELETE.MENU',\r\n        0x009F: 'DELETE.COMMAND',\r\n        0x00A0: 'GET.CHART.ITEM',\r\n        0x00A1: 'DIALOG.BOX',\r\n        0x00A2: 'CLEAN',\r\n        0x00A3: 'MDETERM',\r\n        0x00A4: 'MINVERSE',\r\n        0x00A5: 'MMULT',\r\n        0x00A6: 'FILES',\r\n        0x00A7: 'IPMT',\r\n        0x00A8: 'PPMT',\r\n        0x00A9: 'COUNTA',\r\n        0x00AA: 'CANCEL.KEY',\r\n        0x00AB: 'FOR',\r\n        0x00AC: 'WHILE',\r\n        0x00AD: 'BREAK',\r\n        0x00AE: 'NEXT',\r\n        0x00AF: 'INITIATE',\r\n        0x00B0: 'REQUEST',\r\n        0x00B1: 'POKE',\r\n        0x00B2: 'EXECUTE',\r\n        0x00B3: 'TERMINATE',\r\n        0x00B4: 'RESTART',\r\n        0x00B5: 'HELP',\r\n        0x00B6: 'GET.BAR',\r\n        0x00B7: 'PRODUCT',\r\n        0x00B8: 'FACT',\r\n        0x00B9: 'GET.CELL',\r\n        0x00BA: 'GET.WORKSPACE',\r\n        0x00BB: 'GET.WINDOW',\r\n        0x00BC: 'GET.DOCUMENT',\r\n        0x00BD: 'DPRODUCT',\r\n        0x00BE: 'ISNONTEXT',\r\n        0x00BF: 'GET.NOTE',\r\n        0x00C0: 'NOTE',\r\n        0x00C1: 'STDEVP',\r\n        0x00C2: 'VARP',\r\n        0x00C3: 'DSTDEVP',\r\n        0x00C4: 'DVARP',\r\n        0x00C5: 'TRUNC',\r\n        0x00C6: 'ISLOGICAL',\r\n        0x00C7: 'DCOUNTA',\r\n        0x00C8: 'DELETE.BAR',\r\n        0x00C9: 'UNREGISTER',\r\n        0x00CC: 'USDOLLAR',\r\n        0x00CD: 'FINDB',\r\n        0x00CE: 'SEARCHB',\r\n        0x00CF: 'REPLACEB',\r\n        0x00D0: 'LEFTB',\r\n        0x00D1: 'RIGHTB',\r\n        0x00D2: 'MIDB',\r\n        0x00D3: 'LENB',\r\n        0x00D4: 'ROUNDUP',\r\n        0x00D5: 'ROUNDDOWN',\r\n        0x00D6: 'ASC',\r\n        0x00D7: 'DBCS',\r\n        0x00D8: 'RANK',\r\n        0x00DB: 'ADDRESS',\r\n        0x00DC: 'DAYS360',\r\n        0x00DD: 'TODAY',\r\n        0x00DE: 'VDB',\r\n        0x00DF: 'ELSE',\r\n        0x00E0: 'ELSE.IF',\r\n        0x00E1: 'END.IF',\r\n        0x00E2: 'FOR.CELL',\r\n        0x00E3: 'MEDIAN',\r\n        0x00E4: 'SUMPRODUCT',\r\n        0x00E5: 'SINH',\r\n        0x00E6: 'COSH',\r\n        0x00E7: 'TANH',\r\n        0x00E8: 'ASINH',\r\n        0x00E9: 'ACOSH',\r\n        0x00EA: 'ATANH',\r\n        0x00EB: 'DGET',\r\n        0x00EC: 'CREATE.OBJECT',\r\n        0x00ED: 'VOLATILE',\r\n        0x00EE: 'LAST.ERROR',\r\n        0x00EF: 'CUSTOM.UNDO',\r\n        0x00F0: 'CUSTOM.REPEAT',\r\n        0x00F1: 'FORMULA.CONVERT',\r\n        0x00F2: 'GET.LINK.INFO',\r\n        0x00F3: 'TEXT.BOX',\r\n        0x00F4: 'INFO',\r\n        0x00F5: 'GROUP',\r\n        0x00F6: 'GET.OBJECT',\r\n        0x00F7: 'DB',\r\n        0x00F8: 'PAUSE',\r\n        0x00FB: 'RESUME',\r\n        0x00FC: 'FREQUENCY',\r\n        0x00FD: 'ADD.TOOLBAR',\r\n        0x00FE: 'DELETE.TOOLBAR',\r\n        0x00FF: 'User',\r\n        0x0100: 'RESET.TOOLBAR',\r\n        0x0101: 'EVALUATE',\r\n        0x0102: 'GET.TOOLBAR',\r\n        0x0103: 'GET.TOOL',\r\n        0x0104: 'SPELLING.CHECK',\r\n        0x0105: 'ERROR.TYPE',\r\n        0x0106: 'APP.TITLE',\r\n        0x0107: 'WINDOW.TITLE',\r\n        0x0108: 'SAVE.TOOLBAR',\r\n        0x0109: 'ENABLE.TOOL',\r\n        0x010A: 'PRESS.TOOL',\r\n        0x010B: 'REGISTER.ID',\r\n        0x010C: 'GET.WORKBOOK',\r\n        0x010D: 'AVEDEV',\r\n        0x010E: 'BETADIST',\r\n        0x010F: 'GAMMALN',\r\n        0x0110: 'BETAINV',\r\n        0x0111: 'BINOMDIST',\r\n        0x0112: 'CHIDIST',\r\n        0x0113: 'CHIINV',\r\n        0x0114: 'COMBIN',\r\n        0x0115: 'CONFIDENCE',\r\n        0x0116: 'CRITBINOM',\r\n        0x0117: 'EVEN',\r\n        0x0118: 'EXPONDIST',\r\n        0x0119: 'FDIST',\r\n        0x011A: 'FINV',\r\n        0x011B: 'FISHER',\r\n        0x011C: 'FISHERINV',\r\n        0x011D: 'FLOOR',\r\n        0x011E: 'GAMMADIST',\r\n        0x011F: 'GAMMAINV',\r\n        0x0120: 'CEILING',\r\n        0x0121: 'HYPGEOMDIST',\r\n        0x0122: 'LOGNORMDIST',\r\n        0x0123: 'LOGINV',\r\n        0x0124: 'NEGBINOMDIST',\r\n        0x0125: 'NORMDIST',\r\n        0x0126: 'NORMSDIST',\r\n        0x0127: 'NORMINV',\r\n        0x0128: 'NORMSINV',\r\n        0x0129: 'STANDARDIZE',\r\n        0x012A: 'ODD',\r\n        0x012B: 'PERMUT',\r\n        0x012C: 'POISSON',\r\n        0x012D: 'TDIST',\r\n        0x012E: 'WEIBULL',\r\n        0x012F: 'SUMXMY2',\r\n        0x0130: 'SUMX2MY2',\r\n        0x0131: 'SUMX2PY2',\r\n        0x0132: 'CHITEST',\r\n        0x0133: 'CORREL',\r\n        0x0134: 'COVAR',\r\n        0x0135: 'FORECAST',\r\n        0x0136: 'FTEST',\r\n        0x0137: 'INTERCEPT',\r\n        0x0138: 'PEARSON',\r\n        0x0139: 'RSQ',\r\n        0x013A: 'STEYX',\r\n        0x013B: 'SLOPE',\r\n        0x013C: 'TTEST',\r\n        0x013D: 'PROB',\r\n        0x013E: 'DEVSQ',\r\n        0x013F: 'GEOMEAN',\r\n        0x0140: 'HARMEAN',\r\n        0x0141: 'SUMSQ',\r\n        0x0142: 'KURT',\r\n        0x0143: 'SKEW',\r\n        0x0144: 'ZTEST',\r\n        0x0145: 'LARGE',\r\n        0x0146: 'SMALL',\r\n        0x0147: 'QUARTILE',\r\n        0x0148: 'PERCENTILE',\r\n        0x0149: 'PERCENTRANK',\r\n        0x014A: 'MODE',\r\n        0x014B: 'TRIMMEAN',\r\n        0x014C: 'TINV',\r\n        0x014E: 'MOVIE.COMMAND',\r\n        0x014F: 'GET.MOVIE',\r\n        0x0150: 'CONCATENATE',\r\n        0x0151: 'POWER',\r\n        0x0152: 'PIVOT.ADD.DATA',\r\n        0x0153: 'GET.PIVOT.TABLE',\r\n        0x0154: 'GET.PIVOT.FIELD',\r\n        0x0155: 'GET.PIVOT.ITEM',\r\n        0x0156: 'RADIANS',\r\n        0x0157: 'DEGREES',\r\n        0x0158: 'SUBTOTAL',\r\n        0x0159: 'SUMIF',\r\n        0x015A: 'COUNTIF',\r\n        0x015B: 'COUNTBLANK',\r\n        0x015C: 'SCENARIO.GET',\r\n        0x015D: 'OPTIONS.LISTS.GET',\r\n        0x015E: 'ISPMT',\r\n        0x015F: 'DATEDIF',\r\n        0x0160: 'DATESTRING',\r\n        0x0161: 'NUMBERSTRING',\r\n        0x0162: 'ROMAN',\r\n        0x0163: 'OPEN.DIALOG',\r\n        0x0164: 'SAVE.DIALOG',\r\n        0x0165: 'VIEW.GET',\r\n        0x0166: 'GETPIVOTDATA',\r\n        0x0167: 'HYPERLINK',\r\n        0x0168: 'PHONETIC',\r\n        0x0169: 'AVERAGEA',\r\n        0x016A: 'MAXA',\r\n        0x016B: 'MINA',\r\n        0x016C: 'STDEVPA',\r\n        0x016D: 'VARPA',\r\n        0x016E: 'STDEVA',\r\n        0x016F: 'VARA',\r\n        0x0170: 'BAHTTEXT',\r\n        0x0171: 'THAIDAYOFWEEK',\r\n        0x0172: 'THAIDIGIT',\r\n        0x0173: 'THAIMONTHOFYEAR',\r\n        0x0174: 'THAINUMSOUND',\r\n        0x0175: 'THAINUMSTRING',\r\n        0x0176: 'THAISTRINGLENGTH',\r\n        0x0177: 'ISTHAIDIGIT',\r\n        0x0178: 'ROUNDBAHTDOWN',\r\n        0x0179: 'ROUNDBAHTUP',\r\n        0x017A: 'THAIYEAR',\r\n        0x017B: 'RTD'\r\n    };\r\n    var FtabArgc = {\r\n        0x0002: 1, /* ISNA */\r\n        0x0003: 1, /* ISERROR */\r\n        0x000F: 1, /* SIN */\r\n        0x0010: 1, /* COS */\r\n        0x0011: 1, /* TAN */\r\n        0x0012: 1, /* ATAN */\r\n        0x0014: 1, /* SQRT */\r\n        0x0015: 1, /* EXP */\r\n        0x0016: 1, /* LN */\r\n        0x0017: 1, /* LOG10 */\r\n        0x0018: 1, /* ABS */\r\n        0x0019: 1, /* INT */\r\n        0x001A: 1, /* SIGN */\r\n        0x001B: 2, /* ROUND */\r\n        0x001E: 2, /* REPT */\r\n        0x001F: 3, /* MID */\r\n        0x0020: 1, /* LEN */\r\n        0x0021: 1, /* VALUE */\r\n        0x0026: 1, /* NOT */\r\n        0x0027: 2, /* MOD */\r\n        0x0028: 3, /* DCOUNT */\r\n        0x0029: 3, /* DSUM */\r\n        0x002A: 3, /* DAVERAGE */\r\n        0x002B: 3, /* DMIN */\r\n        0x002C: 3, /* DMAX */\r\n        0x002D: 3, /* DSTDEV */\r\n        0x002F: 3, /* DVAR */\r\n        0x0030: 2, /* TEXT */\r\n        0x0035: 1, /* GOTO */\r\n        0x003D: 3, /* MIRR */\r\n        0x0041: 3, /* DATE */\r\n        0x0042: 3, /* TIME */\r\n        0x0043: 1, /* DAY */\r\n        0x0044: 1, /* MONTH */\r\n        0x0045: 1, /* YEAR */\r\n        0x0047: 1, /* HOUR */\r\n        0x0048: 1, /* MINUTE */\r\n        0x0049: 1, /* SECOND */\r\n        0x004B: 1, /* AREAS */\r\n        0x004C: 1, /* ROWS */\r\n        0x004D: 1, /* COLUMNS */\r\n        0x004F: 2, /* ABSREF */\r\n        0x0050: 2, /* RELREF */\r\n        0x0053: 1, /* TRANSPOSE */\r\n        0x0056: 1, /* TYPE */\r\n        0x005A: 1, /* DEREF */\r\n        0x0061: 2, /* ATAN2 */\r\n        0x0062: 1, /* ASIN */\r\n        0x0063: 1, /* ACOS */\r\n        0x0069: 1, /* ISREF */\r\n        0x006F: 1, /* CHAR */\r\n        0x0070: 1, /* LOWER */\r\n        0x0071: 1, /* UPPER */\r\n        0x0072: 1, /* PROPER */\r\n        0x0075: 2, /* EXACT */\r\n        0x0076: 1, /* TRIM */\r\n        0x0077: 4, /* REPLACE */\r\n        0x0079: 1, /* CODE */\r\n        0x007E: 1, /* ISERR */\r\n        0x007F: 1, /* ISTEXT */\r\n        0x0080: 1, /* ISNUMBER */\r\n        0x0081: 1, /* ISBLANK */\r\n        0x0082: 1, /* T */\r\n        0x0083: 1, /* N */\r\n        0x0085: 1, /* FCLOSE */\r\n        0x0086: 1, /* FSIZE */\r\n        0x0087: 1, /* FREADLN */\r\n        0x0088: 2, /* FREAD */\r\n        0x0089: 2, /* FWRITELN */\r\n        0x008A: 2, /* FWRITE */\r\n        0x008C: 1, /* DATEVALUE */\r\n        0x008D: 1, /* TIMEVALUE */\r\n        0x008E: 3, /* SLN */\r\n        0x008F: 4, /* SYD */\r\n        0x00A2: 1, /* CLEAN */\r\n        0x00A3: 1, /* MDETERM */\r\n        0x00A4: 1, /* MINVERSE */\r\n        0x00A5: 2, /* MMULT */\r\n        0x00AC: 1, /* WHILE */\r\n        0x00AF: 2, /* INITIATE */\r\n        0x00B0: 2, /* REQUEST */\r\n        0x00B1: 3, /* POKE */\r\n        0x00B2: 2, /* EXECUTE */\r\n        0x00B3: 1, /* TERMINATE */\r\n        0x00B8: 1, /* FACT */\r\n        0x00BD: 3, /* DPRODUCT */\r\n        0x00BE: 1, /* ISNONTEXT */\r\n        0x00C3: 3, /* DSTDEVP */\r\n        0x00C4: 3, /* DVARP */\r\n        0x00C6: 1, /* ISLOGICAL */\r\n        0x00C7: 3, /* DCOUNTA */\r\n        0x00C9: 1, /* UNREGISTER */\r\n        0x00CF: 4, /* REPLACEB */\r\n        0x00D2: 3, /* MIDB */\r\n        0x00D3: 1, /* LENB */\r\n        0x00D4: 2, /* ROUNDUP */\r\n        0x00D5: 2, /* ROUNDDOWN */\r\n        0x00D6: 1, /* ASC */\r\n        0x00D7: 1, /* DBCS */\r\n        0x00E5: 1, /* SINH */\r\n        0x00E6: 1, /* COSH */\r\n        0x00E7: 1, /* TANH */\r\n        0x00E8: 1, /* ASINH */\r\n        0x00E9: 1, /* ACOSH */\r\n        0x00EA: 1, /* ATANH */\r\n        0x00EB: 3, /* DGET */\r\n        0x00F4: 1, /* INFO */\r\n        0x00FC: 2, /* FREQUENCY */\r\n        0x0101: 1, /* EVALUATE */\r\n        0x0105: 1, /* ERROR.TYPE */\r\n        0x010F: 1, /* GAMMALN */\r\n        0x0111: 4, /* BINOMDIST */\r\n        0x0112: 2, /* CHIDIST */\r\n        0x0113: 2, /* CHIINV */\r\n        0x0114: 2, /* COMBIN */\r\n        0x0115: 3, /* CONFIDENCE */\r\n        0x0116: 3, /* CRITBINOM */\r\n        0x0117: 1, /* EVEN */\r\n        0x0118: 3, /* EXPONDIST */\r\n        0x0119: 3, /* FDIST */\r\n        0x011A: 3, /* FINV */\r\n        0x011B: 1, /* FISHER */\r\n        0x011C: 1, /* FISHERINV */\r\n        0x011D: 2, /* FLOOR */\r\n        0x011E: 4, /* GAMMADIST */\r\n        0x011F: 3, /* GAMMAINV */\r\n        0x0120: 2, /* CEILING */\r\n        0x0121: 4, /* HYPGEOMDIST */\r\n        0x0122: 3, /* LOGNORMDIST */\r\n        0x0123: 3, /* LOGINV */\r\n        0x0124: 3, /* NEGBINOMDIST */\r\n        0x0125: 4, /* NORMDIST */\r\n        0x0126: 1, /* NORMSDIST */\r\n        0x0127: 3, /* NORMINV */\r\n        0x0128: 1, /* NORMSINV */\r\n        0x0129: 3, /* STANDARDIZE */\r\n        0x012A: 1, /* ODD */\r\n        0x012B: 2, /* PERMUT */\r\n        0x012C: 3, /* POISSON */\r\n        0x012D: 3, /* TDIST */\r\n        0x012E: 4, /* WEIBULL */\r\n        0x012F: 2, /* SUMXMY2 */\r\n        0x0130: 2, /* SUMX2MY2 */\r\n        0x0131: 2, /* SUMX2PY2 */\r\n        0x0132: 2, /* CHITEST */\r\n        0x0133: 2, /* CORREL */\r\n        0x0134: 2, /* COVAR */\r\n        0x0135: 3, /* FORECAST */\r\n        0x0136: 2, /* FTEST */\r\n        0x0137: 2, /* INTERCEPT */\r\n        0x0138: 2, /* PEARSON */\r\n        0x0139: 2, /* RSQ */\r\n        0x013A: 2, /* STEYX */\r\n        0x013B: 2, /* SLOPE */\r\n        0x013C: 4, /* TTEST */\r\n        0x0145: 2, /* LARGE */\r\n        0x0146: 2, /* SMALL */\r\n        0x0147: 2, /* QUARTILE */\r\n        0x0148: 2, /* PERCENTILE */\r\n        0x014B: 2, /* TRIMMEAN */\r\n        0x014C: 2, /* TINV */\r\n        0x0151: 2, /* POWER */\r\n        0x0156: 1, /* RADIANS */\r\n        0x0157: 1, /* DEGREES */\r\n        0x015A: 2, /* COUNTIF */\r\n        0x015B: 1, /* COUNTBLANK */\r\n        0x015E: 4, /* ISPMT */\r\n        0x015F: 3, /* DATEDIF */\r\n        0x0160: 1, /* DATESTRING */\r\n        0x0161: 2, /* NUMBERSTRING */\r\n        0x0168: 1, /* PHONETIC */\r\n        0x0170: 1, /* BAHTTEXT */\r\n        0x0171: 1, /* THAIDAYOFWEEK */\r\n        0x0172: 1, /* THAIDIGIT */\r\n        0x0173: 1, /* THAIMONTHOFYEAR */\r\n        0x0174: 1, /* THAINUMSOUND */\r\n        0x0175: 1, /* THAINUMSTRING */\r\n        0x0176: 1, /* THAISTRINGLENGTH */\r\n        0x0177: 1, /* ISTHAIDIGIT */\r\n        0x0178: 1, /* ROUNDBAHTDOWN */\r\n        0x0179: 1, /* ROUNDBAHTUP */\r\n        0x017A: 1, /* THAIYEAR */\r\n        0xFFFF: 0\r\n    };\r\n    /* [MS-XLSX] 2.2.3 Functions */\r\n    var XLSXFutureFunctions = {\r\n        \"_xlfn.ACOT\": \"ACOT\",\r\n        \"_xlfn.ACOTH\": \"ACOTH\",\r\n        \"_xlfn.AGGREGATE\": \"AGGREGATE\",\r\n        \"_xlfn.ARABIC\": \"ARABIC\",\r\n        \"_xlfn.AVERAGEIF\": \"AVERAGEIF\",\r\n        \"_xlfn.AVERAGEIFS\": \"AVERAGEIFS\",\r\n        \"_xlfn.BASE\": \"BASE\",\r\n        \"_xlfn.BETA.DIST\": \"BETA.DIST\",\r\n        \"_xlfn.BETA.INV\": \"BETA.INV\",\r\n        \"_xlfn.BINOM.DIST\": \"BINOM.DIST\",\r\n        \"_xlfn.BINOM.DIST.RANGE\": \"BINOM.DIST.RANGE\",\r\n        \"_xlfn.BINOM.INV\": \"BINOM.INV\",\r\n        \"_xlfn.BITAND\": \"BITAND\",\r\n        \"_xlfn.BITLSHIFT\": \"BITLSHIFT\",\r\n        \"_xlfn.BITOR\": \"BITOR\",\r\n        \"_xlfn.BITRSHIFT\": \"BITRSHIFT\",\r\n        \"_xlfn.BITXOR\": \"BITXOR\",\r\n        \"_xlfn.CEILING.MATH\": \"CEILING.MATH\",\r\n        \"_xlfn.CEILING.PRECISE\": \"CEILING.PRECISE\",\r\n        \"_xlfn.CHISQ.DIST\": \"CHISQ.DIST\",\r\n        \"_xlfn.CHISQ.DIST.RT\": \"CHISQ.DIST.RT\",\r\n        \"_xlfn.CHISQ.INV\": \"CHISQ.INV\",\r\n        \"_xlfn.CHISQ.INV.RT\": \"CHISQ.INV.RT\",\r\n        \"_xlfn.CHISQ.TEST\": \"CHISQ.TEST\",\r\n        \"_xlfn.COMBINA\": \"COMBINA\",\r\n        \"_xlfn.CONFIDENCE.NORM\": \"CONFIDENCE.NORM\",\r\n        \"_xlfn.CONFIDENCE.T\": \"CONFIDENCE.T\",\r\n        \"_xlfn.COT\": \"COT\",\r\n        \"_xlfn.COTH\": \"COTH\",\r\n        \"_xlfn.COUNTIFS\": \"COUNTIFS\",\r\n        \"_xlfn.COVARIANCE.P\": \"COVARIANCE.P\",\r\n        \"_xlfn.COVARIANCE.S\": \"COVARIANCE.S\",\r\n        \"_xlfn.CSC\": \"CSC\",\r\n        \"_xlfn.CSCH\": \"CSCH\",\r\n        \"_xlfn.DAYS\": \"DAYS\",\r\n        \"_xlfn.DECIMAL\": \"DECIMAL\",\r\n        \"_xlfn.ECMA.CEILING\": \"ECMA.CEILING\",\r\n        \"_xlfn.ERF.PRECISE\": \"ERF.PRECISE\",\r\n        \"_xlfn.ERFC.PRECISE\": \"ERFC.PRECISE\",\r\n        \"_xlfn.EXPON.DIST\": \"EXPON.DIST\",\r\n        \"_xlfn.F.DIST\": \"F.DIST\",\r\n        \"_xlfn.F.DIST.RT\": \"F.DIST.RT\",\r\n        \"_xlfn.F.INV\": \"F.INV\",\r\n        \"_xlfn.F.INV.RT\": \"F.INV.RT\",\r\n        \"_xlfn.F.TEST\": \"F.TEST\",\r\n        \"_xlfn.FILTERXML\": \"FILTERXML\",\r\n        \"_xlfn.FLOOR.MATH\": \"FLOOR.MATH\",\r\n        \"_xlfn.FLOOR.PRECISE\": \"FLOOR.PRECISE\",\r\n        \"_xlfn.FORMULATEXT\": \"FORMULATEXT\",\r\n        \"_xlfn.GAMMA\": \"GAMMA\",\r\n        \"_xlfn.GAMMA.DIST\": \"GAMMA.DIST\",\r\n        \"_xlfn.GAMMA.INV\": \"GAMMA.INV\",\r\n        \"_xlfn.GAMMALN.PRECISE\": \"GAMMALN.PRECISE\",\r\n        \"_xlfn.GAUSS\": \"GAUSS\",\r\n        \"_xlfn.HYPGEOM.DIST\": \"HYPGEOM.DIST\",\r\n        \"_xlfn.IFNA\": \"IFNA\",\r\n        \"_xlfn.IFERROR\": \"IFERROR\",\r\n        \"_xlfn.IMCOSH\": \"IMCOSH\",\r\n        \"_xlfn.IMCOT\": \"IMCOT\",\r\n        \"_xlfn.IMCSC\": \"IMCSC\",\r\n        \"_xlfn.IMCSCH\": \"IMCSCH\",\r\n        \"_xlfn.IMSEC\": \"IMSEC\",\r\n        \"_xlfn.IMSECH\": \"IMSECH\",\r\n        \"_xlfn.IMSINH\": \"IMSINH\",\r\n        \"_xlfn.IMTAN\": \"IMTAN\",\r\n        \"_xlfn.ISFORMULA\": \"ISFORMULA\",\r\n        \"_xlfn.ISO.CEILING\": \"ISO.CEILING\",\r\n        \"_xlfn.ISOWEEKNUM\": \"ISOWEEKNUM\",\r\n        \"_xlfn.LOGNORM.DIST\": \"LOGNORM.DIST\",\r\n        \"_xlfn.LOGNORM.INV\": \"LOGNORM.INV\",\r\n        \"_xlfn.MODE.MULT\": \"MODE.MULT\",\r\n        \"_xlfn.MODE.SNGL\": \"MODE.SNGL\",\r\n        \"_xlfn.MUNIT\": \"MUNIT\",\r\n        \"_xlfn.NEGBINOM.DIST\": \"NEGBINOM.DIST\",\r\n        \"_xlfn.NETWORKDAYS.INTL\": \"NETWORKDAYS.INTL\",\r\n        \"_xlfn.NIGBINOM\": \"NIGBINOM\",\r\n        \"_xlfn.NORM.DIST\": \"NORM.DIST\",\r\n        \"_xlfn.NORM.INV\": \"NORM.INV\",\r\n        \"_xlfn.NORM.S.DIST\": \"NORM.S.DIST\",\r\n        \"_xlfn.NORM.S.INV\": \"NORM.S.INV\",\r\n        \"_xlfn.NUMBERVALUE\": \"NUMBERVALUE\",\r\n        \"_xlfn.PDURATION\": \"PDURATION\",\r\n        \"_xlfn.PERCENTILE.EXC\": \"PERCENTILE.EXC\",\r\n        \"_xlfn.PERCENTILE.INC\": \"PERCENTILE.INC\",\r\n        \"_xlfn.PERCENTRANK.EXC\": \"PERCENTRANK.EXC\",\r\n        \"_xlfn.PERCENTRANK.INC\": \"PERCENTRANK.INC\",\r\n        \"_xlfn.PERMUTATIONA\": \"PERMUTATIONA\",\r\n        \"_xlfn.PHI\": \"PHI\",\r\n        \"_xlfn.POISSON.DIST\": \"POISSON.DIST\",\r\n        \"_xlfn.QUARTILE.EXC\": \"QUARTILE.EXC\",\r\n        \"_xlfn.QUARTILE.INC\": \"QUARTILE.INC\",\r\n        \"_xlfn.QUERYSTRING\": \"QUERYSTRING\",\r\n        \"_xlfn.RANK.AVG\": \"RANK.AVG\",\r\n        \"_xlfn.RANK.EQ\": \"RANK.EQ\",\r\n        \"_xlfn.RRI\": \"RRI\",\r\n        \"_xlfn.SEC\": \"SEC\",\r\n        \"_xlfn.SECH\": \"SECH\",\r\n        \"_xlfn.SHEET\": \"SHEET\",\r\n        \"_xlfn.SHEETS\": \"SHEETS\",\r\n        \"_xlfn.SKEW.P\": \"SKEW.P\",\r\n        \"_xlfn.STDEV.P\": \"STDEV.P\",\r\n        \"_xlfn.STDEV.S\": \"STDEV.S\",\r\n        \"_xlfn.SUMIFS\": \"SUMIFS\",\r\n        \"_xlfn.T.DIST\": \"T.DIST\",\r\n        \"_xlfn.T.DIST.2T\": \"T.DIST.2T\",\r\n        \"_xlfn.T.DIST.RT\": \"T.DIST.RT\",\r\n        \"_xlfn.T.INV\": \"T.INV\",\r\n        \"_xlfn.T.INV.2T\": \"T.INV.2T\",\r\n        \"_xlfn.T.TEST\": \"T.TEST\",\r\n        \"_xlfn.UNICHAR\": \"UNICHAR\",\r\n        \"_xlfn.UNICODE\": \"UNICODE\",\r\n        \"_xlfn.VAR.P\": \"VAR.P\",\r\n        \"_xlfn.VAR.S\": \"VAR.S\",\r\n        \"_xlfn.WEBSERVICE\": \"WEBSERVICE\",\r\n        \"_xlfn.WEIBULL.DIST\": \"WEIBULL.DIST\",\r\n        \"_xlfn.WORKDAY.INTL\": \"WORKDAY.INTL\",\r\n        \"_xlfn.XOR\": \"XOR\",\r\n        \"_xlfn.Z.TEST\": \"Z.TEST\"\r\n    };\r\n\r\n    var strs = {}; // shared strings\r\n    var _ssfopts = {}; // spreadsheet formatting options\r\n\r\n    RELS.WS = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\";\r\n\r\n    function get_sst_id(sst, str) {\r\n        for (var i = 0, len = sst.length; i < len; ++i) if (sst[i].t === str) { sst.Count++; return i; }\r\n        sst[len] = { t: str }; sst.Count++; sst.Unique++; return len;\r\n    }\r\n\r\n    function get_cell_style(styles, cell, opts) {\r\n        if (typeof style_builder != 'undefined') {\r\n            if (/^\\d+$/.exec(cell.s)) { return cell.s }  // if its already an integer index, let it be\r\n            if (cell.s && (cell.s == +cell.s)) { return cell.s }  // if its already an integer index, let it be\r\n            var s = cell.s || {};\r\n            if (cell.z) s.numFmt = cell.z;\r\n            return style_builder.addStyle(s);\r\n        }\r\n        else {\r\n            var z = opts.revssf[cell.z != null ? cell.z : \"General\"];\r\n            for (var i = 0, len = styles.length; i != len; ++i) if (styles[i].numFmtId === z) return i;\r\n            styles[len] = {\r\n                numFmtId: z,\r\n                fontId: 0,\r\n                fillId: 0,\r\n                borderId: 0,\r\n                xfId: 0,\r\n                applyNumberFormat: 1\r\n            };\r\n            return len;\r\n        }\r\n    }\r\n\r\n    function get_cell_style_csf(cellXf) {\r\n\r\n        if (cellXf) {\r\n\r\n            var s = {}\r\n\r\n            if (typeof cellXf.numFmtId != undefined) {\r\n                s.numFmt = SSF._table[cellXf.numFmtId];\r\n            }\r\n\r\n            if (cellXf.fillId) {\r\n                s.fill = styles.Fills[cellXf.fillId];\r\n            }\r\n\r\n            if (cellXf.fontId) {\r\n                s.font = styles.Fonts[cellXf.fontId];\r\n            }\r\n            if (cellXf.borderId) {\r\n                s.border = styles.Borders[cellXf.borderId];\r\n            }\r\n            if (cellXf.applyAlignment == 1) {\r\n                s.alignment = cellXf.alignment;\r\n            }\r\n\r\n\r\n            return JSON.parse(JSON.stringify(s));\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function safe_format(p, fmtid, fillid, opts) {\r\n        try {\r\n            if (p.t === 'e') p.w = p.w || BErr[p.v];\r\n            else if (fmtid === 0) {\r\n                if (p.t === 'n') {\r\n                    if ((p.v | 0) === p.v) p.w = SSF._general_int(p.v, _ssfopts);\r\n                    else p.w = SSF._general_num(p.v, _ssfopts);\r\n                }\r\n                else if (p.t === 'd') {\r\n                    var dd = datenum(p.v);\r\n                    if ((dd | 0) === dd) p.w = SSF._general_int(dd, _ssfopts);\r\n                    else p.w = SSF._general_num(dd, _ssfopts);\r\n                }\r\n                else if (p.v === undefined) return \"\";\r\n                else p.w = SSF._general(p.v, _ssfopts);\r\n            }\r\n            else if (p.t === 'd') p.w = SSF.format(fmtid, datenum(p.v), _ssfopts);\r\n            else p.w = SSF.format(fmtid, p.v, _ssfopts);\r\n            if (opts.cellNF) p.z = SSF._table[fmtid];\r\n        } catch (e) { if (opts.WTF) throw e; }\r\n    }\r\n    function parse_ws_xml_dim(ws, s) {\r\n        var d = safe_decode_range(s);\r\n        if (d.s.r <= d.e.r && d.s.c <= d.e.c && d.s.r >= 0 && d.s.c >= 0) ws[\"!ref\"] = encode_range(d);\r\n    }\r\n    var mergecregex = /<mergeCell ref=\"[A-Z0-9:]+\"\\s*\\/>/g;\r\n    var sheetdataregex = /<(?:\\w+:)?sheetData>([^\\u2603]*)<\\/(?:\\w+:)?sheetData>/;\r\n    var hlinkregex = /<hyperlink[^>]*\\/>/g;\r\n    var dimregex = /\"(\\w*:\\w*)\"/;\r\n    var colregex = /<col[^>]*\\/>/g;\r\n    /* 18.3 Worksheets */\r\n    function parse_ws_xml(data, opts, rels) {\r\n        if (!data) return data;\r\n        /* 18.3.1.99 worksheet CT_Worksheet */\r\n        var s = {};\r\n\r\n        /* 18.3.1.35 dimension CT_SheetDimension ? */\r\n        var ridx = data.indexOf(\"<dimension\");\r\n        if (ridx > 0) {\r\n            var ref = data.substr(ridx, 50).match(dimregex);\r\n            if (ref != null) parse_ws_xml_dim(s, ref[1]);\r\n        }\r\n\r\n        /* 18.3.1.55 mergeCells CT_MergeCells */\r\n        var mergecells = [];\r\n        if (data.indexOf(\"</mergeCells>\") !== -1) {\r\n            var merges = data.match(mergecregex);\r\n            for (ridx = 0; ridx != merges.length; ++ridx)\r\n                mergecells[ridx] = safe_decode_range(merges[ridx].substr(merges[ridx].indexOf(\"\\\"\") + 1));\r\n        }\r\n\r\n        /* 18.3.1.17 cols CT_Cols */\r\n        var columns = [];\r\n        if (opts.cellStyles && data.indexOf(\"</cols>\") !== -1) {\r\n            /* 18.3.1.13 col CT_Col */\r\n            var cols = data.match(colregex);\r\n            parse_ws_xml_cols(columns, cols);\r\n        }\r\n\r\n        var refguess = { s: { r: 1000000, c: 1000000 }, e: { r: 0, c: 0 } };\r\n\r\n        /* 18.3.1.80 sheetData CT_SheetData ? */\r\n        var mtch = data.match(sheetdataregex);\r\n        if (mtch) parse_ws_xml_data(mtch[1], s, opts, refguess);\r\n\r\n        /* 18.3.1.48 hyperlinks CT_Hyperlinks */\r\n        if (data.indexOf(\"</hyperlinks>\") !== -1) parse_ws_xml_hlinks(s, data.match(hlinkregex), rels);\r\n\r\n        if (!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\r\n        if (opts.sheetRows > 0 && s[\"!ref\"]) {\r\n            var tmpref = safe_decode_range(s[\"!ref\"]);\r\n            if (opts.sheetRows < +tmpref.e.r) {\r\n                tmpref.e.r = opts.sheetRows - 1;\r\n                if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\r\n                if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\r\n                if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\r\n                if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\r\n                s[\"!fullref\"] = s[\"!ref\"];\r\n                s[\"!ref\"] = encode_range(tmpref);\r\n            }\r\n        }\r\n        if (mergecells.length > 0) s[\"!merges\"] = mergecells;\r\n        if (columns.length > 0) s[\"!cols\"] = columns;\r\n        return s;\r\n    }\r\n\r\n    function write_ws_xml_merges(merges) {\r\n        if (merges.length == 0) return \"\";\r\n        var o = '<mergeCells count=\"' + merges.length + '\">';\r\n        for (var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\r\n        return o + '</mergeCells>';\r\n    }\r\n\r\n    function parse_ws_xml_hlinks(s, data, rels) {\r\n        for (var i = 0; i != data.length; ++i) {\r\n            var val = parsexmltag(data[i], true);\r\n            if (!val.ref) return;\r\n            var rel = rels ? rels['!id'][val.id] : null;\r\n            if (rel) {\r\n                val.Target = rel.Target;\r\n                if (val.location) val.Target += \"#\" + val.location;\r\n                val.Rel = rel;\r\n            } else {\r\n                val.Target = val.location;\r\n                rel = { Target: val.location, TargetMode: 'Internal' };\r\n                val.Rel = rel;\r\n            }\r\n            var rng = safe_decode_range(val.ref);\r\n            for (var R = rng.s.r; R <= rng.e.r; ++R) for (var C = rng.s.c; C <= rng.e.c; ++C) {\r\n                var addr = encode_cell({ c: C, r: R });\r\n                if (!s[addr]) s[addr] = { t: \"stub\", v: undefined };\r\n                s[addr].l = val;\r\n            }\r\n        }\r\n    }\r\n\r\n    function parse_ws_xml_cols(columns, cols) {\r\n        var seencol = false;\r\n        for (var coli = 0; coli != cols.length; ++coli) {\r\n            var coll = parsexmltag(cols[coli], true);\r\n            var colm = parseInt(coll.min, 10) - 1, colM = parseInt(coll.max, 10) - 1;\r\n            delete coll.min; delete coll.max;\r\n            if (!seencol && coll.width) { seencol = true; find_mdw(+coll.width, coll); }\r\n            if (coll.width) {\r\n                coll.wpx = width2px(+coll.width);\r\n                coll.wch = px2char(coll.wpx);\r\n                coll.MDW = MDW;\r\n            }\r\n            while (colm <= colM) columns[colm++] = coll;\r\n        }\r\n    }\r\n\r\n    function write_ws_xml_cols(ws, cols) {\r\n        var o = [\"<cols>\"], col, width;\r\n        for (var i = 0; i != cols.length; ++i) {\r\n            if (!(col = cols[i])) continue;\r\n            var p = { min: i + 1, max: i + 1 };\r\n            /* wch (chars), wpx (pixels) */\r\n            width = -1;\r\n            if (col.wpx) width = px2char(col.wpx);\r\n            else if (col.wch) width = col.wch;\r\n            if (width > -1) { p.width = char2width(width); p.customWidth = 1; }\r\n            o[o.length] = (writextag('col', null, p));\r\n        }\r\n        o[o.length] = \"</cols>\";\r\n        return o.join(\"\");\r\n    }\r\n\r\n    function write_ws_xml_cell(cell, ref, ws, opts, idx, wb) {\r\n        if (cell.v === undefined && cell.s === undefined) return \"\";\r\n        var vv = \"\";\r\n        var oldt = cell.t, oldv = cell.v;\r\n        switch (cell.t) {\r\n            case 'b': vv = cell.v ? \"1\" : \"0\"; break;\r\n            case 'n': vv = '' + cell.v; break;\r\n            case 'e': vv = BErr[cell.v]; break;\r\n            case 'd':\r\n                if (opts.cellDates) vv = new Date(cell.v).toISOString();\r\n                else {\r\n                    cell.t = 'n';\r\n                    vv = '' + (cell.v = datenum(cell.v));\r\n                    if (typeof cell.z === 'undefined') cell.z = SSF._table[14];\r\n                }\r\n                break;\r\n            default: vv = cell.v; break;\r\n        }\r\n        var v = writetag('v', escapexml(vv)), o = { r: ref };\r\n        /* TODO: cell style */\r\n        var os = get_cell_style(opts.cellXfs, cell, opts);\r\n        if (os !== 0) o.s = os;\r\n        switch (cell.t) {\r\n            case 'n': break;\r\n            case 'd': o.t = \"d\"; break;\r\n            case 'b': o.t = \"b\"; break;\r\n            case 'e': o.t = \"e\"; break;\r\n            default:\r\n                if (opts.bookSST) {\r\n                    v = writetag('v', '' + get_sst_id(opts.Strings, cell.v));\r\n                    o.t = \"s\"; break;\r\n                }\r\n                o.t = \"str\"; break;\r\n        }\r\n        if (cell.t != oldt) { cell.t = oldt; cell.v = oldv; }\r\n        return writextag('c', v, o);\r\n    }\r\n\r\n    var parse_ws_xml_data = (function parse_ws_xml_data_factory() {\r\n        var cellregex = /<(?:\\w+:)?c[ >]/, rowregex = /<\\/(?:\\w+:)?row>/;\r\n        var rregex = /r=[\"']([^\"']*)[\"']/, isregex = /<is>([\\S\\s]*?)<\\/is>/;\r\n        var match_v = matchtag(\"v\"), match_f = matchtag(\"f\");\r\n\r\n        return function parse_ws_xml_data(sdata, s, opts, guess) {\r\n            var ri = 0, x = \"\", cells = [], cref = [], idx = 0, i = 0, cc = 0, d = \"\", p;\r\n            var tag, tagr = 0, tagc = 0;\r\n            var sstr;\r\n            var fmtid = 0, fillid = 0, do_format = Array.isArray(styles.CellXf), cf;\r\n            for (var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\r\n                x = marr[mt].trim();\r\n                var xlen = x.length;\r\n                if (xlen === 0) continue;\r\n\r\n                /* 18.3.1.73 row CT_Row */\r\n                for (ri = 0; ri < xlen; ++ri) if (x.charCodeAt(ri) === 62) break; ++ri;\r\n                tag = parsexmltag(x.substr(0, ri), true);\r\n                /* SpreadSheetGear uses implicit r/c */\r\n                tagr = typeof tag.r !== 'undefined' ? parseInt(tag.r, 10) : tagr + 1; tagc = -1;\r\n                if (opts.sheetRows && opts.sheetRows < tagr) continue;\r\n                if (guess.s.r > tagr - 1) guess.s.r = tagr - 1;\r\n                if (guess.e.r < tagr - 1) guess.e.r = tagr - 1;\r\n\r\n                /* 18.3.1.4 c CT_Cell */\r\n                cells = x.substr(ri).split(cellregex);\r\n                for (ri = typeof tag.r === 'undefined' ? 0 : 1; ri != cells.length; ++ri) {\r\n                    x = cells[ri].trim();\r\n                    if (x.length === 0) continue;\r\n                    cref = x.match(rregex); idx = ri; i = 0; cc = 0;\r\n                    x = \"<c \" + (x.substr(0, 1) == \"<\" ? \">\" : \"\") + x;\r\n                    if (cref !== null && cref.length === 2) {\r\n                        idx = 0; d = cref[1];\r\n                        for (i = 0; i != d.length; ++i) {\r\n                            if ((cc = d.charCodeAt(i) - 64) < 1 || cc > 26) break;\r\n                            idx = 26 * idx + cc;\r\n                        }\r\n                        --idx;\r\n                        tagc = idx;\r\n                    } else ++tagc;\r\n                    for (i = 0; i != x.length; ++i) if (x.charCodeAt(i) === 62) break; ++i;\r\n                    tag = parsexmltag(x.substr(0, i), true);\r\n                    if (!tag.r) tag.r = utils.encode_cell({ r: tagr - 1, c: tagc });\r\n                    d = x.substr(i);\r\n                    p = { t: \"\" };\r\n\r\n                    if ((cref = d.match(match_v)) !== null && cref[1] !== '') p.v = unescapexml(cref[1]);\r\n                    if (opts.cellFormula && (cref = d.match(match_f)) !== null) p.f = unescapexml(cref[1]);\r\n\r\n                    /* SCHEMA IS ACTUALLY INCORRECT HERE.  IF A CELL HAS NO T, EMIT \"\" */\r\n                    if (tag.t === undefined && tag.s === undefined && p.v === undefined) {\r\n                        if (!opts.sheetStubs) continue;\r\n                        p.t = \"stub\";\r\n                    }\r\n                    else p.t = tag.t || \"n\";\r\n                    if (guess.s.c > idx) guess.s.c = idx;\r\n                    if (guess.e.c < idx) guess.e.c = idx;\r\n                    /* 18.18.11 t ST_CellType */\r\n                    switch (p.t) {\r\n                        case 'n':\r\n                            p.v = parseFloat(p.v);\r\n                            if (isNaN(p.v)) p.v = \"\" // we don't want NaN if p.v is null\r\n                            break;\r\n                        case 's':\r\n                            sstr = strs[parseInt(p.v, 10)];\r\n                            p.v = sstr.t;\r\n                            p.r = sstr.r;\r\n                            if (opts.cellHTML) p.h = sstr.h;\r\n                            break;\r\n                        case 'str':\r\n                            p.t = \"s\";\r\n                            p.v = (p.v != null) ? utf8read(p.v) : '';\r\n                            if (opts.cellHTML) p.h = p.v;\r\n                            break;\r\n                        case 'inlineStr':\r\n                            cref = d.match(isregex);\r\n                            p.t = 's';\r\n                            if (cref !== null) { sstr = parse_si(cref[1]); p.v = sstr.t; } else p.v = \"\";\r\n                            break; // inline string\r\n                        case 'b': p.v = parsexmlbool(p.v); break;\r\n                        case 'd':\r\n                            if (!opts.cellDates) { p.v = datenum(p.v); p.t = 'n'; }\r\n                            break;\r\n                        /* error string in .v, number in .v */\r\n                        case 'e': p.w = p.v; p.v = RBErr[p.v]; break;\r\n                    }\r\n                    /* formatting */\r\n                    fmtid = fillid = 0;\r\n                    if (do_format && tag.s !== undefined) {\r\n                        cf = styles.CellXf[tag.s];\r\n                        if (opts.cellStyles) {\r\n                            p.s = get_cell_style_csf(cf)\r\n                        }\r\n                        if (cf != null) {\r\n                            if (cf.numFmtId != null) fmtid = cf.numFmtId;\r\n                            if (opts.cellStyles && cf.fillId != null) fillid = cf.fillId;\r\n                        }\r\n                    }\r\n                    safe_format(p, fmtid, fillid, opts);\r\n                    s[tag.r] = p;\r\n                }\r\n            }\r\n        };\r\n    })();\r\n\r\n    function write_ws_xml_data(ws, opts, idx, wb) {\r\n        var o = [], r = [], range = safe_decode_range(ws['!ref']), cell, ref, rr = \"\", cols = [], R, C;\r\n        for (C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\r\n        for (R = range.s.r; R <= range.e.r; ++R) {\r\n            r = [];\r\n            rr = encode_row(R);\r\n            for (C = range.s.c; C <= range.e.c; ++C) {\r\n                ref = cols[C] + rr;\r\n                if (ws[ref] === undefined) continue;\r\n                if ((cell = write_ws_xml_cell(ws[ref], ref, ws, opts, idx, wb)) != null) r.push(cell);\r\n            }\r\n            if (r.length > 0) o[o.length] = (writextag('row', r.join(\"\"), { r: rr }));\r\n        }\r\n        return o.join(\"\");\r\n    }\r\n\r\n    var WS_XML_ROOT = writextag('worksheet', null, {\r\n        'xmlns': XMLNS.main[0],\r\n        'xmlns:r': XMLNS.r\r\n    });\r\n\r\n    function write_ws_xml(idx, opts, wb) {\r\n        var o = [XML_HEADER, WS_XML_ROOT];\r\n        var s = wb.SheetNames[idx], sidx = 0, rdata = \"\";\r\n        var ws = wb.Sheets[s];\r\n        if (ws === undefined) ws = {};\r\n        var ref = ws['!ref']; if (ref === undefined) ref = 'A1';\r\n        o[o.length] = (writextag('dimension', null, { 'ref': ref }));\r\n\r\n        if (ws['!cols'] !== undefined && ws['!cols'].length > 0) o[o.length] = (write_ws_xml_cols(ws, ws['!cols']));\r\n        o[sidx = o.length] = '<sheetData/>';\r\n        if (ws['!ref'] !== undefined) {\r\n            rdata = write_ws_xml_data(ws, opts, idx, wb);\r\n            if (rdata.length > 0) o[o.length] = (rdata);\r\n        }\r\n        if (o.length > sidx + 1) { o[o.length] = ('</sheetData>'); o[sidx] = o[sidx].replace(\"/>\", \">\"); }\r\n\r\n        if (ws['!merges'] !== undefined && ws['!merges'].length > 0) o[o.length] = (write_ws_xml_merges(ws['!merges']));\r\n\r\n        if (o.length > 2) { o[o.length] = ('</worksheet>'); o[1] = o[1].replace(\"/>\", \">\"); }\r\n        return o.join(\"\");\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.718 BrtRowHdr */\r\n    function parse_BrtRowHdr(data, length) {\r\n        var z = [];\r\n        z.r = data.read_shift(4);\r\n        data.l += length - 4;\r\n        return z;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.812 BrtWsDim */\r\n    var parse_BrtWsDim = parse_UncheckedRfX;\r\n    var write_BrtWsDim = write_UncheckedRfX;\r\n\r\n    /* [MS-XLSB] 2.4.815 BrtWsProp */\r\n    function parse_BrtWsProp(data, length) {\r\n        var z = {};\r\n        /* TODO: pull flags */\r\n        data.l += 19;\r\n        z.name = parse_XLSBCodeName(data, length - 19);\r\n        return z;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.303 BrtCellBlank */\r\n    function parse_BrtCellBlank(data, length) {\r\n        var cell = parse_XLSBCell(data);\r\n        return [cell];\r\n    }\r\n    function write_BrtCellBlank(cell, val, o) {\r\n        if (o == null) o = new_buf(8);\r\n        return write_XLSBCell(val, o);\r\n    }\r\n\r\n\r\n    /* [MS-XLSB] 2.4.304 BrtCellBool */\r\n    function parse_BrtCellBool(data, length) {\r\n        var cell = parse_XLSBCell(data);\r\n        var fBool = data.read_shift(1);\r\n        return [cell, fBool, 'b'];\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.305 BrtCellError */\r\n    function parse_BrtCellError(data, length) {\r\n        var cell = parse_XLSBCell(data);\r\n        var fBool = data.read_shift(1);\r\n        return [cell, fBool, 'e'];\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.308 BrtCellIsst */\r\n    function parse_BrtCellIsst(data, length) {\r\n        var cell = parse_XLSBCell(data);\r\n        var isst = data.read_shift(4);\r\n        return [cell, isst, 's'];\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.310 BrtCellReal */\r\n    function parse_BrtCellReal(data, length) {\r\n        var cell = parse_XLSBCell(data);\r\n        var value = parse_Xnum(data);\r\n        return [cell, value, 'n'];\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.311 BrtCellRk */\r\n    function parse_BrtCellRk(data, length) {\r\n        var cell = parse_XLSBCell(data);\r\n        var value = parse_RkNumber(data);\r\n        return [cell, value, 'n'];\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.314 BrtCellSt */\r\n    function parse_BrtCellSt(data, length) {\r\n        var cell = parse_XLSBCell(data);\r\n        var value = parse_XLWideString(data);\r\n        return [cell, value, 'str'];\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.647 BrtFmlaBool */\r\n    function parse_BrtFmlaBool(data, length, opts) {\r\n        var cell = parse_XLSBCell(data);\r\n        var value = data.read_shift(1);\r\n        var o = [cell, value, 'b'];\r\n        if (opts.cellFormula) {\r\n            var formula = parse_XLSBCellParsedFormula(data, length - 9);\r\n            o[3] = \"\"; /* TODO */\r\n        }\r\n        else data.l += length - 9;\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.648 BrtFmlaError */\r\n    function parse_BrtFmlaError(data, length, opts) {\r\n        var cell = parse_XLSBCell(data);\r\n        var value = data.read_shift(1);\r\n        var o = [cell, value, 'e'];\r\n        if (opts.cellFormula) {\r\n            var formula = parse_XLSBCellParsedFormula(data, length - 9);\r\n            o[3] = \"\"; /* TODO */\r\n        }\r\n        else data.l += length - 9;\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.649 BrtFmlaNum */\r\n    function parse_BrtFmlaNum(data, length, opts) {\r\n        var cell = parse_XLSBCell(data);\r\n        var value = parse_Xnum(data);\r\n        var o = [cell, value, 'n'];\r\n        if (opts.cellFormula) {\r\n            var formula = parse_XLSBCellParsedFormula(data, length - 16);\r\n            o[3] = \"\"; /* TODO */\r\n        }\r\n        else data.l += length - 16;\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.650 BrtFmlaString */\r\n    function parse_BrtFmlaString(data, length, opts) {\r\n        var start = data.l;\r\n        var cell = parse_XLSBCell(data);\r\n        var value = parse_XLWideString(data);\r\n        var o = [cell, value, 'str'];\r\n        if (opts.cellFormula) {\r\n            var formula = parse_XLSBCellParsedFormula(data, start + length - data.l);\r\n        }\r\n        else data.l = start + length;\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.676 BrtMergeCell */\r\n    var parse_BrtMergeCell = parse_UncheckedRfX;\r\n\r\n    /* [MS-XLSB] 2.4.656 BrtHLink */\r\n    function parse_BrtHLink(data, length, opts) {\r\n        var end = data.l + length;\r\n        var rfx = parse_UncheckedRfX(data, 16);\r\n        var relId = parse_XLNullableWideString(data);\r\n        var loc = parse_XLWideString(data);\r\n        var tooltip = parse_XLWideString(data);\r\n        var display = parse_XLWideString(data);\r\n        data.l = end;\r\n        return { rfx: rfx, relId: relId, loc: loc, tooltip: tooltip, display: display };\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.7.61 Worksheet */\r\n    function parse_ws_bin(data, opts, rels) {\r\n        if (!data) return data;\r\n        if (!rels) rels = { '!id': {} };\r\n        var s = {};\r\n\r\n        var ref;\r\n        var refguess = { s: { r: 1000000, c: 1000000 }, e: { r: 0, c: 0 } };\r\n\r\n        var pass = false, end = false;\r\n        var row, p, cf, R, C, addr, sstr, rr;\r\n        var mergecells = [];\r\n        recordhopper(data, function ws_parse(val, R) {\r\n            if (end) return;\r\n            switch (R.n) {\r\n                case 'BrtWsDim': ref = val; break;\r\n                case 'BrtRowHdr':\r\n                    row = val;\r\n                    if (opts.sheetRows && opts.sheetRows <= row.r) end = true;\r\n                    rr = encode_row(row.r);\r\n                    break;\r\n\r\n                case 'BrtFmlaBool':\r\n                case 'BrtFmlaError':\r\n                case 'BrtFmlaNum':\r\n                case 'BrtFmlaString':\r\n                case 'BrtCellBool':\r\n                case 'BrtCellError':\r\n                case 'BrtCellIsst':\r\n                case 'BrtCellReal':\r\n                case 'BrtCellRk':\r\n                case 'BrtCellSt':\r\n                    p = { t: val[2] };\r\n                    switch (val[2]) {\r\n                        case 'n': p.v = val[1]; break;\r\n                        case 's': sstr = strs[val[1]]; p.v = sstr.t; p.r = sstr.r; break;\r\n                        case 'b': p.v = val[1] ? true : false; break;\r\n                        case 'e': p.v = val[1]; p.w = BErr[p.v]; break;\r\n                        case 'str': p.t = 's'; p.v = utf8read(val[1]); break;\r\n                    }\r\n                    if (opts.cellFormula && val.length > 3) p.f = val[3];\r\n                    if ((cf = styles.CellXf[val[0].iStyleRef])) safe_format(p, cf.ifmt, null, opts);\r\n                    s[encode_col(C = val[0].c) + rr] = p;\r\n                    if (refguess.s.r > row.r) refguess.s.r = row.r;\r\n                    if (refguess.s.c > C) refguess.s.c = C;\r\n                    if (refguess.e.r < row.r) refguess.e.r = row.r;\r\n                    if (refguess.e.c < C) refguess.e.c = C;\r\n                    break;\r\n\r\n                case 'BrtCellBlank': if (!opts.sheetStubs) break;\r\n                    p = { t: 's', v: undefined };\r\n                    s[encode_col(C = val[0].c) + rr] = p;\r\n                    if (refguess.s.r > row.r) refguess.s.r = row.r;\r\n                    if (refguess.s.c > C) refguess.s.c = C;\r\n                    if (refguess.e.r < row.r) refguess.e.r = row.r;\r\n                    if (refguess.e.c < C) refguess.e.c = C;\r\n                    break;\r\n\r\n                /* Merge Cells */\r\n                case 'BrtBeginMergeCells': break;\r\n                case 'BrtEndMergeCells': break;\r\n                case 'BrtMergeCell': mergecells.push(val); break;\r\n\r\n                case 'BrtHLink':\r\n                    var rel = rels['!id'][val.relId];\r\n                    if (rel) {\r\n                        val.Target = rel.Target;\r\n                        if (val.loc) val.Target += \"#\" + val.loc;\r\n                        val.Rel = rel;\r\n                    }\r\n                    for (R = val.rfx.s.r; R <= val.rfx.e.r; ++R) for (C = val.rfx.s.c; C <= val.rfx.e.c; ++C) {\r\n                        addr = encode_cell({ c: C, r: R });\r\n                        if (!s[addr]) s[addr] = { t: 's', v: undefined };\r\n                        s[addr].l = val;\r\n                    }\r\n                    break;\r\n\r\n                case 'BrtArrFmla': break; // TODO\r\n                case 'BrtShrFmla': break; // TODO\r\n                case 'BrtBeginSheet': break;\r\n                case 'BrtWsProp': break; // TODO\r\n                case 'BrtSheetCalcProp': break; // TODO\r\n                case 'BrtBeginWsViews': break; // TODO\r\n                case 'BrtBeginWsView': break; // TODO\r\n                case 'BrtPane': break; // TODO\r\n                case 'BrtSel': break; // TODO\r\n                case 'BrtEndWsView': break; // TODO\r\n                case 'BrtEndWsViews': break; // TODO\r\n                case 'BrtACBegin': break; // TODO\r\n                case 'BrtRwDescent': break; // TODO\r\n                case 'BrtACEnd': break; // TODO\r\n                case 'BrtWsFmtInfoEx14': break; // TODO\r\n                case 'BrtWsFmtInfo': break; // TODO\r\n                case 'BrtBeginColInfos': break; // TODO\r\n                case 'BrtColInfo': break; // TODO\r\n                case 'BrtEndColInfos': break; // TODO\r\n                case 'BrtBeginSheetData': break; // TODO\r\n                case 'BrtEndSheetData': break; // TODO\r\n                case 'BrtSheetProtection': break; // TODO\r\n                case 'BrtPrintOptions': break; // TODO\r\n                case 'BrtMargins': break; // TODO\r\n                case 'BrtPageSetup': break; // TODO\r\n                case 'BrtFRTBegin': pass = true; break;\r\n                case 'BrtFRTEnd': pass = false; break;\r\n                case 'BrtEndSheet': break; // TODO\r\n                case 'BrtDrawing': break; // TODO\r\n                case 'BrtLegacyDrawing': break; // TODO\r\n                case 'BrtLegacyDrawingHF': break; // TODO\r\n                case 'BrtPhoneticInfo': break; // TODO\r\n                case 'BrtBeginHeaderFooter': break; // TODO\r\n                case 'BrtEndHeaderFooter': break; // TODO\r\n                case 'BrtBrk': break; // TODO\r\n                case 'BrtBeginRwBrk': break; // TODO\r\n                case 'BrtEndRwBrk': break; // TODO\r\n                case 'BrtBeginColBrk': break; // TODO\r\n                case 'BrtEndColBrk': break; // TODO\r\n                case 'BrtBeginUserShViews': break; // TODO\r\n                case 'BrtBeginUserShView': break; // TODO\r\n                case 'BrtEndUserShView': break; // TODO\r\n                case 'BrtEndUserShViews': break; // TODO\r\n                case 'BrtBkHim': break; // TODO\r\n                case 'BrtBeginOleObjects': break; // TODO\r\n                case 'BrtOleObject': break; // TODO\r\n                case 'BrtEndOleObjects': break; // TODO\r\n                case 'BrtBeginListParts': break; // TODO\r\n                case 'BrtListPart': break; // TODO\r\n                case 'BrtEndListParts': break; // TODO\r\n                case 'BrtBeginSortState': break; // TODO\r\n                case 'BrtBeginSortCond': break; // TODO\r\n                case 'BrtEndSortCond': break; // TODO\r\n                case 'BrtEndSortState': break; // TODO\r\n                case 'BrtBeginConditionalFormatting': break; // TODO\r\n                case 'BrtEndConditionalFormatting': break; // TODO\r\n                case 'BrtBeginCFRule': break; // TODO\r\n                case 'BrtEndCFRule': break; // TODO\r\n                case 'BrtBeginDVals': break; // TODO\r\n                case 'BrtDVal': break; // TODO\r\n                case 'BrtEndDVals': break; // TODO\r\n                case 'BrtRangeProtection': break; // TODO\r\n                case 'BrtBeginDCon': break; // TODO\r\n                case 'BrtEndDCon': break; // TODO\r\n                case 'BrtBeginDRefs': break;\r\n                case 'BrtDRef': break;\r\n                case 'BrtEndDRefs': break;\r\n\r\n                /* ActiveX */\r\n                case 'BrtBeginActiveXControls': break;\r\n                case 'BrtActiveX': break;\r\n                case 'BrtEndActiveXControls': break;\r\n\r\n                /* AutoFilter */\r\n                case 'BrtBeginAFilter': break;\r\n                case 'BrtEndAFilter': break;\r\n                case 'BrtBeginFilterColumn': break;\r\n                case 'BrtBeginFilters': break;\r\n                case 'BrtFilter': break;\r\n                case 'BrtEndFilters': break;\r\n                case 'BrtEndFilterColumn': break;\r\n                case 'BrtDynamicFilter': break;\r\n                case 'BrtTop10Filter': break;\r\n                case 'BrtBeginCustomFilters': break;\r\n                case 'BrtCustomFilter': break;\r\n                case 'BrtEndCustomFilters': break;\r\n\r\n                /* Smart Tags */\r\n                case 'BrtBeginSmartTags': break;\r\n                case 'BrtBeginCellSmartTags': break;\r\n                case 'BrtBeginCellSmartTag': break;\r\n                case 'BrtCellSmartTagProperty': break;\r\n                case 'BrtEndCellSmartTag': break;\r\n                case 'BrtEndCellSmartTags': break;\r\n                case 'BrtEndSmartTags': break;\r\n\r\n                /* Cell Watch */\r\n                case 'BrtBeginCellWatches': break;\r\n                case 'BrtCellWatch': break;\r\n                case 'BrtEndCellWatches': break;\r\n\r\n                /* Table */\r\n                case 'BrtTable': break;\r\n\r\n                /* Ignore Cell Errors */\r\n                case 'BrtBeginCellIgnoreECs': break;\r\n                case 'BrtCellIgnoreEC': break;\r\n                case 'BrtEndCellIgnoreECs': break;\r\n\r\n                default: if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\r\n            }\r\n        }, opts);\r\n        if (!s[\"!ref\"] && (refguess.s.r < 1000000 || ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0)) s[\"!ref\"] = encode_range(ref);\r\n        if (opts.sheetRows && s[\"!ref\"]) {\r\n            var tmpref = safe_decode_range(s[\"!ref\"]);\r\n            if (opts.sheetRows < +tmpref.e.r) {\r\n                tmpref.e.r = opts.sheetRows - 1;\r\n                if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\r\n                if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\r\n                if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\r\n                if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\r\n                s[\"!fullref\"] = s[\"!ref\"];\r\n                s[\"!ref\"] = encode_range(tmpref);\r\n            }\r\n        }\r\n        if (mergecells.length > 0) s[\"!merges\"] = mergecells;\r\n        return s;\r\n    }\r\n\r\n    /* TODO: something useful -- this is a stub */\r\n    function write_ws_bin_cell(ba, cell, R, C, opts) {\r\n        if (cell.v === undefined) return \"\";\r\n        var vv = \"\";\r\n        switch (cell.t) {\r\n            case 'b': vv = cell.v ? \"1\" : \"0\"; break;\r\n            case 'n': case 'e': vv = '' + cell.v; break;\r\n            default: vv = cell.v; break;\r\n        }\r\n        var o = { r: R, c: C };\r\n        /* TODO: cell style */\r\n        o.s = get_cell_style(opts.cellXfs, cell, opts);\r\n        switch (cell.t) {\r\n            case 's': case 'str':\r\n                if (opts.bookSST) {\r\n                    vv = get_sst_id(opts.Strings, cell.v);\r\n                    o.t = \"s\"; break;\r\n                }\r\n                o.t = \"str\"; break;\r\n            case 'n': break;\r\n            case 'b': o.t = \"b\"; break;\r\n            case 'e': o.t = \"e\"; break;\r\n        }\r\n        write_record(ba, \"BrtCellBlank\", write_BrtCellBlank(cell, o));\r\n    }\r\n\r\n    function write_CELLTABLE(ba, ws, idx, opts, wb) {\r\n        var range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols = [];\r\n        write_record(ba, 'BrtBeginSheetData');\r\n        for (var R = range.s.r; R <= range.e.r; ++R) {\r\n            rr = encode_row(R);\r\n            /* [ACCELLTABLE] */\r\n            /* BrtRowHdr */\r\n            for (var C = range.s.c; C <= range.e.c; ++C) {\r\n                /* *16384CELL */\r\n                if (R === range.s.r) cols[C] = encode_col(C);\r\n                ref = cols[C] + rr;\r\n                if (!ws[ref]) continue;\r\n                /* write cell */\r\n                write_ws_bin_cell(ba, ws[ref], R, C, opts);\r\n            }\r\n        }\r\n        write_record(ba, 'BrtEndSheetData');\r\n    }\r\n\r\n    function write_ws_bin(idx, opts, wb) {\r\n        var ba = buf_array();\r\n        var s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\r\n        var r = safe_decode_range(ws['!ref'] || \"A1\");\r\n        write_record(ba, \"BrtBeginSheet\");\r\n        /* [BrtWsProp] */\r\n        write_record(ba, \"BrtWsDim\", write_BrtWsDim(r));\r\n        /* [WSVIEWS2] */\r\n        /* [WSFMTINFO] */\r\n        /* *COLINFOS */\r\n        write_CELLTABLE(ba, ws, idx, opts, wb);\r\n        /* [BrtSheetCalcProp] */\r\n        /* [[BrtSheetProtectionIso] BrtSheetProtection] */\r\n        /* *([BrtRangeProtectionIso] BrtRangeProtection) */\r\n        /* [SCENMAN] */\r\n        /* [AUTOFILTER] */\r\n        /* [SORTSTATE] */\r\n        /* [DCON] */\r\n        /* [USERSHVIEWS] */\r\n        /* [MERGECELLS] */\r\n        /* [BrtPhoneticInfo] */\r\n        /* *CONDITIONALFORMATTING */\r\n        /* [DVALS] */\r\n        /* *BrtHLink */\r\n        /* [BrtPrintOptions] */\r\n        /* [BrtMargins] */\r\n        /* [BrtPageSetup] */\r\n        /* [HEADERFOOTER] */\r\n        /* [RWBRK] */\r\n        /* [COLBRK] */\r\n        /* *BrtBigName */\r\n        /* [CELLWATCHES] */\r\n        /* [IGNOREECS] */\r\n        /* [SMARTTAGS] */\r\n        /* [BrtDrawing] */\r\n        /* [BrtLegacyDrawing] */\r\n        /* [BrtLegacyDrawingHF] */\r\n        /* [BrtBkHim] */\r\n        /* [OLEOBJECTS] */\r\n        /* [ACTIVEXCONTROLS] */\r\n        /* [WEBPUBITEMS] */\r\n        /* [LISTPARTS] */\r\n        /* FRTWORKSHEET */\r\n        write_record(ba, \"BrtEndSheet\");\r\n        return ba.end();\r\n    }\r\n    /* 18.2.28 (CT_WorkbookProtection) Defaults */\r\n    var WBPropsDef = [\r\n        ['allowRefreshQuery', '0'],\r\n        ['autoCompressPictures', '1'],\r\n        ['backupFile', '0'],\r\n        ['checkCompatibility', '0'],\r\n        ['codeName', ''],\r\n        ['date1904', '0'],\r\n        ['dateCompatibility', '1'],\r\n        //['defaultThemeVersion', '0'],\r\n        ['filterPrivacy', '0'],\r\n        ['hidePivotFieldList', '0'],\r\n        ['promptedSolutions', '0'],\r\n        ['publishItems', '0'],\r\n        ['refreshAllConnections', false],\r\n        ['saveExternalLinkValues', '1'],\r\n        ['showBorderUnselectedTables', '1'],\r\n        ['showInkAnnotation', '1'],\r\n        ['showObjects', 'all'],\r\n        ['showPivotChartFilter', '0']\r\n        //['updateLinks', 'userSet']\r\n    ];\r\n\r\n    /* 18.2.30 (CT_BookView) Defaults */\r\n    var WBViewDef = [\r\n        ['activeTab', '0'],\r\n        ['autoFilterDateGrouping', '1'],\r\n        ['firstSheet', '0'],\r\n        ['minimized', '0'],\r\n        ['showHorizontalScroll', '1'],\r\n        ['showSheetTabs', '1'],\r\n        ['showVerticalScroll', '1'],\r\n        ['tabRatio', '600'],\r\n        ['visibility', 'visible']\r\n        //window{Height,Width}, {x,y}Window\r\n    ];\r\n\r\n    /* 18.2.19 (CT_Sheet) Defaults */\r\n    var SheetDef = [\r\n        ['state', 'visible']\r\n    ];\r\n\r\n    /* 18.2.2  (CT_CalcPr) Defaults */\r\n    var CalcPrDef = [\r\n        ['calcCompleted', 'true'],\r\n        ['calcMode', 'auto'],\r\n        ['calcOnSave', 'true'],\r\n        ['concurrentCalc', 'true'],\r\n        ['fullCalcOnLoad', 'false'],\r\n        ['fullPrecision', 'true'],\r\n        ['iterate', 'false'],\r\n        ['iterateCount', '100'],\r\n        ['iterateDelta', '0.001'],\r\n        ['refMode', 'A1']\r\n    ];\r\n\r\n    /* 18.2.3 (CT_CustomWorkbookView) Defaults */\r\n    var CustomWBViewDef = [\r\n        ['autoUpdate', 'false'],\r\n        ['changesSavedWin', 'false'],\r\n        ['includeHiddenRowCol', 'true'],\r\n        ['includePrintSettings', 'true'],\r\n        ['maximized', 'false'],\r\n        ['minimized', 'false'],\r\n        ['onlySync', 'false'],\r\n        ['personalView', 'false'],\r\n        ['showComments', 'commIndicator'],\r\n        ['showFormulaBar', 'true'],\r\n        ['showHorizontalScroll', 'true'],\r\n        ['showObjects', 'all'],\r\n        ['showSheetTabs', 'true'],\r\n        ['showStatusbar', 'true'],\r\n        ['showVerticalScroll', 'true'],\r\n        ['tabRatio', '600'],\r\n        ['xWindow', '0'],\r\n        ['yWindow', '0']\r\n    ];\r\n\r\n    function push_defaults_array(target, defaults) {\r\n        for (var j = 0; j != target.length; ++j) {\r\n            var w = target[j];\r\n            for (var i = 0; i != defaults.length; ++i) {\r\n                var z = defaults[i];\r\n                if (w[z[0]] == null) w[z[0]] = z[1];\r\n            }\r\n        }\r\n    }\r\n    function push_defaults(target, defaults) {\r\n        for (var i = 0; i != defaults.length; ++i) {\r\n            var z = defaults[i];\r\n            if (target[z[0]] == null) target[z[0]] = z[1];\r\n        }\r\n    }\r\n\r\n    function parse_wb_defaults(wb) {\r\n        push_defaults(wb.WBProps, WBPropsDef);\r\n        push_defaults(wb.CalcPr, CalcPrDef);\r\n\r\n        push_defaults_array(wb.WBView, WBViewDef);\r\n        push_defaults_array(wb.Sheets, SheetDef);\r\n\r\n        _ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904, 'date1904');\r\n    }\r\n    /* 18.2 Workbook */\r\n    var wbnsregex = /<\\w+:workbook/;\r\n    function parse_wb_xml(data, opts) {\r\n        var wb = { AppVersion: {}, WBProps: {}, WBView: [], Sheets: [], CalcPr: {}, xmlns: \"\" };\r\n        var pass = false, xmlns = \"xmlns\";\r\n        data.match(tagregex).forEach(function xml_wb(x) {\r\n            var y = parsexmltag(x);\r\n            switch (strip_ns(y[0])) {\r\n                case '<?xml': break;\r\n\r\n                /* 18.2.27 workbook CT_Workbook 1 */\r\n                case '<workbook':\r\n                    if (x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\r\n                    wb.xmlns = y[xmlns];\r\n                    break;\r\n                case '</workbook>': break;\r\n\r\n                /* 18.2.13 fileVersion CT_FileVersion ? */\r\n                case '<fileVersion': delete y[0]; wb.AppVersion = y; break;\r\n                case '<fileVersion/>': break;\r\n\r\n                /* 18.2.12 fileSharing CT_FileSharing ? */\r\n                case '<fileSharing': case '<fileSharing/>': break;\r\n\r\n                /* 18.2.28 workbookPr CT_WorkbookPr ? */\r\n                case '<workbookPr': delete y[0]; wb.WBProps = y; break;\r\n                case '<workbookPr/>': delete y[0]; wb.WBProps = y; break;\r\n\r\n                /* 18.2.29 workbookProtection CT_WorkbookProtection ? */\r\n                case '<workbookProtection': break;\r\n                case '<workbookProtection/>': break;\r\n\r\n                /* 18.2.1  bookViews CT_BookViews ? */\r\n                case '<bookViews>': case '</bookViews>': break;\r\n                /* 18.2.30   workbookView CT_BookView + */\r\n                case '<workbookView': delete y[0]; wb.WBView.push(y); break;\r\n\r\n                /* 18.2.20 sheets CT_Sheets 1 */\r\n                case '<sheets>': case '</sheets>': break; // aggregate sheet\r\n                /* 18.2.19   sheet CT_Sheet + */\r\n                case '<sheet': delete y[0]; y.name = utf8read(y.name); wb.Sheets.push(y); break;\r\n\r\n                /* 18.2.15 functionGroups CT_FunctionGroups ? */\r\n                case '<functionGroups': case '<functionGroups/>': break;\r\n                /* 18.2.14   functionGroup CT_FunctionGroup + */\r\n                case '<functionGroup': break;\r\n\r\n                /* 18.2.9  externalReferences CT_ExternalReferences ? */\r\n                case '<externalReferences': case '</externalReferences>': case '<externalReferences>': break;\r\n                /* 18.2.8    externalReference CT_ExternalReference + */\r\n                case '<externalReference': break;\r\n\r\n                /* 18.2.6  definedNames CT_DefinedNames ? */\r\n                case '<definedNames/>': break;\r\n                case '<definedNames>': case '<definedNames': pass = true; break;\r\n                case '</definedNames>': pass = false; break;\r\n                /* 18.2.5    definedName CT_DefinedName + */\r\n                case '<definedName': case '<definedName/>': case '</definedName>': break;\r\n\r\n                /* 18.2.2  calcPr CT_CalcPr ? */\r\n                case '<calcPr': delete y[0]; wb.CalcPr = y; break;\r\n                case '<calcPr/>': delete y[0]; wb.CalcPr = y; break;\r\n\r\n                /* 18.2.16 oleSize CT_OleSize ? (ref required) */\r\n                case '<oleSize': break;\r\n\r\n                /* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\r\n                case '<customWorkbookViews>': case '</customWorkbookViews>': case '<customWorkbookViews': break;\r\n                /* 18.2.3    customWorkbookView CT_CustomWorkbookView + */\r\n                case '<customWorkbookView': case '</customWorkbookView>': break;\r\n\r\n                /* 18.2.18 pivotCaches CT_PivotCaches ? */\r\n                case '<pivotCaches>': case '</pivotCaches>': case '<pivotCaches': break;\r\n                /* 18.2.17 pivotCache CT_PivotCache ? */\r\n                case '<pivotCache': break;\r\n\r\n                /* 18.2.21 smartTagPr CT_SmartTagPr ? */\r\n                case '<smartTagPr': case '<smartTagPr/>': break;\r\n\r\n                /* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\r\n                case '<smartTagTypes': case '<smartTagTypes>': case '</smartTagTypes>': break;\r\n                /* 18.2.22   smartTagType CT_SmartTagType ? */\r\n                case '<smartTagType': break;\r\n\r\n                /* 18.2.24 webPublishing CT_WebPublishing ? */\r\n                case '<webPublishing': case '<webPublishing/>': break;\r\n\r\n                /* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\r\n                case '<fileRecoveryPr': case '<fileRecoveryPr/>': break;\r\n\r\n                /* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\r\n                case '<webPublishObjects>': case '<webPublishObjects': case '</webPublishObjects>': break;\r\n                /* 18.2.25 webPublishObject CT_WebPublishObject ? */\r\n                case '<webPublishObject': break;\r\n\r\n                /* 18.2.10 extLst CT_ExtensionList ? */\r\n                case '<extLst>': case '</extLst>': case '<extLst/>': break;\r\n                /* 18.2.7    ext CT_Extension + */\r\n                case '<ext': pass = true; break; //TODO: check with versions of excel\r\n                case '</ext>': pass = false; break;\r\n\r\n                /* Others */\r\n                case '<ArchID': break;\r\n                case '<AlternateContent': pass = true; break;\r\n                case '</AlternateContent>': pass = false; break;\r\n\r\n                default: if (!pass && opts.WTF) throw 'unrecognized ' + y[0] + ' in workbook';\r\n            }\r\n        });\r\n        if (XMLNS.main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\r\n\r\n        parse_wb_defaults(wb);\r\n\r\n        return wb;\r\n    }\r\n\r\n    var WB_XML_ROOT = writextag('workbook', null, {\r\n        'xmlns': XMLNS.main[0],\r\n        //'xmlns:mx': XMLNS.mx,\r\n        //'xmlns:s': XMLNS.main[0],\r\n        'xmlns:r': XMLNS.r\r\n    });\r\n\r\n    function safe1904(wb) {\r\n        /* TODO: store date1904 somewhere else */\r\n        try { return parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\"; } catch (e) { return \"false\"; }\r\n    }\r\n\r\n    function write_wb_xml(wb, opts) {\r\n        var o = [XML_HEADER];\r\n        o[o.length] = WB_XML_ROOT;\r\n        o[o.length] = (writextag('workbookPr', null, { date1904: safe1904(wb) }));\r\n        o[o.length] = \"<sheets>\";\r\n        for (var i = 0; i != wb.SheetNames.length; ++i)\r\n            o[o.length] = (writextag('sheet', null, { name: wb.SheetNames[i].substr(0, 31), sheetId: \"\" + (i + 1), \"r:id\": \"rId\" + (i + 1) }));\r\n        o[o.length] = \"</sheets>\";\r\n        if (o.length > 2) { o[o.length] = '</workbook>'; o[1] = o[1].replace(\"/>\", \">\"); }\r\n        return o.join(\"\");\r\n    }\r\n    /* [MS-XLSB] 2.4.301 BrtBundleSh */\r\n    function parse_BrtBundleSh(data, length) {\r\n        var z = {};\r\n        z.hsState = data.read_shift(4); //ST_SheetState\r\n        z.iTabID = data.read_shift(4);\r\n        z.strRelID = parse_RelID(data, length - 8);\r\n        z.name = parse_XLWideString(data);\r\n        return z;\r\n    }\r\n    function write_BrtBundleSh(data, o) {\r\n        if (!o) o = new_buf(127);\r\n        o.write_shift(4, data.hsState);\r\n        o.write_shift(4, data.iTabID);\r\n        write_RelID(data.strRelID, o);\r\n        write_XLWideString(data.name.substr(0, 31), o);\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.807 BrtWbProp */\r\n    function parse_BrtWbProp(data, length) {\r\n        data.read_shift(4);\r\n        var dwThemeVersion = data.read_shift(4);\r\n        var strName = (length > 8) ? parse_XLWideString(data) : \"\";\r\n        return [dwThemeVersion, strName];\r\n    }\r\n    function write_BrtWbProp(data, o) {\r\n        if (!o) o = new_buf(8);\r\n        o.write_shift(4, 0);\r\n        o.write_shift(4, 0);\r\n        return o;\r\n    }\r\n\r\n    function parse_BrtFRTArchID$(data, length) {\r\n        var o = {};\r\n        data.read_shift(4);\r\n        o.ArchID = data.read_shift(4);\r\n        data.l += length - 8;\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.7.60 Workbook */\r\n    function parse_wb_bin(data, opts) {\r\n        var wb = { AppVersion: {}, WBProps: {}, WBView: [], Sheets: [], CalcPr: {}, xmlns: \"\" };\r\n        var pass = false, z;\r\n\r\n        recordhopper(data, function hopper_wb(val, R) {\r\n            switch (R.n) {\r\n                case 'BrtBundleSh': wb.Sheets.push(val); break;\r\n\r\n                case 'BrtBeginBook': break;\r\n                case 'BrtFileVersion': break;\r\n                case 'BrtWbProp': break;\r\n                case 'BrtACBegin': break;\r\n                case 'BrtAbsPath15': break;\r\n                case 'BrtACEnd': break;\r\n                case 'BrtWbFactoid': break;\r\n                /*case 'BrtBookProtectionIso': break;*/\r\n                case 'BrtBookProtection': break;\r\n                case 'BrtBeginBookViews': break;\r\n                case 'BrtBookView': break;\r\n                case 'BrtEndBookViews': break;\r\n                case 'BrtBeginBundleShs': break;\r\n                case 'BrtEndBundleShs': break;\r\n                case 'BrtBeginFnGroup': break;\r\n                case 'BrtEndFnGroup': break;\r\n                case 'BrtBeginExternals': break;\r\n                case 'BrtSupSelf': break;\r\n                case 'BrtSupBookSrc': break;\r\n                case 'BrtExternSheet': break;\r\n                case 'BrtEndExternals': break;\r\n                case 'BrtName': break;\r\n                case 'BrtCalcProp': break;\r\n                case 'BrtUserBookView': break;\r\n                case 'BrtBeginPivotCacheIDs': break;\r\n                case 'BrtBeginPivotCacheID': break;\r\n                case 'BrtEndPivotCacheID': break;\r\n                case 'BrtEndPivotCacheIDs': break;\r\n                case 'BrtWebOpt': break;\r\n                case 'BrtFileRecover': break;\r\n                case 'BrtFileSharing': break;\r\n                /*case 'BrtBeginWebPubItems': break;\r\n                case 'BrtBeginWebPubItem': break;\r\n                case 'BrtEndWebPubItem': break;\r\n                case 'BrtEndWebPubItems': break;*/\r\n\r\n                /* Smart Tags */\r\n                case 'BrtBeginSmartTagTypes': break;\r\n                case 'BrtSmartTagType': break;\r\n                case 'BrtEndSmartTagTypes': break;\r\n\r\n                case 'BrtFRTBegin': pass = true; break;\r\n                case 'BrtFRTArchID$': break;\r\n                case 'BrtWorkBookPr15': break;\r\n                case 'BrtFRTEnd': pass = false; break;\r\n                case 'BrtEndBook': break;\r\n                default: if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\r\n            }\r\n        });\r\n\r\n        parse_wb_defaults(wb);\r\n\r\n        return wb;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.7.60 Workbook */\r\n    function write_BUNDLESHS(ba, wb, opts) {\r\n        write_record(ba, \"BrtBeginBundleShs\");\r\n        for (var idx = 0; idx != wb.SheetNames.length; ++idx) {\r\n            var d = { hsState: 0, iTabID: idx + 1, strRelID: 'rId' + (idx + 1), name: wb.SheetNames[idx] };\r\n            write_record(ba, \"BrtBundleSh\", write_BrtBundleSh(d));\r\n        }\r\n        write_record(ba, \"BrtEndBundleShs\");\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.643 BrtFileVersion */\r\n    function write_BrtFileVersion(data, o) {\r\n        if (!o) o = new_buf(127);\r\n        for (var i = 0; i != 4; ++i) o.write_shift(4, 0);\r\n        write_XLWideString(\"SheetJS\", o);\r\n        write_XLWideString(XLSX.version, o);\r\n        write_XLWideString(XLSX.version, o);\r\n        write_XLWideString(\"7262\", o);\r\n        o.length = o.l;\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.7.60 Workbook */\r\n    function write_BOOKVIEWS(ba, wb, opts) {\r\n        write_record(ba, \"BrtBeginBookViews\");\r\n        /* 1*(BrtBookView *FRT) */\r\n        write_record(ba, \"BrtEndBookViews\");\r\n    }\r\n\r\n    /* [MS-XLSB] 2.4.302 BrtCalcProp */\r\n    function write_BrtCalcProp(data, o) {\r\n        if (!o) o = new_buf(26);\r\n        o.write_shift(4, 0); /* force recalc */\r\n        o.write_shift(4, 1);\r\n        o.write_shift(4, 0);\r\n        write_Xnum(0, o);\r\n        o.write_shift(-4, 1023);\r\n        o.write_shift(1, 0x33);\r\n        o.write_shift(1, 0x00);\r\n        return o;\r\n    }\r\n\r\n    function write_BrtFileRecover(data, o) {\r\n        if (!o) o = new_buf(1);\r\n        o.write_shift(1, 0);\r\n        return o;\r\n    }\r\n\r\n    /* [MS-XLSB] 2.1.7.60 Workbook */\r\n    function write_wb_bin(wb, opts) {\r\n        var ba = buf_array();\r\n        write_record(ba, \"BrtBeginBook\");\r\n        write_record(ba, \"BrtFileVersion\", write_BrtFileVersion());\r\n        /* [[BrtFileSharingIso] BrtFileSharing] */\r\n        write_record(ba, \"BrtWbProp\", write_BrtWbProp());\r\n        /* [ACABSPATH] */\r\n        /* [[BrtBookProtectionIso] BrtBookProtection] */\r\n        write_BOOKVIEWS(ba, wb, opts);\r\n        write_BUNDLESHS(ba, wb, opts);\r\n        /* [FNGROUP] */\r\n        /* [EXTERNALS] */\r\n        /* *BrtName */\r\n        write_record(ba, \"BrtCalcProp\", write_BrtCalcProp());\r\n        /* [BrtOleSize] */\r\n        /* *(BrtUserBookView *FRT) */\r\n        /* [PIVOTCACHEIDS] */\r\n        /* [BrtWbFactoid] */\r\n        /* [SMARTTAGTYPES] */\r\n        /* [BrtWebOpt] */\r\n        write_record(ba, \"BrtFileRecover\", write_BrtFileRecover());\r\n        /* [WEBPUBITEMS] */\r\n        /* [CRERRS] */\r\n        /* FRTWORKBOOK */\r\n        write_record(ba, \"BrtEndBook\");\r\n\r\n        return ba.end();\r\n    }\r\n    function parse_wb(data, name, opts) {\r\n        return (name.substr(-4) === \".bin\" ? parse_wb_bin : parse_wb_xml)(data, opts);\r\n    }\r\n\r\n    function parse_ws(data, name, opts, rels) {\r\n        return (name.substr(-4) === \".bin\" ? parse_ws_bin : parse_ws_xml)(data, opts, rels);\r\n    }\r\n\r\n    function parse_sty(data, name, opts) {\r\n        return (name.substr(-4) === \".bin\" ? parse_sty_bin : parse_sty_xml)(data, opts);\r\n    }\r\n\r\n    function parse_theme(data, name, opts) {\r\n        return parse_theme_xml(data, opts);\r\n    }\r\n\r\n    function parse_sst(data, name, opts) {\r\n        return (name.substr(-4) === \".bin\" ? parse_sst_bin : parse_sst_xml)(data, opts);\r\n    }\r\n\r\n    function parse_cmnt(data, name, opts) {\r\n        return (name.substr(-4) === \".bin\" ? parse_comments_bin : parse_comments_xml)(data, opts);\r\n    }\r\n\r\n    function parse_cc(data, name, opts) {\r\n        return (name.substr(-4) === \".bin\" ? parse_cc_bin : parse_cc_xml)(data, opts);\r\n    }\r\n\r\n    function write_wb(wb, name, opts) {\r\n        return (name.substr(-4) === \".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\r\n    }\r\n\r\n    function write_ws(data, name, opts, wb) {\r\n        return (name.substr(-4) === \".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb);\r\n    }\r\n\r\n    function write_sty(data, name, opts) {\r\n        return (name.substr(-4) === \".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\r\n    }\r\n\r\n    function write_sst(data, name, opts) {\r\n        return (name.substr(-4) === \".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\r\n    }\r\n    /*\r\n    function write_cmnt(data, name, opts) {\r\n        return (name.substr(-4)===\".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\r\n    }\r\n    \r\n    function write_cc(data, name, opts) {\r\n        return (name.substr(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\r\n    }\r\n    */\r\n    var attregexg2 = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\r\n    var attregex2 = /([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\r\n    var _chr = function (c) { return String.fromCharCode(c); };\r\n    function xlml_parsexmltag(tag, skip_root) {\r\n        var words = tag.split(/\\s+/);\r\n        var z = []; if (!skip_root) z[0] = words[0];\r\n        if (words.length === 1) return z;\r\n        var m = tag.match(attregexg2), y, j, w, i;\r\n        if (m) for (i = 0; i != m.length; ++i) {\r\n            y = m[i].match(attregex2);\r\n            if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1, y[2].length - 2);\r\n            else {\r\n                if (y[1].substr(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].substr(6);\r\n                else w = y[1].substr(j + 1);\r\n                z[w] = y[2].substr(1, y[2].length - 2);\r\n            }\r\n        }\r\n        return z;\r\n    }\r\n    function xlml_parsexmltagobj(tag) {\r\n        var words = tag.split(/\\s+/);\r\n        var z = {};\r\n        if (words.length === 1) return z;\r\n        var m = tag.match(attregexg2), y, j, w, i;\r\n        if (m) for (i = 0; i != m.length; ++i) {\r\n            y = m[i].match(attregex2);\r\n            if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1, y[2].length - 2);\r\n            else {\r\n                if (y[1].substr(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].substr(6);\r\n                else w = y[1].substr(j + 1);\r\n                z[w] = y[2].substr(1, y[2].length - 2);\r\n            }\r\n        }\r\n        return z;\r\n    }\r\n\r\n    // ----\r\n\r\n    function xlml_format(format, value) {\r\n        var fmt = XLMLFormatMap[format] || unescapexml(format);\r\n        if (fmt === \"General\") return SSF._general(value);\r\n        return SSF.format(fmt, value);\r\n    }\r\n\r\n    function xlml_set_custprop(Custprops, Rn, cp, val) {\r\n        switch ((cp[0].match(/dt:dt=\"([\\w.]+)\"/) || [\"\", \"\"])[1]) {\r\n            case \"boolean\": val = parsexmlbool(val); break;\r\n            case \"i2\": case \"int\": val = parseInt(val, 10); break;\r\n            case \"r4\": case \"float\": val = parseFloat(val); break;\r\n            case \"date\": case \"dateTime.tz\": val = new Date(val); break;\r\n            case \"i8\": case \"string\": case \"fixed\": case \"uuid\": case \"bin.base64\": break;\r\n            default: throw \"bad custprop:\" + cp[0];\r\n        }\r\n        Custprops[unescapexml(Rn[3])] = val;\r\n    }\r\n\r\n    function safe_format_xlml(cell, nf, o) {\r\n        try {\r\n            if (cell.t === 'e') { cell.w = cell.w || BErr[cell.v]; }\r\n            else if (nf === \"General\") {\r\n                if (cell.t === 'n') {\r\n                    if ((cell.v | 0) === cell.v) cell.w = SSF._general_int(cell.v);\r\n                    else cell.w = SSF._general_num(cell.v);\r\n                }\r\n                else cell.w = SSF._general(cell.v);\r\n            }\r\n            else cell.w = xlml_format(nf || \"General\", cell.v);\r\n            if (o.cellNF) cell.z = XLMLFormatMap[nf] || nf || \"General\";\r\n        } catch (e) { if (o.WTF) throw e; }\r\n    }\r\n\r\n    function process_style_xlml(styles, stag, opts) {\r\n        if (opts.cellStyles) {\r\n            if (stag.Interior) {\r\n                var I = stag.Interior;\r\n                if (I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\r\n            }\r\n        }\r\n        styles[stag.ID] = stag;\r\n    }\r\n\r\n    /* TODO: there must exist some form of OSP-blessed spec */\r\n    function parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, o) {\r\n        var nf = \"General\", sid = cell.StyleID, S = {}; o = o || {};\r\n        var interiors = [];\r\n        if (sid === undefined && row) sid = row.StyleID;\r\n        if (sid === undefined && csty) sid = csty.StyleID;\r\n        while (styles[sid] !== undefined) {\r\n            if (styles[sid].nf) nf = styles[sid].nf;\r\n            if (styles[sid].Interior) interiors.push(styles[sid].Interior);\r\n            if (!styles[sid].Parent) break;\r\n            sid = styles[sid].Parent;\r\n        }\r\n        switch (data.Type) {\r\n            case 'Boolean':\r\n                cell.t = 'b';\r\n                cell.v = parsexmlbool(xml);\r\n                break;\r\n            case 'String':\r\n                cell.t = 's'; cell.r = xlml_fixstr(unescapexml(xml));\r\n                cell.v = xml.indexOf(\"<\") > -1 ? ss : cell.r;\r\n                break;\r\n            case 'DateTime':\r\n                cell.v = (Date.parse(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\r\n                if (cell.v !== cell.v) cell.v = unescapexml(xml);\r\n                else if (cell.v >= 1 && cell.v < 60) cell.v = cell.v - 1;\r\n                if (!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\r\n            /* falls through */\r\n            case 'Number':\r\n                if (cell.v === undefined) cell.v = +xml;\r\n                if (!cell.t) cell.t = 'n';\r\n                break;\r\n            case 'Error': cell.t = 'e'; cell.v = RBErr[xml]; cell.w = xml; break;\r\n            default: cell.t = 's'; cell.v = xlml_fixstr(ss); break;\r\n        }\r\n        safe_format_xlml(cell, nf, o);\r\n        if (o.cellFormula != null && cell.Formula) {\r\n            cell.f = rc_to_a1(unescapexml(cell.Formula), base);\r\n            cell.Formula = undefined;\r\n        }\r\n        if (o.cellStyles) {\r\n            interiors.forEach(function (x) {\r\n                if (!S.patternType && x.patternType) S.patternType = x.patternType;\r\n            });\r\n            cell.s = S;\r\n        }\r\n        cell.ixfe = cell.StyleID !== undefined ? cell.StyleID : 'Default';\r\n    }\r\n\r\n    function xlml_clean_comment(comment) {\r\n        comment.t = comment.v;\r\n        comment.v = comment.w = comment.ixfe = undefined;\r\n    }\r\n\r\n    function xlml_normalize(d) {\r\n        if (has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\r\n        if (typeof d === 'string') return d;\r\n        throw \"badf\";\r\n    }\r\n\r\n    /* TODO: Everything */\r\n    var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\r\n    function parse_xlml_xml(d, opts) {\r\n        var str = xlml_normalize(d);\r\n        var Rn;\r\n        var state = [], tmp;\r\n        var sheets = {}, sheetnames = [], cursheet = {}, sheetname = \"\";\r\n        var table = {}, cell = {}, row = {}, dtag, didx;\r\n        var c = 0, r = 0;\r\n        var refguess = { s: { r: 1000000, c: 1000000 }, e: { r: 0, c: 0 } };\r\n        var styles = {}, stag = {};\r\n        var ss = \"\", fidx = 0;\r\n        var mergecells = [];\r\n        var Props = {}, Custprops = {}, pidx = 0, cp = {};\r\n        var comments = [], comment = {};\r\n        var cstys = [], csty;\r\n        xlmlregex.lastIndex = 0;\r\n        while ((Rn = xlmlregex.exec(str))) switch (Rn[3]) {\r\n            case 'Data':\r\n                if (state[state.length - 1][1]) break;\r\n                if (Rn[1] === '/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length - 1][0] == \"Comment\" ? comment : cell, { c: c, r: r }, styles, cstys[c], row, opts);\r\n                else { ss = \"\"; dtag = xlml_parsexmltag(Rn[0]); didx = Rn.index + Rn[0].length; }\r\n                break;\r\n            case 'Cell':\r\n                if (Rn[1] === '/') {\r\n                    if (comments.length > 0) cell.c = comments;\r\n                    if ((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) cursheet[encode_col(c) + encode_row(r)] = cell;\r\n                    if (cell.HRef) {\r\n                        cell.l = { Target: cell.HRef, tooltip: cell.HRefScreenTip };\r\n                        cell.HRef = cell.HRefScreenTip = undefined;\r\n                    }\r\n                    if (cell.MergeAcross || cell.MergeDown) {\r\n                        var cc = c + (parseInt(cell.MergeAcross, 10) | 0);\r\n                        var rr = r + (parseInt(cell.MergeDown, 10) | 0);\r\n                        mergecells.push({ s: { c: c, r: r }, e: { c: cc, r: rr } });\r\n                    }\r\n                    ++c;\r\n                    if (cell.MergeAcross) c += +cell.MergeAcross;\r\n                } else {\r\n                    cell = xlml_parsexmltagobj(Rn[0]);\r\n                    if (cell.Index) c = +cell.Index - 1;\r\n                    if (c < refguess.s.c) refguess.s.c = c;\r\n                    if (c > refguess.e.c) refguess.e.c = c;\r\n                    if (Rn[0].substr(-2) === \"/>\")++c;\r\n                    comments = [];\r\n                }\r\n                break;\r\n            case 'Row':\r\n                if (Rn[1] === '/' || Rn[0].substr(-2) === \"/>\") {\r\n                    if (r < refguess.s.r) refguess.s.r = r;\r\n                    if (r > refguess.e.r) refguess.e.r = r;\r\n                    if (Rn[0].substr(-2) === \"/>\") {\r\n                        row = xlml_parsexmltag(Rn[0]);\r\n                        if (row.Index) r = +row.Index - 1;\r\n                    }\r\n                    c = 0; ++r;\r\n                } else {\r\n                    row = xlml_parsexmltag(Rn[0]);\r\n                    if (row.Index) r = +row.Index - 1;\r\n                }\r\n                break;\r\n            case 'Worksheet': /* TODO: read range from FullRows/FullColumns */\r\n                if (Rn[1] === '/') {\r\n                    if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\r\n                    sheetnames.push(sheetname);\r\n                    if (refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) cursheet[\"!ref\"] = encode_range(refguess);\r\n                    if (mergecells.length) cursheet[\"!merges\"] = mergecells;\r\n                    sheets[sheetname] = cursheet;\r\n                } else {\r\n                    refguess = { s: { r: 1000000, c: 1000000 }, e: { r: 0, c: 0 } };\r\n                    r = c = 0;\r\n                    state.push([Rn[3], false]);\r\n                    tmp = xlml_parsexmltag(Rn[0]);\r\n                    sheetname = tmp.Name;\r\n                    cursheet = {};\r\n                    mergecells = [];\r\n                }\r\n                break;\r\n            case 'Table':\r\n                if (Rn[1] === '/') { if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp; }\r\n                else if (Rn[0].slice(-2) == \"/>\") break;\r\n                else {\r\n                    table = xlml_parsexmltag(Rn[0]);\r\n                    state.push([Rn[3], false]);\r\n                    cstys = [];\r\n                }\r\n                break;\r\n\r\n            case 'Style':\r\n                if (Rn[1] === '/') process_style_xlml(styles, stag, opts);\r\n                else stag = xlml_parsexmltag(Rn[0]);\r\n                break;\r\n\r\n            case 'NumberFormat':\r\n                stag.nf = xlml_parsexmltag(Rn[0]).Format || \"General\";\r\n                break;\r\n\r\n            case 'Column':\r\n                if (state[state.length - 1][0] !== 'Table') break;\r\n                csty = xlml_parsexmltag(Rn[0]);\r\n                cstys[(csty.Index - 1 || cstys.length)] = csty;\r\n                for (var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = csty;\r\n                break;\r\n\r\n            case 'NamedRange': break;\r\n            case 'NamedCell': break;\r\n            case 'B': break;\r\n            case 'I': break;\r\n            case 'U': break;\r\n            case 'S': break;\r\n            case 'Sub': break;\r\n            case 'Sup': break;\r\n            case 'Span': break;\r\n            case 'Border': break;\r\n            case 'Alignment': break;\r\n            case 'Borders': break;\r\n            case 'Font':\r\n                if (Rn[0].substr(-2) === \"/>\") break;\r\n                else if (Rn[1] === \"/\") ss += str.slice(fidx, Rn.index);\r\n                else fidx = Rn.index + Rn[0].length;\r\n                break;\r\n            case 'Interior':\r\n                if (!opts.cellStyles) break;\r\n                stag.Interior = xlml_parsexmltag(Rn[0]);\r\n                break;\r\n            case 'Protection': break;\r\n\r\n            case 'Author':\r\n            case 'Title':\r\n            case 'Description':\r\n            case 'Created':\r\n            case 'Keywords':\r\n            case 'Subject':\r\n            case 'Category':\r\n            case 'Company':\r\n            case 'LastAuthor':\r\n            case 'LastSaved':\r\n            case 'LastPrinted':\r\n            case 'Version':\r\n            case 'Revision':\r\n            case 'TotalTime':\r\n            case 'HyperlinkBase':\r\n            case 'Manager':\r\n                if (Rn[0].substr(-2) === \"/>\") break;\r\n                else if (Rn[1] === \"/\") xlml_set_prop(Props, Rn[3], str.slice(pidx, Rn.index));\r\n                else pidx = Rn.index + Rn[0].length;\r\n                break;\r\n            case 'Paragraphs': break;\r\n\r\n            case 'Styles':\r\n            case 'Workbook':\r\n                if (Rn[1] === '/') { if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp; }\r\n                else state.push([Rn[3], false]);\r\n                break;\r\n\r\n            case 'Comment':\r\n                if (Rn[1] === '/') {\r\n                    if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\r\n                    xlml_clean_comment(comment);\r\n                    comments.push(comment);\r\n                } else {\r\n                    state.push([Rn[3], false]);\r\n                    tmp = xlml_parsexmltag(Rn[0]);\r\n                    comment = { a: tmp.Author };\r\n                }\r\n                break;\r\n\r\n            case 'Name': break;\r\n\r\n            case 'ComponentOptions':\r\n            case 'DocumentProperties':\r\n            case 'CustomDocumentProperties':\r\n            case 'OfficeDocumentSettings':\r\n            case 'PivotTable':\r\n            case 'PivotCache':\r\n            case 'Names':\r\n            case 'MapInfo':\r\n            case 'PageBreaks':\r\n            case 'QueryTable':\r\n            case 'DataValidation':\r\n            case 'AutoFilter':\r\n            case 'Sorting':\r\n            case 'Schema':\r\n            case 'data':\r\n            case 'ConditionalFormatting':\r\n            case 'SmartTagType':\r\n            case 'SmartTags':\r\n            case 'ExcelWorkbook':\r\n            case 'WorkbookOptions':\r\n            case 'WorksheetOptions':\r\n                if (Rn[1] === '/') { if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp; }\r\n                else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\r\n                break;\r\n\r\n            default:\r\n                var seen = true;\r\n                switch (state[state.length - 1][0]) {\r\n                    /* OfficeDocumentSettings */\r\n                    case 'OfficeDocumentSettings': switch (Rn[3]) {\r\n                        case 'AllowPNG': break;\r\n                        case 'RemovePersonalInformation': break;\r\n                        case 'DownloadComponents': break;\r\n                        case 'LocationOfComponents': break;\r\n                        case 'Colors': break;\r\n                        case 'Color': break;\r\n                        case 'Index': break;\r\n                        case 'RGB': break;\r\n                        case 'PixelsPerInch': break;\r\n                        case 'TargetScreenSize': break;\r\n                        case 'ReadOnlyRecommended': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* ComponentOptions */\r\n                    case 'ComponentOptions': switch (Rn[3]) {\r\n                        case 'Toolbar': break;\r\n                        case 'HideOfficeLogo': break;\r\n                        case 'SpreadsheetAutoFit': break;\r\n                        case 'Label': break;\r\n                        case 'Caption': break;\r\n                        case 'MaxHeight': break;\r\n                        case 'MaxWidth': break;\r\n                        case 'NextSheetNumber': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* ExcelWorkbook */\r\n                    case 'ExcelWorkbook': switch (Rn[3]) {\r\n                        case 'WindowHeight': break;\r\n                        case 'WindowWidth': break;\r\n                        case 'WindowTopX': break;\r\n                        case 'WindowTopY': break;\r\n                        case 'TabRatio': break;\r\n                        case 'ProtectStructure': break;\r\n                        case 'ProtectWindows': break;\r\n                        case 'ActiveSheet': break;\r\n                        case 'DisplayInkNotes': break;\r\n                        case 'FirstVisibleSheet': break;\r\n                        case 'SupBook': break;\r\n                        case 'SheetName': break;\r\n                        case 'SheetIndex': break;\r\n                        case 'SheetIndexFirst': break;\r\n                        case 'SheetIndexLast': break;\r\n                        case 'Dll': break;\r\n                        case 'AcceptLabelsInFormulas': break;\r\n                        case 'DoNotSaveLinkValues': break;\r\n                        case 'Date1904': break;\r\n                        case 'Iteration': break;\r\n                        case 'MaxIterations': break;\r\n                        case 'MaxChange': break;\r\n                        case 'Path': break;\r\n                        case 'Xct': break;\r\n                        case 'Count': break;\r\n                        case 'SelectedSheets': break;\r\n                        case 'Calculation': break;\r\n                        case 'Uncalced': break;\r\n                        case 'StartupPrompt': break;\r\n                        case 'Crn': break;\r\n                        case 'ExternName': break;\r\n                        case 'Formula': break;\r\n                        case 'ColFirst': break;\r\n                        case 'ColLast': break;\r\n                        case 'WantAdvise': break;\r\n                        case 'Boolean': break;\r\n                        case 'Error': break;\r\n                        case 'Text': break;\r\n                        case 'OLE': break;\r\n                        case 'NoAutoRecover': break;\r\n                        case 'PublishObjects': break;\r\n                        case 'DoNotCalculateBeforeSave': break;\r\n                        case 'Number': break;\r\n                        case 'RefModeR1C1': break;\r\n                        case 'EmbedSaveSmartTags': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* WorkbookOptions */\r\n                    case 'WorkbookOptions': switch (Rn[3]) {\r\n                        case 'OWCVersion': break;\r\n                        case 'Height': break;\r\n                        case 'Width': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* WorksheetOptions */\r\n                    case 'WorksheetOptions': switch (Rn[3]) {\r\n                        case 'Unsynced': break;\r\n                        case 'Visible': break;\r\n                        case 'Print': break;\r\n                        case 'Panes': break;\r\n                        case 'Scale': break;\r\n                        case 'Pane': break;\r\n                        case 'Number': break;\r\n                        case 'Layout': break;\r\n                        case 'Header': break;\r\n                        case 'Footer': break;\r\n                        case 'PageSetup': break;\r\n                        case 'PageMargins': break;\r\n                        case 'Selected': break;\r\n                        case 'ProtectObjects': break;\r\n                        case 'EnableSelection': break;\r\n                        case 'ProtectScenarios': break;\r\n                        case 'ValidPrinterInfo': break;\r\n                        case 'HorizontalResolution': break;\r\n                        case 'VerticalResolution': break;\r\n                        case 'NumberofCopies': break;\r\n                        case 'ActiveRow': break;\r\n                        case 'ActiveCol': break;\r\n                        case 'ActivePane': break;\r\n                        case 'TopRowVisible': break;\r\n                        case 'TopRowBottomPane': break;\r\n                        case 'LeftColumnVisible': break;\r\n                        case 'LeftColumnRightPane': break;\r\n                        case 'FitToPage': break;\r\n                        case 'RangeSelection': break;\r\n                        case 'PaperSizeIndex': break;\r\n                        case 'PageLayoutZoom': break;\r\n                        case 'PageBreakZoom': break;\r\n                        case 'FilterOn': break;\r\n                        case 'DoNotDisplayGridlines': break;\r\n                        case 'SplitHorizontal': break;\r\n                        case 'SplitVertical': break;\r\n                        case 'FreezePanes': break;\r\n                        case 'FrozenNoSplit': break;\r\n                        case 'FitWidth': break;\r\n                        case 'FitHeight': break;\r\n                        case 'CommentsLayout': break;\r\n                        case 'Zoom': break;\r\n                        case 'LeftToRight': break;\r\n                        case 'Gridlines': break;\r\n                        case 'AllowSort': break;\r\n                        case 'AllowFilter': break;\r\n                        case 'AllowInsertRows': break;\r\n                        case 'AllowDeleteRows': break;\r\n                        case 'AllowInsertCols': break;\r\n                        case 'AllowDeleteCols': break;\r\n                        case 'AllowInsertHyperlinks': break;\r\n                        case 'AllowFormatCells': break;\r\n                        case 'AllowSizeCols': break;\r\n                        case 'AllowSizeRows': break;\r\n                        case 'NoSummaryRowsBelowDetail': break;\r\n                        case 'TabColorIndex': break;\r\n                        case 'DoNotDisplayHeadings': break;\r\n                        case 'ShowPageLayoutZoom': break;\r\n                        case 'NoSummaryColumnsRightDetail': break;\r\n                        case 'BlackAndWhite': break;\r\n                        case 'DoNotDisplayZeros': break;\r\n                        case 'DisplayPageBreak': break;\r\n                        case 'RowColHeadings': break;\r\n                        case 'DoNotDisplayOutline': break;\r\n                        case 'NoOrientation': break;\r\n                        case 'AllowUsePivotTables': break;\r\n                        case 'ZeroHeight': break;\r\n                        case 'ViewableRange': break;\r\n                        case 'Selection': break;\r\n                        case 'ProtectContents': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* PivotTable */\r\n                    case 'PivotTable': case 'PivotCache': switch (Rn[3]) {\r\n                        case 'ImmediateItemsOnDrop': break;\r\n                        case 'ShowPageMultipleItemLabel': break;\r\n                        case 'CompactRowIndent': break;\r\n                        case 'Location': break;\r\n                        case 'PivotField': break;\r\n                        case 'Orientation': break;\r\n                        case 'LayoutForm': break;\r\n                        case 'LayoutSubtotalLocation': break;\r\n                        case 'LayoutCompactRow': break;\r\n                        case 'Position': break;\r\n                        case 'PivotItem': break;\r\n                        case 'DataType': break;\r\n                        case 'DataField': break;\r\n                        case 'SourceName': break;\r\n                        case 'ParentField': break;\r\n                        case 'PTLineItems': break;\r\n                        case 'PTLineItem': break;\r\n                        case 'CountOfSameItems': break;\r\n                        case 'Item': break;\r\n                        case 'ItemType': break;\r\n                        case 'PTSource': break;\r\n                        case 'CacheIndex': break;\r\n                        case 'ConsolidationReference': break;\r\n                        case 'FileName': break;\r\n                        case 'Reference': break;\r\n                        case 'NoColumnGrand': break;\r\n                        case 'NoRowGrand': break;\r\n                        case 'BlankLineAfterItems': break;\r\n                        case 'Hidden': break;\r\n                        case 'Subtotal': break;\r\n                        case 'BaseField': break;\r\n                        case 'MapChildItems': break;\r\n                        case 'Function': break;\r\n                        case 'RefreshOnFileOpen': break;\r\n                        case 'PrintSetTitles': break;\r\n                        case 'MergeLabels': break;\r\n                        case 'DefaultVersion': break;\r\n                        case 'RefreshName': break;\r\n                        case 'RefreshDate': break;\r\n                        case 'RefreshDateCopy': break;\r\n                        case 'VersionLastRefresh': break;\r\n                        case 'VersionLastUpdate': break;\r\n                        case 'VersionUpdateableMin': break;\r\n                        case 'VersionRefreshableMin': break;\r\n                        case 'Calculation': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* PageBreaks */\r\n                    case 'PageBreaks': switch (Rn[3]) {\r\n                        case 'ColBreaks': break;\r\n                        case 'ColBreak': break;\r\n                        case 'RowBreaks': break;\r\n                        case 'RowBreak': break;\r\n                        case 'ColStart': break;\r\n                        case 'ColEnd': break;\r\n                        case 'RowEnd': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* AutoFilter */\r\n                    case 'AutoFilter': switch (Rn[3]) {\r\n                        case 'AutoFilterColumn': break;\r\n                        case 'AutoFilterCondition': break;\r\n                        case 'AutoFilterAnd': break;\r\n                        case 'AutoFilterOr': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* QueryTable */\r\n                    case 'QueryTable': switch (Rn[3]) {\r\n                        case 'Id': break;\r\n                        case 'AutoFormatFont': break;\r\n                        case 'AutoFormatPattern': break;\r\n                        case 'QuerySource': break;\r\n                        case 'QueryType': break;\r\n                        case 'EnableRedirections': break;\r\n                        case 'RefreshedInXl9': break;\r\n                        case 'URLString': break;\r\n                        case 'HTMLTables': break;\r\n                        case 'Connection': break;\r\n                        case 'CommandText': break;\r\n                        case 'RefreshInfo': break;\r\n                        case 'NoTitles': break;\r\n                        case 'NextId': break;\r\n                        case 'ColumnInfo': break;\r\n                        case 'OverwriteCells': break;\r\n                        case 'DoNotPromptForFile': break;\r\n                        case 'TextWizardSettings': break;\r\n                        case 'Source': break;\r\n                        case 'Number': break;\r\n                        case 'Decimal': break;\r\n                        case 'ThousandSeparator': break;\r\n                        case 'TrailingMinusNumbers': break;\r\n                        case 'FormatSettings': break;\r\n                        case 'FieldType': break;\r\n                        case 'Delimiters': break;\r\n                        case 'Tab': break;\r\n                        case 'Comma': break;\r\n                        case 'AutoFormatName': break;\r\n                        case 'VersionLastEdit': break;\r\n                        case 'VersionLastRefresh': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* Sorting */\r\n                    case 'Sorting':\r\n                    /* ConditionalFormatting */\r\n                    case 'ConditionalFormatting':\r\n                    /* DataValidation */\r\n                    case 'DataValidation': switch (Rn[3]) {\r\n                        case 'Range': break;\r\n                        case 'Type': break;\r\n                        case 'Min': break;\r\n                        case 'Max': break;\r\n                        case 'Sort': break;\r\n                        case 'Descending': break;\r\n                        case 'Order': break;\r\n                        case 'CaseSensitive': break;\r\n                        case 'Value': break;\r\n                        case 'ErrorStyle': break;\r\n                        case 'ErrorMessage': break;\r\n                        case 'ErrorTitle': break;\r\n                        case 'CellRangeList': break;\r\n                        case 'InputMessage': break;\r\n                        case 'InputTitle': break;\r\n                        case 'ComboHide': break;\r\n                        case 'InputHide': break;\r\n                        case 'Condition': break;\r\n                        case 'Qualifier': break;\r\n                        case 'UseBlank': break;\r\n                        case 'Value1': break;\r\n                        case 'Value2': break;\r\n                        case 'Format': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* MapInfo (schema) */\r\n                    case 'MapInfo': case 'Schema': case 'data': switch (Rn[3]) {\r\n                        case 'Map': break;\r\n                        case 'Entry': break;\r\n                        case 'Range': break;\r\n                        case 'XPath': break;\r\n                        case 'Field': break;\r\n                        case 'XSDType': break;\r\n                        case 'FilterOn': break;\r\n                        case 'Aggregate': break;\r\n                        case 'ElementType': break;\r\n                        case 'AttributeType': break;\r\n                        /* These are from xsd (XML Schema Definition) */\r\n                        case 'schema':\r\n                        case 'element':\r\n                        case 'complexType':\r\n                        case 'datatype':\r\n                        case 'all':\r\n                        case 'attribute':\r\n                        case 'extends': break;\r\n\r\n                        case 'row': break;\r\n                        default: seen = false;\r\n                    } break;\r\n\r\n                    /* SmartTags (can be anything) */\r\n                    case 'SmartTags': break;\r\n\r\n                    default: seen = false; break;\r\n                }\r\n                if (seen) break;\r\n                /* CustomDocumentProperties */\r\n                if (!state[state.length - 1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\r\n                if (state[state.length - 1][0] === 'CustomDocumentProperties') {\r\n                    if (Rn[0].substr(-2) === \"/>\") break;\r\n                    else if (Rn[1] === \"/\") xlml_set_custprop(Custprops, Rn, cp, str.slice(pidx, Rn.index));\r\n                    else { cp = Rn; pidx = Rn.index + Rn[0].length; }\r\n                    break;\r\n                }\r\n                if (opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\r\n        }\r\n        var out = {};\r\n        if (!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\r\n        out.SheetNames = sheetnames;\r\n        out.SSF = SSF.get_table();\r\n        out.Props = Props;\r\n        out.Custprops = Custprops;\r\n        return out;\r\n    }\r\n\r\n    function parse_xlml(data, opts) {\r\n        fix_read_opts(opts = opts || {});\r\n        switch (opts.type || \"base64\") {\r\n            case \"base64\": return parse_xlml_xml(Base64.decode(data), opts);\r\n            case \"binary\": case \"buffer\": case \"file\": return parse_xlml_xml(data, opts);\r\n            case \"array\": return parse_xlml_xml(data.map(_chr).join(\"\"), opts);\r\n        }\r\n    }\r\n\r\n    function write_xlml(wb, opts) { }\r\n\r\n    /* [MS-OLEDS] 2.3.8 CompObjStream */\r\n    function parse_compobj(obj) {\r\n        var v = {};\r\n        var o = obj.content;\r\n\r\n        /* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\r\n        var l = 28, m;\r\n        m = __lpstr(o, l);\r\n        l += 4 + __readUInt32LE(o, l);\r\n        v.UserType = m;\r\n\r\n        /* [MS-OLEDS] 2.3.1 ClipboardFormatOrAnsiString */\r\n        m = __readUInt32LE(o, l); l += 4;\r\n        switch (m) {\r\n            case 0x00000000: break;\r\n            case 0xffffffff: case 0xfffffffe: l += 4; break;\r\n            default:\r\n                if (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\r\n                l += m;\r\n        }\r\n\r\n        m = __lpstr(o, l); l += m.length === 0 ? 0 : 5 + m.length; v.Reserved1 = m;\r\n\r\n        if ((m = __readUInt32LE(o, l)) !== 0x71b2e9f4) return v;\r\n        throw \"Unsupported Unicode Extension\";\r\n    }\r\n\r\n    /* 2.4.58 Continue logic */\r\n    function slurp(R, blob, length, opts) {\r\n        var l = length;\r\n        var bufs = [];\r\n        var d = blob.slice(blob.l, blob.l + l);\r\n        if (opts && opts.enc && opts.enc.insitu_decrypt) switch (R.n) {\r\n            case 'BOF': case 'FilePass': case 'FileLock': case 'InterfaceHdr': case 'RRDInfo': case 'RRDHead': case 'UsrExcl': break;\r\n            default:\r\n                if (d.length === 0) break;\r\n                opts.enc.insitu_decrypt(d);\r\n        }\r\n        bufs.push(d);\r\n        blob.l += l;\r\n        var next = (XLSRecordEnum[__readUInt16LE(blob, blob.l)]);\r\n        while (next != null && next.n === 'Continue') {\r\n            l = __readUInt16LE(blob, blob.l + 2);\r\n            bufs.push(blob.slice(blob.l + 4, blob.l + 4 + l));\r\n            blob.l += 4 + l;\r\n            next = (XLSRecordEnum[__readUInt16LE(blob, blob.l)]);\r\n        }\r\n        var b = bconcat(bufs);\r\n        prep_blob(b, 0);\r\n        var ll = 0; b.lens = [];\r\n        for (var j = 0; j < bufs.length; ++j) { b.lens.push(ll); ll += bufs[j].length; }\r\n        return R.f(b, b.length, opts);\r\n    }\r\n\r\n    function safe_format_xf(p, opts, date1904) {\r\n        if (!p.XF) return;\r\n        try {\r\n            var fmtid = p.XF.ifmt || 0;\r\n            if (p.t === 'e') { p.w = p.w || BErr[p.v]; }\r\n            else if (fmtid === 0) {\r\n                if (p.t === 'n') {\r\n                    if ((p.v | 0) === p.v) p.w = SSF._general_int(p.v);\r\n                    else p.w = SSF._general_num(p.v);\r\n                }\r\n                else p.w = SSF._general(p.v);\r\n            }\r\n            else p.w = SSF.format(fmtid, p.v, { date1904: date1904 || false });\r\n            if (opts.cellNF) p.z = SSF._table[fmtid];\r\n        } catch (e) { if (opts.WTF) throw e; }\r\n    }\r\n\r\n    function make_cell(val, ixfe, t) {\r\n        return { v: val, ixfe: ixfe, t: t };\r\n    }\r\n\r\n    // 2.3.2\r\n    function parse_workbook(blob, options) {\r\n        var wb = { opts: {} };\r\n        var Sheets = {};\r\n        var out = {};\r\n        var Directory = {};\r\n        var found_sheet = false;\r\n        var range = {};\r\n        var last_formula = null;\r\n        var sst = [];\r\n        var cur_sheet = \"\";\r\n        var Preamble = {};\r\n        var lastcell, last_cell, cc, cmnt, rng, rngC, rngR;\r\n        var shared_formulae = {};\r\n        var array_formulae = []; /* TODO: something more clever */\r\n        var temp_val;\r\n        var country;\r\n        var cell_valid = true;\r\n        var XFs = []; /* XF records */\r\n        var palette = [];\r\n        var get_rgb = function getrgb(icv) {\r\n            if (icv < 8) return XLSIcv[icv];\r\n            if (icv < 64) return palette[icv - 8] || XLSIcv[icv];\r\n            return XLSIcv[icv];\r\n        };\r\n        var process_cell_style = function pcs(cell, line) {\r\n            var xfd = line.XF.data;\r\n            if (!xfd || !xfd.patternType) return;\r\n            line.s = {};\r\n            line.s.patternType = xfd.patternType;\r\n            var t;\r\n            if ((t = rgb2Hex(get_rgb(xfd.icvFore)))) { line.s.fgColor = { rgb: t }; }\r\n            if ((t = rgb2Hex(get_rgb(xfd.icvBack)))) { line.s.bgColor = { rgb: t }; }\r\n        };\r\n        var addcell = function addcell(cell, line, options) {\r\n            if (!cell_valid) return;\r\n            if (options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line);\r\n            lastcell = cell;\r\n            last_cell = encode_cell(cell);\r\n            if (range.s) {\r\n                if (cell.r < range.s.r) range.s.r = cell.r;\r\n                if (cell.c < range.s.c) range.s.c = cell.c;\r\n            }\r\n            if (range.e) {\r\n                if (cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\r\n                if (cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\r\n            }\r\n            if (options.sheetRows && lastcell.r >= options.sheetRows) cell_valid = false;\r\n            else out[last_cell] = line;\r\n        };\r\n        var opts = {\r\n            enc: false, // encrypted\r\n            sbcch: 0, // cch in the preceding SupBook\r\n            snames: [], // sheetnames\r\n            sharedf: shared_formulae, // shared formulae by address\r\n            arrayf: array_formulae, // array formulae array\r\n            rrtabid: [], // RRTabId\r\n            lastuser: \"\", // Last User from WriteAccess\r\n            biff: 8, // BIFF version\r\n            codepage: 0, // CP from CodePage record\r\n            winlocked: 0, // fLockWn from WinProtect\r\n            wtf: false\r\n        };\r\n        if (options.password) opts.password = options.password;\r\n        var mergecells = [];\r\n        var objects = [];\r\n        var supbooks = [[]]; // 1-indexed, will hold extern names\r\n        var sbc = 0, sbci = 0, sbcli = 0;\r\n        supbooks.SheetNames = opts.snames;\r\n        supbooks.sharedf = opts.sharedf;\r\n        supbooks.arrayf = opts.arrayf;\r\n        var last_Rn = '';\r\n        var file_depth = 0; /* TODO: make a real stack */\r\n\r\n        /* explicit override for some broken writers */\r\n        opts.codepage = 1200;\r\n        set_cp(1200);\r\n\r\n        while (blob.l < blob.length - 1) {\r\n            var s = blob.l;\r\n            var RecordType = blob.read_shift(2);\r\n            if (RecordType === 0 && last_Rn === 'EOF') break;\r\n            var length = (blob.l === blob.length ? 0 : blob.read_shift(2)), y;\r\n            var R = XLSRecordEnum[RecordType];\r\n            if (R && R.f) {\r\n                if (options.bookSheets) {\r\n                    if (last_Rn === 'BoundSheet8' && R.n !== 'BoundSheet8') break;\r\n                }\r\n                last_Rn = R.n;\r\n                if (R.r === 2 || R.r == 12) {\r\n                    var rt = blob.read_shift(2); length -= 2;\r\n                    if (!opts.enc && rt !== RecordType) throw \"rt mismatch\";\r\n                    if (R.r == 12) { blob.l += 10; length -= 10; } // skip FRT\r\n                }\r\n                //console.error(R,blob.l,length,blob.length);\r\n                var val;\r\n                if (R.n === 'EOF') val = R.f(blob, length, opts);\r\n                else val = slurp(R, blob, length, opts);\r\n                var Rn = R.n;\r\n                /* BIFF5 overrides */\r\n                if (opts.biff === 5 || opts.biff === 2) switch (Rn) {\r\n                    case 'Lbl': Rn = 'Label'; break;\r\n                }\r\n                /* nested switch statements to workaround V8 128 limit */\r\n                switch (Rn) {\r\n                    /* Workbook Options */\r\n                    case 'Date1904': wb.opts.Date1904 = val; break;\r\n                    case 'WriteProtect': wb.opts.WriteProtect = true; break;\r\n                    case 'FilePass':\r\n                        if (!opts.enc) blob.l = 0;\r\n                        opts.enc = val;\r\n                        if (opts.WTF) console.error(val);\r\n                        if (!options.password) throw new Error(\"File is password-protected\");\r\n                        if (val.Type !== 0) throw new Error(\"Encryption scheme unsupported\");\r\n                        if (!val.valid) throw new Error(\"Password is incorrect\");\r\n                        break;\r\n                    case 'WriteAccess': opts.lastuser = val; break;\r\n                    case 'FileSharing': break; //TODO\r\n                    case 'CodePage':\r\n                        /* overrides based on test cases */\r\n                        if (val === 0x5212) val = 1200;\r\n                        else if (val === 0x8001) val = 1252;\r\n                        opts.codepage = val;\r\n                        set_cp(val);\r\n                        break;\r\n                    case 'RRTabId': opts.rrtabid = val; break;\r\n                    case 'WinProtect': opts.winlocked = val; break;\r\n                    case 'Template': break; // TODO\r\n                    case 'RefreshAll': wb.opts.RefreshAll = val; break;\r\n                    case 'BookBool': break; // TODO\r\n                    case 'UsesELFs': /* if(val) console.error(\"Unsupported ELFs\"); */ break;\r\n                    case 'MTRSettings': {\r\n                        if (val[0] && val[1]) throw \"Unsupported threads: \" + val;\r\n                    } break; // TODO: actually support threads\r\n                    case 'CalcCount': wb.opts.CalcCount = val; break;\r\n                    case 'CalcDelta': wb.opts.CalcDelta = val; break;\r\n                    case 'CalcIter': wb.opts.CalcIter = val; break;\r\n                    case 'CalcMode': wb.opts.CalcMode = val; break;\r\n                    case 'CalcPrecision': wb.opts.CalcPrecision = val; break;\r\n                    case 'CalcSaveRecalc': wb.opts.CalcSaveRecalc = val; break;\r\n                    case 'CalcRefMode': opts.CalcRefMode = val; break; // TODO: implement R1C1\r\n                    case 'Uncalced': break;\r\n                    case 'ForceFullCalculation': wb.opts.FullCalc = val; break;\r\n                    case 'WsBool': break; // TODO\r\n                    case 'XF': XFs.push(val); break;\r\n                    case 'ExtSST': break; // TODO\r\n                    case 'BookExt': break; // TODO\r\n                    case 'RichTextStream': break;\r\n                    case 'BkHim': break;\r\n\r\n                    case 'SupBook': supbooks[++sbc] = [val]; sbci = 0; break;\r\n                    case 'ExternName': supbooks[sbc][++sbci] = val; break;\r\n                    case 'Index': break; // TODO\r\n                    case 'Lbl': supbooks[0][++sbcli] = val; break;\r\n                    case 'ExternSheet': supbooks[sbc] = supbooks[sbc].concat(val); sbci += val.length; break;\r\n\r\n                    case 'Protect': out[\"!protect\"] = val; break; /* for sheet or book */\r\n                    case 'Password': if (val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val); break;\r\n                    case 'Prot4Rev': case 'Prot4RevPass': break; /*TODO: Revision Control*/\r\n\r\n                    case 'BoundSheet8': {\r\n                        Directory[val.pos] = val;\r\n                        opts.snames.push(val.name);\r\n                    } break;\r\n                    case 'EOF': {\r\n                        if (--file_depth) break;\r\n                        if (range.e) {\r\n                            out[\"!range\"] = range;\r\n                            if (range.e.r > 0 && range.e.c > 0) {\r\n                                range.e.r--; range.e.c--;\r\n                                out[\"!ref\"] = encode_range(range);\r\n                                range.e.r++; range.e.c++;\r\n                            }\r\n                            if (mergecells.length > 0) out[\"!merges\"] = mergecells;\r\n                            if (objects.length > 0) out[\"!objects\"] = objects;\r\n                        }\r\n                        if (cur_sheet === \"\") Preamble = out; else Sheets[cur_sheet] = out;\r\n                        out = {};\r\n                    } break;\r\n                    case 'BOF': {\r\n                        if (opts.biff !== 8);\r\n                        else if (val.BIFFVer === 0x0500) opts.biff = 5;\r\n                        else if (val.BIFFVer === 0x0002) opts.biff = 2;\r\n                        else if (val.BIFFVer === 0x0007) opts.biff = 2;\r\n                        if (file_depth++) break;\r\n                        cell_valid = true;\r\n                        out = {};\r\n                        if (opts.biff === 2) {\r\n                            if (cur_sheet === \"\") cur_sheet = \"Sheet1\";\r\n                            range = { s: { r: 0, c: 0 }, e: { r: 0, c: 0 } };\r\n                        }\r\n                        else cur_sheet = (Directory[s] || { name: \"\" }).name;\r\n                        mergecells = [];\r\n                        objects = [];\r\n                    } break;\r\n                    case 'Number': case 'BIFF2NUM': {\r\n                        temp_val = { ixfe: val.ixfe, XF: XFs[val.ixfe], v: val.val, t: 'n' };\r\n                        if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n                        addcell({ c: val.c, r: val.r }, temp_val, options);\r\n                    } break;\r\n                    case 'BoolErr': {\r\n                        temp_val = { ixfe: val.ixfe, XF: XFs[val.ixfe], v: val.val, t: val.t };\r\n                        if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n                        addcell({ c: val.c, r: val.r }, temp_val, options);\r\n                    } break;\r\n                    case 'RK': {\r\n                        temp_val = { ixfe: val.ixfe, XF: XFs[val.ixfe], v: val.rknum, t: 'n' };\r\n                        if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n                        addcell({ c: val.c, r: val.r }, temp_val, options);\r\n                    } break;\r\n                    case 'MulRk': {\r\n                        for (var j = val.c; j <= val.C; ++j) {\r\n                            var ixfe = val.rkrec[j - val.c][0];\r\n                            temp_val = { ixfe: ixfe, XF: XFs[ixfe], v: val.rkrec[j - val.c][1], t: 'n' };\r\n                            if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n                            addcell({ c: j, r: val.r }, temp_val, options);\r\n                        }\r\n                    } break;\r\n                    case 'Formula': {\r\n                        switch (val.val) {\r\n                            case 'String': last_formula = val; break;\r\n                            case 'Array Formula': throw \"Array Formula unsupported\";\r\n                            default:\r\n                                temp_val = { v: val.val, ixfe: val.cell.ixfe, t: val.tt };\r\n                                temp_val.XF = XFs[temp_val.ixfe];\r\n                                if (options.cellFormula) temp_val.f = \"=\" + stringify_formula(val.formula, range, val.cell, supbooks, opts);\r\n                                if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n                                addcell(val.cell, temp_val, options);\r\n                                last_formula = val;\r\n                        }\r\n                    } break;\r\n                    case 'String': {\r\n                        if (last_formula) {\r\n                            last_formula.val = val;\r\n                            temp_val = { v: last_formula.val, ixfe: last_formula.cell.ixfe, t: 's' };\r\n                            temp_val.XF = XFs[temp_val.ixfe];\r\n                            if (options.cellFormula) temp_val.f = \"=\" + stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\r\n                            if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n                            addcell(last_formula.cell, temp_val, options);\r\n                            last_formula = null;\r\n                        }\r\n                    } break;\r\n                    case 'Array': {\r\n                        array_formulae.push(val);\r\n                    } break;\r\n                    case 'ShrFmla': {\r\n                        if (!cell_valid) break;\r\n                        //if(options.cellFormula) out[last_cell].f = stringify_formula(val[0], range, lastcell, supbooks, opts);\r\n                        /* TODO: capture range */\r\n                        shared_formulae[encode_cell(last_formula.cell)] = val[0];\r\n                    } break;\r\n                    case 'LabelSst':\r\n                        //temp_val={v:sst[val.isst].t, ixfe:val.ixfe, t:'s'};\r\n                        temp_val = make_cell(sst[val.isst].t, val.ixfe, 's');\r\n                        temp_val.XF = XFs[temp_val.ixfe];\r\n                        if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n                        addcell({ c: val.c, r: val.r }, temp_val, options);\r\n                        break;\r\n                    case 'Label': case 'BIFF2STR':\r\n                        /* Some writers erroneously write Label */\r\n                        temp_val = make_cell(val.val, val.ixfe, 's');\r\n                        temp_val.XF = XFs[temp_val.ixfe];\r\n                        if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n                        addcell({ c: val.c, r: val.r }, temp_val, options);\r\n                        break;\r\n                    case 'Dimensions': {\r\n                        if (file_depth === 1) range = val; /* TODO: stack */\r\n                    } break;\r\n                    case 'SST': {\r\n                        sst = val;\r\n                    } break;\r\n                    case 'Format': { /* val = [id, fmt] */\r\n                        SSF.load(val[1], val[0]);\r\n                    } break;\r\n\r\n                    case 'MergeCells': mergecells = mergecells.concat(val); break;\r\n\r\n                    case 'Obj': objects[val.cmo[0]] = opts.lastobj = val; break;\r\n                    case 'TxO': opts.lastobj.TxO = val; break;\r\n\r\n                    case 'HLink': {\r\n                        for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\r\n                            for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC)\r\n                                if (out[encode_cell({ c: rngC, r: rngR })])\r\n                                    out[encode_cell({ c: rngC, r: rngR })].l = val[1];\r\n                    } break;\r\n                    case 'HLinkTooltip': {\r\n                        for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\r\n                            for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC)\r\n                                if (out[encode_cell({ c: rngC, r: rngR })])\r\n                                    out[encode_cell({ c: rngC, r: rngR })].l.tooltip = val[1];\r\n                    } break;\r\n\r\n                    /* Comments */\r\n                    case 'Note': {\r\n                        if (opts.biff <= 5 && opts.biff >= 2) break; /* TODO: BIFF5 */\r\n                        cc = out[encode_cell(val[0])];\r\n                        var noteobj = objects[val[2]];\r\n                        if (!cc) break;\r\n                        if (!cc.c) cc.c = [];\r\n                        cmnt = { a: val[1], t: noteobj.TxO.t };\r\n                        cc.c.push(cmnt);\r\n                    } break;\r\n\r\n                    default: switch (R.n) { /* nested */\r\n                        case 'ClrtClient': break;\r\n                        case 'XFExt': update_xfext(XFs[val.ixfe], val.ext); break;\r\n\r\n                        case 'NameCmt': break;\r\n                        case 'Header': break; // TODO\r\n                        case 'Footer': break; // TODO\r\n                        case 'HCenter': break; // TODO\r\n                        case 'VCenter': break; // TODO\r\n                        case 'Pls': break; // TODO\r\n                        case 'Setup': break; // TODO\r\n                        case 'DefColWidth': break; // TODO\r\n                        case 'GCW': break;\r\n                        case 'LHRecord': break;\r\n                        case 'ColInfo': break; // TODO\r\n                        case 'Row': break; // TODO\r\n                        case 'DBCell': break; // TODO\r\n                        case 'MulBlank': break; // TODO\r\n                        case 'EntExU2': break; // TODO\r\n                        case 'SxView': break; // TODO\r\n                        case 'Sxvd': break; // TODO\r\n                        case 'SXVI': break; // TODO\r\n                        case 'SXVDEx': break; // TODO\r\n                        case 'SxIvd': break; // TODO\r\n                        case 'SXDI': break; // TODO\r\n                        case 'SXLI': break; // TODO\r\n                        case 'SXEx': break; // TODO\r\n                        case 'QsiSXTag': break; // TODO\r\n                        case 'Selection': break;\r\n                        case 'Feat': break;\r\n                        case 'FeatHdr': case 'FeatHdr11': break;\r\n                        case 'Feature11': case 'Feature12': case 'List12': break;\r\n                        case 'Blank': break;\r\n                        case 'Country': country = val; break;\r\n                        case 'RecalcId': break;\r\n                        case 'DefaultRowHeight': case 'DxGCol': break; // TODO: htmlify\r\n                        case 'Fbi': case 'Fbi2': case 'GelFrame': break;\r\n                        case 'Font': break; // TODO\r\n                        case 'XFCRC': break; // TODO\r\n                        case 'Style': break; // TODO\r\n                        case 'StyleExt': break; // TODO\r\n                        case 'Palette': palette = val; break; // TODO\r\n                        case 'Theme': break; // TODO\r\n                        /* Protection */\r\n                        case 'ScenarioProtect': break;\r\n                        case 'ObjProtect': break;\r\n\r\n                        /* Conditional Formatting */\r\n                        case 'CondFmt12': break;\r\n\r\n                        /* Table */\r\n                        case 'Table': break; // TODO\r\n                        case 'TableStyles': break; // TODO\r\n                        case 'TableStyle': break; // TODO\r\n                        case 'TableStyleElement': break; // TODO\r\n\r\n                        /* PivotTable */\r\n                        case 'SXStreamID': break; // TODO\r\n                        case 'SXVS': break; // TODO\r\n                        case 'DConRef': break; // TODO\r\n                        case 'SXAddl': break; // TODO\r\n                        case 'DConBin': break; // TODO\r\n                        case 'DConName': break; // TODO\r\n                        case 'SXPI': break; // TODO\r\n                        case 'SxFormat': break; // TODO\r\n                        case 'SxSelect': break; // TODO\r\n                        case 'SxRule': break; // TODO\r\n                        case 'SxFilt': break; // TODO\r\n                        case 'SxItm': break; // TODO\r\n                        case 'SxDXF': break; // TODO\r\n\r\n                        /* Scenario Manager */\r\n                        case 'ScenMan': break;\r\n\r\n                        /* Data Consolidation */\r\n                        case 'DCon': break;\r\n\r\n                        /* Watched Cell */\r\n                        case 'CellWatch': break;\r\n\r\n                        /* Print Settings */\r\n                        case 'PrintRowCol': break;\r\n                        case 'PrintGrid': break;\r\n                        case 'PrintSize': break;\r\n\r\n                        case 'XCT': break;\r\n                        case 'CRN': break;\r\n\r\n                        case 'Scl': {\r\n                            //console.log(\"Zoom Level:\", val[0]/val[1],val);\r\n                        } break;\r\n                        case 'SheetExt': {\r\n\r\n                        } break;\r\n                        case 'SheetExtOptional': {\r\n\r\n                        } break;\r\n\r\n                        /* VBA */\r\n                        case 'ObNoMacros': {\r\n\r\n                        } break;\r\n                        case 'ObProj': {\r\n\r\n                        } break;\r\n                        case 'CodeName': {\r\n\r\n                        } break;\r\n                        case 'GUIDTypeLib': {\r\n\r\n                        } break;\r\n\r\n                        case 'WOpt': break; // TODO: WTF?\r\n                        case 'PhoneticInfo': break;\r\n\r\n                        case 'OleObjectSize': break;\r\n\r\n                        /* Differential Formatting */\r\n                        case 'DXF': case 'DXFN': case 'DXFN12': case 'DXFN12List': case 'DXFN12NoCB': break;\r\n\r\n                        /* Data Validation */\r\n                        case 'Dv': case 'DVal': break;\r\n\r\n                        /* Data Series */\r\n                        case 'BRAI': case 'Series': case 'SeriesText': break;\r\n\r\n                        /* Data Connection */\r\n                        case 'DConn': break;\r\n                        case 'DbOrParamQry': break;\r\n                        case 'DBQueryExt': break;\r\n\r\n                        /* Formatting */\r\n                        case 'IFmtRecord': break;\r\n                        case 'CondFmt': case 'CF': case 'CF12': case 'CFEx': break;\r\n\r\n                        /* Explicitly Ignored */\r\n                        case 'Excel9File': break;\r\n                        case 'Units': break;\r\n                        case 'InterfaceHdr': case 'Mms': case 'InterfaceEnd': case 'DSF': case 'BuiltInFnGroupCount':\r\n                        /* View Stuff */\r\n                        case 'Window1': case 'Window2': case 'HideObj': case 'GridSet': case 'Guts':\r\n                        case 'UserBView': case 'UserSViewBegin': case 'UserSViewEnd':\r\n                        case 'Pane': break;\r\n                        default: switch (R.n) { /* nested */\r\n                            /* Chart */\r\n                            case 'Dat':\r\n                            case 'Begin': case 'End':\r\n                            case 'StartBlock': case 'EndBlock':\r\n                            case 'Frame': case 'Area':\r\n                            case 'Axis': case 'AxisLine': case 'Tick': break;\r\n                            case 'AxesUsed':\r\n                            case 'CrtLayout12': case 'CrtLayout12A': case 'CrtLink': case 'CrtLine': case 'CrtMlFrt': case 'CrtMlFrtContinue': break;\r\n                            case 'LineFormat': case 'AreaFormat':\r\n                            case 'Chart': case 'Chart3d': case 'Chart3DBarShape': case 'ChartFormat': case 'ChartFrtInfo': break;\r\n                            case 'PlotArea': case 'PlotGrowth': break;\r\n                            case 'SeriesList': case 'SerParent': case 'SerAuxTrend': break;\r\n                            case 'DataFormat': case 'SerToCrt': case 'FontX': break;\r\n                            case 'CatSerRange': case 'AxcExt': case 'SerFmt': break;\r\n                            case 'ShtProps': break;\r\n                            case 'DefaultText': case 'Text': case 'CatLab': break;\r\n                            case 'DataLabExtContents': break;\r\n                            case 'Legend': case 'LegendException': break;\r\n                            case 'Pie': case 'Scatter': break;\r\n                            case 'PieFormat': case 'MarkerFormat': break;\r\n                            case 'StartObject': case 'EndObject': break;\r\n                            case 'AlRuns': case 'ObjectLink': break;\r\n                            case 'SIIndex': break;\r\n                            case 'AttachedLabel': case 'YMult': break;\r\n\r\n                            /* Chart Group */\r\n                            case 'Line': case 'Bar': break;\r\n                            case 'Surf': break;\r\n\r\n                            /* Axis Group */\r\n                            case 'AxisParent': break;\r\n                            case 'Pos': break;\r\n                            case 'ValueRange': break;\r\n\r\n                            /* Pivot Chart */\r\n                            case 'SXViewEx9': break; // TODO\r\n                            case 'SXViewLink': break;\r\n                            case 'PivotChartBits': break;\r\n                            case 'SBaseRef': break;\r\n                            case 'TextPropsStream': break;\r\n\r\n                            /* Chart Misc */\r\n                            case 'LnExt': break;\r\n                            case 'MkrExt': break;\r\n                            case 'CrtCoopt': break;\r\n\r\n                            /* Query Table */\r\n                            case 'Qsi': case 'Qsif': case 'Qsir': case 'QsiSXTag': break;\r\n                            case 'TxtQry': break;\r\n\r\n                            /* Filter */\r\n                            case 'FilterMode': break;\r\n                            case 'AutoFilter': case 'AutoFilterInfo': break;\r\n                            case 'AutoFilter12': break;\r\n                            case 'DropDownObjIds': break;\r\n                            case 'Sort': break;\r\n                            case 'SortData': break;\r\n\r\n                            /* Drawing */\r\n                            case 'ShapePropsStream': break;\r\n                            case 'MsoDrawing': case 'MsoDrawingGroup': case 'MsoDrawingSelection': break;\r\n                            case 'ImData': break;\r\n                            /* Pub Stuff */\r\n                            case 'WebPub': case 'AutoWebPub':\r\n\r\n                            /* Print Stuff */\r\n                            case 'RightMargin': case 'LeftMargin': case 'TopMargin': case 'BottomMargin':\r\n                            case 'HeaderFooter': case 'HFPicture': case 'PLV':\r\n                            case 'HorizontalPageBreaks': case 'VerticalPageBreaks':\r\n                            /* Behavioral */\r\n                            case 'Backup': case 'CompressPictures': case 'Compat12': break;\r\n\r\n                            /* Should not Happen */\r\n                            case 'Continue': case 'ContinueFrt12': break;\r\n\r\n                            /* Future Records */\r\n                            case 'FrtFontList': case 'FrtWrapper': break;\r\n\r\n                            /* BIFF5 records */\r\n                            case 'ExternCount': break;\r\n                            case 'RString': break;\r\n                            case 'TabIdConf': case 'Radar': case 'RadarArea': case 'DropBar': case 'Intl': case 'CoordList': case 'SerAuxErrBar': break;\r\n\r\n                            default: switch (R.n) { /* nested */\r\n                                /* Miscellaneous */\r\n                                case 'SCENARIO': case 'DConBin': case 'PicF': case 'DataLabExt':\r\n                                case 'Lel': case 'BopPop': case 'BopPopCustom': case 'RealTimeData':\r\n                                case 'Name': break;\r\n                                default: if (options.WTF) throw 'Unrecognized Record ' + R.n;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            } else blob.l += length;\r\n        }\r\n        var sheetnamesraw = opts.biff === 2 ? ['Sheet1'] : Object.keys(Directory).sort(function (a, b) { return Number(a) - Number(b); }).map(function (x) { return Directory[x].name; });\r\n        var sheetnames = sheetnamesraw.slice();\r\n        wb.Directory = sheetnamesraw;\r\n        wb.SheetNames = sheetnamesraw;\r\n        if (!options.bookSheets) wb.Sheets = Sheets;\r\n        wb.Preamble = Preamble;\r\n        wb.Strings = sst;\r\n        wb.SSF = SSF.get_table();\r\n        if (opts.enc) wb.Encryption = opts.enc;\r\n        wb.Metadata = {};\r\n        if (country !== undefined) wb.Metadata.Country = country;\r\n        return wb;\r\n    }\r\n\r\n    function parse_xlscfb(cfb, options) {\r\n        if (!options) options = {};\r\n        fix_read_opts(options);\r\n        reset_cp();\r\n        var CompObj, Summary, Workbook;\r\n        if (cfb.find) {\r\n            CompObj = cfb.find('!CompObj');\r\n            Summary = cfb.find('!SummaryInformation');\r\n            Workbook = cfb.find('/Workbook');\r\n        } else {\r\n            prep_blob(cfb, 0);\r\n            Workbook = { content: cfb };\r\n        }\r\n\r\n        if (!Workbook) Workbook = cfb.find('/Book');\r\n        var CompObjP, SummaryP, WorkbookP;\r\n\r\n        if (CompObj) CompObjP = parse_compobj(CompObj);\r\n        if (options.bookProps && !options.bookSheets) WorkbookP = {};\r\n        else {\r\n            if (Workbook) WorkbookP = parse_workbook(Workbook.content, options, !!Workbook.find);\r\n            else throw new Error(\"Cannot find Workbook stream\");\r\n        }\r\n\r\n        if (cfb.find) parse_props(cfb);\r\n\r\n        var props = {};\r\n        for (var y in cfb.Summary) props[y] = cfb.Summary[y];\r\n        for (y in cfb.DocSummary) props[y] = cfb.DocSummary[y];\r\n        WorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\r\n        if (options.bookFiles) WorkbookP.cfb = cfb;\r\n        WorkbookP.CompObjP = CompObjP;\r\n        return WorkbookP;\r\n    }\r\n\r\n    /* TODO: WTF */\r\n    function parse_props(cfb) {\r\n        /* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\r\n        var DSI = cfb.find('!DocumentSummaryInformation');\r\n        if (DSI) try { cfb.DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI); } catch (e) { }\r\n\r\n        /* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\r\n        var SI = cfb.find('!SummaryInformation');\r\n        if (SI) try { cfb.Summary = parse_PropertySetStream(SI, SummaryPIDSI); } catch (e) { }\r\n    }\r\n\r\n    /* [MS-XLSB] 2.3 Record Enumeration */\r\n    var XLSBRecordEnum = {\r\n        0x0000: { n: \"BrtRowHdr\", f: parse_BrtRowHdr },\r\n        0x0001: { n: \"BrtCellBlank\", f: parse_BrtCellBlank },\r\n        0x0002: { n: \"BrtCellRk\", f: parse_BrtCellRk },\r\n        0x0003: { n: \"BrtCellError\", f: parse_BrtCellError },\r\n        0x0004: { n: \"BrtCellBool\", f: parse_BrtCellBool },\r\n        0x0005: { n: \"BrtCellReal\", f: parse_BrtCellReal },\r\n        0x0006: { n: \"BrtCellSt\", f: parse_BrtCellSt },\r\n        0x0007: { n: \"BrtCellIsst\", f: parse_BrtCellIsst },\r\n        0x0008: { n: \"BrtFmlaString\", f: parse_BrtFmlaString },\r\n        0x0009: { n: \"BrtFmlaNum\", f: parse_BrtFmlaNum },\r\n        0x000A: { n: \"BrtFmlaBool\", f: parse_BrtFmlaBool },\r\n        0x000B: { n: \"BrtFmlaError\", f: parse_BrtFmlaError },\r\n        0x0010: { n: \"BrtFRTArchID$\", f: parse_BrtFRTArchID$ },\r\n        0x0013: { n: \"BrtSSTItem\", f: parse_RichStr },\r\n        0x0014: { n: \"BrtPCDIMissing\", f: parsenoop },\r\n        0x0015: { n: \"BrtPCDINumber\", f: parsenoop },\r\n        0x0016: { n: \"BrtPCDIBoolean\", f: parsenoop },\r\n        0x0017: { n: \"BrtPCDIError\", f: parsenoop },\r\n        0x0018: { n: \"BrtPCDIString\", f: parsenoop },\r\n        0x0019: { n: \"BrtPCDIDatetime\", f: parsenoop },\r\n        0x001A: { n: \"BrtPCDIIndex\", f: parsenoop },\r\n        0x001B: { n: \"BrtPCDIAMissing\", f: parsenoop },\r\n        0x001C: { n: \"BrtPCDIANumber\", f: parsenoop },\r\n        0x001D: { n: \"BrtPCDIABoolean\", f: parsenoop },\r\n        0x001E: { n: \"BrtPCDIAError\", f: parsenoop },\r\n        0x001F: { n: \"BrtPCDIAString\", f: parsenoop },\r\n        0x0020: { n: \"BrtPCDIADatetime\", f: parsenoop },\r\n        0x0021: { n: \"BrtPCRRecord\", f: parsenoop },\r\n        0x0022: { n: \"BrtPCRRecordDt\", f: parsenoop },\r\n        0x0023: { n: \"BrtFRTBegin\", f: parsenoop },\r\n        0x0024: { n: \"BrtFRTEnd\", f: parsenoop },\r\n        0x0025: { n: \"BrtACBegin\", f: parsenoop },\r\n        0x0026: { n: \"BrtACEnd\", f: parsenoop },\r\n        0x0027: { n: \"BrtName\", f: parsenoop },\r\n        0x0028: { n: \"BrtIndexRowBlock\", f: parsenoop },\r\n        0x002A: { n: \"BrtIndexBlock\", f: parsenoop },\r\n        0x002B: { n: \"BrtFont\", f: parse_BrtFont },\r\n        0x002C: { n: \"BrtFmt\", f: parse_BrtFmt },\r\n        0x002D: { n: \"BrtFill\", f: parsenoop },\r\n        0x002E: { n: \"BrtBorder\", f: parsenoop },\r\n        0x002F: { n: \"BrtXF\", f: parse_BrtXF },\r\n        0x0030: { n: \"BrtStyle\", f: parsenoop },\r\n        0x0031: { n: \"BrtCellMeta\", f: parsenoop },\r\n        0x0032: { n: \"BrtValueMeta\", f: parsenoop },\r\n        0x0033: { n: \"BrtMdb\", f: parsenoop },\r\n        0x0034: { n: \"BrtBeginFmd\", f: parsenoop },\r\n        0x0035: { n: \"BrtEndFmd\", f: parsenoop },\r\n        0x0036: { n: \"BrtBeginMdx\", f: parsenoop },\r\n        0x0037: { n: \"BrtEndMdx\", f: parsenoop },\r\n        0x0038: { n: \"BrtBeginMdxTuple\", f: parsenoop },\r\n        0x0039: { n: \"BrtEndMdxTuple\", f: parsenoop },\r\n        0x003A: { n: \"BrtMdxMbrIstr\", f: parsenoop },\r\n        0x003B: { n: \"BrtStr\", f: parsenoop },\r\n        0x003C: { n: \"BrtColInfo\", f: parsenoop },\r\n        0x003E: { n: \"BrtCellRString\", f: parsenoop },\r\n        0x003F: { n: \"BrtCalcChainItem$\", f: parse_BrtCalcChainItem$ },\r\n        0x0040: { n: \"BrtDVal\", f: parsenoop },\r\n        0x0041: { n: \"BrtSxvcellNum\", f: parsenoop },\r\n        0x0042: { n: \"BrtSxvcellStr\", f: parsenoop },\r\n        0x0043: { n: \"BrtSxvcellBool\", f: parsenoop },\r\n        0x0044: { n: \"BrtSxvcellErr\", f: parsenoop },\r\n        0x0045: { n: \"BrtSxvcellDate\", f: parsenoop },\r\n        0x0046: { n: \"BrtSxvcellNil\", f: parsenoop },\r\n        0x0080: { n: \"BrtFileVersion\", f: parsenoop },\r\n        0x0081: { n: \"BrtBeginSheet\", f: parsenoop },\r\n        0x0082: { n: \"BrtEndSheet\", f: parsenoop },\r\n        0x0083: { n: \"BrtBeginBook\", f: parsenoop, p: 0 },\r\n        0x0084: { n: \"BrtEndBook\", f: parsenoop },\r\n        0x0085: { n: \"BrtBeginWsViews\", f: parsenoop },\r\n        0x0086: { n: \"BrtEndWsViews\", f: parsenoop },\r\n        0x0087: { n: \"BrtBeginBookViews\", f: parsenoop },\r\n        0x0088: { n: \"BrtEndBookViews\", f: parsenoop },\r\n        0x0089: { n: \"BrtBeginWsView\", f: parsenoop },\r\n        0x008A: { n: \"BrtEndWsView\", f: parsenoop },\r\n        0x008B: { n: \"BrtBeginCsViews\", f: parsenoop },\r\n        0x008C: { n: \"BrtEndCsViews\", f: parsenoop },\r\n        0x008D: { n: \"BrtBeginCsView\", f: parsenoop },\r\n        0x008E: { n: \"BrtEndCsView\", f: parsenoop },\r\n        0x008F: { n: \"BrtBeginBundleShs\", f: parsenoop },\r\n        0x0090: { n: \"BrtEndBundleShs\", f: parsenoop },\r\n        0x0091: { n: \"BrtBeginSheetData\", f: parsenoop },\r\n        0x0092: { n: \"BrtEndSheetData\", f: parsenoop },\r\n        0x0093: { n: \"BrtWsProp\", f: parse_BrtWsProp },\r\n        0x0094: { n: \"BrtWsDim\", f: parse_BrtWsDim, p: 16 },\r\n        0x0097: { n: \"BrtPane\", f: parsenoop },\r\n        0x0098: { n: \"BrtSel\", f: parsenoop },\r\n        0x0099: { n: \"BrtWbProp\", f: parse_BrtWbProp },\r\n        0x009A: { n: \"BrtWbFactoid\", f: parsenoop },\r\n        0x009B: { n: \"BrtFileRecover\", f: parsenoop },\r\n        0x009C: { n: \"BrtBundleSh\", f: parse_BrtBundleSh },\r\n        0x009D: { n: \"BrtCalcProp\", f: parsenoop },\r\n        0x009E: { n: \"BrtBookView\", f: parsenoop },\r\n        0x009F: { n: \"BrtBeginSst\", f: parse_BrtBeginSst },\r\n        0x00A0: { n: \"BrtEndSst\", f: parsenoop },\r\n        0x00A1: { n: \"BrtBeginAFilter\", f: parsenoop },\r\n        0x00A2: { n: \"BrtEndAFilter\", f: parsenoop },\r\n        0x00A3: { n: \"BrtBeginFilterColumn\", f: parsenoop },\r\n        0x00A4: { n: \"BrtEndFilterColumn\", f: parsenoop },\r\n        0x00A5: { n: \"BrtBeginFilters\", f: parsenoop },\r\n        0x00A6: { n: \"BrtEndFilters\", f: parsenoop },\r\n        0x00A7: { n: \"BrtFilter\", f: parsenoop },\r\n        0x00A8: { n: \"BrtColorFilter\", f: parsenoop },\r\n        0x00A9: { n: \"BrtIconFilter\", f: parsenoop },\r\n        0x00AA: { n: \"BrtTop10Filter\", f: parsenoop },\r\n        0x00AB: { n: \"BrtDynamicFilter\", f: parsenoop },\r\n        0x00AC: { n: \"BrtBeginCustomFilters\", f: parsenoop },\r\n        0x00AD: { n: \"BrtEndCustomFilters\", f: parsenoop },\r\n        0x00AE: { n: \"BrtCustomFilter\", f: parsenoop },\r\n        0x00AF: { n: \"BrtAFilterDateGroupItem\", f: parsenoop },\r\n        0x00B0: { n: \"BrtMergeCell\", f: parse_BrtMergeCell },\r\n        0x00B1: { n: \"BrtBeginMergeCells\", f: parsenoop },\r\n        0x00B2: { n: \"BrtEndMergeCells\", f: parsenoop },\r\n        0x00B3: { n: \"BrtBeginPivotCacheDef\", f: parsenoop },\r\n        0x00B4: { n: \"BrtEndPivotCacheDef\", f: parsenoop },\r\n        0x00B5: { n: \"BrtBeginPCDFields\", f: parsenoop },\r\n        0x00B6: { n: \"BrtEndPCDFields\", f: parsenoop },\r\n        0x00B7: { n: \"BrtBeginPCDField\", f: parsenoop },\r\n        0x00B8: { n: \"BrtEndPCDField\", f: parsenoop },\r\n        0x00B9: { n: \"BrtBeginPCDSource\", f: parsenoop },\r\n        0x00BA: { n: \"BrtEndPCDSource\", f: parsenoop },\r\n        0x00BB: { n: \"BrtBeginPCDSRange\", f: parsenoop },\r\n        0x00BC: { n: \"BrtEndPCDSRange\", f: parsenoop },\r\n        0x00BD: { n: \"BrtBeginPCDFAtbl\", f: parsenoop },\r\n        0x00BE: { n: \"BrtEndPCDFAtbl\", f: parsenoop },\r\n        0x00BF: { n: \"BrtBeginPCDIRun\", f: parsenoop },\r\n        0x00C0: { n: \"BrtEndPCDIRun\", f: parsenoop },\r\n        0x00C1: { n: \"BrtBeginPivotCacheRecords\", f: parsenoop },\r\n        0x00C2: { n: \"BrtEndPivotCacheRecords\", f: parsenoop },\r\n        0x00C3: { n: \"BrtBeginPCDHierarchies\", f: parsenoop },\r\n        0x00C4: { n: \"BrtEndPCDHierarchies\", f: parsenoop },\r\n        0x00C5: { n: \"BrtBeginPCDHierarchy\", f: parsenoop },\r\n        0x00C6: { n: \"BrtEndPCDHierarchy\", f: parsenoop },\r\n        0x00C7: { n: \"BrtBeginPCDHFieldsUsage\", f: parsenoop },\r\n        0x00C8: { n: \"BrtEndPCDHFieldsUsage\", f: parsenoop },\r\n        0x00C9: { n: \"BrtBeginExtConnection\", f: parsenoop },\r\n        0x00CA: { n: \"BrtEndExtConnection\", f: parsenoop },\r\n        0x00CB: { n: \"BrtBeginECDbProps\", f: parsenoop },\r\n        0x00CC: { n: \"BrtEndECDbProps\", f: parsenoop },\r\n        0x00CD: { n: \"BrtBeginECOlapProps\", f: parsenoop },\r\n        0x00CE: { n: \"BrtEndECOlapProps\", f: parsenoop },\r\n        0x00CF: { n: \"BrtBeginPCDSConsol\", f: parsenoop },\r\n        0x00D0: { n: \"BrtEndPCDSConsol\", f: parsenoop },\r\n        0x00D1: { n: \"BrtBeginPCDSCPages\", f: parsenoop },\r\n        0x00D2: { n: \"BrtEndPCDSCPages\", f: parsenoop },\r\n        0x00D3: { n: \"BrtBeginPCDSCPage\", f: parsenoop },\r\n        0x00D4: { n: \"BrtEndPCDSCPage\", f: parsenoop },\r\n        0x00D5: { n: \"BrtBeginPCDSCPItem\", f: parsenoop },\r\n        0x00D6: { n: \"BrtEndPCDSCPItem\", f: parsenoop },\r\n        0x00D7: { n: \"BrtBeginPCDSCSets\", f: parsenoop },\r\n        0x00D8: { n: \"BrtEndPCDSCSets\", f: parsenoop },\r\n        0x00D9: { n: \"BrtBeginPCDSCSet\", f: parsenoop },\r\n        0x00DA: { n: \"BrtEndPCDSCSet\", f: parsenoop },\r\n        0x00DB: { n: \"BrtBeginPCDFGroup\", f: parsenoop },\r\n        0x00DC: { n: \"BrtEndPCDFGroup\", f: parsenoop },\r\n        0x00DD: { n: \"BrtBeginPCDFGItems\", f: parsenoop },\r\n        0x00DE: { n: \"BrtEndPCDFGItems\", f: parsenoop },\r\n        0x00DF: { n: \"BrtBeginPCDFGRange\", f: parsenoop },\r\n        0x00E0: { n: \"BrtEndPCDFGRange\", f: parsenoop },\r\n        0x00E1: { n: \"BrtBeginPCDFGDiscrete\", f: parsenoop },\r\n        0x00E2: { n: \"BrtEndPCDFGDiscrete\", f: parsenoop },\r\n        0x00E3: { n: \"BrtBeginPCDSDTupleCache\", f: parsenoop },\r\n        0x00E4: { n: \"BrtEndPCDSDTupleCache\", f: parsenoop },\r\n        0x00E5: { n: \"BrtBeginPCDSDTCEntries\", f: parsenoop },\r\n        0x00E6: { n: \"BrtEndPCDSDTCEntries\", f: parsenoop },\r\n        0x00E7: { n: \"BrtBeginPCDSDTCEMembers\", f: parsenoop },\r\n        0x00E8: { n: \"BrtEndPCDSDTCEMembers\", f: parsenoop },\r\n        0x00E9: { n: \"BrtBeginPCDSDTCEMember\", f: parsenoop },\r\n        0x00EA: { n: \"BrtEndPCDSDTCEMember\", f: parsenoop },\r\n        0x00EB: { n: \"BrtBeginPCDSDTCQueries\", f: parsenoop },\r\n        0x00EC: { n: \"BrtEndPCDSDTCQueries\", f: parsenoop },\r\n        0x00ED: { n: \"BrtBeginPCDSDTCQuery\", f: parsenoop },\r\n        0x00EE: { n: \"BrtEndPCDSDTCQuery\", f: parsenoop },\r\n        0x00EF: { n: \"BrtBeginPCDSDTCSets\", f: parsenoop },\r\n        0x00F0: { n: \"BrtEndPCDSDTCSets\", f: parsenoop },\r\n        0x00F1: { n: \"BrtBeginPCDSDTCSet\", f: parsenoop },\r\n        0x00F2: { n: \"BrtEndPCDSDTCSet\", f: parsenoop },\r\n        0x00F3: { n: \"BrtBeginPCDCalcItems\", f: parsenoop },\r\n        0x00F4: { n: \"BrtEndPCDCalcItems\", f: parsenoop },\r\n        0x00F5: { n: \"BrtBeginPCDCalcItem\", f: parsenoop },\r\n        0x00F6: { n: \"BrtEndPCDCalcItem\", f: parsenoop },\r\n        0x00F7: { n: \"BrtBeginPRule\", f: parsenoop },\r\n        0x00F8: { n: \"BrtEndPRule\", f: parsenoop },\r\n        0x00F9: { n: \"BrtBeginPRFilters\", f: parsenoop },\r\n        0x00FA: { n: \"BrtEndPRFilters\", f: parsenoop },\r\n        0x00FB: { n: \"BrtBeginPRFilter\", f: parsenoop },\r\n        0x00FC: { n: \"BrtEndPRFilter\", f: parsenoop },\r\n        0x00FD: { n: \"BrtBeginPNames\", f: parsenoop },\r\n        0x00FE: { n: \"BrtEndPNames\", f: parsenoop },\r\n        0x00FF: { n: \"BrtBeginPName\", f: parsenoop },\r\n        0x0100: { n: \"BrtEndPName\", f: parsenoop },\r\n        0x0101: { n: \"BrtBeginPNPairs\", f: parsenoop },\r\n        0x0102: { n: \"BrtEndPNPairs\", f: parsenoop },\r\n        0x0103: { n: \"BrtBeginPNPair\", f: parsenoop },\r\n        0x0104: { n: \"BrtEndPNPair\", f: parsenoop },\r\n        0x0105: { n: \"BrtBeginECWebProps\", f: parsenoop },\r\n        0x0106: { n: \"BrtEndECWebProps\", f: parsenoop },\r\n        0x0107: { n: \"BrtBeginEcWpTables\", f: parsenoop },\r\n        0x0108: { n: \"BrtEndECWPTables\", f: parsenoop },\r\n        0x0109: { n: \"BrtBeginECParams\", f: parsenoop },\r\n        0x010A: { n: \"BrtEndECParams\", f: parsenoop },\r\n        0x010B: { n: \"BrtBeginECParam\", f: parsenoop },\r\n        0x010C: { n: \"BrtEndECParam\", f: parsenoop },\r\n        0x010D: { n: \"BrtBeginPCDKPIs\", f: parsenoop },\r\n        0x010E: { n: \"BrtEndPCDKPIs\", f: parsenoop },\r\n        0x010F: { n: \"BrtBeginPCDKPI\", f: parsenoop },\r\n        0x0110: { n: \"BrtEndPCDKPI\", f: parsenoop },\r\n        0x0111: { n: \"BrtBeginDims\", f: parsenoop },\r\n        0x0112: { n: \"BrtEndDims\", f: parsenoop },\r\n        0x0113: { n: \"BrtBeginDim\", f: parsenoop },\r\n        0x0114: { n: \"BrtEndDim\", f: parsenoop },\r\n        0x0115: { n: \"BrtIndexPartEnd\", f: parsenoop },\r\n        0x0116: { n: \"BrtBeginStyleSheet\", f: parsenoop },\r\n        0x0117: { n: \"BrtEndStyleSheet\", f: parsenoop },\r\n        0x0118: { n: \"BrtBeginSXView\", f: parsenoop },\r\n        0x0119: { n: \"BrtEndSXVI\", f: parsenoop },\r\n        0x011A: { n: \"BrtBeginSXVI\", f: parsenoop },\r\n        0x011B: { n: \"BrtBeginSXVIs\", f: parsenoop },\r\n        0x011C: { n: \"BrtEndSXVIs\", f: parsenoop },\r\n        0x011D: { n: \"BrtBeginSXVD\", f: parsenoop },\r\n        0x011E: { n: \"BrtEndSXVD\", f: parsenoop },\r\n        0x011F: { n: \"BrtBeginSXVDs\", f: parsenoop },\r\n        0x0120: { n: \"BrtEndSXVDs\", f: parsenoop },\r\n        0x0121: { n: \"BrtBeginSXPI\", f: parsenoop },\r\n        0x0122: { n: \"BrtEndSXPI\", f: parsenoop },\r\n        0x0123: { n: \"BrtBeginSXPIs\", f: parsenoop },\r\n        0x0124: { n: \"BrtEndSXPIs\", f: parsenoop },\r\n        0x0125: { n: \"BrtBeginSXDI\", f: parsenoop },\r\n        0x0126: { n: \"BrtEndSXDI\", f: parsenoop },\r\n        0x0127: { n: \"BrtBeginSXDIs\", f: parsenoop },\r\n        0x0128: { n: \"BrtEndSXDIs\", f: parsenoop },\r\n        0x0129: { n: \"BrtBeginSXLI\", f: parsenoop },\r\n        0x012A: { n: \"BrtEndSXLI\", f: parsenoop },\r\n        0x012B: { n: \"BrtBeginSXLIRws\", f: parsenoop },\r\n        0x012C: { n: \"BrtEndSXLIRws\", f: parsenoop },\r\n        0x012D: { n: \"BrtBeginSXLICols\", f: parsenoop },\r\n        0x012E: { n: \"BrtEndSXLICols\", f: parsenoop },\r\n        0x012F: { n: \"BrtBeginSXFormat\", f: parsenoop },\r\n        0x0130: { n: \"BrtEndSXFormat\", f: parsenoop },\r\n        0x0131: { n: \"BrtBeginSXFormats\", f: parsenoop },\r\n        0x0132: { n: \"BrtEndSxFormats\", f: parsenoop },\r\n        0x0133: { n: \"BrtBeginSxSelect\", f: parsenoop },\r\n        0x0134: { n: \"BrtEndSxSelect\", f: parsenoop },\r\n        0x0135: { n: \"BrtBeginISXVDRws\", f: parsenoop },\r\n        0x0136: { n: \"BrtEndISXVDRws\", f: parsenoop },\r\n        0x0137: { n: \"BrtBeginISXVDCols\", f: parsenoop },\r\n        0x0138: { n: \"BrtEndISXVDCols\", f: parsenoop },\r\n        0x0139: { n: \"BrtEndSXLocation\", f: parsenoop },\r\n        0x013A: { n: \"BrtBeginSXLocation\", f: parsenoop },\r\n        0x013B: { n: \"BrtEndSXView\", f: parsenoop },\r\n        0x013C: { n: \"BrtBeginSXTHs\", f: parsenoop },\r\n        0x013D: { n: \"BrtEndSXTHs\", f: parsenoop },\r\n        0x013E: { n: \"BrtBeginSXTH\", f: parsenoop },\r\n        0x013F: { n: \"BrtEndSXTH\", f: parsenoop },\r\n        0x0140: { n: \"BrtBeginISXTHRws\", f: parsenoop },\r\n        0x0141: { n: \"BrtEndISXTHRws\", f: parsenoop },\r\n        0x0142: { n: \"BrtBeginISXTHCols\", f: parsenoop },\r\n        0x0143: { n: \"BrtEndISXTHCols\", f: parsenoop },\r\n        0x0144: { n: \"BrtBeginSXTDMPS\", f: parsenoop },\r\n        0x0145: { n: \"BrtEndSXTDMPs\", f: parsenoop },\r\n        0x0146: { n: \"BrtBeginSXTDMP\", f: parsenoop },\r\n        0x0147: { n: \"BrtEndSXTDMP\", f: parsenoop },\r\n        0x0148: { n: \"BrtBeginSXTHItems\", f: parsenoop },\r\n        0x0149: { n: \"BrtEndSXTHItems\", f: parsenoop },\r\n        0x014A: { n: \"BrtBeginSXTHItem\", f: parsenoop },\r\n        0x014B: { n: \"BrtEndSXTHItem\", f: parsenoop },\r\n        0x014C: { n: \"BrtBeginMetadata\", f: parsenoop },\r\n        0x014D: { n: \"BrtEndMetadata\", f: parsenoop },\r\n        0x014E: { n: \"BrtBeginEsmdtinfo\", f: parsenoop },\r\n        0x014F: { n: \"BrtMdtinfo\", f: parsenoop },\r\n        0x0150: { n: \"BrtEndEsmdtinfo\", f: parsenoop },\r\n        0x0151: { n: \"BrtBeginEsmdb\", f: parsenoop },\r\n        0x0152: { n: \"BrtEndEsmdb\", f: parsenoop },\r\n        0x0153: { n: \"BrtBeginEsfmd\", f: parsenoop },\r\n        0x0154: { n: \"BrtEndEsfmd\", f: parsenoop },\r\n        0x0155: { n: \"BrtBeginSingleCells\", f: parsenoop },\r\n        0x0156: { n: \"BrtEndSingleCells\", f: parsenoop },\r\n        0x0157: { n: \"BrtBeginList\", f: parsenoop },\r\n        0x0158: { n: \"BrtEndList\", f: parsenoop },\r\n        0x0159: { n: \"BrtBeginListCols\", f: parsenoop },\r\n        0x015A: { n: \"BrtEndListCols\", f: parsenoop },\r\n        0x015B: { n: \"BrtBeginListCol\", f: parsenoop },\r\n        0x015C: { n: \"BrtEndListCol\", f: parsenoop },\r\n        0x015D: { n: \"BrtBeginListXmlCPr\", f: parsenoop },\r\n        0x015E: { n: \"BrtEndListXmlCPr\", f: parsenoop },\r\n        0x015F: { n: \"BrtListCCFmla\", f: parsenoop },\r\n        0x0160: { n: \"BrtListTrFmla\", f: parsenoop },\r\n        0x0161: { n: \"BrtBeginExternals\", f: parsenoop },\r\n        0x0162: { n: \"BrtEndExternals\", f: parsenoop },\r\n        0x0163: { n: \"BrtSupBookSrc\", f: parsenoop },\r\n        0x0165: { n: \"BrtSupSelf\", f: parsenoop },\r\n        0x0166: { n: \"BrtSupSame\", f: parsenoop },\r\n        0x0167: { n: \"BrtSupTabs\", f: parsenoop },\r\n        0x0168: { n: \"BrtBeginSupBook\", f: parsenoop },\r\n        0x0169: { n: \"BrtPlaceholderName\", f: parsenoop },\r\n        0x016A: { n: \"BrtExternSheet\", f: parsenoop },\r\n        0x016B: { n: \"BrtExternTableStart\", f: parsenoop },\r\n        0x016C: { n: \"BrtExternTableEnd\", f: parsenoop },\r\n        0x016E: { n: \"BrtExternRowHdr\", f: parsenoop },\r\n        0x016F: { n: \"BrtExternCellBlank\", f: parsenoop },\r\n        0x0170: { n: \"BrtExternCellReal\", f: parsenoop },\r\n        0x0171: { n: \"BrtExternCellBool\", f: parsenoop },\r\n        0x0172: { n: \"BrtExternCellError\", f: parsenoop },\r\n        0x0173: { n: \"BrtExternCellString\", f: parsenoop },\r\n        0x0174: { n: \"BrtBeginEsmdx\", f: parsenoop },\r\n        0x0175: { n: \"BrtEndEsmdx\", f: parsenoop },\r\n        0x0176: { n: \"BrtBeginMdxSet\", f: parsenoop },\r\n        0x0177: { n: \"BrtEndMdxSet\", f: parsenoop },\r\n        0x0178: { n: \"BrtBeginMdxMbrProp\", f: parsenoop },\r\n        0x0179: { n: \"BrtEndMdxMbrProp\", f: parsenoop },\r\n        0x017A: { n: \"BrtBeginMdxKPI\", f: parsenoop },\r\n        0x017B: { n: \"BrtEndMdxKPI\", f: parsenoop },\r\n        0x017C: { n: \"BrtBeginEsstr\", f: parsenoop },\r\n        0x017D: { n: \"BrtEndEsstr\", f: parsenoop },\r\n        0x017E: { n: \"BrtBeginPRFItem\", f: parsenoop },\r\n        0x017F: { n: \"BrtEndPRFItem\", f: parsenoop },\r\n        0x0180: { n: \"BrtBeginPivotCacheIDs\", f: parsenoop },\r\n        0x0181: { n: \"BrtEndPivotCacheIDs\", f: parsenoop },\r\n        0x0182: { n: \"BrtBeginPivotCacheID\", f: parsenoop },\r\n        0x0183: { n: \"BrtEndPivotCacheID\", f: parsenoop },\r\n        0x0184: { n: \"BrtBeginISXVIs\", f: parsenoop },\r\n        0x0185: { n: \"BrtEndISXVIs\", f: parsenoop },\r\n        0x0186: { n: \"BrtBeginColInfos\", f: parsenoop },\r\n        0x0187: { n: \"BrtEndColInfos\", f: parsenoop },\r\n        0x0188: { n: \"BrtBeginRwBrk\", f: parsenoop },\r\n        0x0189: { n: \"BrtEndRwBrk\", f: parsenoop },\r\n        0x018A: { n: \"BrtBeginColBrk\", f: parsenoop },\r\n        0x018B: { n: \"BrtEndColBrk\", f: parsenoop },\r\n        0x018C: { n: \"BrtBrk\", f: parsenoop },\r\n        0x018D: { n: \"BrtUserBookView\", f: parsenoop },\r\n        0x018E: { n: \"BrtInfo\", f: parsenoop },\r\n        0x018F: { n: \"BrtCUsr\", f: parsenoop },\r\n        0x0190: { n: \"BrtUsr\", f: parsenoop },\r\n        0x0191: { n: \"BrtBeginUsers\", f: parsenoop },\r\n        0x0193: { n: \"BrtEOF\", f: parsenoop },\r\n        0x0194: { n: \"BrtUCR\", f: parsenoop },\r\n        0x0195: { n: \"BrtRRInsDel\", f: parsenoop },\r\n        0x0196: { n: \"BrtRREndInsDel\", f: parsenoop },\r\n        0x0197: { n: \"BrtRRMove\", f: parsenoop },\r\n        0x0198: { n: \"BrtRREndMove\", f: parsenoop },\r\n        0x0199: { n: \"BrtRRChgCell\", f: parsenoop },\r\n        0x019A: { n: \"BrtRREndChgCell\", f: parsenoop },\r\n        0x019B: { n: \"BrtRRHeader\", f: parsenoop },\r\n        0x019C: { n: \"BrtRRUserView\", f: parsenoop },\r\n        0x019D: { n: \"BrtRRRenSheet\", f: parsenoop },\r\n        0x019E: { n: \"BrtRRInsertSh\", f: parsenoop },\r\n        0x019F: { n: \"BrtRRDefName\", f: parsenoop },\r\n        0x01A0: { n: \"BrtRRNote\", f: parsenoop },\r\n        0x01A1: { n: \"BrtRRConflict\", f: parsenoop },\r\n        0x01A2: { n: \"BrtRRTQSIF\", f: parsenoop },\r\n        0x01A3: { n: \"BrtRRFormat\", f: parsenoop },\r\n        0x01A4: { n: \"BrtRREndFormat\", f: parsenoop },\r\n        0x01A5: { n: \"BrtRRAutoFmt\", f: parsenoop },\r\n        0x01A6: { n: \"BrtBeginUserShViews\", f: parsenoop },\r\n        0x01A7: { n: \"BrtBeginUserShView\", f: parsenoop },\r\n        0x01A8: { n: \"BrtEndUserShView\", f: parsenoop },\r\n        0x01A9: { n: \"BrtEndUserShViews\", f: parsenoop },\r\n        0x01AA: { n: \"BrtArrFmla\", f: parsenoop },\r\n        0x01AB: { n: \"BrtShrFmla\", f: parsenoop },\r\n        0x01AC: { n: \"BrtTable\", f: parsenoop },\r\n        0x01AD: { n: \"BrtBeginExtConnections\", f: parsenoop },\r\n        0x01AE: { n: \"BrtEndExtConnections\", f: parsenoop },\r\n        0x01AF: { n: \"BrtBeginPCDCalcMems\", f: parsenoop },\r\n        0x01B0: { n: \"BrtEndPCDCalcMems\", f: parsenoop },\r\n        0x01B1: { n: \"BrtBeginPCDCalcMem\", f: parsenoop },\r\n        0x01B2: { n: \"BrtEndPCDCalcMem\", f: parsenoop },\r\n        0x01B3: { n: \"BrtBeginPCDHGLevels\", f: parsenoop },\r\n        0x01B4: { n: \"BrtEndPCDHGLevels\", f: parsenoop },\r\n        0x01B5: { n: \"BrtBeginPCDHGLevel\", f: parsenoop },\r\n        0x01B6: { n: \"BrtEndPCDHGLevel\", f: parsenoop },\r\n        0x01B7: { n: \"BrtBeginPCDHGLGroups\", f: parsenoop },\r\n        0x01B8: { n: \"BrtEndPCDHGLGroups\", f: parsenoop },\r\n        0x01B9: { n: \"BrtBeginPCDHGLGroup\", f: parsenoop },\r\n        0x01BA: { n: \"BrtEndPCDHGLGroup\", f: parsenoop },\r\n        0x01BB: { n: \"BrtBeginPCDHGLGMembers\", f: parsenoop },\r\n        0x01BC: { n: \"BrtEndPCDHGLGMembers\", f: parsenoop },\r\n        0x01BD: { n: \"BrtBeginPCDHGLGMember\", f: parsenoop },\r\n        0x01BE: { n: \"BrtEndPCDHGLGMember\", f: parsenoop },\r\n        0x01BF: { n: \"BrtBeginQSI\", f: parsenoop },\r\n        0x01C0: { n: \"BrtEndQSI\", f: parsenoop },\r\n        0x01C1: { n: \"BrtBeginQSIR\", f: parsenoop },\r\n        0x01C2: { n: \"BrtEndQSIR\", f: parsenoop },\r\n        0x01C3: { n: \"BrtBeginDeletedNames\", f: parsenoop },\r\n        0x01C4: { n: \"BrtEndDeletedNames\", f: parsenoop },\r\n        0x01C5: { n: \"BrtBeginDeletedName\", f: parsenoop },\r\n        0x01C6: { n: \"BrtEndDeletedName\", f: parsenoop },\r\n        0x01C7: { n: \"BrtBeginQSIFs\", f: parsenoop },\r\n        0x01C8: { n: \"BrtEndQSIFs\", f: parsenoop },\r\n        0x01C9: { n: \"BrtBeginQSIF\", f: parsenoop },\r\n        0x01CA: { n: \"BrtEndQSIF\", f: parsenoop },\r\n        0x01CB: { n: \"BrtBeginAutoSortScope\", f: parsenoop },\r\n        0x01CC: { n: \"BrtEndAutoSortScope\", f: parsenoop },\r\n        0x01CD: { n: \"BrtBeginConditionalFormatting\", f: parsenoop },\r\n        0x01CE: { n: \"BrtEndConditionalFormatting\", f: parsenoop },\r\n        0x01CF: { n: \"BrtBeginCFRule\", f: parsenoop },\r\n        0x01D0: { n: \"BrtEndCFRule\", f: parsenoop },\r\n        0x01D1: { n: \"BrtBeginIconSet\", f: parsenoop },\r\n        0x01D2: { n: \"BrtEndIconSet\", f: parsenoop },\r\n        0x01D3: { n: \"BrtBeginDatabar\", f: parsenoop },\r\n        0x01D4: { n: \"BrtEndDatabar\", f: parsenoop },\r\n        0x01D5: { n: \"BrtBeginColorScale\", f: parsenoop },\r\n        0x01D6: { n: \"BrtEndColorScale\", f: parsenoop },\r\n        0x01D7: { n: \"BrtCFVO\", f: parsenoop },\r\n        0x01D8: { n: \"BrtExternValueMeta\", f: parsenoop },\r\n        0x01D9: { n: \"BrtBeginColorPalette\", f: parsenoop },\r\n        0x01DA: { n: \"BrtEndColorPalette\", f: parsenoop },\r\n        0x01DB: { n: \"BrtIndexedColor\", f: parsenoop },\r\n        0x01DC: { n: \"BrtMargins\", f: parsenoop },\r\n        0x01DD: { n: \"BrtPrintOptions\", f: parsenoop },\r\n        0x01DE: { n: \"BrtPageSetup\", f: parsenoop },\r\n        0x01DF: { n: \"BrtBeginHeaderFooter\", f: parsenoop },\r\n        0x01E0: { n: \"BrtEndHeaderFooter\", f: parsenoop },\r\n        0x01E1: { n: \"BrtBeginSXCrtFormat\", f: parsenoop },\r\n        0x01E2: { n: \"BrtEndSXCrtFormat\", f: parsenoop },\r\n        0x01E3: { n: \"BrtBeginSXCrtFormats\", f: parsenoop },\r\n        0x01E4: { n: \"BrtEndSXCrtFormats\", f: parsenoop },\r\n        0x01E5: { n: \"BrtWsFmtInfo\", f: parsenoop },\r\n        0x01E6: { n: \"BrtBeginMgs\", f: parsenoop },\r\n        0x01E7: { n: \"BrtEndMGs\", f: parsenoop },\r\n        0x01E8: { n: \"BrtBeginMGMaps\", f: parsenoop },\r\n        0x01E9: { n: \"BrtEndMGMaps\", f: parsenoop },\r\n        0x01EA: { n: \"BrtBeginMG\", f: parsenoop },\r\n        0x01EB: { n: \"BrtEndMG\", f: parsenoop },\r\n        0x01EC: { n: \"BrtBeginMap\", f: parsenoop },\r\n        0x01ED: { n: \"BrtEndMap\", f: parsenoop },\r\n        0x01EE: { n: \"BrtHLink\", f: parse_BrtHLink },\r\n        0x01EF: { n: \"BrtBeginDCon\", f: parsenoop },\r\n        0x01F0: { n: \"BrtEndDCon\", f: parsenoop },\r\n        0x01F1: { n: \"BrtBeginDRefs\", f: parsenoop },\r\n        0x01F2: { n: \"BrtEndDRefs\", f: parsenoop },\r\n        0x01F3: { n: \"BrtDRef\", f: parsenoop },\r\n        0x01F4: { n: \"BrtBeginScenMan\", f: parsenoop },\r\n        0x01F5: { n: \"BrtEndScenMan\", f: parsenoop },\r\n        0x01F6: { n: \"BrtBeginSct\", f: parsenoop },\r\n        0x01F7: { n: \"BrtEndSct\", f: parsenoop },\r\n        0x01F8: { n: \"BrtSlc\", f: parsenoop },\r\n        0x01F9: { n: \"BrtBeginDXFs\", f: parsenoop },\r\n        0x01FA: { n: \"BrtEndDXFs\", f: parsenoop },\r\n        0x01FB: { n: \"BrtDXF\", f: parsenoop },\r\n        0x01FC: { n: \"BrtBeginTableStyles\", f: parsenoop },\r\n        0x01FD: { n: \"BrtEndTableStyles\", f: parsenoop },\r\n        0x01FE: { n: \"BrtBeginTableStyle\", f: parsenoop },\r\n        0x01FF: { n: \"BrtEndTableStyle\", f: parsenoop },\r\n        0x0200: { n: \"BrtTableStyleElement\", f: parsenoop },\r\n        0x0201: { n: \"BrtTableStyleClient\", f: parsenoop },\r\n        0x0202: { n: \"BrtBeginVolDeps\", f: parsenoop },\r\n        0x0203: { n: \"BrtEndVolDeps\", f: parsenoop },\r\n        0x0204: { n: \"BrtBeginVolType\", f: parsenoop },\r\n        0x0205: { n: \"BrtEndVolType\", f: parsenoop },\r\n        0x0206: { n: \"BrtBeginVolMain\", f: parsenoop },\r\n        0x0207: { n: \"BrtEndVolMain\", f: parsenoop },\r\n        0x0208: { n: \"BrtBeginVolTopic\", f: parsenoop },\r\n        0x0209: { n: \"BrtEndVolTopic\", f: parsenoop },\r\n        0x020A: { n: \"BrtVolSubtopic\", f: parsenoop },\r\n        0x020B: { n: \"BrtVolRef\", f: parsenoop },\r\n        0x020C: { n: \"BrtVolNum\", f: parsenoop },\r\n        0x020D: { n: \"BrtVolErr\", f: parsenoop },\r\n        0x020E: { n: \"BrtVolStr\", f: parsenoop },\r\n        0x020F: { n: \"BrtVolBool\", f: parsenoop },\r\n        0x0210: { n: \"BrtBeginCalcChain$\", f: parsenoop },\r\n        0x0211: { n: \"BrtEndCalcChain$\", f: parsenoop },\r\n        0x0212: { n: \"BrtBeginSortState\", f: parsenoop },\r\n        0x0213: { n: \"BrtEndSortState\", f: parsenoop },\r\n        0x0214: { n: \"BrtBeginSortCond\", f: parsenoop },\r\n        0x0215: { n: \"BrtEndSortCond\", f: parsenoop },\r\n        0x0216: { n: \"BrtBookProtection\", f: parsenoop },\r\n        0x0217: { n: \"BrtSheetProtection\", f: parsenoop },\r\n        0x0218: { n: \"BrtRangeProtection\", f: parsenoop },\r\n        0x0219: { n: \"BrtPhoneticInfo\", f: parsenoop },\r\n        0x021A: { n: \"BrtBeginECTxtWiz\", f: parsenoop },\r\n        0x021B: { n: \"BrtEndECTxtWiz\", f: parsenoop },\r\n        0x021C: { n: \"BrtBeginECTWFldInfoLst\", f: parsenoop },\r\n        0x021D: { n: \"BrtEndECTWFldInfoLst\", f: parsenoop },\r\n        0x021E: { n: \"BrtBeginECTwFldInfo\", f: parsenoop },\r\n        0x0224: { n: \"BrtFileSharing\", f: parsenoop },\r\n        0x0225: { n: \"BrtOleSize\", f: parsenoop },\r\n        0x0226: { n: \"BrtDrawing\", f: parsenoop },\r\n        0x0227: { n: \"BrtLegacyDrawing\", f: parsenoop },\r\n        0x0228: { n: \"BrtLegacyDrawingHF\", f: parsenoop },\r\n        0x0229: { n: \"BrtWebOpt\", f: parsenoop },\r\n        0x022A: { n: \"BrtBeginWebPubItems\", f: parsenoop },\r\n        0x022B: { n: \"BrtEndWebPubItems\", f: parsenoop },\r\n        0x022C: { n: \"BrtBeginWebPubItem\", f: parsenoop },\r\n        0x022D: { n: \"BrtEndWebPubItem\", f: parsenoop },\r\n        0x022E: { n: \"BrtBeginSXCondFmt\", f: parsenoop },\r\n        0x022F: { n: \"BrtEndSXCondFmt\", f: parsenoop },\r\n        0x0230: { n: \"BrtBeginSXCondFmts\", f: parsenoop },\r\n        0x0231: { n: \"BrtEndSXCondFmts\", f: parsenoop },\r\n        0x0232: { n: \"BrtBkHim\", f: parsenoop },\r\n        0x0234: { n: \"BrtColor\", f: parsenoop },\r\n        0x0235: { n: \"BrtBeginIndexedColors\", f: parsenoop },\r\n        0x0236: { n: \"BrtEndIndexedColors\", f: parsenoop },\r\n        0x0239: { n: \"BrtBeginMRUColors\", f: parsenoop },\r\n        0x023A: { n: \"BrtEndMRUColors\", f: parsenoop },\r\n        0x023C: { n: \"BrtMRUColor\", f: parsenoop },\r\n        0x023D: { n: \"BrtBeginDVals\", f: parsenoop },\r\n        0x023E: { n: \"BrtEndDVals\", f: parsenoop },\r\n        0x0241: { n: \"BrtSupNameStart\", f: parsenoop },\r\n        0x0242: { n: \"BrtSupNameValueStart\", f: parsenoop },\r\n        0x0243: { n: \"BrtSupNameValueEnd\", f: parsenoop },\r\n        0x0244: { n: \"BrtSupNameNum\", f: parsenoop },\r\n        0x0245: { n: \"BrtSupNameErr\", f: parsenoop },\r\n        0x0246: { n: \"BrtSupNameSt\", f: parsenoop },\r\n        0x0247: { n: \"BrtSupNameNil\", f: parsenoop },\r\n        0x0248: { n: \"BrtSupNameBool\", f: parsenoop },\r\n        0x0249: { n: \"BrtSupNameFmla\", f: parsenoop },\r\n        0x024A: { n: \"BrtSupNameBits\", f: parsenoop },\r\n        0x024B: { n: \"BrtSupNameEnd\", f: parsenoop },\r\n        0x024C: { n: \"BrtEndSupBook\", f: parsenoop },\r\n        0x024D: { n: \"BrtCellSmartTagProperty\", f: parsenoop },\r\n        0x024E: { n: \"BrtBeginCellSmartTag\", f: parsenoop },\r\n        0x024F: { n: \"BrtEndCellSmartTag\", f: parsenoop },\r\n        0x0250: { n: \"BrtBeginCellSmartTags\", f: parsenoop },\r\n        0x0251: { n: \"BrtEndCellSmartTags\", f: parsenoop },\r\n        0x0252: { n: \"BrtBeginSmartTags\", f: parsenoop },\r\n        0x0253: { n: \"BrtEndSmartTags\", f: parsenoop },\r\n        0x0254: { n: \"BrtSmartTagType\", f: parsenoop },\r\n        0x0255: { n: \"BrtBeginSmartTagTypes\", f: parsenoop },\r\n        0x0256: { n: \"BrtEndSmartTagTypes\", f: parsenoop },\r\n        0x0257: { n: \"BrtBeginSXFilters\", f: parsenoop },\r\n        0x0258: { n: \"BrtEndSXFilters\", f: parsenoop },\r\n        0x0259: { n: \"BrtBeginSXFILTER\", f: parsenoop },\r\n        0x025A: { n: \"BrtEndSXFilter\", f: parsenoop },\r\n        0x025B: { n: \"BrtBeginFills\", f: parsenoop },\r\n        0x025C: { n: \"BrtEndFills\", f: parsenoop },\r\n        0x025D: { n: \"BrtBeginCellWatches\", f: parsenoop },\r\n        0x025E: { n: \"BrtEndCellWatches\", f: parsenoop },\r\n        0x025F: { n: \"BrtCellWatch\", f: parsenoop },\r\n        0x0260: { n: \"BrtBeginCRErrs\", f: parsenoop },\r\n        0x0261: { n: \"BrtEndCRErrs\", f: parsenoop },\r\n        0x0262: { n: \"BrtCrashRecErr\", f: parsenoop },\r\n        0x0263: { n: \"BrtBeginFonts\", f: parsenoop },\r\n        0x0264: { n: \"BrtEndFonts\", f: parsenoop },\r\n        0x0265: { n: \"BrtBeginBorders\", f: parsenoop },\r\n        0x0266: { n: \"BrtEndBorders\", f: parsenoop },\r\n        0x0267: { n: \"BrtBeginFmts\", f: parsenoop },\r\n        0x0268: { n: \"BrtEndFmts\", f: parsenoop },\r\n        0x0269: { n: \"BrtBeginCellXFs\", f: parsenoop },\r\n        0x026A: { n: \"BrtEndCellXFs\", f: parsenoop },\r\n        0x026B: { n: \"BrtBeginStyles\", f: parsenoop },\r\n        0x026C: { n: \"BrtEndStyles\", f: parsenoop },\r\n        0x0271: { n: \"BrtBigName\", f: parsenoop },\r\n        0x0272: { n: \"BrtBeginCellStyleXFs\", f: parsenoop },\r\n        0x0273: { n: \"BrtEndCellStyleXFs\", f: parsenoop },\r\n        0x0274: { n: \"BrtBeginComments\", f: parsenoop },\r\n        0x0275: { n: \"BrtEndComments\", f: parsenoop },\r\n        0x0276: { n: \"BrtBeginCommentAuthors\", f: parsenoop },\r\n        0x0277: { n: \"BrtEndCommentAuthors\", f: parsenoop },\r\n        0x0278: { n: \"BrtCommentAuthor\", f: parse_BrtCommentAuthor },\r\n        0x0279: { n: \"BrtBeginCommentList\", f: parsenoop },\r\n        0x027A: { n: \"BrtEndCommentList\", f: parsenoop },\r\n        0x027B: { n: \"BrtBeginComment\", f: parse_BrtBeginComment },\r\n        0x027C: { n: \"BrtEndComment\", f: parsenoop },\r\n        0x027D: { n: \"BrtCommentText\", f: parse_BrtCommentText },\r\n        0x027E: { n: \"BrtBeginOleObjects\", f: parsenoop },\r\n        0x027F: { n: \"BrtOleObject\", f: parsenoop },\r\n        0x0280: { n: \"BrtEndOleObjects\", f: parsenoop },\r\n        0x0281: { n: \"BrtBeginSxrules\", f: parsenoop },\r\n        0x0282: { n: \"BrtEndSxRules\", f: parsenoop },\r\n        0x0283: { n: \"BrtBeginActiveXControls\", f: parsenoop },\r\n        0x0284: { n: \"BrtActiveX\", f: parsenoop },\r\n        0x0285: { n: \"BrtEndActiveXControls\", f: parsenoop },\r\n        0x0286: { n: \"BrtBeginPCDSDTCEMembersSortBy\", f: parsenoop },\r\n        0x0288: { n: \"BrtBeginCellIgnoreECs\", f: parsenoop },\r\n        0x0289: { n: \"BrtCellIgnoreEC\", f: parsenoop },\r\n        0x028A: { n: \"BrtEndCellIgnoreECs\", f: parsenoop },\r\n        0x028B: { n: \"BrtCsProp\", f: parsenoop },\r\n        0x028C: { n: \"BrtCsPageSetup\", f: parsenoop },\r\n        0x028D: { n: \"BrtBeginUserCsViews\", f: parsenoop },\r\n        0x028E: { n: \"BrtEndUserCsViews\", f: parsenoop },\r\n        0x028F: { n: \"BrtBeginUserCsView\", f: parsenoop },\r\n        0x0290: { n: \"BrtEndUserCsView\", f: parsenoop },\r\n        0x0291: { n: \"BrtBeginPcdSFCIEntries\", f: parsenoop },\r\n        0x0292: { n: \"BrtEndPCDSFCIEntries\", f: parsenoop },\r\n        0x0293: { n: \"BrtPCDSFCIEntry\", f: parsenoop },\r\n        0x0294: { n: \"BrtBeginListParts\", f: parsenoop },\r\n        0x0295: { n: \"BrtListPart\", f: parsenoop },\r\n        0x0296: { n: \"BrtEndListParts\", f: parsenoop },\r\n        0x0297: { n: \"BrtSheetCalcProp\", f: parsenoop },\r\n        0x0298: { n: \"BrtBeginFnGroup\", f: parsenoop },\r\n        0x0299: { n: \"BrtFnGroup\", f: parsenoop },\r\n        0x029A: { n: \"BrtEndFnGroup\", f: parsenoop },\r\n        0x029B: { n: \"BrtSupAddin\", f: parsenoop },\r\n        0x029C: { n: \"BrtSXTDMPOrder\", f: parsenoop },\r\n        0x029D: { n: \"BrtCsProtection\", f: parsenoop },\r\n        0x029F: { n: \"BrtBeginWsSortMap\", f: parsenoop },\r\n        0x02A0: { n: \"BrtEndWsSortMap\", f: parsenoop },\r\n        0x02A1: { n: \"BrtBeginRRSort\", f: parsenoop },\r\n        0x02A2: { n: \"BrtEndRRSort\", f: parsenoop },\r\n        0x02A3: { n: \"BrtRRSortItem\", f: parsenoop },\r\n        0x02A4: { n: \"BrtFileSharingIso\", f: parsenoop },\r\n        0x02A5: { n: \"BrtBookProtectionIso\", f: parsenoop },\r\n        0x02A6: { n: \"BrtSheetProtectionIso\", f: parsenoop },\r\n        0x02A7: { n: \"BrtCsProtectionIso\", f: parsenoop },\r\n        0x02A8: { n: \"BrtRangeProtectionIso\", f: parsenoop },\r\n        0x0400: { n: \"BrtRwDescent\", f: parsenoop },\r\n        0x0401: { n: \"BrtKnownFonts\", f: parsenoop },\r\n        0x0402: { n: \"BrtBeginSXTupleSet\", f: parsenoop },\r\n        0x0403: { n: \"BrtEndSXTupleSet\", f: parsenoop },\r\n        0x0404: { n: \"BrtBeginSXTupleSetHeader\", f: parsenoop },\r\n        0x0405: { n: \"BrtEndSXTupleSetHeader\", f: parsenoop },\r\n        0x0406: { n: \"BrtSXTupleSetHeaderItem\", f: parsenoop },\r\n        0x0407: { n: \"BrtBeginSXTupleSetData\", f: parsenoop },\r\n        0x0408: { n: \"BrtEndSXTupleSetData\", f: parsenoop },\r\n        0x0409: { n: \"BrtBeginSXTupleSetRow\", f: parsenoop },\r\n        0x040A: { n: \"BrtEndSXTupleSetRow\", f: parsenoop },\r\n        0x040B: { n: \"BrtSXTupleSetRowItem\", f: parsenoop },\r\n        0x040C: { n: \"BrtNameExt\", f: parsenoop },\r\n        0x040D: { n: \"BrtPCDH14\", f: parsenoop },\r\n        0x040E: { n: \"BrtBeginPCDCalcMem14\", f: parsenoop },\r\n        0x040F: { n: \"BrtEndPCDCalcMem14\", f: parsenoop },\r\n        0x0410: { n: \"BrtSXTH14\", f: parsenoop },\r\n        0x0411: { n: \"BrtBeginSparklineGroup\", f: parsenoop },\r\n        0x0412: { n: \"BrtEndSparklineGroup\", f: parsenoop },\r\n        0x0413: { n: \"BrtSparkline\", f: parsenoop },\r\n        0x0414: { n: \"BrtSXDI14\", f: parsenoop },\r\n        0x0415: { n: \"BrtWsFmtInfoEx14\", f: parsenoop },\r\n        0x0416: { n: \"BrtBeginConditionalFormatting14\", f: parsenoop },\r\n        0x0417: { n: \"BrtEndConditionalFormatting14\", f: parsenoop },\r\n        0x0418: { n: \"BrtBeginCFRule14\", f: parsenoop },\r\n        0x0419: { n: \"BrtEndCFRule14\", f: parsenoop },\r\n        0x041A: { n: \"BrtCFVO14\", f: parsenoop },\r\n        0x041B: { n: \"BrtBeginDatabar14\", f: parsenoop },\r\n        0x041C: { n: \"BrtBeginIconSet14\", f: parsenoop },\r\n        0x041D: { n: \"BrtDVal14\", f: parsenoop },\r\n        0x041E: { n: \"BrtBeginDVals14\", f: parsenoop },\r\n        0x041F: { n: \"BrtColor14\", f: parsenoop },\r\n        0x0420: { n: \"BrtBeginSparklines\", f: parsenoop },\r\n        0x0421: { n: \"BrtEndSparklines\", f: parsenoop },\r\n        0x0422: { n: \"BrtBeginSparklineGroups\", f: parsenoop },\r\n        0x0423: { n: \"BrtEndSparklineGroups\", f: parsenoop },\r\n        0x0425: { n: \"BrtSXVD14\", f: parsenoop },\r\n        0x0426: { n: \"BrtBeginSxview14\", f: parsenoop },\r\n        0x0427: { n: \"BrtEndSxview14\", f: parsenoop },\r\n        0x042A: { n: \"BrtBeginPCD14\", f: parsenoop },\r\n        0x042B: { n: \"BrtEndPCD14\", f: parsenoop },\r\n        0x042C: { n: \"BrtBeginExtConn14\", f: parsenoop },\r\n        0x042D: { n: \"BrtEndExtConn14\", f: parsenoop },\r\n        0x042E: { n: \"BrtBeginSlicerCacheIDs\", f: parsenoop },\r\n        0x042F: { n: \"BrtEndSlicerCacheIDs\", f: parsenoop },\r\n        0x0430: { n: \"BrtBeginSlicerCacheID\", f: parsenoop },\r\n        0x0431: { n: \"BrtEndSlicerCacheID\", f: parsenoop },\r\n        0x0433: { n: \"BrtBeginSlicerCache\", f: parsenoop },\r\n        0x0434: { n: \"BrtEndSlicerCache\", f: parsenoop },\r\n        0x0435: { n: \"BrtBeginSlicerCacheDef\", f: parsenoop },\r\n        0x0436: { n: \"BrtEndSlicerCacheDef\", f: parsenoop },\r\n        0x0437: { n: \"BrtBeginSlicersEx\", f: parsenoop },\r\n        0x0438: { n: \"BrtEndSlicersEx\", f: parsenoop },\r\n        0x0439: { n: \"BrtBeginSlicerEx\", f: parsenoop },\r\n        0x043A: { n: \"BrtEndSlicerEx\", f: parsenoop },\r\n        0x043B: { n: \"BrtBeginSlicer\", f: parsenoop },\r\n        0x043C: { n: \"BrtEndSlicer\", f: parsenoop },\r\n        0x043D: { n: \"BrtSlicerCachePivotTables\", f: parsenoop },\r\n        0x043E: { n: \"BrtBeginSlicerCacheOlapImpl\", f: parsenoop },\r\n        0x043F: { n: \"BrtEndSlicerCacheOlapImpl\", f: parsenoop },\r\n        0x0440: { n: \"BrtBeginSlicerCacheLevelsData\", f: parsenoop },\r\n        0x0441: { n: \"BrtEndSlicerCacheLevelsData\", f: parsenoop },\r\n        0x0442: { n: \"BrtBeginSlicerCacheLevelData\", f: parsenoop },\r\n        0x0443: { n: \"BrtEndSlicerCacheLevelData\", f: parsenoop },\r\n        0x0444: { n: \"BrtBeginSlicerCacheSiRanges\", f: parsenoop },\r\n        0x0445: { n: \"BrtEndSlicerCacheSiRanges\", f: parsenoop },\r\n        0x0446: { n: \"BrtBeginSlicerCacheSiRange\", f: parsenoop },\r\n        0x0447: { n: \"BrtEndSlicerCacheSiRange\", f: parsenoop },\r\n        0x0448: { n: \"BrtSlicerCacheOlapItem\", f: parsenoop },\r\n        0x0449: { n: \"BrtBeginSlicerCacheSelections\", f: parsenoop },\r\n        0x044A: { n: \"BrtSlicerCacheSelection\", f: parsenoop },\r\n        0x044B: { n: \"BrtEndSlicerCacheSelections\", f: parsenoop },\r\n        0x044C: { n: \"BrtBeginSlicerCacheNative\", f: parsenoop },\r\n        0x044D: { n: \"BrtEndSlicerCacheNative\", f: parsenoop },\r\n        0x044E: { n: \"BrtSlicerCacheNativeItem\", f: parsenoop },\r\n        0x044F: { n: \"BrtRangeProtection14\", f: parsenoop },\r\n        0x0450: { n: \"BrtRangeProtectionIso14\", f: parsenoop },\r\n        0x0451: { n: \"BrtCellIgnoreEC14\", f: parsenoop },\r\n        0x0457: { n: \"BrtList14\", f: parsenoop },\r\n        0x0458: { n: \"BrtCFIcon\", f: parsenoop },\r\n        0x0459: { n: \"BrtBeginSlicerCachesPivotCacheIDs\", f: parsenoop },\r\n        0x045A: { n: \"BrtEndSlicerCachesPivotCacheIDs\", f: parsenoop },\r\n        0x045B: { n: \"BrtBeginSlicers\", f: parsenoop },\r\n        0x045C: { n: \"BrtEndSlicers\", f: parsenoop },\r\n        0x045D: { n: \"BrtWbProp14\", f: parsenoop },\r\n        0x045E: { n: \"BrtBeginSXEdit\", f: parsenoop },\r\n        0x045F: { n: \"BrtEndSXEdit\", f: parsenoop },\r\n        0x0460: { n: \"BrtBeginSXEdits\", f: parsenoop },\r\n        0x0461: { n: \"BrtEndSXEdits\", f: parsenoop },\r\n        0x0462: { n: \"BrtBeginSXChange\", f: parsenoop },\r\n        0x0463: { n: \"BrtEndSXChange\", f: parsenoop },\r\n        0x0464: { n: \"BrtBeginSXChanges\", f: parsenoop },\r\n        0x0465: { n: \"BrtEndSXChanges\", f: parsenoop },\r\n        0x0466: { n: \"BrtSXTupleItems\", f: parsenoop },\r\n        0x0468: { n: \"BrtBeginSlicerStyle\", f: parsenoop },\r\n        0x0469: { n: \"BrtEndSlicerStyle\", f: parsenoop },\r\n        0x046A: { n: \"BrtSlicerStyleElement\", f: parsenoop },\r\n        0x046B: { n: \"BrtBeginStyleSheetExt14\", f: parsenoop },\r\n        0x046C: { n: \"BrtEndStyleSheetExt14\", f: parsenoop },\r\n        0x046D: { n: \"BrtBeginSlicerCachesPivotCacheID\", f: parsenoop },\r\n        0x046E: { n: \"BrtEndSlicerCachesPivotCacheID\", f: parsenoop },\r\n        0x046F: { n: \"BrtBeginConditionalFormattings\", f: parsenoop },\r\n        0x0470: { n: \"BrtEndConditionalFormattings\", f: parsenoop },\r\n        0x0471: { n: \"BrtBeginPCDCalcMemExt\", f: parsenoop },\r\n        0x0472: { n: \"BrtEndPCDCalcMemExt\", f: parsenoop },\r\n        0x0473: { n: \"BrtBeginPCDCalcMemsExt\", f: parsenoop },\r\n        0x0474: { n: \"BrtEndPCDCalcMemsExt\", f: parsenoop },\r\n        0x0475: { n: \"BrtPCDField14\", f: parsenoop },\r\n        0x0476: { n: \"BrtBeginSlicerStyles\", f: parsenoop },\r\n        0x0477: { n: \"BrtEndSlicerStyles\", f: parsenoop },\r\n        0x0478: { n: \"BrtBeginSlicerStyleElements\", f: parsenoop },\r\n        0x0479: { n: \"BrtEndSlicerStyleElements\", f: parsenoop },\r\n        0x047A: { n: \"BrtCFRuleExt\", f: parsenoop },\r\n        0x047B: { n: \"BrtBeginSXCondFmt14\", f: parsenoop },\r\n        0x047C: { n: \"BrtEndSXCondFmt14\", f: parsenoop },\r\n        0x047D: { n: \"BrtBeginSXCondFmts14\", f: parsenoop },\r\n        0x047E: { n: \"BrtEndSXCondFmts14\", f: parsenoop },\r\n        0x0480: { n: \"BrtBeginSortCond14\", f: parsenoop },\r\n        0x0481: { n: \"BrtEndSortCond14\", f: parsenoop },\r\n        0x0482: { n: \"BrtEndDVals14\", f: parsenoop },\r\n        0x0483: { n: \"BrtEndIconSet14\", f: parsenoop },\r\n        0x0484: { n: \"BrtEndDatabar14\", f: parsenoop },\r\n        0x0485: { n: \"BrtBeginColorScale14\", f: parsenoop },\r\n        0x0486: { n: \"BrtEndColorScale14\", f: parsenoop },\r\n        0x0487: { n: \"BrtBeginSxrules14\", f: parsenoop },\r\n        0x0488: { n: \"BrtEndSxrules14\", f: parsenoop },\r\n        0x0489: { n: \"BrtBeginPRule14\", f: parsenoop },\r\n        0x048A: { n: \"BrtEndPRule14\", f: parsenoop },\r\n        0x048B: { n: \"BrtBeginPRFilters14\", f: parsenoop },\r\n        0x048C: { n: \"BrtEndPRFilters14\", f: parsenoop },\r\n        0x048D: { n: \"BrtBeginPRFilter14\", f: parsenoop },\r\n        0x048E: { n: \"BrtEndPRFilter14\", f: parsenoop },\r\n        0x048F: { n: \"BrtBeginPRFItem14\", f: parsenoop },\r\n        0x0490: { n: \"BrtEndPRFItem14\", f: parsenoop },\r\n        0x0491: { n: \"BrtBeginCellIgnoreECs14\", f: parsenoop },\r\n        0x0492: { n: \"BrtEndCellIgnoreECs14\", f: parsenoop },\r\n        0x0493: { n: \"BrtDxf14\", f: parsenoop },\r\n        0x0494: { n: \"BrtBeginDxF14s\", f: parsenoop },\r\n        0x0495: { n: \"BrtEndDxf14s\", f: parsenoop },\r\n        0x0499: { n: \"BrtFilter14\", f: parsenoop },\r\n        0x049A: { n: \"BrtBeginCustomFilters14\", f: parsenoop },\r\n        0x049C: { n: \"BrtCustomFilter14\", f: parsenoop },\r\n        0x049D: { n: \"BrtIconFilter14\", f: parsenoop },\r\n        0x049E: { n: \"BrtPivotCacheConnectionName\", f: parsenoop },\r\n        0x0800: { n: \"BrtBeginDecoupledPivotCacheIDs\", f: parsenoop },\r\n        0x0801: { n: \"BrtEndDecoupledPivotCacheIDs\", f: parsenoop },\r\n        0x0802: { n: \"BrtDecoupledPivotCacheID\", f: parsenoop },\r\n        0x0803: { n: \"BrtBeginPivotTableRefs\", f: parsenoop },\r\n        0x0804: { n: \"BrtEndPivotTableRefs\", f: parsenoop },\r\n        0x0805: { n: \"BrtPivotTableRef\", f: parsenoop },\r\n        0x0806: { n: \"BrtSlicerCacheBookPivotTables\", f: parsenoop },\r\n        0x0807: { n: \"BrtBeginSxvcells\", f: parsenoop },\r\n        0x0808: { n: \"BrtEndSxvcells\", f: parsenoop },\r\n        0x0809: { n: \"BrtBeginSxRow\", f: parsenoop },\r\n        0x080A: { n: \"BrtEndSxRow\", f: parsenoop },\r\n        0x080C: { n: \"BrtPcdCalcMem15\", f: parsenoop },\r\n        0x0813: { n: \"BrtQsi15\", f: parsenoop },\r\n        0x0814: { n: \"BrtBeginWebExtensions\", f: parsenoop },\r\n        0x0815: { n: \"BrtEndWebExtensions\", f: parsenoop },\r\n        0x0816: { n: \"BrtWebExtension\", f: parsenoop },\r\n        0x0817: { n: \"BrtAbsPath15\", f: parsenoop },\r\n        0x0818: { n: \"BrtBeginPivotTableUISettings\", f: parsenoop },\r\n        0x0819: { n: \"BrtEndPivotTableUISettings\", f: parsenoop },\r\n        0x081B: { n: \"BrtTableSlicerCacheIDs\", f: parsenoop },\r\n        0x081C: { n: \"BrtTableSlicerCacheID\", f: parsenoop },\r\n        0x081D: { n: \"BrtBeginTableSlicerCache\", f: parsenoop },\r\n        0x081E: { n: \"BrtEndTableSlicerCache\", f: parsenoop },\r\n        0x081F: { n: \"BrtSxFilter15\", f: parsenoop },\r\n        0x0820: { n: \"BrtBeginTimelineCachePivotCacheIDs\", f: parsenoop },\r\n        0x0821: { n: \"BrtEndTimelineCachePivotCacheIDs\", f: parsenoop },\r\n        0x0822: { n: \"BrtTimelineCachePivotCacheID\", f: parsenoop },\r\n        0x0823: { n: \"BrtBeginTimelineCacheIDs\", f: parsenoop },\r\n        0x0824: { n: \"BrtEndTimelineCacheIDs\", f: parsenoop },\r\n        0x0825: { n: \"BrtBeginTimelineCacheID\", f: parsenoop },\r\n        0x0826: { n: \"BrtEndTimelineCacheID\", f: parsenoop },\r\n        0x0827: { n: \"BrtBeginTimelinesEx\", f: parsenoop },\r\n        0x0828: { n: \"BrtEndTimelinesEx\", f: parsenoop },\r\n        0x0829: { n: \"BrtBeginTimelineEx\", f: parsenoop },\r\n        0x082A: { n: \"BrtEndTimelineEx\", f: parsenoop },\r\n        0x082B: { n: \"BrtWorkBookPr15\", f: parsenoop },\r\n        0x082C: { n: \"BrtPCDH15\", f: parsenoop },\r\n        0x082D: { n: \"BrtBeginTimelineStyle\", f: parsenoop },\r\n        0x082E: { n: \"BrtEndTimelineStyle\", f: parsenoop },\r\n        0x082F: { n: \"BrtTimelineStyleElement\", f: parsenoop },\r\n        0x0830: { n: \"BrtBeginTimelineStylesheetExt15\", f: parsenoop },\r\n        0x0831: { n: \"BrtEndTimelineStylesheetExt15\", f: parsenoop },\r\n        0x0832: { n: \"BrtBeginTimelineStyles\", f: parsenoop },\r\n        0x0833: { n: \"BrtEndTimelineStyles\", f: parsenoop },\r\n        0x0834: { n: \"BrtBeginTimelineStyleElements\", f: parsenoop },\r\n        0x0835: { n: \"BrtEndTimelineStyleElements\", f: parsenoop },\r\n        0x0836: { n: \"BrtDxf15\", f: parsenoop },\r\n        0x0837: { n: \"BrtBeginDxfs15\", f: parsenoop },\r\n        0x0838: { n: \"brtEndDxfs15\", f: parsenoop },\r\n        0x0839: { n: \"BrtSlicerCacheHideItemsWithNoData\", f: parsenoop },\r\n        0x083A: { n: \"BrtBeginItemUniqueNames\", f: parsenoop },\r\n        0x083B: { n: \"BrtEndItemUniqueNames\", f: parsenoop },\r\n        0x083C: { n: \"BrtItemUniqueName\", f: parsenoop },\r\n        0x083D: { n: \"BrtBeginExtConn15\", f: parsenoop },\r\n        0x083E: { n: \"BrtEndExtConn15\", f: parsenoop },\r\n        0x083F: { n: \"BrtBeginOledbPr15\", f: parsenoop },\r\n        0x0840: { n: \"BrtEndOledbPr15\", f: parsenoop },\r\n        0x0841: { n: \"BrtBeginDataFeedPr15\", f: parsenoop },\r\n        0x0842: { n: \"BrtEndDataFeedPr15\", f: parsenoop },\r\n        0x0843: { n: \"BrtTextPr15\", f: parsenoop },\r\n        0x0844: { n: \"BrtRangePr15\", f: parsenoop },\r\n        0x0845: { n: \"BrtDbCommand15\", f: parsenoop },\r\n        0x0846: { n: \"BrtBeginDbTables15\", f: parsenoop },\r\n        0x0847: { n: \"BrtEndDbTables15\", f: parsenoop },\r\n        0x0848: { n: \"BrtDbTable15\", f: parsenoop },\r\n        0x0849: { n: \"BrtBeginDataModel\", f: parsenoop },\r\n        0x084A: { n: \"BrtEndDataModel\", f: parsenoop },\r\n        0x084B: { n: \"BrtBeginModelTables\", f: parsenoop },\r\n        0x084C: { n: \"BrtEndModelTables\", f: parsenoop },\r\n        0x084D: { n: \"BrtModelTable\", f: parsenoop },\r\n        0x084E: { n: \"BrtBeginModelRelationships\", f: parsenoop },\r\n        0x084F: { n: \"BrtEndModelRelationships\", f: parsenoop },\r\n        0x0850: { n: \"BrtModelRelationship\", f: parsenoop },\r\n        0x0851: { n: \"BrtBeginECTxtWiz15\", f: parsenoop },\r\n        0x0852: { n: \"BrtEndECTxtWiz15\", f: parsenoop },\r\n        0x0853: { n: \"BrtBeginECTWFldInfoLst15\", f: parsenoop },\r\n        0x0854: { n: \"BrtEndECTWFldInfoLst15\", f: parsenoop },\r\n        0x0855: { n: \"BrtBeginECTWFldInfo15\", f: parsenoop },\r\n        0x0856: { n: \"BrtFieldListActiveItem\", f: parsenoop },\r\n        0x0857: { n: \"BrtPivotCacheIdVersion\", f: parsenoop },\r\n        0x0858: { n: \"BrtSXDI15\", f: parsenoop },\r\n        0xFFFF: { n: \"\", f: parsenoop }\r\n    };\r\n\r\n    var evert_RE = evert_key(XLSBRecordEnum, 'n');\r\n\r\n    /* [MS-XLS] 2.3 Record Enumeration */\r\n    var XLSRecordEnum = {\r\n        0x0003: { n: \"BIFF2NUM\", f: parse_BIFF2NUM },\r\n        0x0004: { n: \"BIFF2STR\", f: parse_BIFF2STR },\r\n        0x0006: { n: \"Formula\", f: parse_Formula },\r\n        0x0009: { n: 'BOF', f: parse_BOF },\r\n        0x000a: { n: 'EOF', f: parse_EOF },\r\n        0x000c: { n: \"CalcCount\", f: parse_CalcCount },\r\n        0x000d: { n: \"CalcMode\", f: parse_CalcMode },\r\n        0x000e: { n: \"CalcPrecision\", f: parse_CalcPrecision },\r\n        0x000f: { n: \"CalcRefMode\", f: parse_CalcRefMode },\r\n        0x0010: { n: \"CalcDelta\", f: parse_CalcDelta },\r\n        0x0011: { n: \"CalcIter\", f: parse_CalcIter },\r\n        0x0012: { n: \"Protect\", f: parse_Protect },\r\n        0x0013: { n: \"Password\", f: parse_Password },\r\n        0x0014: { n: \"Header\", f: parse_Header },\r\n        0x0015: { n: \"Footer\", f: parse_Footer },\r\n        0x0017: { n: \"ExternSheet\", f: parse_ExternSheet },\r\n        0x0018: { n: \"Lbl\", f: parse_Lbl },\r\n        0x0019: { n: \"WinProtect\", f: parse_WinProtect },\r\n        0x001a: { n: \"VerticalPageBreaks\", f: parse_VerticalPageBreaks },\r\n        0x001b: { n: \"HorizontalPageBreaks\", f: parse_HorizontalPageBreaks },\r\n        0x001c: { n: \"Note\", f: parse_Note },\r\n        0x001d: { n: \"Selection\", f: parse_Selection },\r\n        0x0022: { n: \"Date1904\", f: parse_Date1904 },\r\n        0x0023: { n: \"ExternName\", f: parse_ExternName },\r\n        0x0026: { n: \"LeftMargin\", f: parse_LeftMargin },\r\n        0x0027: { n: \"RightMargin\", f: parse_RightMargin },\r\n        0x0028: { n: \"TopMargin\", f: parse_TopMargin },\r\n        0x0029: { n: \"BottomMargin\", f: parse_BottomMargin },\r\n        0x002a: { n: \"PrintRowCol\", f: parse_PrintRowCol },\r\n        0x002b: { n: \"PrintGrid\", f: parse_PrintGrid },\r\n        0x002f: { n: \"FilePass\", f: parse_FilePass },\r\n        0x0031: { n: \"Font\", f: parse_Font },\r\n        0x0033: { n: \"PrintSize\", f: parse_PrintSize },\r\n        0x003c: { n: \"Continue\", f: parse_Continue },\r\n        0x003d: { n: \"Window1\", f: parse_Window1 },\r\n        0x0040: { n: \"Backup\", f: parse_Backup },\r\n        0x0041: { n: \"Pane\", f: parse_Pane },\r\n        0x0042: { n: 'CodePage', f: parse_CodePage },\r\n        0x004d: { n: \"Pls\", f: parse_Pls },\r\n        0x0050: { n: \"DCon\", f: parse_DCon },\r\n        0x0051: { n: \"DConRef\", f: parse_DConRef },\r\n        0x0052: { n: \"DConName\", f: parse_DConName },\r\n        0x0055: { n: \"DefColWidth\", f: parse_DefColWidth },\r\n        0x0059: { n: \"XCT\", f: parse_XCT },\r\n        0x005a: { n: \"CRN\", f: parse_CRN },\r\n        0x005b: { n: \"FileSharing\", f: parse_FileSharing },\r\n        0x005c: { n: 'WriteAccess', f: parse_WriteAccess },\r\n        0x005d: { n: \"Obj\", f: parse_Obj },\r\n        0x005e: { n: \"Uncalced\", f: parse_Uncalced },\r\n        0x005f: { n: \"CalcSaveRecalc\", f: parse_CalcSaveRecalc },\r\n        0x0060: { n: \"Template\", f: parse_Template },\r\n        0x0061: { n: \"Intl\", f: parse_Intl },\r\n        0x0063: { n: \"ObjProtect\", f: parse_ObjProtect },\r\n        0x007d: { n: \"ColInfo\", f: parse_ColInfo },\r\n        0x0080: { n: \"Guts\", f: parse_Guts },\r\n        0x0081: { n: \"WsBool\", f: parse_WsBool },\r\n        0x0082: { n: \"GridSet\", f: parse_GridSet },\r\n        0x0083: { n: \"HCenter\", f: parse_HCenter },\r\n        0x0084: { n: \"VCenter\", f: parse_VCenter },\r\n        0x0085: { n: 'BoundSheet8', f: parse_BoundSheet8 },\r\n        0x0086: { n: \"WriteProtect\", f: parse_WriteProtect },\r\n        0x008c: { n: \"Country\", f: parse_Country },\r\n        0x008d: { n: \"HideObj\", f: parse_HideObj },\r\n        0x0090: { n: \"Sort\", f: parse_Sort },\r\n        0x0092: { n: \"Palette\", f: parse_Palette },\r\n        0x0097: { n: \"Sync\", f: parse_Sync },\r\n        0x0098: { n: \"LPr\", f: parse_LPr },\r\n        0x0099: { n: \"DxGCol\", f: parse_DxGCol },\r\n        0x009a: { n: \"FnGroupName\", f: parse_FnGroupName },\r\n        0x009b: { n: \"FilterMode\", f: parse_FilterMode },\r\n        0x009c: { n: \"BuiltInFnGroupCount\", f: parse_BuiltInFnGroupCount },\r\n        0x009d: { n: \"AutoFilterInfo\", f: parse_AutoFilterInfo },\r\n        0x009e: { n: \"AutoFilter\", f: parse_AutoFilter },\r\n        0x00a0: { n: \"Scl\", f: parse_Scl },\r\n        0x00a1: { n: \"Setup\", f: parse_Setup },\r\n        0x00ae: { n: \"ScenMan\", f: parse_ScenMan },\r\n        0x00af: { n: \"SCENARIO\", f: parse_SCENARIO },\r\n        0x00b0: { n: \"SxView\", f: parse_SxView },\r\n        0x00b1: { n: \"Sxvd\", f: parse_Sxvd },\r\n        0x00b2: { n: \"SXVI\", f: parse_SXVI },\r\n        0x00b4: { n: \"SxIvd\", f: parse_SxIvd },\r\n        0x00b5: { n: \"SXLI\", f: parse_SXLI },\r\n        0x00b6: { n: \"SXPI\", f: parse_SXPI },\r\n        0x00b8: { n: \"DocRoute\", f: parse_DocRoute },\r\n        0x00b9: { n: \"RecipName\", f: parse_RecipName },\r\n        0x00bd: { n: \"MulRk\", f: parse_MulRk },\r\n        0x00be: { n: \"MulBlank\", f: parse_MulBlank },\r\n        0x00c1: { n: 'Mms', f: parse_Mms },\r\n        0x00c5: { n: \"SXDI\", f: parse_SXDI },\r\n        0x00c6: { n: \"SXDB\", f: parse_SXDB },\r\n        0x00c7: { n: \"SXFDB\", f: parse_SXFDB },\r\n        0x00c8: { n: \"SXDBB\", f: parse_SXDBB },\r\n        0x00c9: { n: \"SXNum\", f: parse_SXNum },\r\n        0x00ca: { n: \"SxBool\", f: parse_SxBool },\r\n        0x00cb: { n: \"SxErr\", f: parse_SxErr },\r\n        0x00cc: { n: \"SXInt\", f: parse_SXInt },\r\n        0x00cd: { n: \"SXString\", f: parse_SXString },\r\n        0x00ce: { n: \"SXDtr\", f: parse_SXDtr },\r\n        0x00cf: { n: \"SxNil\", f: parse_SxNil },\r\n        0x00d0: { n: \"SXTbl\", f: parse_SXTbl },\r\n        0x00d1: { n: \"SXTBRGIITM\", f: parse_SXTBRGIITM },\r\n        0x00d2: { n: \"SxTbpg\", f: parse_SxTbpg },\r\n        0x00d3: { n: \"ObProj\", f: parse_ObProj },\r\n        0x00d5: { n: \"SXStreamID\", f: parse_SXStreamID },\r\n        0x00d7: { n: \"DBCell\", f: parse_DBCell },\r\n        0x00d8: { n: \"SXRng\", f: parse_SXRng },\r\n        0x00d9: { n: \"SxIsxoper\", f: parse_SxIsxoper },\r\n        0x00da: { n: \"BookBool\", f: parse_BookBool },\r\n        0x00dc: { n: \"DbOrParamQry\", f: parse_DbOrParamQry },\r\n        0x00dd: { n: \"ScenarioProtect\", f: parse_ScenarioProtect },\r\n        0x00de: { n: \"OleObjectSize\", f: parse_OleObjectSize },\r\n        0x00e0: { n: \"XF\", f: parse_XF },\r\n        0x00e1: { n: 'InterfaceHdr', f: parse_InterfaceHdr },\r\n        0x00e2: { n: 'InterfaceEnd', f: parse_InterfaceEnd },\r\n        0x00e3: { n: \"SXVS\", f: parse_SXVS },\r\n        0x00e5: { n: \"MergeCells\", f: parse_MergeCells },\r\n        0x00e9: { n: \"BkHim\", f: parse_BkHim },\r\n        0x00eb: { n: \"MsoDrawingGroup\", f: parse_MsoDrawingGroup },\r\n        0x00ec: { n: \"MsoDrawing\", f: parse_MsoDrawing },\r\n        0x00ed: { n: \"MsoDrawingSelection\", f: parse_MsoDrawingSelection },\r\n        0x00ef: { n: \"PhoneticInfo\", f: parse_PhoneticInfo },\r\n        0x00f0: { n: \"SxRule\", f: parse_SxRule },\r\n        0x00f1: { n: \"SXEx\", f: parse_SXEx },\r\n        0x00f2: { n: \"SxFilt\", f: parse_SxFilt },\r\n        0x00f4: { n: \"SxDXF\", f: parse_SxDXF },\r\n        0x00f5: { n: \"SxItm\", f: parse_SxItm },\r\n        0x00f6: { n: \"SxName\", f: parse_SxName },\r\n        0x00f7: { n: \"SxSelect\", f: parse_SxSelect },\r\n        0x00f8: { n: \"SXPair\", f: parse_SXPair },\r\n        0x00f9: { n: \"SxFmla\", f: parse_SxFmla },\r\n        0x00fb: { n: \"SxFormat\", f: parse_SxFormat },\r\n        0x00fc: { n: \"SST\", f: parse_SST },\r\n        0x00fd: { n: \"LabelSst\", f: parse_LabelSst },\r\n        0x00ff: { n: \"ExtSST\", f: parse_ExtSST },\r\n        0x0100: { n: \"SXVDEx\", f: parse_SXVDEx },\r\n        0x0103: { n: \"SXFormula\", f: parse_SXFormula },\r\n        0x0122: { n: \"SXDBEx\", f: parse_SXDBEx },\r\n        0x0137: { n: \"RRDInsDel\", f: parse_RRDInsDel },\r\n        0x0138: { n: \"RRDHead\", f: parse_RRDHead },\r\n        0x013b: { n: \"RRDChgCell\", f: parse_RRDChgCell },\r\n        0x013d: { n: \"RRTabId\", f: parse_RRTabId },\r\n        0x013e: { n: \"RRDRenSheet\", f: parse_RRDRenSheet },\r\n        0x013f: { n: \"RRSort\", f: parse_RRSort },\r\n        0x0140: { n: \"RRDMove\", f: parse_RRDMove },\r\n        0x014a: { n: \"RRFormat\", f: parse_RRFormat },\r\n        0x014b: { n: \"RRAutoFmt\", f: parse_RRAutoFmt },\r\n        0x014d: { n: \"RRInsertSh\", f: parse_RRInsertSh },\r\n        0x014e: { n: \"RRDMoveBegin\", f: parse_RRDMoveBegin },\r\n        0x014f: { n: \"RRDMoveEnd\", f: parse_RRDMoveEnd },\r\n        0x0150: { n: \"RRDInsDelBegin\", f: parse_RRDInsDelBegin },\r\n        0x0151: { n: \"RRDInsDelEnd\", f: parse_RRDInsDelEnd },\r\n        0x0152: { n: \"RRDConflict\", f: parse_RRDConflict },\r\n        0x0153: { n: \"RRDDefName\", f: parse_RRDDefName },\r\n        0x0154: { n: \"RRDRstEtxp\", f: parse_RRDRstEtxp },\r\n        0x015f: { n: \"LRng\", f: parse_LRng },\r\n        0x0160: { n: \"UsesELFs\", f: parse_UsesELFs },\r\n        0x0161: { n: \"DSF\", f: parse_DSF },\r\n        0x0191: { n: \"CUsr\", f: parse_CUsr },\r\n        0x0192: { n: \"CbUsr\", f: parse_CbUsr },\r\n        0x0193: { n: \"UsrInfo\", f: parse_UsrInfo },\r\n        0x0194: { n: \"UsrExcl\", f: parse_UsrExcl },\r\n        0x0195: { n: \"FileLock\", f: parse_FileLock },\r\n        0x0196: { n: \"RRDInfo\", f: parse_RRDInfo },\r\n        0x0197: { n: \"BCUsrs\", f: parse_BCUsrs },\r\n        0x0198: { n: \"UsrChk\", f: parse_UsrChk },\r\n        0x01a9: { n: \"UserBView\", f: parse_UserBView },\r\n        0x01aa: { n: \"UserSViewBegin\", f: parse_UserSViewBegin },\r\n        0x01ab: { n: \"UserSViewEnd\", f: parse_UserSViewEnd },\r\n        0x01ac: { n: \"RRDUserView\", f: parse_RRDUserView },\r\n        0x01ad: { n: \"Qsi\", f: parse_Qsi },\r\n        0x01ae: { n: \"SupBook\", f: parse_SupBook },\r\n        0x01af: { n: \"Prot4Rev\", f: parse_Prot4Rev },\r\n        0x01b0: { n: \"CondFmt\", f: parse_CondFmt },\r\n        0x01b1: { n: \"CF\", f: parse_CF },\r\n        0x01b2: { n: \"DVal\", f: parse_DVal },\r\n        0x01b5: { n: \"DConBin\", f: parse_DConBin },\r\n        0x01b6: { n: \"TxO\", f: parse_TxO },\r\n        0x01b7: { n: \"RefreshAll\", f: parse_RefreshAll },\r\n        0x01b8: { n: \"HLink\", f: parse_HLink },\r\n        0x01b9: { n: \"Lel\", f: parse_Lel },\r\n        0x01ba: { n: \"CodeName\", f: parse_XLSCodeName },\r\n        0x01bb: { n: \"SXFDBType\", f: parse_SXFDBType },\r\n        0x01bc: { n: \"Prot4RevPass\", f: parse_Prot4RevPass },\r\n        0x01bd: { n: \"ObNoMacros\", f: parse_ObNoMacros },\r\n        0x01be: { n: \"Dv\", f: parse_Dv },\r\n        0x01c0: { n: \"Excel9File\", f: parse_Excel9File },\r\n        0x01c1: { n: \"RecalcId\", f: parse_RecalcId, r: 2 },\r\n        0x01c2: { n: \"EntExU2\", f: parse_EntExU2 },\r\n        0x0200: { n: \"Dimensions\", f: parse_Dimensions },\r\n        0x0201: { n: \"Blank\", f: parse_Blank },\r\n        0x0203: { n: \"Number\", f: parse_Number },\r\n        0x0204: { n: \"Label\", f: parse_Label },\r\n        0x0205: { n: \"BoolErr\", f: parse_BoolErr },\r\n        0x0207: { n: \"String\", f: parse_String },\r\n        0x0208: { n: 'Row', f: parse_Row },\r\n        0x020b: { n: \"Index\", f: parse_Index },\r\n        0x0221: { n: \"Array\", f: parse_Array },\r\n        0x0225: { n: \"DefaultRowHeight\", f: parse_DefaultRowHeight },\r\n        0x0236: { n: \"Table\", f: parse_Table },\r\n        0x023e: { n: \"Window2\", f: parse_Window2 },\r\n        0x027e: { n: \"RK\", f: parse_RK },\r\n        0x0293: { n: \"Style\", f: parse_Style },\r\n        0x0418: { n: \"BigName\", f: parse_BigName },\r\n        0x041e: { n: \"Format\", f: parse_Format },\r\n        0x043c: { n: \"ContinueBigName\", f: parse_ContinueBigName },\r\n        0x04bc: { n: \"ShrFmla\", f: parse_ShrFmla },\r\n        0x0800: { n: \"HLinkTooltip\", f: parse_HLinkTooltip },\r\n        0x0801: { n: \"WebPub\", f: parse_WebPub },\r\n        0x0802: { n: \"QsiSXTag\", f: parse_QsiSXTag },\r\n        0x0803: { n: \"DBQueryExt\", f: parse_DBQueryExt },\r\n        0x0804: { n: \"ExtString\", f: parse_ExtString },\r\n        0x0805: { n: \"TxtQry\", f: parse_TxtQry },\r\n        0x0806: { n: \"Qsir\", f: parse_Qsir },\r\n        0x0807: { n: \"Qsif\", f: parse_Qsif },\r\n        0x0808: { n: \"RRDTQSIF\", f: parse_RRDTQSIF },\r\n        0x0809: { n: 'BOF', f: parse_BOF },\r\n        0x080a: { n: \"OleDbConn\", f: parse_OleDbConn },\r\n        0x080b: { n: \"WOpt\", f: parse_WOpt },\r\n        0x080c: { n: \"SXViewEx\", f: parse_SXViewEx },\r\n        0x080d: { n: \"SXTH\", f: parse_SXTH },\r\n        0x080e: { n: \"SXPIEx\", f: parse_SXPIEx },\r\n        0x080f: { n: \"SXVDTEx\", f: parse_SXVDTEx },\r\n        0x0810: { n: \"SXViewEx9\", f: parse_SXViewEx9 },\r\n        0x0812: { n: \"ContinueFrt\", f: parse_ContinueFrt },\r\n        0x0813: { n: \"RealTimeData\", f: parse_RealTimeData },\r\n        0x0850: { n: \"ChartFrtInfo\", f: parse_ChartFrtInfo },\r\n        0x0851: { n: \"FrtWrapper\", f: parse_FrtWrapper },\r\n        0x0852: { n: \"StartBlock\", f: parse_StartBlock },\r\n        0x0853: { n: \"EndBlock\", f: parse_EndBlock },\r\n        0x0854: { n: \"StartObject\", f: parse_StartObject },\r\n        0x0855: { n: \"EndObject\", f: parse_EndObject },\r\n        0x0856: { n: \"CatLab\", f: parse_CatLab },\r\n        0x0857: { n: \"YMult\", f: parse_YMult },\r\n        0x0858: { n: \"SXViewLink\", f: parse_SXViewLink },\r\n        0x0859: { n: \"PivotChartBits\", f: parse_PivotChartBits },\r\n        0x085a: { n: \"FrtFontList\", f: parse_FrtFontList },\r\n        0x0862: { n: \"SheetExt\", f: parse_SheetExt },\r\n        0x0863: { n: \"BookExt\", f: parse_BookExt, r: 12 },\r\n        0x0864: { n: \"SXAddl\", f: parse_SXAddl },\r\n        0x0865: { n: \"CrErr\", f: parse_CrErr },\r\n        0x0866: { n: \"HFPicture\", f: parse_HFPicture },\r\n        0x0867: { n: 'FeatHdr', f: parse_FeatHdr },\r\n        0x0868: { n: \"Feat\", f: parse_Feat },\r\n        0x086a: { n: \"DataLabExt\", f: parse_DataLabExt },\r\n        0x086b: { n: \"DataLabExtContents\", f: parse_DataLabExtContents },\r\n        0x086c: { n: \"CellWatch\", f: parse_CellWatch },\r\n        0x0871: { n: \"FeatHdr11\", f: parse_FeatHdr11 },\r\n        0x0872: { n: \"Feature11\", f: parse_Feature11 },\r\n        0x0874: { n: \"DropDownObjIds\", f: parse_DropDownObjIds },\r\n        0x0875: { n: \"ContinueFrt11\", f: parse_ContinueFrt11 },\r\n        0x0876: { n: \"DConn\", f: parse_DConn },\r\n        0x0877: { n: \"List12\", f: parse_List12 },\r\n        0x0878: { n: \"Feature12\", f: parse_Feature12 },\r\n        0x0879: { n: \"CondFmt12\", f: parse_CondFmt12 },\r\n        0x087a: { n: \"CF12\", f: parse_CF12 },\r\n        0x087b: { n: \"CFEx\", f: parse_CFEx },\r\n        0x087c: { n: \"XFCRC\", f: parse_XFCRC, r: 12 },\r\n        0x087d: { n: \"XFExt\", f: parse_XFExt, r: 12 },\r\n        0x087e: { n: \"AutoFilter12\", f: parse_AutoFilter12 },\r\n        0x087f: { n: \"ContinueFrt12\", f: parse_ContinueFrt12 },\r\n        0x0884: { n: \"MDTInfo\", f: parse_MDTInfo },\r\n        0x0885: { n: \"MDXStr\", f: parse_MDXStr },\r\n        0x0886: { n: \"MDXTuple\", f: parse_MDXTuple },\r\n        0x0887: { n: \"MDXSet\", f: parse_MDXSet },\r\n        0x0888: { n: \"MDXProp\", f: parse_MDXProp },\r\n        0x0889: { n: \"MDXKPI\", f: parse_MDXKPI },\r\n        0x088a: { n: \"MDB\", f: parse_MDB },\r\n        0x088b: { n: \"PLV\", f: parse_PLV },\r\n        0x088c: { n: \"Compat12\", f: parse_Compat12, r: 12 },\r\n        0x088d: { n: \"DXF\", f: parse_DXF },\r\n        0x088e: { n: \"TableStyles\", f: parse_TableStyles, r: 12 },\r\n        0x088f: { n: \"TableStyle\", f: parse_TableStyle },\r\n        0x0890: { n: \"TableStyleElement\", f: parse_TableStyleElement },\r\n        0x0892: { n: \"StyleExt\", f: parse_StyleExt },\r\n        0x0893: { n: \"NamePublish\", f: parse_NamePublish },\r\n        0x0894: { n: \"NameCmt\", f: parse_NameCmt },\r\n        0x0895: { n: \"SortData\", f: parse_SortData },\r\n        0x0896: { n: \"Theme\", f: parse_Theme, r: 12 },\r\n        0x0897: { n: \"GUIDTypeLib\", f: parse_GUIDTypeLib },\r\n        0x0898: { n: \"FnGrp12\", f: parse_FnGrp12 },\r\n        0x0899: { n: \"NameFnGrp12\", f: parse_NameFnGrp12 },\r\n        0x089a: { n: \"MTRSettings\", f: parse_MTRSettings, r: 12 },\r\n        0x089b: { n: \"CompressPictures\", f: parse_CompressPictures },\r\n        0x089c: { n: \"HeaderFooter\", f: parse_HeaderFooter },\r\n        0x089d: { n: \"CrtLayout12\", f: parse_CrtLayout12 },\r\n        0x089e: { n: \"CrtMlFrt\", f: parse_CrtMlFrt },\r\n        0x089f: { n: \"CrtMlFrtContinue\", f: parse_CrtMlFrtContinue },\r\n        0x08a3: { n: \"ForceFullCalculation\", f: parse_ForceFullCalculation },\r\n        0x08a4: { n: \"ShapePropsStream\", f: parse_ShapePropsStream },\r\n        0x08a5: { n: \"TextPropsStream\", f: parse_TextPropsStream },\r\n        0x08a6: { n: \"RichTextStream\", f: parse_RichTextStream },\r\n        0x08a7: { n: \"CrtLayout12A\", f: parse_CrtLayout12A },\r\n        0x1001: { n: \"Units\", f: parse_Units },\r\n        0x1002: { n: \"Chart\", f: parse_Chart },\r\n        0x1003: { n: \"Series\", f: parse_Series },\r\n        0x1006: { n: \"DataFormat\", f: parse_DataFormat },\r\n        0x1007: { n: \"LineFormat\", f: parse_LineFormat },\r\n        0x1009: { n: \"MarkerFormat\", f: parse_MarkerFormat },\r\n        0x100a: { n: \"AreaFormat\", f: parse_AreaFormat },\r\n        0x100b: { n: \"PieFormat\", f: parse_PieFormat },\r\n        0x100c: { n: \"AttachedLabel\", f: parse_AttachedLabel },\r\n        0x100d: { n: \"SeriesText\", f: parse_SeriesText },\r\n        0x1014: { n: \"ChartFormat\", f: parse_ChartFormat },\r\n        0x1015: { n: \"Legend\", f: parse_Legend },\r\n        0x1016: { n: \"SeriesList\", f: parse_SeriesList },\r\n        0x1017: { n: \"Bar\", f: parse_Bar },\r\n        0x1018: { n: \"Line\", f: parse_Line },\r\n        0x1019: { n: \"Pie\", f: parse_Pie },\r\n        0x101a: { n: \"Area\", f: parse_Area },\r\n        0x101b: { n: \"Scatter\", f: parse_Scatter },\r\n        0x101c: { n: \"CrtLine\", f: parse_CrtLine },\r\n        0x101d: { n: \"Axis\", f: parse_Axis },\r\n        0x101e: { n: \"Tick\", f: parse_Tick },\r\n        0x101f: { n: \"ValueRange\", f: parse_ValueRange },\r\n        0x1020: { n: \"CatSerRange\", f: parse_CatSerRange },\r\n        0x1021: { n: \"AxisLine\", f: parse_AxisLine },\r\n        0x1022: { n: \"CrtLink\", f: parse_CrtLink },\r\n        0x1024: { n: \"DefaultText\", f: parse_DefaultText },\r\n        0x1025: { n: \"Text\", f: parse_Text },\r\n        0x1026: { n: \"FontX\", f: parse_FontX },\r\n        0x1027: { n: \"ObjectLink\", f: parse_ObjectLink },\r\n        0x1032: { n: \"Frame\", f: parse_Frame },\r\n        0x1033: { n: \"Begin\", f: parse_Begin },\r\n        0x1034: { n: \"End\", f: parse_End },\r\n        0x1035: { n: \"PlotArea\", f: parse_PlotArea },\r\n        0x103a: { n: \"Chart3d\", f: parse_Chart3d },\r\n        0x103c: { n: \"PicF\", f: parse_PicF },\r\n        0x103d: { n: \"DropBar\", f: parse_DropBar },\r\n        0x103e: { n: \"Radar\", f: parse_Radar },\r\n        0x103f: { n: \"Surf\", f: parse_Surf },\r\n        0x1040: { n: \"RadarArea\", f: parse_RadarArea },\r\n        0x1041: { n: \"AxisParent\", f: parse_AxisParent },\r\n        0x1043: { n: \"LegendException\", f: parse_LegendException },\r\n        0x1044: { n: \"ShtProps\", f: parse_ShtProps },\r\n        0x1045: { n: \"SerToCrt\", f: parse_SerToCrt },\r\n        0x1046: { n: \"AxesUsed\", f: parse_AxesUsed },\r\n        0x1048: { n: \"SBaseRef\", f: parse_SBaseRef },\r\n        0x104a: { n: \"SerParent\", f: parse_SerParent },\r\n        0x104b: { n: \"SerAuxTrend\", f: parse_SerAuxTrend },\r\n        0x104e: { n: \"IFmtRecord\", f: parse_IFmtRecord },\r\n        0x104f: { n: \"Pos\", f: parse_Pos },\r\n        0x1050: { n: \"AlRuns\", f: parse_AlRuns },\r\n        0x1051: { n: \"BRAI\", f: parse_BRAI },\r\n        0x105b: { n: \"SerAuxErrBar\", f: parse_SerAuxErrBar },\r\n        0x105c: { n: \"ClrtClient\", f: parse_ClrtClient },\r\n        0x105d: { n: \"SerFmt\", f: parse_SerFmt },\r\n        0x105f: { n: \"Chart3DBarShape\", f: parse_Chart3DBarShape },\r\n        0x1060: { n: \"Fbi\", f: parse_Fbi },\r\n        0x1061: { n: \"BopPop\", f: parse_BopPop },\r\n        0x1062: { n: \"AxcExt\", f: parse_AxcExt },\r\n        0x1063: { n: \"Dat\", f: parse_Dat },\r\n        0x1064: { n: \"PlotGrowth\", f: parse_PlotGrowth },\r\n        0x1065: { n: \"SIIndex\", f: parse_SIIndex },\r\n        0x1066: { n: \"GelFrame\", f: parse_GelFrame },\r\n        0x1067: { n: \"BopPopCustom\", f: parse_BopPopCustom },\r\n        0x1068: { n: \"Fbi2\", f: parse_Fbi2 },\r\n\r\n        /* These are specified in an older version of the spec */\r\n        0x0016: { n: \"ExternCount\", f: parsenoop },\r\n        0x007e: { n: \"RK\", f: parsenoop }, /* Not necessarily same as 0x027e */\r\n        0x007f: { n: \"ImData\", f: parsenoop },\r\n        0x0087: { n: \"Addin\", f: parsenoop },\r\n        0x0088: { n: \"Edg\", f: parsenoop },\r\n        0x0089: { n: \"Pub\", f: parsenoop },\r\n        0x0091: { n: \"Sub\", f: parsenoop },\r\n        0x0094: { n: \"LHRecord\", f: parsenoop },\r\n        0x0095: { n: \"LHNGraph\", f: parsenoop },\r\n        0x0096: { n: \"Sound\", f: parsenoop },\r\n        0x00a9: { n: \"CoordList\", f: parsenoop },\r\n        0x00ab: { n: \"GCW\", f: parsenoop },\r\n        0x00bc: { n: \"ShrFmla\", f: parsenoop }, /* Not necessarily same as 0x04bc */\r\n        0x00c2: { n: \"AddMenu\", f: parsenoop },\r\n        0x00c3: { n: \"DelMenu\", f: parsenoop },\r\n        0x00d6: { n: \"RString\", f: parsenoop },\r\n        0x00df: { n: \"UDDesc\", f: parsenoop },\r\n        0x00ea: { n: \"TabIdConf\", f: parsenoop },\r\n        0x0162: { n: \"XL5Modify\", f: parsenoop },\r\n        0x01a5: { n: \"FileSharing2\", f: parsenoop },\r\n        0x0218: { n: \"Name\", f: parsenoop },\r\n        0x0223: { n: \"ExternName\", f: parse_ExternName },\r\n        0x0231: { n: \"Font\", f: parsenoop },\r\n        0x0406: { n: \"Formula\", f: parse_Formula },\r\n        0x086d: { n: \"FeatInfo\", f: parsenoop },\r\n        0x0873: { n: \"FeatInfo11\", f: parsenoop },\r\n        0x0881: { n: \"SXAddl12\", f: parsenoop },\r\n        0x08c0: { n: \"AutoWebPub\", f: parsenoop },\r\n        0x08c1: { n: \"ListObj\", f: parsenoop },\r\n        0x08c2: { n: \"ListField\", f: parsenoop },\r\n        0x08c3: { n: \"ListDV\", f: parsenoop },\r\n        0x08c4: { n: \"ListCondFmt\", f: parsenoop },\r\n        0x08c5: { n: \"ListCF\", f: parsenoop },\r\n        0x08c6: { n: \"FMQry\", f: parsenoop },\r\n        0x08c7: { n: \"FMSQry\", f: parsenoop },\r\n        0x08c8: { n: \"PLV\", f: parsenoop }, /* supposedly PLV for Excel 11 */\r\n        0x08c9: { n: \"LnExt\", f: parsenoop },\r\n        0x08ca: { n: \"MkrExt\", f: parsenoop },\r\n        0x08cb: { n: \"CrtCoopt\", f: parsenoop },\r\n\r\n        0x0000: {}\r\n    };\r\n\r\n\r\n    /* Helper function to call out to ODS parser */\r\n    function parse_ods(zip, opts) {\r\n        if (typeof module !== \"undefined\" && typeof require !== 'undefined' && typeof ODS === 'undefined') ODS = require('./od' + 's');\r\n        if (typeof ODS === 'undefined' || !ODS.parse_ods) throw new Error(\"Unsupported ODS\");\r\n        return ODS.parse_ods(zip, opts);\r\n    }\r\n    function fix_opts_func(defaults) {\r\n        return function fix_opts(opts) {\r\n            for (var i = 0; i != defaults.length; ++i) {\r\n                var d = defaults[i];\r\n                if (opts[d[0]] === undefined) opts[d[0]] = d[1];\r\n                if (d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\r\n            }\r\n        };\r\n    }\r\n\r\n    var fix_read_opts = fix_opts_func([\r\n        ['cellNF', false], /* emit cell number format string as .z */\r\n        ['cellHTML', true], /* emit html string as .h */\r\n        ['cellFormula', true], /* emit formulae as .f */\r\n        ['cellStyles', false], /* emits style/theme as .s */\r\n        ['cellDates', false], /* emit date cells with type `d` */\r\n\r\n        ['sheetStubs', false], /* emit empty cells */\r\n        ['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\r\n\r\n        ['bookDeps', false], /* parse calculation chains */\r\n        ['bookSheets', false], /* only try to get sheet names (no Sheets) */\r\n        ['bookProps', false], /* only try to get properties (no Sheets) */\r\n        ['bookFiles', false], /* include raw file structure (keys, files, cfb) */\r\n        ['bookVBA', false], /* include vba raw data (vbaraw) */\r\n\r\n        ['password', ''], /* password */\r\n        ['WTF', false] /* WTF mode (throws errors) */\r\n    ]);\r\n\r\n\r\n    var fix_write_opts = fix_opts_func([\r\n        ['cellDates', false], /* write date cells with type `d` */\r\n\r\n        ['bookSST', false], /* Generate Shared String Table */\r\n\r\n        ['bookType', 'xlsx'], /* Type of workbook (xlsx/m/b) */\r\n\r\n        ['WTF', false] /* WTF mode (throws errors) */\r\n    ]);\r\n    function safe_parse_wbrels(wbrels, sheets) {\r\n        if (!wbrels) return 0;\r\n        try {\r\n            wbrels = sheets.map(function pwbr(w) { return [w.name, wbrels['!id'][w.id].Target]; });\r\n        } catch (e) { return null; }\r\n        return !wbrels || wbrels.length === 0 ? null : wbrels;\r\n    }\r\n\r\n    function safe_parse_ws(zip, path, relsPath, sheet, sheetRels, sheets, opts) {\r\n        try {\r\n            sheetRels[sheet] = parse_rels(getzipdata(zip, relsPath, true), path);\r\n            sheets[sheet] = parse_ws(getzipdata(zip, path), path, opts, sheetRels[sheet]);\r\n        } catch (e) { if (opts.WTF) throw e; }\r\n    }\r\n\r\n    var nodirs = function nodirs(x) { return x.substr(-1) != '/'; };\r\n    function parse_zip(zip, opts) {\r\n        make_ssf(SSF);\r\n        opts = opts || {};\r\n        fix_read_opts(opts);\r\n        reset_cp();\r\n\r\n        /* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\r\n        if (safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\r\n\r\n        var entries = keys(zip.files).filter(nodirs).sort();\r\n        var dir = parse_ct(getzipdata(zip, '[Content_Types].xml'), opts);\r\n        var xlsb = false;\r\n        var sheets, binname;\r\n        if (dir.workbooks.length === 0) {\r\n            binname = \"xl/workbook.xml\";\r\n            if (getzipdata(zip, binname, true)) dir.workbooks.push(binname);\r\n        }\r\n        if (dir.workbooks.length === 0) {\r\n            binname = \"xl/workbook.bin\";\r\n            if (!getzipfile(zip, binname, true)) throw new Error(\"Could not find workbook\");\r\n            dir.workbooks.push(binname);\r\n            xlsb = true;\r\n        }\r\n        if (dir.workbooks[0].substr(-3) == \"bin\") xlsb = true;\r\n        if (xlsb) set_cp(1200);\r\n\r\n        if (!opts.bookSheets && !opts.bookProps) {\r\n            strs = [];\r\n            if (dir.sst) strs = parse_sst(getzipdata(zip, dir.sst.replace(/^\\//, '')), dir.sst, opts);\r\n\r\n            // parse themes before styles so that we can reliably decode theme/tint into rgb when parsing styles\r\n            themes = {};\r\n            if (opts.cellStyles && dir.themes.length) themes = parse_theme(getzipdata(zip, dir.themes[0].replace(/^\\//, ''), true), dir.themes[0], opts);\r\n\r\n            styles = {};\r\n            if (dir.style) styles = parse_sty(getzipdata(zip, dir.style.replace(/^\\//, '')), dir.style, opts);\r\n\r\n        }\r\n\r\n        var wb = parse_wb(getzipdata(zip, dir.workbooks[0].replace(/^\\//, '')), dir.workbooks[0], opts);\r\n\r\n        var props = {}, propdata = \"\";\r\n\r\n        if (dir.coreprops.length !== 0) {\r\n            propdata = getzipdata(zip, dir.coreprops[0].replace(/^\\//, ''), true);\r\n            if (propdata) props = parse_core_props(propdata);\r\n            if (dir.extprops.length !== 0) {\r\n                propdata = getzipdata(zip, dir.extprops[0].replace(/^\\//, ''), true);\r\n                if (propdata) parse_ext_props(propdata, props);\r\n            }\r\n        }\r\n\r\n        var custprops = {};\r\n        if (!opts.bookSheets || opts.bookProps) {\r\n            if (dir.custprops.length !== 0) {\r\n                propdata = getzipdata(zip, dir.custprops[0].replace(/^\\//, ''), true);\r\n                if (propdata) custprops = parse_cust_props(propdata, opts);\r\n            }\r\n        }\r\n\r\n        var out = {};\r\n        if (opts.bookSheets || opts.bookProps) {\r\n            if (props.Worksheets && props.SheetNames.length > 0) sheets = props.SheetNames;\r\n            else if (wb.Sheets) sheets = wb.Sheets.map(function pluck(x) { return x.name; });\r\n            if (opts.bookProps) { out.Props = props; out.Custprops = custprops; }\r\n            if (typeof sheets !== 'undefined') out.SheetNames = sheets;\r\n            if (opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\r\n        }\r\n        sheets = {};\r\n\r\n        var deps = {};\r\n        if (opts.bookDeps && dir.calcchain) deps = parse_cc(getzipdata(zip, dir.calcchain.replace(/^\\//, '')), dir.calcchain, opts);\r\n\r\n        var i = 0;\r\n        var sheetRels = {};\r\n        var path, relsPath;\r\n        if (!props.Worksheets) {\r\n            var wbsheets = wb.Sheets;\r\n            props.Worksheets = wbsheets.length;\r\n            props.SheetNames = [];\r\n            for (var j = 0; j != wbsheets.length; ++j) {\r\n                props.SheetNames[j] = wbsheets[j].name;\r\n            }\r\n        }\r\n\r\n        var wbext = xlsb ? \"bin\" : \"xml\";\r\n        var wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\r\n        var wbrels = parse_rels(getzipdata(zip, wbrelsfile, true), wbrelsfile);\r\n        if (wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\r\n        /* Numbers iOS hack */\r\n        var nmode = (getzipdata(zip, \"xl/worksheets/sheet.xml\", true)) ? 1 : 0;\r\n        for (i = 0; i != props.Worksheets; ++i) {\r\n            if (wbrels) path = 'xl/' + (wbrels[i][1]).replace(/[\\/]?xl\\//, \"\");\r\n            else {\r\n                path = 'xl/worksheets/sheet' + (i + 1 - nmode) + \".\" + wbext;\r\n                path = path.replace(/sheet0\\./, \"sheet.\");\r\n            }\r\n            relsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\r\n            safe_parse_ws(zip, path, relsPath, props.SheetNames[i], sheetRels, sheets, opts);\r\n        }\r\n\r\n        if (dir.comments) parse_comments(zip, dir.comments, sheets, sheetRels, opts);\r\n\r\n        out = {\r\n            Directory: dir,\r\n            Workbook: wb,\r\n            Props: props,\r\n            Custprops: custprops,\r\n            Deps: deps,\r\n            Sheets: sheets,\r\n            SheetNames: props.SheetNames,\r\n            Strings: strs,\r\n            Styles: styles,\r\n            Themes: themes,\r\n            SSF: SSF.get_table()\r\n        };\r\n        if (opts.bookFiles) {\r\n            out.keys = entries;\r\n            out.files = zip.files;\r\n        }\r\n        if (opts.bookVBA) {\r\n            if (dir.vba.length > 0) out.vbaraw = getzipdata(zip, dir.vba[0], true);\r\n            else if (dir.defaults.bin === 'application/vnd.ms-office.vbaProject') out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin', true);\r\n        }\r\n        return out;\r\n    }\r\n    function add_rels(rels, rId, f, type, relobj) {\r\n        if (!relobj) relobj = {};\r\n        if (!rels['!id']) rels['!id'] = {};\r\n        relobj.Id = 'rId' + rId;\r\n        relobj.Type = type;\r\n        relobj.Target = f;\r\n        if (rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\r\n        rels['!id'][relobj.Id] = relobj;\r\n        rels[('/' + relobj.Target).replace(\"//\", \"/\")] = relobj;\r\n    }\r\n\r\n    function write_zip(wb, opts) {\r\n        if (wb && !wb.SSF) {\r\n            wb.SSF = SSF.get_table();\r\n        }\r\n        if (wb && wb.SSF) {\r\n            make_ssf(SSF); SSF.load_table(wb.SSF);\r\n            opts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\r\n        }\r\n        opts.rels = {}; opts.wbrels = {};\r\n        opts.Strings = []; opts.Strings.Count = 0; opts.Strings.Unique = 0;\r\n        var wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\r\n        var ct = {\r\n            workbooks: [], sheets: [], calcchains: [], themes: [], styles: [],\r\n            coreprops: [], extprops: [], custprops: [], strs: [], comments: [], vba: [],\r\n            TODO: [], rels: [], xmlns: \"\"\r\n        };\r\n        fix_write_opts(opts = opts || {});\r\n        var zip = new jszip();\r\n        var f = \"\", rId = 0;\r\n\r\n        opts.cellXfs = [];\r\n        get_cell_style(opts.cellXfs, {}, { revssf: { \"General\": 0 } });\r\n\r\n        f = \"docProps/core.xml\";\r\n        zip.file(f, write_core_props(wb.Props, opts));\r\n        ct.coreprops.push(f);\r\n        add_rels(opts.rels, 2, f, RELS.CORE_PROPS);\r\n\r\n        f = \"docProps/app.xml\";\r\n        if (!wb.Props) wb.Props = {};\r\n        wb.Props.SheetNames = wb.SheetNames;\r\n        wb.Props.Worksheets = wb.SheetNames.length;\r\n        zip.file(f, write_ext_props(wb.Props, opts));\r\n        ct.extprops.push(f);\r\n        add_rels(opts.rels, 3, f, RELS.EXT_PROPS);\r\n\r\n        if (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {\r\n            f = \"docProps/custom.xml\";\r\n            zip.file(f, write_cust_props(wb.Custprops, opts));\r\n            ct.custprops.push(f);\r\n            add_rels(opts.rels, 4, f, RELS.CUST_PROPS);\r\n        }\r\n\r\n        f = \"xl/workbook.\" + wbext;\r\n        zip.file(f, write_wb(wb, f, opts));\r\n        ct.workbooks.push(f);\r\n        add_rels(opts.rels, 1, f, RELS.WB);\r\n\r\n        for (rId = 1; rId <= wb.SheetNames.length; ++rId) {\r\n            f = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\r\n            zip.file(f, write_ws(rId - 1, f, opts, wb));\r\n            ct.sheets.push(f);\r\n            add_rels(opts.wbrels, rId, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS);\r\n        }\r\n\r\n        if (opts.Strings != null && opts.Strings.length > 0) {\r\n            f = \"xl/sharedStrings.\" + wbext;\r\n            zip.file(f, write_sst(opts.Strings, f, opts));\r\n            ct.strs.push(f);\r\n            add_rels(opts.wbrels, ++rId, \"sharedStrings.\" + wbext, RELS.SST);\r\n        }\r\n\r\n        /* TODO: something more intelligent with themes */\r\n\r\n        f = \"xl/theme/theme1.xml\";\r\n        zip.file(f, write_theme(opts));\r\n        ct.themes.push(f);\r\n        add_rels(opts.wbrels, ++rId, \"theme/theme1.xml\", RELS.THEME);\r\n\r\n        /* TODO: something more intelligent with styles */\r\n\r\n        f = \"xl/styles.\" + wbext;\r\n        zip.file(f, write_sty(wb, f, opts));\r\n        ct.styles.push(f);\r\n        add_rels(opts.wbrels, ++rId, \"styles.\" + wbext, RELS.STY);\r\n\r\n        zip.file(\"[Content_Types].xml\", write_ct(ct, opts));\r\n        zip.file('_rels/.rels', write_rels(opts.rels));\r\n        zip.file('xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\r\n        return zip;\r\n    }\r\n    function firstbyte(f, o) {\r\n        switch ((o || {}).type || \"base64\") {\r\n            case 'buffer': return f[0];\r\n            case 'base64': return Base64.decode(f.substr(0, 12)).charCodeAt(0);\r\n            case 'binary': return f.charCodeAt(0);\r\n            case 'array': return f[0];\r\n            default: throw new Error(\"Unrecognized type \" + o.type);\r\n        }\r\n    }\r\n\r\n    function read_zip(data, opts) {\r\n        var zip, d = data;\r\n        var o = opts || {};\r\n        if (!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\r\n        switch (o.type) {\r\n            case \"base64\": zip = new jszip(d, { base64: true }); break;\r\n            case \"binary\": case \"array\": zip = new jszip(d, { base64: false }); break;\r\n            case \"buffer\": zip = new jszip(d); break;\r\n            case \"file\": zip = new jszip(d = _fs.readFileSync(data)); break;\r\n            default: throw new Error(\"Unrecognized type \" + o.type);\r\n        }\r\n        return parse_zip(zip, o);\r\n    }\r\n\r\n    function readSync(data, opts) {\r\n        var zip, d = data, isfile = false, n;\r\n        var o = opts || {};\r\n        if (!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\r\n        if (o.type == \"file\") { isfile = true; o.type = \"buffer\"; d = _fs.readFileSync(data); }\r\n        switch ((n = firstbyte(d, o))) {\r\n            case 0xD0:\r\n                if (isfile) o.type = \"file\";\r\n                return parse_xlscfb(CFB.read(data, o), o);\r\n            case 0x09: return parse_xlscfb(s2a(o.type === 'base64' ? Base64.decode(data) : data), o);\r\n            case 0x3C: return parse_xlml(d, o);\r\n            case 0x50:\r\n                if (isfile) o.type = \"file\";\r\n                return read_zip(data, opts);\r\n            default: throw new Error(\"Unsupported file \" + n);\r\n        }\r\n    }\r\n\r\n    function readFileSync(data, opts) {\r\n        var o = opts || {}; o.type = 'file'\r\n        var wb = readSync(data, o);\r\n        wb.FILENAME = data;\r\n        return wb;\r\n    }\r\n    function write_zip_type(wb, opts) {\r\n        var o = opts || {};\r\n        style_builder = new StyleBuilder(opts);\r\n\r\n        var z = write_zip(wb, o);\r\n        switch (o.type) {\r\n            case \"base64\": return z.generate({ type: \"base64\" });\r\n            case \"binary\": return z.generate({ type: \"string\" });\r\n            case \"buffer\": return z.generate({ type: \"nodebuffer\" });\r\n            case \"file\": return _fs.writeFileSync(o.file, z.generate({ type: \"nodebuffer\" }));\r\n            default: throw new Error(\"Unrecognized type \" + o.type);\r\n        }\r\n    }\r\n\r\n    function writeSync(wb, opts) {\r\n        var o = opts || {};\r\n        switch (o.bookType) {\r\n            case 'xml': return write_xlml(wb, o);\r\n            default: return write_zip_type(wb, o);\r\n        }\r\n    }\r\n\r\n    function writeFileSync(wb, filename, opts) {\r\n        var o = opts || {}; o.type = 'file';\r\n\r\n        o.file = filename;\r\n        switch (o.file.substr(-5).toLowerCase()) {\r\n            case '.xlsx': o.bookType = 'xlsx'; break;\r\n            case '.xlsm': o.bookType = 'xlsm'; break;\r\n            case '.xlsb': o.bookType = 'xlsb'; break;\r\n            default: switch (o.file.substr(-4).toLowerCase()) {\r\n                case '.xls': o.bookType = 'xls'; break;\r\n                case '.xml': o.bookType = 'xml'; break;\r\n            }\r\n        }\r\n        return writeSync(wb, o);\r\n    }\r\n\r\n    function decode_row(rowstr) { return parseInt(unfix_row(rowstr), 10) - 1; }\r\n    function encode_row(row) { return \"\" + (row + 1); }\r\n    function fix_row(cstr) { return cstr.replace(/([A-Z]|^)(\\d+)$/, \"$1$$$2\"); }\r\n    function unfix_row(cstr) { return cstr.replace(/\\$(\\d+)$/, \"$1\"); }\r\n\r\n    function decode_col(colstr) { var c = unfix_col(colstr), d = 0, i = 0; for (; i !== c.length; ++i) d = 26 * d + c.charCodeAt(i) - 64; return d - 1; }\r\n    function encode_col(col) { var s = \"\"; for (++col; col; col = Math.floor((col - 1) / 26)) s = String.fromCharCode(((col - 1) % 26) + 65) + s; return s; }\r\n    function fix_col(cstr) { return cstr.replace(/^([A-Z])/, \"$$$1\"); }\r\n    function unfix_col(cstr) { return cstr.replace(/^\\$([A-Z])/, \"$1\"); }\r\n\r\n    function split_cell(cstr) { return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/, \"$1,$2\").split(\",\"); }\r\n    function decode_cell(cstr) { var splt = split_cell(cstr); return { c: decode_col(splt[0]), r: decode_row(splt[1]) }; }\r\n    function encode_cell(cell) { return encode_col(cell.c) + encode_row(cell.r); }\r\n    function fix_cell(cstr) { return fix_col(fix_row(cstr)); }\r\n    function unfix_cell(cstr) { return unfix_col(unfix_row(cstr)); }\r\n    function decode_range(range) { var x = range.split(\":\").map(decode_cell); return { s: x[0], e: x[x.length - 1] }; }\r\n    function encode_range(cs, ce) {\r\n        if (ce === undefined || typeof ce === 'number') return encode_range(cs.s, cs.e);\r\n        if (typeof cs !== 'string') cs = encode_cell(cs); if (typeof ce !== 'string') ce = encode_cell(ce);\r\n        return cs == ce ? cs : cs + \":\" + ce;\r\n    }\r\n\r\n    function safe_decode_range(range) {\r\n        var o = { s: { c: 0, r: 0 }, e: { c: 0, r: 0 } };\r\n        var idx = 0, i = 0, cc = 0;\r\n        var len = range.length;\r\n        for (idx = 0; i < len; ++i) {\r\n            if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\r\n            idx = 26 * idx + cc;\r\n        }\r\n        o.s.c = --idx;\r\n\r\n        for (idx = 0; i < len; ++i) {\r\n            if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\r\n            idx = 10 * idx + cc;\r\n        }\r\n        o.s.r = --idx;\r\n\r\n        if (i === len || range.charCodeAt(++i) === 58) { o.e.c = o.s.c; o.e.r = o.s.r; return o; }\r\n\r\n        for (idx = 0; i != len; ++i) {\r\n            if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\r\n            idx = 26 * idx + cc;\r\n        }\r\n        o.e.c = --idx;\r\n\r\n        for (idx = 0; i != len; ++i) {\r\n            if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\r\n            idx = 10 * idx + cc;\r\n        }\r\n        o.e.r = --idx;\r\n        return o;\r\n    }\r\n\r\n    function safe_format_cell(cell, v) {\r\n        if (cell.z !== undefined) try { return (cell.w = SSF.format(cell.z, v)); } catch (e) { }\r\n        if (!cell.XF) return v;\r\n        try { return (cell.w = SSF.format(cell.XF.ifmt || 0, v)); } catch (e) { return '' + v; }\r\n    }\r\n\r\n    function format_cell(cell, v) {\r\n        if (cell == null || cell.t == null) return \"\";\r\n        if (cell.w !== undefined) return cell.w;\r\n        if (v === undefined) return safe_format_cell(cell, cell.v);\r\n        return safe_format_cell(cell, v);\r\n    }\r\n\r\n    function sheet_to_json(sheet, opts) {\r\n        var val, row, range, header = 0, offset = 1, r, hdr = [], isempty, R, C, v;\r\n        var o = opts != null ? opts : {};\r\n        var raw = o.raw;\r\n        if (sheet == null || sheet[\"!ref\"] == null) return [];\r\n        range = o.range !== undefined ? o.range : sheet[\"!ref\"];\r\n        if (o.header === 1) header = 1;\r\n        else if (o.header === \"A\") header = 2;\r\n        else if (Array.isArray(o.header)) header = 3;\r\n        switch (typeof range) {\r\n            case 'string': r = safe_decode_range(range); break;\r\n            case 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\r\n            default: r = range;\r\n        }\r\n        if (header > 0) offset = 0;\r\n        var rr = encode_row(r.s.r);\r\n        var cols = new Array(r.e.c - r.s.c + 1);\r\n        var out = new Array(r.e.r - r.s.r - offset + 1);\r\n        var outi = 0;\r\n        for (C = r.s.c; C <= r.e.c; ++C) {\r\n            cols[C] = encode_col(C);\r\n            val = sheet[cols[C] + rr];\r\n            switch (header) {\r\n                case 1: hdr[C] = C; break;\r\n                case 2: hdr[C] = cols[C]; break;\r\n                case 3: hdr[C] = o.header[C - r.s.c]; break;\r\n                default:\r\n                    if (val === undefined) continue;\r\n                    hdr[C] = format_cell(val);\r\n            }\r\n        }\r\n\r\n        for (R = r.s.r + offset; R <= r.e.r; ++R) {\r\n            rr = encode_row(R);\r\n            isempty = true;\r\n            if (header === 1) row = [];\r\n            else {\r\n                row = {};\r\n                if (Object.defineProperty) Object.defineProperty(row, '__rowNum__', { value: R, enumerable: false });\r\n                else row.__rowNum__ = R;\r\n            }\r\n            for (C = r.s.c; C <= r.e.c; ++C) {\r\n                val = sheet[cols[C] + rr];\r\n                if (val === undefined || val.t === undefined) continue;\r\n                v = val.v;\r\n                switch (val.t) {\r\n                    case 'e': continue;\r\n                    case 's': break;\r\n                    case 'b': case 'n': break;\r\n                    default: throw 'unrecognized type ' + val.t;\r\n                }\r\n                if (v !== undefined) {\r\n                    row[hdr[C]] = raw ? v : format_cell(val, v);\r\n                    isempty = false;\r\n                }\r\n            }\r\n            if (isempty === false || header === 1) out[outi++] = row;\r\n        }\r\n        out.length = outi;\r\n        return out;\r\n    }\r\n\r\n    function sheet_to_row_object_array(sheet, opts) { return sheet_to_json(sheet, opts != null ? opts : {}); }\r\n\r\n    function sheet_to_csv(sheet, opts) {\r\n        var out = \"\", txt = \"\", qreg = /\"/g;\r\n        var o = opts == null ? {} : opts;\r\n        if (sheet == null || sheet[\"!ref\"] == null) return \"\";\r\n        var r = safe_decode_range(sheet[\"!ref\"]);\r\n        var FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\r\n        var RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\r\n        var row = \"\", rr = \"\", cols = [];\r\n        var i = 0, cc = 0, val;\r\n        var R = 0, C = 0;\r\n        for (C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\r\n        for (R = r.s.r; R <= r.e.r; ++R) {\r\n            row = \"\";\r\n            rr = encode_row(R);\r\n            for (C = r.s.c; C <= r.e.c; ++C) {\r\n                val = sheet[cols[C] + rr];\r\n                txt = val !== undefined ? '' + format_cell(val) : \"\";\r\n                for (i = 0, cc = 0; i !== txt.length; ++i) if ((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34) {\r\n                    txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\"; break;\r\n                }\r\n                row += (C === r.s.c ? \"\" : FS) + txt;\r\n            }\r\n            out += row + RS;\r\n        }\r\n        return out;\r\n    }\r\n    var make_csv = sheet_to_csv;\r\n\r\n    function sheet_to_formulae(sheet) {\r\n        var cmds, y = \"\", x, val = \"\";\r\n        if (sheet == null || sheet[\"!ref\"] == null) return \"\";\r\n        var r = safe_decode_range(sheet['!ref']), rr = \"\", cols = [], C;\r\n        cmds = new Array((r.e.r - r.s.r + 1) * (r.e.c - r.s.c + 1));\r\n        var i = 0;\r\n        for (C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\r\n        for (var R = r.s.r; R <= r.e.r; ++R) {\r\n            rr = encode_row(R);\r\n            for (C = r.s.c; C <= r.e.c; ++C) {\r\n                y = cols[C] + rr;\r\n                x = sheet[y];\r\n                val = \"\";\r\n                if (x === undefined) continue;\r\n                if (x.f != null) val = x.f;\r\n                else if (x.w !== undefined) val = \"'\" + x.w;\r\n                else if (x.v === undefined) continue;\r\n                else val = \"\" + x.v;\r\n                cmds[i++] = y + \"=\" + val;\r\n            }\r\n        }\r\n        cmds.length = i;\r\n        return cmds;\r\n    }\r\n\r\n    var DENSE = null;\r\n    var good_pd_date = new Date('2017-02-19T19:06:09.000Z');\r\n    if (isNaN(good_pd_date.getFullYear())) good_pd_date = new Date('2/19/17');\r\n    var good_pd = good_pd_date.getFullYear() == 2017;\r\n\r\n    function parseDate(str, fixdate) {\r\n        var d = new Date(str);\r\n        if (good_pd) {\r\n            if (fixdate > 0) d.setTime(d.getTime() + d.getTimezoneOffset() * 60 * 1000);\r\n            else if (fixdate < 0) d.setTime(d.getTime() - d.getTimezoneOffset() * 60 * 1000);\r\n            return d;\r\n        }\r\n        if (str instanceof Date) return str;\r\n        if (good_pd_date.getFullYear() == 1917 && !isNaN(d.getFullYear())) {\r\n            var s = d.getFullYear();\r\n            if (str.indexOf(\"\" + s) > -1) return d;\r\n            d.setFullYear(d.getFullYear() + 100); return d;\r\n        }\r\n        var n = str.match(/\\d+/g) || [\"2017\", \"2\", \"19\", \"0\", \"0\", \"0\"];\r\n        var out = new Date(+n[0], +n[1] - 1, +n[2], (+n[3] || 0), (+n[4] || 0), (+n[5] || 0));\r\n        if (str.indexOf(\"Z\") > -1) out = new Date(out.getTime() - out.getTimezoneOffset() * 60 * 1000);\r\n        return out;\r\n    }\r\n\r\n    function fuzzynum(s) {\r\n        var cellValue = s.replace(/\\s+/g, '');\r\n        var v = Number(cellValue);\r\n        if (!isNaN(v)) return v;\r\n        var wt = 1;\r\n        var ss = s.replace(/([\\d]),([\\d])/g, \"$1$2\").replace(/[$]/g, \"\").replace(/[%]/g, function () { wt *= 100; return \"\"; });\r\n        if (!isNaN(v = Number(ss))) return v / wt;\r\n        ss = ss.replace(/[(](.*)[)]/, function ($$, $1) { wt = -wt; return $1; });\r\n        if (!isNaN(v = Number(ss))) return v / wt;\r\n        return v;\r\n    }\r\n    function fuzzydate(s) {\r\n        var o = new Date(s), n = new Date(NaN);\r\n        var y = o.getYear(), m = o.getMonth(), d = o.getDate();\r\n        if (isNaN(d)) return n;\r\n        if (y < 0 || y > 8099) return n;\r\n        if ((m > 0 || d > 1) && y != 101) return o;\r\n        if (s.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) return o;\r\n        if (s.match(/[^-0-9:,\\/\\\\]/)) return n;\r\n        return o;\r\n    }\r\n\r\n    function htmldecode(str) {\r\n        return str.trim().replace(/\\s+/g, \" \").replace(/<\\s*[bB][rR]\\s*\\/?>/g, \"\\n\").replace(/<[^>]*>/g, \"\").replace(/&nbsp;/g, \" \");\r\n    }\r\n\r\n    function parse_dom_table(table, _opts) {\r\n        var opts = _opts || {};\r\n        if (DENSE != null) opts.dense = DENSE;\r\n        var ws = opts.dense ? ([]) : ({});\r\n        var rows = table.getElementsByTagName('tr');\r\n        var range = { s: { r: 0, c: 0 }, e: { r: rows.length - 1, c: 0 } };\r\n        var merges = [], midx = 0;\r\n        var R = 0, _C = 0, C = 0, RS = 0, CS = 0;\r\n        for (; R < rows.length; ++R) {\r\n            var row = rows[R];\r\n            var elts = row.children;\r\n            for (_C = C = 0; _C < elts.length; ++_C) {\r\n                var elt = elts[_C], v = htmldecode(elts[_C].innerHTML);\r\n                for (midx = 0; midx < merges.length; ++midx) {\r\n                    var m = merges[midx];\r\n                    if (m.s.c == C && m.s.r <= R && R <= m.e.r) { C = m.e.c + 1; midx = -1; }\r\n                }\r\n                /* TODO: figure out how to extract nonstandard mso- style */\r\n                CS = +elt.getAttribute(\"colspan\") || 1;\r\n                if ((RS = +elt.getAttribute(\"rowspan\")) > 0 || CS > 1) merges.push({ s: { r: R, c: C }, e: { r: R + (RS || 1) - 1, c: C + CS - 1 } });\r\n                var o = { t: 's', v: v };\r\n                if (v != null) {\r\n                    if (v.length == 0) o.t = 'z';\r\n                    else if (opts.raw) { }\r\n                    else if (v.trim().length == 0) o.t = 's';\r\n                    else if (v === 'TRUE') o = { t: 'b', v: true };\r\n                    else if (v === 'FALSE') o = { t: 'b', v: false };\r\n                    else if (!isNaN(fuzzynum(v))) o = { t: 'n', v: fuzzynum(v) };\r\n                    else if (!isNaN(fuzzydate(v).getDate())) {\r\n                        o = ({ t: 'd', v: parseDate(v) });\r\n                        if (!opts.cellDates) o = ({ t: 'n', v: datenum(o.v) });\r\n                        o.z = opts.dateNF || SSF._table[14];\r\n                    }\r\n                }\r\n\r\n                if (elt.nodeName === \"TH\") {\r\n                    o.s = {\r\n                        font: { bold: true },\r\n                        fill: { fgColor: { rgb: 'FFC0C0C0' }, patternType: 'solid' }\r\n                    };\r\n                } else if (elt.className.split(\" \").filter(isBoldCell).length > 0) {\r\n                    o.s = {\r\n                        font: { bold: true }\r\n                    };\r\n                }\r\n\r\n                if (opts.dense) { if (!ws[R]) ws[R] = []; ws[R][C] = o; }\r\n                else ws[encode_cell({ c: C, r: R })] = o;\r\n                if (range.e.c < C) range.e.c = C;\r\n                C += CS;\r\n            }\r\n        }\r\n        ws['!merges'] = merges;\r\n        ws['!ref'] = encode_range(range);\r\n        return ws;\r\n    }\r\n\r\n    function sheet_to_workbook(sheet, opts) {\r\n        var n = opts && opts.sheet ? opts.sheet : \"Sheet1\";\r\n        var sheets = {}; sheets[n] = sheet;\r\n        return { SheetNames: [n], Sheets: sheets };\r\n    }\r\n\r\n    function table_to_book(table, opts) {\r\n        return sheet_to_workbook(parse_dom_table(table, opts), opts);\r\n    }\r\n\r\n    function isBoldCell(value) {\r\n        return ['rowTotal', 'colTotal', 'pvtGrandTotal'].includes(value);\r\n    }\r\n\r\n    function isBoldAndFilledCell(value) {\r\n        return ['pvtAxisLabel', 'pvtColLabel', 'pvtRowLabel', 'pvtTotalLabel'].includes(value);\r\n    }\r\n\r\n    var utils = {\r\n        encode_col: encode_col,\r\n        encode_row: encode_row,\r\n        encode_cell: encode_cell,\r\n        encode_range: encode_range,\r\n        decode_col: decode_col,\r\n        decode_row: decode_row,\r\n        split_cell: split_cell,\r\n        decode_cell: decode_cell,\r\n        decode_range: decode_range,\r\n        format_cell: format_cell,\r\n        get_formulae: sheet_to_formulae,\r\n        make_csv: sheet_to_csv,\r\n        make_json: sheet_to_json,\r\n        make_formulae: sheet_to_formulae,\r\n        sheet_to_csv: sheet_to_csv,\r\n        sheet_to_json: sheet_to_json,\r\n        sheet_to_formulae: sheet_to_formulae,\r\n        sheet_to_row_object_array: sheet_to_row_object_array,\r\n        table_to_book: table_to_book\r\n    };\r\n\r\n    /////////////////////////////////////////////////////////////////////////////////////////////////////\r\n    var XmlNode = (function () {\r\n        function XmlNode(tagName, attributes, children) {\r\n\r\n            if (!(this instanceof XmlNode)) {\r\n                return new XmlNode(tagName, attributes, children);\r\n            }\r\n            this.tagName = tagName;\r\n            this._attributes = attributes || {};\r\n            this._children = children || [];\r\n            this._prefix = '';\r\n            return this;\r\n        }\r\n\r\n        XmlNode.prototype.createElement = function () {\r\n            return new XmlNode(arguments)\r\n        }\r\n\r\n        XmlNode.prototype.children = function () {\r\n            return this._children;\r\n        }\r\n\r\n        XmlNode.prototype.append = function (node) {\r\n            this._children.push(node);\r\n            return this;\r\n        }\r\n\r\n        XmlNode.prototype.prefix = function (prefix) {\r\n            if (arguments.length == 0) { return this._prefix; }\r\n            this._prefix = prefix;\r\n            return this;\r\n        }\r\n\r\n        XmlNode.prototype.attr = function (attr, value) {\r\n            if (value == undefined) {\r\n                delete this._attributes[attr];\r\n                return this;\r\n            }\r\n            if (arguments.length == 0) {\r\n                return this._attributes;\r\n            }\r\n            else if (typeof attr == 'string' && arguments.length == 1) {\r\n                return this._attributes.attr[attr];\r\n            }\r\n            if (typeof attr == 'object' && arguments.length == 1) {\r\n                for (var key in attr) {\r\n                    this._attributes[key] = attr[key];\r\n                }\r\n            }\r\n            else if (arguments.length == 2 && typeof attr == 'string') {\r\n                this._attributes[attr] = value;\r\n            }\r\n            return this;\r\n        }\r\n\r\n        var APOS = \"'\"; QUOTE = '\"'\r\n        var ESCAPED_QUOTE = {}\r\n        ESCAPED_QUOTE[QUOTE] = '&quot;'\r\n        ESCAPED_QUOTE[APOS] = '&apos;'\r\n\r\n        XmlNode.prototype.escapeAttributeValue = function (att_value) {\r\n            return '\"' + att_value.replace(/\\\"/g, '&quot;') + '\"';// TODO Extend with four other codes\r\n\r\n        }\r\n\r\n        XmlNode.prototype.toXml = function (node) {\r\n            if (!node) node = this;\r\n            var xml = node._prefix;\r\n            xml += '<' + node.tagName;\r\n            if (node._attributes) {\r\n                for (var key in node._attributes) {\r\n                    xml += ' ' + key + '=' + this.escapeAttributeValue('' + node._attributes[key]) + ''\r\n                }\r\n            }\r\n            if (node._children && node._children.length > 0) {\r\n                xml += \">\";\r\n                for (var i = 0; i < node._children.length; i++) {\r\n                    xml += this.toXml(node._children[i]);\r\n                }\r\n                xml += '</' + node.tagName + '>';\r\n            }\r\n            else {\r\n                xml += '/>';\r\n            }\r\n            return xml;\r\n        }\r\n        return XmlNode;\r\n    })();\r\n    /////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n    var StyleBuilder = function (options) {\r\n\r\n        var customNumFmtId = 164;\r\n\r\n\r\n\r\n        var table_fmt = {\r\n            0: 'General',\r\n            1: '0',\r\n            2: '0.00',\r\n            3: '#,##0',\r\n            4: '#,##0.00',\r\n            9: '0%',\r\n            10: '0.00%',\r\n            11: '0.00E+00',\r\n            12: '# ?/?',\r\n            13: '# ??/??',\r\n            14: 'm/d/yy',\r\n            15: 'd-mmm-yy',\r\n            16: 'd-mmm',\r\n            17: 'mmm-yy',\r\n            18: 'h:mm AM/PM',\r\n            19: 'h:mm:ss AM/PM',\r\n            20: 'h:mm',\r\n            21: 'h:mm:ss',\r\n            22: 'm/d/yy h:mm',\r\n            37: '#,##0 ;(#,##0)',\r\n            38: '#,##0 ;[Red](#,##0)',\r\n            39: '#,##0.00;(#,##0.00)',\r\n            40: '#,##0.00;[Red](#,##0.00)',\r\n            45: 'mm:ss',\r\n            46: '[h]:mm:ss',\r\n            47: 'mmss.0',\r\n            48: '##0.0E+0',\r\n            49: '@',\r\n            56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\r\n        };\r\n        var fmt_table = {};\r\n\r\n        for (var idx in table_fmt) {\r\n            fmt_table[table_fmt[idx]] = idx;\r\n        }\r\n\r\n\r\n        // cache style specs to avoid excessive duplication\r\n        _hashIndex = {};\r\n        _listIndex = [];\r\n\r\n        return {\r\n\r\n            initialize: function (options) {\r\n\r\n                this.$fonts = XmlNode('fonts').attr('count', 0).attr(\"x14ac:knownFonts\", \"1\");\r\n                this.$fills = XmlNode('fills').attr('count', 0);\r\n                this.$borders = XmlNode('borders').attr('count', 0);\r\n                this.$numFmts = XmlNode('numFmts').attr('count', 0);\r\n                this.$cellStyleXfs = XmlNode('cellStyleXfs');\r\n                this.$xf = XmlNode('xf')\r\n                    .attr('numFmtId', 0)\r\n                    .attr('fontId', 0)\r\n                    .attr('fillId', 0)\r\n                    .attr('borderId', 0);\r\n\r\n                this.$cellXfs = XmlNode('cellXfs').attr('count', 0);\r\n                this.$cellStyles = XmlNode('cellStyles')\r\n                    .append(XmlNode('cellStyle')\r\n                        .attr('name', 'Normal')\r\n                        .attr('xfId', 0)\r\n                        .attr('builtinId', 0)\r\n                    );\r\n                this.$dxfs = XmlNode('dxfs').attr('count', \"0\");\r\n                this.$tableStyles = XmlNode('tableStyles')\r\n                    .attr('count', '0')\r\n                    .attr('defaultTableStyle', 'TableStyleMedium9')\r\n                    .attr('defaultPivotStyle', 'PivotStyleMedium4')\r\n\r\n\r\n                this.$styles = XmlNode('styleSheet')\r\n                    .attr('xmlns:mc', 'http://schemas.openxmlformats.org/markup-compatibility/2006')\r\n                    .attr('xmlns:x14ac', 'http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac')\r\n                    .attr('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main')\r\n                    .attr('mc:Ignorable', 'x14ac')\r\n                    .prefix('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>')\r\n                    .append(this.$numFmts)\r\n                    .append(this.$fonts)\r\n                    .append(this.$fills)\r\n                    .append(this.$borders)\r\n                    .append(this.$cellStyleXfs.append(this.$xf))\r\n                    .append(this.$cellXfs)\r\n                    .append(this.$cellStyles)\r\n                    .append(this.$dxfs)\r\n                    .append(this.$tableStyles);\r\n\r\n\r\n                // need to specify styles at index 0 and 1.\r\n                // the second style MUST be gray125 for some reason\r\n\r\n                var defaultStyle = options.defaultCellStyle || {};\r\n                if (!defaultStyle.font) defaultStyle.font = { name: 'Calibri', sz: '12' };\r\n                if (!defaultStyle.font.name) defaultStyle.font.name = 'Calibri';\r\n                if (!defaultStyle.font.sz) defaultStyle.font.sz = 11;\r\n                if (!defaultStyle.fill) defaultStyle.fill = { patternType: \"none\", fgColor: {} };\r\n                if (!defaultStyle.border) defaultStyle.border = {};\r\n                if (!defaultStyle.numFmt) defaultStyle.numFmt = 0;\r\n\r\n                this.defaultStyle = defaultStyle;\r\n\r\n                var gray125Style = JSON.parse(JSON.stringify(defaultStyle));\r\n                gray125Style.fill = { patternType: \"gray125\", fgColor: {} }\r\n\r\n                this.addStyles([defaultStyle, gray125Style]);\r\n                return this;\r\n            },\r\n\r\n            // create a style entry and returns an integer index that can be used in the cell .s property\r\n            // these format of this object follows the emerging Common Spreadsheet Format\r\n            addStyle: function (attributes) {\r\n\r\n                var hashKey = JSON.stringify(attributes);\r\n                var index = _hashIndex[hashKey];\r\n                if (index == undefined) {\r\n\r\n                    index = this._addXf(attributes); //_listIndex.push(attributes) -1;\r\n                    _hashIndex[hashKey] = index;\r\n                }\r\n                else {\r\n                    index = _hashIndex[hashKey];\r\n                }\r\n                return index;\r\n            },\r\n\r\n            // create style entries and returns array of integer indexes that can be used in cell .s property\r\n            addStyles: function (styles) {\r\n                var self = this;\r\n                return styles.map(function (style) {\r\n                    return self.addStyle(style);\r\n                })\r\n            },\r\n\r\n            _duckTypeStyle: function (attributes) {\r\n\r\n                if (typeof attributes == 'object' && (attributes.patternFill || attributes.fgColor)) {\r\n                    return { fill: attributes }; // this must be read via XLSX.parseFile(...)\r\n                }\r\n                else if (attributes.font || attributes.numFmt || attributes.border || attributes.fill) {\r\n                    return attributes;\r\n                }\r\n                else {\r\n                    return this._getStyleCSS(attributes)\r\n                }\r\n            },\r\n\r\n            _getStyleCSS: function (css) {\r\n                return css; //TODO\r\n            },\r\n\r\n            // Create an <xf> record for the style as well as corresponding <font>, <fill>, <border>, <numfmts>\r\n            // Right now this is simple and creates a <font>, <fill>, <border>, <numfmts> for every <xf>\r\n            // We could perhaps get fancier and avoid duplicating  auxiliary entries as Excel presumably intended, but bother.\r\n            _addXf: function (attributes) {\r\n\r\n\r\n                var fontId = this._addFont(attributes.font);\r\n                var fillId = this._addFill(attributes.fill);\r\n                var borderId = this._addBorder(attributes.border);\r\n                var numFmtId = this._addNumFmt(attributes.numFmt);\r\n\r\n                var $xf = XmlNode('xf')\r\n                    .attr(\"numFmtId\", numFmtId)\r\n                    .attr(\"fontId\", fontId)\r\n                    .attr(\"fillId\", fillId)\r\n                    .attr(\"borderId\", borderId)\r\n                    .attr(\"xfId\", \"0\");\r\n\r\n                if (fontId > 0) {\r\n                    $xf.attr('applyFont', \"1\");\r\n                }\r\n                if (fillId > 0) {\r\n                    $xf.attr('applyFill', \"1\");\r\n                }\r\n                if (borderId > 0) {\r\n                    $xf.attr('applyBorder', \"1\");\r\n                }\r\n                if (numFmtId > 0) {\r\n                    $xf.attr('applyNumberFormat', \"1\");\r\n                }\r\n\r\n                if (attributes.alignment) {\r\n                    var $alignment = XmlNode('alignment');\r\n                    if (attributes.alignment.horizontal) { $alignment.attr('horizontal', attributes.alignment.horizontal); }\r\n                    if (attributes.alignment.vertical) { $alignment.attr('vertical', attributes.alignment.vertical); }\r\n                    if (attributes.alignment.indent) { $alignment.attr('indent', attributes.alignment.indent); }\r\n                    if (attributes.alignment.readingOrder) { $alignment.attr('readingOrder', attributes.alignment.readingOrder); }\r\n                    if (attributes.alignment.wrapText) { $alignment.attr('wrapText', attributes.alignment.wrapText); }\r\n                    if (attributes.alignment.textRotation != undefined) { $alignment.attr('textRotation', attributes.alignment.textRotation); }\r\n\r\n                    $xf.append($alignment).attr('applyAlignment', 1)\r\n\r\n                }\r\n                this.$cellXfs.append($xf);\r\n                var count = +this.$cellXfs.children().length;\r\n\r\n                this.$cellXfs.attr('count', count);\r\n                return count - 1;\r\n            },\r\n\r\n            _addFont: function (attributes) {\r\n\r\n                if (!attributes) { return 0; }\r\n\r\n                var $font = XmlNode('font')\r\n                    .append(XmlNode('sz').attr('val', attributes.sz || this.defaultStyle.font.sz))\r\n                    .append(XmlNode('name').attr('val', attributes.name || this.defaultStyle.font.name))\r\n\r\n                if (attributes.bold) $font.append(XmlNode('b'));\r\n                if (attributes.underline) $font.append(XmlNode('u'));\r\n                if (attributes.italic) $font.append(XmlNode('i'));\r\n                if (attributes.strike) $font.append(XmlNode('strike'));\r\n                if (attributes.outline) $font.append(XmlNode('outline'));\r\n                if (attributes.shadow) $font.append(XmlNode('shadow'));\r\n\r\n                if (attributes.vertAlign) {\r\n                    $font.append(XmlNode('vertAlign').attr('val', attributes.vertAlign))\r\n                }\r\n\r\n\r\n                if (attributes.color) {\r\n                    if (attributes.color.theme) {\r\n                        $font.append(XmlNode('color').attr('theme', attributes.color.theme))\r\n\r\n                        if (attributes.color.tint) { //tint only if theme\r\n                            $font.append(XmlNode('tint').attr('theme', attributes.color.tint))\r\n                        }\r\n\r\n                    } else if (attributes.color.rgb) { // not both rgb and theme\r\n                        $font.append(XmlNode('color').attr('rgb', attributes.color.rgb))\r\n                    }\r\n                }\r\n\r\n                this.$fonts.append($font);\r\n\r\n                var count = this.$fonts.children().length;\r\n                this.$fonts.attr('count', count);\r\n                return count - 1;\r\n            },\r\n\r\n            _addNumFmt: function (numFmt) {\r\n                if (!numFmt) { return 0; }\r\n\r\n                if (typeof numFmt == 'string') {\r\n                    var numFmtIdx = fmt_table[numFmt];\r\n                    if (numFmtIdx >= 0) {\r\n                        return numFmtIdx; // we found a match against built in formats\r\n                    }\r\n                }\r\n\r\n                if (/^[0-9]+$/.exec(numFmt)) {\r\n                    return numFmt; // we're matching an integer against some known code\r\n                }\r\n                numFmt = numFmt\r\n                    .replace(/&/g, '&amp;')\r\n                    .replace(/</g, '&lt;')\r\n                    .replace(/>/g, '&gt;')\r\n                    .replace(/\"/g, '&quot;')\r\n                    .replace(/'/g, '&apos;');\r\n\r\n\r\n                var $numFmt = XmlNode('numFmt')\r\n                    .attr('numFmtId', (++customNumFmtId))\r\n                    .attr('formatCode', numFmt);\r\n\r\n\r\n                this.$numFmts.append($numFmt);\r\n\r\n                var count = this.$numFmts.children().length;\r\n                this.$numFmts.attr('count', count);\r\n                return customNumFmtId;\r\n            },\r\n\r\n            _addFill: function (attributes) {\r\n\r\n                if (!attributes) { return 0; }\r\n\r\n                var $patternFill = XmlNode('patternFill')\r\n                    .attr('patternType', attributes.patternType || 'solid');\r\n\r\n                if (attributes.fgColor) {\r\n                    var $fgColor = XmlNode('fgColor');\r\n\r\n                    //Excel doesn't like it when we set both rgb and theme+tint, but xlsx.parseFile() sets both\r\n                    //var $fgColor = createElement('<fgColor/>', null, null, {xmlMode: true}).attr(attributes.fgColor)\r\n                    if (attributes.fgColor.rgb) {\r\n\r\n                        if (attributes.fgColor.rgb.length == 6) {\r\n                            attributes.fgColor.rgb = \"FF\" + attributes.fgColor.rgb /// add alpha to an RGB as Excel expects aRGB\r\n                        }\r\n\r\n                        $fgColor.attr('rgb', attributes.fgColor.rgb);\r\n                        $patternFill.append($fgColor);\r\n                    }\r\n                    else if (attributes.fgColor.theme) {\r\n                        $fgColor.attr('theme', attributes.fgColor.theme);\r\n                        if (attributes.fgColor.tint) {\r\n                            $fgColor.attr('tint', attributes.fgColor.tint);\r\n                        }\r\n                        $patternFill.append($fgColor);\r\n                    }\r\n\r\n                    if (!attributes.bgColor) {\r\n                        attributes.bgColor = { \"indexed\": \"64\" }\r\n                    }\r\n                }\r\n\r\n                if (attributes.bgColor) {\r\n                    var $bgColor = XmlNode('bgColor').attr(attributes.bgColor);\r\n                    $patternFill.append($bgColor);\r\n                }\r\n\r\n                var $fill = XmlNode('fill')\r\n                    .append($patternFill);\r\n\r\n                this.$fills.append($fill);\r\n\r\n                var count = this.$fills.children().length;\r\n                this.$fills.attr('count', count);\r\n                return count - 1;\r\n            },\r\n\r\n            _getSubBorder: function (direction, spec) {\r\n\r\n                var $direction = XmlNode(direction);\r\n                if (spec) {\r\n                    if (spec.style) $direction.attr('style', spec.style);\r\n                    if (spec.color) {\r\n                        var $color = XmlNode('color');\r\n                        if (spec.color.auto) {\r\n                            $color.attr('auto', spec.color.auto);\r\n                        }\r\n                        else if (spec.color.rgb) {\r\n                            $color.attr('rgb', spec.color.rgb);\r\n                        }\r\n                        else if (spec.color.theme || spec.color.tint) {\r\n                            $color.attr('theme', spec.color.theme || \"1\");\r\n                            $color.attr('tint', spec.color.tint || \"0\");\r\n                        }\r\n                        $direction.append($color)\r\n                    }\r\n                }\r\n                return $direction;\r\n            },\r\n\r\n            _addBorder: function (attributes) {\r\n                if (!attributes) { return 0; }\r\n\r\n                var self = this;\r\n\r\n                var $border = XmlNode('border')\r\n                    .attr(\"diagonalUp\", attributes.diagonalUp)\r\n                    .attr(\"diagonalDown\", attributes.diagonalDown);\r\n\r\n                var directions = [\"left\", \"right\", \"top\", \"bottom\", \"diagonal\"];\r\n\r\n                directions.forEach(function (direction) {\r\n                    $border.append(self._getSubBorder(direction, attributes[direction]))\r\n                });\r\n                this.$borders.append($border);\r\n\r\n                var count = this.$borders.children().length;\r\n                this.$borders.attr('count', count);\r\n                return count - 1;\r\n            },\r\n\r\n            toXml: function () {\r\n                return this.$styles.toXml();\r\n            }\r\n        }.initialize(options || {});\r\n    }\r\n\r\n\r\n    XLSX.parse_xlscfb = parse_xlscfb;\r\n    XLSX.parse_zip = parse_zip;\r\n    XLSX.read = readSync; //xlsread\r\n    XLSX.readFile = readFileSync; //readFile\r\n    XLSX.readFileSync = readFileSync;\r\n    XLSX.write = writeSync;\r\n    XLSX.writeFile = writeFileSync;\r\n    XLSX.writeFileSync = writeFileSync;\r\n    XLSX.utils = utils;\r\n    XLSX.CFB = CFB;\r\n    XLSX.SSF = SSF;\r\n})(typeof exports !== 'undefined' ? exports : XLSX);\r\nvar XLS = XLSX;\r\n","/* FileSaver.js\r\n * A saveAs() FileSaver implementation.\r\n * 1.3.2\r\n * 2016-06-16 18:25:19\r\n *\r\n * By Eli Grey, http://eligrey.com\r\n * License: MIT\r\n *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\r\n */\r\n\r\n/*global self */\r\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\r\n\r\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */\r\n\r\nvar saveAs = saveAs || (function(view) {\r\n\t\"use strict\";\r\n\t// IE <10 is explicitly unsupported\r\n\tif (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\r\n\t\treturn;\r\n\t}\r\n\tvar\r\n\t\t  doc = view.document\r\n\t\t  // only get URL when necessary in case Blob.js hasn't overridden it yet\r\n\t\t, get_URL = function() {\r\n\t\t\treturn view.URL || view.webkitURL || view;\r\n\t\t}\r\n\t\t, save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\r\n\t\t, can_use_save_link = \"download\" in save_link\r\n\t\t, click = function(node) {\r\n\t\t\tvar event = new MouseEvent(\"click\");\r\n\t\t\tnode.dispatchEvent(event);\r\n\t\t}\r\n\t\t, is_safari = /constructor/i.test(view.HTMLElement)\r\n\t\t, is_chrome_ios =/CriOS\\/[\\d]+/.test(navigator.userAgent)\r\n\t\t, throw_outside = function(ex) {\r\n\t\t\t(view.setImmediate || view.setTimeout)(function() {\r\n\t\t\t\tthrow ex;\r\n\t\t\t}, 0);\r\n\t\t}\r\n\t\t, force_saveable_type = \"application/octet-stream\"\r\n\t\t// the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\r\n\t\t, arbitrary_revoke_timeout = 1000 * 40 // in ms\r\n\t\t, revoke = function(file) {\r\n\t\t\tvar revoker = function() {\r\n\t\t\t\tif (typeof file === \"string\") { // file is an object URL\r\n\t\t\t\t\tget_URL().revokeObjectURL(file);\r\n\t\t\t\t} else { // file is a File\r\n\t\t\t\t\tfile.remove();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tsetTimeout(revoker, arbitrary_revoke_timeout);\r\n\t\t}\r\n\t\t, dispatch = function(filesaver, event_types, event) {\r\n\t\t\tevent_types = [].concat(event_types);\r\n\t\t\tvar i = event_types.length;\r\n\t\t\twhile (i--) {\r\n\t\t\t\tvar listener = filesaver[\"on\" + event_types[i]];\r\n\t\t\t\tif (typeof listener === \"function\") {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlistener.call(filesaver, event || filesaver);\r\n\t\t\t\t\t} catch (ex) {\r\n\t\t\t\t\t\tthrow_outside(ex);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t, auto_bom = function(blob) {\r\n\t\t\t// prepend BOM for UTF-8 XML and text/* types (including HTML)\r\n\t\t\t// note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\r\n\t\t\tif (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\r\n\t\t\t\treturn new Blob([String.fromCharCode(0xFEFF), blob], {type: blob.type});\r\n\t\t\t}\r\n\t\t\treturn blob;\r\n\t\t}\r\n\t\t, FileSaver = function(blob, name, no_auto_bom) {\r\n\t\t\tif (!no_auto_bom) {\r\n\t\t\t\tblob = auto_bom(blob);\r\n\t\t\t}\r\n\t\t\t// First try a.download, then web filesystem, then object URLs\r\n\t\t\tvar\r\n\t\t\t\t  filesaver = this\r\n\t\t\t\t, type = blob.type\r\n\t\t\t\t, force = type === force_saveable_type\r\n\t\t\t\t, object_url\r\n\t\t\t\t, dispatch_all = function() {\r\n\t\t\t\t\tdispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\r\n\t\t\t\t}\r\n\t\t\t\t// on any filesys errors revert to saving with object URLs\r\n\t\t\t\t, fs_error = function() {\r\n\t\t\t\t\tif ((is_chrome_ios || (force && is_safari)) && view.FileReader) {\r\n\t\t\t\t\t\t// Safari doesn't allow downloading of blob urls\r\n\t\t\t\t\t\tvar reader = new FileReader();\r\n\t\t\t\t\t\treader.onloadend = function() {\r\n\t\t\t\t\t\t\tvar url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\r\n\t\t\t\t\t\t\tvar popup = view.open(url, '_blank');\r\n\t\t\t\t\t\t\tif(!popup) view.location.href = url;\r\n\t\t\t\t\t\t\turl=undefined; // release reference before dispatching\r\n\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\r\n\t\t\t\t\t\t\tdispatch_all();\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treader.readAsDataURL(blob);\r\n\t\t\t\t\t\tfilesaver.readyState = filesaver.INIT;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// don't create more object URLs than needed\r\n\t\t\t\t\tif (!object_url) {\r\n\t\t\t\t\t\tobject_url = get_URL().createObjectURL(blob);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (force) {\r\n\t\t\t\t\t\tview.location.href = object_url;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar opened = view.open(object_url, \"_blank\");\r\n\t\t\t\t\t\tif (!opened) {\r\n\t\t\t\t\t\t\t// Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\r\n\t\t\t\t\t\t\tview.location.href = object_url;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\r\n\t\t\t\t\tdispatch_all();\r\n\t\t\t\t\trevoke(object_url);\r\n\t\t\t\t}\r\n\t\t\t;\r\n\t\t\tfilesaver.readyState = filesaver.INIT;\r\n\r\n\t\t\tif (can_use_save_link) {\r\n\t\t\t\tobject_url = get_URL().createObjectURL(blob);\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tsave_link.href = object_url;\r\n\t\t\t\t\tsave_link.download = name;\r\n\t\t\t\t\tclick(save_link);\r\n\t\t\t\t\tdispatch_all();\r\n\t\t\t\t\trevoke(object_url);\r\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfs_error();\r\n\t\t}\r\n\t\t, FS_proto = FileSaver.prototype\r\n\t\t, saveAs = function(blob, name, no_auto_bom) {\r\n\t\t\treturn new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\r\n\t\t}\r\n\t;\r\n\t// IE 10+ (native saveAs)\r\n\tif (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\r\n\t\treturn function(blob, name, no_auto_bom) {\r\n\t\t\tname = name || blob.name || \"download\";\r\n\r\n\t\t\tif (!no_auto_bom) {\r\n\t\t\t\tblob = auto_bom(blob);\r\n\t\t\t}\r\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name);\r\n\t\t};\r\n\t}\r\n\r\n\tFS_proto.abort = function(){};\r\n\tFS_proto.readyState = FS_proto.INIT = 0;\r\n\tFS_proto.WRITING = 1;\r\n\tFS_proto.DONE = 2;\r\n\r\n\tFS_proto.error =\r\n\tFS_proto.onwritestart =\r\n\tFS_proto.onprogress =\r\n\tFS_proto.onwrite =\r\n\tFS_proto.onabort =\r\n\tFS_proto.onerror =\r\n\tFS_proto.onwriteend =\r\n\t\tnull;\r\n\r\n\treturn saveAs;\r\n}(\r\n\t   typeof self !== \"undefined\" && self\r\n\t|| typeof window !== \"undefined\" && window\r\n\t|| this.content\r\n));\r\n// `self` is undefined in Firefox for Android content script context\r\n// while `this` is nsIContentFrameMessageManager\r\n// with an attribute `content` that corresponds to the window\r\n\r\nif (typeof module !== \"undefined\" && module.exports) {\r\n  module.exports.saveAs = saveAs;\r\n} else if ((typeof define !== \"undefined\" && define !== null) && (define.amd !== null)) {\r\n  define([], function() {\r\n    return saveAs;\r\n  });\r\n}\r\n","\r\n/*\r\n * JQuery zTree core v3.5.19.1\r\n * http://zTree.me/\r\n *\r\n * Copyright (c) 2010 Hunter.z\r\n *\r\n * Licensed same as jquery - MIT License\r\n * http://www.opensource.org/licenses/mit-license.php\r\n *\r\n * email: hunter.z@263.net\r\n * Date: 2015-10-26\r\n */\r\n(function(q){var I,J,K,L,M,N,v,s={},w={},x={},O={treeId:\"\",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:\"fast\",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:\"children\",name:\"name\",title:\"\",url:\"url\",icon:\"icon\"},simpleData:{enable:!1,idKey:\"id\",pIdKey:\"pId\",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:\"application/x-www-form-urlencoded\",type:\"post\",dataType:\"text\",\r\nurl:\"\",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},y=[function(b){var a=b.treeObj,c=f.event;a.bind(c.NODECREATED,function(a,c,g){j.apply(b.callback.onNodeCreated,\r\n[a,c,g])});a.bind(c.CLICK,function(a,c,g,m,h){j.apply(b.callback.onClick,[c,g,m,h])});a.bind(c.EXPAND,function(a,c,g){j.apply(b.callback.onExpand,[a,c,g])});a.bind(c.COLLAPSE,function(a,c,g){j.apply(b.callback.onCollapse,[a,c,g])});a.bind(c.ASYNC_SUCCESS,function(a,c,g,h){j.apply(b.callback.onAsyncSuccess,[a,c,g,h])});a.bind(c.ASYNC_ERROR,function(a,c,g,h,f,i){j.apply(b.callback.onAsyncError,[a,c,g,h,f,i])});a.bind(c.REMOVE,function(a,c,g){j.apply(b.callback.onRemove,[a,c,g])});a.bind(c.SELECTED,\r\nfunction(a,c,g){j.apply(b.callback.onSelected,[c,g])});a.bind(c.UNSELECTED,function(a,c,g){j.apply(b.callback.onUnSelected,[c,g])})}],z=[function(b){var a=f.event;b.treeObj.unbind(a.NODECREATED).unbind(a.CLICK).unbind(a.EXPAND).unbind(a.COLLAPSE).unbind(a.ASYNC_SUCCESS).unbind(a.ASYNC_ERROR).unbind(a.REMOVE).unbind(a.SELECTED).unbind(a.UNSELECTED)}],A=[function(b){var a=h.getCache(b);a||(a={},h.setCache(b,a));a.nodes=[];a.doms=[]}],B=[function(b,a,c,d,e,g){if(c){var m=h.getRoot(b),f=b.data.key.children;\r\nc.level=a;c.tId=b.treeId+\"_\"+ ++m.zId;c.parentTId=d?d.tId:null;c.open=typeof c.open==\"string\"?j.eqs(c.open,\"true\"):!!c.open;c[f]&&c[f].length>0?(c.isParent=!0,c.zAsync=!0):(c.isParent=typeof c.isParent==\"string\"?j.eqs(c.isParent,\"true\"):!!c.isParent,c.open=c.isParent&&!b.async.enable?c.open:!1,c.zAsync=!c.isParent);c.isFirstNode=e;c.isLastNode=g;c.getParentNode=function(){return h.getNodeCache(b,c.parentTId)};c.getPreNode=function(){return h.getPreNode(b,c)};c.getNextNode=function(){return h.getNextNode(b,\r\nc)};c.getIndex=function(){return h.getNodeIndex(b,c)};c.getPath=function(){return h.getNodePath(b,c)};c.isAjaxing=!1;h.fixPIdKeyValue(b,c)}}],u=[function(b){var a=b.target,c=h.getSetting(b.data.treeId),d=\"\",e=null,g=\"\",m=\"\",i=null,n=null,k=null;if(j.eqs(b.type,\"mousedown\"))m=\"mousedown\";else if(j.eqs(b.type,\"mouseup\"))m=\"mouseup\";else if(j.eqs(b.type,\"contextmenu\"))m=\"contextmenu\";else if(j.eqs(b.type,\"click\"))if(j.eqs(a.tagName,\"span\")&&a.getAttribute(\"treeNode\"+f.id.SWITCH)!==null)d=j.getNodeMainDom(a).id,\r\ng=\"switchNode\";else{if(k=j.getMDom(c,a,[{tagName:\"a\",attrName:\"treeNode\"+f.id.A}]))d=j.getNodeMainDom(k).id,g=\"clickNode\"}else if(j.eqs(b.type,\"dblclick\")&&(m=\"dblclick\",k=j.getMDom(c,a,[{tagName:\"a\",attrName:\"treeNode\"+f.id.A}])))d=j.getNodeMainDom(k).id,g=\"switchNode\";if(m.length>0&&d.length==0&&(k=j.getMDom(c,a,[{tagName:\"a\",attrName:\"treeNode\"+f.id.A}])))d=j.getNodeMainDom(k).id;if(d.length>0)switch(e=h.getNodeCache(c,d),g){case \"switchNode\":e.isParent?j.eqs(b.type,\"click\")||j.eqs(b.type,\"dblclick\")&&\r\nj.apply(c.view.dblClickExpand,[c.treeId,e],c.view.dblClickExpand)?i=I:g=\"\":g=\"\";break;case \"clickNode\":i=J}switch(m){case \"mousedown\":n=K;break;case \"mouseup\":n=L;break;case \"dblclick\":n=M;break;case \"contextmenu\":n=N}return{stop:!1,node:e,nodeEventType:g,nodeEventCallback:i,treeEventType:m,treeEventCallback:n}}],C=[function(b){var a=h.getRoot(b);a||(a={},h.setRoot(b,a));a[b.data.key.children]=[];a.expandTriggerFlag=!1;a.curSelectedList=[];a.noSelection=!0;a.createdNodes=[];a.zId=0;a._ver=(new Date).getTime()}],\r\nD=[],E=[],F=[],G=[],H=[],h={addNodeCache:function(b,a){h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=a},getNodeCacheId:function(b){return b.substring(b.lastIndexOf(\"_\")+1)},addAfterA:function(b){E.push(b)},addBeforeA:function(b){D.push(b)},addInnerAfterA:function(b){G.push(b)},addInnerBeforeA:function(b){F.push(b)},addInitBind:function(b){y.push(b)},addInitUnBind:function(b){z.push(b)},addInitCache:function(b){A.push(b)},addInitNode:function(b){B.push(b)},addInitProxy:function(b,a){a?u.splice(0,0,\r\nb):u.push(b)},addInitRoot:function(b){C.push(b)},addNodesData:function(b,a,c,d){var e=b.data.key.children;a[e]?c>=a[e].length&&(c=-1):(a[e]=[],c=-1);if(a[e].length>0&&c===0)a[e][0].isFirstNode=!1,i.setNodeLineIcos(b,a[e][0]);else if(a[e].length>0&&c<0)a[e][a[e].length-1].isLastNode=!1,i.setNodeLineIcos(b,a[e][a[e].length-1]);a.isParent=!0;c<0?a[e]=a[e].concat(d):(b=[c,0].concat(d),a[e].splice.apply(a[e],b))},addSelectedNode:function(b,a){var c=h.getRoot(b);h.isSelectedNode(b,a)||c.curSelectedList.push(a)},\r\naddCreatedNode:function(b,a){(b.callback.onNodeCreated||b.view.addDiyDom)&&h.getRoot(b).createdNodes.push(a)},addZTreeTools:function(b){H.push(b)},exSetting:function(b){q.extend(!0,O,b)},fixPIdKeyValue:function(b,a){b.data.simpleData.enable&&(a[b.data.simpleData.pIdKey]=a.parentTId?a.getParentNode()[b.data.simpleData.idKey]:b.data.simpleData.rootPId)},getAfterA:function(b,a,c){for(var d=0,e=E.length;d<e;d++)E[d].apply(this,arguments)},getBeforeA:function(b,a,c){for(var d=0,e=D.length;d<e;d++)D[d].apply(this,\r\narguments)},getInnerAfterA:function(b,a,c){for(var d=0,e=G.length;d<e;d++)G[d].apply(this,arguments)},getInnerBeforeA:function(b,a,c){for(var d=0,e=F.length;d<e;d++)F[d].apply(this,arguments)},getCache:function(b){return x[b.treeId]},getNodeIndex:function(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length-1;e<=g;e++)if(d[c][e]===a)return e;return-1},getNextNode:function(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?\r\na.getParentNode():h.getRoot(b),e=0,g=d[c].length-1;e<=g;e++)if(d[c][e]===a)return e==g?null:d[c][e+1];return null},getNodeByParam:function(b,a,c,d){if(!a||!c)return null;for(var e=b.data.key.children,g=0,f=a.length;g<f;g++){if(a[g][c]==d)return a[g];var i=h.getNodeByParam(b,a[g][e],c,d);if(i)return i}return null},getNodeCache:function(b,a){if(!a)return null;var c=x[b.treeId].nodes[h.getNodeCacheId(a)];return c?c:null},getNodeName:function(b,a){return\"\"+a[b.data.key.name]},getNodePath:function(b,a){if(!a)return null;\r\nvar c;(c=a.parentTId?a.getParentNode().getPath():[])&&c.push(a);return c},getNodeTitle:function(b,a){return\"\"+a[b.data.key.title===\"\"?b.data.key.name:b.data.key.title]},getNodes:function(b){return h.getRoot(b)[b.data.key.children]},getNodesByParam:function(b,a,c,d){if(!a||!c)return[];for(var e=b.data.key.children,g=[],f=0,i=a.length;f<i;f++)a[f][c]==d&&g.push(a[f]),g=g.concat(h.getNodesByParam(b,a[f][e],c,d));return g},getNodesByParamFuzzy:function(b,a,c,d){if(!a||!c)return[];for(var e=b.data.key.children,\r\ng=[],d=d.toLowerCase(),f=0,i=a.length;f<i;f++)typeof a[f][c]==\"string\"&&a[f][c].toLowerCase().indexOf(d)>-1&&g.push(a[f]),g=g.concat(h.getNodesByParamFuzzy(b,a[f][e],c,d));return g},getNodesByFilter:function(b,a,c,d,e){if(!a)return d?null:[];for(var g=b.data.key.children,f=d?null:[],i=0,n=a.length;i<n;i++){if(j.apply(c,[a[i],e],!1)){if(d)return a[i];f.push(a[i])}var k=h.getNodesByFilter(b,a[i][g],c,d,e);if(d&&k)return k;f=d?k:f.concat(k)}return f},getPreNode:function(b,a){if(!a)return null;for(var c=\r\nb.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length;e<g;e++)if(d[c][e]===a)return e==0?null:d[c][e-1];return null},getRoot:function(b){return b?w[b.treeId]:null},getRoots:function(){return w},getSetting:function(b){return s[b]},getSettings:function(){return s},getZTreeTools:function(b){return(b=this.getRoot(this.getSetting(b)))?b.treeTools:null},initCache:function(b){for(var a=0,c=A.length;a<c;a++)A[a].apply(this,arguments)},initNode:function(b,a,c,d,e,g){for(var f=\r\n0,h=B.length;f<h;f++)B[f].apply(this,arguments)},initRoot:function(b){for(var a=0,c=C.length;a<c;a++)C[a].apply(this,arguments)},isSelectedNode:function(b,a){for(var c=h.getRoot(b),d=0,e=c.curSelectedList.length;d<e;d++)if(a===c.curSelectedList[d])return!0;return!1},removeNodeCache:function(b,a){var c=b.data.key.children;if(a[c])for(var d=0,e=a[c].length;d<e;d++)arguments.callee(b,a[c][d]);h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=null},removeSelectedNode:function(b,a){for(var c=h.getRoot(b),d=\r\n0,e=c.curSelectedList.length;d<e;d++)if(a===c.curSelectedList[d]||!h.getNodeCache(b,c.curSelectedList[d].tId))c.curSelectedList.splice(d,1),b.treeObj.trigger(f.event.UNSELECTED,[b.treeId,a]),d--,e--},setCache:function(b,a){x[b.treeId]=a},setRoot:function(b,a){w[b.treeId]=a},setZTreeTools:function(b,a){for(var c=0,d=H.length;c<d;c++)H[c].apply(this,arguments)},transformToArrayFormat:function(b,a){if(!a)return[];var c=b.data.key.children,d=[];if(j.isArray(a))for(var e=0,g=a.length;e<g;e++)d.push(a[e]),\r\na[e][c]&&(d=d.concat(h.transformToArrayFormat(b,a[e][c])));else d.push(a),a[c]&&(d=d.concat(h.transformToArrayFormat(b,a[c])));return d},transformTozTreeFormat:function(b,a){var c,d,e=b.data.simpleData.idKey,g=b.data.simpleData.pIdKey,f=b.data.key.children;if(!e||e==\"\"||!a)return[];if(j.isArray(a)){var h=[],i=[];for(c=0,d=a.length;c<d;c++)i[a[c][e]]=a[c];for(c=0,d=a.length;c<d;c++)i[a[c][g]]&&a[c][e]!=a[c][g]?(i[a[c][g]][f]||(i[a[c][g]][f]=[]),i[a[c][g]][f].push(a[c])):h.push(a[c]);return h}else return[a]}},\r\nl={bindEvent:function(b){for(var a=0,c=y.length;a<c;a++)y[a].apply(this,arguments)},unbindEvent:function(b){for(var a=0,c=z.length;a<c;a++)z[a].apply(this,arguments)},bindTree:function(b){var a={treeId:b.treeId},c=b.treeObj;b.view.txtSelectedEnable||c.bind(\"selectstart\",v).css({\"-moz-user-select\":\"-moz-none\"});c.bind(\"click\",a,l.proxy);c.bind(\"dblclick\",a,l.proxy);c.bind(\"mouseover\",a,l.proxy);c.bind(\"mouseout\",a,l.proxy);c.bind(\"mousedown\",a,l.proxy);c.bind(\"mouseup\",a,l.proxy);c.bind(\"contextmenu\",\r\na,l.proxy)},unbindTree:function(b){b.treeObj.unbind(\"selectstart\",v).unbind(\"click\",l.proxy).unbind(\"dblclick\",l.proxy).unbind(\"mouseover\",l.proxy).unbind(\"mouseout\",l.proxy).unbind(\"mousedown\",l.proxy).unbind(\"mouseup\",l.proxy).unbind(\"contextmenu\",l.proxy)},doProxy:function(b){for(var a=[],c=0,d=u.length;c<d;c++){var e=u[c].apply(this,arguments);a.push(e);if(e.stop)break}return a},proxy:function(b){var a=h.getSetting(b.data.treeId);if(!j.uCanDo(a,b))return!0;for(var a=l.doProxy(b),c=!0,d=0,e=a.length;d<\r\ne;d++){var g=a[d];g.nodeEventCallback&&(c=g.nodeEventCallback.apply(g,[b,g.node])&&c);g.treeEventCallback&&(c=g.treeEventCallback.apply(g,[b,g.node])&&c)}return c}};I=function(b,a){var c=h.getSetting(b.data.treeId);if(a.open){if(j.apply(c.callback.beforeCollapse,[c.treeId,a],!0)==!1)return!0}else if(j.apply(c.callback.beforeExpand,[c.treeId,a],!0)==!1)return!0;h.getRoot(c).expandTriggerFlag=!0;i.switchNode(c,a);return!0};J=function(b,a){var c=h.getSetting(b.data.treeId),d=c.view.autoCancelSelected&&\r\n(b.ctrlKey||b.metaKey)&&h.isSelectedNode(c,a)?0:c.view.autoCancelSelected&&(b.ctrlKey||b.metaKey)&&c.view.selectedMulti?2:1;if(j.apply(c.callback.beforeClick,[c.treeId,a,d],!0)==!1)return!0;d===0?i.cancelPreSelectedNode(c,a):i.selectNode(c,a,d===2);c.treeObj.trigger(f.event.CLICK,[b,c.treeId,a,d]);return!0};K=function(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeMouseDown,[c.treeId,a],!0)&&j.apply(c.callback.onMouseDown,[b,c.treeId,a]);return!0};L=function(b,a){var c=h.getSetting(b.data.treeId);\r\nj.apply(c.callback.beforeMouseUp,[c.treeId,a],!0)&&j.apply(c.callback.onMouseUp,[b,c.treeId,a]);return!0};M=function(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeDblClick,[c.treeId,a],!0)&&j.apply(c.callback.onDblClick,[b,c.treeId,a]);return!0};N=function(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeRightClick,[c.treeId,a],!0)&&j.apply(c.callback.onRightClick,[b,c.treeId,a]);return typeof c.callback.onRightClick!=\"function\"};v=function(b){b=b.originalEvent.srcElement.nodeName.toLowerCase();\r\nreturn b===\"input\"||b===\"textarea\"};var j={apply:function(b,a,c){return typeof b==\"function\"?b.apply(P,a?a:[]):c},canAsync:function(b,a){var c=b.data.key.children;return b.async.enable&&a&&a.isParent&&!(a.zAsync||a[c]&&a[c].length>0)},clone:function(b){if(b===null)return null;var a=j.isArray(b)?[]:{},c;for(c in b)a[c]=b[c]instanceof Date?new Date(b[c].getTime()):typeof b[c]===\"object\"?arguments.callee(b[c]):b[c];return a},eqs:function(b,a){return b.toLowerCase()===a.toLowerCase()},isArray:function(b){return Object.prototype.toString.apply(b)===\r\n\"[object Array]\"},$:function(b,a,c){a&&typeof a!=\"string\"&&(c=a,a=\"\");return typeof b==\"string\"?q(b,c?c.treeObj.get(0).ownerDocument:null):q(\"#\"+b.tId+a,c?c.treeObj:null)},getMDom:function(b,a,c){if(!a)return null;for(;a&&a.id!==b.treeId;){for(var d=0,e=c.length;a.tagName&&d<e;d++)if(j.eqs(a.tagName,c[d].tagName)&&a.getAttribute(c[d].attrName)!==null)return a;a=a.parentNode}return null},getNodeMainDom:function(b){return q(b).parent(\"li\").get(0)||q(b).parentsUntil(\"li\").parent().get(0)},isChildOrSelf:function(b,\r\na){return q(b).closest(\"#\"+a).length>0},uCanDo:function(){return!0}},i={addNodes:function(b,a,c,d,e){if(!b.data.keep.leaf||!a||a.isParent)if(j.isArray(d)||(d=[d]),b.data.simpleData.enable&&(d=h.transformTozTreeFormat(b,d)),a){var g=k(a,f.id.SWITCH,b),m=k(a,f.id.ICON,b),o=k(a,f.id.UL,b);if(!a.open)i.replaceSwitchClass(a,g,f.folder.CLOSE),i.replaceIcoClass(a,m,f.folder.CLOSE),a.open=!1,o.css({display:\"none\"});h.addNodesData(b,a,c,d);i.createNodes(b,a.level+1,d,a,c);e||i.expandCollapseParentNode(b,a,\r\n!0)}else h.addNodesData(b,h.getRoot(b),c,d),i.createNodes(b,0,d,null,c)},appendNodes:function(b,a,c,d,e,g,f){if(!c)return[];var j=[],k=b.data.key.children,l=(d?d:h.getRoot(b))[k],r,Q;if(!l||e>=l.length)e=-1;for(var t=0,q=c.length;t<q;t++){var p=c[t];g&&(r=(e===0||l.length==c.length)&&t==0,Q=e<0&&t==c.length-1,h.initNode(b,a,p,d,r,Q,f),h.addNodeCache(b,p));r=[];p[k]&&p[k].length>0&&(r=i.appendNodes(b,a+1,p[k],p,-1,g,f&&p.open));f&&(i.makeDOMNodeMainBefore(j,b,p),i.makeDOMNodeLine(j,b,p),h.getBeforeA(b,\r\np,j),i.makeDOMNodeNameBefore(j,b,p),h.getInnerBeforeA(b,p,j),i.makeDOMNodeIcon(j,b,p),h.getInnerAfterA(b,p,j),i.makeDOMNodeNameAfter(j,b,p),h.getAfterA(b,p,j),p.isParent&&p.open&&i.makeUlHtml(b,p,j,r.join(\"\")),i.makeDOMNodeMainAfter(j,b,p),h.addCreatedNode(b,p))}return j},appendParentULDom:function(b,a){var c=[],d=k(a,b);!d.get(0)&&a.parentTId&&(i.appendParentULDom(b,a.getParentNode()),d=k(a,b));var e=k(a,f.id.UL,b);e.get(0)&&e.remove();e=i.appendNodes(b,a.level+1,a[b.data.key.children],a,-1,!1,!0);\r\ni.makeUlHtml(b,a,c,e.join(\"\"));d.append(c.join(\"\"))},asyncNode:function(b,a,c,d){var e,g;if(a&&!a.isParent)return j.apply(d),!1;else if(a&&a.isAjaxing)return!1;else if(j.apply(b.callback.beforeAsync,[b.treeId,a],!0)==!1)return j.apply(d),!1;if(a)a.isAjaxing=!0,k(a,f.id.ICON,b).attr({style:\"\",\"class\":f.className.BUTTON+\" \"+f.className.ICO_LOADING});var m={};for(e=0,g=b.async.autoParam.length;a&&e<g;e++){var o=b.async.autoParam[e].split(\"=\"),n=o;o.length>1&&(n=o[1],o=o[0]);m[n]=a[o]}if(j.isArray(b.async.otherParam))for(e=\r\n0,g=b.async.otherParam.length;e<g;e+=2)m[b.async.otherParam[e]]=b.async.otherParam[e+1];else for(var l in b.async.otherParam)m[l]=b.async.otherParam[l];var r=h.getRoot(b)._ver;q.ajax({contentType:b.async.contentType,cache:!1,type:b.async.type,url:j.apply(b.async.url,[b.treeId,a],b.async.url),data:m,dataType:b.async.dataType,success:function(e){if(r==h.getRoot(b)._ver){var g=[];try{g=!e||e.length==0?[]:typeof e==\"string\"?eval(\"(\"+e+\")\"):e}catch(m){g=e}if(a)a.isAjaxing=null,a.zAsync=!0;i.setNodeLineIcos(b,\r\na);g&&g!==\"\"?(g=j.apply(b.async.dataFilter,[b.treeId,a,g],g),i.addNodes(b,a,-1,g?j.clone(g):[],!!c)):i.addNodes(b,a,-1,[],!!c);b.treeObj.trigger(f.event.ASYNC_SUCCESS,[b.treeId,a,e]);j.apply(d)}},error:function(c,d,e){if(r==h.getRoot(b)._ver){if(a)a.isAjaxing=null;i.setNodeLineIcos(b,a);b.treeObj.trigger(f.event.ASYNC_ERROR,[b.treeId,a,c,d,e])}}});return!0},cancelPreSelectedNode:function(b,a,c){var d=h.getRoot(b).curSelectedList,e,g;for(e=d.length-1;e>=0;e--)if(g=d[e],a===g||!a&&(!c||c!==g))if(k(g,\r\nf.id.A,b).removeClass(f.node.CURSELECTED),a){h.removeSelectedNode(b,a);break}else d.splice(e,1),b.treeObj.trigger(f.event.UNSELECTED,[b.treeId,g])},createNodeCallback:function(b){if(b.callback.onNodeCreated||b.view.addDiyDom)for(var a=h.getRoot(b);a.createdNodes.length>0;){var c=a.createdNodes.shift();j.apply(b.view.addDiyDom,[b.treeId,c]);b.callback.onNodeCreated&&b.treeObj.trigger(f.event.NODECREATED,[b.treeId,c])}},createNodes:function(b,a,c,d,e){if(c&&c.length!=0){var g=h.getRoot(b),j=b.data.key.children,\r\nj=!d||d.open||!!k(d[j][0],b).get(0);g.createdNodes=[];var a=i.appendNodes(b,a,c,d,e,!0,j),o,n;d?(d=k(d,f.id.UL,b),d.get(0)&&(o=d)):o=b.treeObj;o&&(e>=0&&(n=o.children()[e]),e>=0&&n?q(n).before(a.join(\"\")):o.append(a.join(\"\")));i.createNodeCallback(b)}},destroy:function(b){b&&(h.initCache(b),h.initRoot(b),l.unbindTree(b),l.unbindEvent(b),b.treeObj.empty(),delete s[b.treeId])},expandCollapseNode:function(b,a,c,d,e){var g=h.getRoot(b),m=b.data.key.children;if(a){if(g.expandTriggerFlag){var o=e,e=function(){o&&\r\no();a.open?b.treeObj.trigger(f.event.EXPAND,[b.treeId,a]):b.treeObj.trigger(f.event.COLLAPSE,[b.treeId,a])};g.expandTriggerFlag=!1}if(!a.open&&a.isParent&&(!k(a,f.id.UL,b).get(0)||a[m]&&a[m].length>0&&!k(a[m][0],b).get(0)))i.appendParentULDom(b,a),i.createNodeCallback(b);if(a.open==c)j.apply(e,[]);else{var c=k(a,f.id.UL,b),g=k(a,f.id.SWITCH,b),n=k(a,f.id.ICON,b);a.isParent?(a.open=!a.open,a.iconOpen&&a.iconClose&&n.attr(\"style\",i.makeNodeIcoStyle(b,a)),a.open?(i.replaceSwitchClass(a,g,f.folder.OPEN),\r\ni.replaceIcoClass(a,n,f.folder.OPEN),d==!1||b.view.expandSpeed==\"\"?(c.show(),j.apply(e,[])):a[m]&&a[m].length>0?c.slideDown(b.view.expandSpeed,e):(c.show(),j.apply(e,[]))):(i.replaceSwitchClass(a,g,f.folder.CLOSE),i.replaceIcoClass(a,n,f.folder.CLOSE),d==!1||b.view.expandSpeed==\"\"||!(a[m]&&a[m].length>0)?(c.hide(),j.apply(e,[])):c.slideUp(b.view.expandSpeed,e))):j.apply(e,[])}}else j.apply(e,[])},expandCollapseParentNode:function(b,a,c,d,e){a&&(a.parentTId?(i.expandCollapseNode(b,a,c,d),a.parentTId&&\r\ni.expandCollapseParentNode(b,a.getParentNode(),c,d,e)):i.expandCollapseNode(b,a,c,d,e))},expandCollapseSonNode:function(b,a,c,d,e){var g=h.getRoot(b),f=b.data.key.children,g=a?a[f]:g[f],f=a?!1:d,j=h.getRoot(b).expandTriggerFlag;h.getRoot(b).expandTriggerFlag=!1;if(g)for(var k=0,l=g.length;k<l;k++)g[k]&&i.expandCollapseSonNode(b,g[k],c,f);h.getRoot(b).expandTriggerFlag=j;i.expandCollapseNode(b,a,c,d,e)},isSelectedNode:function(b,a){if(!a)return!1;var c=h.getRoot(b).curSelectedList,d;for(d=c.length-\r\n1;d>=0;d--)if(a===c[d])return!0;return!1},makeDOMNodeIcon:function(b,a,c){var d=h.getNodeName(a,c),d=a.view.nameIsHTML?d:d.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\");b.push(\"<span id='\",c.tId,f.id.ICON,\"' title='' treeNode\",f.id.ICON,\" class='\",i.makeNodeIcoClass(a,c),\"' style='\",i.makeNodeIcoStyle(a,c),\"'></span><span id='\",c.tId,f.id.SPAN,\"'>\",d,\"</span>\")},makeDOMNodeLine:function(b,a,c){b.push(\"<span id='\",c.tId,f.id.SWITCH,\"' title='' class='\",i.makeNodeLineClass(a,c),\"' treeNode\",\r\nf.id.SWITCH,\"></span>\")},makeDOMNodeMainAfter:function(b){b.push(\"</li>\")},makeDOMNodeMainBefore:function(b,a,c){b.push(\"<li id='\",c.tId,\"' class='\",f.className.LEVEL,c.level,\"' tabindex='0' hidefocus='true' treenode>\")},makeDOMNodeNameAfter:function(b){b.push(\"</a>\")},makeDOMNodeNameBefore:function(b,a,c){var d=h.getNodeTitle(a,c),e=i.makeNodeUrl(a,c),g=i.makeNodeFontCss(a,c),m=[],k;for(k in g)m.push(k,\":\",g[k],\";\");b.push(\"<a id='\",c.tId,f.id.A,\"' class='\",f.className.LEVEL,c.level,\"' treeNode\",\r\nf.id.A,' onclick=\"',c.click||\"\",'\" ',e!=null&&e.length>0?\"href='\"+e+\"'\":\"\",\" target='\",i.makeNodeTarget(c),\"' style='\",m.join(\"\"),\"'\");j.apply(a.view.showTitle,[a.treeId,c],a.view.showTitle)&&d&&b.push(\"title='\",d.replace(/'/g,\"&#39;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\"),\"'\");b.push(\">\")},makeNodeFontCss:function(b,a){var c=j.apply(b.view.fontCss,[b.treeId,a],b.view.fontCss);return c&&typeof c!=\"function\"?c:{}},makeNodeIcoClass:function(b,a){var c=[\"ico\"];a.isAjaxing||(c[0]=(a.iconSkin?a.iconSkin+\r\n\"_\":\"\")+c[0],a.isParent?c.push(a.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU));return f.className.BUTTON+\" \"+c.join(\"_\")},makeNodeIcoStyle:function(b,a){var c=[];if(!a.isAjaxing){var d=a.isParent&&a.iconOpen&&a.iconClose?a.open?a.iconOpen:a.iconClose:a[b.data.key.icon];d&&c.push(\"background:url(\",d,\") 0 0 no-repeat;\");(b.view.showIcon==!1||!j.apply(b.view.showIcon,[b.treeId,a],!0))&&c.push(\"width:0px;height:0px;\")}return c.join(\"\")},makeNodeLineClass:function(b,a){var c=[];b.view.showLine?\r\na.level==0&&a.isFirstNode&&a.isLastNode?c.push(f.line.ROOT):a.level==0&&a.isFirstNode?c.push(f.line.ROOTS):a.isLastNode?c.push(f.line.BOTTOM):c.push(f.line.CENTER):c.push(f.line.NOLINE);a.isParent?c.push(a.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU);return i.makeNodeLineClassEx(a)+c.join(\"_\")},makeNodeLineClassEx:function(b){return f.className.BUTTON+\" \"+f.className.LEVEL+b.level+\" \"+f.className.SWITCH+\" \"},makeNodeTarget:function(b){return b.target||\"_blank\"},makeNodeUrl:function(b,\r\na){var c=b.data.key.url;return a[c]?a[c]:null},makeUlHtml:function(b,a,c,d){c.push(\"<ul id='\",a.tId,f.id.UL,\"' class='\",f.className.LEVEL,a.level,\" \",i.makeUlLineClass(b,a),\"' style='display:\",a.open?\"block\":\"none\",\"'>\");c.push(d);c.push(\"</ul>\")},makeUlLineClass:function(b,a){return b.view.showLine&&!a.isLastNode?f.line.LINE:\"\"},removeChildNodes:function(b,a){if(a){var c=b.data.key.children,d=a[c];if(d){for(var e=0,g=d.length;e<g;e++)h.removeNodeCache(b,d[e]);h.removeSelectedNode(b);delete a[c];\r\nb.data.keep.parent?k(a,f.id.UL,b).empty():(a.isParent=!1,a.open=!1,c=k(a,f.id.SWITCH,b),d=k(a,f.id.ICON,b),i.replaceSwitchClass(a,c,f.folder.DOCU),i.replaceIcoClass(a,d,f.folder.DOCU),k(a,f.id.UL,b).remove())}}},setFirstNode:function(b,a){var c=b.data.key.children;if(a[c].length>0)a[c][0].isFirstNode=!0},setLastNode:function(b,a){var c=b.data.key.children,d=a[c].length;if(d>0)a[c][d-1].isLastNode=!0},removeNode:function(b,a){var c=h.getRoot(b),d=b.data.key.children,e=a.parentTId?a.getParentNode():\r\nc;a.isFirstNode=!1;a.isLastNode=!1;a.getPreNode=function(){return null};a.getNextNode=function(){return null};if(h.getNodeCache(b,a.tId)){k(a,b).remove();h.removeNodeCache(b,a);h.removeSelectedNode(b,a);for(var g=0,j=e[d].length;g<j;g++)if(e[d][g].tId==a.tId){e[d].splice(g,1);break}i.setFirstNode(b,e);i.setLastNode(b,e);var o,g=e[d].length;if(!b.data.keep.parent&&g==0)e.isParent=!1,e.open=!1,g=k(e,f.id.UL,b),j=k(e,f.id.SWITCH,b),o=k(e,f.id.ICON,b),i.replaceSwitchClass(e,j,f.folder.DOCU),i.replaceIcoClass(e,\r\no,f.folder.DOCU),g.css(\"display\",\"none\");else if(b.view.showLine&&g>0){var n=e[d][g-1],g=k(n,f.id.UL,b),j=k(n,f.id.SWITCH,b);o=k(n,f.id.ICON,b);e==c?e[d].length==1?i.replaceSwitchClass(n,j,f.line.ROOT):(c=k(e[d][0],f.id.SWITCH,b),i.replaceSwitchClass(e[d][0],c,f.line.ROOTS),i.replaceSwitchClass(n,j,f.line.BOTTOM)):i.replaceSwitchClass(n,j,f.line.BOTTOM);g.removeClass(f.line.LINE)}}},replaceIcoClass:function(b,a,c){if(a&&!b.isAjaxing&&(b=a.attr(\"class\"),b!=void 0)){b=b.split(\"_\");switch(c){case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:b[b.length-\r\n1]=c}a.attr(\"class\",b.join(\"_\"))}},replaceSwitchClass:function(b,a,c){if(a){var d=a.attr(\"class\");if(d!=void 0){d=d.split(\"_\");switch(c){case f.line.ROOT:case f.line.ROOTS:case f.line.CENTER:case f.line.BOTTOM:case f.line.NOLINE:d[0]=i.makeNodeLineClassEx(b)+c;break;case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:d[1]=c}a.attr(\"class\",d.join(\"_\"));c!==f.folder.DOCU?a.removeAttr(\"disabled\"):a.attr(\"disabled\",\"disabled\")}}},selectNode:function(b,a,c){c||i.cancelPreSelectedNode(b,null,a);k(a,\r\nf.id.A,b).addClass(f.node.CURSELECTED);h.addSelectedNode(b,a);b.treeObj.trigger(f.event.SELECTED,[b.treeId,a])},setNodeFontCss:function(b,a){var c=k(a,f.id.A,b),d=i.makeNodeFontCss(b,a);d&&c.css(d)},setNodeLineIcos:function(b,a){if(a){var c=k(a,f.id.SWITCH,b),d=k(a,f.id.UL,b),e=k(a,f.id.ICON,b),g=i.makeUlLineClass(b,a);g.length==0?d.removeClass(f.line.LINE):d.addClass(g);c.attr(\"class\",i.makeNodeLineClass(b,a));a.isParent?c.removeAttr(\"disabled\"):c.attr(\"disabled\",\"disabled\");e.removeAttr(\"style\");\r\ne.attr(\"style\",i.makeNodeIcoStyle(b,a));e.attr(\"class\",i.makeNodeIcoClass(b,a))}},setNodeName:function(b,a){var c=h.getNodeTitle(b,a),d=k(a,f.id.SPAN,b);d.empty();b.view.nameIsHTML?d.html(h.getNodeName(b,a)):d.text(h.getNodeName(b,a));j.apply(b.view.showTitle,[b.treeId,a],b.view.showTitle)&&k(a,f.id.A,b).attr(\"title\",!c?\"\":c)},setNodeTarget:function(b,a){k(a,f.id.A,b).attr(\"target\",i.makeNodeTarget(a))},setNodeUrl:function(b,a){var c=k(a,f.id.A,b),d=i.makeNodeUrl(b,a);d==null||d.length==0?c.removeAttr(\"href\"):\r\nc.attr(\"href\",d)},switchNode:function(b,a){a.open||!j.canAsync(b,a)?i.expandCollapseNode(b,a,!a.open):b.async.enable?i.asyncNode(b,a)||i.expandCollapseNode(b,a,!a.open):a&&i.expandCollapseNode(b,a,!a.open)}};q.fn.zTree={consts:{className:{BUTTON:\"button\",LEVEL:\"level\",ICO_LOADING:\"ico_loading\",SWITCH:\"switch\"},event:{NODECREATED:\"ztree_nodeCreated\",CLICK:\"ztree_click\",EXPAND:\"ztree_expand\",COLLAPSE:\"ztree_collapse\",ASYNC_SUCCESS:\"ztree_async_success\",ASYNC_ERROR:\"ztree_async_error\",REMOVE:\"ztree_remove\",\r\nSELECTED:\"ztree_selected\",UNSELECTED:\"ztree_unselected\"},id:{A:\"_a\",ICON:\"_ico\",SPAN:\"_span\",SWITCH:\"_switch\",UL:\"_ul\"},line:{ROOT:\"root\",ROOTS:\"roots\",CENTER:\"center\",BOTTOM:\"bottom\",NOLINE:\"noline\",LINE:\"line\"},folder:{OPEN:\"open\",CLOSE:\"close\",DOCU:\"docu\"},node:{CURSELECTED:\"curSelectedNode\"}},_z:{tools:j,view:i,event:l,data:h},getZTreeObj:function(b){return(b=h.getZTreeTools(b))?b:null},destroy:function(b){if(b&&b.length>0)i.destroy(h.getSetting(b));else for(var a in s)i.destroy(s[a])},init:function(b,\r\na,c){var d=j.clone(O);q.extend(!0,d,a);d.treeId=b.attr(\"id\");d.treeObj=b;d.treeObj.empty();s[d.treeId]=d;if(typeof document.body.style.maxHeight===\"undefined\")d.view.expandSpeed=\"\";h.initRoot(d);b=h.getRoot(d);a=d.data.key.children;c=c?j.clone(j.isArray(c)?c:[c]):[];b[a]=d.data.simpleData.enable?h.transformTozTreeFormat(d,c):c;h.initCache(d);l.unbindTree(d);l.bindTree(d);l.unbindEvent(d);l.bindEvent(d);c={setting:d,addNodes:function(a,b,c,f){function h(){i.addNodes(d,a,b,l,f==!0)}a||(a=null);if(a&&\r\n!a.isParent&&d.data.keep.leaf)return null;var k=parseInt(b,10);isNaN(k)?(f=!!c,c=b,b=-1):b=k;if(!c)return null;var l=j.clone(j.isArray(c)?c:[c]);j.canAsync(d,a)?i.asyncNode(d,a,f,h):h();return l},cancelSelectedNode:function(a){i.cancelPreSelectedNode(d,a)},destroy:function(){i.destroy(d)},expandAll:function(a){a=!!a;i.expandCollapseSonNode(d,null,a,!0);return a},expandNode:function(a,b,c,f,n){if(!a||!a.isParent)return null;b!==!0&&b!==!1&&(b=!a.open);if((n=!!n)&&b&&j.apply(d.callback.beforeExpand,\r\n[d.treeId,a],!0)==!1)return null;else if(n&&!b&&j.apply(d.callback.beforeCollapse,[d.treeId,a],!0)==!1)return null;b&&a.parentTId&&i.expandCollapseParentNode(d,a.getParentNode(),b,!1);if(b===a.open&&!c)return null;h.getRoot(d).expandTriggerFlag=n;if(!j.canAsync(d,a)&&c)i.expandCollapseSonNode(d,a,b,!0,function(){if(f!==!1)try{k(a,d).focus().blur()}catch(b){}});else if(a.open=!b,i.switchNode(this.setting,a),f!==!1)try{k(a,d).focus().blur()}catch(l){}return b},getNodes:function(){return h.getNodes(d)},\r\ngetNodeByParam:function(a,b,c){return!a?null:h.getNodeByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b)},getNodeByTId:function(a){return h.getNodeCache(d,a)},getNodesByParam:function(a,b,c){return!a?null:h.getNodesByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b)},getNodesByParamFuzzy:function(a,b,c){return!a?null:h.getNodesByParamFuzzy(d,c?c[d.data.key.children]:h.getNodes(d),a,b)},getNodesByFilter:function(a,b,c,f){b=!!b;return!a||typeof a!=\"function\"?b?null:[]:h.getNodesByFilter(d,c?c[d.data.key.children]:\r\nh.getNodes(d),a,b,f)},getNodeIndex:function(a){if(!a)return null;for(var b=d.data.key.children,c=a.parentTId?a.getParentNode():h.getRoot(d),f=0,i=c[b].length;f<i;f++)if(c[b][f]==a)return f;return-1},getSelectedNodes:function(){for(var a=[],b=h.getRoot(d).curSelectedList,c=0,f=b.length;c<f;c++)a.push(b[c]);return a},isSelectedNode:function(a){return h.isSelectedNode(d,a)},reAsyncChildNodes:function(a,b,c){if(this.setting.async.enable){var j=!a;j&&(a=h.getRoot(d));if(b==\"refresh\"){for(var b=this.setting.data.key.children,\r\nl=0,q=a[b]?a[b].length:0;l<q;l++)h.removeNodeCache(d,a[b][l]);h.removeSelectedNode(d);a[b]=[];j?this.setting.treeObj.empty():k(a,f.id.UL,d).empty()}i.asyncNode(this.setting,j?null:a,!!c)}},refresh:function(){this.setting.treeObj.empty();var a=h.getRoot(d),b=a[d.data.key.children];h.initRoot(d);a[d.data.key.children]=b;h.initCache(d);i.createNodes(d,0,a[d.data.key.children],null,-1)},removeChildNodes:function(a){if(!a)return null;var b=a[d.data.key.children];i.removeChildNodes(d,a);return b?b:null},\r\nremoveNode:function(a,b){a&&(b=!!b,b&&j.apply(d.callback.beforeRemove,[d.treeId,a],!0)==!1||(i.removeNode(d,a),b&&this.setting.treeObj.trigger(f.event.REMOVE,[d.treeId,a])))},selectNode:function(a,b){if(a&&j.uCanDo(d)){b=d.view.selectedMulti&&b;if(a.parentTId)i.expandCollapseParentNode(d,a.getParentNode(),!0,!1,function(){try{k(a,d).focus().blur()}catch(b){}});else try{k(a,d).focus().blur()}catch(c){}i.selectNode(d,a,b)}},transformTozTreeNodes:function(a){return h.transformTozTreeFormat(d,a)},transformToArray:function(a){return h.transformToArrayFormat(d,\r\na)},updateNode:function(a){a&&k(a,d).get(0)&&j.uCanDo(d)&&(i.setNodeName(d,a),i.setNodeTarget(d,a),i.setNodeUrl(d,a),i.setNodeLineIcos(d,a),i.setNodeFontCss(d,a))}};b.treeTools=c;h.setZTreeTools(d,c);b[a]&&b[a].length>0?i.createNodes(d,0,b[a],null,-1):d.async.enable&&d.async.url&&d.async.url!==\"\"&&i.asyncNode(d);return c}};var P=q.fn.zTree,k=j.$,f=P.consts})(jQuery);\r\n\r\n/*\r\n * JQuery zTree excheck v3.5.19.1\r\n * http://zTree.me/\r\n *\r\n * Copyright (c) 2010 Hunter.z\r\n *\r\n * Licensed same as jquery - MIT License\r\n * http://www.opensource.org/licenses/mit-license.php\r\n *\r\n * email: hunter.z@263.net\r\n * Date: 2015-10-26\r\n */\r\n(function(m){var p,q,r,o={event:{CHECK:\"ztree_check\"},id:{CHECK:\"_check\"},checkbox:{STYLE:\"checkbox\",DEFAULT:\"chk\",DISABLED:\"disable\",FALSE:\"false\",TRUE:\"true\",FULL:\"full\",PART:\"part\",FOCUS:\"focus\"},radio:{STYLE:\"radio\",TYPE_ALL:\"all\",TYPE_LEVEL:\"level\"}},v={check:{enable:!1,autoCheckTrigger:!1,chkStyle:o.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:o.radio.TYPE_LEVEL,chkboxType:{Y:\"ps\",N:\"ps\"}},data:{key:{checked:\"checked\"}},callback:{beforeCheck:null,onCheck:null}};p=function(c,\r\na){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=b.data.key.checked;if(k.apply(b.callback.beforeCheck,[b.treeId,a],!0)==!1)return!0;a[d]=!a[d];e.checkNodeRelation(b,a);d=n(a,j.id.CHECK,b);e.setChkClass(b,d,a);e.repairParentChkClassWithSelf(b,a);b.treeObj.trigger(j.event.CHECK,[c,b.treeId,a]);return!0};q=function(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);a.check_Focus=!0;e.setChkClass(b,d,a);return!0};r=function(c,a){if(a.chkDisabled===\r\n!0)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);a.check_Focus=!1;e.setChkClass(b,d,a);return!0};m.extend(!0,m.fn.zTree.consts,o);m.extend(!0,m.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(c,a){var b,d,h,i=c.data.key.children,l=c.data.key.checked;b=j.radio;if(c.check.chkStyle==b.STYLE){var f=g.getRadioCheckedList(c);if(a[l])if(c.check.radioType==b.TYPE_ALL){for(d=f.length-1;d>=0;d--)b=f[d],b[l]&&b!=a&&(b[l]=!1,f.splice(d,1),e.setChkClass(c,n(b,j.id.CHECK,c),b),b.parentTId!=\r\na.parentTId&&e.repairParentChkClassWithSelf(c,b));f.push(a)}else{f=a.parentTId?a.getParentNode():g.getRoot(c);for(d=0,h=f[i].length;d<h;d++)b=f[i][d],b[l]&&b!=a&&(b[l]=!1,e.setChkClass(c,n(b,j.id.CHECK,c),b))}else if(c.check.radioType==b.TYPE_ALL)for(d=0,h=f.length;d<h;d++)if(a==f[d]){f.splice(d,1);break}}else a[l]&&(!a[i]||a[i].length==0||c.check.chkboxType.Y.indexOf(\"s\")>-1)&&e.setSonNodeCheckBox(c,a,!0),!a[l]&&(!a[i]||a[i].length==0||c.check.chkboxType.N.indexOf(\"s\")>-1)&&e.setSonNodeCheckBox(c,\r\na,!1),a[l]&&c.check.chkboxType.Y.indexOf(\"p\")>-1&&e.setParentNodeCheckBox(c,a,!0),!a[l]&&c.check.chkboxType.N.indexOf(\"p\")>-1&&e.setParentNodeCheckBox(c,a,!1)},makeChkClass:function(c,a){var b=c.data.key.checked,d=j.checkbox,h=j.radio,i=\"\",i=a.chkDisabled===!0?d.DISABLED:a.halfCheck?d.PART:c.check.chkStyle==h.STYLE?a.check_Child_State<1?d.FULL:d.PART:a[b]?a.check_Child_State===2||a.check_Child_State===-1?d.FULL:d.PART:a.check_Child_State<1?d.FULL:d.PART,b=c.check.chkStyle+\"_\"+(a[b]?d.TRUE:d.FALSE)+\r\n\"_\"+i,b=a.check_Focus&&a.chkDisabled!==!0?b+\"_\"+d.FOCUS:b;return j.className.BUTTON+\" \"+d.DEFAULT+\" \"+b},repairAllChk:function(c,a){if(c.check.enable&&c.check.chkStyle===j.checkbox.STYLE)for(var b=c.data.key.checked,d=c.data.key.children,h=g.getRoot(c),i=0,l=h[d].length;i<l;i++){var f=h[d][i];f.nocheck!==!0&&f.chkDisabled!==!0&&(f[b]=a);e.setSonNodeCheckBox(c,f,a)}},repairChkClass:function(c,a){if(a&&(g.makeChkFlag(c,a),a.nocheck!==!0)){var b=n(a,j.id.CHECK,c);e.setChkClass(c,b,a)}},repairParentChkClass:function(c,\r\na){if(a&&a.parentTId){var b=a.getParentNode();e.repairChkClass(c,b);e.repairParentChkClass(c,b)}},repairParentChkClassWithSelf:function(c,a){if(a){var b=c.data.key.children;a[b]&&a[b].length>0?e.repairParentChkClass(c,a[b][0]):e.repairParentChkClass(c,a)}},repairSonChkDisabled:function(c,a,b,d){if(a){var h=c.data.key.children;if(a.chkDisabled!=b)a.chkDisabled=b;e.repairChkClass(c,a);if(a[h]&&d)for(var i=0,l=a[h].length;i<l;i++)e.repairSonChkDisabled(c,a[h][i],b,d)}},repairParentChkDisabled:function(c,\r\na,b,d){if(a){if(a.chkDisabled!=b&&d)a.chkDisabled=b;e.repairChkClass(c,a);e.repairParentChkDisabled(c,a.getParentNode(),b,d)}},setChkClass:function(c,a,b){a&&(b.nocheck===!0?a.hide():a.show(),a.attr(\"class\",e.makeChkClass(c,b)))},setParentNodeCheckBox:function(c,a,b,d){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);d||(d=a);g.makeChkFlag(c,a);a.nocheck!==!0&&a.chkDisabled!==!0&&(a[i]=b,e.setChkClass(c,l,a),c.check.autoCheckTrigger&&a!=d&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,\r\na]));if(a.parentTId){l=!0;if(!b)for(var h=a.getParentNode()[h],f=0,k=h.length;f<k;f++)if(h[f].nocheck!==!0&&h[f].chkDisabled!==!0&&h[f][i]||(h[f].nocheck===!0||h[f].chkDisabled===!0)&&h[f].check_Child_State>0){l=!1;break}l&&e.setParentNodeCheckBox(c,a.getParentNode(),b,d)}},setSonNodeCheckBox:function(c,a,b,d){if(a){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);d||(d=a);var f=!1;if(a[h])for(var k=0,m=a[h].length;k<m&&a.chkDisabled!==!0;k++){var o=a[h][k];e.setSonNodeCheckBox(c,\r\no,b,d);o.chkDisabled===!0&&(f=!0)}if(a!=g.getRoot(c)&&a.chkDisabled!==!0){f&&a.nocheck!==!0&&g.makeChkFlag(c,a);if(a.nocheck!==!0&&a.chkDisabled!==!0){if(a[i]=b,!f)a.check_Child_State=a[h]&&a[h].length>0?b?2:0:-1}else a.check_Child_State=-1;e.setChkClass(c,l,a);c.check.autoCheckTrigger&&a!=d&&a.nocheck!==!0&&a.chkDisabled!==!0&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,a])}}}},event:{},data:{getRadioCheckedList:function(c){for(var a=g.getRoot(c).radioCheckedList,b=0,d=a.length;b<d;b++)g.getNodeCache(c,\r\na[b].tId)||(a.splice(b,1),b--,d--);return a},getCheckStatus:function(c,a){if(!c.check.enable||a.nocheck||a.chkDisabled)return null;var b=c.data.key.checked;return{checked:a[b],half:a.halfCheck?a.halfCheck:c.check.chkStyle==j.radio.STYLE?a.check_Child_State===2:a[b]?a.check_Child_State>-1&&a.check_Child_State<2:a.check_Child_State>0}},getTreeCheckedNodes:function(c,a,b,d){if(!a)return[];for(var h=c.data.key.children,i=c.data.key.checked,e=b&&c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL,\r\nd=!d?[]:d,f=0,k=a.length;f<k;f++){if(a[f].nocheck!==!0&&a[f].chkDisabled!==!0&&a[f][i]==b&&(d.push(a[f]),e))break;g.getTreeCheckedNodes(c,a[f][h],b,d);if(e&&d.length>0)break}return d},getTreeChangeCheckedNodes:function(c,a,b){if(!a)return[];for(var d=c.data.key.children,h=c.data.key.checked,b=!b?[]:b,i=0,e=a.length;i<e;i++)a[i].nocheck!==!0&&a[i].chkDisabled!==!0&&a[i][h]!=a[i].checkedOld&&b.push(a[i]),g.getTreeChangeCheckedNodes(c,a[i][d],b);return b},makeChkFlag:function(c,a){if(a){var b=c.data.key.children,\r\nd=c.data.key.checked,h=-1;if(a[b])for(var i=0,e=a[b].length;i<e;i++){var f=a[b][i],g=-1;if(c.check.chkStyle==j.radio.STYLE)if(g=f.nocheck===!0||f.chkDisabled===!0?f.check_Child_State:f.halfCheck===!0?2:f[d]?2:f.check_Child_State>0?2:0,g==2){h=2;break}else g==0&&(h=0);else if(c.check.chkStyle==j.checkbox.STYLE)if(g=f.nocheck===!0||f.chkDisabled===!0?f.check_Child_State:f.halfCheck===!0?1:f[d]?f.check_Child_State===-1||f.check_Child_State===2?2:1:f.check_Child_State>0?1:0,g===1){h=1;break}else if(g===\r\n2&&h>-1&&i>0&&g!==h){h=1;break}else if(h===2&&g>-1&&g<2){h=1;break}else g>-1&&(h=g)}a.check_Child_State=h}}}});var m=m.fn.zTree,k=m._z.tools,j=m.consts,e=m._z.view,g=m._z.data,n=k.$;g.exSetting(v);g.addInitBind(function(c){c.treeObj.bind(j.event.CHECK,function(a,b,d,h){a.srcEvent=b;k.apply(c.callback.onCheck,[a,d,h])})});g.addInitUnBind(function(c){c.treeObj.unbind(j.event.CHECK)});g.addInitCache(function(){});g.addInitNode(function(c,a,b,d){if(b){a=c.data.key.checked;typeof b[a]==\"string\"&&(b[a]=\r\nk.eqs(b[a],\"true\"));b[a]=!!b[a];b.checkedOld=b[a];if(typeof b.nocheck==\"string\")b.nocheck=k.eqs(b.nocheck,\"true\");b.nocheck=!!b.nocheck||c.check.nocheckInherit&&d&&!!d.nocheck;if(typeof b.chkDisabled==\"string\")b.chkDisabled=k.eqs(b.chkDisabled,\"true\");b.chkDisabled=!!b.chkDisabled||c.check.chkDisabledInherit&&d&&!!d.chkDisabled;if(typeof b.halfCheck==\"string\")b.halfCheck=k.eqs(b.halfCheck,\"true\");b.halfCheck=!!b.halfCheck;b.check_Child_State=-1;b.check_Focus=!1;b.getCheckStatus=function(){return g.getCheckStatus(c,\r\nb)};c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL&&b[a]&&g.getRoot(c).radioCheckedList.push(b)}});g.addInitProxy(function(c){var a=c.target,b=g.getSetting(c.data.treeId),d=\"\",h=null,e=\"\",l=null;if(k.eqs(c.type,\"mouseover\")){if(b.check.enable&&k.eqs(a.tagName,\"span\")&&a.getAttribute(\"treeNode\"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e=\"mouseoverCheck\"}else if(k.eqs(c.type,\"mouseout\")){if(b.check.enable&&k.eqs(a.tagName,\"span\")&&a.getAttribute(\"treeNode\"+j.id.CHECK)!==null)d=\r\nk.getNodeMainDom(a).id,e=\"mouseoutCheck\"}else if(k.eqs(c.type,\"click\")&&b.check.enable&&k.eqs(a.tagName,\"span\")&&a.getAttribute(\"treeNode\"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e=\"checkNode\";if(d.length>0)switch(h=g.getNodeCache(b,d),e){case \"checkNode\":l=p;break;case \"mouseoverCheck\":l=q;break;case \"mouseoutCheck\":l=r}return{stop:e===\"checkNode\",node:h,nodeEventType:e,nodeEventCallback:l,treeEventType:\"\",treeEventCallback:null}},!0);g.addInitRoot(function(c){g.getRoot(c).radioCheckedList=[]});\r\ng.addBeforeA(function(c,a,b){c.check.enable&&(g.makeChkFlag(c,a),b.push(\"<span ID='\",a.tId,j.id.CHECK,\"' class='\",e.makeChkClass(c,a),\"' treeNode\",j.id.CHECK,a.nocheck===!0?\" style='display:none;'\":\"\",\"></span>\"))});g.addZTreeTools(function(c,a){a.checkNode=function(a,b,c,g){var f=this.setting.data.key.checked;if(a.chkDisabled!==!0&&(b!==!0&&b!==!1&&(b=!a[f]),g=!!g,(a[f]!==b||c)&&!(g&&k.apply(this.setting.callback.beforeCheck,[this.setting.treeId,a],!0)==!1)&&k.uCanDo(this.setting)&&this.setting.check.enable&&\r\na.nocheck!==!0))a[f]=b,b=n(a,j.id.CHECK,this.setting),(c||this.setting.check.chkStyle===j.radio.STYLE)&&e.checkNodeRelation(this.setting,a),e.setChkClass(this.setting,b,a),e.repairParentChkClassWithSelf(this.setting,a),g&&this.setting.treeObj.trigger(j.event.CHECK,[null,this.setting.treeId,a])};a.checkAllNodes=function(a){e.repairAllChk(this.setting,!!a)};a.getCheckedNodes=function(a){var b=this.setting.data.key.children;return g.getTreeCheckedNodes(this.setting,g.getRoot(this.setting)[b],a!==!1)};\r\na.getChangeCheckedNodes=function(){var a=this.setting.data.key.children;return g.getTreeChangeCheckedNodes(this.setting,g.getRoot(this.setting)[a])};a.setChkDisabled=function(a,b,c,g){b=!!b;c=!!c;e.repairSonChkDisabled(this.setting,a,b,!!g);e.repairParentChkDisabled(this.setting,a.getParentNode(),b,c)};var b=a.updateNode;a.updateNode=function(c,g){b&&b.apply(a,arguments);if(c&&this.setting.check.enable&&n(c,this.setting).get(0)&&k.uCanDo(this.setting)){var i=n(c,j.id.CHECK,this.setting);(g==!0||this.setting.check.chkStyle===\r\nj.radio.STYLE)&&e.checkNodeRelation(this.setting,c);e.setChkClass(this.setting,i,c);e.repairParentChkClassWithSelf(this.setting,c)}}});var s=e.createNodes;e.createNodes=function(c,a,b,d,g){s&&s.apply(e,arguments);b&&e.repairParentChkClassWithSelf(c,d)};var t=e.removeNode;e.removeNode=function(c,a){var b=a.getParentNode();t&&t.apply(e,arguments);a&&b&&(e.repairChkClass(c,b),e.repairParentChkClass(c,b))};var u=e.appendNodes;e.appendNodes=function(c,a,b,d,h,i,j){var f=\"\";u&&(f=u.apply(e,arguments));\r\nd&&g.makeChkFlag(c,d);return f}})(jQuery);\r\n\r\n/*\r\n * JQuery zTree exedit v3.5.19.1\r\n * http://zTree.me/\r\n *\r\n * Copyright (c) 2010 Hunter.z\r\n *\r\n * Licensed same as jquery - MIT License\r\n * http://www.opensource.org/licenses/mit-license.php\r\n *\r\n * email: hunter.z@263.net\r\n * Date: 2015-10-26\r\n */\r\n(function(v){var I={event:{DRAG:\"ztree_drag\",DROP:\"ztree_drop\",RENAME:\"ztree_rename\",DRAGMOVE:\"ztree_dragmove\"},id:{EDIT:\"_edit\",INPUT:\"_input\",REMOVE:\"_remove\"},move:{TYPE_INNER:\"inner\",TYPE_PREV:\"prev\",TYPE_NEXT:\"next\"},node:{CURSELECTED_EDIT:\"curSelectedNode_Edit\",TMPTARGET_TREE:\"tmpTargetzTree\",TMPTARGET_NODE:\"tmpTargetNode\"}},x={onHoverOverNode:function(b,a){var c=m.getSetting(b.data.treeId),d=m.getRoot(c);if(d.curHoverNode!=a)x.onHoverOutNode(b);d.curHoverNode=a;f.addHoverDom(c,a)},onHoverOutNode:function(b){var b=\r\nm.getSetting(b.data.treeId),a=m.getRoot(b);if(a.curHoverNode&&!m.isSelectedNode(b,a.curHoverNode))f.removeTreeDom(b,a.curHoverNode),a.curHoverNode=null},onMousedownNode:function(b,a){function c(b){if(B.dragFlag==0&&Math.abs(N-b.clientX)<e.edit.drag.minMoveSize&&Math.abs(O-b.clientY)<e.edit.drag.minMoveSize)return!0;var a,c,n,k,i;i=e.data.key.children;M.css(\"cursor\",\"pointer\");if(B.dragFlag==0){if(g.apply(e.callback.beforeDrag,[e.treeId,l],!0)==!1)return r(b),!0;for(a=0,c=l.length;a<c;a++){if(a==0)B.dragNodeShowBefore=\r\n[];n=l[a];n.isParent&&n.open?(f.expandCollapseNode(e,n,!n.open),B.dragNodeShowBefore[n.tId]=!0):B.dragNodeShowBefore[n.tId]=!1}B.dragFlag=1;t.showHoverDom=!1;g.showIfameMask(e,!0);n=!0;k=-1;if(l.length>1){var j=l[0].parentTId?l[0].getParentNode()[i]:m.getNodes(e);i=[];for(a=0,c=j.length;a<c;a++)if(B.dragNodeShowBefore[j[a].tId]!==void 0&&(n&&k>-1&&k+1!==a&&(n=!1),i.push(j[a]),k=a),l.length===i.length){l=i;break}}n&&(H=l[0].getPreNode(),R=l[l.length-1].getNextNode());D=o(\"<ul class='zTreeDragUL'></ul>\",\r\ne);for(a=0,c=l.length;a<c;a++)n=l[a],n.editNameFlag=!1,f.selectNode(e,n,a>0),f.removeTreeDom(e,n),a>e.edit.drag.maxShowNodeNum-1||(k=o(\"<li id='\"+n.tId+\"_tmp'></li>\",e),k.append(o(n,d.id.A,e).clone()),k.css(\"padding\",\"0\"),k.children(\"#\"+n.tId+d.id.A).removeClass(d.node.CURSELECTED),D.append(k),a==e.edit.drag.maxShowNodeNum-1&&(k=o(\"<li id='\"+n.tId+\"_moretmp'><a>  ...  </a></li>\",e),D.append(k)));D.attr(\"id\",l[0].tId+d.id.UL+\"_tmp\");D.addClass(e.treeObj.attr(\"class\"));D.appendTo(M);A=o(\"<span class='tmpzTreeMove_arrow'></span>\",\r\ne);A.attr(\"id\",\"zTreeMove_arrow_tmp\");A.appendTo(M);e.treeObj.trigger(d.event.DRAG,[b,e.treeId,l])}if(B.dragFlag==1){s&&A.attr(\"id\")==b.target.id&&u&&b.clientX+F.scrollLeft()+2>v(\"#\"+u+d.id.A,s).offset().left?(n=v(\"#\"+u+d.id.A,s),b.target=n.length>0?n.get(0):b.target):s&&(s.removeClass(d.node.TMPTARGET_TREE),u&&v(\"#\"+u+d.id.A,s).removeClass(d.node.TMPTARGET_NODE+\"_\"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+\"_\"+I.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+\"_\"+I.move.TYPE_INNER));\r\nu=s=null;J=!1;h=e;n=m.getSettings();for(var y in n)if(n[y].treeId&&n[y].edit.enable&&n[y].treeId!=e.treeId&&(b.target.id==n[y].treeId||v(b.target).parents(\"#\"+n[y].treeId).length>0))J=!0,h=n[y];y=F.scrollTop();k=F.scrollLeft();i=h.treeObj.offset();a=h.treeObj.get(0).scrollHeight;n=h.treeObj.get(0).scrollWidth;c=b.clientY+y-i.top;var p=h.treeObj.height()+i.top-b.clientY-y,q=b.clientX+k-i.left,x=h.treeObj.width()+i.left-b.clientX-k;i=c<e.edit.drag.borderMax&&c>e.edit.drag.borderMin;var j=p<e.edit.drag.borderMax&&\r\np>e.edit.drag.borderMin,K=q<e.edit.drag.borderMax&&q>e.edit.drag.borderMin,G=x<e.edit.drag.borderMax&&x>e.edit.drag.borderMin,p=c>e.edit.drag.borderMin&&p>e.edit.drag.borderMin&&q>e.edit.drag.borderMin&&x>e.edit.drag.borderMin,q=i&&h.treeObj.scrollTop()<=0,x=j&&h.treeObj.scrollTop()+h.treeObj.height()+10>=a,P=K&&h.treeObj.scrollLeft()<=0,Q=G&&h.treeObj.scrollLeft()+h.treeObj.width()+10>=n;if(b.target&&g.isChildOrSelf(b.target,h.treeId)){for(var E=b.target;E&&E.tagName&&!g.eqs(E.tagName,\"li\")&&E.id!=\r\nh.treeId;)E=E.parentNode;var S=!0;for(a=0,c=l.length;a<c;a++)if(n=l[a],E.id===n.tId){S=!1;break}else if(o(n,e).find(\"#\"+E.id).length>0){S=!1;break}if(S&&b.target&&g.isChildOrSelf(b.target,E.id+d.id.A))s=v(E),u=E.id}n=l[0];if(p&&g.isChildOrSelf(b.target,h.treeId)){if(!s&&(b.target.id==h.treeId||q||x||P||Q)&&(J||!J&&n.parentTId))s=h.treeObj;i?h.treeObj.scrollTop(h.treeObj.scrollTop()-10):j&&h.treeObj.scrollTop(h.treeObj.scrollTop()+10);K?h.treeObj.scrollLeft(h.treeObj.scrollLeft()-10):G&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+\r\n10);s&&s!=h.treeObj&&s.offset().left<h.treeObj.offset().left&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+s.offset().left-h.treeObj.offset().left)}D.css({top:b.clientY+y+3+\"px\",left:b.clientX+k+3+\"px\"});i=a=0;if(s&&s.attr(\"id\")!=h.treeId){var z=u==null?null:m.getNodeCache(h,u);c=(b.ctrlKey||b.metaKey)&&e.edit.drag.isMove&&e.edit.drag.isCopy||!e.edit.drag.isMove&&e.edit.drag.isCopy;a=!!(H&&u===H.tId);i=!!(R&&u===R.tId);k=n.parentTId&&n.parentTId==u;n=(c||!i)&&g.apply(h.edit.drag.prev,[h.treeId,l,z],\r\n!!h.edit.drag.prev);a=(c||!a)&&g.apply(h.edit.drag.next,[h.treeId,l,z],!!h.edit.drag.next);G=(c||!k)&&!(h.data.keep.leaf&&!z.isParent)&&g.apply(h.edit.drag.inner,[h.treeId,l,z],!!h.edit.drag.inner);if(!n&&!a&&!G){if(s=null,u=\"\",w=d.move.TYPE_INNER,A.css({display:\"none\"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null}else{c=v(\"#\"+u+d.id.A,s);i=z.isLastNode?null:v(\"#\"+z.getNextNode().tId+d.id.A,s.next());j=c.offset().top;k=c.offset().left;K=n?G?0.25:a?\r\n0.5:1:-1;G=a?G?0.75:n?0.5:0:-1;y=(b.clientY+y-j)/c.height();(K==1||y<=K&&y>=-0.2)&&n?(a=1-A.width(),i=j-A.height()/2,w=d.move.TYPE_PREV):(G==0||y>=G&&y<=1.2)&&a?(a=1-A.width(),i=i==null||z.isParent&&z.open?j+c.height()-A.height()/2:i.offset().top-A.height()/2,w=d.move.TYPE_NEXT):(a=5-A.width(),i=j,w=d.move.TYPE_INNER);A.css({display:\"block\",top:i+\"px\",left:k+a+\"px\"});c.addClass(d.node.TMPTARGET_NODE+\"_\"+w);if(T!=u||U!=w)L=(new Date).getTime();if(z&&z.isParent&&w==d.move.TYPE_INNER&&(y=!0,window.zTreeMoveTimer&&\r\nwindow.zTreeMoveTargetNodeTId!==z.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===z.tId&&(y=!1),y))window.zTreeMoveTimer=setTimeout(function(){w==d.move.TYPE_INNER&&z&&z.isParent&&!z.open&&(new Date).getTime()-L>h.edit.drag.autoOpenTime&&g.apply(h.callback.beforeDragOpen,[h.treeId,z],!0)&&(f.switchNode(h,z),h.edit.drag.autoExpandTrigger&&h.treeObj.trigger(d.event.EXPAND,[h.treeId,z]))},h.edit.drag.autoOpenTime+50),\r\nwindow.zTreeMoveTargetNodeTId=z.tId}}else if(w=d.move.TYPE_INNER,s&&g.apply(h.edit.drag.inner,[h.treeId,l,null],!!h.edit.drag.inner)?s.addClass(d.node.TMPTARGET_TREE):s=null,A.css({display:\"none\"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;T=u;U=w;e.treeObj.trigger(d.event.DRAGMOVE,[b,e.treeId,l])}return!1}function r(b){if(window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;U=T=null;F.unbind(\"mousemove\",c);\r\nF.unbind(\"mouseup\",r);F.unbind(\"selectstart\",k);M.css(\"cursor\",\"auto\");s&&(s.removeClass(d.node.TMPTARGET_TREE),u&&v(\"#\"+u+d.id.A,s).removeClass(d.node.TMPTARGET_NODE+\"_\"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+\"_\"+I.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+\"_\"+I.move.TYPE_INNER));g.showIfameMask(e,!1);t.showHoverDom=!0;if(B.dragFlag!=0){B.dragFlag=0;var a,i,j;for(a=0,i=l.length;a<i;a++)j=l[a],j.isParent&&B.dragNodeShowBefore[j.tId]&&!j.open&&(f.expandCollapseNode(e,j,!j.open),\r\ndelete B.dragNodeShowBefore[j.tId]);D&&D.remove();A&&A.remove();var p=(b.ctrlKey||b.metaKey)&&e.edit.drag.isMove&&e.edit.drag.isCopy||!e.edit.drag.isMove&&e.edit.drag.isCopy;!p&&s&&u&&l[0].parentTId&&u==l[0].parentTId&&w==d.move.TYPE_INNER&&(s=null);if(s){var q=u==null?null:m.getNodeCache(h,u);if(g.apply(e.callback.beforeDrop,[h.treeId,l,q,w,p],!0)==!1)f.selectNodes(x,l);else{var C=p?g.clone(l):l;a=function(){if(J){if(!p)for(var a=0,c=l.length;a<c;a++)f.removeNode(e,l[a]);w==d.move.TYPE_INNER?f.addNodes(h,\r\nq,-1,C):f.addNodes(h,q.getParentNode(),w==d.move.TYPE_PREV?q.getIndex():q.getIndex()+1,C)}else if(p&&w==d.move.TYPE_INNER)f.addNodes(h,q,-1,C);else if(p)f.addNodes(h,q.getParentNode(),w==d.move.TYPE_PREV?q.getIndex():q.getIndex()+1,C);else if(w!=d.move.TYPE_NEXT)for(a=0,c=C.length;a<c;a++)f.moveNode(h,q,C[a],w,!1);else for(a=-1,c=C.length-1;a<c;c--)f.moveNode(h,q,C[c],w,!1);f.selectNodes(h,C);o(C[0],e).focus().blur();e.treeObj.trigger(d.event.DROP,[b,h.treeId,C,q,w,p])};w==d.move.TYPE_INNER&&g.canAsync(h,\r\nq)?f.asyncNode(h,q,!1,a):a()}}else f.selectNodes(x,l),e.treeObj.trigger(d.event.DROP,[b,e.treeId,l,null,null,null])}}function k(){return!1}var i,j,e=m.getSetting(b.data.treeId),B=m.getRoot(e),t=m.getRoots();if(b.button==2||!e.edit.enable||!e.edit.drag.isCopy&&!e.edit.drag.isMove)return!0;var p=b.target,q=m.getRoot(e).curSelectedList,l=[];if(m.isSelectedNode(e,a))for(i=0,j=q.length;i<j;i++){if(q[i].editNameFlag&&g.eqs(p.tagName,\"input\")&&p.getAttribute(\"treeNode\"+d.id.INPUT)!==null)return!0;l.push(q[i]);\r\nif(l[0].parentTId!==q[i].parentTId){l=[a];break}}else l=[a];f.editNodeBlur=!0;f.cancelCurEditNode(e);var F=v(e.treeObj.get(0).ownerDocument),M=v(e.treeObj.get(0).ownerDocument.body),D,A,s,J=!1,h=e,x=e,H,R,T=null,U=null,u=null,w=d.move.TYPE_INNER,N=b.clientX,O=b.clientY,L=(new Date).getTime();g.uCanDo(e)&&F.bind(\"mousemove\",c);F.bind(\"mouseup\",r);F.bind(\"selectstart\",k);b.preventDefault&&b.preventDefault();return!0}};v.extend(!0,v.fn.zTree.consts,I);v.extend(!0,v.fn.zTree._z,{tools:{getAbs:function(b){b=\r\nb.getBoundingClientRect();return[b.left+(document.body.scrollLeft+document.documentElement.scrollLeft),b.top+(document.body.scrollTop+document.documentElement.scrollTop)]},inputFocus:function(b){b.get(0)&&(b.focus(),g.setCursorPosition(b.get(0),b.val().length))},inputSelect:function(b){b.get(0)&&(b.focus(),b.select())},setCursorPosition:function(b,a){if(b.setSelectionRange)b.focus(),b.setSelectionRange(a,a);else if(b.createTextRange){var c=b.createTextRange();c.collapse(!0);c.moveEnd(\"character\",\r\na);c.moveStart(\"character\",a);c.select()}},showIfameMask:function(b,a){for(var c=m.getRoot(b);c.dragMaskList.length>0;)c.dragMaskList[0].remove(),c.dragMaskList.shift();if(a)for(var d=o(\"iframe\",b),f=0,i=d.length;f<i;f++){var j=d.get(f),e=g.getAbs(j),j=o(\"<div id='zTreeMask_\"+f+\"' class='zTreeMask' style='top:\"+e[1]+\"px; left:\"+e[0]+\"px; width:\"+j.offsetWidth+\"px; height:\"+j.offsetHeight+\"px;'></div>\",b);j.appendTo(o(\"body\",b));c.dragMaskList.push(j)}}},view:{addEditBtn:function(b,a){if(!(a.editNameFlag||\r\no(a,d.id.EDIT,b).length>0)&&g.apply(b.edit.showRenameBtn,[b.treeId,a],b.edit.showRenameBtn)){var c=o(a,d.id.A,b),r=\"<span class='\"+d.className.BUTTON+\" edit' id='\"+a.tId+d.id.EDIT+\"' title='\"+g.apply(b.edit.renameTitle,[b.treeId,a],b.edit.renameTitle)+\"' treeNode\"+d.id.EDIT+\" style='display:none;'></span>\";c.append(r);o(a,d.id.EDIT,b).bind(\"click\",function(){if(!g.uCanDo(b)||g.apply(b.callback.beforeEditName,[b.treeId,a],!0)==!1)return!1;f.editNode(b,a);return!1}).show()}},addRemoveBtn:function(b,\r\na){if(!(a.editNameFlag||o(a,d.id.REMOVE,b).length>0)&&g.apply(b.edit.showRemoveBtn,[b.treeId,a],b.edit.showRemoveBtn)){var c=o(a,d.id.A,b),r=\"<span class='\"+d.className.BUTTON+\" remove' id='\"+a.tId+d.id.REMOVE+\"' title='\"+g.apply(b.edit.removeTitle,[b.treeId,a],b.edit.removeTitle)+\"' treeNode\"+d.id.REMOVE+\" style='display:none;'></span>\";c.append(r);o(a,d.id.REMOVE,b).bind(\"click\",function(){if(!g.uCanDo(b)||g.apply(b.callback.beforeRemove,[b.treeId,a],!0)==!1)return!1;f.removeNode(b,a);b.treeObj.trigger(d.event.REMOVE,\r\n[b.treeId,a]);return!1}).bind(\"mousedown\",function(){return!0}).show()}},addHoverDom:function(b,a){if(m.getRoots().showHoverDom)a.isHover=!0,b.edit.enable&&(f.addEditBtn(b,a),f.addRemoveBtn(b,a)),g.apply(b.view.addHoverDom,[b.treeId,a])},cancelCurEditNode:function(b,a,c){var r=m.getRoot(b),k=b.data.key.name,i=r.curEditNode;if(i){var j=r.curEditInput,a=a?a:c?i[k]:j.val();if(g.apply(b.callback.beforeRename,[b.treeId,i,a,c],!0)===!1)return!1;i[k]=a;o(i,d.id.A,b).removeClass(d.node.CURSELECTED_EDIT);\r\nj.unbind();f.setNodeName(b,i);i.editNameFlag=!1;r.curEditNode=null;r.curEditInput=null;f.selectNode(b,i,!1);b.treeObj.trigger(d.event.RENAME,[b.treeId,i,c])}return r.noSelection=!0},editNode:function(b,a){var c=m.getRoot(b);f.editNodeBlur=!1;if(m.isSelectedNode(b,a)&&c.curEditNode==a&&a.editNameFlag)setTimeout(function(){g.inputFocus(c.curEditInput)},0);else{var r=b.data.key.name;a.editNameFlag=!0;f.removeTreeDom(b,a);f.cancelCurEditNode(b);f.selectNode(b,a,!1);o(a,d.id.SPAN,b).html(\"<input type=text class='rename' id='\"+\r\na.tId+d.id.INPUT+\"' treeNode\"+d.id.INPUT+\" >\");var k=o(a,d.id.INPUT,b);k.attr(\"value\",a[r]);b.edit.editNameSelectAll?g.inputSelect(k):g.inputFocus(k);k.bind(\"blur\",function(){f.editNodeBlur||f.cancelCurEditNode(b)}).bind(\"keydown\",function(a){a.keyCode==\"13\"?(f.editNodeBlur=!0,f.cancelCurEditNode(b)):a.keyCode==\"27\"&&f.cancelCurEditNode(b,null,!0)}).bind(\"click\",function(){return!1}).bind(\"dblclick\",function(){return!1});o(a,d.id.A,b).addClass(d.node.CURSELECTED_EDIT);c.curEditInput=k;c.noSelection=\r\n!1;c.curEditNode=a}},moveNode:function(b,a,c,r,k,i){var j=m.getRoot(b),e=b.data.key.children;if(a!=c&&(!b.data.keep.leaf||!a||a.isParent||r!=d.move.TYPE_INNER)){var g=c.parentTId?c.getParentNode():j,t=a===null||a==j;t&&a===null&&(a=j);if(t)r=d.move.TYPE_INNER;j=a.parentTId?a.getParentNode():j;if(r!=d.move.TYPE_PREV&&r!=d.move.TYPE_NEXT)r=d.move.TYPE_INNER;if(r==d.move.TYPE_INNER)if(t)c.parentTId=null;else{if(!a.isParent)a.isParent=!0,a.open=!!a.open,f.setNodeLineIcos(b,a);c.parentTId=a.tId}var p;\r\nt?p=t=b.treeObj:(!i&&r==d.move.TYPE_INNER?f.expandCollapseNode(b,a,!0,!1):i||f.expandCollapseNode(b,a.getParentNode(),!0,!1),t=o(a,b),p=o(a,d.id.UL,b),t.get(0)&&!p.get(0)&&(p=[],f.makeUlHtml(b,a,p,\"\"),t.append(p.join(\"\"))),p=o(a,d.id.UL,b));var q=o(c,b);q.get(0)?t.get(0)||q.remove():q=f.appendNodes(b,c.level,[c],null,-1,!1,!0).join(\"\");p.get(0)&&r==d.move.TYPE_INNER?p.append(q):t.get(0)&&r==d.move.TYPE_PREV?t.before(q):t.get(0)&&r==d.move.TYPE_NEXT&&t.after(q);var l=-1,v=0,x=null,t=null,D=c.level;\r\nif(c.isFirstNode){if(l=0,g[e].length>1)x=g[e][1],x.isFirstNode=!0}else if(c.isLastNode)l=g[e].length-1,x=g[e][l-1],x.isLastNode=!0;else for(p=0,q=g[e].length;p<q;p++)if(g[e][p].tId==c.tId){l=p;break}l>=0&&g[e].splice(l,1);if(r!=d.move.TYPE_INNER)for(p=0,q=j[e].length;p<q;p++)j[e][p].tId==a.tId&&(v=p);if(r==d.move.TYPE_INNER){a[e]||(a[e]=[]);if(a[e].length>0)t=a[e][a[e].length-1],t.isLastNode=!1;a[e].splice(a[e].length,0,c);c.isLastNode=!0;c.isFirstNode=a[e].length==1}else a.isFirstNode&&r==d.move.TYPE_PREV?\r\n(j[e].splice(v,0,c),t=a,t.isFirstNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!0,c.isLastNode=!1):a.isLastNode&&r==d.move.TYPE_NEXT?(j[e].splice(v+1,0,c),t=a,t.isLastNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(r==d.move.TYPE_PREV?j[e].splice(v,0,c):j[e].splice(v+1,0,c),c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!1);m.fixPIdKeyValue(b,c);m.setSonNodeLevel(b,c.getParentNode(),c);f.setNodeLineIcos(b,c);f.repairNodeLevelClass(b,c,D);!b.data.keep.parent&&g[e].length<\r\n1?(g.isParent=!1,g.open=!1,a=o(g,d.id.UL,b),r=o(g,d.id.SWITCH,b),e=o(g,d.id.ICON,b),f.replaceSwitchClass(g,r,d.folder.DOCU),f.replaceIcoClass(g,e,d.folder.DOCU),a.css(\"display\",\"none\")):x&&f.setNodeLineIcos(b,x);t&&f.setNodeLineIcos(b,t);b.check&&b.check.enable&&f.repairChkClass&&(f.repairChkClass(b,g),f.repairParentChkClassWithSelf(b,g),g!=c.parent&&f.repairParentChkClassWithSelf(b,c));i||f.expandCollapseParentNode(b,c.getParentNode(),!0,k)}},removeEditBtn:function(b,a){o(a,d.id.EDIT,b).unbind().remove()},\r\nremoveRemoveBtn:function(b,a){o(a,d.id.REMOVE,b).unbind().remove()},removeTreeDom:function(b,a){a.isHover=!1;f.removeEditBtn(b,a);f.removeRemoveBtn(b,a);g.apply(b.view.removeHoverDom,[b.treeId,a])},repairNodeLevelClass:function(b,a,c){if(c!==a.level){var f=o(a,b),g=o(a,d.id.A,b),b=o(a,d.id.UL,b),c=d.className.LEVEL+c,a=d.className.LEVEL+a.level;f.removeClass(c);f.addClass(a);g.removeClass(c);g.addClass(a);b.removeClass(c);b.addClass(a)}},selectNodes:function(b,a){for(var c=0,d=a.length;c<d;c++)f.selectNode(b,\r\na[c],c>0)}},event:{},data:{setSonNodeLevel:function(b,a,c){if(c){var d=b.data.key.children;c.level=a?a.level+1:0;if(c[d])for(var a=0,f=c[d].length;a<f;a++)c[d][a]&&m.setSonNodeLevel(b,c,c[d][a])}}}});var H=v.fn.zTree,g=H._z.tools,d=H.consts,f=H._z.view,m=H._z.data,o=g.$;m.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:\"remove\",renameTitle:\"rename\",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,\r\nmaxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});m.addInitBind(function(b){var a=b.treeObj,c=d.event;a.bind(c.RENAME,function(a,c,d,f){g.apply(b.callback.onRename,[a,c,d,f])});a.bind(c.DRAG,function(a,c,d,f){g.apply(b.callback.onDrag,[c,d,f])});a.bind(c.DRAGMOVE,function(a,c,d,f){g.apply(b.callback.onDragMove,[c,\r\nd,f])});a.bind(c.DROP,function(a,c,d,f,e,m,o){g.apply(b.callback.onDrop,[c,d,f,e,m,o])})});m.addInitUnBind(function(b){var b=b.treeObj,a=d.event;b.unbind(a.RENAME);b.unbind(a.DRAG);b.unbind(a.DRAGMOVE);b.unbind(a.DROP)});m.addInitCache(function(){});m.addInitNode(function(b,a,c){if(c)c.isHover=!1,c.editNameFlag=!1});m.addInitProxy(function(b){var a=b.target,c=m.getSetting(b.data.treeId),f=b.relatedTarget,k=\"\",i=null,j=\"\",e=null,o=null;if(g.eqs(b.type,\"mouseover\")){if(o=g.getMDom(c,a,[{tagName:\"a\",\r\nattrName:\"treeNode\"+d.id.A}]))k=g.getNodeMainDom(o).id,j=\"hoverOverNode\"}else if(g.eqs(b.type,\"mouseout\"))o=g.getMDom(c,f,[{tagName:\"a\",attrName:\"treeNode\"+d.id.A}]),o||(k=\"remove\",j=\"hoverOutNode\");else if(g.eqs(b.type,\"mousedown\")&&(o=g.getMDom(c,a,[{tagName:\"a\",attrName:\"treeNode\"+d.id.A}])))k=g.getNodeMainDom(o).id,j=\"mousedownNode\";if(k.length>0)switch(i=m.getNodeCache(c,k),j){case \"mousedownNode\":e=x.onMousedownNode;break;case \"hoverOverNode\":e=x.onHoverOverNode;break;case \"hoverOutNode\":e=\r\nx.onHoverOutNode}return{stop:!1,node:i,nodeEventType:j,nodeEventCallback:e,treeEventType:\"\",treeEventCallback:null}});m.addInitRoot(function(b){var b=m.getRoot(b),a=m.getRoots();b.curEditNode=null;b.curEditInput=null;b.curHoverNode=null;b.dragFlag=0;b.dragNodeShowBefore=[];b.dragMaskList=[];a.showHoverDom=!0});m.addZTreeTools(function(b,a){a.cancelEditName=function(a){m.getRoot(this.setting).curEditNode&&f.cancelCurEditNode(this.setting,a?a:null,!0)};a.copyNode=function(a,b,k,i){if(!b)return null;\r\nif(a&&!a.isParent&&this.setting.data.keep.leaf&&k===d.move.TYPE_INNER)return null;var j=this,e=g.clone(b);if(!a)a=null,k=d.move.TYPE_INNER;k==d.move.TYPE_INNER?(b=function(){f.addNodes(j.setting,a,-1,[e],i)},g.canAsync(this.setting,a)?f.asyncNode(this.setting,a,i,b):b()):(f.addNodes(this.setting,a.parentNode,-1,[e],i),f.moveNode(this.setting,a,e,k,!1,i));return e};a.editName=function(a){a&&a.tId&&a===m.getNodeCache(this.setting,a.tId)&&(a.parentTId&&f.expandCollapseParentNode(this.setting,a.getParentNode(),\r\n!0),f.editNode(this.setting,a))};a.moveNode=function(a,b,k,i){function j(){f.moveNode(e.setting,a,b,k,!1,i)}if(!b)return b;if(a&&!a.isParent&&this.setting.data.keep.leaf&&k===d.move.TYPE_INNER)return null;else if(a&&(b.parentTId==a.tId&&k==d.move.TYPE_INNER||o(b,this.setting).find(\"#\"+a.tId).length>0))return null;else a||(a=null);var e=this;g.canAsync(this.setting,a)&&k===d.move.TYPE_INNER?f.asyncNode(this.setting,a,i,j):j();return b};a.setEditable=function(a){this.setting.edit.enable=a;return this.refresh()}});\r\nvar N=f.cancelPreSelectedNode;f.cancelPreSelectedNode=function(b,a){for(var c=m.getRoot(b).curSelectedList,d=0,g=c.length;d<g;d++)if(!a||a===c[d])if(f.removeTreeDom(b,c[d]),a)break;N&&N.apply(f,arguments)};var O=f.createNodes;f.createNodes=function(b,a,c,d,g){O&&O.apply(f,arguments);c&&f.repairParentChkClassWithSelf&&f.repairParentChkClassWithSelf(b,d)};var V=f.makeNodeUrl;f.makeNodeUrl=function(b,a){return b.edit.enable?null:V.apply(f,arguments)};var L=f.removeNode;f.removeNode=function(b,a){var c=\r\nm.getRoot(b);if(c.curEditNode===a)c.curEditNode=null;L&&L.apply(f,arguments)};var P=f.selectNode;f.selectNode=function(b,a,c){var d=m.getRoot(b);if(m.isSelectedNode(b,a)&&d.curEditNode==a&&a.editNameFlag)return!1;P&&P.apply(f,arguments);f.addHoverDom(b,a);return!0};var Q=g.uCanDo;g.uCanDo=function(b,a){var c=m.getRoot(b);if(a&&(g.eqs(a.type,\"mouseover\")||g.eqs(a.type,\"mouseout\")||g.eqs(a.type,\"mousedown\")||g.eqs(a.type,\"mouseup\")))return!0;if(c.curEditNode)f.editNodeBlur=!1,c.curEditInput.focus();\r\nreturn!c.curEditNode&&(Q?Q.apply(f,arguments):!0)}})(jQuery);\r\n\r\n","/*\r\n * JQuery zTree exHideNodes v3.5.19.1\r\n * http://zTree.me/\r\n *\r\n * Copyright (c) 2010 Hunter.z\r\n *\r\n * Licensed same as jquery - MIT License\r\n * http://www.opensource.org/licenses/mit-license.php\r\n *\r\n * email: hunter.z@263.net\r\n * Date: 2015-10-26\r\n */\r\n(function($){\r\n\t//default init node of exLib\r\n\tvar _initNode = function(setting, level, n, parentNode, isFirstNode, isLastNode, openFlag) {\r\n\t\tif (typeof n.isHidden == \"string\") n.isHidden = tools.eqs(n.isHidden, \"true\");\r\n\t\tn.isHidden = !!n.isHidden;\r\n\t\tdata.initHideForExCheck(setting, n);\r\n\t},\r\n\t//add dom for check\r\n\t_beforeA = function(setting, node, html) {},\r\n\t//update zTreeObj, add method of exLib\r\n\t_zTreeTools = function(setting, zTreeTools) {\r\n\t\tzTreeTools.showNodes = function(nodes, options) {\r\n\t\t\tview.showNodes(setting, nodes, options);\r\n\t\t}\r\n\t\tzTreeTools.showNode = function(node, options) {\r\n\t\t\tif (!node) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tview.showNodes(setting, [node], options);\r\n\t\t}\r\n\t\tzTreeTools.hideNodes = function(nodes, options) {\r\n\t\t\tview.hideNodes(setting, nodes, options);\r\n\t\t}\r\n\t\tzTreeTools.hideNode = function(node, options) {\r\n\t\t\tif (!node) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tview.hideNodes(setting, [node], options);\r\n\t\t}\r\n\r\n\t\tvar _checkNode = zTreeTools.checkNode;\r\n\t\tif (_checkNode) {\r\n\t\t\tzTreeTools.checkNode = function(node, checked, checkTypeFlag, callbackFlag) {\r\n\t\t\t\tif (!!node && !!node.isHidden) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t_checkNode.apply(zTreeTools, arguments);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t//method of operate data\r\n\t_data = {\r\n\t\tinitHideForExCheck: function(setting, n) {\r\n\t\t\tif (n.isHidden && setting.check && setting.check.enable) {\r\n\t\t\t\tif(typeof n._nocheck == \"undefined\") {\r\n\t\t\t\t\tn._nocheck = !!n.nocheck\r\n\t\t\t\t\tn.nocheck = true;\r\n\t\t\t\t}\r\n\t\t\t\tn.check_Child_State = -1;\r\n\t\t\t\tif (view.repairParentChkClassWithSelf) {\r\n\t\t\t\t\tview.repairParentChkClassWithSelf(setting, n);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tinitShowForExCheck: function(setting, n) {\r\n\t\t\tif (!n.isHidden && setting.check && setting.check.enable) {\r\n\t\t\t\tif(typeof n._nocheck != \"undefined\") {\r\n\t\t\t\t\tn.nocheck = n._nocheck;\r\n\t\t\t\t\tdelete n._nocheck;\r\n\t\t\t\t}\r\n\t\t\t\tif (view.setChkClass) {\r\n\t\t\t\t\tvar checkObj = $$(n, consts.id.CHECK, setting);\r\n\t\t\t\t\tview.setChkClass(setting, checkObj, n);\r\n\t\t\t\t}\r\n\t\t\t\tif (view.repairParentChkClassWithSelf) {\r\n\t\t\t\t\tview.repairParentChkClassWithSelf(setting, n);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t//method of operate ztree dom\r\n\t_view = {\r\n\t\tclearOldFirstNode: function(setting, node) {\r\n\t\t\tvar n = node.getNextNode();\r\n\t\t\twhile(!!n){\r\n\t\t\t\tif (n.isFirstNode) {\r\n\t\t\t\t\tn.isFirstNode = false;\r\n\t\t\t\t\tview.setNodeLineIcos(setting, n);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (n.isLastNode) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tn = n.getNextNode();\r\n\t\t\t}\r\n\t\t},\r\n        clearOldLastNode: function(setting, node, openFlag) {\r\n            var n = node.getPreNode();\r\n            while(!!n){\r\n                if (n.isLastNode) {\r\n                    n.isLastNode = false;\r\n                    if (openFlag) {\r\n                        view.setNodeLineIcos(setting, n);\r\n                    }\r\n                    break;\r\n                }\r\n                if (n.isFirstNode) {\r\n                    break;\r\n                }\r\n                n = n.getPreNode();\r\n            }\r\n        },\r\n\t\tmakeDOMNodeMainBefore: function(html, setting, node) {\r\n\t\t\thtml.push(\"<li \", (node.isHidden ? \"style='display:none;' \" : \"\"), \"id='\", node.tId, \"' class='\", consts.className.LEVEL, node.level,\"' tabindex='0' hidefocus='true' treenode>\");\r\n\t\t},\r\n\t\tshowNode: function(setting, node, options) {\r\n\t\t\tnode.isHidden = false;\r\n\t\t\tdata.initShowForExCheck(setting, node);\r\n\t\t\t$$(node, setting).show();\r\n\t\t},\r\n\t\tshowNodes: function(setting, nodes, options) {\r\n\t\t\tif (!nodes || nodes.length == 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar pList = {}, i, j;\r\n\t\t\tfor (i=0, j=nodes.length; i<j; i++) {\r\n\t\t\t\tvar n = nodes[i];\r\n\t\t\t\tif (!pList[n.parentTId]) {\r\n\t\t\t\t\tvar pn = n.getParentNode();\r\n\t\t\t\t\tpList[n.parentTId] = (pn === null) ? data.getRoot(setting) : n.getParentNode();\r\n\t\t\t\t}\r\n\t\t\t\tview.showNode(setting, n, options);\r\n\t\t\t}\r\n\t\t\tfor (var tId in pList) {\r\n\t\t\t\tvar children = pList[tId][setting.data.key.children];\r\n\t\t\t\tview.setFirstNodeForShow(setting, children);\r\n\t\t\t\tview.setLastNodeForShow(setting, children);\r\n\t\t\t}\r\n\t\t},\r\n\t\thideNode: function(setting, node, options) {\r\n\t\t\tnode.isHidden = true;\r\n\t\t\tnode.isFirstNode = false;\r\n\t\t\tnode.isLastNode = false;\r\n\t\t\tdata.initHideForExCheck(setting, node);\r\n\t\t\tview.cancelPreSelectedNode(setting, node);\r\n\t\t\t$$(node, setting).hide();\r\n\t\t},\r\n\t\thideNodes: function(setting, nodes, options) {\r\n\t\t\tif (!nodes || nodes.length == 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar pList = {}, i, j;\r\n\t\t\tfor (i=0, j=nodes.length; i<j; i++) {\r\n\t\t\t\tvar n = nodes[i];\r\n\t\t\t\tif ((n.isFirstNode || n.isLastNode) && !pList[n.parentTId]) {\r\n\t\t\t\t\tvar pn = n.getParentNode();\r\n\t\t\t\t\tpList[n.parentTId] = (pn === null) ? data.getRoot(setting) : n.getParentNode();\r\n\t\t\t\t}\r\n\t\t\t\tview.hideNode(setting, n, options);\r\n\t\t\t}\r\n\t\t\tfor (var tId in pList) {\r\n\t\t\t\tvar children = pList[tId][setting.data.key.children];\r\n\t\t\t\tview.setFirstNodeForHide(setting, children);\r\n\t\t\t\tview.setLastNodeForHide(setting, children);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetFirstNode: function(setting, parentNode) {\r\n\t\t\tvar childKey = setting.data.key.children, childLength = parentNode[childKey].length;\r\n\t\t\tif (childLength > 0 && !parentNode[childKey][0].isHidden) {\r\n\t\t\t\tparentNode[childKey][0].isFirstNode = true;\r\n\t\t\t} else if (childLength > 0) {\r\n\t\t\t\tview.setFirstNodeForHide(setting, parentNode[childKey]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetLastNode: function(setting, parentNode) {\r\n\t\t\tvar childKey = setting.data.key.children, childLength = parentNode[childKey].length;\r\n\t\t\tif (childLength > 0 && !parentNode[childKey][0].isHidden) {\r\n\t\t\t\tparentNode[childKey][childLength - 1].isLastNode = true;\r\n\t\t\t} else if (childLength > 0) {\r\n\t\t\t\tview.setLastNodeForHide(setting, parentNode[childKey]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetFirstNodeForHide: function(setting, nodes) {\r\n\t\t\tvar n,i,j;\r\n\t\t\tfor (i=0, j=nodes.length; i<j; i++) {\r\n\t\t\t\tn = nodes[i];\r\n\t\t\t\tif (n.isFirstNode) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!n.isHidden && !n.isFirstNode) {\r\n\t\t\t\t\tn.isFirstNode = true;\r\n\t\t\t\t\tview.setNodeLineIcos(setting, n);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tn = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn n;\r\n\t\t},\r\n\t\tsetFirstNodeForShow: function(setting, nodes) {\r\n\t\t\tvar n,i,j, first, old;\r\n\t\t\tfor(i=0, j=nodes.length; i<j; i++) {\r\n\t\t\t\tn = nodes[i];\r\n\t\t\t\tif (!first && !n.isHidden && n.isFirstNode) {\r\n\t\t\t\t\tfirst = n;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else if (!first && !n.isHidden && !n.isFirstNode) {\r\n\t\t\t\t\tn.isFirstNode = true;\r\n\t\t\t\t\tfirst = n;\r\n\t\t\t\t\tview.setNodeLineIcos(setting, n);\r\n\t\t\t\t} else if (first && n.isFirstNode) {\r\n\t\t\t\t\tn.isFirstNode = false;\r\n\t\t\t\t\told = n;\r\n\t\t\t\t\tview.setNodeLineIcos(setting, n);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tn = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\"new\":first, \"old\":old};\r\n\t\t},\r\n\t\tsetLastNodeForHide: function(setting, nodes) {\r\n\t\t\tvar n,i;\r\n\t\t\tfor (i=nodes.length-1; i>=0; i--) {\r\n\t\t\t\tn = nodes[i];\r\n\t\t\t\tif (n.isLastNode) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!n.isHidden && !n.isLastNode) {\r\n\t\t\t\t\tn.isLastNode = true;\r\n\t\t\t\t\tview.setNodeLineIcos(setting, n);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tn = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn n;\r\n\t\t},\r\n\t\tsetLastNodeForShow: function(setting, nodes) {\r\n\t\t\tvar n,i,j, last, old;\r\n\t\t\tfor (i=nodes.length-1; i>=0; i--) {\r\n\t\t\t\tn = nodes[i];\r\n\t\t\t\tif (!last && !n.isHidden && n.isLastNode) {\r\n\t\t\t\t\tlast = n;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else if (!last && !n.isHidden && !n.isLastNode) {\r\n\t\t\t\t\tn.isLastNode = true;\r\n\t\t\t\t\tlast = n;\r\n\t\t\t\t\tview.setNodeLineIcos(setting, n);\r\n\t\t\t\t} else if (last && n.isLastNode) {\r\n\t\t\t\t\tn.isLastNode = false;\r\n\t\t\t\t\told = n;\r\n\t\t\t\t\tview.setNodeLineIcos(setting, n);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tn = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\"new\":last, \"old\":old};\r\n\t\t}\r\n\t},\r\n\r\n\t_z = {\r\n\t\tview: _view,\r\n\t\tdata: _data\r\n\t};\r\n\t$.extend(true, $.fn.zTree._z, _z);\r\n\r\n\tvar zt = $.fn.zTree,\r\n\ttools = zt._z.tools,\r\n\tconsts = zt.consts,\r\n\tview = zt._z.view,\r\n\tdata = zt._z.data,\r\n\tevent = zt._z.event,\r\n\t$$ = tools.$;\r\n\r\n\tdata.addInitNode(_initNode);\r\n\tdata.addBeforeA(_beforeA);\r\n\tdata.addZTreeTools(_zTreeTools);\r\n\r\n//\tOverride method in core\r\n\tvar _dInitNode = data.initNode;\r\n    data.initNode = function(setting, level, node, parentNode, isFirstNode, isLastNode, openFlag) {\r\n        var tmpPNode = (parentNode) ? parentNode: data.getRoot(setting),\r\n            children = tmpPNode[setting.data.key.children];\r\n        data.tmpHideFirstNode = view.setFirstNodeForHide(setting, children);\r\n        data.tmpHideLastNode = view.setLastNodeForHide(setting, children);\r\n        if (openFlag) {\r\n            view.setNodeLineIcos(setting, data.tmpHideFirstNode);\r\n            view.setNodeLineIcos(setting, data.tmpHideLastNode);\r\n        }\r\n        isFirstNode = (data.tmpHideFirstNode === node);\r\n        isLastNode = (data.tmpHideLastNode === node);\r\n        if (_dInitNode) _dInitNode.apply(data, arguments);\r\n        if (openFlag && isLastNode) {\r\n            view.clearOldLastNode(setting, node, openFlag);\r\n        }\r\n    };\r\n\r\n\tvar _makeChkFlag = data.makeChkFlag;\r\n\tif (!!_makeChkFlag) {\r\n\t\tdata.makeChkFlag = function(setting, node) {\r\n\t\t\tif (!!node && !!node.isHidden) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_makeChkFlag.apply(data, arguments);\r\n\t\t}\r\n\t}\r\n\r\n\tvar _getTreeCheckedNodes = data.getTreeCheckedNodes;\r\n\tif (!!_getTreeCheckedNodes) {\r\n\t\tdata.getTreeCheckedNodes = function(setting, nodes, checked, results) {\r\n\t\t\tif (!!nodes && nodes.length > 0) {\r\n\t\t\t\tvar p = nodes[0].getParentNode();\r\n\t\t\t\tif (!!p && !!p.isHidden) {\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn _getTreeCheckedNodes.apply(data, arguments);\r\n\t\t}\r\n\t}\r\n\r\n\tvar _getTreeChangeCheckedNodes = data.getTreeChangeCheckedNodes;\r\n\tif (!!_getTreeChangeCheckedNodes) {\r\n\t\tdata.getTreeChangeCheckedNodes = function(setting, nodes, results) {\r\n\t\t\tif (!!nodes && nodes.length > 0) {\r\n\t\t\t\tvar p = nodes[0].getParentNode();\r\n\t\t\t\tif (!!p && !!p.isHidden) {\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn _getTreeChangeCheckedNodes.apply(data, arguments);\r\n\t\t}\r\n\t}\r\n\r\n\tvar _expandCollapseSonNode = view.expandCollapseSonNode;\r\n\tif (!!_expandCollapseSonNode) {\r\n\t\tview.expandCollapseSonNode = function(setting, node, expandFlag, animateFlag, callback) {\r\n\t\t\tif (!!node && !!node.isHidden) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_expandCollapseSonNode.apply(view, arguments);\r\n\t\t}\r\n\t}\r\n\r\n\tvar _setSonNodeCheckBox = view.setSonNodeCheckBox;\r\n\tif (!!_setSonNodeCheckBox) {\r\n\t\tview.setSonNodeCheckBox = function(setting, node, value, srcNode) {\r\n\t\t\tif (!!node && !!node.isHidden) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_setSonNodeCheckBox.apply(view, arguments);\r\n\t\t}\r\n\t}\r\n\r\n\tvar _repairParentChkClassWithSelf = view.repairParentChkClassWithSelf;\r\n\tif (!!_repairParentChkClassWithSelf) {\r\n\t\tview.repairParentChkClassWithSelf = function(setting, node) {\r\n\t\t\tif (!!node && !!node.isHidden) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_repairParentChkClassWithSelf.apply(view, arguments);\r\n\t\t}\r\n\t}\r\n})(jQuery);","var Tree = function (containerId, options) {\r\n    var self = this;\r\n\r\n    self.options = $.extend({\r\n        expandRoots: false, //��������� 1\r\n        selectableRoots: false, // ��������� 2\r\n        multipleSelect: false, // ��������� 4,\r\n        nodes: []\r\n    }, options);\r\n\r\n    function getSettings() {\r\n        return {\r\n            check: {\r\n                enable: (self.options.multipleSelect),\r\n                chkboxType: (self.options.selectableRoots ? { \"Y\": \"\", \"N\": \"\" } : { \"Y\": \"s\", \"N\": \"ps\" })\r\n            },\r\n            view: {\r\n                dblClickExpand: false,\r\n                showLine: false\r\n            },\r\n            data: {\r\n                simpleData: {\r\n                    enable: true\r\n                }\r\n            }\r\n        };\r\n    }\r\n\r\n    function fillNodes(zTreeNodes) {\r\n        var i, item, count, result;\r\n\r\n        count = zTreeNodes.length;\r\n        result = {};\r\n\r\n        for (i = 0; i < count; i++) {\r\n            item = zTreeNodes[i];\r\n            result[item.id] = item;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    self.container = $(\"#\" + containerId);\r\n    self.zTree = $.fn.zTree.init(self.container, getSettings(), self.options.nodes);\r\n    self.zTreeNodes = self.zTree.transformToArray(self.zTree.getNodes());\r\n    self.nodes = fillNodes(self.zTreeNodes);\r\n\r\n    self.zTree.expandAll(self.options.expandRoots);\r\n};\r\n\r\n//#region DELEGATES\r\nTree.isLeafPredicate = function (item) { return !item.isParent };\r\n//#endregion\r\n\r\n//#region UTILS\r\nTree.ExceptArray = function (source, target) {\r\n    var newArr = [], arr, j, count, i;\r\n    arr = source.concat(target);\r\n\r\n    for (i in arr) {\r\n        var f = arr[i];\r\n        var t = 0;\r\n        count = arr.length;\r\n        for (j = 0; j < count; j++) {\r\n            if (arr[j] === f) {\r\n                t++;\r\n            }\r\n        }\r\n        if (t === 1) {\r\n            newArr.push(f);\r\n        }\r\n    }\r\n    return newArr;\r\n};\r\n//#endregion UTILS\r\n\r\n//#region METHODS\r\nTree.prototype.getNodeById = function (nodeId) {\r\n    return this.nodes[Number(nodeId)];\r\n};\r\n\r\nTree.prototype.getNodesByValue = function (value) {\r\n    return this.zTree.getNodesByParam(\"id\", value);\r\n}\r\n\r\nTree.prototype.getDisabledNodes = function () {\r\n    return this.zTree.getNodesByParam(\"chkDisabled\", true);\r\n}\r\n\r\nTree.prototype.getCheckedNodes = function () {\r\n    var checkedNodes = [], item, node;\r\n\r\n    for (node in this.nodes) {\r\n        if (this.nodes.hasOwnProperty(node)) {\r\n            item = this.nodes[node];\r\n            if (item.checked) {\r\n                checkedNodes.push(item)\r\n            }\r\n        }\r\n    }\r\n\r\n    if (!this.options.selectableRoots) {\r\n        checkedNodes = checkedNodes.filter(Tree.isLeafPredicate);\r\n    }\r\n    return checkedNodes;\r\n};\r\n\r\nTree.prototype.checkNode = function (nodeId, isChecked) {\r\n    var node = this.getNodeById(nodeId);\r\n    this.zTree.checkNode(node, isChecked, true, true);\r\n    node.checked = isChecked;\r\n};\r\n\r\nTree.prototype.openPathByNode = function (node) {\r\n    var parents = node.getPath();\r\n    for (var i = 0; i < parents.length - 1; i++) {\r\n        this.zTree.expandNode(parents[i], true, false, false);\r\n    }\r\n}\r\n\r\n\r\n\r\nTree.prototype.selectNode = function (node) {\r\n    return this.zTree.selectNode(node);\r\n}\r\n\r\nTree.prototype.on = function (eventName, callback) {\r\n    this.zTree.setting.callback[eventName] = callback;\r\n};\r\n\r\nTree.prototype.search = function (searchText) {\r\n    var visibleNodes = this.zTree.getNodesByParamFuzzy(\"name\", searchText, null),\r\n        i, count, item, parent;\r\n\r\n    count = visibleNodes.length;\r\n    for (i = 0; i < count; i++) {\r\n        item = visibleNodes[i];\r\n        parent = item.getParentNode();\r\n\r\n        while (parent) {\r\n            visibleNodes.push(parent);\r\n            parent = parent.getParentNode();\r\n        }\r\n    }\r\n\r\n    this.zTree.showNodes(this.zTreeNodes);\r\n    this.zTree.hideNodes(Tree.ExceptArray(this.zTreeNodes, visibleNodes));\r\n};\r\n\r\nTree.prototype.getSelectedNodes = function () {\r\n    var selected = this.zTree.getSelectedNodes()[0];\r\n    if (!this.options.selectableRoots && selected.isParent) {\r\n        return null;\r\n    }\r\n    return selected;\r\n};\r\n\r\nTree.prototype.reloadNodes = function (nodes) {\r\n    //this.zTree.destroy();\r\n    //this.options.nodes = nodes;\r\n    //new Tree(this.container.attr(\"id\"), this.options);\r\n\r\n}\r\n\r\n//#endregion METHODS","var DataRows = (function () {\r\n    var slickOptions;\r\n\r\n    slickOptions = {\r\n        enableCellNavigation: true,\r\n        enableColumnReorder: false,\r\n        fullWidthRows: true,\r\n        forceFitColumns: true,\r\n        editable: false,\r\n        autoHeight: false,\r\n        wideString: false,\r\n        initiallyCollapsed: false\r\n    };\r\n\r\n\r\n    function updateGrid(rows) {\r\n    \t\t(rows && this.dataView.setItems(rows));\r\n    \t\tthis.grid.measureHeights();\r\n    \t\tthis.grid.updateRowCount();\r\n    \t\tthis.grid.invalidateAllRows();\r\n    \t\tthis.grid.render();\r\n    }\r\n\r\n    function resetAllMarkedRows(){\r\n        var iter,\r\n            markedRows = document.querySelectorAll(\".grid-canvas .row-selected\");\r\n\r\n        iter = markedRows.length;\r\n        while(iter--){\r\n            markedRows[iter].classList.remove(\"row-selected\");\r\n        }\r\n    }\r\n\r\n    var DataRows = function (options) {\r\n        var self = this;\r\n        self.options = $.extend({\r\n            slickContainer: \"\",\r\n            searchInput: \"\",\r\n\t\t\t\t\t\tselectableRoots : false\r\n        }, options);\r\n        self.dataView = new Slick.Data.DataView();\r\n\t\t\t\tself.grid = null;\r\n\t\t\t\tself.searchList = null;\r\n\t\t\t\tself.columnsArr = null;\r\n\t\t\t\tself.slickGrid = null;\r\n\r\n        self.dataView.onRowCountChanged.subscribe(function (e, args) {\r\n            updateGrid.call(self);\r\n        });\r\n\r\n        self.dataView.onRowsChanged.subscribe(function (e, args) {\r\n        \tself.grid.invalidateRows(args.rows);\r\n        \tself.grid.render();\r\n        });\r\n\t\t\t\t\r\n\r\n        $(document).on(\"input\", self.options.slickContainer + \"Search\", function (e) {\r\n        \t\tself.searchList = $(this).val().split(\" \");\r\n\r\n            self.dataView.beginUpdate();\r\n            self.dataView.setFilter(function(item) {\r\n            \tvar mnull = 0, optnull = 0, l = self.searchList.length, len = self.columnsArr.length;\r\n            \t\tfor (var i = 0; i < l; i++) {\r\n            \t\t\tfor (var j = 0; j < len; j++) {\r\n            \t\t\t\tif (String(item[self.columnsArr[j].field]).toLowerCase().indexOf(String(self.searchList[i]).toLowerCase()) === -1) {\r\n\t\t\t\t\t            mnull++;\r\n\t\t\t\t            }\r\n            \t\t\t}\r\n            \t\t\tif (mnull === len) {\r\n\t\t\t\t            optnull++;\r\n\t\t\t            }\r\n            \t\t\tmnull = 0;\r\n            \t\t}\r\n            \t\treturn optnull === 0;\r\n            });\r\n            self.dataView.endUpdate();\r\n        });\r\n    };\r\n\r\n    DataRows.prototype.loadFromAsystView = function (viewName) {\r\n    \tvar self = this;\r\n        var data = null;\r\n        if (window.Asyst && Asyst.Workspace && Asyst.Workspace.currentForm && Asyst.Workspace.currentForm.Data)\r\n            data = Asyst.protocol.thiningData(Asyst.Workspace.currentForm.Data);\r\n    \tAsyst.APIv2.View.load({\r\n    \t    viewName: viewName,\r\n            data: data,\r\n    \t    success: function(slick) {\r\n    \t        self.grid = new Slick.Grid(self.options.slickContainer, self.dataView, slick.columns, slickOptions);\r\n    \t        self.columnsArr = self.grid.getColumns();\r\n    \t        if (!self.options.selectableRoots) {\r\n    \t            slick.data = slick.data.filter(function (item) { return Boolean(item.ParentKey); });\r\n    \t        }\r\n\r\n    \t        updateGrid.call(self, slick.data);\r\n    \t        //self.slickGrid = grid;\r\n    \t    },\r\n    \t    async: false\r\n    \t});\r\n    };\r\n\r\n    DataRows.prototype.on = function (eventName, callback) {\r\n        this.grid[eventName].subscribe(callback);\r\n    };\r\n\r\n    DataRows.prototype.markRow = function (id, isSelected,resetAllBeforeMark) {\r\n        var rowNode, parent, rowNum;\r\n\r\n        (resetAllBeforeMark && resetAllMarkedRows());\r\n\r\n        rowNum = this.dataView.getRowById(id);\r\n        rowNode = this.grid.getCellNode(rowNum, 0);\r\n        if (rowNode) {\r\n            parent = rowNode.parentNode;\r\n            isSelected ? parent.classList.add(\"row-selected\") : parent.classList.remove(\"row-selected\");\r\n\r\n        }\r\n    };\r\n\r\n    return DataRows;\r\n})();","(function ($) {\r\n    $.fn.treeComboBox = function (settings) {\r\n        var $choicesList, $modal, $dropContainer, choiceTemplate, dropTemplate, tree, $placeholder, $choicesListContainer, dataRows, $attachedSelect, containerId, modalId, options, arrow;\r\n\r\n        options = $.extend({\r\n            expandRoots: false, //Раскрыть дерево\r\n            selectableRoots: true, // настройка 2\r\n            multipleSelect: false, // настройка 4,\r\n            nodes: [],\r\n            maxHeight: 0,\r\n            modalDataRowsView: \"\",\r\n            attachedSelect: null,\r\n            readonly: false\r\n        }, settings);\r\n\r\n\r\n        //#region VARS_INIT\r\n\r\n        var $container = this;\r\n        $container.css(\"margin-left\", 0);\r\n        containerId = $container.attr(\"id\");\r\n        var ztreeId = containerId + \"ZTree\";\r\n        modalId = containerId + \"SlickModal\";\r\n        var formId = \"#\" + Asyst.Workspace.currentForm.FormName + \" \";\r\n\r\n        $attachedSelect = $(options.attachedSelect);\r\n\r\n        var viewModes = {\r\n            singleSelect: function (onInitCompleted) {\r\n                $container.find(\".tree-choice\").addClass(\"single-select\");\r\n\r\n                tree.on(\"onClick\", function () {\r\n                    var selected = tree.getSelectedNodes();\r\n                    (selected && setSingleSelectedNode(selected));\r\n                });\r\n\r\n                onInitCompleted && onInitCompleted.call(null);\r\n\r\n            },\r\n            multipleSelect: function (onInitCompleted) {\r\n                tree.on(\"beforeClick\", function (treeId, treeNode) {\r\n                    tree.checkNode(treeNode.id, !treeNode.checked);\r\n                    return false;\r\n                });\r\n                tree.on(\"onCheck\", function () {\r\n                    renderNodes();\r\n                    (updateLinkedTrees());\r\n                });\r\n\r\n                onInitCompleted && onInitCompleted.call(null);\r\n            }\r\n        };\r\n\r\n        //#endregion /VARS_INIT\r\n\r\n        //#region FUNC\r\n        function renderNodes() {\r\n            var checkedNodes = tree.getCheckedNodes(),\r\n                checkedNodesLength = checkedNodes.length, i, node, result;\r\n\r\n            result = [];\r\n            if (!options.multipleSelect && checkedNodesLength<1 ) {\r\n                result.push(arrow);\r\n            }\r\n            $attachedSelect.find(\"option\").removeAttr(\"selected\");\r\n            for (i = 0; i < checkedNodesLength; i++) {\r\n                node = checkedNodes[i];\r\n                result.push(getChoice(node));\r\n                dataRows && dataRows.markRow(node.id, true);\r\n                $attachedSelect.find(\"option[value=\" + node.id + \"]\").attr(\"selected\", \"selected\");\r\n            }\r\n            $choicesList.html(result.join(\"\"));\r\n\r\n            var nodes = tree.getDisabledNodes();\r\n            for (i = 0; i < nodes.length; i++) {\r\n                nodeId = \"#\" + nodes[i].tId + \"_a\";\r\n                $(nodeId).addClass(\"disabled\");\r\n            }\r\n\r\n            updateView();\r\n        }\r\n\r\n        function setContainerPlaceholder() {\r\n            $choicesList.find(\">*:not(.tree-choice-drop)\").length ? $placeholder.addClass(\"hidden\") : $placeholder.removeClass(\"hidden\");\r\n        }\r\n\r\n        function getChoice(node, classes) {\r\n            return node && choiceTemplate\r\n                .replace(/\\$CHOICE_NAME\\$/, node.name || \"\")\r\n                .replace(/\\$CHOICE_ID\\$/, node.id || 0)\r\n                .replace(/\\$CLASSES\\$/, (classes || \"\"));\r\n        }\r\n\r\n        function updateTreePosition() {\r\n            var height = $choicesList.height();\r\n            $dropContainer.css({ top: height + \"px\" });\r\n        }\r\n\r\n        function setMaxZIndex() {\r\n            var maxZIndex, allIndexes;\r\n\r\n            allIndexes = [].slice.call($(\".tree-drop-container\")).map(function (item) {\r\n                return Number($(item).css(\"z-index\"))\r\n            });\r\n            maxZIndex = Math.max.apply(null, allIndexes);\r\n            if (Number($dropContainer.css(\"z-index\")) <= maxZIndex) {\r\n                maxZIndex++;\r\n                $dropContainer.css(\"z-index\", maxZIndex);\r\n            }\r\n\r\n        }\r\n\r\n        function openTree() {\r\n            if (!$dropContainer.is(\":visible\")) {\r\n                var value = $attachedSelect.val();\r\n                var elementName = $attachedSelect.attr(\"id\");\r\n\r\n                $choicesList.addClass(\"tree-opened\");\r\n                updateTreePosition();\r\n                options.maxHeight && $container.find(\".ztree\").css({\r\n                    \"max-height\": (options.maxHeight + \"px\"),\r\n                    \"overflow-y\": \"auto\"\r\n                });\r\n                setMaxZIndex();\r\n                $dropContainer.show();\r\n                if ($attachedSelect.val() && !options.multipleSelect) {\r\n                    var selected = tree.getNodesByValue($attachedSelect.val());\r\n                    if (selected.length > 0) {\r\n                        tree.openPathByNode(selected[0]);\r\n                        var container = $('#' + ztreeId),\r\n                            scrollTo = $('#' + selected[0].tId);\r\n\r\n                        container.animate({\r\n                            scrollTop: scrollTo.offset().top - container.offset().top + container.scrollTop()\r\n                        });\r\n                        tree.selectNode(selected[0]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        function closeTree() {\r\n            $choicesList.removeClass(\"tree-opened\");\r\n            $dropContainer.hide();\r\n        }\r\n\r\n        function updateView() {\r\n            setContainerPlaceholder();\r\n            updateTreePosition();\r\n        }\r\n\r\n        function initHtml() {\r\n            arrow = '<li class=\"tree-choice-drop\"><div><b></b></div></li>';\r\n            choiceTemplate = options.multipleSelect\r\n                ? '<li class=\"tree-choice $CLASSES$\"><span>$CHOICE_NAME$</span><a class=\"tree-choice-close cursor-pointer\" data-choice-id=\"$CHOICE_ID$\"></a></li>'\r\n                : arrow + '<li class=\"tree-choice-close cursor-pointer\" data-choice-id=\"$CHOICE_ID$\"></li><li class=\"tree-choice single-select $CLASSES$\"><span>$CHOICE_NAME$</span></li>';\r\n            //choiceTemplate = '<li class=\"tree-choice $CLASSES$\"><span>$CHOICE_NAME$</span></li>';\r\n            $container.addClass(\"tree-container relative\").attr(\"tab-index\", 0);\r\n            $container.html('<div class=\"tree-choice-container not-selectable relative\"><ul class=\"tree-choices tree-not-init cursor-pointer\"></ul><div class=\"tree-btn-modal-container\"><button class=\"btn btn-default tree-btn-modal\">...</button></div><div class=\"absolute tree-container-placeholder hidden\"><span>Выберите значение</span></div></div><div class=\"tree-drop-container absolute\" style=\"display:none;\"><div class=\"relative\"><input id=\"citySel\" class=\"tree-input\" type=\"text\" value=\"\" placeholder=\"Введите часть названия для поиска\" tabindex=\"-1\"/></div><ul id=\"' + ztreeId + '\" class=\"ztree\"></ul></div><div class=\"modalfade hide tree-modal-box\" tabindex=\"-1\" role=\"dialog\"aria-hidden=\"true\"><div class=\"modal-body auto-max-height\"><div class=\"control-group\"><input type=\"text\" id=\"' + modalId + 'Search\" class=\"tree-modal-box-input\" placeholder=\"Введите часть названия для поиска\"/></div><div id=\"' + containerId + 'SlickModal\" class=\"grid\"></div><ul class=\"tree-choices tree-not-init modal-choices\" data-tree-id=\"' + containerId + '\"></ul></div><div class=\"modal-footer\"><button type=\"button\" class=\"btn\" data-dismiss=\"modal\" aria-hidden=\"true\">Закрыть</button></div></div>');\r\n            $placeholder = $container.find(\".tree-container-placeholder\");\r\n            $choicesListContainer = $container.find(\".tree-choice-container\");\r\n            $choicesList = $container.find(\".tree-choices\");\r\n            $dropContainer = $container.find(\".tree-drop-container\");\r\n            $modal = $container.find(\".tree-modal-box\");\r\n\r\n        }\r\n\r\n        function setSingleSelectedNode(node) {\r\n            var isChanged = false;\r\n\r\n            if ($attachedSelect.val() != node.id) {\r\n                isChanged = true;\r\n            }\r\n            if (!(options.selectableRoots || !node.isParent)) {\r\n                return;\r\n            }\r\n            if (node.chkDisabled) {\r\n                return;\r\n            }\r\n            $choicesList.html(getChoice(node, true));\r\n            setContainerPlaceholder();\r\n            dataRows && dataRows.markRow(node.id, true, true);\r\n\r\n            $attachedSelect.find(\"option\").removeAttr(\"selected\");\r\n            $attachedSelect.find(\"option[value=\" + node.id + \"]\").attr(\"selected\", \"selected\");\r\n            $container.find(\".tree-input\").val(\"\").trigger(\"input\");\r\n            if (isChanged) {\r\n                $attachedSelect.trigger(\"change\");\r\n                updateLinkedTrees();\r\n            }\r\n            closeTree();\r\n        }\r\n\r\n\r\n        function initModalDataRows(callback) {\r\n            var viewName;\r\n            viewName = options.modalDataRowsView;\r\n            if (!viewName) {\r\n                $container.find(\".tree-btn-modal-container\").css({ display: \"none\", width: 0 });\r\n                $container.find(\".tree-choices,.tree-drop-container\").css({ width: \"100%\" });\r\n                return;\r\n            }\r\n        }\r\n        function loadModalDataRows(callback) {\r\n            var viewName;\r\n            viewName = options.modalDataRowsView;\r\n\r\n            dataRows = new DataRows({\r\n                slickContainer: \"#\" + modalId,\r\n                searchInput: \".tree-modal-box-input\",\r\n                selectableRoots: options.selectableRoots\r\n            });\r\n\r\n            dataRows.loadFromAsystView(viewName);\r\n            dataRows.on(\"onClick\", function (e) {\r\n                var cell = this.getCellFromEvent(e),\r\n                    dataItem = this.getDataItem(cell.row);\r\n\r\n                if (options.multipleSelect) {\r\n                    tree.checkNode(dataItem.Key, true);\r\n                    dataRows.markRow(dataItem.Key, true);\r\n                } else {\r\n                    var node = tree.getNodeById(dataItem.Key);\r\n                    setSingleSelectedNode(node);\r\n                    $(\".modal-body > .tree-choices > .tree-choice-close\").hide().remove();\r\n                    $(\".modal-body > .tree-choices > .tree-choice-drop\").hide().remove();\r\n                }\r\n            });\r\n        }\r\n\r\n        function removeChoice(item) {\r\n            var choiceId = Number(item.dataset.choiceId);\r\n            dataRows && dataRows.markRow(choiceId, false);\r\n            if (options.multipleSelect) {\r\n                tree.checkNode(choiceId, false);\r\n                $(item).parents(\".tree-choice\").hide().remove();\r\n            } else {\r\n                $choicesList.find(\".tree-choice\").hide().remove();\r\n                $choicesList.find(\".tree-choice-close\").hide().remove();\r\n            }\r\n            if (options.attachedSelect) {\r\n                $attachedSelect.find(\"option[value=\" + choiceId + \"]\").removeAttr(\"selected\", false);\r\n            }\r\n            updateView();\r\n        }\r\n\r\n        function updateLinkedTrees() {\r\n            var i, item, count, treeContainer, arr;\r\n\r\n            Asyst.Workspace.currentForm.Update();\r\n            $(\"select[data-depends-select=\" + $attachedSelect.attr(\"id\") + ']').each(function () {\r\n                item = $(this).attr(\"id\");\r\n                //treeContainer = formId + \" #TreeComboBox\" + item;\r\n                //if ($(treeContainer).length) {\r\n                //    $(treeContainer).remove();\r\n                //}\r\n                Asyst.Workspace.currentForm.LoadSelect($(this).attr(\"id\"), null, true);\r\n            });\r\n        }\r\n\r\n        //#endregion FUNC\r\n\r\n        initHtml();\r\n        setContainerPlaceholder();\r\n        tree = new Tree(Asyst.Workspace.currentForm.FormName + \" #\" + ztreeId, options);\r\n        initModalDataRows();\r\n        renderNodes();\r\n        options.multipleSelect ? viewModes.multipleSelect() : viewModes.singleSelect();\r\n\r\n        $choicesList.removeClass(\"tree-not-init\");\r\n\r\n        if (!options.readonly) {\r\n\r\n            $choicesListContainer.on(\"click\", function (e) {\r\n                var target = e.target,\r\n                    isCloseBtn = (target.classList.contains(\"tree-btn-modal\") || target.classList.contains(\"tree-choice-close\") || target.parentNode.classList.contains(\"tree-choice-close\"));\r\n                e.preventDefault();\r\n\r\n                if (!isCloseBtn) {\r\n                    $choicesList.hasClass(\"tree-opened\") ? closeTree() : openTree();\r\n                }\r\n            });\r\n\r\n            $container.on(\"click\", \".tree-choice-close\", function () {\r\n                removeChoice(this);\r\n            });\r\n\r\n            $container.on(\"click\", \".tree-btn-modal\", function () {\r\n                closeTree();\r\n                $modal.modal({ backdrop: \"static\" });\r\n                loadModalDataRows();\r\n                $(\".modal-body > .tree-choices > .tree-choice-close\").hide().remove();\r\n                $(\".modal-body > .tree-choices > .tree-choice-drop\").hide().remove();\r\n            });\r\n\r\n            $container.on(\"input\", \".tree-input\", function () {\r\n                var clearBtn = $container.find(\".tree-icon-clear\");\r\n                var $search = $(this);\r\n                var delay = 500;\r\n                clearTimeout($search.data('timer'));\r\n                $search.data('timer', setTimeout(function () {\r\n                    $search.val() ? clearBtn.removeClass(\"hidden\") : clearBtn.addClass(\"hidden\");\r\n                    tree.search($search.val());\r\n                }, delay));\r\n            });\r\n\r\n            $container.on(\"click\", \".tree-icon-clear\", function () {\r\n                $container.find(\".tree-input\").val(\"\").trigger(\"input\");\r\n            });\r\n\r\n            $(document).on(\"mousedown\", function (event) {\r\n                var target = $(event.target);\r\n                if (!(target.hasClass(\"tree-choices\") || target.hasClass(\"tree-drop-container\") || target.parents(\".tree-container\").length)) {\r\n                    closeTree();\r\n                }\r\n            });\r\n\r\n            $(document).on(\"dblclick\", \"#\" + modalId + \" .slick-cell\", function (e) {\r\n                dataRows.grid.onDblClick.notify(null, e, dataRows.grid);\r\n            });\r\n\r\n            $(document).on(\"click\", \".modal-choices .tree-choice-close\", function () {\r\n                //TODO:Мега костылище\r\n                var self = $(this),\r\n                    container = self.parents(\".modal-choices\").data(\"treeId\"),\r\n                    ztree = container + \"ZTree\",\r\n                    modal = container + \"SlickModal\",\r\n                    choiceId = self.data(\"choiceId\"),\r\n                    selectId = (container + \"\").replace(\"TreeComboBox\", \"\");\r\n\r\n                var treeObj = $.fn.zTree.getZTreeObj(ztree);\r\n                var nodes = treeObj.getNodesByParam(\"id\", choiceId, null);\r\n                treeObj.checkNode(nodes[0], false, true, true);\r\n                self.parents(\".tree-choice\").hide().remove();\r\n\r\n                $(formId + \"#\" + modal + \" .slick-row:contains('\" + self.parent().text().trim() + \"')\").removeClass(\"row-selected\");\r\n                $(formId + \"select#\" + selectId).find(\"option[value=\" + choiceId + \"]\").removeAttr(\"selected\", false);\r\n                $(formId + \"#\" + container).find(\".tree-choice.single-select\").remove();\r\n            });\r\n\r\n            $(document).on(\"hide\", \".tree-modal-box\", function () {\r\n                $(this).find(\".tree-modal-box-input\").val(\"\").trigger(\"input\");\r\n            });\r\n        } else {\r\n            $container.addClass(\"readonly\");\r\n            $container.addClass(\"chosen-disabled\");\r\n        }\r\n\r\n        $(window).resize(function () {\r\n            updateTreePosition();\r\n        });\r\n    }\r\n})(jQuery);"]}